
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at mar déc  7 16:00:34 CET 2021
2021-12-07 16:00:35.233034: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
[drg2-w019:165618] [[9616,0],0] ORTE_ERROR_LOG: Out of resource in file util/show_help.c at line 501
WARNING:tensorflow:From /home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-07 16:00:38.146756: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-12-07 16:00:38.189661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:00:38.189698: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:00:38.193160: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:00:38.196129: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:00:38.197367: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:00:38.200153: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:00:38.201973: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:00:38.207238: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:00:38.208417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:00:38.208444: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:00:38.735850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:00:38.735894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:00:38.735900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:00:38.737776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:00:38.739053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:00:38.739092: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:00:38.739141: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:00:38.739154: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:00:38.739166: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:00:38.739177: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:00:38.739193: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:00:38.739205: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:00:38.740283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:00:38.740303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:00:38.740310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:00:38.740315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:00:38.741392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:01:31.271019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:01:31.271325: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:01:31.271773: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:01:31.271798: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:01:31.271816: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:01:31.271831: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:01:31.271847: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:01:31.271865: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:01:31.273000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:01:31.274330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:01:31.274362: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:01:31.274398: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:01:31.274412: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:01:31.274424: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:01:31.274437: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:01:31.274449: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:01:31.274461: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:01:31.275616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:01:31.275660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:01:31.275667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:01:31.275676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:01:31.276808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:01:31.276879: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
2021-12-07 16:01:39.715356: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
Exécution 0 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 300, 50)           2500      
_________________________________________________________________
bidirectional (Bidirectional (None, 20)                3720      
_________________________________________________________________
dense (Dense)                (None, 10)                210       
=================================================================
Total params: 6,430
Trainable params: 6,430
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2500 - accuracy: 0.09842/5 [===========>..................] - ETA: 2s - loss: 0.2493 - accuracy: 0.10263/5 [=================>............] - ETA: 1s - loss: 0.2486 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.2479 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.2479 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.2479 - accuracy: 0.1002
Epoch 2/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2429 - accuracy: 0.10342/5 [===========>..................] - ETA: 2s - loss: 0.2422 - accuracy: 0.10273/5 [=================>............] - ETA: 1s - loss: 0.2414 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.2407 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.2406 - accuracy: 0.10055/5 [==============================] - 5s 1s/step - loss: 0.2406 - accuracy: 0.1005
Epoch 3/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2351 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.2342 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.2334 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.2325 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.2324 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.2324 - accuracy: 0.1002
Epoch 4/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2261 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.2250 - accuracy: 0.10213/5 [=================>............] - ETA: 1s - loss: 0.2240 - accuracy: 0.10204/5 [=======================>......] - ETA: 1s - loss: 0.2229 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.2229 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.2229 - accuracy: 0.1017
Epoch 5/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2154 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.2142 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.2129 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.2117 - accuracy: 0.10175/5 [==============================] - ETA: 0s - loss: 0.2116 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.2116 - accuracy: 0.1017
Epoch 6/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2026 - accuracy: 0.10422/5 [===========>..................] - ETA: 2s - loss: 0.2012 - accuracy: 0.10523/5 [=================>............] - ETA: 1s - loss: 0.1998 - accuracy: 0.10304/5 [=======================>......] - ETA: 1s - loss: 0.1984 - accuracy: 0.10175/5 [==============================] - ETA: 0s - loss: 0.1984 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.1984 - accuracy: 0.1017
Epoch 7/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1879 - accuracy: 0.09802/5 [===========>..................] - ETA: 2s - loss: 0.1863 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.1847 - accuracy: 0.10224/5 [=======================>......] - ETA: 1s - loss: 0.1831 - accuracy: 0.10185/5 [==============================] - ETA: 0s - loss: 0.1831 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.1831 - accuracy: 0.1017
Epoch 8/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1715 - accuracy: 0.09852/5 [===========>..................] - ETA: 2s - loss: 0.1697 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.1680 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.1662 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.1662 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.1662 - accuracy: 0.1017
Epoch 9/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1540 - accuracy: 0.10562/5 [===========>..................] - ETA: 2s - loss: 0.1523 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.1506 - accuracy: 0.10174/5 [=======================>......] - ETA: 1s - loss: 0.1489 - accuracy: 0.10175/5 [==============================] - ETA: 0s - loss: 0.1489 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.1489 - accuracy: 0.1017
Epoch 10/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1374 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.1359 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.1343 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.1328 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.1328 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.1328 - accuracy: 0.1017
Epoch 11/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1231 - accuracy: 0.09572/5 [===========>..................] - ETA: 2s - loss: 0.1217 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.1205 - accuracy: 0.10334/5 [=======================>......] - ETA: 1s - loss: 0.1194 - accuracy: 0.10175/5 [==============================] - ETA: 0s - loss: 0.1193 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.1193 - accuracy: 0.1017
Epoch 12/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1118 - accuracy: 0.10402/5 [===========>..................] - ETA: 2s - loss: 0.1109 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.1101 - accuracy: 0.10284/5 [=======================>......] - ETA: 1s - loss: 0.1092 - accuracy: 0.10175/5 [==============================] - ETA: 0s - loss: 0.1092 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.1092 - accuracy: 0.1017
Epoch 13/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1039 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.1033 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.1028 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.1023 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.1023 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.1023 - accuracy: 0.0995
Epoch 14/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0988 - accuracy: 0.10222/5 [===========>..................] - ETA: 2s - loss: 0.0985 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.0981 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.0978 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0978 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0978 - accuracy: 0.1002
Epoch 15/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0956 - accuracy: 0.10222/5 [===========>..................] - ETA: 2s - loss: 0.0954 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0952 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0951 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0950 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0950 - accuracy: 0.1002
Epoch 16/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0938 - accuracy: 0.09452/5 [===========>..................] - ETA: 2s - loss: 0.0937 - accuracy: 0.09783/5 [=================>............] - ETA: 1s - loss: 0.0936 - accuracy: 0.09754/5 [=======================>......] - ETA: 1s - loss: 0.0934 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0934 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0934 - accuracy: 0.1002
Epoch 17/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0924 - accuracy: 0.10622/5 [===========>..................] - ETA: 2s - loss: 0.0925 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.0924 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0923 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0923 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0923 - accuracy: 0.1002
Epoch 18/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0918 - accuracy: 0.09662/5 [===========>..................] - ETA: 2s - loss: 0.0918 - accuracy: 0.09773/5 [=================>............] - ETA: 1s - loss: 0.0917 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.0917 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0917 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0917 - accuracy: 0.1002
Epoch 19/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0914 - accuracy: 0.09442/5 [===========>..................] - ETA: 2s - loss: 0.0913 - accuracy: 0.09593/5 [=================>............] - ETA: 1s - loss: 0.0913 - accuracy: 0.09874/5 [=======================>......] - ETA: 1s - loss: 0.0912 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0912 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0912 - accuracy: 0.1002
Epoch 20/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0910 - accuracy: 0.10222/5 [===========>..................] - ETA: 2s - loss: 0.0910 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0909 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0909 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0909 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0909 - accuracy: 0.1002
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0908 - accuracy: 0.09732/3 [===================>..........] - ETA: 0s - loss: 0.0908 - accuracy: 0.10043/3 [==============================] - ETA: 0s - loss: 0.0908 - accuracy: 0.09963/3 [==============================] - 0s 106ms/step - loss: 0.0908 - accuracy: 0.0996
2021-12-07 16:04:39.505768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:04:39.506028: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:04:39.506141: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:04:39.506159: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:04:39.506175: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:04:39.506190: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:04:39.506205: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:04:39.506222: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:04:39.507031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:04:39.507059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:04:39.507066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:04:39.507071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:04:39.507831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:04:39.508447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:04:39.508475: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:04:39.508519: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:04:39.508532: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:04:39.508543: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:04:39.508555: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:04:39.508566: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:04:39.508578: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:04:39.509310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:04:39.509328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:04:39.509335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:04:39.509341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:04:39.510079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.1504391  0.08788854 0.08263009 0.11303587 0.11435544
 0.12360348 0.12102979 0.08094192 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.15043908 0.08788852 0.08263009 0.11303587 0.11435544
 0.12360348 0.12102979 0.08094191 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.15043905 0.08788854 0.08263008 0.11303587 0.11435544
 0.12360345 0.12102974 0.08094192 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.15043905 0.08788854 0.08263008 0.11303587 0.11435544
 0.12360345 0.12102974 0.08094192 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.15043905 0.08788854 0.08263008 0.11303587 0.11435544
 0.12360345 0.12102974 0.08094192 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.1504391  0.08788854 0.08263009 0.11303587 0.11435544
 0.12360348 0.12102979 0.08094191 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.1504391  0.08788854 0.08263011 0.11303587 0.11435544
 0.12360348 0.12102979 0.08094191 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.15043905 0.08788854 0.08263008 0.11303587 0.11435544
 0.12360345 0.12102974 0.08094192 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.15043905 0.08788854 0.08263008 0.11303587 0.11435544
 0.12360345 0.12102974 0.08094192 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.15043905 0.08788854 0.08263008 0.11303589 0.11435544
 0.12360345 0.12102975 0.08094191 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.1504391  0.08788854 0.08263009 0.11303587 0.11435544
 0.12360348 0.12102979 0.08094191 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.1504391  0.08788854 0.08263009 0.11303587 0.11435544
 0.12360348 0.12102979 0.08094191 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.15043905 0.08788854 0.08263008 0.11303587 0.11435544
 0.12360345 0.12102974 0.08094192 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.15043905 0.08788854 0.08263008 0.11303589 0.11435544
 0.12360345 0.12102974 0.08094192 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [1 9 0 6 7 5 4 2 3 8] pred: [0.1273227  0.1504391  0.08788854 0.08263009 0.11303587 0.11435544
 0.12360348 0.12102979 0.08094191 0.14828588]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
Exécution 1 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 20)                3720      
_________________________________________________________________
dense_1 (Dense)              (None, 10)                210       
=================================================================
Total params: 6,430
Trainable params: 6,430
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2528 - accuracy: 0.10012/5 [===========>..................] - ETA: 2s - loss: 0.2519 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.2510 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.2501 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.2501 - accuracy: 0.10085/5 [==============================] - 5s 1s/step - loss: 0.2501 - accuracy: 0.1008
Epoch 2/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2438 - accuracy: 0.09582/5 [===========>..................] - ETA: 2s - loss: 0.2429 - accuracy: 0.09913/5 [=================>............] - ETA: 1s - loss: 0.2420 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.2411 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.2411 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.2411 - accuracy: 0.1004
Epoch 3/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2347 - accuracy: 0.09862/5 [===========>..................] - ETA: 2s - loss: 0.2337 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.2328 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.2318 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.2318 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.2318 - accuracy: 0.1009
Epoch 4/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2248 - accuracy: 0.10142/5 [===========>..................] - ETA: 2s - loss: 0.2237 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.2226 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.2215 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.2215 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2215 - accuracy: 0.1007
Epoch 5/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2136 - accuracy: 0.10282/5 [===========>..................] - ETA: 2s - loss: 0.2124 - accuracy: 0.10313/5 [=================>............] - ETA: 1s - loss: 0.2112 - accuracy: 0.10254/5 [=======================>......] - ETA: 1s - loss: 0.2099 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.2099 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2099 - accuracy: 0.1007
Epoch 6/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2009 - accuracy: 0.09792/5 [===========>..................] - ETA: 2s - loss: 0.1995 - accuracy: 0.09983/5 [=================>............] - ETA: 1s - loss: 0.1981 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.1967 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.1966 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.1966 - accuracy: 0.1007
Epoch 7/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1863 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.1848 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.1832 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.1816 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.1816 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.1816 - accuracy: 0.1007
Epoch 8/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1702 - accuracy: 0.10442/5 [===========>..................] - ETA: 2s - loss: 0.1685 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.1668 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.1651 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.1651 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.1651 - accuracy: 0.1007
Epoch 9/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1532 - accuracy: 0.10442/5 [===========>..................] - ETA: 2s - loss: 0.1515 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.1498 - accuracy: 0.10204/5 [=======================>......] - ETA: 1s - loss: 0.1481 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.1480 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.1480 - accuracy: 0.1007
Epoch 10/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1365 - accuracy: 0.10252/5 [===========>..................] - ETA: 2s - loss: 0.1348 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.1333 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.1319 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.1318 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.1318 - accuracy: 0.1007
Epoch 11/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1218 - accuracy: 0.10382/5 [===========>..................] - ETA: 2s - loss: 0.1205 - accuracy: 0.10293/5 [=================>............] - ETA: 1s - loss: 0.1193 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.1181 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.1180 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.1180 - accuracy: 0.1007
Epoch 12/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1102 - accuracy: 0.10692/5 [===========>..................] - ETA: 2s - loss: 0.1093 - accuracy: 0.10393/5 [=================>............] - ETA: 1s - loss: 0.1085 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.1077 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.1077 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.1077 - accuracy: 0.1007
Epoch 13/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1023 - accuracy: 0.10852/5 [===========>..................] - ETA: 2s - loss: 0.1017 - accuracy: 0.10413/5 [=================>............] - ETA: 1s - loss: 0.1012 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.1007 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.1006 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.1006 - accuracy: 0.1007
Epoch 14/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0974 - accuracy: 0.09742/5 [===========>..................] - ETA: 2s - loss: 0.0970 - accuracy: 0.10003/5 [=================>............] - ETA: 1s - loss: 0.0966 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0963 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.0963 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0963 - accuracy: 0.1007
Epoch 15/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0944 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.0941 - accuracy: 0.10003/5 [=================>............] - ETA: 1s - loss: 0.0939 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0937 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.0937 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0937 - accuracy: 0.1007
Epoch 16/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0925 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0924 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0923 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.0922 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.0922 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0922 - accuracy: 0.1007
Epoch 17/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0915 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.0915 - accuracy: 0.10213/5 [=================>............] - ETA: 1s - loss: 0.0914 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.0914 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0914 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0914 - accuracy: 0.1007
Epoch 18/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0910 - accuracy: 0.09582/5 [===========>..................] - ETA: 2s - loss: 0.0909 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.0909 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0909 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.0909 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0909 - accuracy: 0.1007
Epoch 19/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0906 - accuracy: 0.10602/5 [===========>..................] - ETA: 2s - loss: 0.0906 - accuracy: 0.10183/5 [=================>............] - ETA: 1s - loss: 0.0906 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.0906 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.0906 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0906 - accuracy: 0.1007
Epoch 20/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0904 - accuracy: 0.10102/5 [===========>..................] - ETA: 2s - loss: 0.0904 - accuracy: 0.09983/5 [=================>............] - ETA: 1s - loss: 0.0904 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.0904 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.0904 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0904 - accuracy: 0.1007
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0903 - accuracy: 0.09792/3 [===================>..........] - ETA: 0s - loss: 0.0903 - accuracy: 0.09873/3 [==============================] - ETA: 0s - loss: 0.0903 - accuracy: 0.09863/3 [==============================] - 0s 103ms/step - loss: 0.0903 - accuracy: 0.0986
2021-12-07 16:08:39.772032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:08:39.772300: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:08:39.772754: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:08:39.772774: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:08:39.772792: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:08:39.772811: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:08:39.772827: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:08:39.772854: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:08:39.773695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:08:39.773723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:08:39.773729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:08:39.773735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:08:39.774493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:08:39.775116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:08:39.775141: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:08:39.775173: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:08:39.775185: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:08:39.775196: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:08:39.775207: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:08:39.775218: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:08:39.775230: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:08:39.775951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:08:39.775969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:08:39.775976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:08:39.775981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:08:39.776704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.11104712 0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948981 0.12123115 0.11899561 0.09059852
 0.1110471  0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.1110471  0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.11104712 0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.11104712 0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.11104712 0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.1110471  0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.11104712 0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.1110471  0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.11104712 0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.11104712 0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.11104712 0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.1110471  0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.1110471  0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [9 3 4 7 6 0 2 1 5 8] pred: [0.10850684 0.09068342 0.09948982 0.12123115 0.11899561 0.09059852
 0.11104712 0.11204054 0.08955692 0.14342012]
 Top predictions indices: [9] vs. real classes indices: [0]
Jaccard Score: 0.0
 
Exécution 2 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 20)                3720      
_________________________________________________________________
dense_2 (Dense)              (None, 10)                210       
=================================================================
Total params: 6,430
Trainable params: 6,430
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2492 - accuracy: 0.10002/5 [===========>..................] - ETA: 2s - loss: 0.2482 - accuracy: 0.10003/5 [=================>............] - ETA: 1s - loss: 0.2472 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.2462 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.2462 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.2462 - accuracy: 0.1001
Epoch 2/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2392 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.2382 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.2372 - accuracy: 0.10154/5 [=======================>......] - ETA: 1s - loss: 0.2362 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.2362 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.2362 - accuracy: 0.1010
Epoch 3/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2290 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.2279 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.2268 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.2257 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.2257 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.2257 - accuracy: 0.1011
Epoch 4/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2180 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.2167 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.2156 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.2143 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.2143 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.2143 - accuracy: 0.1011
Epoch 5/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2059 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.2044 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.2031 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.2017 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.2017 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.2017 - accuracy: 0.1011
Epoch 6/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1923 - accuracy: 0.09672/5 [===========>..................] - ETA: 2s - loss: 0.1908 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.1894 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.1878 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.1878 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.1878 - accuracy: 0.1011
Epoch 7/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1775 - accuracy: 0.10642/5 [===========>..................] - ETA: 2s - loss: 0.1759 - accuracy: 0.10323/5 [=================>............] - ETA: 1s - loss: 0.1745 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.1730 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.1729 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.1729 - accuracy: 0.1011
Epoch 8/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1620 - accuracy: 0.10692/5 [===========>..................] - ETA: 2s - loss: 0.1607 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.1592 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.1577 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.1577 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.1577 - accuracy: 0.1011
Epoch 9/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1474 - accuracy: 0.09832/5 [===========>..................] - ETA: 2s - loss: 0.1458 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.1444 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.1430 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.1430 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.1430 - accuracy: 0.1011
Epoch 10/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1335 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.1323 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.1312 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.1299 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.1299 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.1299 - accuracy: 0.1011
Epoch 11/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1220 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.1210 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.1200 - accuracy: 0.10154/5 [=======================>......] - ETA: 1s - loss: 0.1190 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.1190 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.1190 - accuracy: 0.1011
Epoch 12/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1128 - accuracy: 0.09672/5 [===========>..................] - ETA: 2s - loss: 0.1120 - accuracy: 0.10003/5 [=================>............] - ETA: 1s - loss: 0.1113 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.1105 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.1105 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.1105 - accuracy: 0.1011
Epoch 13/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1061 - accuracy: 0.09892/5 [===========>..................] - ETA: 2s - loss: 0.1054 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.1047 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.1042 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.1042 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.1042 - accuracy: 0.1011
Epoch 14/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1009 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.1005 - accuracy: 0.09843/5 [=================>............] - ETA: 1s - loss: 0.1000 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.0997 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.0997 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.0997 - accuracy: 0.1011
Epoch 15/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0972 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.0971 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0968 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0966 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.0965 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.0965 - accuracy: 0.1011
Epoch 16/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0950 - accuracy: 0.09732/5 [===========>..................] - ETA: 2s - loss: 0.0947 - accuracy: 0.10273/5 [=================>............] - ETA: 1s - loss: 0.0946 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0944 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0944 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.0944 - accuracy: 0.1011
Epoch 17/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0934 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0933 - accuracy: 0.09913/5 [=================>............] - ETA: 1s - loss: 0.0932 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0931 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0931 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.0931 - accuracy: 0.1011
Epoch 18/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0924 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.0923 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.0922 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0921 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0921 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.0921 - accuracy: 0.1011
Epoch 19/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0917 - accuracy: 0.10392/5 [===========>..................] - ETA: 2s - loss: 0.0916 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0916 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0915 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0915 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0915 - accuracy: 0.1010
Epoch 20/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0912 - accuracy: 0.09752/5 [===========>..................] - ETA: 2s - loss: 0.0911 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0911 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0911 - accuracy: 0.09935/5 [==============================] - ETA: 0s - loss: 0.0911 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0911 - accuracy: 0.0996
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0909 - accuracy: 0.10082/3 [===================>..........] - ETA: 0s - loss: 0.0909 - accuracy: 0.10133/3 [==============================] - ETA: 0s - loss: 0.0909 - accuracy: 0.10083/3 [==============================] - 0s 102ms/step - loss: 0.0909 - accuracy: 0.1008
2021-12-07 16:12:39.693907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:12:39.694187: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:12:39.694638: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:12:39.694661: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:12:39.694695: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:12:39.694712: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:12:39.694728: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:12:39.694746: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:12:39.695534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:12:39.695560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:12:39.695567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:12:39.695572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:12:39.696328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:12:39.697116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:12:39.697141: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:12:39.697171: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:12:39.697182: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:12:39.697194: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:12:39.697205: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:12:39.697216: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:12:39.697227: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:12:39.697947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:12:39.697964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:12:39.697971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:12:39.697976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:12:39.698716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.16026244 0.13308994 0.1079513  0.08324371 0.09283589 0.15769346
 0.10062882 0.11034404 0.08935591 0.08812507]
 Top predictions indices: [0] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.16026245 0.13308994 0.1079513  0.08324371 0.09283589 0.1576934
 0.10062881 0.11034404 0.08935591 0.08812512]
 Top predictions indices: [0] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.16026244 0.13308994 0.1079513  0.08324371 0.09283589 0.15769346
 0.10062882 0.11034404 0.08935591 0.08812507]
 Top predictions indices: [0] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.1602625  0.13308994 0.10795134 0.08324371 0.09283592 0.15769348
 0.10062885 0.11034406 0.08935595 0.08812512]
 Top predictions indices: [0] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.16026247 0.13308994 0.1079513  0.08324369 0.09283592 0.1576934
 0.10062881 0.11034402 0.08935592 0.08812512]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.1602625  0.13308994 0.10795134 0.08324371 0.09283592 0.15769342
 0.10062882 0.11034406 0.08935595 0.08812512]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.16026245 0.13308994 0.1079513  0.08324371 0.09283589 0.1576934
 0.10062881 0.11034402 0.08935591 0.08812512]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.16026245 0.13308994 0.1079513  0.08324371 0.09283589 0.1576934
 0.10062881 0.11034404 0.08935591 0.08812512]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.16026245 0.13308997 0.10795134 0.08324371 0.09283589 0.15769346
 0.10062882 0.11034404 0.08935591 0.08812507]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.1602625  0.13308994 0.10795134 0.08324374 0.09283593 0.15769342
 0.10062882 0.11034406 0.08935595 0.08812515]
 Top predictions indices: [0] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.16026244 0.13308993 0.1079513  0.08324371 0.09283587 0.15769346
 0.10062881 0.11034404 0.08935589 0.08812507]
 Top predictions indices: [0] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.16026245 0.13308994 0.1079513  0.08324371 0.09283589 0.1576934
 0.10062881 0.11034404 0.08935591 0.08812512]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.16026247 0.13308994 0.1079513  0.08324371 0.09283592 0.1576934
 0.10062881 0.11034404 0.08935592 0.08812512]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.1602625  0.13308997 0.10795134 0.08324375 0.09283592 0.15769342
 0.10062885 0.11034406 0.08935595 0.08812515]
 Top predictions indices: [0] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [0 5 1 7 2 6 4 8 9 3] pred: [0.16026245 0.13308997 0.10795134 0.08324371 0.09283589 0.15769346
 0.10062882 0.11034402 0.08935591 0.08812509]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Exécution 3 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 20)                3720      
_________________________________________________________________
dense_3 (Dense)              (None, 10)                210       
=================================================================
Total params: 6,430
Trainable params: 6,430
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2567 - accuracy: 0.10012/5 [===========>..................] - ETA: 2s - loss: 0.2557 - accuracy: 0.09843/5 [=================>............] - ETA: 1s - loss: 0.2547 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.2537 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.2537 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2537 - accuracy: 0.1007
Epoch 2/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2469 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.2460 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.2450 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.2441 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.2441 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2441 - accuracy: 0.1007
Epoch 3/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2375 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.2366 - accuracy: 0.09913/5 [=================>............] - ETA: 1s - loss: 0.2356 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.2346 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.2346 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2346 - accuracy: 0.1007
Epoch 4/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2277 - accuracy: 0.10232/5 [===========>..................] - ETA: 2s - loss: 0.2267 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.2256 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.2246 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.2246 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2246 - accuracy: 0.1007
Epoch 5/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2169 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.2157 - accuracy: 0.10093/5 [=================>............] - ETA: 1s - loss: 0.2145 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.2133 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.2133 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2133 - accuracy: 0.1007
Epoch 6/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2045 - accuracy: 0.10502/5 [===========>..................] - ETA: 2s - loss: 0.2032 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.2018 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.2005 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.2004 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2004 - accuracy: 0.1007
Epoch 7/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1905 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.1889 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.1875 - accuracy: 0.10194/5 [=======================>......] - ETA: 1s - loss: 0.1859 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.1859 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.1859 - accuracy: 0.1020
Epoch 8/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1748 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.1731 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.1715 - accuracy: 0.10204/5 [=======================>......] - ETA: 1s - loss: 0.1698 - accuracy: 0.10215/5 [==============================] - ETA: 0s - loss: 0.1698 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.1698 - accuracy: 0.1020
Epoch 9/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1579 - accuracy: 0.10232/5 [===========>..................] - ETA: 2s - loss: 0.1563 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.1546 - accuracy: 0.10264/5 [=======================>......] - ETA: 1s - loss: 0.1529 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.1528 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.1528 - accuracy: 0.1020
Epoch 10/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1412 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.1395 - accuracy: 0.10263/5 [=================>............] - ETA: 1s - loss: 0.1379 - accuracy: 0.10264/5 [=======================>......] - ETA: 1s - loss: 0.1364 - accuracy: 0.10215/5 [==============================] - ETA: 0s - loss: 0.1363 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.1363 - accuracy: 0.1020
Epoch 11/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1258 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.1244 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.1230 - accuracy: 0.10224/5 [=======================>......] - ETA: 1s - loss: 0.1217 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.1217 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.1217 - accuracy: 0.1020
Epoch 12/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1131 - accuracy: 0.10472/5 [===========>..................] - ETA: 2s - loss: 0.1121 - accuracy: 0.10233/5 [=================>............] - ETA: 1s - loss: 0.1112 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.1102 - accuracy: 0.10215/5 [==============================] - ETA: 0s - loss: 0.1102 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.1102 - accuracy: 0.1020
Epoch 13/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1041 - accuracy: 0.10282/5 [===========>..................] - ETA: 2s - loss: 0.1034 - accuracy: 0.10253/5 [=================>............] - ETA: 1s - loss: 0.1028 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.1022 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.1022 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.1022 - accuracy: 0.1020
Epoch 14/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0984 - accuracy: 0.10282/5 [===========>..................] - ETA: 2s - loss: 0.0980 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0976 - accuracy: 0.10174/5 [=======================>......] - ETA: 1s - loss: 0.0972 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.0972 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0972 - accuracy: 0.1020
Epoch 15/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0949 - accuracy: 0.09812/5 [===========>..................] - ETA: 2s - loss: 0.0947 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0944 - accuracy: 0.10154/5 [=======================>......] - ETA: 1s - loss: 0.0942 - accuracy: 0.10215/5 [==============================] - ETA: 0s - loss: 0.0942 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0942 - accuracy: 0.1020
Epoch 16/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0930 - accuracy: 0.10332/5 [===========>..................] - ETA: 2s - loss: 0.0928 - accuracy: 0.10233/5 [=================>............] - ETA: 1s - loss: 0.0927 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0926 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.0926 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0926 - accuracy: 0.1020
Epoch 17/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0919 - accuracy: 0.10082/5 [===========>..................] - ETA: 2s - loss: 0.0918 - accuracy: 0.10213/5 [=================>............] - ETA: 1s - loss: 0.0917 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.0916 - accuracy: 0.10195/5 [==============================] - ETA: 0s - loss: 0.0916 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0916 - accuracy: 0.1020
Epoch 18/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0912 - accuracy: 0.09892/5 [===========>..................] - ETA: 2s - loss: 0.0912 - accuracy: 0.09813/5 [=================>............] - ETA: 1s - loss: 0.0912 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0911 - accuracy: 0.10215/5 [==============================] - ETA: 0s - loss: 0.0911 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0911 - accuracy: 0.1020
Epoch 19/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0908 - accuracy: 0.10602/5 [===========>..................] - ETA: 2s - loss: 0.0908 - accuracy: 0.10613/5 [=================>............] - ETA: 1s - loss: 0.0908 - accuracy: 0.10344/5 [=======================>......] - ETA: 1s - loss: 0.0908 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.0908 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0908 - accuracy: 0.1020
Epoch 20/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0906 - accuracy: 0.10382/5 [===========>..................] - ETA: 2s - loss: 0.0906 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0906 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0906 - accuracy: 0.10185/5 [==============================] - ETA: 0s - loss: 0.0906 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0906 - accuracy: 0.1020
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0905 - accuracy: 0.09462/3 [===================>..........] - ETA: 0s - loss: 0.0905 - accuracy: 0.09613/3 [==============================] - ETA: 0s - loss: 0.0905 - accuracy: 0.09613/3 [==============================] - 0s 104ms/step - loss: 0.0905 - accuracy: 0.0961
2021-12-07 16:16:40.059021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:16:40.059275: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:16:40.059747: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:16:40.059768: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:16:40.059786: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:16:40.059812: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:16:40.059829: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:16:40.059848: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:16:40.060659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:16:40.060688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:16:40.060695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:16:40.060700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:16:40.061453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:16:40.062082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:16:40.062109: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:16:40.062143: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:16:40.062158: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:16:40.062170: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:16:40.062181: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:16:40.062192: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:16:40.062204: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:16:40.062952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:16:40.062969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:16:40.062976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:16:40.062981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:16:40.063705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867697 0.09221499 0.10604627 0.09881505 0.12000618 0.09826346
 0.08299649 0.07698078 0.15239884 0.10409475]
 Top predictions indices: [8] vs. real classes indices: [8]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867697 0.09221601 0.10604862 0.09881691 0.12000767 0.09826442
 0.08299947 0.07698166 0.15239935 0.10409448]
 Top predictions indices: [8] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867697 0.09221599 0.10604862 0.09881691 0.12000767 0.09826442
 0.08299947 0.07698166 0.15239935 0.10409448]
 Top predictions indices: [8] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867695 0.09221502 0.10604627 0.09881505 0.1200062  0.09826346
 0.08299652 0.07698078 0.15239884 0.10409475]
 Top predictions indices: [8] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867695 0.09221599 0.1060486  0.09881691 0.12000767 0.0982644
 0.08299947 0.07698166 0.15239932 0.10409448]
 Top predictions indices: [8] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867695 0.09221601 0.1060486  0.09881691 0.12000767 0.09826442
 0.08299947 0.07698166 0.15239932 0.10409448]
 Top predictions indices: [8] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867697 0.09221502 0.10604625 0.09881502 0.12000618 0.09826346
 0.08299649 0.07698078 0.15239884 0.10409475]
 Top predictions indices: [8] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867692 0.09221502 0.1060463  0.09881506 0.1200062  0.09826346
 0.08299652 0.07698078 0.15239885 0.10409475]
 Top predictions indices: [8] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867697 0.09221499 0.10604627 0.09881505 0.12000618 0.09826346
 0.08299649 0.07698078 0.15239884 0.10409475]
 Top predictions indices: [8] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867697 0.09221502 0.10604625 0.09881502 0.12000618 0.09826346
 0.08299649 0.07698078 0.15239882 0.10409473]
 Top predictions indices: [8] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867695 0.09221599 0.1060486  0.09881689 0.12000764 0.0982644
 0.08299941 0.07698164 0.15239932 0.10409448]
 Top predictions indices: [8] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867697 0.09221599 0.10604862 0.09881691 0.12000764 0.09826442
 0.08299947 0.07698166 0.15239935 0.10409448]
 Top predictions indices: [8] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867697 0.09221601 0.10604862 0.09881691 0.12000767 0.09826442
 0.08299947 0.07698166 0.15239935 0.10409448]
 Top predictions indices: [8] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867692 0.09221502 0.1060463  0.09881506 0.1200062  0.09826346
 0.08299652 0.07698078 0.15239884 0.10409475]
 Top predictions indices: [8] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [8 0 4 2 9 3 5 1 6 7] pred: [0.12867697 0.09221601 0.10604862 0.09881691 0.12000767 0.09826442
 0.08299947 0.07698166 0.15239935 0.10409448]
 Top predictions indices: [8] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Exécution 4 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 20)                3720      
_________________________________________________________________
dense_4 (Dense)              (None, 10)                210       
=================================================================
Total params: 6,430
Trainable params: 6,430
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2515 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.2506 - accuracy: 0.10423/5 [=================>............] - ETA: 1s - loss: 0.2498 - accuracy: 0.10224/5 [=======================>......] - ETA: 1s - loss: 0.2489 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.2489 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2489 - accuracy: 0.1007
Epoch 2/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2430 - accuracy: 0.10002/5 [===========>..................] - ETA: 2s - loss: 0.2422 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.2413 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.2405 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.2404 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2404 - accuracy: 0.1007
Epoch 3/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2344 - accuracy: 0.10292/5 [===========>..................] - ETA: 2s - loss: 0.2335 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.2326 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.2317 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.2316 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2316 - accuracy: 0.1007
Epoch 4/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2250 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.2240 - accuracy: 0.09803/5 [=================>............] - ETA: 1s - loss: 0.2230 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.2219 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.2218 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2218 - accuracy: 0.1007
Epoch 5/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2144 - accuracy: 0.10342/5 [===========>..................] - ETA: 2s - loss: 0.2132 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.2120 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.2108 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.2107 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2107 - accuracy: 0.1007
Epoch 6/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2021 - accuracy: 0.09882/5 [===========>..................] - ETA: 2s - loss: 0.2007 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.1995 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.1981 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.1981 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.1981 - accuracy: 0.1007
Epoch 7/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1883 - accuracy: 0.10182/5 [===========>..................] - ETA: 2s - loss: 0.1870 - accuracy: 0.10153/5 [=================>............] - ETA: 1s - loss: 0.1855 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.1841 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.1840 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.1840 - accuracy: 0.1007
Epoch 8/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1736 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.1722 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.1706 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.1691 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.1690 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.1690 - accuracy: 0.1012
Epoch 9/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1583 - accuracy: 0.10402/5 [===========>..................] - ETA: 2s - loss: 0.1570 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.1555 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.1540 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.1539 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.1539 - accuracy: 0.1010
Epoch 10/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1440 - accuracy: 0.09582/5 [===========>..................] - ETA: 2s - loss: 0.1426 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.1412 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.1399 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.1398 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.1398 - accuracy: 0.1010
Epoch 11/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1309 - accuracy: 0.10012/5 [===========>..................] - ETA: 2s - loss: 0.1299 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.1288 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.1276 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.1276 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.1276 - accuracy: 0.1010
Epoch 12/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1204 - accuracy: 0.09942/5 [===========>..................] - ETA: 2s - loss: 0.1195 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.1186 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.1178 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.1178 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.1178 - accuracy: 0.1010
Epoch 13/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1124 - accuracy: 0.09672/5 [===========>..................] - ETA: 2s - loss: 0.1117 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.1111 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.1104 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.1103 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.1103 - accuracy: 0.1010
Epoch 14/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1062 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.1056 - accuracy: 0.10343/5 [=================>............] - ETA: 1s - loss: 0.1052 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.1048 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.1048 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.1048 - accuracy: 0.1010
Epoch 15/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1019 - accuracy: 0.10142/5 [===========>..................] - ETA: 2s - loss: 0.1016 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.1012 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.1009 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.1009 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.1009 - accuracy: 0.1010
Epoch 16/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0985 - accuracy: 0.10642/5 [===========>..................] - ETA: 2s - loss: 0.0984 - accuracy: 0.10333/5 [=================>............] - ETA: 1s - loss: 0.0983 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0981 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0981 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0981 - accuracy: 0.1010
Epoch 17/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0966 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.0965 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.0963 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0961 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.0961 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0961 - accuracy: 0.1010
Epoch 18/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0948 - accuracy: 0.10992/5 [===========>..................] - ETA: 2s - loss: 0.0948 - accuracy: 0.10413/5 [=================>............] - ETA: 1s - loss: 0.0948 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.0947 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0947 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0947 - accuracy: 0.1010
Epoch 19/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0939 - accuracy: 0.10472/5 [===========>..................] - ETA: 2s - loss: 0.0939 - accuracy: 0.10263/5 [=================>............] - ETA: 1s - loss: 0.0938 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.0937 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.0937 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0937 - accuracy: 0.1010
Epoch 20/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0931 - accuracy: 0.10692/5 [===========>..................] - ETA: 2s - loss: 0.0931 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0930 - accuracy: 0.10284/5 [=======================>......] - ETA: 1s - loss: 0.0930 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.0930 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0930 - accuracy: 0.1010
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08dbc46320> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0926 - accuracy: 0.09972/3 [===================>..........] - ETA: 0s - loss: 0.0927 - accuracy: 0.09863/3 [==============================] - ETA: 0s - loss: 0.0927 - accuracy: 0.09803/3 [==============================] - 0s 102ms/step - loss: 0.0927 - accuracy: 0.0980
2021-12-07 16:20:40.277185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:20:40.277566: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:20:40.277681: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:20:40.277698: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:20:40.277715: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:20:40.277730: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:20:40.277744: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:20:40.277762: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:20:40.278580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:20:40.278608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:20:40.278615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:20:40.278620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:20:40.279393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:20:40.280199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:20:40.280227: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:20:40.280261: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:20:40.280276: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:20:40.280288: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:20:40.280299: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:20:40.280311: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:20:40.280322: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:20:40.281074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:20:40.281093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:20:40.281100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:20:40.281105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:20:40.281832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240086 0.06312796 0.13438067 0.20965101 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981441]
 Top predictions indices: [4] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240081 0.06312796 0.13438065 0.20965096 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981443]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240086 0.06312796 0.13438067 0.20965096 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981441]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240081 0.06312796 0.13438065 0.20965096 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981443]
 Top predictions indices: [4] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240081 0.06312796 0.13438064 0.20965096 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981443]
 Top predictions indices: [4] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240081 0.06312796 0.13438065 0.20965096 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981443]
 Top predictions indices: [4] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240084 0.06312796 0.13438065 0.20965101 0.0711017
 0.09358005 0.14832969 0.11093452 0.17981441]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240081 0.06312796 0.13438065 0.20965096 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981443]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240081 0.06312796 0.13438065 0.20965096 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981443]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240081 0.06312796 0.13438065 0.20965101 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981443]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240084 0.06312796 0.13438065 0.20965096 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981443]
 Top predictions indices: [4] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240086 0.06312796 0.13438067 0.20965096 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981441]
 Top predictions indices: [4] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240084 0.06312796 0.13438065 0.20965101 0.0711017
 0.09358005 0.14832969 0.11093452 0.17981441]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240081 0.06312796 0.13438065 0.20965101 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981443]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [4 9 7 3 8 6 1 5 2 0] pred: [0.05724149 0.09240081 0.06312796 0.13438065 0.20965096 0.07110167
 0.09358004 0.14832969 0.11093452 0.17981443]
 Top predictions indices: [4] vs. real classes indices: [7]
Jaccard Score: 0.0
 
Exécution 5 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 20)                3720      
_________________________________________________________________
dense_5 (Dense)              (None, 10)                210       
=================================================================
Total params: 6,430
Trainable params: 6,430
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2506 - accuracy: 0.09612/5 [===========>..................] - ETA: 2s - loss: 0.2498 - accuracy: 0.09753/5 [=================>............] - ETA: 1s - loss: 0.2490 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.2481 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.2481 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.2481 - accuracy: 0.1000
Epoch 2/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2424 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.2416 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.2408 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.2400 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.2400 - accuracy: 0.10085/5 [==============================] - 5s 1s/step - loss: 0.2400 - accuracy: 0.1008
Epoch 3/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2341 - accuracy: 0.10362/5 [===========>..................] - ETA: 2s - loss: 0.2333 - accuracy: 0.10233/5 [=================>............] - ETA: 1s - loss: 0.2324 - accuracy: 0.10154/5 [=======================>......] - ETA: 1s - loss: 0.2315 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.2315 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.2315 - accuracy: 0.0996
Epoch 4/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2251 - accuracy: 0.09862/5 [===========>..................] - ETA: 2s - loss: 0.2241 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.2231 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.2221 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.2220 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.2220 - accuracy: 0.0996
Epoch 5/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2147 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.2137 - accuracy: 0.09653/5 [=================>............] - ETA: 1s - loss: 0.2124 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.2113 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.2112 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.2112 - accuracy: 0.0996
Epoch 6/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2028 - accuracy: 0.09682/5 [===========>..................] - ETA: 2s - loss: 0.2015 - accuracy: 0.09893/5 [=================>............] - ETA: 1s - loss: 0.2002 - accuracy: 0.09914/5 [=======================>......] - ETA: 1s - loss: 0.1989 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.1988 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1988 - accuracy: 0.0996
Epoch 7/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1892 - accuracy: 0.10362/5 [===========>..................] - ETA: 2s - loss: 0.1877 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.1864 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.1849 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.1849 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1849 - accuracy: 0.0996
Epoch 8/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1745 - accuracy: 0.10222/5 [===========>..................] - ETA: 2s - loss: 0.1729 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.1713 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.1698 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.1698 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1698 - accuracy: 0.0996
Epoch 9/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1589 - accuracy: 0.10002/5 [===========>..................] - ETA: 2s - loss: 0.1573 - accuracy: 0.09893/5 [=================>............] - ETA: 1s - loss: 0.1558 - accuracy: 0.09834/5 [=======================>......] - ETA: 1s - loss: 0.1543 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.1542 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1542 - accuracy: 0.0996
Epoch 10/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1435 - accuracy: 0.10422/5 [===========>..................] - ETA: 2s - loss: 0.1421 - accuracy: 0.09933/5 [=================>............] - ETA: 1s - loss: 0.1407 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.1393 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.1393 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1393 - accuracy: 0.0996
Epoch 11/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1296 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.1284 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.1272 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.1260 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.1259 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1259 - accuracy: 0.0996
Epoch 12/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1180 - accuracy: 0.09612/5 [===========>..................] - ETA: 2s - loss: 0.1169 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.1159 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.1150 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.1150 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1150 - accuracy: 0.0996
Epoch 13/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1089 - accuracy: 0.09802/5 [===========>..................] - ETA: 2s - loss: 0.1084 - accuracy: 0.09583/5 [=================>............] - ETA: 1s - loss: 0.1075 - accuracy: 0.09784/5 [=======================>......] - ETA: 1s - loss: 0.1068 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.1067 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1067 - accuracy: 0.0996
Epoch 14/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1024 - accuracy: 0.10332/5 [===========>..................] - ETA: 2s - loss: 0.1019 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.1014 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.1010 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.1010 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1010 - accuracy: 0.0996
Epoch 15/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0981 - accuracy: 0.09292/5 [===========>..................] - ETA: 2s - loss: 0.0978 - accuracy: 0.09643/5 [=================>............] - ETA: 1s - loss: 0.0975 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.0972 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0972 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0972 - accuracy: 0.0996
Epoch 16/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0955 - accuracy: 0.09892/5 [===========>..................] - ETA: 2s - loss: 0.0951 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0950 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0948 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0948 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0948 - accuracy: 0.0996
Epoch 17/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0938 - accuracy: 0.09242/5 [===========>..................] - ETA: 2s - loss: 0.0936 - accuracy: 0.09643/5 [=================>............] - ETA: 1s - loss: 0.0935 - accuracy: 0.09714/5 [=======================>......] - ETA: 1s - loss: 0.0933 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0933 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0933 - accuracy: 0.0996
Epoch 18/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0927 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.0925 - accuracy: 0.09833/5 [=================>............] - ETA: 1s - loss: 0.0924 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0923 - accuracy: 0.09935/5 [==============================] - ETA: 0s - loss: 0.0923 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0923 - accuracy: 0.0996
Epoch 19/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0919 - accuracy: 0.09852/5 [===========>..................] - ETA: 2s - loss: 0.0919 - accuracy: 0.09853/5 [=================>............] - ETA: 1s - loss: 0.0917 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.0917 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0917 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0917 - accuracy: 0.0996
Epoch 20/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0913 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.0913 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.0913 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0913 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0913 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0913 - accuracy: 0.0996
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08dc8127a0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0911 - accuracy: 0.09812/3 [===================>..........] - ETA: 0s - loss: 0.0911 - accuracy: 0.10093/3 [==============================] - ETA: 0s - loss: 0.0911 - accuracy: 0.10073/3 [==============================] - 0s 107ms/step - loss: 0.0911 - accuracy: 0.1007
2021-12-07 16:24:40.558148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:24:40.558417: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:24:40.558842: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:24:40.558863: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:24:40.558879: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:24:40.558906: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:24:40.558921: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:24:40.558938: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:24:40.559729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:24:40.559759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:24:40.559765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:24:40.559771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:24:40.560541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:24:40.561367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:24:40.561395: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:24:40.561434: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:24:40.561446: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:24:40.561460: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:24:40.561472: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:24:40.561483: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:24:40.561494: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:24:40.562301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:24:40.562318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:24:40.562325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:24:40.562330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:24:40.563111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357149 0.1214892  0.10184054 0.14738138 0.09154747 0.07543284
 0.12085909 0.0665341  0.1577718  0.13419722]
 Top predictions indices: [8] vs. real classes indices: [8]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357155 0.12148923 0.10184054 0.1473814  0.09154752 0.07543282
 0.12085908 0.06653412 0.1577718  0.13419724]
 Top predictions indices: [8] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357149 0.1214892  0.10184054 0.14738138 0.09154747 0.07543284
 0.12085909 0.0665341  0.1577718  0.13419722]
 Top predictions indices: [8] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357149 0.1214892  0.10184054 0.14738138 0.09154747 0.07543284
 0.12085909 0.0665341  0.1577718  0.13419722]
 Top predictions indices: [8] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357149 0.1214892  0.10184054 0.14738138 0.09154747 0.07543284
 0.1208591  0.0665341  0.1577718  0.13419722]
 Top predictions indices: [8] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357149 0.1214892  0.10184054 0.14738138 0.09154747 0.07543284
 0.12085909 0.0665341  0.1577718  0.13419722]
 Top predictions indices: [8] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357149 0.1214892  0.10184054 0.14738138 0.09154747 0.07543284
 0.1208591  0.0665341  0.1577718  0.13419722]
 Top predictions indices: [8] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357155 0.12148923 0.10184054 0.1473814  0.09154752 0.07543282
 0.1208591  0.06653412 0.1577718  0.13419724]
 Top predictions indices: [8] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357155 0.12148923 0.10184054 0.1473814  0.09154752 0.07543282
 0.1208591  0.06653412 0.1577718  0.13419724]
 Top predictions indices: [8] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357149 0.1214892  0.10184054 0.14738138 0.09154747 0.07543284
 0.12085909 0.0665341  0.1577718  0.13419722]
 Top predictions indices: [8] vs. real classes indices: [8]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357155 0.12148923 0.10184054 0.1473814  0.09154752 0.07543282
 0.1208591  0.06653412 0.1577718  0.13419724]
 Top predictions indices: [8] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357155 0.12148923 0.10184054 0.1473814  0.09154752 0.07543282
 0.1208591  0.06653412 0.1577718  0.13419724]
 Top predictions indices: [8] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357149 0.1214892  0.10184054 0.14738138 0.09154747 0.07543284
 0.12085909 0.0665341  0.1577718  0.13419722]
 Top predictions indices: [8] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357149 0.1214892  0.10184054 0.14738138 0.09154747 0.07543284
 0.12085909 0.0665341  0.1577718  0.13419722]
 Top predictions indices: [8] vs. real classes indices: [8]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [8 3 9 0 1 6 2 4 5 7] pred: [0.13357149 0.1214892  0.10184054 0.14738138 0.09154747 0.07543284
 0.12085909 0.0665341  0.1577718  0.13419722]
 Top predictions indices: [8] vs. real classes indices: [7]
Jaccard Score: 0.0
 
Exécution 6 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 20)                3720      
_________________________________________________________________
dense_6 (Dense)              (None, 10)                210       
=================================================================
Total params: 6,430
Trainable params: 6,430
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2478 - accuracy: 0.10252/5 [===========>..................] - ETA: 2s - loss: 0.2469 - accuracy: 0.10333/5 [=================>............] - ETA: 1s - loss: 0.2460 - accuracy: 0.10194/5 [=======================>......] - ETA: 1s - loss: 0.2451 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.2451 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.2451 - accuracy: 0.1007
Epoch 2/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2386 - accuracy: 0.10332/5 [===========>..................] - ETA: 2s - loss: 0.2377 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.2367 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.2358 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.2357 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.2357 - accuracy: 0.0996
Epoch 3/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2288 - accuracy: 0.09842/5 [===========>..................] - ETA: 2s - loss: 0.2277 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.2267 - accuracy: 0.10204/5 [=======================>......] - ETA: 1s - loss: 0.2256 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.2256 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.2256 - accuracy: 0.0996
Epoch 4/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2179 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.2167 - accuracy: 0.09793/5 [=================>............] - ETA: 1s - loss: 0.2155 - accuracy: 0.09794/5 [=======================>......] - ETA: 1s - loss: 0.2143 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.2142 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.2142 - accuracy: 0.0996
Epoch 5/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2055 - accuracy: 0.09532/5 [===========>..................] - ETA: 2s - loss: 0.2041 - accuracy: 0.09903/5 [=================>............] - ETA: 1s - loss: 0.2027 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.2013 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.2013 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.2013 - accuracy: 0.0996
Epoch 6/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1913 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.1897 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.1882 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.1866 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.1866 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1866 - accuracy: 0.0996
Epoch 7/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1754 - accuracy: 0.10252/5 [===========>..................] - ETA: 2s - loss: 0.1737 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.1721 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.1704 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.1703 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1703 - accuracy: 0.0996
Epoch 8/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1584 - accuracy: 0.10182/5 [===========>..................] - ETA: 2s - loss: 0.1567 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.1550 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.1533 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.1532 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1532 - accuracy: 0.0996
Epoch 9/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1412 - accuracy: 0.10622/5 [===========>..................] - ETA: 2s - loss: 0.1397 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.1381 - accuracy: 0.09954/5 [=======================>......] - ETA: 1s - loss: 0.1365 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.1365 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.1365 - accuracy: 0.0999
Epoch 10/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1258 - accuracy: 0.09892/5 [===========>..................] - ETA: 2s - loss: 0.1244 - accuracy: 0.09963/5 [=================>............] - ETA: 1s - loss: 0.1230 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.1216 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.1216 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.1216 - accuracy: 0.1004
Epoch 11/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1129 - accuracy: 0.10242/5 [===========>..................] - ETA: 2s - loss: 0.1119 - accuracy: 0.10073/5 [=================>............] - ETA: 1s - loss: 0.1109 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.1099 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.1099 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.1099 - accuracy: 0.1004
Epoch 12/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1038 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.1031 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.1025 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.1018 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.1018 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.1018 - accuracy: 0.1004
Epoch 13/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0979 - accuracy: 0.10002/5 [===========>..................] - ETA: 2s - loss: 0.0975 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0971 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.0968 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0967 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0967 - accuracy: 0.1004
Epoch 14/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0946 - accuracy: 0.09682/5 [===========>..................] - ETA: 2s - loss: 0.0944 - accuracy: 0.09583/5 [=================>............] - ETA: 1s - loss: 0.0941 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.0939 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0938 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0938 - accuracy: 0.1004
Epoch 15/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0926 - accuracy: 0.10382/5 [===========>..................] - ETA: 2s - loss: 0.0925 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0924 - accuracy: 0.10004/5 [=======================>......] - ETA: 1s - loss: 0.0923 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0923 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0923 - accuracy: 0.1004
Epoch 16/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0915 - accuracy: 0.10622/5 [===========>..................] - ETA: 2s - loss: 0.0915 - accuracy: 0.10313/5 [=================>............] - ETA: 1s - loss: 0.0915 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0914 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0914 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0914 - accuracy: 0.1004
Epoch 17/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0912 - accuracy: 0.09812/5 [===========>..................] - ETA: 2s - loss: 0.0910 - accuracy: 0.10013/5 [=================>............] - ETA: 1s - loss: 0.0910 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0909 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0909 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0909 - accuracy: 0.1004
Epoch 18/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0907 - accuracy: 0.10142/5 [===========>..................] - ETA: 2s - loss: 0.0907 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0907 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0907 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0907 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0907 - accuracy: 0.1004
Epoch 19/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0906 - accuracy: 0.09862/5 [===========>..................] - ETA: 2s - loss: 0.0905 - accuracy: 0.10043/5 [=================>............] - ETA: 1s - loss: 0.0905 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0905 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.0905 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0905 - accuracy: 0.1004
Epoch 20/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0905 - accuracy: 0.10142/5 [===========>..................] - ETA: 2s - loss: 0.0905 - accuracy: 0.09853/5 [=================>............] - ETA: 1s - loss: 0.0904 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0904 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0904 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0904 - accuracy: 0.1004
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08dd1b9560> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0904 - accuracy: 0.09692/3 [===================>..........] - ETA: 0s - loss: 0.0903 - accuracy: 0.09903/3 [==============================] - ETA: 0s - loss: 0.0903 - accuracy: 0.09933/3 [==============================] - 0s 111ms/step - loss: 0.0903 - accuracy: 0.0993
2021-12-07 16:28:41.118878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:28:41.119256: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:28:41.119695: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:28:41.119715: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:28:41.119732: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:28:41.119756: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:28:41.119772: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:28:41.119790: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:28:41.120606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:28:41.120634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:28:41.120641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:28:41.120646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:28:41.121395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:28:41.122063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:28:41.122116: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:28:41.122148: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:28:41.122160: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:28:41.122175: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:28:41.122187: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:28:41.122198: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:28:41.122209: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:28:41.122970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:28:41.122990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:28:41.122996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:28:41.123002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:28:41.123789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306003 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.1145196  0.13172092 0.09812345 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306003 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.1145196  0.13172092 0.09812345 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306006 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.11451965 0.13172093 0.09812347 0.12528148]
 Top predictions indices: [7] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306006 0.08655909 0.11250652 0.10221631 0.09360906 0.0653032
 0.11451965 0.13172095 0.09812347 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306003 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.1145196  0.13172092 0.09812345 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306006 0.08655909 0.11250652 0.10221631 0.09360906 0.0653032
 0.11451965 0.13172093 0.09812347 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306006 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.11451962 0.13172092 0.09812347 0.12528148]
 Top predictions indices: [7] vs. real classes indices: [7]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306003 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.1145196  0.13172092 0.09812345 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306003 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.1145196  0.13172092 0.09812345 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306006 0.08655911 0.11250652 0.10221631 0.09360906 0.0653032
 0.11451965 0.13172095 0.09812347 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306003 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.1145196  0.13172092 0.09812345 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306003 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.1145196  0.13172092 0.09812345 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306003 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.1145196  0.13172092 0.09812345 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306003 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.1145196  0.13172092 0.09812345 0.12528145]
 Top predictions indices: [7] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [7 9 6 2 3 8 4 0 1 5] pred: [0.09306003 0.08655909 0.11250652 0.10221628 0.09360906 0.0653032
 0.11451962 0.13172092 0.09812345 0.12528148]
 Top predictions indices: [7] vs. real classes indices: [5]
Jaccard Score: 0.0
 
Exécution 7 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 20)                3720      
_________________________________________________________________
dense_7 (Dense)              (None, 10)                210       
=================================================================
Total params: 6,430
Trainable params: 6,430
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2513 - accuracy: 0.09592/5 [===========>..................] - ETA: 2s - loss: 0.2504 - accuracy: 0.09903/5 [=================>............] - ETA: 1s - loss: 0.2495 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.2487 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.2486 - accuracy: 0.10055/5 [==============================] - 5s 1s/step - loss: 0.2486 - accuracy: 0.1005
Epoch 2/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2428 - accuracy: 0.09302/5 [===========>..................] - ETA: 2s - loss: 0.2420 - accuracy: 0.09493/5 [=================>............] - ETA: 1s - loss: 0.2411 - accuracy: 0.09814/5 [=======================>......] - ETA: 1s - loss: 0.2403 - accuracy: 0.09865/5 [==============================] - ETA: 0s - loss: 0.2403 - accuracy: 0.09885/5 [==============================] - 5s 1s/step - loss: 0.2403 - accuracy: 0.0988
Epoch 3/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2344 - accuracy: 0.09912/5 [===========>..................] - ETA: 2s - loss: 0.2336 - accuracy: 0.09613/5 [=================>............] - ETA: 1s - loss: 0.2327 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.2318 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.2318 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.2318 - accuracy: 0.0998
Epoch 4/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2255 - accuracy: 0.09782/5 [===========>..................] - ETA: 2s - loss: 0.2246 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.2236 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.2227 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.2226 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.2226 - accuracy: 0.0998
Epoch 5/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2156 - accuracy: 0.09672/5 [===========>..................] - ETA: 2s - loss: 0.2145 - accuracy: 0.09803/5 [=================>............] - ETA: 1s - loss: 0.2134 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.2123 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.2123 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.2123 - accuracy: 0.0998
Epoch 6/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2043 - accuracy: 0.10142/5 [===========>..................] - ETA: 2s - loss: 0.2031 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.2018 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.2005 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.2004 - accuracy: 0.10165/5 [==============================] - 5s 1s/step - loss: 0.2004 - accuracy: 0.1016
Epoch 7/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1914 - accuracy: 0.10352/5 [===========>..................] - ETA: 2s - loss: 0.1900 - accuracy: 0.09873/5 [=================>............] - ETA: 1s - loss: 0.1885 - accuracy: 0.09874/5 [=======================>......] - ETA: 1s - loss: 0.1870 - accuracy: 0.09835/5 [==============================] - ETA: 0s - loss: 0.1870 - accuracy: 0.09835/5 [==============================] - 5s 1s/step - loss: 0.1870 - accuracy: 0.0983
Epoch 8/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1767 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.1752 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.1737 - accuracy: 0.09764/5 [=======================>......] - ETA: 1s - loss: 0.1722 - accuracy: 0.09845/5 [==============================] - ETA: 0s - loss: 0.1721 - accuracy: 0.09855/5 [==============================] - 5s 1s/step - loss: 0.1721 - accuracy: 0.0985
Epoch 9/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1614 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.1598 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.1582 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.1566 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.1566 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.1566 - accuracy: 0.1009
Epoch 10/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1459 - accuracy: 0.10082/5 [===========>..................] - ETA: 2s - loss: 0.1445 - accuracy: 0.09983/5 [=================>............] - ETA: 1s - loss: 0.1430 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.1416 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.1415 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.1415 - accuracy: 0.1009
Epoch 11/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1322 - accuracy: 0.09442/5 [===========>..................] - ETA: 2s - loss: 0.1307 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.1295 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.1283 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.1283 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.1283 - accuracy: 0.1009
Epoch 12/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1204 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.1195 - accuracy: 0.09913/5 [=================>............] - ETA: 1s - loss: 0.1186 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.1176 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.1176 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.1176 - accuracy: 0.1009
Epoch 13/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1115 - accuracy: 0.10442/5 [===========>..................] - ETA: 2s - loss: 0.1109 - accuracy: 0.10263/5 [=================>............] - ETA: 1s - loss: 0.1102 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.1095 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.1095 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.1095 - accuracy: 0.1009
Epoch 14/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1055 - accuracy: 0.09912/5 [===========>..................] - ETA: 2s - loss: 0.1046 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.1041 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.1037 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.1037 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.1037 - accuracy: 0.1009
Epoch 15/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1004 - accuracy: 0.10332/5 [===========>..................] - ETA: 2s - loss: 0.1003 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.1000 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0997 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0997 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0997 - accuracy: 0.1009
Epoch 16/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0973 - accuracy: 0.10402/5 [===========>..................] - ETA: 2s - loss: 0.0972 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0971 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0969 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.0969 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0969 - accuracy: 0.1009
Epoch 17/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0956 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.0953 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0952 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0950 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0950 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0950 - accuracy: 0.1009
Epoch 18/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0942 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.0940 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0939 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0938 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0938 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0938 - accuracy: 0.1009
Epoch 19/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0931 - accuracy: 0.10142/5 [===========>..................] - ETA: 2s - loss: 0.0930 - accuracy: 0.10253/5 [=================>............] - ETA: 1s - loss: 0.0930 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0929 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.0929 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0929 - accuracy: 0.1009
Epoch 20/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0926 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.0925 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0923 - accuracy: 0.10194/5 [=======================>......] - ETA: 1s - loss: 0.0923 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.0923 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0923 - accuracy: 0.1009
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08de58c9e0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0920 - accuracy: 0.09732/3 [===================>..........] - ETA: 0s - loss: 0.0919 - accuracy: 0.09833/3 [==============================] - ETA: 0s - loss: 0.0919 - accuracy: 0.09833/3 [==============================] - 0s 105ms/step - loss: 0.0919 - accuracy: 0.0983
2021-12-07 16:32:41.846297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:32:41.846600: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:32:41.847045: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:32:41.847064: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:32:41.847082: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:32:41.847098: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:32:41.847122: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:32:41.847141: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:32:41.847932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:32:41.847959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:32:41.847966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:32:41.847971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:32:41.848755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:32:41.849413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:32:41.849439: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:32:41.849473: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:32:41.849485: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:32:41.849497: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:32:41.849549: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:32:41.849562: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:32:41.849574: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:32:41.850309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:32:41.850327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:32:41.850334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:32:41.850339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:32:41.851065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218879 0.09657095 0.067862   0.15871544 0.0627327  0.15925628
 0.10108848 0.1932774  0.07376565 0.13066562]
 Top predictions indices: [7] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218879 0.09657095 0.067862   0.15871544 0.0627327  0.15925631
 0.10108848 0.1932774  0.07376565 0.13066562]
 Top predictions indices: [7] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218886 0.09657099 0.06786209 0.15871546 0.06273275 0.15925637
 0.10108855 0.19327745 0.07376573 0.13066572]
 Top predictions indices: [7] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218879 0.09657095 0.067862   0.15871544 0.0627327  0.15925628
 0.10108848 0.1932774  0.07376565 0.13066562]
 Top predictions indices: [7] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218879 0.09657095 0.067862   0.15871544 0.0627327  0.15925628
 0.10108848 0.1932774  0.07376565 0.13066562]
 Top predictions indices: [7] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218879 0.09657095 0.067862   0.15871544 0.0627327  0.15925631
 0.10108848 0.1932774  0.07376565 0.13066562]
 Top predictions indices: [7] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218879 0.09657095 0.067862   0.15871544 0.0627327  0.15925631
 0.10108848 0.1932774  0.07376567 0.13066562]
 Top predictions indices: [7] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218879 0.09657095 0.067862   0.15871544 0.0627327  0.15925631
 0.10108848 0.1932774  0.07376565 0.13066562]
 Top predictions indices: [7] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218879 0.09657095 0.067862   0.15871544 0.0627327  0.15925628
 0.10108848 0.1932774  0.07376565 0.13066562]
 Top predictions indices: [7] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218879 0.09657095 0.067862   0.15871544 0.0627327  0.15925628
 0.10108848 0.1932774  0.07376565 0.13066562]
 Top predictions indices: [7] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218888 0.09657099 0.06786209 0.15871546 0.06273276 0.15925638
 0.10108855 0.19327748 0.07376575 0.13066572]
 Top predictions indices: [7] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218888 0.09657099 0.06786209 0.15871546 0.06273276 0.15925638
 0.10108855 0.19327748 0.07376575 0.13066572]
 Top predictions indices: [7] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218886 0.09657099 0.06786209 0.15871546 0.06273275 0.15925637
 0.10108855 0.19327745 0.07376573 0.13066572]
 Top predictions indices: [7] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218879 0.09657095 0.067862   0.15871544 0.0627327  0.15925628
 0.10108848 0.1932774  0.07376565 0.13066562]
 Top predictions indices: [7] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [7 5 3 9 0 6 1 8 2 4] pred: [0.10218879 0.09657095 0.067862   0.15871544 0.0627327  0.15925631
 0.10108848 0.1932774  0.07376565 0.13066562]
 Top predictions indices: [7] vs. real classes indices: [9]
Jaccard Score: 0.0
 
Exécution 8 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 20)                3720      
_________________________________________________________________
dense_8 (Dense)              (None, 10)                210       
=================================================================
Total params: 6,430
Trainable params: 6,430
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2471 - accuracy: 0.10232/5 [===========>..................] - ETA: 2s - loss: 0.2464 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.2456 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.2448 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.2448 - accuracy: 0.10055/5 [==============================] - 5s 1s/step - loss: 0.2448 - accuracy: 0.1005
Epoch 2/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2393 - accuracy: 0.09632/5 [===========>..................] - ETA: 2s - loss: 0.2384 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.2376 - accuracy: 0.09954/5 [=======================>......] - ETA: 1s - loss: 0.2368 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.2367 - accuracy: 0.10055/5 [==============================] - 5s 1s/step - loss: 0.2367 - accuracy: 0.1005
Epoch 3/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2307 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.2297 - accuracy: 0.09913/5 [=================>............] - ETA: 1s - loss: 0.2288 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.2278 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.2278 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.2278 - accuracy: 0.1000
Epoch 4/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2207 - accuracy: 0.09692/5 [===========>..................] - ETA: 2s - loss: 0.2196 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.2185 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.2174 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.2173 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.2173 - accuracy: 0.0999
Epoch 5/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2090 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.2078 - accuracy: 0.10003/5 [=================>............] - ETA: 1s - loss: 0.2065 - accuracy: 0.09954/5 [=======================>......] - ETA: 1s - loss: 0.2051 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.2051 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.2051 - accuracy: 0.0999
Epoch 6/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1953 - accuracy: 0.10512/5 [===========>..................] - ETA: 2s - loss: 0.1939 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.1924 - accuracy: 0.10004/5 [=======================>......] - ETA: 1s - loss: 0.1909 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.1909 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.1909 - accuracy: 0.0999
Epoch 7/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1799 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.1783 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.1767 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.1750 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.1750 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.1750 - accuracy: 0.0999
Epoch 8/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1633 - accuracy: 0.09692/5 [===========>..................] - ETA: 2s - loss: 0.1615 - accuracy: 0.10273/5 [=================>............] - ETA: 1s - loss: 0.1598 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.1581 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.1581 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.1581 - accuracy: 0.0999
Epoch 9/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1466 - accuracy: 0.09792/5 [===========>..................] - ETA: 2s - loss: 0.1448 - accuracy: 0.09893/5 [=================>............] - ETA: 1s - loss: 0.1432 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.1415 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.1414 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.1414 - accuracy: 0.0999
Epoch 10/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1309 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.1293 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.1280 - accuracy: 0.10004/5 [=======================>......] - ETA: 1s - loss: 0.1267 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.1266 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.1266 - accuracy: 0.0999
Epoch 11/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1179 - accuracy: 0.10582/5 [===========>..................] - ETA: 2s - loss: 0.1168 - accuracy: 0.10213/5 [=================>............] - ETA: 1s - loss: 0.1157 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.1148 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.1148 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.1148 - accuracy: 0.0999
Epoch 12/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1083 - accuracy: 0.09862/5 [===========>..................] - ETA: 2s - loss: 0.1078 - accuracy: 0.09783/5 [=================>............] - ETA: 1s - loss: 0.1070 - accuracy: 0.09874/5 [=======================>......] - ETA: 1s - loss: 0.1063 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.1062 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.1062 - accuracy: 0.0999
Epoch 13/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1021 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.1015 - accuracy: 0.09883/5 [=================>............] - ETA: 1s - loss: 0.1010 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.1005 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.1005 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.1005 - accuracy: 0.0999
Epoch 14/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0975 - accuracy: 0.10242/5 [===========>..................] - ETA: 2s - loss: 0.0973 - accuracy: 0.10153/5 [=================>............] - ETA: 1s - loss: 0.0971 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.0968 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0968 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0968 - accuracy: 0.0999
Epoch 15/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0951 - accuracy: 0.10182/5 [===========>..................] - ETA: 2s - loss: 0.0949 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0947 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.0945 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0945 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0945 - accuracy: 0.0999
Epoch 16/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0934 - accuracy: 0.09752/5 [===========>..................] - ETA: 2s - loss: 0.0934 - accuracy: 0.09663/5 [=================>............] - ETA: 1s - loss: 0.0933 - accuracy: 0.09914/5 [=======================>......] - ETA: 1s - loss: 0.0931 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0931 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0931 - accuracy: 0.0999
Epoch 17/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0923 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0924 - accuracy: 0.09963/5 [=================>............] - ETA: 1s - loss: 0.0923 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.0923 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0922 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0922 - accuracy: 0.0999
Epoch 18/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0918 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0918 - accuracy: 0.09963/5 [=================>............] - ETA: 1s - loss: 0.0917 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.0917 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0917 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0917 - accuracy: 0.0999
Epoch 19/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0914 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0914 - accuracy: 0.10153/5 [=================>............] - ETA: 1s - loss: 0.0913 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0913 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0913 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0913 - accuracy: 0.0999
Epoch 20/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0912 - accuracy: 0.09742/5 [===========>..................] - ETA: 2s - loss: 0.0911 - accuracy: 0.09913/5 [=================>............] - ETA: 1s - loss: 0.0911 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0911 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0910 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0910 - accuracy: 0.0999
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08df8687a0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0909 - accuracy: 0.10462/3 [===================>..........] - ETA: 0s - loss: 0.0909 - accuracy: 0.10043/3 [==============================] - ETA: 0s - loss: 0.0909 - accuracy: 0.10023/3 [==============================] - 0s 104ms/step - loss: 0.0909 - accuracy: 0.1002
2021-12-07 16:36:43.649288: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:36:43.649609: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:36:43.649722: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:36:43.649738: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:36:43.649755: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:36:43.649769: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:36:43.649783: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:36:43.649800: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:36:43.650595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:36:43.650624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:36:43.650630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:36:43.650636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:36:43.651381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:36:43.652190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:36:43.652217: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:36:43.652252: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:36:43.652264: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:36:43.652275: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:36:43.652290: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:36:43.652302: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:36:43.652313: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:36:43.653050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:36:43.653068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:36:43.653074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:36:43.653080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:36:43.653801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902084 0.07625803 0.14466287 0.15730761 0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902084 0.07625803 0.14466287 0.15730761 0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902085 0.07625803 0.14466287 0.1573076  0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902085 0.07625806 0.14466289 0.1573076  0.10741325 0.09906388
 0.06754866 0.11337189 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902085 0.07625803 0.14466287 0.1573076  0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902084 0.07625803 0.14466287 0.15730761 0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902085 0.07625806 0.14466289 0.1573076  0.10741325 0.09906388
 0.06754866 0.11337189 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902085 0.07625803 0.14466287 0.1573076  0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902084 0.07625803 0.14466287 0.15730761 0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902085 0.07625803 0.14466287 0.1573076  0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902084 0.07625803 0.14466287 0.15730761 0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902084 0.07625803 0.14466287 0.15730761 0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902085 0.07625803 0.14466287 0.1573076  0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902085 0.07625803 0.14466287 0.1573076  0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [3 2 0 8 7 4 5 1 9 6] pred: [0.12902084 0.07625803 0.14466287 0.15730761 0.10741325 0.09906386
 0.06754864 0.11337186 0.11941895 0.07171883]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score: 0.0
 
Exécution 9 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 20)                3720      
_________________________________________________________________
dense_9 (Dense)              (None, 10)                210       
=================================================================
Total params: 6,430
Trainable params: 6,430
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2489 - accuracy: 0.09522/5 [===========>..................] - ETA: 2s - loss: 0.2480 - accuracy: 0.09693/5 [=================>............] - ETA: 1s - loss: 0.2472 - accuracy: 0.09804/5 [=======================>......] - ETA: 1s - loss: 0.2464 - accuracy: 0.09925/5 [==============================] - ETA: 0s - loss: 0.2463 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.2463 - accuracy: 0.0991
Epoch 2/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2406 - accuracy: 0.09812/5 [===========>..................] - ETA: 2s - loss: 0.2397 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.2388 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.2380 - accuracy: 0.09905/5 [==============================] - ETA: 0s - loss: 0.2380 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.2380 - accuracy: 0.0991
Epoch 3/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2319 - accuracy: 0.09612/5 [===========>..................] - ETA: 2s - loss: 0.2310 - accuracy: 0.09873/5 [=================>............] - ETA: 1s - loss: 0.2301 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.2292 - accuracy: 0.09925/5 [==============================] - ETA: 0s - loss: 0.2291 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.2291 - accuracy: 0.0991
Epoch 4/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2225 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.2216 - accuracy: 0.10043/5 [=================>............] - ETA: 1s - loss: 0.2206 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.2196 - accuracy: 0.09905/5 [==============================] - ETA: 0s - loss: 0.2196 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.2196 - accuracy: 0.0991
Epoch 5/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2122 - accuracy: 0.10302/5 [===========>..................] - ETA: 2s - loss: 0.2112 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.2101 - accuracy: 0.09834/5 [=======================>......] - ETA: 1s - loss: 0.2090 - accuracy: 0.09905/5 [==============================] - ETA: 0s - loss: 0.2090 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.2090 - accuracy: 0.0991
Epoch 6/20
1/5 [=====>........................] - ETA: 0s - loss: 0.2010 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.1998 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.1986 - accuracy: 0.09954/5 [=======================>......] - ETA: 1s - loss: 0.1974 - accuracy: 0.09915/5 [==============================] - ETA: 0s - loss: 0.1974 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.1974 - accuracy: 0.0991
Epoch 7/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1887 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.1875 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.1862 - accuracy: 0.09894/5 [=======================>......] - ETA: 1s - loss: 0.1849 - accuracy: 0.09925/5 [==============================] - ETA: 0s - loss: 0.1848 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.1848 - accuracy: 0.0991
Epoch 8/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1758 - accuracy: 0.10102/5 [===========>..................] - ETA: 2s - loss: 0.1745 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.1731 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.1718 - accuracy: 0.09885/5 [==============================] - ETA: 0s - loss: 0.1718 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.1718 - accuracy: 0.0991
Epoch 9/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1626 - accuracy: 0.09742/5 [===========>..................] - ETA: 2s - loss: 0.1612 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.1600 - accuracy: 0.09894/5 [=======================>......] - ETA: 1s - loss: 0.1588 - accuracy: 0.09905/5 [==============================] - ETA: 0s - loss: 0.1587 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.1587 - accuracy: 0.0991
Epoch 10/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1499 - accuracy: 0.09952/5 [===========>..................] - ETA: 2s - loss: 0.1488 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.1476 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.1463 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.1463 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.1463 - accuracy: 0.0991
Epoch 11/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1383 - accuracy: 0.09892/5 [===========>..................] - ETA: 2s - loss: 0.1373 - accuracy: 0.09813/5 [=================>............] - ETA: 1s - loss: 0.1361 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.1352 - accuracy: 0.09925/5 [==============================] - ETA: 0s - loss: 0.1351 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.1351 - accuracy: 0.0991
Epoch 12/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1281 - accuracy: 0.10032/5 [===========>..................] - ETA: 2s - loss: 0.1272 - accuracy: 0.10073/5 [=================>............] - ETA: 1s - loss: 0.1263 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.1254 - accuracy: 0.09915/5 [==============================] - ETA: 0s - loss: 0.1254 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.1254 - accuracy: 0.0991
Epoch 13/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1196 - accuracy: 0.09642/5 [===========>..................] - ETA: 2s - loss: 0.1187 - accuracy: 0.09933/5 [=================>............] - ETA: 1s - loss: 0.1181 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.1173 - accuracy: 0.09885/5 [==============================] - ETA: 0s - loss: 0.1173 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.1173 - accuracy: 0.0991
Epoch 14/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1125 - accuracy: 0.09892/5 [===========>..................] - ETA: 2s - loss: 0.1118 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.1113 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.1107 - accuracy: 0.09905/5 [==============================] - ETA: 0s - loss: 0.1107 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.1107 - accuracy: 0.0991
Epoch 15/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1067 - accuracy: 0.10002/5 [===========>..................] - ETA: 2s - loss: 0.1064 - accuracy: 0.10003/5 [=================>............] - ETA: 1s - loss: 0.1059 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.1055 - accuracy: 0.09915/5 [==============================] - ETA: 0s - loss: 0.1055 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.1055 - accuracy: 0.0991
Epoch 16/20
1/5 [=====>........................] - ETA: 0s - loss: 0.1028 - accuracy: 0.09552/5 [===========>..................] - ETA: 2s - loss: 0.1023 - accuracy: 0.09773/5 [=================>............] - ETA: 1s - loss: 0.1019 - accuracy: 0.09914/5 [=======================>......] - ETA: 1s - loss: 0.1016 - accuracy: 0.09875/5 [==============================] - ETA: 0s - loss: 0.1015 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.1015 - accuracy: 0.0991
Epoch 17/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0995 - accuracy: 0.09802/5 [===========>..................] - ETA: 2s - loss: 0.0991 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.0988 - accuracy: 0.09914/5 [=======================>......] - ETA: 1s - loss: 0.0986 - accuracy: 0.09925/5 [==============================] - ETA: 0s - loss: 0.0986 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.0986 - accuracy: 0.0991
Epoch 18/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0970 - accuracy: 0.09732/5 [===========>..................] - ETA: 2s - loss: 0.0967 - accuracy: 0.10003/5 [=================>............] - ETA: 1s - loss: 0.0966 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.0964 - accuracy: 0.09905/5 [==============================] - ETA: 0s - loss: 0.0964 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.0964 - accuracy: 0.0991
Epoch 19/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0951 - accuracy: 0.10272/5 [===========>..................] - ETA: 2s - loss: 0.0950 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0949 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0948 - accuracy: 0.09905/5 [==============================] - ETA: 0s - loss: 0.0948 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.0948 - accuracy: 0.0991
Epoch 20/20
1/5 [=====>........................] - ETA: 0s - loss: 0.0939 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.0939 - accuracy: 0.09893/5 [=================>............] - ETA: 1s - loss: 0.0938 - accuracy: 0.09854/5 [=======================>......] - ETA: 1s - loss: 0.0937 - accuracy: 0.09935/5 [==============================] - ETA: 0s - loss: 0.0937 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.0937 - accuracy: 0.0991
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08de07b290> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0930 - accuracy: 0.10282/3 [===================>..........] - ETA: 0s - loss: 0.0931 - accuracy: 0.10133/3 [==============================] - ETA: 0s - loss: 0.0930 - accuracy: 0.10173/3 [==============================] - 0s 103ms/step - loss: 0.0930 - accuracy: 0.1017
2021-12-07 16:40:43.575516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:40:43.575688: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:40:43.576134: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:40:43.576153: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:40:43.576171: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:40:43.576187: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:40:43.576203: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:40:43.576222: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:40:43.577015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:40:43.577042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:40:43.577049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:40:43.577054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:40:43.577808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:40:43.578488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:40:43.578519: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:40:43.578554: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:40:43.578566: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:40:43.578577: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:40:43.578588: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:40:43.578603: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:40:43.578615: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:40:43.579328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:40:43.579346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:40:43.579352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:40:43.579357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:40:43.580082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453125 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360043 0.06016911 0.09093475]
 Top predictions indices: [6] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453123 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360044 0.0601691  0.09093472]
 Top predictions indices: [6] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453125 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360043 0.06016911 0.09093475]
 Top predictions indices: [6] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453123 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.23419409 0.13360043 0.0601691  0.09093472]
 Top predictions indices: [6] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453125 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360043 0.06016911 0.09093475]
 Top predictions indices: [6] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453123 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360044 0.0601691  0.09093472]
 Top predictions indices: [6] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453122 0.15239653 0.0883668  0.10256675 0.14881073 0.11212803
 0.23419409 0.13360043 0.06016908 0.09093472]
 Top predictions indices: [6] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453123 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360044 0.0601691  0.09093472]
 Top predictions indices: [6] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453125 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360041 0.0601691  0.09093475]
 Top predictions indices: [6] vs. real classes indices: [6]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453123 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360044 0.0601691  0.09093472]
 Top predictions indices: [6] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453125 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360043 0.06016911 0.09093475]
 Top predictions indices: [6] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453123 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360044 0.0601691  0.09093472]
 Top predictions indices: [6] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453123 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360044 0.0601691  0.09093472]
 Top predictions indices: [6] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453123 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.2341941  0.13360044 0.0601691  0.09093472]
 Top predictions indices: [6] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [6 0 1 4 7 5 3 9 2 8] pred: [0.16453123 0.15239653 0.0883668  0.10256677 0.14881073 0.11212803
 0.23419409 0.13360043 0.0601691  0.09093472]
 Top predictions indices: [6] vs. real classes indices: [0]
Jaccard Score: 0.0
 
Exécution 0 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_10"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_10 (Embedding)     (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_10 (Bidirectio (None, 60)                14760     
_________________________________________________________________
dense_10 (Dense)             (None, 10)                610       
=================================================================
Total params: 17,870
Trainable params: 17,870
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2490 - accuracy: 0.10242/5 [===========>..................] - ETA: 2s - loss: 0.2479 - accuracy: 0.09863/5 [=================>............] - ETA: 1s - loss: 0.2467 - accuracy: 0.09914/5 [=======================>......] - ETA: 1s - loss: 0.2455 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.2455 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.2455 - accuracy: 0.0995
Epoch 2/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2372 - accuracy: 0.09892/5 [===========>..................] - ETA: 2s - loss: 0.2360 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.2347 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.2335 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.2334 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.2334 - accuracy: 0.0995
Epoch 3/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2239 - accuracy: 0.10012/5 [===========>..................] - ETA: 2s - loss: 0.2225 - accuracy: 0.09753/5 [=================>............] - ETA: 1s - loss: 0.2209 - accuracy: 0.09914/5 [=======================>......] - ETA: 1s - loss: 0.2193 - accuracy: 0.09905/5 [==============================] - ETA: 0s - loss: 0.2192 - accuracy: 0.09905/5 [==============================] - 5s 1s/step - loss: 0.2192 - accuracy: 0.0990
Epoch 4/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2071 - accuracy: 0.10252/5 [===========>..................] - ETA: 2s - loss: 0.2053 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.2033 - accuracy: 0.09834/5 [=======================>......] - ETA: 1s - loss: 0.2013 - accuracy: 0.09895/5 [==============================] - ETA: 0s - loss: 0.2012 - accuracy: 0.09905/5 [==============================] - 5s 1s/step - loss: 0.2012 - accuracy: 0.0990
Epoch 5/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1856 - accuracy: 0.10382/5 [===========>..................] - ETA: 2s - loss: 0.1831 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.1805 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.1778 - accuracy: 0.09905/5 [==============================] - ETA: 0s - loss: 0.1777 - accuracy: 0.09905/5 [==============================] - 5s 1s/step - loss: 0.1777 - accuracy: 0.0990
Epoch 6/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1582 - accuracy: 0.10102/5 [===========>..................] - ETA: 2s - loss: 0.1551 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.1521 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.1490 - accuracy: 0.09885/5 [==============================] - ETA: 0s - loss: 0.1489 - accuracy: 0.09905/5 [==============================] - 5s 1s/step - loss: 0.1489 - accuracy: 0.0990
Epoch 7/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1276 - accuracy: 0.09482/5 [===========>..................] - ETA: 2s - loss: 0.1248 - accuracy: 0.09883/5 [=================>............] - ETA: 1s - loss: 0.1221 - accuracy: 0.09854/5 [=======================>......] - ETA: 1s - loss: 0.1195 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.1194 - accuracy: 0.09945/5 [==============================] - 5s 1s/step - loss: 0.1194 - accuracy: 0.0994
Epoch 8/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1036 - accuracy: 0.10472/5 [===========>..................] - ETA: 2s - loss: 0.1023 - accuracy: 0.09873/5 [=================>............] - ETA: 1s - loss: 0.1008 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.0997 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0996 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0996 - accuracy: 0.0995
Epoch 9/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0939 - accuracy: 0.10182/5 [===========>..................] - ETA: 2s - loss: 0.0936 - accuracy: 0.10043/5 [=================>............] - ETA: 1s - loss: 0.0934 - accuracy: 0.09854/5 [=======================>......] - ETA: 1s - loss: 0.0933 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0933 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0933 - accuracy: 0.0995
Epoch 10/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0927 - accuracy: 0.09972/5 [===========>..................] - ETA: 2s - loss: 0.0927 - accuracy: 0.09853/5 [=================>............] - ETA: 1s - loss: 0.0927 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.0928 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0928 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0928 - accuracy: 0.0995
Epoch 11/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0930 - accuracy: 0.09552/5 [===========>..................] - ETA: 2s - loss: 0.0930 - accuracy: 0.09803/5 [=================>............] - ETA: 1s - loss: 0.0930 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0930 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0930 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0930 - accuracy: 0.0995
Epoch 12/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0930 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.0929 - accuracy: 0.09843/5 [=================>............] - ETA: 1s - loss: 0.0929 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.0928 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0928 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0928 - accuracy: 0.0995
Epoch 13/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0925 - accuracy: 0.09952/5 [===========>..................] - ETA: 2s - loss: 0.0924 - accuracy: 0.09893/5 [=================>............] - ETA: 1s - loss: 0.0923 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.0923 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0923 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0923 - accuracy: 0.0995
Epoch 14/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0917 - accuracy: 0.09882/5 [===========>..................] - ETA: 2s - loss: 0.0917 - accuracy: 0.09813/5 [=================>............] - ETA: 1s - loss: 0.0916 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.0915 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0915 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0915 - accuracy: 0.0996
Epoch 15/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0909 - accuracy: 0.09882/5 [===========>..................] - ETA: 2s - loss: 0.0909 - accuracy: 0.09933/5 [=================>............] - ETA: 1s - loss: 0.0908 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0908 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0908 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0908 - accuracy: 0.1000
Epoch 16/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0904 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.0903 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0903 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0903 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0903 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0903 - accuracy: 0.1000
Epoch 17/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.09743/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.09874/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.1000
Epoch 18/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10343/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.1000
Epoch 19/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.09552/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1000
Epoch 20/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.09883/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.09894/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.0999
Epoch 21/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10012/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09773/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10055/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1005
Epoch 22/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09612/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09933/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0995
Epoch 23/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09834/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0995
Epoch 24/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09502/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09803/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09824/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09925/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0995
Epoch 25/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1020
Epoch 26/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1020
Epoch 27/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10082/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10433/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10334/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1020
Epoch 28/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10272/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1020
Epoch 29/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09802/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10254/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1020
Epoch 30/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10622/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10443/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10344/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1020
Epoch 31/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09792/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09683/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09825/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09845/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0984
Epoch 32/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09832/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09813/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09874/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09875/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09885/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0988
Epoch 33/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09722/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09895/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09885/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0988
Epoch 34/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10122/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09833/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09734/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09785/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09785/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0978
Epoch 35/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10332/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10393/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10284/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1020
Epoch 36/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10892/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10294/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10265/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10265/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1026
Epoch 37/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10422/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10194/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 38/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10313/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 39/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10342/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10224/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 40/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10392/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10203/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10154/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 41/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09832/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 42/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1001
Epoch 43/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10215/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1021
Epoch 44/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10472/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1010
Epoch 45/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09692/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09894/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0997
Epoch 46/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09682/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09863/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1000
Epoch 47/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10282/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 48/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09963/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09954/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1000
Epoch 49/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10332/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09823/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 50/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09942/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1020
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08dfc268c0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09622/3 [===================>..........] - ETA: 0s - loss: 0.0900 - accuracy: 0.09563/3 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09613/3 [==============================] - 0s 102ms/step - loss: 0.0900 - accuracy: 0.0961
2021-12-07 16:48:04.212911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:48:04.213138: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:48:04.213250: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:48:04.213270: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:48:04.213286: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:48:04.213300: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:48:04.213325: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:48:04.213343: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:48:04.214170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:48:04.214199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:48:04.214206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:48:04.214212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:48:04.214992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:48:04.215592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:48:04.215617: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:48:04.215649: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:48:04.215661: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:48:04.215672: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:48:04.215683: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:48:04.215695: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:48:04.215707: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:48:04.216420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:48:04.216437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:48:04.216443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:48:04.216449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:48:04.217179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880377 0.0968629  0.0975798  0.09959479 0.0980832  0.09910576
 0.1013977  0.10267354 0.09925285 0.10067031]
 Top predictions indices: [7] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880316 0.09686286 0.09757932 0.09959403 0.09808265 0.0991053
 0.10139753 0.10267354 0.09925234 0.10066975]
 Top predictions indices: [7] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880352 0.09686288 0.09757961 0.0995945  0.09808299 0.09910557
 0.10139764 0.10267352 0.09925266 0.10067008]
 Top predictions indices: [7] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880354 0.09686288 0.09757962 0.0995945  0.09808299 0.09910557
 0.10139762 0.10267354 0.09925266 0.10067011]
 Top predictions indices: [7] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880386 0.0968629  0.09757988 0.09959492 0.09808329 0.09910583
 0.10139773 0.10267354 0.09925291 0.10067041]
 Top predictions indices: [7] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880354 0.09686288 0.09757962 0.0995945  0.09808299 0.09910557
 0.10139762 0.10267352 0.09925266 0.10067011]
 Top predictions indices: [7] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880307 0.09686288 0.0975792  0.09959389 0.09808257 0.09910521
 0.10139751 0.10267354 0.09925227 0.10066962]
 Top predictions indices: [7] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880339 0.09686288 0.09757951 0.09959432 0.09808287 0.09910547
 0.1013976  0.10267352 0.09925253 0.10066996]
 Top predictions indices: [7] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.0988863  0.09696796 0.09763838 0.09965407 0.09816407 0.09918604
 0.10150075 0.10277832 0.09932616 0.1007286 ]
 Top predictions indices: [7] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880354 0.09686288 0.09757962 0.0995945  0.09808299 0.09910557
 0.10139762 0.10267354 0.09925266 0.10067011]
 Top predictions indices: [7] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880356 0.09686288 0.09757962 0.09959453 0.09808299 0.09910557
 0.10139764 0.10267354 0.09925268 0.10067011]
 Top predictions indices: [7] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880339 0.09686288 0.09757951 0.09959432 0.09808287 0.09910547
 0.10139762 0.10267354 0.09925253 0.10066996]
 Top predictions indices: [7] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880318 0.09686286 0.09757929 0.09959403 0.09808265 0.0991053
 0.10139753 0.10267352 0.09925234 0.10066975]
 Top predictions indices: [7] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880343 0.09686288 0.09757954 0.09959438 0.09808291 0.09910551
 0.10139762 0.10267352 0.09925259 0.10067001]
 Top predictions indices: [7] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [7 6 9 3 8 5 0 4 2 1] pred: [0.09880348 0.09686288 0.09757954 0.09959441 0.09808295 0.09910551
 0.10139762 0.10267352 0.09925262 0.10067005]
 Top predictions indices: [7] vs. real classes indices: [8]
Jaccard Score: 0.0
 
Exécution 1 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_11"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_11 (Embedding)     (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_11 (Bidirectio (None, 60)                14760     
_________________________________________________________________
dense_11 (Dense)             (None, 10)                610       
=================================================================
Total params: 17,870
Trainable params: 17,870
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2494 - accuracy: 0.09662/5 [===========>..................] - ETA: 2s - loss: 0.2481 - accuracy: 0.10153/5 [=================>............] - ETA: 1s - loss: 0.2469 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.2457 - accuracy: 0.09935/5 [==============================] - ETA: 0s - loss: 0.2457 - accuracy: 0.09925/5 [==============================] - 5s 1s/step - loss: 0.2457 - accuracy: 0.0992
Epoch 2/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2372 - accuracy: 0.09722/5 [===========>..................] - ETA: 2s - loss: 0.2359 - accuracy: 0.09913/5 [=================>............] - ETA: 1s - loss: 0.2347 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.2333 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.2333 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.2333 - accuracy: 0.1000
Epoch 3/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2238 - accuracy: 0.09632/5 [===========>..................] - ETA: 2s - loss: 0.2223 - accuracy: 0.09903/5 [=================>............] - ETA: 1s - loss: 0.2207 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.2191 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.2191 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.2191 - accuracy: 0.1000
Epoch 4/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2071 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.2052 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.2032 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.2011 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.2010 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.2010 - accuracy: 0.1000
Epoch 5/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1855 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.1830 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.1804 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.1777 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.1776 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.1776 - accuracy: 0.1000
Epoch 6/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1579 - accuracy: 0.09812/5 [===========>..................] - ETA: 2s - loss: 0.1549 - accuracy: 0.09793/5 [=================>............] - ETA: 1s - loss: 0.1518 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.1486 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.1485 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.1485 - accuracy: 0.1000
Epoch 7/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1265 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.1235 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.1206 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.1177 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.1176 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.1176 - accuracy: 0.1000
Epoch 8/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1004 - accuracy: 0.10602/5 [===========>..................] - ETA: 2s - loss: 0.0988 - accuracy: 0.10253/5 [=================>............] - ETA: 1s - loss: 0.0973 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.0961 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0961 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0961 - accuracy: 0.1024
Epoch 9/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0909 - accuracy: 0.10392/5 [===========>..................] - ETA: 2s - loss: 0.0909 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0910 - accuracy: 0.10254/5 [=======================>......] - ETA: 1s - loss: 0.0911 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0911 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0911 - accuracy: 0.1013
Epoch 10/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0920 - accuracy: 0.09702/5 [===========>..................] - ETA: 2s - loss: 0.0921 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0922 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0923 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0923 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0923 - accuracy: 0.1013
Epoch 11/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0930 - accuracy: 0.10122/5 [===========>..................] - ETA: 2s - loss: 0.0930 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0931 - accuracy: 0.10154/5 [=======================>......] - ETA: 1s - loss: 0.0931 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.0931 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0931 - accuracy: 0.1013
Epoch 12/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0931 - accuracy: 0.10712/5 [===========>..................] - ETA: 2s - loss: 0.0930 - accuracy: 0.10453/5 [=================>............] - ETA: 1s - loss: 0.0930 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0930 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0930 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0930 - accuracy: 0.1013
Epoch 13/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0927 - accuracy: 0.09752/5 [===========>..................] - ETA: 2s - loss: 0.0926 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0925 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0924 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0924 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0924 - accuracy: 0.1013
Epoch 14/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0918 - accuracy: 0.10082/5 [===========>..................] - ETA: 2s - loss: 0.0917 - accuracy: 0.10333/5 [=================>............] - ETA: 1s - loss: 0.0917 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0916 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0916 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0916 - accuracy: 0.1013
Epoch 15/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0910 - accuracy: 0.10222/5 [===========>..................] - ETA: 2s - loss: 0.0909 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0908 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.0908 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0908 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0908 - accuracy: 0.1013
Epoch 16/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0904 - accuracy: 0.10712/5 [===========>..................] - ETA: 2s - loss: 0.0904 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.0903 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0903 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0903 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0903 - accuracy: 0.1013
Epoch 17/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.09612/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10264/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1013
Epoch 18/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10122/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10273/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1013
Epoch 19/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10362/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1013
Epoch 20/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10253/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1013
Epoch 21/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 22/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09732/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09783/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 23/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10332/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 24/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10333/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 25/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 26/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10203/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10254/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 27/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10043/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 28/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10422/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10183/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 29/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09852/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09743/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 30/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09412/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09623/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 31/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09954/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1003
Epoch 32/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09812/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09803/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1004
Epoch 33/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10412/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 34/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10222/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10153/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 35/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10222/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10213/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 36/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10382/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09813/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09895/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09885/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0988
Epoch 37/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10822/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10284/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 38/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09962/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 39/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10102/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 40/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 41/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09912/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 42/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10252/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 43/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09992/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 44/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09832/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09693/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09844/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09855/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09845/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0984
Epoch 45/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09642/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0999
Epoch 46/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09582/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 47/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 48/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10222/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10313/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 49/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09972/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 50/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10213/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08ddef83b0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09722/3 [===================>..........] - ETA: 0s - loss: 0.0900 - accuracy: 0.09743/3 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09753/3 [==============================] - 0s 107ms/step - loss: 0.0900 - accuracy: 0.0975
2021-12-07 16:55:24.700926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:55:24.701204: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:55:24.701657: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:55:24.701687: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:55:24.701705: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:55:24.701721: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:55:24.701738: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:55:24.701756: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:55:24.702537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:55:24.702565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:55:24.702571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:55:24.702577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:55:24.703327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 16:55:24.703961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 16:55:24.703991: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 16:55:24.704026: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 16:55:24.704038: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 16:55:24.704050: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 16:55:24.704061: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 16:55:24.704072: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 16:55:24.704083: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 16:55:24.704801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 16:55:24.704819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 16:55:24.704825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 16:55:24.704831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 16:55:24.705575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901006 0.0981862  0.09890875 0.09781954 0.10163999 0.09799702
 0.10363528 0.10019171 0.10018576 0.10397404]
 Top predictions indices: [9] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901033 0.09818656 0.09890916 0.09781979 0.10164015 0.0979974
 0.10363551 0.10019194 0.1001861  0.10397442]
 Top predictions indices: [9] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901037 0.0981866  0.09890918 0.09781983 0.10164022 0.09799743
 0.10363557 0.10019204 0.10018614 0.10397446]
 Top predictions indices: [9] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901004 0.0981862  0.09890875 0.09781954 0.10163994 0.09799702
 0.10363523 0.10019168 0.10018573 0.10397402]
 Top predictions indices: [9] vs. real classes indices: [9]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901001 0.09818616 0.09890874 0.09781952 0.10163993 0.09799699
 0.10363523 0.10019162 0.10018572 0.10397402]
 Top predictions indices: [9] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901033 0.09818657 0.09890916 0.09781979 0.10164018 0.09799742
 0.10363553 0.10019199 0.10018612 0.10397442]
 Top predictions indices: [9] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901037 0.09818661 0.09890918 0.09781983 0.10164022 0.09799743
 0.1036356  0.10019206 0.10018614 0.10397446]
 Top predictions indices: [9] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901042 0.09818666 0.09890918 0.09781988 0.10164029 0.09799746
 0.10363561 0.10019211 0.10018619 0.10397446]
 Top predictions indices: [9] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901004 0.0981862  0.09890875 0.09781954 0.10163996 0.09799704
 0.10363528 0.10019169 0.10018576 0.10397404]
 Top predictions indices: [9] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901007 0.0981862  0.09890875 0.09781958 0.10163999 0.09799702
 0.10363528 0.10019171 0.10018576 0.10397406]
 Top predictions indices: [9] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901004 0.0981862  0.09890875 0.09781954 0.10163996 0.09799702
 0.10363528 0.10019168 0.10018576 0.10397404]
 Top predictions indices: [9] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901004 0.0981862  0.09890875 0.09781954 0.10163994 0.09799702
 0.10363523 0.10019168 0.10018573 0.10397402]
 Top predictions indices: [9] vs. real classes indices: [9]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901004 0.0981862  0.09890875 0.09781954 0.10163996 0.09799702
 0.10363527 0.10019168 0.10018573 0.10397402]
 Top predictions indices: [9] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901004 0.0981862  0.09890875 0.09781954 0.10163996 0.09799702
 0.10363528 0.10019168 0.10018573 0.10397404]
 Top predictions indices: [9] vs. real classes indices: [9]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [9 6 4 7 8 0 2 1 5 3] pred: [0.09901007 0.09818622 0.09890875 0.09781957 0.10163999 0.09799702
 0.10363528 0.10019171 0.10018576 0.10397406]
 Top predictions indices: [9] vs. real classes indices: [3]
Jaccard Score: 0.0
 
Exécution 2 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_12"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_12 (Embedding)     (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_12 (Bidirectio (None, 60)                14760     
_________________________________________________________________
dense_12 (Dense)             (None, 10)                610       
=================================================================
Total params: 17,870
Trainable params: 17,870
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2519 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.2507 - accuracy: 0.09853/5 [=================>............] - ETA: 1s - loss: 0.2494 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.2481 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.2480 - accuracy: 0.10085/5 [==============================] - 5s 1s/step - loss: 0.2480 - accuracy: 0.1008
Epoch 2/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2389 - accuracy: 0.10672/5 [===========>..................] - ETA: 2s - loss: 0.2375 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.2361 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.2346 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.2346 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.2346 - accuracy: 0.0996
Epoch 3/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2241 - accuracy: 0.09402/5 [===========>..................] - ETA: 2s - loss: 0.2224 - accuracy: 0.09863/5 [=================>............] - ETA: 1s - loss: 0.2206 - accuracy: 0.09894/5 [=======================>......] - ETA: 1s - loss: 0.2188 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.2188 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.2188 - accuracy: 0.0996
Epoch 4/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2055 - accuracy: 0.09522/5 [===========>..................] - ETA: 2s - loss: 0.2033 - accuracy: 0.09853/5 [=================>............] - ETA: 1s - loss: 0.2010 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.1987 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.1986 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1986 - accuracy: 0.0996
Epoch 5/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1813 - accuracy: 0.09992/5 [===========>..................] - ETA: 2s - loss: 0.1786 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.1757 - accuracy: 0.09954/5 [=======================>......] - ETA: 1s - loss: 0.1728 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.1727 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1727 - accuracy: 0.0996
Epoch 6/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1513 - accuracy: 0.10102/5 [===========>..................] - ETA: 2s - loss: 0.1479 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.1447 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.1414 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.1413 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1413 - accuracy: 0.0996
Epoch 7/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1192 - accuracy: 0.09612/5 [===========>..................] - ETA: 2s - loss: 0.1162 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.1135 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.1110 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.1110 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.1110 - accuracy: 0.0996
Epoch 8/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0968 - accuracy: 0.09842/5 [===========>..................] - ETA: 2s - loss: 0.0956 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.0948 - accuracy: 0.09724/5 [=======================>......] - ETA: 1s - loss: 0.0940 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0940 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0940 - accuracy: 0.0996
Epoch 9/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0911 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.0911 - accuracy: 0.10013/5 [=================>............] - ETA: 1s - loss: 0.0912 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0913 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0913 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0913 - accuracy: 0.0996
Epoch 10/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0920 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0921 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.0922 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0923 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0923 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0923 - accuracy: 0.0997
Epoch 11/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0928 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0928 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0928 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0928 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0928 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0928 - accuracy: 0.1002
Epoch 12/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0928 - accuracy: 0.10472/5 [===========>..................] - ETA: 2s - loss: 0.0928 - accuracy: 0.10263/5 [=================>............] - ETA: 1s - loss: 0.0928 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0927 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0927 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0927 - accuracy: 0.1002
Epoch 13/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0924 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.0924 - accuracy: 0.09723/5 [=================>............] - ETA: 1s - loss: 0.0923 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0922 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0922 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0922 - accuracy: 0.1002
Epoch 14/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0917 - accuracy: 0.10892/5 [===========>..................] - ETA: 2s - loss: 0.0917 - accuracy: 0.10253/5 [=================>............] - ETA: 1s - loss: 0.0916 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0916 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0916 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0916 - accuracy: 0.1002
Epoch 15/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0911 - accuracy: 0.09782/5 [===========>..................] - ETA: 2s - loss: 0.0911 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0910 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0909 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0909 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0909 - accuracy: 0.1001
Epoch 16/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0905 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.0905 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0905 - accuracy: 0.10194/5 [=======================>......] - ETA: 1s - loss: 0.0905 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0905 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0905 - accuracy: 0.1023
Epoch 17/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0903 - accuracy: 0.09782/5 [===========>..................] - ETA: 2s - loss: 0.0903 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.0903 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0903 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0903 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0903 - accuracy: 0.1023
Epoch 18/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10433/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.1023
Epoch 19/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10382/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10264/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.1023
Epoch 20/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1023
Epoch 21/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10662/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10363/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1023
Epoch 22/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10772/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10423/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 23/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 24/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 25/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09702/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10255/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 26/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09882/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10215/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1021
Epoch 27/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09972/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 6s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 28/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10242/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10254/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 29/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10242/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10213/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10264/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 30/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10593/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10394/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 31/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10422/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10353/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10294/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 32/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09522/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09753/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09954/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 33/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09642/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09753/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 34/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10422/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10273/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10294/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 35/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10352/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10204/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 36/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10412/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10265/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 37/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09882/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10275/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1027
Epoch 38/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09792/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09823/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09844/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 39/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10552/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 40/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09972/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 41/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 42/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09752/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 43/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10294/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10255/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 44/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09883/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0999
Epoch 45/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09962/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0996
Epoch 46/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09983/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0996
Epoch 47/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09883/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0996
Epoch 48/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10142/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10254/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 49/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09802/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10255/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 50/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10302/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10253/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10215/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08da58ab90> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09412/3 [===================>..........] - ETA: 0s - loss: 0.0900 - accuracy: 0.09523/3 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09553/3 [==============================] - 0s 107ms/step - loss: 0.0900 - accuracy: 0.0955
2021-12-07 17:02:47.528216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:02:47.528494: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:02:47.528946: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:02:47.528968: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:02:47.528986: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:02:47.529010: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:02:47.529026: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:02:47.529045: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:02:47.529887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:02:47.529914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:02:47.529920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:02:47.529926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:02:47.530733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 17:02:47.531397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:02:47.531424: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:02:47.531458: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:02:47.531470: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:02:47.531481: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:02:47.531493: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:02:47.531526: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:02:47.531538: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:02:47.532250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:02:47.532268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:02:47.532274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:02:47.532280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:02:47.533004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076027 0.09913437 0.1005065  0.10261817 0.10080337 0.09842244
 0.10050513 0.10040986 0.09919218 0.09869119]
 Top predictions indices: [3] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.1007601  0.09913401 0.10050616 0.10261792 0.10080317 0.09842222
 0.10050474 0.10040972 0.09919196 0.098691  ]
 Top predictions indices: [3] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076014 0.09913404 0.10050613 0.10261794 0.10080323 0.0984223
 0.10050476 0.10040987 0.09919196 0.09869108]
 Top predictions indices: [3] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076018 0.09913418 0.10050633 0.10261805 0.10080327 0.09842233
 0.10050493 0.10040977 0.09919206 0.09869108]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076024 0.09913432 0.10050645 0.10261814 0.10080333 0.09842241
 0.10050504 0.10040981 0.09919214 0.09869117]
 Top predictions indices: [3] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076014 0.09913408 0.10050619 0.10261796 0.10080324 0.09842233
 0.1005048  0.1004099  0.09919196 0.09869111]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076005 0.09913391 0.10050601 0.10261785 0.10080314 0.09842224
 0.10050462 0.10040984 0.09919188 0.098691  ]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.1007603  0.09913433 0.10050645 0.10261817 0.1008034  0.09842249
 0.10050508 0.10040998 0.09919214 0.09869125]
 Top predictions indices: [3] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076031 0.09913442 0.10050648 0.1026182  0.10080342 0.09842251
 0.10050515 0.10040998 0.09919218 0.09869129]
 Top predictions indices: [3] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076035 0.09913449 0.10050652 0.10261825 0.10080347 0.09842256
 0.10050518 0.10041003 0.09919219 0.09869134]
 Top predictions indices: [3] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076018 0.09913421 0.10050635 0.10261805 0.10080327 0.09842233
 0.10050493 0.10040977 0.09919206 0.09869111]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076023 0.09913425 0.1005064  0.10261809 0.1008033  0.09842236
 0.10050499 0.10040979 0.0991921  0.09869112]
 Top predictions indices: [3] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076014 0.09913406 0.10050616 0.10261796 0.10080324 0.09842233
 0.10050479 0.1004099  0.09919196 0.09869108]
 Top predictions indices: [3] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076031 0.09913437 0.10050646 0.10261817 0.10080342 0.09842251
 0.10050511 0.10040998 0.09919214 0.09869127]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 0 2 6 7 8 1 9 5] pred: [0.10076005 0.09913391 0.10050601 0.10261785 0.10080316 0.09842222
 0.10050462 0.10040984 0.09919188 0.09869101]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 3 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_13"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_13 (Embedding)     (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_13 (Bidirectio (None, 60)                14760     
_________________________________________________________________
dense_13 (Dense)             (None, 10)                610       
=================================================================
Total params: 17,870
Trainable params: 17,870
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2487 - accuracy: 0.09892/5 [===========>..................] - ETA: 2s - loss: 0.2474 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.2461 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.2447 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.2447 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.2447 - accuracy: 0.1015
Epoch 2/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2351 - accuracy: 0.09782/5 [===========>..................] - ETA: 2s - loss: 0.2337 - accuracy: 0.10093/5 [=================>............] - ETA: 1s - loss: 0.2322 - accuracy: 0.10264/5 [=======================>......] - ETA: 1s - loss: 0.2307 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.2306 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.2306 - accuracy: 0.1015
Epoch 3/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2197 - accuracy: 0.10512/5 [===========>..................] - ETA: 2s - loss: 0.2180 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.2162 - accuracy: 0.10204/5 [=======================>......] - ETA: 1s - loss: 0.2144 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.2143 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.2143 - accuracy: 0.1015
Epoch 4/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2006 - accuracy: 0.10282/5 [===========>..................] - ETA: 2s - loss: 0.1984 - accuracy: 0.10343/5 [=================>............] - ETA: 1s - loss: 0.1961 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.1937 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.1936 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.1936 - accuracy: 0.1015
Epoch 5/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1758 - accuracy: 0.10562/5 [===========>..................] - ETA: 2s - loss: 0.1731 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.1702 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.1672 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.1671 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.1671 - accuracy: 0.1015
Epoch 6/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1455 - accuracy: 0.09962/5 [===========>..................] - ETA: 2s - loss: 0.1422 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.1390 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.1358 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.1357 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.1357 - accuracy: 0.1015
Epoch 7/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1144 - accuracy: 0.09892/5 [===========>..................] - ETA: 2s - loss: 0.1118 - accuracy: 0.09843/5 [=================>............] - ETA: 1s - loss: 0.1094 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.1072 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.1071 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.1071 - accuracy: 0.1015
Epoch 8/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0950 - accuracy: 0.10512/5 [===========>..................] - ETA: 2s - loss: 0.0943 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.0937 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0933 - accuracy: 0.10175/5 [==============================] - ETA: 0s - loss: 0.0933 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0933 - accuracy: 0.1015
Epoch 9/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0917 - accuracy: 0.10182/5 [===========>..................] - ETA: 2s - loss: 0.0918 - accuracy: 0.10043/5 [=================>............] - ETA: 1s - loss: 0.0919 - accuracy: 0.10204/5 [=======================>......] - ETA: 1s - loss: 0.0920 - accuracy: 0.10175/5 [==============================] - ETA: 0s - loss: 0.0920 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0920 - accuracy: 0.1015
Epoch 10/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0925 - accuracy: 0.10232/5 [===========>..................] - ETA: 2s - loss: 0.0927 - accuracy: 0.10333/5 [=================>............] - ETA: 1s - loss: 0.0927 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.0928 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0928 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0928 - accuracy: 0.1015
Epoch 11/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0931 - accuracy: 0.09622/5 [===========>..................] - ETA: 2s - loss: 0.0931 - accuracy: 0.09843/5 [=================>............] - ETA: 1s - loss: 0.0930 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.0930 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0930 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0930 - accuracy: 0.1015
Epoch 12/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0928 - accuracy: 0.09912/5 [===========>..................] - ETA: 2s - loss: 0.0927 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0927 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.0926 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0926 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0926 - accuracy: 0.1015
Epoch 13/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0921 - accuracy: 0.10462/5 [===========>..................] - ETA: 2s - loss: 0.0920 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0920 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0919 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0919 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0919 - accuracy: 0.1015
Epoch 14/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0912 - accuracy: 0.10362/5 [===========>..................] - ETA: 2s - loss: 0.0912 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0911 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0910 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0910 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0910 - accuracy: 0.1015
Epoch 15/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0905 - accuracy: 0.10012/5 [===========>..................] - ETA: 2s - loss: 0.0905 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0904 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0904 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.0904 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0904 - accuracy: 0.1006
Epoch 16/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.0998
Epoch 17/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.09873/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10004/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.0998
Epoch 18/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.09852/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.09753/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.09894/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.0998
Epoch 19/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.09962/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1015
Epoch 20/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10032/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 21/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 22/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09702/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 23/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10182/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10153/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 24/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10344/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 25/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10452/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10153/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 26/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 27/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10142/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 28/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09803/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 29/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09462/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09803/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1004
Epoch 30/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09983/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0999
Epoch 31/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09952/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 32/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09682/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09903/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0997
Epoch 33/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10182/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09893/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1001
Epoch 34/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09732/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09843/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 35/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10313/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10194/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 36/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10252/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10073/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 37/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09862/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 38/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09732/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1007
Epoch 39/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09532/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09893/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1007
Epoch 40/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10302/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10174/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1007
Epoch 41/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10153/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1007
Epoch 42/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09962/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09874/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09865/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09885/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0988
Epoch 43/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10122/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09883/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1000
Epoch 44/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09782/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09933/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1000
Epoch 45/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09972/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10175/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10185/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1018
Epoch 46/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09933/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 47/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 48/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10302/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 49/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09972/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 50/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10392/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1007
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08e11af8c0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10252/3 [===================>..........] - ETA: 0s - loss: 0.0900 - accuracy: 0.09923/3 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09863/3 [==============================] - 0s 106ms/step - loss: 0.0900 - accuracy: 0.0986
2021-12-07 17:10:08.081749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:10:08.081999: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:10:08.082415: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:10:08.082450: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:10:08.082467: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:10:08.082481: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:10:08.082495: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:10:08.082519: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:10:08.083306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:10:08.083334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:10:08.083343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:10:08.083349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:10:08.084106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 17:10:08.084877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:10:08.084902: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:10:08.084937: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:10:08.084949: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:10:08.084961: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:10:08.084972: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:10:08.084983: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:10:08.084994: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:10:08.085715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:10:08.085733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:10:08.085739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:10:08.085745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:10:08.086495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978892 0.10127728 0.0961435  0.09925763 0.10413207 0.09834547
 0.09889491 0.1031556  0.10198261 0.09829554]
 Top predictions indices: [4] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978884 0.10127719 0.09614348 0.09925742 0.104132   0.09834526
 0.09889477 0.10315537 0.10198256 0.09829542]
 Top predictions indices: [4] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978867 0.10127699 0.09614344 0.09925694 0.10413186 0.09834477
 0.09889448 0.10315486 0.10198248 0.09829514]
 Top predictions indices: [4] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.0997887  0.101277   0.09614346 0.09925698 0.10413189 0.09834479
 0.0988945  0.10315486 0.1019825  0.0982952 ]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978899 0.10127734 0.09614356 0.09925774 0.10413209 0.09834555
 0.09889497 0.10315571 0.10198268 0.09829563]
 Top predictions indices: [4] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978875 0.10127707 0.09614348 0.0992571  0.10413194 0.09834496
 0.09889458 0.10315502 0.10198255 0.09829527]
 Top predictions indices: [4] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978868 0.10127705 0.09614344 0.09925707 0.10413189 0.09834488
 0.09889454 0.10315499 0.1019825  0.0982952 ]
 Top predictions indices: [4] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978877 0.10127711 0.09614346 0.09925724 0.10413194 0.09834507
 0.09889465 0.10315518 0.10198255 0.09829529]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978884 0.10127719 0.09614348 0.09925742 0.104132   0.09834526
 0.09889477 0.10315537 0.10198256 0.09829542]
 Top predictions indices: [4] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978892 0.10127728 0.09614353 0.09925766 0.10413207 0.0983455
 0.09889492 0.10315561 0.10198263 0.09829556]
 Top predictions indices: [4] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.0997888  0.10127716 0.09614348 0.09925737 0.10413197 0.09834518
 0.09889472 0.10315528 0.10198255 0.09829537]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978899 0.10127735 0.09614353 0.09925783 0.10413212 0.09834564
 0.09889501 0.10315578 0.10198266 0.09829565]
 Top predictions indices: [4] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978864 0.10127694 0.09614342 0.09925685 0.10413183 0.09834467
 0.09889442 0.10315473 0.10198246 0.09829508]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978868 0.10127699 0.09614344 0.09925692 0.10413188 0.09834477
 0.09889448 0.10315482 0.10198248 0.09829516]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [4 7 8 1 0 3 6 5 9 2] pred: [0.09978881 0.10127711 0.0961435  0.09925721 0.10413196 0.09834507
 0.09889467 0.10315515 0.10198255 0.09829533]
 Top predictions indices: [4] vs. real classes indices: [6]
Jaccard Score: 0.0
 
Exécution 4 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_14"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_14 (Embedding)     (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_14 (Bidirectio (None, 60)                14760     
_________________________________________________________________
dense_14 (Dense)             (None, 10)                610       
=================================================================
Total params: 17,870
Trainable params: 17,870
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2494 - accuracy: 0.09972/5 [===========>..................] - ETA: 2s - loss: 0.2480 - accuracy: 0.09893/5 [=================>............] - ETA: 1s - loss: 0.2466 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.2452 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.2451 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.2451 - accuracy: 0.0995
Epoch 2/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2351 - accuracy: 0.09782/5 [===========>..................] - ETA: 2s - loss: 0.2336 - accuracy: 0.09983/5 [=================>............] - ETA: 1s - loss: 0.2320 - accuracy: 0.09954/5 [=======================>......] - ETA: 1s - loss: 0.2304 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.2304 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.2304 - accuracy: 0.0995
Epoch 3/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2187 - accuracy: 0.09642/5 [===========>..................] - ETA: 2s - loss: 0.2168 - accuracy: 0.09883/5 [=================>............] - ETA: 1s - loss: 0.2149 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.2129 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.2128 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.2128 - accuracy: 0.0995
Epoch 4/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1980 - accuracy: 0.10002/5 [===========>..................] - ETA: 2s - loss: 0.1957 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.1932 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.1907 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.1906 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.1906 - accuracy: 0.0995
Epoch 5/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1718 - accuracy: 0.10182/5 [===========>..................] - ETA: 2s - loss: 0.1689 - accuracy: 0.09983/5 [=================>............] - ETA: 1s - loss: 0.1659 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.1628 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.1627 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.1627 - accuracy: 0.0995
Epoch 6/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1409 - accuracy: 0.09942/5 [===========>..................] - ETA: 2s - loss: 0.1378 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.1347 - accuracy: 0.10004/5 [=======================>......] - ETA: 1s - loss: 0.1317 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.1316 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.1316 - accuracy: 0.0995
Epoch 7/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1117 - accuracy: 0.09962/5 [===========>..................] - ETA: 2s - loss: 0.1094 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.1073 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.1054 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.1054 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.1054 - accuracy: 0.0995
Epoch 8/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0953 - accuracy: 0.09742/5 [===========>..................] - ETA: 2s - loss: 0.0945 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0940 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0937 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0937 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0937 - accuracy: 0.0995
Epoch 9/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0924 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.0923 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.0924 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0924 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0924 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0924 - accuracy: 0.0995
Epoch 10/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0928 - accuracy: 0.09402/5 [===========>..................] - ETA: 2s - loss: 0.0928 - accuracy: 0.09753/5 [=================>............] - ETA: 1s - loss: 0.0928 - accuracy: 0.09854/5 [=======================>......] - ETA: 1s - loss: 0.0928 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0928 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0928 - accuracy: 0.0995
Epoch 11/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0930 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.0929 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.0929 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0929 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0929 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0929 - accuracy: 0.0995
Epoch 12/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0926 - accuracy: 0.10272/5 [===========>..................] - ETA: 2s - loss: 0.0926 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.0926 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0925 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0925 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.0925 - accuracy: 0.1011
Epoch 13/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0921 - accuracy: 0.10082/5 [===========>..................] - ETA: 2s - loss: 0.0920 - accuracy: 0.10013/5 [=================>............] - ETA: 1s - loss: 0.0920 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.0919 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0919 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0919 - accuracy: 0.1001
Epoch 14/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0914 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.0913 - accuracy: 0.10253/5 [=================>............] - ETA: 1s - loss: 0.0913 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.0912 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0912 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0912 - accuracy: 0.1001
Epoch 15/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0908 - accuracy: 0.10002/5 [===========>..................] - ETA: 2s - loss: 0.0908 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0907 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0907 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0907 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0907 - accuracy: 0.1001
Epoch 16/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0905 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.0904 - accuracy: 0.10093/5 [=================>............] - ETA: 1s - loss: 0.0904 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0904 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0904 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0904 - accuracy: 0.1001
Epoch 17/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0903 - accuracy: 0.09532/5 [===========>..................] - ETA: 2s - loss: 0.0903 - accuracy: 0.09693/5 [=================>............] - ETA: 1s - loss: 0.0903 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.0903 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0903 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0903 - accuracy: 0.1001
Epoch 18/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10122/5 [===========>..................] - ETA: 2s - loss: 0.0903 - accuracy: 0.10043/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.0998
Epoch 19/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.09912/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.09863/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.0998
Epoch 20/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.09992/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.09903/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.09914/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.0996
Epoch 21/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09752/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.09783/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1001
Epoch 22/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09342/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1001
Epoch 23/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09992/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10183/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10085/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1008
Epoch 24/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10422/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0995
Epoch 25/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10232/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10055/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1005
Epoch 26/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10043/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1014
Epoch 27/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09522/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09823/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 28/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10293/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 29/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09912/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0998
Epoch 30/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0995
Epoch 31/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10352/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09834/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09945/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0994
Epoch 32/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09882/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09843/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09885/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09905/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0990
Epoch 33/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10302/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 34/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10342/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 35/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10353/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 36/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10012/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1014
Epoch 37/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10552/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10353/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10294/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10275/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10275/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1027
Epoch 38/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10242/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10174/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1010
Epoch 39/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09782/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1010
Epoch 40/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09962/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1010
Epoch 41/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10682/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10233/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10154/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1010
Epoch 42/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10182/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10224/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1010
Epoch 43/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09972/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1010
Epoch 44/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10252/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10304/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10265/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1028
Epoch 45/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10013/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0995
Epoch 46/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1000
Epoch 47/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0998
Epoch 48/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10462/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10353/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 49/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10442/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 50/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09842/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09903/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08e20eed40> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09582/3 [===================>..........] - ETA: 0s - loss: 0.0900 - accuracy: 0.09773/3 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09743/3 [==============================] - 0s 105ms/step - loss: 0.0900 - accuracy: 0.0974
2021-12-07 17:17:29.486150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:17:29.486529: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:17:29.486641: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:17:29.486655: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:17:29.486681: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:17:29.486696: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:17:29.486710: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:17:29.486728: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:17:29.487529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:17:29.487558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:17:29.487564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:17:29.487570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:17:29.488317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 17:17:29.488932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:17:29.488958: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:17:29.488991: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:17:29.489003: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:17:29.489014: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:17:29.489026: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:17:29.489037: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:17:29.489053: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:17:29.489773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:17:29.489791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:17:29.489797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:17:29.489803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:17:29.490542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049293 0.10298622 0.09925907 0.09686277 0.10037319 0.10063372
 0.10011653 0.09911016 0.10118586 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049293 0.10298621 0.09925907 0.09686277 0.10037319 0.10063372
 0.10011653 0.09911016 0.10118586 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049288 0.10298616 0.099259   0.09686267 0.10037314 0.10063364
 0.10011648 0.09911006 0.10118579 0.09803578]
 Top predictions indices: [1] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049288 0.10298616 0.09925903 0.09686267 0.10037314 0.10063364
 0.10011648 0.09911006 0.10118579 0.0980358 ]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049293 0.10298622 0.09925907 0.09686277 0.10037319 0.10063372
 0.10011653 0.09911016 0.10118588 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049293 0.10298621 0.09925907 0.09686277 0.10037319 0.10063372
 0.10011653 0.09911013 0.10118586 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049293 0.10298621 0.09925907 0.09686277 0.10037319 0.1006337
 0.10011653 0.09911016 0.10118583 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049295 0.10298625 0.09925909 0.09686279 0.10037321 0.1006337
 0.10011653 0.09911016 0.10118586 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049293 0.10298621 0.09925907 0.09686277 0.10037319 0.10063372
 0.10011653 0.09911016 0.10118586 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049286 0.10298616 0.09925903 0.09686267 0.10037314 0.10063364
 0.10011648 0.09911006 0.10118579 0.09803578]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049293 0.10298621 0.09925907 0.09686277 0.10037319 0.10063372
 0.10011653 0.09911016 0.10118586 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049293 0.10298622 0.09925907 0.09686277 0.10037319 0.1006337
 0.10011653 0.09911016 0.10118583 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049293 0.10298622 0.09925907 0.09686277 0.10037319 0.10063372
 0.10011653 0.09911016 0.10118586 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049293 0.10298622 0.09925907 0.09686277 0.10037321 0.10063372
 0.10011653 0.09911016 0.10118588 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [1 8 5 0 4 6 2 7 9 3] pred: [0.10049293 0.10298621 0.09925907 0.09686277 0.10037319 0.1006337
 0.10011653 0.09911013 0.10118586 0.09803586]
 Top predictions indices: [1] vs. real classes indices: [9]
Jaccard Score: 0.0
 
Exécution 5 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_15"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_15 (Embedding)     (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_15 (Bidirectio (None, 60)                14760     
_________________________________________________________________
dense_15 (Dense)             (None, 10)                610       
=================================================================
Total params: 17,870
Trainable params: 17,870
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2478 - accuracy: 0.09422/5 [===========>..................] - ETA: 2s - loss: 0.2466 - accuracy: 0.09853/5 [=================>............] - ETA: 1s - loss: 0.2453 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.2440 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.2440 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.2440 - accuracy: 0.0997
Epoch 2/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2345 - accuracy: 0.09722/5 [===========>..................] - ETA: 2s - loss: 0.2331 - accuracy: 0.09843/5 [=================>............] - ETA: 1s - loss: 0.2315 - accuracy: 0.09874/5 [=======================>......] - ETA: 1s - loss: 0.2300 - accuracy: 0.09785/5 [==============================] - ETA: 0s - loss: 0.2299 - accuracy: 0.09775/5 [==============================] - 5s 1s/step - loss: 0.2299 - accuracy: 0.0977
Epoch 3/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2181 - accuracy: 0.09842/5 [===========>..................] - ETA: 2s - loss: 0.2161 - accuracy: 0.09863/5 [=================>............] - ETA: 1s - loss: 0.2140 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.2119 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.2118 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.2118 - accuracy: 0.0995
Epoch 4/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1958 - accuracy: 0.09732/5 [===========>..................] - ETA: 2s - loss: 0.1932 - accuracy: 0.10093/5 [=================>............] - ETA: 1s - loss: 0.1904 - accuracy: 0.09954/5 [=======================>......] - ETA: 1s - loss: 0.1875 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.1874 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.1874 - accuracy: 0.0995
Epoch 5/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1661 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.1626 - accuracy: 0.09863/5 [=================>............] - ETA: 1s - loss: 0.1591 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.1555 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.1554 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.1554 - accuracy: 0.0995
Epoch 6/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1298 - accuracy: 0.10272/5 [===========>..................] - ETA: 2s - loss: 0.1262 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.1227 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.1195 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.1194 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.1194 - accuracy: 0.0995
Epoch 7/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0994 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.0976 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0963 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0952 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0952 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0952 - accuracy: 0.0995
Epoch 8/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0909 - accuracy: 0.09802/5 [===========>..................] - ETA: 2s - loss: 0.0910 - accuracy: 0.09823/5 [=================>............] - ETA: 1s - loss: 0.0911 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.0912 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0912 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0912 - accuracy: 0.0995
Epoch 9/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0924 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.0924 - accuracy: 0.09813/5 [=================>............] - ETA: 1s - loss: 0.0926 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.0927 - accuracy: 0.09915/5 [==============================] - ETA: 0s - loss: 0.0927 - accuracy: 0.09905/5 [==============================] - 5s 1s/step - loss: 0.0927 - accuracy: 0.0990
Epoch 10/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0932 - accuracy: 0.09852/5 [===========>..................] - ETA: 2s - loss: 0.0933 - accuracy: 0.09533/5 [=================>............] - ETA: 1s - loss: 0.0933 - accuracy: 0.09754/5 [=======================>......] - ETA: 1s - loss: 0.0933 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0933 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0933 - accuracy: 0.0997
Epoch 11/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0933 - accuracy: 0.09912/5 [===========>..................] - ETA: 2s - loss: 0.0933 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.0933 - accuracy: 0.09824/5 [=======================>......] - ETA: 1s - loss: 0.0933 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0933 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0933 - accuracy: 0.0997
Epoch 12/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0929 - accuracy: 0.09852/5 [===========>..................] - ETA: 2s - loss: 0.0928 - accuracy: 0.10073/5 [=================>............] - ETA: 1s - loss: 0.0928 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.0927 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0927 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0927 - accuracy: 0.0997
Epoch 13/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0922 - accuracy: 0.09992/5 [===========>..................] - ETA: 2s - loss: 0.0921 - accuracy: 0.10003/5 [=================>............] - ETA: 1s - loss: 0.0920 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0919 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0919 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0919 - accuracy: 0.0997
Epoch 14/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0913 - accuracy: 0.09882/5 [===========>..................] - ETA: 2s - loss: 0.0913 - accuracy: 0.09873/5 [=================>............] - ETA: 1s - loss: 0.0912 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.0911 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0911 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0911 - accuracy: 0.0997
Epoch 15/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0907 - accuracy: 0.10252/5 [===========>..................] - ETA: 2s - loss: 0.0906 - accuracy: 0.09883/5 [=================>............] - ETA: 1s - loss: 0.0906 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.0905 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0905 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0905 - accuracy: 0.0997
Epoch 16/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0903 - accuracy: 0.10232/5 [===========>..................] - ETA: 2s - loss: 0.0903 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.0903 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0903 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0903 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0903 - accuracy: 0.0997
Epoch 17/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0903 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0903 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.0997
Epoch 18/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10352/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.0997
Epoch 19/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.09462/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.09333/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.09564/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.09675/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.09685/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.0968
Epoch 20/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.09642/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.09613/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.09784/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.09845/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.09825/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.0982
Epoch 21/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1014
Epoch 22/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10722/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10473/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10224/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1014
Epoch 23/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09852/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 24/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 25/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10752/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10423/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10234/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 26/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10232/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10093/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 27/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10252/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 28/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 29/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10093/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 30/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 31/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 32/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10122/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10073/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10334/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 33/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10055/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1005
Epoch 34/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10462/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10503/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10264/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 35/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09992/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10073/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 36/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10142/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10263/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 37/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1014
Epoch 38/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09502/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09813/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09954/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1001
Epoch 39/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09812/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09873/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0998
Epoch 40/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10412/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1023
Epoch 41/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 42/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 43/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10242/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10383/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 44/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09582/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09983/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0999
Epoch 45/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09812/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10183/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0995
Epoch 46/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09983/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 47/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09732/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10093/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10224/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 48/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10095/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1009
Epoch 49/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10185/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 50/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10292/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10353/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10255/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1025
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08e32da680> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09752/3 [===================>..........] - ETA: 0s - loss: 0.0900 - accuracy: 0.09743/3 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09743/3 [==============================] - 0s 112ms/step - loss: 0.0900 - accuracy: 0.0974
2021-12-07 17:24:50.440545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:24:50.440815: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:24:50.440925: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:24:50.440942: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:24:50.440961: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:24:50.440976: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:24:50.440991: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:24:50.441022: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:24:50.441857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:24:50.441886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:24:50.441893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:24:50.441898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:24:50.442683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 17:24:50.443448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:24:50.443475: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:24:50.443516: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:24:50.443529: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:24:50.443540: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:24:50.443551: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:24:50.443563: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:24:50.443575: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:24:50.444286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:24:50.444305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:24:50.444311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:24:50.444316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:24:50.445040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09844994 0.10245088 0.10143714 0.10020734 0.09777424 0.10080568
 0.09916122 0.0974219  0.09791877 0.10033252]
 Top predictions indices: [1] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.0984515  0.10245234 0.10143881 0.10020818 0.09777524 0.10080706
 0.0991624  0.09742303 0.0979194  0.10033381]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845051 0.1024514  0.10143773 0.10020762 0.0977746  0.10080618
 0.09916162 0.0974223  0.09791896 0.10033295]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845184 0.10245263 0.10143916 0.10020836 0.09777543 0.10080735
 0.09916263 0.09742324 0.09791953 0.10033405]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845061 0.10245149 0.10143786 0.10020769 0.09777468 0.10080624
 0.09916169 0.09742236 0.097919   0.10033304]
 Top predictions indices: [1] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845061 0.10245149 0.10143786 0.10020769 0.09777465 0.10080624
 0.09916168 0.09742236 0.09791898 0.10033304]
 Top predictions indices: [1] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845155 0.10245237 0.10143881 0.1002082  0.09777526 0.10080709
 0.09916242 0.09742303 0.09791943 0.10033381]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845059 0.10245149 0.10143784 0.10020766 0.09777465 0.10080624
 0.09916168 0.09742234 0.09791898 0.10033304]
 Top predictions indices: [1] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845013 0.10245105 0.10143734 0.10020743 0.09777439 0.10080581
 0.09916133 0.09742203 0.09791882 0.10033266]
 Top predictions indices: [1] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845193 0.10245272 0.10143925 0.10020839 0.0977755  0.10080742
 0.0991627  0.09742333 0.09791958 0.10033412]
 Top predictions indices: [1] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845193 0.10245272 0.10143927 0.10020839 0.09777547 0.10080742
 0.0991627  0.09742333 0.09791955 0.10033414]
 Top predictions indices: [1] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845174 0.10245254 0.10143902 0.10020829 0.09777537 0.10080723
 0.09916256 0.09742319 0.09791949 0.10033398]
 Top predictions indices: [1] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845193 0.10245272 0.10143925 0.10020837 0.0977755  0.10080743
 0.0991627  0.09742331 0.09791958 0.10033414]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845015 0.10245109 0.10143734 0.10020743 0.0977744  0.10080586
 0.09916136 0.09742203 0.09791884 0.10033267]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 5 9 3 6 0 8 4 7] pred: [0.09845049 0.10245135 0.10143773 0.1002076  0.0977746  0.10080616
 0.09916159 0.09742227 0.09791894 0.10033294]
 Top predictions indices: [1] vs. real classes indices: [9]
Jaccard Score: 0.0
 
Exécution 6 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_16"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_16 (Embedding)     (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_16 (Bidirectio (None, 60)                14760     
_________________________________________________________________
dense_16 (Dense)             (None, 10)                610       
=================================================================
Total params: 17,870
Trainable params: 17,870
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2485 - accuracy: 0.10082/5 [===========>..................] - ETA: 2s - loss: 0.2471 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.2457 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.2442 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.2442 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.2442 - accuracy: 0.1006
Epoch 2/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2341 - accuracy: 0.09892/5 [===========>..................] - ETA: 2s - loss: 0.2326 - accuracy: 0.09863/5 [=================>............] - ETA: 1s - loss: 0.2311 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.2295 - accuracy: 0.09925/5 [==============================] - ETA: 0s - loss: 0.2295 - accuracy: 0.09925/5 [==============================] - 5s 1s/step - loss: 0.2295 - accuracy: 0.0992
Epoch 3/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2181 - accuracy: 0.10142/5 [===========>..................] - ETA: 2s - loss: 0.2163 - accuracy: 0.10443/5 [=================>............] - ETA: 1s - loss: 0.2144 - accuracy: 0.10484/5 [=======================>......] - ETA: 1s - loss: 0.2125 - accuracy: 0.10285/5 [==============================] - ETA: 0s - loss: 0.2124 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.2124 - accuracy: 0.1028
Epoch 4/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1983 - accuracy: 0.10712/5 [===========>..................] - ETA: 2s - loss: 0.1961 - accuracy: 0.10253/5 [=================>............] - ETA: 1s - loss: 0.1937 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.1913 - accuracy: 0.10255/5 [==============================] - ETA: 0s - loss: 0.1912 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.1912 - accuracy: 0.1028
Epoch 5/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1734 - accuracy: 0.10412/5 [===========>..................] - ETA: 2s - loss: 0.1706 - accuracy: 0.10353/5 [=================>............] - ETA: 1s - loss: 0.1676 - accuracy: 0.10344/5 [=======================>......] - ETA: 1s - loss: 0.1646 - accuracy: 0.10275/5 [==============================] - ETA: 0s - loss: 0.1645 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.1645 - accuracy: 0.1028
Epoch 6/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1432 - accuracy: 0.09862/5 [===========>..................] - ETA: 2s - loss: 0.1400 - accuracy: 0.09813/5 [=================>............] - ETA: 1s - loss: 0.1367 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.1335 - accuracy: 0.10285/5 [==============================] - ETA: 0s - loss: 0.1334 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.1334 - accuracy: 0.1028
Epoch 7/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1123 - accuracy: 0.09722/5 [===========>..................] - ETA: 2s - loss: 0.1097 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.1072 - accuracy: 0.10174/5 [=======================>......] - ETA: 1s - loss: 0.1051 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.1050 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.1050 - accuracy: 0.1002
Epoch 8/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0934 - accuracy: 0.09852/5 [===========>..................] - ETA: 2s - loss: 0.0928 - accuracy: 0.09783/5 [=================>............] - ETA: 1s - loss: 0.0923 - accuracy: 0.09874/5 [=======================>......] - ETA: 1s - loss: 0.0919 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0919 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0919 - accuracy: 0.1002
Epoch 9/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0911 - accuracy: 0.10122/5 [===========>..................] - ETA: 2s - loss: 0.0912 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.0913 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.0914 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0914 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0914 - accuracy: 0.1002
Epoch 10/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0922 - accuracy: 0.10442/5 [===========>..................] - ETA: 2s - loss: 0.0923 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.0924 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0924 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0924 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0924 - accuracy: 0.1002
Epoch 11/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0928 - accuracy: 0.09862/5 [===========>..................] - ETA: 2s - loss: 0.0928 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.0928 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0928 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0928 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0928 - accuracy: 0.0998
Epoch 12/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0927 - accuracy: 0.09662/5 [===========>..................] - ETA: 2s - loss: 0.0927 - accuracy: 0.09753/5 [=================>............] - ETA: 1s - loss: 0.0927 - accuracy: 0.09894/5 [=======================>......] - ETA: 1s - loss: 0.0926 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0926 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0926 - accuracy: 0.0998
Epoch 13/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0923 - accuracy: 0.09732/5 [===========>..................] - ETA: 2s - loss: 0.0923 - accuracy: 0.09753/5 [=================>............] - ETA: 1s - loss: 0.0922 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0921 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0921 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0921 - accuracy: 0.0998
Epoch 14/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0917 - accuracy: 0.09802/5 [===========>..................] - ETA: 2s - loss: 0.0917 - accuracy: 0.10003/5 [=================>............] - ETA: 1s - loss: 0.0916 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.0915 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0915 - accuracy: 0.09975/5 [==============================] - 5s 1s/step - loss: 0.0915 - accuracy: 0.0997
Epoch 15/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0911 - accuracy: 0.10512/5 [===========>..................] - ETA: 2s - loss: 0.0910 - accuracy: 0.10353/5 [=================>............] - ETA: 1s - loss: 0.0910 - accuracy: 0.10294/5 [=======================>......] - ETA: 1s - loss: 0.0909 - accuracy: 0.10285/5 [==============================] - ETA: 0s - loss: 0.0909 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0909 - accuracy: 0.1028
Epoch 16/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0906 - accuracy: 0.10282/5 [===========>..................] - ETA: 2s - loss: 0.0905 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0905 - accuracy: 0.10224/5 [=======================>......] - ETA: 1s - loss: 0.0905 - accuracy: 0.10255/5 [==============================] - ETA: 0s - loss: 0.0905 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0905 - accuracy: 0.1028
Epoch 17/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0903 - accuracy: 0.09842/5 [===========>..................] - ETA: 2s - loss: 0.0903 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0903 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0903 - accuracy: 0.10295/5 [==============================] - ETA: 0s - loss: 0.0903 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0903 - accuracy: 0.1028
Epoch 18/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10002/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.10285/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.1028
Epoch 19/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10382/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10313/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10294/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.10305/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.1028
Epoch 20/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.10265/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.1028
Epoch 21/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10213/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10444/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10275/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1028
Epoch 22/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10073/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10324/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10275/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1028
Epoch 23/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10295/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1028
Epoch 24/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10133/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 25/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09592/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 26/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10992/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10473/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 27/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09802/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09633/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09814/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 28/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10532/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10473/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10294/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10295/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1028
Epoch 29/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1001
Epoch 30/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1000
Epoch 31/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09502/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1000
Epoch 32/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10072/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1000
Epoch 33/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10452/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1001
Epoch 34/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09802/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09884/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0998
Epoch 35/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10462/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10323/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10175/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10185/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1018
Epoch 36/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09202/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09603/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 37/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09892/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10073/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 38/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09642/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09823/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 39/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09743/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 40/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09832/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09853/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10055/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1005
Epoch 41/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09672/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09843/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09935/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0991
Epoch 42/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0996
Epoch 43/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10342/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10353/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10254/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10285/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1028
Epoch 44/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10153/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10284/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10285/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1028
Epoch 45/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10622/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10373/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10404/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10295/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1028
Epoch 46/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10552/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10413/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10264/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10295/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1028
Epoch 47/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09622/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10285/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10265/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1026
Epoch 48/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10242/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10233/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09925/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0992
Epoch 49/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09592/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10003/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1016
Epoch 50/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10392/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10334/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10275/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10285/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1028
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08e0bbe8c0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09382/3 [===================>..........] - ETA: 0s - loss: 0.0900 - accuracy: 0.09423/3 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09463/3 [==============================] - 0s 107ms/step - loss: 0.0900 - accuracy: 0.0946
2021-12-07 17:32:11.357075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:32:11.357287: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:32:11.357743: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:32:11.357763: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:32:11.357781: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:32:11.357797: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:32:11.357813: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:32:11.357843: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:32:11.358635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:32:11.358663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:32:11.358670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:32:11.358675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:32:11.359426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 17:32:11.360060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:32:11.360087: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:32:11.360126: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:32:11.360138: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:32:11.360150: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:32:11.360161: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:32:11.360172: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:32:11.360184: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:32:11.360904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:32:11.360922: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:32:11.360928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:32:11.360934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:32:11.361676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054389 0.10277414 0.10022596 0.09885757 0.09881814 0.10011386
 0.10064671 0.10067246 0.09904169 0.1002868 ]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054409 0.1027744  0.10022608 0.09885772 0.09881832 0.10011412
 0.10064694 0.10067267 0.09904173 0.10028692]
 Top predictions indices: [1] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054389 0.10277414 0.10022596 0.09885756 0.09881814 0.10011386
 0.10064671 0.10067246 0.09904169 0.1002868 ]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054409 0.1027744  0.10022608 0.09885772 0.09881832 0.10011412
 0.10064694 0.10067267 0.09904173 0.10028692]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054389 0.10277414 0.10022598 0.09885757 0.09881814 0.10011388
 0.10064671 0.10067249 0.09904166 0.1002868 ]
 Top predictions indices: [1] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054411 0.10277443 0.10022608 0.09885772 0.09881832 0.10011414
 0.10064694 0.10067267 0.09904175 0.10028692]
 Top predictions indices: [1] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054389 0.10277414 0.10022596 0.09885757 0.09881814 0.10011386
 0.10064671 0.10067246 0.09904169 0.1002868 ]
 Top predictions indices: [1] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054389 0.10277414 0.10022596 0.09885757 0.09881814 0.10011386
 0.10064671 0.10067246 0.09904166 0.1002868 ]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054389 0.10277414 0.10022596 0.09885756 0.09881814 0.10011388
 0.10064671 0.10067249 0.09904169 0.1002868 ]
 Top predictions indices: [1] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054409 0.1027744  0.10022608 0.09885772 0.09881832 0.10011412
 0.10064694 0.10067267 0.09904173 0.10028692]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054389 0.10277414 0.10022596 0.09885757 0.09881814 0.10011386
 0.10064671 0.10067246 0.09904169 0.1002868 ]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054411 0.10277443 0.10022608 0.09885772 0.09881832 0.10011414
 0.10064694 0.10067267 0.09904175 0.10028692]
 Top predictions indices: [1] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054411 0.10277443 0.10022608 0.09885772 0.09881832 0.10011414
 0.10064694 0.10067267 0.09904175 0.10028692]
 Top predictions indices: [1] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054389 0.10277414 0.10022596 0.09885757 0.09881814 0.10011386
 0.10064671 0.10067246 0.09904169 0.1002868 ]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [1 7 6 0 9 2 5 8 3 4] pred: [0.10054389 0.10277414 0.10022596 0.09885756 0.09881814 0.10011386
 0.10064671 0.10067246 0.09904169 0.1002868 ]
 Top predictions indices: [1] vs. real classes indices: [8]
Jaccard Score: 0.0
 
Exécution 7 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_17"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_17 (Embedding)     (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_17 (Bidirectio (None, 60)                14760     
_________________________________________________________________
dense_17 (Dense)             (None, 10)                610       
=================================================================
Total params: 17,870
Trainable params: 17,870
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2546 - accuracy: 0.10442/5 [===========>..................] - ETA: 2s - loss: 0.2531 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.2516 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.2501 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.2501 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.2501 - accuracy: 0.0999
Epoch 2/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2401 - accuracy: 0.09992/5 [===========>..................] - ETA: 2s - loss: 0.2387 - accuracy: 0.09963/5 [=================>............] - ETA: 1s - loss: 0.2372 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.2358 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.2357 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.2357 - accuracy: 0.0999
Epoch 3/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2253 - accuracy: 0.09642/5 [===========>..................] - ETA: 2s - loss: 0.2236 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.2220 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.2203 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.2202 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.2202 - accuracy: 0.1015
Epoch 4/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2077 - accuracy: 0.10362/5 [===========>..................] - ETA: 2s - loss: 0.2057 - accuracy: 0.09983/5 [=================>............] - ETA: 1s - loss: 0.2036 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.2014 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.2013 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.2013 - accuracy: 0.1015
Epoch 5/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1856 - accuracy: 0.09962/5 [===========>..................] - ETA: 2s - loss: 0.1831 - accuracy: 0.09913/5 [=================>............] - ETA: 1s - loss: 0.1805 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.1778 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.1777 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.1777 - accuracy: 0.1015
Epoch 6/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1585 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.1556 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.1526 - accuracy: 0.10174/5 [=======================>......] - ETA: 1s - loss: 0.1496 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.1495 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.1495 - accuracy: 0.1015
Epoch 7/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1286 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.1257 - accuracy: 0.10183/5 [=================>............] - ETA: 1s - loss: 0.1230 - accuracy: 0.10314/5 [=======================>......] - ETA: 1s - loss: 0.1204 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.1203 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.1203 - accuracy: 0.1015
Epoch 8/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1038 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.1021 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.1006 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0994 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0993 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0993 - accuracy: 0.1015
Epoch 9/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0930 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.0926 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.0924 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.0923 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0923 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0923 - accuracy: 0.1015
Epoch 10/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0919 - accuracy: 0.10222/5 [===========>..................] - ETA: 2s - loss: 0.0920 - accuracy: 0.10273/5 [=================>............] - ETA: 1s - loss: 0.0921 - accuracy: 0.10314/5 [=======================>......] - ETA: 1s - loss: 0.0922 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0922 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0922 - accuracy: 0.1015
Epoch 11/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0926 - accuracy: 0.10412/5 [===========>..................] - ETA: 2s - loss: 0.0927 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.0927 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0927 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0927 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0927 - accuracy: 0.1015
Epoch 12/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0927 - accuracy: 0.09992/5 [===========>..................] - ETA: 2s - loss: 0.0926 - accuracy: 0.10233/5 [=================>............] - ETA: 1s - loss: 0.0926 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0925 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0925 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0925 - accuracy: 0.1015
Epoch 13/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0921 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.0920 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.0919 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.0918 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0918 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0918 - accuracy: 0.1015
Epoch 14/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0912 - accuracy: 0.09802/5 [===========>..................] - ETA: 2s - loss: 0.0911 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0910 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0909 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0909 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0909 - accuracy: 0.1015
Epoch 15/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0905 - accuracy: 0.09962/5 [===========>..................] - ETA: 2s - loss: 0.0904 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.0904 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.0903 - accuracy: 0.09805/5 [==============================] - ETA: 0s - loss: 0.0903 - accuracy: 0.09785/5 [==============================] - 5s 1s/step - loss: 0.0903 - accuracy: 0.0978
Epoch 16/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10522/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.09845/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.09855/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.0985
Epoch 17/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.09442/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.09613/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.09754/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.09855/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.09855/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.0985
Epoch 18/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.09512/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.09914/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.09845/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.09855/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.0985
Epoch 19/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10232/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.09874/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.09855/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.09855/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.0985
Epoch 20/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09992/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09863/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09824/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09865/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09855/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0985
Epoch 21/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09642/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09913/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09885/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09905/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0990
Epoch 22/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10522/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10043/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10004/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10145/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 23/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09672/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 24/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10082/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09983/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 25/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 26/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10382/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 27/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10792/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10263/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 28/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09972/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10383/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 29/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10442/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10403/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 30/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10362/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10413/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10334/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10265/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 31/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09702/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09863/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1001
Epoch 32/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 33/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10462/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10183/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 34/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10265/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 35/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10292/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10344/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 36/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10255/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 37/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10073/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09794/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09805/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09805/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0980
Epoch 38/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10122/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09915/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0991
Epoch 39/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10122/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09905/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09895/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0989
Epoch 40/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09522/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09803/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09915/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0991
Epoch 41/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10102/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09933/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09935/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09915/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0991
Epoch 42/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10073/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 43/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10102/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10353/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10284/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 44/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 45/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10215/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 46/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09742/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 47/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09842/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09863/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10314/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10225/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 48/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09842/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10204/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10255/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
Epoch 49/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09572/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10174/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10195/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10185/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1018
Epoch 50/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10032/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10353/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10264/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10245/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1024
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08d98538c0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09692/3 [===================>..........] - ETA: 0s - loss: 0.0900 - accuracy: 0.09493/3 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09543/3 [==============================] - 0s 109ms/step - loss: 0.0900 - accuracy: 0.0954
2021-12-07 17:39:32.284382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:39:32.284814: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:39:32.285458: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:39:32.285477: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:39:32.285496: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:39:32.285517: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:39:32.285543: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:39:32.285561: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:39:32.286343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:39:32.286371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:39:32.286378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:39:32.286383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:39:32.287137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 17:39:32.287810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:39:32.287835: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:39:32.287871: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:39:32.287883: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:39:32.287894: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:39:32.287906: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:39:32.287917: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:39:32.287928: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:39:32.288646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:39:32.288664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:39:32.288670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:39:32.288676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:39:32.289397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870807 0.10366842 0.09793201 0.09817488 0.10464513 0.09899747
 0.10043869 0.09796208 0.10020317 0.09799849]
 Top predictions indices: [4] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870768 0.10366811 0.09793175 0.09817474 0.10464468 0.09899706
 0.10043846 0.09796172 0.10020289 0.09799807]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870805 0.10366842 0.097932   0.09817486 0.10464513 0.09899744
 0.10043872 0.09796208 0.10020316 0.09799849]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870787 0.10366827 0.0979319  0.0981748  0.1046449  0.09899728
 0.10043859 0.09796192 0.10020302 0.09799828]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870797 0.10366834 0.09793194 0.09817482 0.10464499 0.09899733
 0.10043862 0.097962   0.10020306 0.09799836]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870753 0.10366803 0.09793164 0.09817466 0.1046445  0.09899693
 0.10043837 0.09796161 0.1002028  0.0979979 ]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870809 0.10366845 0.09793204 0.0981749  0.10464515 0.09899748
 0.10043874 0.09796208 0.10020317 0.09799851]
 Top predictions indices: [4] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.0987079  0.10366829 0.0979319  0.0981748  0.1046449  0.09899728
 0.10043859 0.09796192 0.10020302 0.09799831]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870792 0.10366829 0.0979319  0.0981748  0.10464492 0.09899728
 0.10043859 0.09796192 0.10020302 0.09799831]
 Top predictions indices: [4] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870771 0.10366813 0.09793175 0.09817474 0.10464468 0.09899708
 0.10043848 0.09796174 0.10020289 0.09799807]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.0987083  0.10366861 0.09793219 0.09817497 0.10464537 0.0989977
 0.10043884 0.09796229 0.10020328 0.09799877]
 Top predictions indices: [4] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870794 0.10366834 0.09793194 0.09817484 0.10464497 0.09899732
 0.10043861 0.09796195 0.10020306 0.09799836]
 Top predictions indices: [4] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870783 0.10366824 0.09793183 0.09817477 0.10464481 0.09899718
 0.10043857 0.09796187 0.10020298 0.09799822]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870787 0.10366827 0.09793187 0.0981748  0.10464486 0.09899723
 0.10043857 0.09796189 0.10020299 0.09799826]
 Top predictions indices: [4] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [4 1 6 8 5 0 3 9 7 2] pred: [0.09870753 0.103668   0.09793164 0.09817466 0.1046445  0.09899691
 0.10043835 0.0979616  0.1002028  0.0979979 ]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score: 0.0
 
Exécution 8 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_18"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_18 (Embedding)     (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_18 (Bidirectio (None, 60)                14760     
_________________________________________________________________
dense_18 (Dense)             (None, 10)                610       
=================================================================
Total params: 17,870
Trainable params: 17,870
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2512 - accuracy: 0.09742/5 [===========>..................] - ETA: 2s - loss: 0.2501 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.2490 - accuracy: 0.09894/5 [=======================>......] - ETA: 1s - loss: 0.2480 - accuracy: 0.09935/5 [==============================] - ETA: 0s - loss: 0.2479 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.2479 - accuracy: 0.0995
Epoch 2/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2404 - accuracy: 0.09942/5 [===========>..................] - ETA: 2s - loss: 0.2392 - accuracy: 0.09793/5 [=================>............] - ETA: 1s - loss: 0.2381 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.2369 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.2369 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.2369 - accuracy: 0.0998
Epoch 3/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2282 - accuracy: 0.09222/5 [===========>..................] - ETA: 2s - loss: 0.2267 - accuracy: 0.09963/5 [=================>............] - ETA: 1s - loss: 0.2252 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.2237 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.2236 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.2236 - accuracy: 0.1002
Epoch 4/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2120 - accuracy: 0.09742/5 [===========>..................] - ETA: 2s - loss: 0.2101 - accuracy: 0.09853/5 [=================>............] - ETA: 1s - loss: 0.2080 - accuracy: 0.09824/5 [=======================>......] - ETA: 1s - loss: 0.2059 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.2058 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.2058 - accuracy: 0.0998
Epoch 5/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1897 - accuracy: 0.09782/5 [===========>..................] - ETA: 2s - loss: 0.1871 - accuracy: 0.09663/5 [=================>............] - ETA: 1s - loss: 0.1843 - accuracy: 0.09914/5 [=======================>......] - ETA: 1s - loss: 0.1813 - accuracy: 0.09965/5 [==============================] - ETA: 0s - loss: 0.1812 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.1812 - accuracy: 0.0998
Epoch 6/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1598 - accuracy: 0.10182/5 [===========>..................] - ETA: 2s - loss: 0.1564 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.1529 - accuracy: 0.10224/5 [=======================>......] - ETA: 1s - loss: 0.1495 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.1494 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.1494 - accuracy: 0.0998
Epoch 7/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1250 - accuracy: 0.10452/5 [===========>..................] - ETA: 2s - loss: 0.1218 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.1188 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.1160 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.1159 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.1159 - accuracy: 0.0998
Epoch 8/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0992 - accuracy: 0.09992/5 [===========>..................] - ETA: 2s - loss: 0.0980 - accuracy: 0.09823/5 [=================>............] - ETA: 1s - loss: 0.0969 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.0960 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0960 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0960 - accuracy: 0.0998
Epoch 9/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0924 - accuracy: 0.09612/5 [===========>..................] - ETA: 2s - loss: 0.0922 - accuracy: 0.09593/5 [=================>............] - ETA: 1s - loss: 0.0921 - accuracy: 0.09774/5 [=======================>......] - ETA: 1s - loss: 0.0920 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0920 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0920 - accuracy: 0.0998
Epoch 10/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0921 - accuracy: 0.09992/5 [===========>..................] - ETA: 2s - loss: 0.0921 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0922 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0923 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0923 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0923 - accuracy: 0.0998
Epoch 11/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0925 - accuracy: 0.09962/5 [===========>..................] - ETA: 2s - loss: 0.0925 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.0926 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.0926 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0926 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0926 - accuracy: 0.0998
Epoch 12/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0926 - accuracy: 0.09882/5 [===========>..................] - ETA: 2s - loss: 0.0925 - accuracy: 0.09823/5 [=================>............] - ETA: 1s - loss: 0.0925 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.0925 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0925 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0925 - accuracy: 0.0998
Epoch 13/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0922 - accuracy: 0.10142/5 [===========>..................] - ETA: 2s - loss: 0.0922 - accuracy: 0.09913/5 [=================>............] - ETA: 1s - loss: 0.0921 - accuracy: 0.09864/5 [=======================>......] - ETA: 1s - loss: 0.0921 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0921 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0921 - accuracy: 0.1002
Epoch 14/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0917 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.0916 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0916 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0915 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0915 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0915 - accuracy: 0.1007
Epoch 15/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0911 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.0910 - accuracy: 0.09823/5 [=================>............] - ETA: 1s - loss: 0.0910 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0909 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.0909 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0909 - accuracy: 0.1007
Epoch 16/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0905 - accuracy: 0.10102/5 [===========>..................] - ETA: 2s - loss: 0.0905 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0905 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0904 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0904 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.0904 - accuracy: 0.1011
Epoch 17/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.1011
Epoch 18/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10672/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10503/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10224/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1011
Epoch 19/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10035/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1003
Epoch 20/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10512/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10134/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10035/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1003
Epoch 21/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10333/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1007
Epoch 22/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 23/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10362/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10253/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 24/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10012/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10215/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1020
Epoch 25/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0998
Epoch 26/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10532/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1000
Epoch 27/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09813/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 28/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09814/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 29/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09972/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10143/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 30/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10302/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10064/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 31/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10003/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10074/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 32/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10602/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10303/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1012
Epoch 33/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10402/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10393/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10314/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10255/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10275/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1027
Epoch 34/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10132/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09993/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10115/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1011
Epoch 35/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10342/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10275/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10255/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1025
Epoch 36/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10292/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1007
Epoch 37/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09862/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10043/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0995
Epoch 38/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09973/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0995
Epoch 39/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10162/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10154/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1007
Epoch 40/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09812/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09893/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09934/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09965/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0996
Epoch 41/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10013/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0998
Epoch 42/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09832/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09913/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09774/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0998
Epoch 43/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09823/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09794/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0998
Epoch 44/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09752/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09753/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0998
Epoch 45/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09984/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 46/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09873/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1003
Epoch 47/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1003
Epoch 48/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09772/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10073/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09974/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1003
Epoch 49/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10272/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10063/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10035/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1003
Epoch 50/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10013/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09904/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1000
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08e19b2680> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10362/3 [===================>..........] - ETA: 0s - loss: 0.0900 - accuracy: 0.10033/3 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10043/3 [==============================] - 0s 105ms/step - loss: 0.0900 - accuracy: 0.1004
2021-12-07 17:46:52.554944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:46:52.555337: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:46:52.555766: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:46:52.555787: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:46:52.555804: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:46:52.555819: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:46:52.555847: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:46:52.555866: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:46:52.556697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:46:52.556727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:46:52.556733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:46:52.556742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:46:52.557535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-12-07 17:46:52.558314: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-PCIE-16GB computeCapability: 7.0
coreClock: 1.38GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-12-07 17:46:52.558340: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-07 17:46:52.558375: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-07 17:46:52.558387: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-07 17:46:52.558399: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-07 17:46:52.558410: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-07 17:46:52.558422: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-07 17:46:52.558433: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-07 17:46:52.559154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-07 17:46:52.559173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-07 17:46:52.559180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-07 17:46:52.559185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-07 17:46:52.559928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14789 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10202938 0.09954191 0.10377319 0.09874112 0.09559868 0.10271329
 0.09830286 0.10156088 0.09972613 0.09547653]
 Top predictions indices: [2] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10202979 0.09954204 0.10377333 0.09874129 0.09559891 0.10271323
 0.09830292 0.10156123 0.09972648 0.09547647]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10202952 0.09954195 0.10377327 0.09874119 0.09559876 0.10271331
 0.0983029  0.10156098 0.09972624 0.09547656]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10202989 0.09954208 0.10377336 0.09874135 0.09559897 0.10271323
 0.09830295 0.10156129 0.09972659 0.09547649]
 Top predictions indices: [2] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10202937 0.0995419  0.10377317 0.0987411  0.09559868 0.10271331
 0.09830283 0.10156085 0.0997261  0.09547656]
 Top predictions indices: [2] vs. real classes indices: [6]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10202964 0.09954198 0.10377327 0.09874123 0.0955988  0.10271321
 0.0983029  0.1015611  0.09972638 0.09547647]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10203    0.09954215 0.10377342 0.09874139 0.09559906 0.10271326
 0.09830301 0.10156137 0.0997267  0.09547649]
 Top predictions indices: [2] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10202987 0.09954208 0.10377336 0.09874134 0.09559897 0.10271323
 0.09830295 0.10156126 0.09972658 0.09547649]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10202979 0.09954204 0.10377333 0.09874129 0.09559888 0.10271323
 0.09830294 0.10156121 0.09972646 0.09547649]
 Top predictions indices: [2] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.1020302  0.09954223 0.1037735  0.0987415  0.09559917 0.10271326
 0.09830306 0.10156153 0.09972689 0.09547652]
 Top predictions indices: [2] vs. real classes indices: [8]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.1020302  0.09954223 0.1037735  0.0987415  0.09559917 0.10271326
 0.09830306 0.10156151 0.09972687 0.09547652]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.1020302  0.09954223 0.1037735  0.0987415  0.09559917 0.10271326
 0.09830306 0.10156151 0.09972689 0.09547652]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10202956 0.09954195 0.10377324 0.09874119 0.09559875 0.1027132
 0.09830286 0.10156103 0.09972625 0.09547645]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10203013 0.09954219 0.10377348 0.09874143 0.09559911 0.10271326
 0.09830305 0.10156149 0.09972682 0.09547653]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 5 0 7 8 1 3 6 4 9] pred: [0.10202979 0.09954204 0.10377333 0.09874132 0.09559888 0.10271323
 0.09830294 0.10156121 0.09972648 0.09547649]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
Exécution 9 : 
claroline-dis_10.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-dis_10.csv
Categories:
[0 1 2 3 4 5 6 7 8 9]
output y_tr
(33000, 300)
(33000, 10)
(17000, 300)
(17000, 10)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
50
Training a GRU
Model: "sequential_19"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_19 (Embedding)     (None, 300, 50)           2500      
_________________________________________________________________
bidirectional_19 (Bidirectio (None, 60)                14760     
_________________________________________________________________
dense_19 (Dense)             (None, 10)                610       
=================================================================
Total params: 17,870
Trainable params: 17,870
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2496 - accuracy: 0.10312/5 [===========>..................] - ETA: 2s - loss: 0.2482 - accuracy: 0.10493/5 [=================>............] - ETA: 1s - loss: 0.2468 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.2454 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.2454 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.2454 - accuracy: 0.1006
Epoch 2/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2355 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.2340 - accuracy: 0.09893/5 [=================>............] - ETA: 1s - loss: 0.2324 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.2308 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.2308 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.2308 - accuracy: 0.1000
Epoch 3/50
1/5 [=====>........................] - ETA: 0s - loss: 0.2192 - accuracy: 0.09862/5 [===========>..................] - ETA: 2s - loss: 0.2173 - accuracy: 0.10343/5 [=================>............] - ETA: 1s - loss: 0.2154 - accuracy: 0.10174/5 [=======================>......] - ETA: 1s - loss: 0.2134 - accuracy: 0.10015/5 [==============================] - ETA: 0s - loss: 0.2134 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.2134 - accuracy: 0.1000
Epoch 4/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1985 - accuracy: 0.10612/5 [===========>..................] - ETA: 2s - loss: 0.1961 - accuracy: 0.10223/5 [=================>............] - ETA: 1s - loss: 0.1936 - accuracy: 0.10054/5 [=======================>......] - ETA: 1s - loss: 0.1910 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.1909 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.1909 - accuracy: 0.1000
Epoch 5/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1717 - accuracy: 0.09622/5 [===========>..................] - ETA: 2s - loss: 0.1685 - accuracy: 0.09873/5 [=================>............] - ETA: 1s - loss: 0.1653 - accuracy: 0.09964/5 [=======================>......] - ETA: 1s - loss: 0.1621 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.1620 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.1620 - accuracy: 0.1000
Epoch 6/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1389 - accuracy: 0.10032/5 [===========>..................] - ETA: 2s - loss: 0.1358 - accuracy: 0.09943/5 [=================>............] - ETA: 1s - loss: 0.1326 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.1295 - accuracy: 0.09975/5 [==============================] - ETA: 0s - loss: 0.1294 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.1294 - accuracy: 0.1000
Epoch 7/50
1/5 [=====>........................] - ETA: 0s - loss: 0.1093 - accuracy: 0.10102/5 [===========>..................] - ETA: 2s - loss: 0.1071 - accuracy: 0.09873/5 [=================>............] - ETA: 1s - loss: 0.1051 - accuracy: 0.10044/5 [=======================>......] - ETA: 1s - loss: 0.1034 - accuracy: 0.10035/5 [==============================] - ETA: 0s - loss: 0.1034 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.1034 - accuracy: 0.1000
Epoch 8/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0943 - accuracy: 0.09952/5 [===========>..................] - ETA: 2s - loss: 0.0936 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0932 - accuracy: 0.10144/5 [=======================>......] - ETA: 1s - loss: 0.0929 - accuracy: 0.10005/5 [==============================] - ETA: 0s - loss: 0.0929 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0929 - accuracy: 0.1000
Epoch 9/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0920 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.0920 - accuracy: 0.10203/5 [=================>............] - ETA: 1s - loss: 0.0921 - accuracy: 0.10014/5 [=======================>......] - ETA: 1s - loss: 0.0922 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0922 - accuracy: 0.10005/5 [==============================] - 5s 1s/step - loss: 0.0922 - accuracy: 0.1000
Epoch 10/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0929 - accuracy: 0.09692/5 [===========>..................] - ETA: 2s - loss: 0.0929 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0929 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.0930 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0930 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0930 - accuracy: 0.0998
Epoch 11/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0932 - accuracy: 0.10352/5 [===========>..................] - ETA: 2s - loss: 0.0931 - accuracy: 0.10233/5 [=================>............] - ETA: 1s - loss: 0.0931 - accuracy: 0.10274/5 [=======================>......] - ETA: 1s - loss: 0.0931 - accuracy: 0.10185/5 [==============================] - ETA: 0s - loss: 0.0931 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.0931 - accuracy: 0.1017
Epoch 12/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0929 - accuracy: 0.10252/5 [===========>..................] - ETA: 2s - loss: 0.0928 - accuracy: 0.09923/5 [=================>............] - ETA: 1s - loss: 0.0928 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0927 - accuracy: 0.10195/5 [==============================] - ETA: 0s - loss: 0.0927 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.0927 - accuracy: 0.1017
Epoch 13/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0922 - accuracy: 0.10522/5 [===========>..................] - ETA: 2s - loss: 0.0921 - accuracy: 0.10293/5 [=================>............] - ETA: 1s - loss: 0.0920 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0919 - accuracy: 0.10095/5 [==============================] - ETA: 0s - loss: 0.0919 - accuracy: 0.10085/5 [==============================] - 5s 1s/step - loss: 0.0919 - accuracy: 0.1008
Epoch 14/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0913 - accuracy: 0.10002/5 [===========>..................] - ETA: 2s - loss: 0.0912 - accuracy: 0.09843/5 [=================>............] - ETA: 1s - loss: 0.0912 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0911 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0911 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0911 - accuracy: 0.1006
Epoch 15/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0906 - accuracy: 0.09962/5 [===========>..................] - ETA: 2s - loss: 0.0906 - accuracy: 0.09873/5 [=================>............] - ETA: 1s - loss: 0.0905 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0905 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0905 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0905 - accuracy: 0.1006
Epoch 16/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.10205/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.1020
Epoch 17/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10192/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.10153/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.1004
Epoch 18/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0902 - accuracy: 0.10062/5 [===========>..................] - ETA: 2s - loss: 0.0902 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0902 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.0902 - accuracy: 0.10055/5 [==============================] - ETA: 0s - loss: 0.0902 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0902 - accuracy: 0.1004
Epoch 19/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.09922/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10013/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.09924/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.09985/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.09985/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.0998
Epoch 20/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0901 - accuracy: 0.10442/5 [===========>..................] - ETA: 2s - loss: 0.0901 - accuracy: 0.10193/5 [=================>............] - ETA: 1s - loss: 0.0901 - accuracy: 0.10104/5 [=======================>......] - ETA: 1s - loss: 0.0901 - accuracy: 0.10175/5 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.0901 - accuracy: 0.1017
Epoch 21/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09952/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10083/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10124/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10175/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1017
Epoch 22/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10242/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10194/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10195/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1017
Epoch 23/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09882/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10283/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10085/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10075/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1007
Epoch 24/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10472/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10383/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10254/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 25/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09782/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09953/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1006
Epoch 26/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10052/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10024/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09855/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09895/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0989
Epoch 27/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09902/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09883/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09764/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09925/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09895/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0989
Epoch 28/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09502/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09743/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09784/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09915/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09895/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0989
Epoch 29/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09312/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09833/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09834/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09895/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09895/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0989
Epoch 30/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09882/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09883/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09894/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1002
Epoch 31/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10082/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10254/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10235/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10205/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1020
Epoch 32/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09512/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09994/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09955/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0995
Epoch 33/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10273/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10214/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10185/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1017
Epoch 34/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10572/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10343/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10254/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10195/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10175/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1017
Epoch 35/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10442/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10243/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10254/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10345/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10365/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1036
Epoch 36/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10113/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 37/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10412/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 38/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10292/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10173/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10244/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 39/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10172/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10053/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10094/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 40/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09874/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09995/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0999
Epoch 41/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09842/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10103/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10135/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1013
Epoch 42/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10112/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10125/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10105/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1010
Epoch 43/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10272/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10163/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10114/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10165/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10155/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1015
Epoch 44/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10352/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10023/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10034/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10025/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1004
Epoch 45/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10212/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10123/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10164/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1004
Epoch 46/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10742/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10213/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10084/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10065/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10045/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1004
Epoch 47/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09832/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09893/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09854/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09865/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09865/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0986
Epoch 48/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10032/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.09793/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09784/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09895/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09885/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0988
Epoch 49/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10472/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10393/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.10184/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.10265/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.10255/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.1025
Epoch 50/50
1/5 [=====>........................] - ETA: 0s - loss: 0.0900 - accuracy: 0.10022/5 [===========>..................] - ETA: 2s - loss: 0.0900 - accuracy: 0.10033/5 [=================>............] - ETA: 1s - loss: 0.0900 - accuracy: 0.09944/5 [=======================>......] - ETA: 1s - loss: 0.0900 - accuracy: 0.09945/5 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09935/5 [==============================] - 5s 1s/step - loss: 0.0900 - accuracy: 0.0993
WARNING:tensorflow:5 out of the last 13 calls to <function Model.make_test_function.<locals>.test_function at 0x2b08df7ceb00> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Evaluate on test data
1/3 [=========>....................] - ETA: 0s - loss: 0.0900 - accuracy: 0.09862/3 [===================>..........] - ETA: 0s - loss: 0.0900 - accuracy: 0.10033/3 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.09993/3 [==============================] - 0s 106ms/step - loss: 0.0900 - accuracy: 0.0999
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09875938 0.1011586  0.10247325 0.10004897 0.10032632 0.09692064
 0.09906437 0.0989641  0.10189073 0.09759449]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09875988 0.10115942 0.10247467 0.10004977 0.10032675 0.09692121
 0.09906513 0.09896485 0.10189151 0.09759463]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09876092 0.10116103 0.10247744 0.10005135 0.10032763 0.09692242
 0.09906671 0.09896632 0.10189294 0.09759497]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09876011 0.1011598  0.10247534 0.10005013 0.10032695 0.0969215
 0.0990655  0.09896519 0.10189185 0.09759468]
 Top predictions indices: [2] vs. real classes indices: [7]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09875988 0.10115942 0.1024747  0.10004977 0.10032675 0.09692121
 0.09906513 0.09896486 0.10189151 0.09759463]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09876032 0.10116005 0.10247572 0.10005042 0.10032712 0.09692171
 0.09906573 0.09896541 0.10189203 0.09759481]
 Top predictions indices: [2] vs. real classes indices: [5]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09876061 0.10116056 0.10247657 0.10005089 0.10032738 0.09692208
 0.09906619 0.09896587 0.10189249 0.09759487]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09876083 0.10116093 0.10247721 0.10005123 0.10032758 0.09692234
 0.09906656 0.09896618 0.10189284 0.09759492]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09875932 0.10115851 0.10247305 0.10004889 0.10032627 0.09692059
 0.09906428 0.09896401 0.10189064 0.09759447]
 Top predictions indices: [2] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09875938 0.10115863 0.10247325 0.100049   0.10032632 0.09692067
 0.09906437 0.09896412 0.10189077 0.09759449]
 Top predictions indices: [2] vs. real classes indices: [9]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09875998 0.10115958 0.10247494 0.10004991 0.10032685 0.09692133
 0.0990653  0.098965   0.10189164 0.09759463]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09876003 0.10115964 0.10247508 0.10004998 0.10032688 0.09692138
 0.09906536 0.09896506 0.1018917  0.09759466]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09875932 0.10115851 0.10247305 0.10004889 0.10032627 0.09692059
 0.09906428 0.09896401 0.10189064 0.09759447]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09875998 0.10115958 0.10247497 0.10004991 0.10032685 0.09692133
 0.0990653  0.09896501 0.10189166 0.09759463]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 8 1 4 3 6 7 0 9 5] pred: [0.09876041 0.10116021 0.10247596 0.10005054 0.10032722 0.09692182
 0.09906586 0.09896555 0.10189216 0.09759481]
 Top predictions indices: [2] vs. real classes indices: [5]
Jaccard Score: 0.0
 
Job end at mar déc  7 17:54:20 CET 2021
