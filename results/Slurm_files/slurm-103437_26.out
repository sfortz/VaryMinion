
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at lun déc 13 23:31:18 CET 2021
2021-12-13 23:31:19.739547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-13 23:31:25.780851: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:31:25.784538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-13 23:31:25.826307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:31:25.826374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:31:25.831737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:31:25.831809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:31:25.835670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:31:25.837317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:31:25.841778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:31:25.844291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:31:25.852855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:31:25.854596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:31:25.854663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:31:26.604117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:31:26.604181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:31:26.604198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:31:26.606756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:31:26.608172: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:31:26.608991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:31:26.609050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:31:26.609100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:31:26.609201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:31:26.609283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:31:26.609325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:31:26.609435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:31:26.609484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:31:26.609525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:31:26.611016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:31:26.611059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:31:26.611075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:31:26.611087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:31:26.612630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:31:28.465688: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:31:28.467564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:31:28.467619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:31:28.467726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:31:28.467780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:31:28.467871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:31:28.467924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:31:28.468036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:31:28.468086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:31:28.468188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:31:28.469282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:31:28.470394: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:31:28.471026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:31:28.471055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:31:28.471084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:31:28.471163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:31:28.471198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:31:28.471227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:31:28.471299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:31:28.471333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:31:28.471362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:31:28.472757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:31:28.472824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:31:28.472867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:31:28.472878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:31:28.474236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:31:28.474375: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-13 23:31:32.073301: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-13 23:31:32.074195: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 1994990000 Hz
2021-12-13 23:31:44.097092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:31:45.195679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
Number of possible configurations: 40
Begining exécution of the 26 th configuration: BPIC20.csv with GRU model, 20 epochs, 30 units, 128 batch_size, sigmoid as activation function and bin_ce as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 90, 58)            3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                16200     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:38 - loss: 0.6921 - accuracy: 0.0859 3/11 [=======>......................] - ETA: 0s - loss: 0.6896 - accuracy: 0.2400   5/11 [============>.................] - ETA: 0s - loss: 0.6872 - accuracy: 0.2949 8/11 [====================>.........] - ETA: 0s - loss: 0.6835 - accuracy: 0.331411/11 [==============================] - ETA: 0s - loss: 0.6796 - accuracy: 0.353511/11 [==============================] - 16s 25ms/step - loss: 0.6786 - accuracy: 0.3589
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6336 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.6286 - accuracy: 0.4275 5/11 [============>.................] - ETA: 0s - loss: 0.6245 - accuracy: 0.4371 8/11 [====================>.........] - ETA: 0s - loss: 0.6185 - accuracy: 0.443810/11 [==========================>...] - ETA: 0s - loss: 0.6145 - accuracy: 0.446411/11 [==============================] - 0s 26ms/step - loss: 0.6109 - accuracy: 0.4493
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5365 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.5327 - accuracy: 0.4488 5/11 [============>.................] - ETA: 0s - loss: 0.5240 - accuracy: 0.4565 7/11 [==================>...........] - ETA: 0s - loss: 0.5159 - accuracy: 0.461910/11 [==========================>...] - ETA: 0s - loss: 0.5065 - accuracy: 0.464911/11 [==============================] - 0s 26ms/step - loss: 0.5016 - accuracy: 0.4647
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3890 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3839 - accuracy: 0.4657 6/11 [===============>..............] - ETA: 0s - loss: 0.3812 - accuracy: 0.4723 8/11 [====================>.........] - ETA: 0s - loss: 0.3799 - accuracy: 0.472110/11 [==========================>...] - ETA: 0s - loss: 0.3781 - accuracy: 0.471611/11 [==============================] - 0s 27ms/step - loss: 0.3765 - accuracy: 0.4702
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3771 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3685 - accuracy: 0.4566 5/11 [============>.................] - ETA: 0s - loss: 0.3673 - accuracy: 0.4546 8/11 [====================>.........] - ETA: 0s - loss: 0.3617 - accuracy: 0.452711/11 [==============================] - ETA: 0s - loss: 0.3572 - accuracy: 0.454911/11 [==============================] - 0s 25ms/step - loss: 0.3560 - accuracy: 0.4556
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3070 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.3094 - accuracy: 0.4944 6/11 [===============>..............] - ETA: 0s - loss: 0.3157 - accuracy: 0.4734 8/11 [====================>.........] - ETA: 0s - loss: 0.3173 - accuracy: 0.470011/11 [==============================] - ETA: 0s - loss: 0.3188 - accuracy: 0.468311/11 [==============================] - 0s 25ms/step - loss: 0.3190 - accuracy: 0.4681
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3188 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.3253 - accuracy: 0.4523 7/11 [==================>...........] - ETA: 0s - loss: 0.3212 - accuracy: 0.4516 9/11 [=======================>......] - ETA: 0s - loss: 0.3172 - accuracy: 0.455611/11 [==============================] - 0s 25ms/step - loss: 0.3129 - accuracy: 0.4604
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3231 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.2958 - accuracy: 0.4813 6/11 [===============>..............] - ETA: 0s - loss: 0.2910 - accuracy: 0.4831 9/11 [=======================>......] - ETA: 0s - loss: 0.2860 - accuracy: 0.487911/11 [==============================] - 0s 25ms/step - loss: 0.2821 - accuracy: 0.4911
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2722 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.2604 - accuracy: 0.5165 5/11 [============>.................] - ETA: 0s - loss: 0.2574 - accuracy: 0.5194 7/11 [==================>...........] - ETA: 0s - loss: 0.2552 - accuracy: 0.522210/11 [==========================>...] - ETA: 0s - loss: 0.2514 - accuracy: 0.531011/11 [==============================] - 0s 27ms/step - loss: 0.2496 - accuracy: 0.5352
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2206 - accuracy: 0.6016 3/11 [=======>......................] - ETA: 0s - loss: 0.2209 - accuracy: 0.6007 5/11 [============>.................] - ETA: 0s - loss: 0.2211 - accuracy: 0.6014 7/11 [==================>...........] - ETA: 0s - loss: 0.2215 - accuracy: 0.597710/11 [==========================>...] - ETA: 0s - loss: 0.2217 - accuracy: 0.601711/11 [==============================] - 0s 26ms/step - loss: 0.2213 - accuracy: 0.6068
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2058 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.2065 - accuracy: 0.6654 5/11 [============>.................] - ETA: 0s - loss: 0.2052 - accuracy: 0.6571 7/11 [==================>...........] - ETA: 0s - loss: 0.2049 - accuracy: 0.654110/11 [==========================>...] - ETA: 0s - loss: 0.2052 - accuracy: 0.651311/11 [==============================] - 0s 26ms/step - loss: 0.2050 - accuracy: 0.6515
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1889 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.1950 - accuracy: 0.7313 5/11 [============>.................] - ETA: 0s - loss: 0.1972 - accuracy: 0.7407 7/11 [==================>...........] - ETA: 0s - loss: 0.1975 - accuracy: 0.7493 9/11 [=======================>......] - ETA: 0s - loss: 0.1968 - accuracy: 0.754111/11 [==============================] - ETA: 0s - loss: 0.1958 - accuracy: 0.756011/11 [==============================] - 0s 27ms/step - loss: 0.1954 - accuracy: 0.7566
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1970 - accuracy: 0.6172 4/11 [=========>....................] - ETA: 0s - loss: 0.1909 - accuracy: 0.6131 7/11 [==================>...........] - ETA: 0s - loss: 0.1877 - accuracy: 0.6253 9/11 [=======================>......] - ETA: 0s - loss: 0.1864 - accuracy: 0.639511/11 [==============================] - 0s 25ms/step - loss: 0.1846 - accuracy: 0.6566
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1665 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.1685 - accuracy: 0.8064 6/11 [===============>..............] - ETA: 0s - loss: 0.1689 - accuracy: 0.8017 8/11 [====================>.........] - ETA: 0s - loss: 0.1684 - accuracy: 0.797310/11 [==========================>...] - ETA: 0s - loss: 0.1677 - accuracy: 0.793111/11 [==============================] - 0s 25ms/step - loss: 0.1675 - accuracy: 0.7904
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1665 - accuracy: 0.7734 4/11 [=========>....................] - ETA: 0s - loss: 0.1626 - accuracy: 0.7951 7/11 [==================>...........] - ETA: 0s - loss: 0.1615 - accuracy: 0.802010/11 [==========================>...] - ETA: 0s - loss: 0.1601 - accuracy: 0.802411/11 [==============================] - 0s 24ms/step - loss: 0.1594 - accuracy: 0.8033
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1458 - accuracy: 0.7578 4/11 [=========>....................] - ETA: 0s - loss: 0.1447 - accuracy: 0.7489 6/11 [===============>..............] - ETA: 0s - loss: 0.1451 - accuracy: 0.7547 9/11 [=======================>......] - ETA: 0s - loss: 0.1449 - accuracy: 0.761211/11 [==============================] - 0s 24ms/step - loss: 0.1447 - accuracy: 0.7693
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1261 - accuracy: 0.8984 4/11 [=========>....................] - ETA: 0s - loss: 0.1358 - accuracy: 0.8628 6/11 [===============>..............] - ETA: 0s - loss: 0.1380 - accuracy: 0.8513 9/11 [=======================>......] - ETA: 0s - loss: 0.1381 - accuracy: 0.841911/11 [==============================] - 0s 24ms/step - loss: 0.1378 - accuracy: 0.8372
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1328 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.1367 - accuracy: 0.8546 5/11 [============>.................] - ETA: 0s - loss: 0.1370 - accuracy: 0.8487 7/11 [==================>...........] - ETA: 0s - loss: 0.1360 - accuracy: 0.8481 9/11 [=======================>......] - ETA: 0s - loss: 0.1349 - accuracy: 0.847311/11 [==============================] - ETA: 0s - loss: 0.1336 - accuracy: 0.844611/11 [==============================] - 0s 27ms/step - loss: 0.1330 - accuracy: 0.8434
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1427 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.1363 - accuracy: 0.8008 5/11 [============>.................] - ETA: 0s - loss: 0.1342 - accuracy: 0.8059 7/11 [==================>...........] - ETA: 0s - loss: 0.1320 - accuracy: 0.812610/11 [==========================>...] - ETA: 0s - loss: 0.1295 - accuracy: 0.818411/11 [==============================] - 0s 27ms/step - loss: 0.1284 - accuracy: 0.8206
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1385 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.1270 - accuracy: 0.7487 6/11 [===============>..............] - ETA: 0s - loss: 0.1241 - accuracy: 0.7596 8/11 [====================>.........] - ETA: 0s - loss: 0.1223 - accuracy: 0.769610/11 [==========================>...] - ETA: 0s - loss: 0.1210 - accuracy: 0.780211/11 [==============================] - 0s 25ms/step - loss: 0.1202 - accuracy: 0.7888
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.1036 - accuracy: 0.90626/6 [==============================] - 5s 10ms/step - loss: 0.1165 - accuracy: 0.8626
2021-12-13 23:32:03.613452: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:32:03.614266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:32:03.614339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:32:03.614395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:32:03.614437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:32:03.614491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:32:03.614542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:32:03.614589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:32:03.614636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:32:03.614687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:32:03.615663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:32:03.615723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:32:03.615740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:32:03.615753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:32:03.616776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:32:03.617196: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:32:03.617707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:32:03.617748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:32:03.617789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:32:03.617829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:32:03.617868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:32:03.617908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:32:03.617963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:32:03.618010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:32:03.618054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:32:03.618987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:32:03.619028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:32:03.619046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:32:03.619059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:32:03.620045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [1.2571968e-03 7.5835699e-01 9.6049696e-01 3.3217552e-04 8.0367630e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [9.9856523e-04 1.4091363e-02 9.8325115e-01 7.0358869e-03 7.5758772e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 2 4 0 1] pred: [0.03241517 0.01726459 0.17011704 0.67879695 0.04533187]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 1 4 0] pred: [0.0013127  0.00711773 0.97576797 0.01702334 0.00274714]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 4 0] pred: [0.00106844 0.0074892  0.9831838  0.01530246 0.00140912]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 4 0] pred: [0.00126296 0.00672506 0.98104984 0.01948701 0.0015466 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [1.0617854e-03 2.8454602e-02 9.7993362e-01 4.0551336e-03 7.1801851e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [6.7490060e-03 8.5485697e-01 7.1990812e-01 4.0025432e-03 2.7757065e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 1 4 0] pred: [0.00104098 0.0067189  0.98320985 0.01555958 0.00144586]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 0 4] pred: [0.00748772 0.01947129 0.75121224 0.15057947 0.00707996]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 4 1 0] pred: [0.00128242 0.00365815 0.9724449  0.03508458 0.00473232]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [5.1050079e-03 8.1459045e-01 8.2080209e-01 2.3257844e-03 2.3296007e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 2 4 0 1] pred: [0.07808987 0.02433125 0.13105077 0.743501   0.10780305]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [5.7856366e-04 6.0935253e-01 9.8305064e-01 2.6316856e-04 5.9608967e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 4 0] pred: [0.00113766 0.0091424  0.98133117 0.01168283 0.00137482]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:39 - loss: 0.6886 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.6861 - accuracy: 0.4154   5/11 [============>.................] - ETA: 0s - loss: 0.6836 - accuracy: 0.4133 8/11 [====================>.........] - ETA: 0s - loss: 0.6798 - accuracy: 0.418811/11 [==============================] - ETA: 0s - loss: 0.6759 - accuracy: 0.423211/11 [==============================] - 16s 24ms/step - loss: 0.6749 - accuracy: 0.4245
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6257 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.6236 - accuracy: 0.4449 5/11 [============>.................] - ETA: 0s - loss: 0.6206 - accuracy: 0.4465 8/11 [====================>.........] - ETA: 0s - loss: 0.6153 - accuracy: 0.447811/11 [==============================] - ETA: 0s - loss: 0.6097 - accuracy: 0.449111/11 [==============================] - 0s 24ms/step - loss: 0.6083 - accuracy: 0.4493
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5383 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.5322 - accuracy: 0.4548 7/11 [==================>...........] - ETA: 0s - loss: 0.5261 - accuracy: 0.4523 9/11 [=======================>......] - ETA: 0s - loss: 0.5215 - accuracy: 0.450610/11 [==========================>...] - ETA: 0s - loss: 0.5188 - accuracy: 0.450211/11 [==============================] - 1s 58ms/step - loss: 0.5140 - accuracy: 0.4504
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4312 - accuracy: 0.3906 3/11 [=======>......................] - ETA: 0s - loss: 0.4194 - accuracy: 0.4271 5/11 [============>.................] - ETA: 0s - loss: 0.4132 - accuracy: 0.4372 7/11 [==================>...........] - ETA: 0s - loss: 0.4100 - accuracy: 0.4421 9/11 [=======================>......] - ETA: 0s - loss: 0.4075 - accuracy: 0.444311/11 [==============================] - 0s 26ms/step - loss: 0.4052 - accuracy: 0.4457
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3687 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.3636 - accuracy: 0.4251 6/11 [===============>..............] - ETA: 0s - loss: 0.3605 - accuracy: 0.4333 9/11 [=======================>......] - ETA: 0s - loss: 0.3586 - accuracy: 0.438211/11 [==============================] - 0s 25ms/step - loss: 0.3572 - accuracy: 0.4414
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3488 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.3472 - accuracy: 0.4359 7/11 [==================>...........] - ETA: 0s - loss: 0.3448 - accuracy: 0.4318 9/11 [=======================>......] - ETA: 0s - loss: 0.3427 - accuracy: 0.432111/11 [==============================] - 0s 24ms/step - loss: 0.3397 - accuracy: 0.4371
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3155 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.3075 - accuracy: 0.4574 6/11 [===============>..............] - ETA: 0s - loss: 0.3077 - accuracy: 0.4622 8/11 [====================>.........] - ETA: 0s - loss: 0.3083 - accuracy: 0.462810/11 [==========================>...] - ETA: 0s - loss: 0.3085 - accuracy: 0.462811/11 [==============================] - 0s 25ms/step - loss: 0.3088 - accuracy: 0.4622
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2956 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.2947 - accuracy: 0.4650 6/11 [===============>..............] - ETA: 0s - loss: 0.2939 - accuracy: 0.4636 8/11 [====================>.........] - ETA: 0s - loss: 0.2933 - accuracy: 0.466811/11 [==============================] - ETA: 0s - loss: 0.2921 - accuracy: 0.469711/11 [==============================] - 0s 26ms/step - loss: 0.2919 - accuracy: 0.4701
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2599 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.2624 - accuracy: 0.4861 5/11 [============>.................] - ETA: 0s - loss: 0.2628 - accuracy: 0.4973 8/11 [====================>.........] - ETA: 0s - loss: 0.2626 - accuracy: 0.505210/11 [==========================>...] - ETA: 0s - loss: 0.2630 - accuracy: 0.505911/11 [==============================] - 0s 25ms/step - loss: 0.2632 - accuracy: 0.5062
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2328 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.2393 - accuracy: 0.5265 5/11 [============>.................] - ETA: 0s - loss: 0.2403 - accuracy: 0.5204 7/11 [==================>...........] - ETA: 0s - loss: 0.2403 - accuracy: 0.5213 9/11 [=======================>......] - ETA: 0s - loss: 0.2392 - accuracy: 0.523511/11 [==============================] - 0s 26ms/step - loss: 0.2376 - accuracy: 0.5303
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2396 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.2229 - accuracy: 0.5738 6/11 [===============>..............] - ETA: 0s - loss: 0.2161 - accuracy: 0.5859 9/11 [=======================>......] - ETA: 0s - loss: 0.2121 - accuracy: 0.592611/11 [==============================] - ETA: 0s - loss: 0.2103 - accuracy: 0.596011/11 [==============================] - 0s 25ms/step - loss: 0.2095 - accuracy: 0.5970
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1935 - accuracy: 0.6016 3/11 [=======>......................] - ETA: 0s - loss: 0.1894 - accuracy: 0.6198 5/11 [============>.................] - ETA: 0s - loss: 0.1864 - accuracy: 0.6223 8/11 [====================>.........] - ETA: 0s - loss: 0.1837 - accuracy: 0.625810/11 [==========================>...] - ETA: 0s - loss: 0.1823 - accuracy: 0.628011/11 [==============================] - 0s 26ms/step - loss: 0.1814 - accuracy: 0.6296
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1724 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.1651 - accuracy: 0.6402 5/11 [============>.................] - ETA: 0s - loss: 0.1640 - accuracy: 0.6480 7/11 [==================>...........] - ETA: 0s - loss: 0.1634 - accuracy: 0.6497 9/11 [=======================>......] - ETA: 0s - loss: 0.1628 - accuracy: 0.650211/11 [==============================] - ETA: 0s - loss: 0.1625 - accuracy: 0.651611/11 [==============================] - 0s 27ms/step - loss: 0.1624 - accuracy: 0.6522
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1568 - accuracy: 0.6641 4/11 [=========>....................] - ETA: 0s - loss: 0.1491 - accuracy: 0.6678 6/11 [===============>..............] - ETA: 0s - loss: 0.1473 - accuracy: 0.6707 8/11 [====================>.........] - ETA: 0s - loss: 0.1469 - accuracy: 0.670511/11 [==============================] - ETA: 0s - loss: 0.1471 - accuracy: 0.671611/11 [==============================] - 0s 25ms/step - loss: 0.1471 - accuracy: 0.6719
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1182 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.1232 - accuracy: 0.7413 5/11 [============>.................] - ETA: 0s - loss: 0.1258 - accuracy: 0.7436 7/11 [==================>...........] - ETA: 0s - loss: 0.1280 - accuracy: 0.7468 9/11 [=======================>......] - ETA: 0s - loss: 0.1298 - accuracy: 0.750511/11 [==============================] - 0s 26ms/step - loss: 0.1314 - accuracy: 0.7553
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1160 - accuracy: 0.8359 4/11 [=========>....................] - ETA: 0s - loss: 0.1257 - accuracy: 0.7863 6/11 [===============>..............] - ETA: 0s - loss: 0.1274 - accuracy: 0.7758 8/11 [====================>.........] - ETA: 0s - loss: 0.1278 - accuracy: 0.772110/11 [==========================>...] - ETA: 0s - loss: 0.1274 - accuracy: 0.771311/11 [==============================] - 0s 26ms/step - loss: 0.1271 - accuracy: 0.7723
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1203 - accuracy: 0.8281 4/11 [=========>....................] - ETA: 0s - loss: 0.1239 - accuracy: 0.8525 6/11 [===============>..............] - ETA: 0s - loss: 0.1225 - accuracy: 0.8593 8/11 [====================>.........] - ETA: 0s - loss: 0.1212 - accuracy: 0.859411/11 [==============================] - ETA: 0s - loss: 0.1198 - accuracy: 0.856311/11 [==============================] - 0s 25ms/step - loss: 0.1195 - accuracy: 0.8550
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1163 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.1141 - accuracy: 0.8060 5/11 [============>.................] - ETA: 0s - loss: 0.1134 - accuracy: 0.8102 8/11 [====================>.........] - ETA: 0s - loss: 0.1128 - accuracy: 0.818911/11 [==============================] - ETA: 0s - loss: 0.1116 - accuracy: 0.824911/11 [==============================] - 0s 25ms/step - loss: 0.1114 - accuracy: 0.8262
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1144 - accuracy: 0.8359 4/11 [=========>....................] - ETA: 0s - loss: 0.1139 - accuracy: 0.8242 6/11 [===============>..............] - ETA: 0s - loss: 0.1108 - accuracy: 0.8224 9/11 [=======================>......] - ETA: 0s - loss: 0.1081 - accuracy: 0.824411/11 [==============================] - 0s 25ms/step - loss: 0.1064 - accuracy: 0.8295
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1083 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.1021 - accuracy: 0.8520 6/11 [===============>..............] - ETA: 0s - loss: 0.0983 - accuracy: 0.8483 8/11 [====================>.........] - ETA: 0s - loss: 0.0968 - accuracy: 0.846410/11 [==========================>...] - ETA: 0s - loss: 0.0964 - accuracy: 0.845011/11 [==============================] - 0s 25ms/step - loss: 0.0962 - accuracy: 0.8439
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.0982 - accuracy: 0.80476/6 [==============================] - ETA: 0s - loss: 0.0946 - accuracy: 0.8683 6/6 [==============================] - 5s 10ms/step - loss: 0.0946 - accuracy: 0.8683
2021-12-13 23:32:39.815642: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:32:39.816463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:32:39.816534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:32:39.816597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:32:39.816642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:32:39.816692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:32:39.816738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:32:39.816780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:32:39.816821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:32:39.816864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:32:39.817865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:32:39.817946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:32:39.817966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:32:39.817980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:32:39.819013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:32:39.819415: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:32:39.819937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:32:39.819980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:32:39.820020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:32:39.820062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:32:39.820102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:32:39.820146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:32:39.820187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:32:39.820227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:32:39.820271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:32:39.821213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:32:39.821255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:32:39.821272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:32:39.821285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:32:39.822269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [2.2038396e-03 8.5974813e-01 9.1772503e-01 4.1566396e-04 2.6443950e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [5.4993606e-03 7.8530067e-01 8.6403996e-01 5.9844262e-04 6.1198859e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [7.3686428e-03 9.4499362e-01 8.0557758e-01 7.6455611e-04 4.7450454e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [5.7837414e-03 9.3304372e-01 8.2333726e-01 5.0142512e-04 4.1434949e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 4 0] pred: [0.00110461 0.00589054 0.9713712  0.00692189 0.00180194]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 4 0] pred: [9.6507755e-04 4.5252279e-03 9.7313935e-01 7.4991523e-03 2.3046371e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [1.1866688e-03 7.2806376e-01 9.6319079e-01 4.2524384e-04 2.4942271e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 3 0 4] pred: [0.01960018 0.95202994 0.25011384 0.02662383 0.00498059]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 1 0] pred: [0.0213303  0.04533933 0.36922655 0.9463879  0.19244711]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [0.04146991 0.9544517  0.45852298 0.00167605 0.00148193]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [3.0341852e-03 7.3749804e-01 9.2614996e-01 5.9087627e-04 3.7464680e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 1 4 0] pred: [2.0932671e-04 7.9254322e-03 9.8203689e-01 9.0728076e-03 1.5573403e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 4 0] pred: [2.5287390e-04 7.8861853e-03 9.5460296e-01 2.5262684e-02 1.9308047e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [0.02930507 0.9451706  0.3622369  0.00668374 0.0021345 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [6.8682304e-04 2.7661016e-02 9.6131438e-01 3.7514947e-03 1.5347076e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:31 - loss: 0.6933 - accuracy: 0.0312 3/11 [=======>......................] - ETA: 0s - loss: 0.6909 - accuracy: 0.1076   6/11 [===============>..............] - ETA: 0s - loss: 0.6869 - accuracy: 0.1916 8/11 [====================>.........] - ETA: 0s - loss: 0.6841 - accuracy: 0.233311/11 [==============================] - ETA: 0s - loss: 0.6800 - accuracy: 0.278111/11 [==============================] - 15s 25ms/step - loss: 0.6789 - accuracy: 0.2886
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6272 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.6255 - accuracy: 0.4991 6/11 [===============>..............] - ETA: 0s - loss: 0.6209 - accuracy: 0.4856 8/11 [====================>.........] - ETA: 0s - loss: 0.6173 - accuracy: 0.478811/11 [==============================] - ETA: 0s - loss: 0.6114 - accuracy: 0.473311/11 [==============================] - 0s 24ms/step - loss: 0.6098 - accuracy: 0.4722
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5362 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.5279 - accuracy: 0.4408 7/11 [==================>...........] - ETA: 0s - loss: 0.5181 - accuracy: 0.441310/11 [==========================>...] - ETA: 0s - loss: 0.5084 - accuracy: 0.446811/11 [==============================] - 0s 23ms/step - loss: 0.5032 - accuracy: 0.4484
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4020 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.3898 - accuracy: 0.4663 7/11 [==================>...........] - ETA: 0s - loss: 0.3842 - accuracy: 0.4619 9/11 [=======================>......] - ETA: 0s - loss: 0.3809 - accuracy: 0.460811/11 [==============================] - ETA: 0s - loss: 0.3784 - accuracy: 0.459711/11 [==============================] - 0s 25ms/step - loss: 0.3775 - accuracy: 0.4594
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3117 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.3275 - accuracy: 0.4888 6/11 [===============>..............] - ETA: 0s - loss: 0.3334 - accuracy: 0.4790 9/11 [=======================>......] - ETA: 0s - loss: 0.3359 - accuracy: 0.471911/11 [==============================] - 0s 24ms/step - loss: 0.3368 - accuracy: 0.4683
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3227 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.3222 - accuracy: 0.4731 6/11 [===============>..............] - ETA: 0s - loss: 0.3174 - accuracy: 0.4744 9/11 [=======================>......] - ETA: 0s - loss: 0.3154 - accuracy: 0.473411/11 [==============================] - 0s 24ms/step - loss: 0.3151 - accuracy: 0.4698
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2816 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.2928 - accuracy: 0.4987 5/11 [============>.................] - ETA: 0s - loss: 0.2958 - accuracy: 0.4853 7/11 [==================>...........] - ETA: 0s - loss: 0.2958 - accuracy: 0.480010/11 [==========================>...] - ETA: 0s - loss: 0.2946 - accuracy: 0.474211/11 [==============================] - 0s 25ms/step - loss: 0.2936 - accuracy: 0.4721
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2884 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.2858 - accuracy: 0.4544 5/11 [============>.................] - ETA: 0s - loss: 0.2803 - accuracy: 0.4562 8/11 [====================>.........] - ETA: 0s - loss: 0.2741 - accuracy: 0.462510/11 [==========================>...] - ETA: 0s - loss: 0.2713 - accuracy: 0.465511/11 [==============================] - 0s 26ms/step - loss: 0.2692 - accuracy: 0.4675
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2449 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.2459 - accuracy: 0.4767 7/11 [==================>...........] - ETA: 0s - loss: 0.2450 - accuracy: 0.488110/11 [==========================>...] - ETA: 0s - loss: 0.2424 - accuracy: 0.496911/11 [==============================] - 0s 24ms/step - loss: 0.2411 - accuracy: 0.5012
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2212 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.2233 - accuracy: 0.5820 6/11 [===============>..............] - ETA: 0s - loss: 0.2237 - accuracy: 0.5797 8/11 [====================>.........] - ETA: 0s - loss: 0.2224 - accuracy: 0.579011/11 [==============================] - ETA: 0s - loss: 0.2206 - accuracy: 0.579211/11 [==============================] - 0s 24ms/step - loss: 0.2201 - accuracy: 0.5790
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2021 - accuracy: 0.6094 4/11 [=========>....................] - ETA: 0s - loss: 0.1975 - accuracy: 0.6118 6/11 [===============>..............] - ETA: 0s - loss: 0.1979 - accuracy: 0.6123 9/11 [=======================>......] - ETA: 0s - loss: 0.1987 - accuracy: 0.609311/11 [==============================] - 0s 25ms/step - loss: 0.1984 - accuracy: 0.6044
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2029 - accuracy: 0.5859 3/11 [=======>......................] - ETA: 0s - loss: 0.1999 - accuracy: 0.5747 5/11 [============>.................] - ETA: 0s - loss: 0.1942 - accuracy: 0.5799 8/11 [====================>.........] - ETA: 0s - loss: 0.1906 - accuracy: 0.585011/11 [==============================] - ETA: 0s - loss: 0.1887 - accuracy: 0.589911/11 [==============================] - 0s 26ms/step - loss: 0.1883 - accuracy: 0.5912
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1886 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.1833 - accuracy: 0.5977 5/11 [============>.................] - ETA: 0s - loss: 0.1809 - accuracy: 0.6038 8/11 [====================>.........] - ETA: 0s - loss: 0.1778 - accuracy: 0.610610/11 [==========================>...] - ETA: 0s - loss: 0.1766 - accuracy: 0.613811/11 [==============================] - 0s 26ms/step - loss: 0.1757 - accuracy: 0.6154
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1583 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.1615 - accuracy: 0.6341 5/11 [============>.................] - ETA: 0s - loss: 0.1609 - accuracy: 0.6325 7/11 [==================>...........] - ETA: 0s - loss: 0.1603 - accuracy: 0.631710/11 [==========================>...] - ETA: 0s - loss: 0.1603 - accuracy: 0.631711/11 [==============================] - 0s 26ms/step - loss: 0.1604 - accuracy: 0.6325
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1825 - accuracy: 0.5859 3/11 [=======>......................] - ETA: 0s - loss: 0.1733 - accuracy: 0.5977 6/11 [===============>..............] - ETA: 0s - loss: 0.1656 - accuracy: 0.6161 9/11 [=======================>......] - ETA: 0s - loss: 0.1623 - accuracy: 0.626111/11 [==============================] - ETA: 0s - loss: 0.1604 - accuracy: 0.631711/11 [==============================] - 0s 24ms/step - loss: 0.1597 - accuracy: 0.6339
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1238 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.1296 - accuracy: 0.6727 5/11 [============>.................] - ETA: 0s - loss: 0.1350 - accuracy: 0.6641 8/11 [====================>.........] - ETA: 0s - loss: 0.1380 - accuracy: 0.663311/11 [==============================] - ETA: 0s - loss: 0.1395 - accuracy: 0.665211/11 [==============================] - 0s 24ms/step - loss: 0.1398 - accuracy: 0.6659
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1284 - accuracy: 0.6797 4/11 [=========>....................] - ETA: 0s - loss: 0.1372 - accuracy: 0.6769 7/11 [==================>...........] - ETA: 0s - loss: 0.1361 - accuracy: 0.678210/11 [==========================>...] - ETA: 0s - loss: 0.1355 - accuracy: 0.678211/11 [==============================] - 0s 26ms/step - loss: 0.1355 - accuracy: 0.6809
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1352 - accuracy: 0.8594 4/11 [=========>....................] - ETA: 0s - loss: 0.1289 - accuracy: 0.8709 7/11 [==================>...........] - ETA: 0s - loss: 0.1285 - accuracy: 0.878910/11 [==========================>...] - ETA: 0s - loss: 0.1283 - accuracy: 0.882311/11 [==============================] - 0s 25ms/step - loss: 0.1285 - accuracy: 0.8823
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1401 - accuracy: 0.8516 4/11 [=========>....................] - ETA: 0s - loss: 0.1306 - accuracy: 0.8335 6/11 [===============>..............] - ETA: 0s - loss: 0.1269 - accuracy: 0.8223 8/11 [====================>.........] - ETA: 0s - loss: 0.1254 - accuracy: 0.815110/11 [==========================>...] - ETA: 0s - loss: 0.1246 - accuracy: 0.808411/11 [==============================] - 0s 25ms/step - loss: 0.1242 - accuracy: 0.8023
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1189 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.1240 - accuracy: 0.7465 6/11 [===============>..............] - ETA: 0s - loss: 0.1224 - accuracy: 0.7638 8/11 [====================>.........] - ETA: 0s - loss: 0.1210 - accuracy: 0.775611/11 [==============================] - ETA: 0s - loss: 0.1198 - accuracy: 0.790611/11 [==============================] - 0s 25ms/step - loss: 0.1196 - accuracy: 0.7943
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1101 - accuracy: 0.87506/6 [==============================] - ETA: 0s - loss: 0.1149 - accuracy: 0.8626 6/6 [==============================] - 5s 10ms/step - loss: 0.1149 - accuracy: 0.8626
2021-12-13 23:33:16.065159: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:33:16.065990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:33:16.066066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:33:16.066125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:33:16.066175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:33:16.066228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:33:16.066280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:33:16.066328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:33:16.066378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:33:16.066427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:33:16.067467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:33:16.067526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:33:16.067544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:33:16.067558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:33:16.068660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:33:16.069344: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:33:16.069723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:33:16.069752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:33:16.069780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:33:16.069808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:33:16.069835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:33:16.069862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:33:16.069893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:33:16.069924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:33:16.069962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:33:16.070630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:33:16.070659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:33:16.070670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:33:16.070679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:33:16.071390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [5.7009158e-05 5.9046000e-03 9.7380549e-01 3.4910236e-03 3.3020310e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 4 3] pred: [0.2346256  0.53344405 0.27801043 0.00120313 0.00121603]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [0.01222544 0.76715434 0.7383727  0.00725057 0.00121982]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.02140705 0.8751282  0.57647246 0.01309284 0.00151893]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [9.6947961e-03 7.2416896e-01 7.4721146e-01 3.1305039e-03 6.0466648e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 4 0] pred: [9.2393988e-05 4.8084655e-03 9.6291816e-01 5.5674454e-03 5.7302974e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [0.01157118 0.85942215 0.806284   0.00409408 0.00086978]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [6.1684943e-05 6.6958126e-03 9.7521782e-01 3.7170562e-03 3.2833466e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [1.21375155e-02 8.72563303e-01 8.20269167e-01 3.93430097e-03
 8.71093769e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [6.6931781e-05 7.3732827e-03 9.7161710e-01 4.0637082e-03 3.0217666e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [7.5643045e-05 7.7537578e-03 9.7297060e-01 4.1504730e-03 3.4108246e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [9.7274017e-03 8.5706687e-01 8.2832044e-01 3.7392767e-03 7.6035614e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 2 0 1] pred: [0.03698875 0.00183611 0.08484846 0.582411   0.5603838 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [7.956762e-03 8.940760e-01 8.701224e-01 4.092813e-03 7.587036e-04]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [8.8638617e-03 8.3987850e-01 8.3120817e-01 3.8161650e-03 6.6451030e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:40 - loss: 0.6902 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.6877 - accuracy: 0.5000   6/11 [===============>..............] - ETA: 0s - loss: 0.6840 - accuracy: 0.5041 8/11 [====================>.........] - ETA: 0s - loss: 0.6815 - accuracy: 0.500211/11 [==============================] - ETA: 0s - loss: 0.6777 - accuracy: 0.495911/11 [==============================] - 16s 25ms/step - loss: 0.6767 - accuracy: 0.4947
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6296 - accuracy: 0.4141 4/11 [=========>....................] - ETA: 0s - loss: 0.6249 - accuracy: 0.4450 6/11 [===============>..............] - ETA: 0s - loss: 0.6214 - accuracy: 0.4487 9/11 [=======================>......] - ETA: 0s - loss: 0.6159 - accuracy: 0.450211/11 [==============================] - ETA: 0s - loss: 0.6120 - accuracy: 0.451511/11 [==============================] - 0s 25ms/step - loss: 0.6104 - accuracy: 0.4519
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5375 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.5311 - accuracy: 0.4688 5/11 [============>.................] - ETA: 0s - loss: 0.5253 - accuracy: 0.4701 8/11 [====================>.........] - ETA: 0s - loss: 0.5155 - accuracy: 0.469011/11 [==============================] - ETA: 0s - loss: 0.5066 - accuracy: 0.464911/11 [==============================] - 0s 26ms/step - loss: 0.5042 - accuracy: 0.4642
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3906 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.3910 - accuracy: 0.4699 7/11 [==================>...........] - ETA: 0s - loss: 0.3853 - accuracy: 0.467010/11 [==========================>...] - ETA: 0s - loss: 0.3819 - accuracy: 0.464011/11 [==============================] - 0s 25ms/step - loss: 0.3798 - accuracy: 0.4627
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3587 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.3584 - accuracy: 0.4332 5/11 [============>.................] - ETA: 0s - loss: 0.3558 - accuracy: 0.4377 8/11 [====================>.........] - ETA: 0s - loss: 0.3538 - accuracy: 0.441610/11 [==========================>...] - ETA: 0s - loss: 0.3525 - accuracy: 0.443411/11 [==============================] - 0s 25ms/step - loss: 0.3512 - accuracy: 0.4455
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3494 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3416 - accuracy: 0.4688 5/11 [============>.................] - ETA: 0s - loss: 0.3325 - accuracy: 0.4788 8/11 [====================>.........] - ETA: 0s - loss: 0.3284 - accuracy: 0.478411/11 [==============================] - ETA: 0s - loss: 0.3277 - accuracy: 0.473211/11 [==============================] - 0s 25ms/step - loss: 0.3276 - accuracy: 0.4718
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3213 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.3111 - accuracy: 0.4983 6/11 [===============>..............] - ETA: 0s - loss: 0.3110 - accuracy: 0.4934 8/11 [====================>.........] - ETA: 0s - loss: 0.3114 - accuracy: 0.485710/11 [==========================>...] - ETA: 0s - loss: 0.3118 - accuracy: 0.479311/11 [==============================] - 0s 25ms/step - loss: 0.3116 - accuracy: 0.4758
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2974 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.2978 - accuracy: 0.4627 5/11 [============>.................] - ETA: 0s - loss: 0.2981 - accuracy: 0.4643 7/11 [==================>...........] - ETA: 0s - loss: 0.2985 - accuracy: 0.4647 9/11 [=======================>......] - ETA: 0s - loss: 0.2979 - accuracy: 0.466111/11 [==============================] - 0s 26ms/step - loss: 0.2970 - accuracy: 0.4652
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2784 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.2843 - accuracy: 0.4570 5/11 [============>.................] - ETA: 0s - loss: 0.2869 - accuracy: 0.4575 8/11 [====================>.........] - ETA: 0s - loss: 0.2851 - accuracy: 0.459110/11 [==========================>...] - ETA: 0s - loss: 0.2835 - accuracy: 0.462311/11 [==============================] - 0s 25ms/step - loss: 0.2821 - accuracy: 0.4649
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2753 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.2749 - accuracy: 0.4340 6/11 [===============>..............] - ETA: 0s - loss: 0.2705 - accuracy: 0.4496 8/11 [====================>.........] - ETA: 0s - loss: 0.2678 - accuracy: 0.459511/11 [==============================] - ETA: 0s - loss: 0.2644 - accuracy: 0.468311/11 [==============================] - 0s 25ms/step - loss: 0.2635 - accuracy: 0.4705
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2378 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.2394 - accuracy: 0.4880 6/11 [===============>..............] - ETA: 0s - loss: 0.2376 - accuracy: 0.4965 9/11 [=======================>......] - ETA: 0s - loss: 0.2354 - accuracy: 0.505111/11 [==============================] - 0s 25ms/step - loss: 0.2336 - accuracy: 0.5135
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2067 - accuracy: 0.6016 3/11 [=======>......................] - ETA: 0s - loss: 0.2031 - accuracy: 0.6141 6/11 [===============>..............] - ETA: 0s - loss: 0.2025 - accuracy: 0.6153 9/11 [=======================>......] - ETA: 0s - loss: 0.2025 - accuracy: 0.612611/11 [==============================] - 0s 26ms/step - loss: 0.2022 - accuracy: 0.6099
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1832 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.1836 - accuracy: 0.6489 5/11 [============>.................] - ETA: 0s - loss: 0.1841 - accuracy: 0.6441 8/11 [====================>.........] - ETA: 0s - loss: 0.1823 - accuracy: 0.643710/11 [==========================>...] - ETA: 0s - loss: 0.1810 - accuracy: 0.643211/11 [==============================] - 0s 26ms/step - loss: 0.1803 - accuracy: 0.6426
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1666 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.1646 - accuracy: 0.6810 6/11 [===============>..............] - ETA: 0s - loss: 0.1633 - accuracy: 0.6817 9/11 [=======================>......] - ETA: 0s - loss: 0.1630 - accuracy: 0.682911/11 [==============================] - 0s 24ms/step - loss: 0.1620 - accuracy: 0.6852
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1808 - accuracy: 0.5859 3/11 [=======>......................] - ETA: 0s - loss: 0.1659 - accuracy: 0.6376 6/11 [===============>..............] - ETA: 0s - loss: 0.1596 - accuracy: 0.6567 8/11 [====================>.........] - ETA: 0s - loss: 0.1572 - accuracy: 0.664211/11 [==============================] - ETA: 0s - loss: 0.1542 - accuracy: 0.674911/11 [==============================] - 0s 25ms/step - loss: 0.1534 - accuracy: 0.6779
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1393 - accuracy: 0.7656 3/11 [=======>......................] - ETA: 0s - loss: 0.1336 - accuracy: 0.7743 6/11 [===============>..............] - ETA: 0s - loss: 0.1345 - accuracy: 0.7705 8/11 [====================>.........] - ETA: 0s - loss: 0.1341 - accuracy: 0.768311/11 [==============================] - ETA: 0s - loss: 0.1342 - accuracy: 0.763211/11 [==============================] - 0s 25ms/step - loss: 0.1342 - accuracy: 0.7616
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1355 - accuracy: 0.7734 4/11 [=========>....................] - ETA: 0s - loss: 0.1323 - accuracy: 0.8091 6/11 [===============>..............] - ETA: 0s - loss: 0.1315 - accuracy: 0.8161 8/11 [====================>.........] - ETA: 0s - loss: 0.1303 - accuracy: 0.819110/11 [==========================>...] - ETA: 0s - loss: 0.1292 - accuracy: 0.818211/11 [==============================] - 0s 27ms/step - loss: 0.1285 - accuracy: 0.8168
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1121 - accuracy: 0.7422 4/11 [=========>....................] - ETA: 0s - loss: 0.1126 - accuracy: 0.7347 6/11 [===============>..............] - ETA: 0s - loss: 0.1140 - accuracy: 0.7437 9/11 [=======================>......] - ETA: 0s - loss: 0.1151 - accuracy: 0.757911/11 [==============================] - 0s 25ms/step - loss: 0.1155 - accuracy: 0.7659
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1130 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.1082 - accuracy: 0.7778 6/11 [===============>..............] - ETA: 0s - loss: 0.1099 - accuracy: 0.7849 8/11 [====================>.........] - ETA: 0s - loss: 0.1104 - accuracy: 0.791010/11 [==========================>...] - ETA: 0s - loss: 0.1107 - accuracy: 0.795411/11 [==============================] - 0s 26ms/step - loss: 0.1106 - accuracy: 0.7987
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1066 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.1110 - accuracy: 0.7461 6/11 [===============>..............] - ETA: 0s - loss: 0.1094 - accuracy: 0.7547 8/11 [====================>.........] - ETA: 0s - loss: 0.1088 - accuracy: 0.762411/11 [==============================] - ETA: 0s - loss: 0.1082 - accuracy: 0.776711/11 [==============================] - 0s 26ms/step - loss: 0.1080 - accuracy: 0.7806
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1134 - accuracy: 0.85946/6 [==============================] - 5s 9ms/step - loss: 0.1145 - accuracy: 0.8499
2021-12-13 23:33:52.536981: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:33:52.537642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:33:52.537707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:33:52.537749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:33:52.537778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:33:52.537814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:33:52.537847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:33:52.537883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:33:52.537916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:33:52.537961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:33:52.538702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:33:52.538757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:33:52.538769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:33:52.538779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:33:52.539562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:33:52.539885: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:33:52.540287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:33:52.540327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:33:52.540355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:33:52.540383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:33:52.540412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:33:52.540442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:33:52.540484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:33:52.540511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:33:52.540550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:33:52.541246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:33:52.541274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:33:52.541286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:33:52.541295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:33:52.542007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 3 1 4] pred: [0.00832397 0.00458283 0.96682525 0.00801486 0.00140794]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [2.6172316e-03 5.0012410e-01 9.6842635e-01 2.2009497e-03 5.4338679e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [2.3603849e-03 3.2723885e-02 9.8232549e-01 5.9633609e-03 4.8293584e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [1.5312546e-03 7.9152155e-01 9.6595633e-01 1.2973696e-03 3.9898138e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [4 3 0 2 1] pred: [0.08735347 0.00140687 0.04095815 0.4008932  0.43814507]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 3 4] pred: [2.7099664e-03 8.4990853e-01 9.6204597e-01 2.2111980e-03 5.8290333e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [2.6182176e-03 8.1247610e-01 9.5686287e-01 2.3877239e-03 6.1891333e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [1.9082731e-03 5.1839983e-01 9.7537941e-01 1.7039436e-03 4.4029322e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [4.1741296e-03 2.5139341e-02 9.7706521e-01 8.4609063e-03 7.5278874e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [1.0469053e-03 4.7983516e-02 9.7736734e-01 2.8853619e-03 4.7980968e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 3 4 0] pred: [0.00405448 0.8332747  0.5167568  0.05603059 0.00516672]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [0.00386817 0.83272743 0.8990196  0.00379883 0.00109059]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 3 4 0] pred: [0.00254413 0.7307058  0.5804769  0.03088906 0.00329646]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 3 0 4] pred: [0.00416848 0.8905181  0.86159253 0.00513175 0.0012769 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 4 3] pred: [0.14347562 0.8408249  0.226802   0.00344765 0.00719375]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:42 - loss: 0.6911 - accuracy: 0.3516 3/11 [=======>......................] - ETA: 0s - loss: 0.6881 - accuracy: 0.3763   5/11 [============>.................] - ETA: 0s - loss: 0.6849 - accuracy: 0.4000 7/11 [==================>...........] - ETA: 0s - loss: 0.6817 - accuracy: 0.4186 9/11 [=======================>......] - ETA: 0s - loss: 0.6785 - accuracy: 0.428111/11 [==============================] - ETA: 0s - loss: 0.6753 - accuracy: 0.433611/11 [==============================] - 16s 27ms/step - loss: 0.6741 - accuracy: 0.4356
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6191 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.6146 - accuracy: 0.4236 5/11 [============>.................] - ETA: 0s - loss: 0.6104 - accuracy: 0.4245 7/11 [==================>...........] - ETA: 0s - loss: 0.6058 - accuracy: 0.429010/11 [==========================>...] - ETA: 0s - loss: 0.5988 - accuracy: 0.433711/11 [==============================] - 0s 25ms/step - loss: 0.5946 - accuracy: 0.4366
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5134 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.5072 - accuracy: 0.4180 7/11 [==================>...........] - ETA: 0s - loss: 0.4957 - accuracy: 0.4256 9/11 [=======================>......] - ETA: 0s - loss: 0.4878 - accuracy: 0.431511/11 [==============================] - ETA: 0s - loss: 0.4808 - accuracy: 0.434811/11 [==============================] - 0s 25ms/step - loss: 0.4780 - accuracy: 0.4361
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3856 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.3772 - accuracy: 0.4494 7/11 [==================>...........] - ETA: 0s - loss: 0.3747 - accuracy: 0.451410/11 [==========================>...] - ETA: 0s - loss: 0.3744 - accuracy: 0.450311/11 [==============================] - 0s 24ms/step - loss: 0.3742 - accuracy: 0.4504
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3765 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.3712 - accuracy: 0.4540 6/11 [===============>..............] - ETA: 0s - loss: 0.3653 - accuracy: 0.4504 9/11 [=======================>......] - ETA: 0s - loss: 0.3617 - accuracy: 0.453111/11 [==============================] - 0s 25ms/step - loss: 0.3597 - accuracy: 0.4529
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3715 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.3535 - accuracy: 0.4593 6/11 [===============>..............] - ETA: 0s - loss: 0.3511 - accuracy: 0.4531 8/11 [====================>.........] - ETA: 0s - loss: 0.3491 - accuracy: 0.451310/11 [==========================>...] - ETA: 0s - loss: 0.3472 - accuracy: 0.450311/11 [==============================] - 0s 25ms/step - loss: 0.3452 - accuracy: 0.4505
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3122 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.3179 - accuracy: 0.4604 6/11 [===============>..............] - ETA: 0s - loss: 0.3194 - accuracy: 0.4588 9/11 [=======================>......] - ETA: 0s - loss: 0.3183 - accuracy: 0.458111/11 [==============================] - 0s 25ms/step - loss: 0.3181 - accuracy: 0.4576
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2839 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.3051 - accuracy: 0.4740 5/11 [============>.................] - ETA: 0s - loss: 0.3072 - accuracy: 0.4672 7/11 [==================>...........] - ETA: 0s - loss: 0.3066 - accuracy: 0.467110/11 [==========================>...] - ETA: 0s - loss: 0.3036 - accuracy: 0.466511/11 [==============================] - 0s 25ms/step - loss: 0.3026 - accuracy: 0.4656
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2719 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.2815 - accuracy: 0.4688 6/11 [===============>..............] - ETA: 0s - loss: 0.2811 - accuracy: 0.4712 8/11 [====================>.........] - ETA: 0s - loss: 0.2802 - accuracy: 0.473311/11 [==============================] - ETA: 0s - loss: 0.2784 - accuracy: 0.473611/11 [==============================] - 0s 24ms/step - loss: 0.2779 - accuracy: 0.4738
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2764 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.2655 - accuracy: 0.4906 6/11 [===============>..............] - ETA: 0s - loss: 0.2609 - accuracy: 0.4978 9/11 [=======================>......] - ETA: 0s - loss: 0.2567 - accuracy: 0.504211/11 [==============================] - 0s 25ms/step - loss: 0.2536 - accuracy: 0.5088
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2194 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.2195 - accuracy: 0.5347 6/11 [===============>..............] - ETA: 0s - loss: 0.2190 - accuracy: 0.5491 9/11 [=======================>......] - ETA: 0s - loss: 0.2183 - accuracy: 0.558011/11 [==============================] - 0s 25ms/step - loss: 0.2178 - accuracy: 0.5652
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1887 - accuracy: 0.6016 3/11 [=======>......................] - ETA: 0s - loss: 0.1984 - accuracy: 0.6220 6/11 [===============>..............] - ETA: 0s - loss: 0.2004 - accuracy: 0.6304 9/11 [=======================>......] - ETA: 0s - loss: 0.1999 - accuracy: 0.640111/11 [==============================] - 0s 23ms/step - loss: 0.1987 - accuracy: 0.6499
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1772 - accuracy: 0.7656 4/11 [=========>....................] - ETA: 0s - loss: 0.1876 - accuracy: 0.7300 7/11 [==================>...........] - ETA: 0s - loss: 0.1863 - accuracy: 0.7263 9/11 [=======================>......] - ETA: 0s - loss: 0.1856 - accuracy: 0.724411/11 [==============================] - 0s 25ms/step - loss: 0.1841 - accuracy: 0.7255
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1681 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.1730 - accuracy: 0.7539 5/11 [============>.................] - ETA: 0s - loss: 0.1727 - accuracy: 0.7563 7/11 [==================>...........] - ETA: 0s - loss: 0.1721 - accuracy: 0.756410/11 [==========================>...] - ETA: 0s - loss: 0.1711 - accuracy: 0.756611/11 [==============================] - 0s 26ms/step - loss: 0.1702 - accuracy: 0.7572
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1541 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.1589 - accuracy: 0.7166 6/11 [===============>..............] - ETA: 0s - loss: 0.1611 - accuracy: 0.7179 8/11 [====================>.........] - ETA: 0s - loss: 0.1599 - accuracy: 0.723410/11 [==========================>...] - ETA: 0s - loss: 0.1588 - accuracy: 0.730211/11 [==============================] - 0s 25ms/step - loss: 0.1579 - accuracy: 0.7364
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1528 - accuracy: 0.7422 4/11 [=========>....................] - ETA: 0s - loss: 0.1509 - accuracy: 0.7381 7/11 [==================>...........] - ETA: 0s - loss: 0.1486 - accuracy: 0.7300 9/11 [=======================>......] - ETA: 0s - loss: 0.1483 - accuracy: 0.731511/11 [==============================] - ETA: 0s - loss: 0.1478 - accuracy: 0.735811/11 [==============================] - 0s 25ms/step - loss: 0.1476 - accuracy: 0.7377
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1464 - accuracy: 0.8438 4/11 [=========>....................] - ETA: 0s - loss: 0.1478 - accuracy: 0.8008 6/11 [===============>..............] - ETA: 0s - loss: 0.1458 - accuracy: 0.7848 8/11 [====================>.........] - ETA: 0s - loss: 0.1436 - accuracy: 0.779011/11 [==============================] - ETA: 0s - loss: 0.1413 - accuracy: 0.778111/11 [==============================] - 0s 24ms/step - loss: 0.1408 - accuracy: 0.7784
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1376 - accuracy: 0.8438 4/11 [=========>....................] - ETA: 0s - loss: 0.1377 - accuracy: 0.8242 6/11 [===============>..............] - ETA: 0s - loss: 0.1363 - accuracy: 0.8110 8/11 [====================>.........] - ETA: 0s - loss: 0.1353 - accuracy: 0.803011/11 [==============================] - ETA: 0s - loss: 0.1331 - accuracy: 0.799911/11 [==============================] - 0s 25ms/step - loss: 0.1325 - accuracy: 0.7996
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1171 - accuracy: 0.8359 4/11 [=========>....................] - ETA: 0s - loss: 0.1121 - accuracy: 0.8288 6/11 [===============>..............] - ETA: 0s - loss: 0.1126 - accuracy: 0.8242 9/11 [=======================>......] - ETA: 0s - loss: 0.1146 - accuracy: 0.822311/11 [==============================] - ETA: 0s - loss: 0.1154 - accuracy: 0.820811/11 [==============================] - 0s 25ms/step - loss: 0.1157 - accuracy: 0.8201
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1294 - accuracy: 0.7891 4/11 [=========>....................] - ETA: 0s - loss: 0.1224 - accuracy: 0.7915 7/11 [==================>...........] - ETA: 0s - loss: 0.1178 - accuracy: 0.786610/11 [==========================>...] - ETA: 0s - loss: 0.1159 - accuracy: 0.787811/11 [==============================] - 0s 25ms/step - loss: 0.1154 - accuracy: 0.7903
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.1427 - accuracy: 0.83596/6 [==============================] - 5s 10ms/step - loss: 0.1273 - accuracy: 0.8201
2021-12-13 23:34:28.666432: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:34:28.668104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:34:28.668182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:34:28.668242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:34:28.668284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:34:28.668340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:34:28.668392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:34:28.668439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:34:28.668485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:34:28.668533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:34:28.669654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:34:28.669698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:34:28.669711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:34:28.669720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:34:28.670489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:34:28.670792: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:34:28.671180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:34:28.671209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:34:28.671237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:34:28.671264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:34:28.671291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:34:28.671318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:34:28.671348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:34:28.671377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:34:28.671404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:34:28.672116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:34:28.672144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:34:28.672156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:34:28.672164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:34:28.672900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 0 4] pred: [0.00146813 0.00210882 0.9747127  0.01784593 0.00129311]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [7.8119999e-03 8.4034735e-01 9.0204215e-01 8.4950542e-04 4.0973598e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [2.5475393e-03 8.6062199e-01 9.5801532e-01 4.0477488e-04 2.9243121e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [0 1 3 4 2] pred: [0.6414549  0.30074647 0.03733355 0.09825206 0.05434452]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [3.3039136e-03 3.0507827e-01 8.7904900e-01 4.1484041e-03 7.6826336e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 0 4] pred: [0.00157494 0.00202853 0.9742795  0.01917362 0.0013417 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 0 4] pred: [0.00297289 0.00444483 0.96621466 0.02278661 0.00147186]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [4.3743816e-03 7.9307234e-01 8.6497706e-01 1.4336306e-03 5.0231785e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [0.00239162 0.1031227  0.96223    0.01232724 0.00202558]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 4 0] pred: [0.00174102 0.00682428 0.96518666 0.01130684 0.00182864]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [1.0084180e-03 7.4447733e-01 9.7342652e-01 3.8840179e-04 2.3154641e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 3 0 4] pred: [0.0232194  0.8580738  0.44587857 0.02879065 0.00763453]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [3 2 4 0 1] pred: [0.0729936  0.01350571 0.19756684 0.76438653 0.12337489]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 4 0] pred: [0.0014604  0.00336163 0.9676011  0.021223   0.00287873]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 2 4 0 1] pred: [0.10662317 0.02219197 0.25039914 0.86427647 0.10983332]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:32 - loss: 0.6978 - accuracy: 0.1250 4/11 [=========>....................] - ETA: 0s - loss: 0.6939 - accuracy: 0.1803   6/11 [===============>..............] - ETA: 0s - loss: 0.6911 - accuracy: 0.2276 9/11 [=======================>......] - ETA: 0s - loss: 0.6870 - accuracy: 0.274511/11 [==============================] - 15s 24ms/step - loss: 0.6831 - accuracy: 0.3049
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6361 - accuracy: 0.3828 4/11 [=========>....................] - ETA: 0s - loss: 0.6304 - accuracy: 0.4378 7/11 [==================>...........] - ETA: 0s - loss: 0.6248 - accuracy: 0.4470 9/11 [=======================>......] - ETA: 0s - loss: 0.6207 - accuracy: 0.449611/11 [==============================] - 0s 24ms/step - loss: 0.6149 - accuracy: 0.4510
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5398 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.5335 - accuracy: 0.4553 5/11 [============>.................] - ETA: 0s - loss: 0.5267 - accuracy: 0.4555 8/11 [====================>.........] - ETA: 0s - loss: 0.5174 - accuracy: 0.456811/11 [==============================] - ETA: 0s - loss: 0.5090 - accuracy: 0.455411/11 [==============================] - 0s 25ms/step - loss: 0.5067 - accuracy: 0.4555
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4252 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.4016 - accuracy: 0.4681 7/11 [==================>...........] - ETA: 0s - loss: 0.3934 - accuracy: 0.4652 9/11 [=======================>......] - ETA: 0s - loss: 0.3898 - accuracy: 0.464911/11 [==============================] - 0s 25ms/step - loss: 0.3867 - accuracy: 0.4628
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3170 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3344 - accuracy: 0.4501 5/11 [============>.................] - ETA: 0s - loss: 0.3386 - accuracy: 0.4513 7/11 [==================>...........] - ETA: 0s - loss: 0.3388 - accuracy: 0.453810/11 [==========================>...] - ETA: 0s - loss: 0.3393 - accuracy: 0.452511/11 [==============================] - 0s 25ms/step - loss: 0.3393 - accuracy: 0.4531
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3111 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.3188 - accuracy: 0.4414 7/11 [==================>...........] - ETA: 0s - loss: 0.3229 - accuracy: 0.4463 9/11 [=======================>......] - ETA: 0s - loss: 0.3226 - accuracy: 0.448911/11 [==============================] - 0s 25ms/step - loss: 0.3217 - accuracy: 0.4511
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3080 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.3090 - accuracy: 0.4727 7/11 [==================>...........] - ETA: 0s - loss: 0.3089 - accuracy: 0.4634 9/11 [=======================>......] - ETA: 0s - loss: 0.3071 - accuracy: 0.462611/11 [==============================] - ETA: 0s - loss: 0.3053 - accuracy: 0.462711/11 [==============================] - 0s 25ms/step - loss: 0.3048 - accuracy: 0.4627
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2973 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.2907 - accuracy: 0.4645 7/11 [==================>...........] - ETA: 0s - loss: 0.2878 - accuracy: 0.4594 9/11 [=======================>......] - ETA: 0s - loss: 0.2857 - accuracy: 0.461111/11 [==============================] - 0s 24ms/step - loss: 0.2839 - accuracy: 0.4629
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2668 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.2596 - accuracy: 0.4971 7/11 [==================>...........] - ETA: 0s - loss: 0.2595 - accuracy: 0.490210/11 [==========================>...] - ETA: 0s - loss: 0.2593 - accuracy: 0.487911/11 [==============================] - 0s 24ms/step - loss: 0.2589 - accuracy: 0.4870
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2532 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.2523 - accuracy: 0.4601 7/11 [==================>...........] - ETA: 0s - loss: 0.2498 - accuracy: 0.4739 9/11 [=======================>......] - ETA: 0s - loss: 0.2486 - accuracy: 0.480611/11 [==============================] - 0s 24ms/step - loss: 0.2460 - accuracy: 0.4890
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2303 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.2271 - accuracy: 0.5282 6/11 [===============>..............] - ETA: 0s - loss: 0.2254 - accuracy: 0.5282 8/11 [====================>.........] - ETA: 0s - loss: 0.2250 - accuracy: 0.531910/11 [==========================>...] - ETA: 0s - loss: 0.2243 - accuracy: 0.535911/11 [==============================] - 0s 24ms/step - loss: 0.2237 - accuracy: 0.5392
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2123 - accuracy: 0.6016 4/11 [=========>....................] - ETA: 0s - loss: 0.2109 - accuracy: 0.5871 6/11 [===============>..............] - ETA: 0s - loss: 0.2096 - accuracy: 0.5892 9/11 [=======================>......] - ETA: 0s - loss: 0.2077 - accuracy: 0.588811/11 [==============================] - 0s 24ms/step - loss: 0.2067 - accuracy: 0.5886
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1860 - accuracy: 0.6250 4/11 [=========>....................] - ETA: 0s - loss: 0.1881 - accuracy: 0.6128 7/11 [==================>...........] - ETA: 0s - loss: 0.1899 - accuracy: 0.6071 9/11 [=======================>......] - ETA: 0s - loss: 0.1902 - accuracy: 0.606811/11 [==============================] - ETA: 0s - loss: 0.1900 - accuracy: 0.606811/11 [==============================] - 0s 25ms/step - loss: 0.1899 - accuracy: 0.6071
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1887 - accuracy: 0.6641 4/11 [=========>....................] - ETA: 0s - loss: 0.1810 - accuracy: 0.6637 7/11 [==================>...........] - ETA: 0s - loss: 0.1789 - accuracy: 0.6603 9/11 [=======================>......] - ETA: 0s - loss: 0.1779 - accuracy: 0.658411/11 [==============================] - 0s 24ms/step - loss: 0.1770 - accuracy: 0.6578
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1497 - accuracy: 0.6562 3/11 [=======>......................] - ETA: 0s - loss: 0.1563 - accuracy: 0.6506 6/11 [===============>..............] - ETA: 0s - loss: 0.1598 - accuracy: 0.6489 8/11 [====================>.........] - ETA: 0s - loss: 0.1603 - accuracy: 0.649910/11 [==========================>...] - ETA: 0s - loss: 0.1600 - accuracy: 0.652311/11 [==============================] - 0s 25ms/step - loss: 0.1601 - accuracy: 0.6546
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1666 - accuracy: 0.7578 4/11 [=========>....................] - ETA: 0s - loss: 0.1603 - accuracy: 0.6934 7/11 [==================>...........] - ETA: 0s - loss: 0.1572 - accuracy: 0.6893 9/11 [=======================>......] - ETA: 0s - loss: 0.1551 - accuracy: 0.688611/11 [==============================] - 0s 25ms/step - loss: 0.1534 - accuracy: 0.6875
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1514 - accuracy: 0.6719 4/11 [=========>....................] - ETA: 0s - loss: 0.1393 - accuracy: 0.6772 6/11 [===============>..............] - ETA: 0s - loss: 0.1379 - accuracy: 0.6844 9/11 [=======================>......] - ETA: 0s - loss: 0.1372 - accuracy: 0.691611/11 [==============================] - 0s 27ms/step - loss: 0.1371 - accuracy: 0.6965
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1362 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.1342 - accuracy: 0.6866 6/11 [===============>..............] - ETA: 0s - loss: 0.1333 - accuracy: 0.7046 9/11 [=======================>......] - ETA: 0s - loss: 0.1321 - accuracy: 0.711111/11 [==============================] - 0s 24ms/step - loss: 0.1312 - accuracy: 0.7124
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1210 - accuracy: 0.7656 4/11 [=========>....................] - ETA: 0s - loss: 0.1190 - accuracy: 0.7716 7/11 [==================>...........] - ETA: 0s - loss: 0.1190 - accuracy: 0.7709 9/11 [=======================>......] - ETA: 0s - loss: 0.1193 - accuracy: 0.768311/11 [==============================] - 0s 24ms/step - loss: 0.1193 - accuracy: 0.7656
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1176 - accuracy: 0.7500 4/11 [=========>....................] - ETA: 0s - loss: 0.1169 - accuracy: 0.7559 6/11 [===============>..............] - ETA: 0s - loss: 0.1160 - accuracy: 0.7582 9/11 [=======================>......] - ETA: 0s - loss: 0.1152 - accuracy: 0.765211/11 [==============================] - 0s 26ms/step - loss: 0.1146 - accuracy: 0.7700
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.1055 - accuracy: 0.82816/6 [==============================] - 5s 10ms/step - loss: 0.1159 - accuracy: 0.7861
2021-12-13 23:35:04.636952: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:35:04.637822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:35:04.637899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:35:04.637971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:35:04.638024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:35:04.638078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:35:04.638128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:35:04.638177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:35:04.638226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:35:04.638280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:35:04.639282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:35:04.639344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:35:04.639362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:35:04.639376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:35:04.640455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:35:04.640892: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:35:04.641742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:35:04.641786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:35:04.641828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:35:04.641872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:35:04.641914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:35:04.641972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:35:04.642016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:35:04.642061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:35:04.642104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:35:04.643129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:35:04.643172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:35:04.643190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:35:04.643204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:35:04.644278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 4 0] pred: [0.00078313 0.01104895 0.7593368  0.05178111 0.00167735]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [4 3 0 2 1] pred: [0.139921   0.00703999 0.08367535 0.7921932  0.9348659 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [3.1093671e-04 2.0557320e-02 9.6847892e-01 3.5812061e-03 1.6729951e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [4.7432294e-04 2.7102407e-02 9.5169502e-01 3.4904876e-03 2.4321802e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [1.1461430e-02 7.7736747e-01 8.6248875e-01 3.6405381e-03 5.1014608e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 3 4] pred: [9.4869006e-03 7.8767604e-01 8.7228018e-01 3.5668004e-03 4.5893952e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [0 1 4 2 3] pred: [0.8754529  0.35563502 0.02702705 0.00533695 0.06569819]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [3 2 4 0 1] pred: [0.00768813 0.00716928 0.10376913 0.87284464 0.06570938]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 0 1] pred: [0.00823027 0.00675655 0.10586281 0.847847   0.07029436]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [1.0989518e-02 8.4339100e-01 8.6089319e-01 3.5852324e-03 3.7997781e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [1.3824867e-02 8.3411866e-01 8.2429755e-01 3.8165147e-03 5.2212429e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [4 3 0 2 1] pred: [0.29587948 0.01855581 0.06790155 0.57478744 0.8822531 ]
 Top predictions indices: [4 3] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 2 4 0 1] pred: [0.00669918 0.00654278 0.11973814 0.8589157  0.06351592]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [0 1 4 3 2] pred: [0.88782185 0.35810915 0.01292197 0.12414287 0.3295473 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 3 0 4] pred: [0.01020777 0.76054823 0.71231616 0.01920471 0.00117624]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:32 - loss: 0.6881 - accuracy: 0.2812 3/11 [=======>......................] - ETA: 0s - loss: 0.6859 - accuracy: 0.3342   5/11 [============>.................] - ETA: 0s - loss: 0.6835 - accuracy: 0.3568 8/11 [====================>.........] - ETA: 0s - loss: 0.6796 - accuracy: 0.380511/11 [==============================] - ETA: 0s - loss: 0.6756 - accuracy: 0.393411/11 [==============================] - 15s 24ms/step - loss: 0.6746 - accuracy: 0.3961
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6233 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.6223 - accuracy: 0.4653 5/11 [============>.................] - ETA: 0s - loss: 0.6192 - accuracy: 0.4579 8/11 [====================>.........] - ETA: 0s - loss: 0.6134 - accuracy: 0.456011/11 [==============================] - ETA: 0s - loss: 0.6072 - accuracy: 0.454511/11 [==============================] - 0s 24ms/step - loss: 0.6055 - accuracy: 0.4543
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5285 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.5248 - accuracy: 0.4549 5/11 [============>.................] - ETA: 0s - loss: 0.5204 - accuracy: 0.4464 7/11 [==================>...........] - ETA: 0s - loss: 0.5134 - accuracy: 0.445810/11 [==========================>...] - ETA: 0s - loss: 0.5041 - accuracy: 0.444211/11 [==============================] - 0s 26ms/step - loss: 0.4983 - accuracy: 0.4456
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4098 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4070 - accuracy: 0.4484 5/11 [============>.................] - ETA: 0s - loss: 0.4022 - accuracy: 0.4467 8/11 [====================>.........] - ETA: 0s - loss: 0.3959 - accuracy: 0.446310/11 [==========================>...] - ETA: 0s - loss: 0.3921 - accuracy: 0.447611/11 [==============================] - 0s 26ms/step - loss: 0.3889 - accuracy: 0.4484
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3283 - accuracy: 0.5391 4/11 [=========>....................] - ETA: 0s - loss: 0.3378 - accuracy: 0.5080 6/11 [===============>..............] - ETA: 0s - loss: 0.3417 - accuracy: 0.4999 8/11 [====================>.........] - ETA: 0s - loss: 0.3441 - accuracy: 0.491510/11 [==========================>...] - ETA: 0s - loss: 0.3446 - accuracy: 0.485211/11 [==============================] - 0s 25ms/step - loss: 0.3444 - accuracy: 0.4797
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3044 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.3136 - accuracy: 0.5022 6/11 [===============>..............] - ETA: 0s - loss: 0.3141 - accuracy: 0.4896 8/11 [====================>.........] - ETA: 0s - loss: 0.3157 - accuracy: 0.481710/11 [==========================>...] - ETA: 0s - loss: 0.3168 - accuracy: 0.475811/11 [==============================] - 0s 26ms/step - loss: 0.3172 - accuracy: 0.4720
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3080 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.3013 - accuracy: 0.4592 5/11 [============>.................] - ETA: 0s - loss: 0.2985 - accuracy: 0.4558 7/11 [==================>...........] - ETA: 0s - loss: 0.2972 - accuracy: 0.457510/11 [==========================>...] - ETA: 0s - loss: 0.2959 - accuracy: 0.457911/11 [==============================] - 0s 26ms/step - loss: 0.2951 - accuracy: 0.4576
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2678 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.2774 - accuracy: 0.4604 6/11 [===============>..............] - ETA: 0s - loss: 0.2773 - accuracy: 0.4596 9/11 [=======================>......] - ETA: 0s - loss: 0.2759 - accuracy: 0.465611/11 [==============================] - 0s 25ms/step - loss: 0.2733 - accuracy: 0.4703
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2446 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.2544 - accuracy: 0.5161 6/11 [===============>..............] - ETA: 0s - loss: 0.2549 - accuracy: 0.5197 8/11 [====================>.........] - ETA: 0s - loss: 0.2540 - accuracy: 0.524610/11 [==========================>...] - ETA: 0s - loss: 0.2518 - accuracy: 0.530611/11 [==============================] - 0s 26ms/step - loss: 0.2504 - accuracy: 0.5342
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2139 - accuracy: 0.5625 4/11 [=========>....................] - ETA: 0s - loss: 0.2192 - accuracy: 0.5807 6/11 [===============>..............] - ETA: 0s - loss: 0.2219 - accuracy: 0.5807 9/11 [=======================>......] - ETA: 0s - loss: 0.2238 - accuracy: 0.579211/11 [==============================] - 0s 25ms/step - loss: 0.2241 - accuracy: 0.5777
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2110 - accuracy: 0.6094 3/11 [=======>......................] - ETA: 0s - loss: 0.2183 - accuracy: 0.5846 5/11 [============>.................] - ETA: 0s - loss: 0.2185 - accuracy: 0.5805 8/11 [====================>.........] - ETA: 0s - loss: 0.2166 - accuracy: 0.585410/11 [==========================>...] - ETA: 0s - loss: 0.2152 - accuracy: 0.586511/11 [==============================] - 0s 25ms/step - loss: 0.2141 - accuracy: 0.5875
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1902 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.1906 - accuracy: 0.5951 5/11 [============>.................] - ETA: 0s - loss: 0.1913 - accuracy: 0.6070 8/11 [====================>.........] - ETA: 0s - loss: 0.1914 - accuracy: 0.613410/11 [==========================>...] - ETA: 0s - loss: 0.1916 - accuracy: 0.613911/11 [==============================] - 0s 25ms/step - loss: 0.1917 - accuracy: 0.6140
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1909 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.1870 - accuracy: 0.6285 6/11 [===============>..............] - ETA: 0s - loss: 0.1846 - accuracy: 0.6362 8/11 [====================>.........] - ETA: 0s - loss: 0.1836 - accuracy: 0.641910/11 [==========================>...] - ETA: 0s - loss: 0.1822 - accuracy: 0.647611/11 [==============================] - 0s 26ms/step - loss: 0.1814 - accuracy: 0.6515
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1636 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.1680 - accuracy: 0.7038 6/11 [===============>..............] - ETA: 0s - loss: 0.1671 - accuracy: 0.6991 9/11 [=======================>......] - ETA: 0s - loss: 0.1663 - accuracy: 0.696111/11 [==============================] - 0s 25ms/step - loss: 0.1653 - accuracy: 0.6989
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1658 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.1586 - accuracy: 0.7726 6/11 [===============>..............] - ETA: 0s - loss: 0.1552 - accuracy: 0.7657 8/11 [====================>.........] - ETA: 0s - loss: 0.1539 - accuracy: 0.760911/11 [==============================] - ETA: 0s - loss: 0.1527 - accuracy: 0.756411/11 [==============================] - 0s 26ms/step - loss: 0.1525 - accuracy: 0.7554
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1449 - accuracy: 0.7578 4/11 [=========>....................] - ETA: 0s - loss: 0.1477 - accuracy: 0.7699 6/11 [===============>..............] - ETA: 0s - loss: 0.1467 - accuracy: 0.7751 8/11 [====================>.........] - ETA: 0s - loss: 0.1456 - accuracy: 0.780310/11 [==========================>...] - ETA: 0s - loss: 0.1444 - accuracy: 0.782911/11 [==============================] - 0s 26ms/step - loss: 0.1434 - accuracy: 0.7852
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1408 - accuracy: 0.8672 4/11 [=========>....................] - ETA: 0s - loss: 0.1375 - accuracy: 0.8560 6/11 [===============>..............] - ETA: 0s - loss: 0.1355 - accuracy: 0.8574 8/11 [====================>.........] - ETA: 0s - loss: 0.1341 - accuracy: 0.859310/11 [==========================>...] - ETA: 0s - loss: 0.1331 - accuracy: 0.858011/11 [==============================] - 0s 26ms/step - loss: 0.1326 - accuracy: 0.8558
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1150 - accuracy: 0.8828 3/11 [=======>......................] - ETA: 0s - loss: 0.1224 - accuracy: 0.8850 5/11 [============>.................] - ETA: 0s - loss: 0.1254 - accuracy: 0.8876 7/11 [==================>...........] - ETA: 0s - loss: 0.1250 - accuracy: 0.887210/11 [==========================>...] - ETA: 0s - loss: 0.1250 - accuracy: 0.880411/11 [==============================] - 0s 27ms/step - loss: 0.1249 - accuracy: 0.8762
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1243 - accuracy: 0.8516 4/11 [=========>....................] - ETA: 0s - loss: 0.1222 - accuracy: 0.8722 6/11 [===============>..............] - ETA: 0s - loss: 0.1215 - accuracy: 0.8807 9/11 [=======================>......] - ETA: 0s - loss: 0.1210 - accuracy: 0.888011/11 [==============================] - 0s 25ms/step - loss: 0.1203 - accuracy: 0.8904
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1029 - accuracy: 0.8359 4/11 [=========>....................] - ETA: 0s - loss: 0.1042 - accuracy: 0.8369 7/11 [==================>...........] - ETA: 0s - loss: 0.1056 - accuracy: 0.8381 9/11 [=======================>......] - ETA: 0s - loss: 0.1063 - accuracy: 0.842211/11 [==============================] - ETA: 0s - loss: 0.1071 - accuracy: 0.846411/11 [==============================] - 0s 26ms/step - loss: 0.1074 - accuracy: 0.8480
Evaluate on test data
1/6 [====>.........................] - ETA: 23s - loss: 0.1166 - accuracy: 0.89066/6 [==============================] - 5s 9ms/step - loss: 0.1193 - accuracy: 0.8895
2021-12-13 23:35:40.649398: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:35:40.650014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:35:40.650069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:35:40.650111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:35:40.650140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:35:40.650175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:35:40.650204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:35:40.650231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:35:40.650260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:35:40.650287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:35:40.650994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:35:40.651037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:35:40.651049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:35:40.651059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:35:40.651803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:35:40.652108: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:35:40.652476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:35:40.652505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:35:40.652531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:35:40.652559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:35:40.652586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:35:40.652613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:35:40.652640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:35:40.652668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:35:40.652695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:35:40.653373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:35:40.653401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:35:40.653413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:35:40.653422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:35:40.654131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [4.5384912e-04 1.6041290e-02 9.6790767e-01 9.6159894e-03 3.6417943e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [1.2552502e-02 9.1192240e-01 7.8106880e-01 4.8830560e-03 3.8871722e-04]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [1 0 2 3 4] pred: [0.45971495 0.69087136 0.1251356  0.01515694 0.01431904]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [3 2 4 1 0] pred: [0.00101934 0.00178879 0.12270138 0.841144   0.04561509]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [1.6540948e-02 9.4979173e-01 7.8374845e-01 4.1450607e-03 4.0442657e-04]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 2 4 3] pred: [0.8122486  0.44765848 0.15161756 0.01208434 0.0613817 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [5.2437262e-04 1.2689420e-02 9.6225554e-01 1.1155306e-02 4.2844875e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [1.6382789e-02 9.3017226e-01 7.7323759e-01 4.4123982e-03 3.7983819e-04]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [1.1918766e-02 9.3402779e-01 8.1430286e-01 3.9290162e-03 3.3346342e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [4.1039719e-04 1.4417663e-02 9.6863103e-01 9.6912356e-03 3.7135996e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [1.0348351e-02 9.2253309e-01 8.2311130e-01 4.0054545e-03 3.2216060e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [7.8832041e-03 9.0575665e-01 8.3746517e-01 3.0645034e-03 2.1800476e-04]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [1.0612773e-02 9.0572160e-01 8.1916553e-01 4.0073534e-03 3.0608487e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [4 3 0 2 1] pred: [0.06373795 0.0024892  0.05641567 0.5382556  0.8028008 ]
 Top predictions indices: [4 3] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [4.4008135e-04 2.8529581e-02 9.7797787e-01 6.6861496e-03 2.7189398e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:30 - loss: 0.7012 - accuracy: 0.0703 4/11 [=========>....................] - ETA: 0s - loss: 0.6969 - accuracy: 0.1227   7/11 [==================>...........] - ETA: 0s - loss: 0.6927 - accuracy: 0.2010 9/11 [=======================>......] - ETA: 0s - loss: 0.6899 - accuracy: 0.233611/11 [==============================] - 15s 25ms/step - loss: 0.6861 - accuracy: 0.2651
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6376 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.6317 - accuracy: 0.4447 6/11 [===============>..............] - ETA: 0s - loss: 0.6280 - accuracy: 0.4510 9/11 [=======================>......] - ETA: 0s - loss: 0.6224 - accuracy: 0.450711/11 [==============================] - ETA: 0s - loss: 0.6185 - accuracy: 0.450511/11 [==============================] - 0s 24ms/step - loss: 0.6169 - accuracy: 0.4503
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5389 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.5355 - accuracy: 0.4332 6/11 [===============>..............] - ETA: 0s - loss: 0.5271 - accuracy: 0.4352 9/11 [=======================>......] - ETA: 0s - loss: 0.5179 - accuracy: 0.438111/11 [==============================] - ETA: 0s - loss: 0.5118 - accuracy: 0.439811/11 [==============================] - 0s 24ms/step - loss: 0.5092 - accuracy: 0.4405
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4128 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.4143 - accuracy: 0.4093 6/11 [===============>..............] - ETA: 0s - loss: 0.4053 - accuracy: 0.4189 8/11 [====================>.........] - ETA: 0s - loss: 0.4017 - accuracy: 0.423410/11 [==========================>...] - ETA: 0s - loss: 0.3979 - accuracy: 0.428511/11 [==============================] - 0s 25ms/step - loss: 0.3948 - accuracy: 0.4317
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3691 - accuracy: 0.4141 4/11 [=========>....................] - ETA: 0s - loss: 0.3675 - accuracy: 0.4290 6/11 [===============>..............] - ETA: 0s - loss: 0.3628 - accuracy: 0.4354 9/11 [=======================>......] - ETA: 0s - loss: 0.3624 - accuracy: 0.437611/11 [==============================] - 0s 25ms/step - loss: 0.3622 - accuracy: 0.4396
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4039 - accuracy: 0.3906 4/11 [=========>....................] - ETA: 0s - loss: 0.3698 - accuracy: 0.4285 6/11 [===============>..............] - ETA: 0s - loss: 0.3629 - accuracy: 0.4358 8/11 [====================>.........] - ETA: 0s - loss: 0.3591 - accuracy: 0.440511/11 [==============================] - ETA: 0s - loss: 0.3545 - accuracy: 0.444111/11 [==============================] - 0s 25ms/step - loss: 0.3536 - accuracy: 0.4444
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3754 - accuracy: 0.3516 4/11 [=========>....................] - ETA: 0s - loss: 0.3563 - accuracy: 0.4023 7/11 [==================>...........] - ETA: 0s - loss: 0.3468 - accuracy: 0.425610/11 [==========================>...] - ETA: 0s - loss: 0.3421 - accuracy: 0.433711/11 [==============================] - 0s 25ms/step - loss: 0.3395 - accuracy: 0.4377
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2959 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 0s - loss: 0.3050 - accuracy: 0.4897 7/11 [==================>...........] - ETA: 0s - loss: 0.3072 - accuracy: 0.4820 9/11 [=======================>......] - ETA: 0s - loss: 0.3076 - accuracy: 0.477911/11 [==============================] - ETA: 0s - loss: 0.3073 - accuracy: 0.474811/11 [==============================] - 0s 25ms/step - loss: 0.3072 - accuracy: 0.4738
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2866 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.2867 - accuracy: 0.5026 6/11 [===============>..............] - ETA: 0s - loss: 0.2882 - accuracy: 0.4945 8/11 [====================>.........] - ETA: 0s - loss: 0.2881 - accuracy: 0.490611/11 [==============================] - ETA: 0s - loss: 0.2872 - accuracy: 0.487011/11 [==============================] - 0s 25ms/step - loss: 0.2868 - accuracy: 0.4861
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2291 - accuracy: 0.5703 4/11 [=========>....................] - ETA: 0s - loss: 0.2452 - accuracy: 0.5288 7/11 [==================>...........] - ETA: 0s - loss: 0.2493 - accuracy: 0.5213 9/11 [=======================>......] - ETA: 0s - loss: 0.2507 - accuracy: 0.516411/11 [==============================] - 0s 24ms/step - loss: 0.2521 - accuracy: 0.5094
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2439 - accuracy: 0.3906 4/11 [=========>....................] - ETA: 0s - loss: 0.2435 - accuracy: 0.4451 7/11 [==================>...........] - ETA: 0s - loss: 0.2431 - accuracy: 0.466010/11 [==========================>...] - ETA: 0s - loss: 0.2415 - accuracy: 0.479611/11 [==============================] - 0s 23ms/step - loss: 0.2404 - accuracy: 0.4856
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2001 - accuracy: 0.5391 4/11 [=========>....................] - ETA: 0s - loss: 0.2083 - accuracy: 0.5552 6/11 [===============>..............] - ETA: 0s - loss: 0.2107 - accuracy: 0.5589 8/11 [====================>.........] - ETA: 0s - loss: 0.2129 - accuracy: 0.561211/11 [==============================] - ETA: 0s - loss: 0.2142 - accuracy: 0.562411/11 [==============================] - 0s 25ms/step - loss: 0.2144 - accuracy: 0.5624
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1964 - accuracy: 0.5469 4/11 [=========>....................] - ETA: 0s - loss: 0.1997 - accuracy: 0.5778 7/11 [==================>...........] - ETA: 0s - loss: 0.2011 - accuracy: 0.5885 9/11 [=======================>......] - ETA: 0s - loss: 0.2014 - accuracy: 0.592111/11 [==============================] - ETA: 0s - loss: 0.2015 - accuracy: 0.595511/11 [==============================] - 0s 25ms/step - loss: 0.2015 - accuracy: 0.5969
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2005 - accuracy: 0.6406 4/11 [=========>....................] - ETA: 0s - loss: 0.1965 - accuracy: 0.6237 7/11 [==================>...........] - ETA: 0s - loss: 0.1972 - accuracy: 0.6253 9/11 [=======================>......] - ETA: 0s - loss: 0.1967 - accuracy: 0.625811/11 [==============================] - 0s 23ms/step - loss: 0.1952 - accuracy: 0.6294
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1885 - accuracy: 0.6562 3/11 [=======>......................] - ETA: 0s - loss: 0.1842 - accuracy: 0.6923 6/11 [===============>..............] - ETA: 0s - loss: 0.1836 - accuracy: 0.6998 8/11 [====================>.........] - ETA: 0s - loss: 0.1830 - accuracy: 0.703610/11 [==========================>...] - ETA: 0s - loss: 0.1823 - accuracy: 0.705511/11 [==============================] - 0s 26ms/step - loss: 0.1817 - accuracy: 0.7061
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1865 - accuracy: 0.6562 4/11 [=========>....................] - ETA: 0s - loss: 0.1693 - accuracy: 0.6849 7/11 [==================>...........] - ETA: 0s - loss: 0.1674 - accuracy: 0.700310/11 [==========================>...] - ETA: 0s - loss: 0.1674 - accuracy: 0.705111/11 [==============================] - 0s 24ms/step - loss: 0.1676 - accuracy: 0.7066
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1529 - accuracy: 0.8047 4/11 [=========>....................] - ETA: 0s - loss: 0.1544 - accuracy: 0.8049 7/11 [==================>...........] - ETA: 0s - loss: 0.1566 - accuracy: 0.7864 9/11 [=======================>......] - ETA: 0s - loss: 0.1571 - accuracy: 0.780011/11 [==============================] - 0s 24ms/step - loss: 0.1575 - accuracy: 0.7769
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1387 - accuracy: 0.8516 4/11 [=========>....................] - ETA: 0s - loss: 0.1450 - accuracy: 0.8547 6/11 [===============>..............] - ETA: 0s - loss: 0.1465 - accuracy: 0.8377 8/11 [====================>.........] - ETA: 0s - loss: 0.1476 - accuracy: 0.827311/11 [==============================] - ETA: 0s - loss: 0.1481 - accuracy: 0.821211/11 [==============================] - 0s 24ms/step - loss: 0.1482 - accuracy: 0.8199
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1528 - accuracy: 0.8594 3/11 [=======>......................] - ETA: 0s - loss: 0.1453 - accuracy: 0.8520 5/11 [============>.................] - ETA: 0s - loss: 0.1428 - accuracy: 0.8496 8/11 [====================>.........] - ETA: 0s - loss: 0.1415 - accuracy: 0.844110/11 [==========================>...] - ETA: 0s - loss: 0.1411 - accuracy: 0.842011/11 [==============================] - 0s 26ms/step - loss: 0.1406 - accuracy: 0.8411
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1232 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.1307 - accuracy: 0.8151 6/11 [===============>..............] - ETA: 0s - loss: 0.1311 - accuracy: 0.8184 9/11 [=======================>......] - ETA: 0s - loss: 0.1315 - accuracy: 0.825811/11 [==============================] - ETA: 0s - loss: 0.1313 - accuracy: 0.829011/11 [==============================] - 0s 24ms/step - loss: 0.1312 - accuracy: 0.8302
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1251 - accuracy: 0.77346/6 [==============================] - 5s 10ms/step - loss: 0.1203 - accuracy: 0.8003
2021-12-13 23:36:16.828561: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:36:16.829662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:36:16.829720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:36:16.829766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:36:16.829798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:36:16.829829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:36:16.829860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:36:16.829892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:36:16.829924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:36:16.829967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:36:16.830692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:36:16.830735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:36:16.830747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:36:16.830757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:36:16.831564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:36:16.831872: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:36:16.832266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:36:16.832294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:36:16.832322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:36:16.832349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:36:16.832376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:36:16.832403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:36:16.832430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:36:16.832457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:36:16.832484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:36:16.833193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:36:16.833221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:36:16.833233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:36:16.833242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:36:16.834016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [4.2453638e-04 4.4931591e-02 9.7131991e-01 3.2804543e-03 1.2334551e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 4 3] pred: [0.100632   0.6535933  0.2587296  0.00319789 0.00489844]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [2.3771352e-03 4.6934065e-01 8.9860117e-01 6.8095210e-03 4.9362262e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [3.0682524e-04 6.8448007e-02 9.7962266e-01 2.5688233e-03 8.4137610e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [3 4 2 0 1] pred: [0.00482179 0.00188122 0.05111654 0.5756669  0.49399313]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.01782424 0.8089279  0.7390396  0.0069328  0.0015622 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [4.4104859e-04 5.7480451e-02 9.6786213e-01 3.0927337e-03 1.2976117e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [0.0271636  0.91092885 0.8253125  0.0066299  0.0012104 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [3 4 2 0 1] pred: [0.00537699 0.00196126 0.0413814  0.5825744  0.5485249 ]
 Top predictions indices: [3 4] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [0.01453042 0.8174001  0.79619896 0.00612058 0.00109756]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [0.02142203 0.87177265 0.77064455 0.00671749 0.00153719]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 4 3] pred: [0.10294519 0.6468713  0.36794966 0.00503618 0.00541551]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [0.00593264 0.35813752 0.9460441  0.02086991 0.00103168]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [4 3 0 2 1] pred: [0.02853034 0.00951985 0.02458002 0.57329327 0.7685328 ]
 Top predictions indices: [4 3] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [7.1067683e-04 3.2397233e-02 9.5757788e-01 5.3196610e-03 2.6237237e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:39 - loss: 0.6939 - accuracy: 0.1562 3/11 [=======>......................] - ETA: 0s - loss: 0.6908 - accuracy: 0.2626   6/11 [===============>..............] - ETA: 0s - loss: 0.6862 - accuracy: 0.3307 9/11 [=======================>......] - ETA: 0s - loss: 0.6817 - accuracy: 0.361811/11 [==============================] - 16s 24ms/step - loss: 0.6774 - accuracy: 0.3806
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6219 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 0s - loss: 0.6158 - accuracy: 0.4909 7/11 [==================>...........] - ETA: 0s - loss: 0.6098 - accuracy: 0.4807 9/11 [=======================>......] - ETA: 0s - loss: 0.6053 - accuracy: 0.479011/11 [==============================] - 0s 24ms/step - loss: 0.5991 - accuracy: 0.4754
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5149 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.5075 - accuracy: 0.4562 6/11 [===============>..............] - ETA: 0s - loss: 0.4985 - accuracy: 0.4576 9/11 [=======================>......] - ETA: 0s - loss: 0.4891 - accuracy: 0.459011/11 [==============================] - 0s 25ms/step - loss: 0.4807 - accuracy: 0.4601
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3551 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.3636 - accuracy: 0.4848 6/11 [===============>..............] - ETA: 0s - loss: 0.3660 - accuracy: 0.4793 9/11 [=======================>......] - ETA: 0s - loss: 0.3697 - accuracy: 0.472111/11 [==============================] - 0s 25ms/step - loss: 0.3698 - accuracy: 0.4700
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3672 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.3660 - accuracy: 0.4484 6/11 [===============>..............] - ETA: 0s - loss: 0.3617 - accuracy: 0.4532 8/11 [====================>.........] - ETA: 0s - loss: 0.3586 - accuracy: 0.455211/11 [==============================] - ETA: 0s - loss: 0.3544 - accuracy: 0.456311/11 [==============================] - 0s 25ms/step - loss: 0.3532 - accuracy: 0.4569
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3362 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.3305 - accuracy: 0.4391 6/11 [===============>..............] - ETA: 0s - loss: 0.3291 - accuracy: 0.4450 8/11 [====================>.........] - ETA: 0s - loss: 0.3287 - accuracy: 0.447011/11 [==============================] - ETA: 0s - loss: 0.3269 - accuracy: 0.451011/11 [==============================] - 0s 25ms/step - loss: 0.3265 - accuracy: 0.4520
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3243 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.3173 - accuracy: 0.4557 6/11 [===============>..............] - ETA: 0s - loss: 0.3134 - accuracy: 0.4600 9/11 [=======================>......] - ETA: 0s - loss: 0.3105 - accuracy: 0.461611/11 [==============================] - ETA: 0s - loss: 0.3088 - accuracy: 0.462711/11 [==============================] - 0s 26ms/step - loss: 0.3083 - accuracy: 0.4630
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2898 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.2972 - accuracy: 0.4449 5/11 [============>.................] - ETA: 0s - loss: 0.2952 - accuracy: 0.4521 7/11 [==================>...........] - ETA: 0s - loss: 0.2922 - accuracy: 0.458010/11 [==========================>...] - ETA: 0s - loss: 0.2896 - accuracy: 0.460111/11 [==============================] - 0s 25ms/step - loss: 0.2881 - accuracy: 0.4618
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2630 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.2615 - accuracy: 0.5190 6/11 [===============>..............] - ETA: 0s - loss: 0.2594 - accuracy: 0.5172 9/11 [=======================>......] - ETA: 0s - loss: 0.2578 - accuracy: 0.514111/11 [==============================] - 0s 25ms/step - loss: 0.2574 - accuracy: 0.5094
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2356 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.2323 - accuracy: 0.4926 5/11 [============>.................] - ETA: 0s - loss: 0.2341 - accuracy: 0.5049 7/11 [==================>...........] - ETA: 0s - loss: 0.2343 - accuracy: 0.5116 9/11 [=======================>......] - ETA: 0s - loss: 0.2338 - accuracy: 0.518711/11 [==============================] - ETA: 0s - loss: 0.2337 - accuracy: 0.524111/11 [==============================] - 0s 27ms/step - loss: 0.2337 - accuracy: 0.5260
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2032 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.2086 - accuracy: 0.5794 6/11 [===============>..............] - ETA: 0s - loss: 0.2099 - accuracy: 0.5906 9/11 [=======================>......] - ETA: 0s - loss: 0.2120 - accuracy: 0.590711/11 [==============================] - 0s 24ms/step - loss: 0.2129 - accuracy: 0.5917
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2043 - accuracy: 0.6328 3/11 [=======>......................] - ETA: 0s - loss: 0.2048 - accuracy: 0.6415 5/11 [============>.................] - ETA: 0s - loss: 0.2042 - accuracy: 0.6355 8/11 [====================>.........] - ETA: 0s - loss: 0.2038 - accuracy: 0.629510/11 [==========================>...] - ETA: 0s - loss: 0.2037 - accuracy: 0.626311/11 [==============================] - 0s 25ms/step - loss: 0.2034 - accuracy: 0.6239
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1943 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.1975 - accuracy: 0.6254 6/11 [===============>..............] - ETA: 0s - loss: 0.1967 - accuracy: 0.6209 8/11 [====================>.........] - ETA: 0s - loss: 0.1962 - accuracy: 0.618611/11 [==============================] - ETA: 0s - loss: 0.1949 - accuracy: 0.618911/11 [==============================] - 0s 26ms/step - loss: 0.1945 - accuracy: 0.6192
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1935 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.1882 - accuracy: 0.6380 6/11 [===============>..............] - ETA: 0s - loss: 0.1855 - accuracy: 0.6296 8/11 [====================>.........] - ETA: 0s - loss: 0.1844 - accuracy: 0.627810/11 [==========================>...] - ETA: 0s - loss: 0.1831 - accuracy: 0.628611/11 [==============================] - 0s 26ms/step - loss: 0.1826 - accuracy: 0.6293
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1523 - accuracy: 0.6719 4/11 [=========>....................] - ETA: 0s - loss: 0.1590 - accuracy: 0.6421 7/11 [==================>...........] - ETA: 0s - loss: 0.1633 - accuracy: 0.639810/11 [==========================>...] - ETA: 0s - loss: 0.1654 - accuracy: 0.640611/11 [==============================] - 0s 24ms/step - loss: 0.1662 - accuracy: 0.6418
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1658 - accuracy: 0.6172 3/11 [=======>......................] - ETA: 0s - loss: 0.1644 - accuracy: 0.6332 6/11 [===============>..............] - ETA: 0s - loss: 0.1658 - accuracy: 0.6408 9/11 [=======================>......] - ETA: 0s - loss: 0.1652 - accuracy: 0.646811/11 [==============================] - ETA: 0s - loss: 0.1644 - accuracy: 0.650311/11 [==============================] - 0s 26ms/step - loss: 0.1642 - accuracy: 0.6514
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1544 - accuracy: 0.6641 3/11 [=======>......................] - ETA: 0s - loss: 0.1482 - accuracy: 0.6984 6/11 [===============>..............] - ETA: 0s - loss: 0.1482 - accuracy: 0.6980 8/11 [====================>.........] - ETA: 0s - loss: 0.1489 - accuracy: 0.698710/11 [==========================>...] - ETA: 0s - loss: 0.1498 - accuracy: 0.698811/11 [==============================] - 0s 26ms/step - loss: 0.1502 - accuracy: 0.6995
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1426 - accuracy: 0.6797 4/11 [=========>....................] - ETA: 0s - loss: 0.1379 - accuracy: 0.7116 7/11 [==================>...........] - ETA: 0s - loss: 0.1396 - accuracy: 0.7198 9/11 [=======================>......] - ETA: 0s - loss: 0.1403 - accuracy: 0.721711/11 [==============================] - 0s 25ms/step - loss: 0.1413 - accuracy: 0.7230
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1274 - accuracy: 0.7656 3/11 [=======>......................] - ETA: 0s - loss: 0.1344 - accuracy: 0.7817 5/11 [============>.................] - ETA: 0s - loss: 0.1374 - accuracy: 0.7799 7/11 [==================>...........] - ETA: 0s - loss: 0.1386 - accuracy: 0.7774 9/11 [=======================>......] - ETA: 0s - loss: 0.1384 - accuracy: 0.772611/11 [==============================] - 0s 26ms/step - loss: 0.1377 - accuracy: 0.7667
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1301 - accuracy: 0.7344 4/11 [=========>....................] - ETA: 0s - loss: 0.1304 - accuracy: 0.7581 6/11 [===============>..............] - ETA: 0s - loss: 0.1304 - accuracy: 0.7664 8/11 [====================>.........] - ETA: 0s - loss: 0.1298 - accuracy: 0.775410/11 [==========================>...] - ETA: 0s - loss: 0.1295 - accuracy: 0.779311/11 [==============================] - 0s 26ms/step - loss: 0.1292 - accuracy: 0.7801
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1405 - accuracy: 0.70316/6 [==============================] - 5s 9ms/step - loss: 0.1444 - accuracy: 0.6941
2021-12-13 23:36:52.576848: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:36:52.577921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:36:52.577984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:36:52.578028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:36:52.578057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:36:52.578088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:36:52.578120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:36:52.578157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:36:52.578190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:36:52.578223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:36:52.578959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:36:52.579002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:36:52.579015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:36:52.579024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:36:52.579772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:36:52.580102: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:36:52.580470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:36:52.580499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:36:52.580526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:36:52.580554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:36:52.580581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:36:52.580607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:36:52.580634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:36:52.580662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:36:52.580689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:36:52.581369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:36:52.581397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:36:52.581408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:36:52.581417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:36:52.582131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 2 0 1] pred: [0.04352225 0.00148549 0.06210295 0.85957897 0.65963924]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [0.00974035 0.6688454  0.8171844  0.00323327 0.00301391]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 4 0] pred: [3.5654788e-04 1.2407350e-01 9.6421909e-01 2.1383446e-03 3.8328065e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [1.9167953e-04 5.8300849e-02 9.6930212e-01 1.3926452e-03 2.2290953e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [1.9331765e-04 9.1412947e-02 9.7826242e-01 1.2019353e-03 1.9531477e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [0.0154221  0.8279212  0.8823252  0.00431893 0.00635086]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 4 3] pred: [0.13354613 0.64747816 0.32215008 0.00158915 0.00254634]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [2.3787601e-04 5.6317043e-02 9.6055812e-01 1.7815001e-03 2.8747585e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [2.43985167e-04 1.14834316e-01 9.71537471e-01 1.24074228e-03
 2.42562179e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [1.5683498e-04 1.2214654e-01 9.8447996e-01 8.9964649e-04 1.3762091e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [0.00701712 0.78432584 0.90729547 0.00289472 0.0024441 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [3.1494320e-04 3.5317685e-02 9.5103961e-01 2.9417509e-03 3.8883710e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [2.3235539e-04 4.7778938e-02 9.6483821e-01 2.0125341e-03 2.7050084e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [0.00253189 0.6201088  0.9317663  0.00248652 0.0015849 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [0.00239146 0.4701006  0.8795503  0.00149625 0.00109749]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:29 - loss: 0.6874 - accuracy: 0.3672 3/11 [=======>......................] - ETA: 0s - loss: 0.6845 - accuracy: 0.3924   6/11 [===============>..............] - ETA: 0s - loss: 0.6800 - accuracy: 0.4139 8/11 [====================>.........] - ETA: 0s - loss: 0.6770 - accuracy: 0.424311/11 [==============================] - ETA: 0s - loss: 0.6726 - accuracy: 0.433911/11 [==============================] - 15s 23ms/step - loss: 0.6714 - accuracy: 0.4359
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6198 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.6152 - accuracy: 0.4301 5/11 [============>.................] - ETA: 0s - loss: 0.6108 - accuracy: 0.4366 8/11 [====================>.........] - ETA: 0s - loss: 0.6040 - accuracy: 0.444411/11 [==============================] - ETA: 0s - loss: 0.5966 - accuracy: 0.449911/11 [==============================] - 0s 24ms/step - loss: 0.5947 - accuracy: 0.4512
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4934 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.4956 - accuracy: 0.4839 6/11 [===============>..............] - ETA: 0s - loss: 0.4905 - accuracy: 0.4757 9/11 [=======================>......] - ETA: 0s - loss: 0.4836 - accuracy: 0.471011/11 [==============================] - 0s 24ms/step - loss: 0.4761 - accuracy: 0.4695
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4045 - accuracy: 0.3984 4/11 [=========>....................] - ETA: 0s - loss: 0.3961 - accuracy: 0.4194 7/11 [==================>...........] - ETA: 0s - loss: 0.3882 - accuracy: 0.436010/11 [==========================>...] - ETA: 0s - loss: 0.3841 - accuracy: 0.444711/11 [==============================] - 0s 24ms/step - loss: 0.3815 - accuracy: 0.4482
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3347 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.3376 - accuracy: 0.4757 6/11 [===============>..............] - ETA: 0s - loss: 0.3460 - accuracy: 0.4622 8/11 [====================>.........] - ETA: 0s - loss: 0.3463 - accuracy: 0.460911/11 [==============================] - ETA: 0s - loss: 0.3457 - accuracy: 0.462511/11 [==============================] - 0s 24ms/step - loss: 0.3457 - accuracy: 0.4627
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3599 - accuracy: 0.3906 3/11 [=======>......................] - ETA: 0s - loss: 0.3498 - accuracy: 0.4223 6/11 [===============>..............] - ETA: 0s - loss: 0.3428 - accuracy: 0.4433 9/11 [=======================>......] - ETA: 0s - loss: 0.3394 - accuracy: 0.451811/11 [==============================] - 0s 24ms/step - loss: 0.3366 - accuracy: 0.4549
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3227 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.3197 - accuracy: 0.4481 6/11 [===============>..............] - ETA: 0s - loss: 0.3170 - accuracy: 0.4518 9/11 [=======================>......] - ETA: 0s - loss: 0.3152 - accuracy: 0.453811/11 [==============================] - ETA: 0s - loss: 0.3138 - accuracy: 0.455811/11 [==============================] - 0s 24ms/step - loss: 0.3131 - accuracy: 0.4569
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2988 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.2957 - accuracy: 0.4323 7/11 [==================>...........] - ETA: 0s - loss: 0.2918 - accuracy: 0.4435 9/11 [=======================>......] - ETA: 0s - loss: 0.2900 - accuracy: 0.450611/11 [==============================] - 0s 24ms/step - loss: 0.2883 - accuracy: 0.4575
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2415 - accuracy: 0.6172 4/11 [=========>....................] - ETA: 0s - loss: 0.2600 - accuracy: 0.5309 6/11 [===============>..............] - ETA: 0s - loss: 0.2622 - accuracy: 0.5210 8/11 [====================>.........] - ETA: 0s - loss: 0.2626 - accuracy: 0.515811/11 [==============================] - ETA: 0s - loss: 0.2620 - accuracy: 0.512111/11 [==============================] - 0s 24ms/step - loss: 0.2617 - accuracy: 0.5115
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2520 - accuracy: 0.5312 4/11 [=========>....................] - ETA: 0s - loss: 0.2458 - accuracy: 0.5446 7/11 [==================>...........] - ETA: 0s - loss: 0.2424 - accuracy: 0.551610/11 [==========================>...] - ETA: 0s - loss: 0.2404 - accuracy: 0.550311/11 [==============================] - 0s 25ms/step - loss: 0.2396 - accuracy: 0.5505
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2318 - accuracy: 0.6172 4/11 [=========>....................] - ETA: 0s - loss: 0.2291 - accuracy: 0.6270 6/11 [===============>..............] - ETA: 0s - loss: 0.2280 - accuracy: 0.6182 8/11 [====================>.........] - ETA: 0s - loss: 0.2260 - accuracy: 0.616211/11 [==============================] - ETA: 0s - loss: 0.2236 - accuracy: 0.615711/11 [==============================] - 0s 25ms/step - loss: 0.2229 - accuracy: 0.6160
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2126 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.2127 - accuracy: 0.5690 6/11 [===============>..............] - ETA: 0s - loss: 0.2076 - accuracy: 0.5898 8/11 [====================>.........] - ETA: 0s - loss: 0.2061 - accuracy: 0.599211/11 [==============================] - ETA: 0s - loss: 0.2036 - accuracy: 0.607811/11 [==============================] - 0s 24ms/step - loss: 0.2030 - accuracy: 0.6097
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2026 - accuracy: 0.6172 4/11 [=========>....................] - ETA: 0s - loss: 0.1951 - accuracy: 0.6411 7/11 [==================>...........] - ETA: 0s - loss: 0.1916 - accuracy: 0.647510/11 [==========================>...] - ETA: 0s - loss: 0.1887 - accuracy: 0.647811/11 [==============================] - 0s 24ms/step - loss: 0.1873 - accuracy: 0.6462
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1651 - accuracy: 0.6328 4/11 [=========>....................] - ETA: 0s - loss: 0.1655 - accuracy: 0.5941 6/11 [===============>..............] - ETA: 0s - loss: 0.1652 - accuracy: 0.6087 8/11 [====================>.........] - ETA: 0s - loss: 0.1657 - accuracy: 0.619410/11 [==========================>...] - ETA: 0s - loss: 0.1660 - accuracy: 0.625811/11 [==============================] - 0s 25ms/step - loss: 0.1660 - accuracy: 0.6302
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1557 - accuracy: 0.6406 4/11 [=========>....................] - ETA: 0s - loss: 0.1505 - accuracy: 0.6471 7/11 [==================>...........] - ETA: 0s - loss: 0.1535 - accuracy: 0.6520 9/11 [=======================>......] - ETA: 0s - loss: 0.1545 - accuracy: 0.654611/11 [==============================] - 0s 24ms/step - loss: 0.1547 - accuracy: 0.6561
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1449 - accuracy: 0.6719 4/11 [=========>....................] - ETA: 0s - loss: 0.1408 - accuracy: 0.6592 7/11 [==================>...........] - ETA: 0s - loss: 0.1415 - accuracy: 0.660510/11 [==========================>...] - ETA: 0s - loss: 0.1430 - accuracy: 0.664011/11 [==============================] - 0s 23ms/step - loss: 0.1435 - accuracy: 0.6659
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1535 - accuracy: 0.7500 4/11 [=========>....................] - ETA: 0s - loss: 0.1452 - accuracy: 0.7300 7/11 [==================>...........] - ETA: 0s - loss: 0.1428 - accuracy: 0.717010/11 [==========================>...] - ETA: 0s - loss: 0.1414 - accuracy: 0.708511/11 [==============================] - 0s 23ms/step - loss: 0.1408 - accuracy: 0.7053
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1243 - accuracy: 0.6562 4/11 [=========>....................] - ETA: 0s - loss: 0.1252 - accuracy: 0.6808 6/11 [===============>..............] - ETA: 0s - loss: 0.1261 - accuracy: 0.6917 9/11 [=======================>......] - ETA: 0s - loss: 0.1275 - accuracy: 0.703211/11 [==============================] - ETA: 0s - loss: 0.1281 - accuracy: 0.707911/11 [==============================] - 0s 24ms/step - loss: 0.1284 - accuracy: 0.7095
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1329 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.1308 - accuracy: 0.7214 7/11 [==================>...........] - ETA: 0s - loss: 0.1296 - accuracy: 0.7107 9/11 [=======================>......] - ETA: 0s - loss: 0.1290 - accuracy: 0.706111/11 [==============================] - ETA: 0s - loss: 0.1285 - accuracy: 0.703611/11 [==============================] - 0s 24ms/step - loss: 0.1283 - accuracy: 0.7029
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1109 - accuracy: 0.7969 4/11 [=========>....................] - ETA: 0s - loss: 0.1149 - accuracy: 0.8193 7/11 [==================>...........] - ETA: 0s - loss: 0.1172 - accuracy: 0.826910/11 [==========================>...] - ETA: 0s - loss: 0.1179 - accuracy: 0.827911/11 [==============================] - 0s 24ms/step - loss: 0.1182 - accuracy: 0.8262
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1083 - accuracy: 0.74226/6 [==============================] - 5s 10ms/step - loss: 0.1159 - accuracy: 0.7323
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [3.4618206e-05 2.4297887e-02 9.7811836e-01 4.6144212e-03 9.0741907e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [3 2 4 0 1] pred: [0.00912405 0.00207644 0.13729815 0.78154296 0.09224944]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [0.00725719 0.80091536 0.84543455 0.00166292 0.00117735]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [3 2 4 0 1] pred: [0.00951602 0.00185899 0.12950517 0.7886901  0.1080645 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [0 3 1 4 2] pred: [0.96788514 0.32159522 0.00532081 0.40535846 0.19771431]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [3 2 4 0 1] pred: [0.00975396 0.00177334 0.12166718 0.8107307  0.11711322]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [3.8722537e-05 2.5482658e-02 9.7659475e-01 4.4036740e-03 9.1109943e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [2.6976864e-05 2.2595588e-02 9.8520362e-01 3.5684840e-03 8.2235306e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 0 1] pred: [0.01032797 0.00237998 0.13283625 0.753077   0.10290781]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 4 0 1] pred: [0.00630595 0.00256737 0.22943194 0.7015888  0.08151658]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [3.0622923e-05 2.3681330e-02 9.8202938e-01 4.1031083e-03 8.8155322e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [0 3 1 4 2] pred: [0.9623439  0.32906514 0.00727532 0.3723189  0.19617668]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [0.00484978 0.7607413  0.88761276 0.00230105 0.00115638]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 2 0 1] pred: [0.01073066 0.00238771 0.05536502 0.613894   0.54504097]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [0.00895954 0.7824085  0.8458955  0.00195794 0.00167115]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Job end at lun déc 13 23:37:30 CET 2021
