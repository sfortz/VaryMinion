
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at lun déc 13 23:35:44 CET 2021
2021-12-13 23:35:45.499703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-13 23:35:50.532465: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:35:50.534127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-13 23:35:50.545302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:35:50.545333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:35:50.548434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:35:50.548478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:35:50.550886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:35:50.551554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:35:50.554666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:35:50.556189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:35:50.561483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:35:50.562762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:35:50.597011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:35:50.597051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:35:50.597062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:35:52.202279: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:35:52.203797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:35:52.203845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:35:52.203953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:35:52.203997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:35:52.204069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:35:52.204112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:35:52.204184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:35:52.204236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:35:52.204312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:35:52.205494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:35:52.206294: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:35:52.206323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:35:52.206333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2021-12-13 23:35:52.206434: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-13 23:35:55.163353: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-13 23:35:55.163982: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2593570000 Hz
Number of possible configurations: 40
Begining exécution of the 28 th configuration: BPIC20.csv with GRU model, 20 epochs, 30 units, 128 batch_size, sigmoid as activation function and mse as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 90, 58)            3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                16200     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:56 - loss: 0.2488 - accuracy: 0.3047 2/11 [====>.........................] - ETA: 0s - loss: 0.2482 - accuracy: 0.3105   3/11 [=======>......................] - ETA: 0s - loss: 0.2476 - accuracy: 0.3112 4/11 [=========>....................] - ETA: 0s - loss: 0.2469 - accuracy: 0.3188 5/11 [============>.................] - ETA: 0s - loss: 0.2462 - accuracy: 0.3254 6/11 [===============>..............] - ETA: 0s - loss: 0.2455 - accuracy: 0.3326 7/11 [==================>...........] - ETA: 0s - loss: 0.2448 - accuracy: 0.3401 8/11 [====================>.........] - ETA: 0s - loss: 0.2442 - accuracy: 0.3465 9/11 [=======================>......] - ETA: 0s - loss: 0.2435 - accuracy: 0.352910/11 [==========================>...] - ETA: 0s - loss: 0.2428 - accuracy: 0.358211/11 [==============================] - ETA: 0s - loss: 0.2422 - accuracy: 0.362711/11 [==============================] - 13s 99ms/step - loss: 0.2417 - accuracy: 0.3665
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2173 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.2163 - accuracy: 0.5098 3/11 [=======>......................] - ETA: 0s - loss: 0.2156 - accuracy: 0.5056 4/11 [=========>....................] - ETA: 0s - loss: 0.2147 - accuracy: 0.4984 5/11 [============>.................] - ETA: 0s - loss: 0.2140 - accuracy: 0.4896 6/11 [===============>..............] - ETA: 0s - loss: 0.2132 - accuracy: 0.4846 7/11 [==================>...........] - ETA: 0s - loss: 0.2124 - accuracy: 0.4805 8/11 [====================>.........] - ETA: 0s - loss: 0.2115 - accuracy: 0.4775 9/11 [=======================>......] - ETA: 0s - loss: 0.2106 - accuracy: 0.475010/11 [==========================>...] - ETA: 0s - loss: 0.2097 - accuracy: 0.472811/11 [==============================] - ETA: 0s - loss: 0.2088 - accuracy: 0.471011/11 [==============================] - 1s 105ms/step - loss: 0.2081 - accuracy: 0.4696
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1729 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.1711 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.1694 - accuracy: 0.5286 4/11 [=========>....................] - ETA: 0s - loss: 0.1682 - accuracy: 0.5234 5/11 [============>.................] - ETA: 0s - loss: 0.1671 - accuracy: 0.5166 6/11 [===============>..............] - ETA: 0s - loss: 0.1661 - accuracy: 0.5092 7/11 [==================>...........] - ETA: 0s - loss: 0.1651 - accuracy: 0.5033 8/11 [====================>.........] - ETA: 0s - loss: 0.1641 - accuracy: 0.4984 9/11 [=======================>......] - ETA: 0s - loss: 0.1631 - accuracy: 0.494110/11 [==========================>...] - ETA: 0s - loss: 0.1622 - accuracy: 0.490211/11 [==============================] - ETA: 0s - loss: 0.1613 - accuracy: 0.486711/11 [==============================] - 1s 102ms/step - loss: 0.1606 - accuracy: 0.4838
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1302 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.1268 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.1260 - accuracy: 0.4661 4/11 [=========>....................] - ETA: 0s - loss: 0.1250 - accuracy: 0.4678 5/11 [============>.................] - ETA: 0s - loss: 0.1241 - accuracy: 0.4686 6/11 [===============>..............] - ETA: 0s - loss: 0.1233 - accuracy: 0.4675 7/11 [==================>...........] - ETA: 0s - loss: 0.1228 - accuracy: 0.4661 8/11 [====================>.........] - ETA: 0s - loss: 0.1223 - accuracy: 0.4655 9/11 [=======================>......] - ETA: 0s - loss: 0.1220 - accuracy: 0.464310/11 [==========================>...] - ETA: 0s - loss: 0.1218 - accuracy: 0.462911/11 [==============================] - ETA: 0s - loss: 0.1216 - accuracy: 0.461911/11 [==============================] - 1s 102ms/step - loss: 0.1215 - accuracy: 0.4610
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1170 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.1111 - accuracy: 0.5137 3/11 [=======>......................] - ETA: 0s - loss: 0.1112 - accuracy: 0.5056 4/11 [=========>....................] - ETA: 0s - loss: 0.1117 - accuracy: 0.4954 5/11 [============>.................] - ETA: 0s - loss: 0.1119 - accuracy: 0.4882 6/11 [===============>..............] - ETA: 0s - loss: 0.1118 - accuracy: 0.4848 7/11 [==================>...........] - ETA: 0s - loss: 0.1118 - accuracy: 0.4818 8/11 [====================>.........] - ETA: 0s - loss: 0.1122 - accuracy: 0.4797 9/11 [=======================>......] - ETA: 0s - loss: 0.1125 - accuracy: 0.477110/11 [==========================>...] - ETA: 0s - loss: 0.1129 - accuracy: 0.474711/11 [==============================] - ETA: 0s - loss: 0.1131 - accuracy: 0.472611/11 [==============================] - 1s 100ms/step - loss: 0.1133 - accuracy: 0.4708
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1189 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.1203 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.1199 - accuracy: 0.4097 4/11 [=========>....................] - ETA: 0s - loss: 0.1188 - accuracy: 0.4172 5/11 [============>.................] - ETA: 0s - loss: 0.1183 - accuracy: 0.4206 6/11 [===============>..............] - ETA: 0s - loss: 0.1178 - accuracy: 0.4236 7/11 [==================>...........] - ETA: 0s - loss: 0.1174 - accuracy: 0.4259 8/11 [====================>.........] - ETA: 0s - loss: 0.1169 - accuracy: 0.4282 9/11 [=======================>......] - ETA: 0s - loss: 0.1165 - accuracy: 0.430210/11 [==========================>...] - ETA: 0s - loss: 0.1161 - accuracy: 0.432311/11 [==============================] - ETA: 0s - loss: 0.1157 - accuracy: 0.434111/11 [==============================] - 1s 98ms/step - loss: 0.1154 - accuracy: 0.4355
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1104 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.1094 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 0s - loss: 0.1089 - accuracy: 0.4418 4/11 [=========>....................] - ETA: 0s - loss: 0.1084 - accuracy: 0.4451 5/11 [============>.................] - ETA: 0s - loss: 0.1082 - accuracy: 0.4489 6/11 [===============>..............] - ETA: 0s - loss: 0.1079 - accuracy: 0.4516 7/11 [==================>...........] - ETA: 0s - loss: 0.1078 - accuracy: 0.4531 8/11 [====================>.........] - ETA: 0s - loss: 0.1076 - accuracy: 0.4544 9/11 [=======================>......] - ETA: 0s - loss: 0.1074 - accuracy: 0.455210/11 [==========================>...] - ETA: 0s - loss: 0.1074 - accuracy: 0.454911/11 [==============================] - ETA: 0s - loss: 0.1073 - accuracy: 0.454911/11 [==============================] - 1s 98ms/step - loss: 0.1073 - accuracy: 0.4550
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0976 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.0998 - accuracy: 0.4883 3/11 [=======>......................] - ETA: 0s - loss: 0.1004 - accuracy: 0.4818 4/11 [=========>....................] - ETA: 0s - loss: 0.1007 - accuracy: 0.4780 5/11 [============>.................] - ETA: 0s - loss: 0.1007 - accuracy: 0.4777 6/11 [===============>..............] - ETA: 0s - loss: 0.1006 - accuracy: 0.4765 7/11 [==================>...........] - ETA: 0s - loss: 0.1003 - accuracy: 0.4769 8/11 [====================>.........] - ETA: 0s - loss: 0.1002 - accuracy: 0.4769 9/11 [=======================>......] - ETA: 0s - loss: 0.1000 - accuracy: 0.476910/11 [==========================>...] - ETA: 0s - loss: 0.0999 - accuracy: 0.476111/11 [==============================] - ETA: 0s - loss: 0.0999 - accuracy: 0.475211/11 [==============================] - 1s 98ms/step - loss: 0.0999 - accuracy: 0.4744
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0972 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.0953 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.0944 - accuracy: 0.4540 4/11 [=========>....................] - ETA: 0s - loss: 0.0939 - accuracy: 0.4582 5/11 [============>.................] - ETA: 0s - loss: 0.0933 - accuracy: 0.4634 6/11 [===============>..............] - ETA: 0s - loss: 0.0925 - accuracy: 0.4676 7/11 [==================>...........] - ETA: 0s - loss: 0.0921 - accuracy: 0.4692 8/11 [====================>.........] - ETA: 0s - loss: 0.0920 - accuracy: 0.4705 9/11 [=======================>......] - ETA: 0s - loss: 0.0918 - accuracy: 0.471910/11 [==========================>...] - ETA: 0s - loss: 0.0917 - accuracy: 0.473511/11 [==============================] - ETA: 0s - loss: 0.0916 - accuracy: 0.475511/11 [==============================] - 1s 103ms/step - loss: 0.0915 - accuracy: 0.4772
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0799 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.0813 - accuracy: 0.5664 3/11 [=======>......................] - ETA: 0s - loss: 0.0818 - accuracy: 0.5547 4/11 [=========>....................] - ETA: 0s - loss: 0.0824 - accuracy: 0.5518 5/11 [============>.................] - ETA: 0s - loss: 0.0822 - accuracy: 0.5520 6/11 [===============>..............] - ETA: 0s - loss: 0.0821 - accuracy: 0.5499 7/11 [==================>...........] - ETA: 0s - loss: 0.0818 - accuracy: 0.5488 8/11 [====================>.........] - ETA: 0s - loss: 0.0815 - accuracy: 0.5488 9/11 [=======================>......] - ETA: 0s - loss: 0.0811 - accuracy: 0.548810/11 [==========================>...] - ETA: 0s - loss: 0.0807 - accuracy: 0.549211/11 [==============================] - ETA: 0s - loss: 0.0804 - accuracy: 0.549111/11 [==============================] - 1s 97ms/step - loss: 0.0801 - accuracy: 0.5491
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0771 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 0s - loss: 0.0750 - accuracy: 0.5723 3/11 [=======>......................] - ETA: 0s - loss: 0.0748 - accuracy: 0.5907 4/11 [=========>....................] - ETA: 0s - loss: 0.0740 - accuracy: 0.5983 5/11 [============>.................] - ETA: 0s - loss: 0.0731 - accuracy: 0.6055 6/11 [===============>..............] - ETA: 0s - loss: 0.0721 - accuracy: 0.6122 7/11 [==================>...........] - ETA: 0s - loss: 0.0712 - accuracy: 0.6184 8/11 [====================>.........] - ETA: 0s - loss: 0.0706 - accuracy: 0.6230 9/11 [=======================>......] - ETA: 0s - loss: 0.0702 - accuracy: 0.626210/11 [==========================>...] - ETA: 0s - loss: 0.0698 - accuracy: 0.628211/11 [==============================] - ETA: 0s - loss: 0.0694 - accuracy: 0.629811/11 [==============================] - 1s 100ms/step - loss: 0.0691 - accuracy: 0.6311
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0671 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 0s - loss: 0.0638 - accuracy: 0.6816 3/11 [=======>......................] - ETA: 0s - loss: 0.0634 - accuracy: 0.6914 4/11 [=========>....................] - ETA: 0s - loss: 0.0634 - accuracy: 0.6982 5/11 [============>.................] - ETA: 0s - loss: 0.0631 - accuracy: 0.7014 6/11 [===============>..............] - ETA: 0s - loss: 0.0625 - accuracy: 0.7065 7/11 [==================>...........] - ETA: 0s - loss: 0.0621 - accuracy: 0.7103 8/11 [====================>.........] - ETA: 0s - loss: 0.0617 - accuracy: 0.7129 9/11 [=======================>......] - ETA: 0s - loss: 0.0614 - accuracy: 0.714410/11 [==========================>...] - ETA: 0s - loss: 0.0610 - accuracy: 0.715311/11 [==============================] - ETA: 0s - loss: 0.0607 - accuracy: 0.716611/11 [==============================] - 1s 105ms/step - loss: 0.0604 - accuracy: 0.7178
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0543 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 0s - loss: 0.0534 - accuracy: 0.7207 3/11 [=======>......................] - ETA: 0s - loss: 0.0535 - accuracy: 0.7305 4/11 [=========>....................] - ETA: 0s - loss: 0.0533 - accuracy: 0.7349 5/11 [============>.................] - ETA: 0s - loss: 0.0530 - accuracy: 0.7357 6/11 [===============>..............] - ETA: 0s - loss: 0.0528 - accuracy: 0.7377 7/11 [==================>...........] - ETA: 0s - loss: 0.0527 - accuracy: 0.7386 8/11 [====================>.........] - ETA: 0s - loss: 0.0527 - accuracy: 0.7394 9/11 [=======================>......] - ETA: 0s - loss: 0.0526 - accuracy: 0.740110/11 [==========================>...] - ETA: 0s - loss: 0.0525 - accuracy: 0.740111/11 [==============================] - ETA: 0s - loss: 0.0523 - accuracy: 0.740211/11 [==============================] - 1s 103ms/step - loss: 0.0522 - accuracy: 0.7403
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0446 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 0s - loss: 0.0447 - accuracy: 0.7617 3/11 [=======>......................] - ETA: 0s - loss: 0.0451 - accuracy: 0.7674 4/11 [=========>....................] - ETA: 0s - loss: 0.0457 - accuracy: 0.7679 5/11 [============>.................] - ETA: 0s - loss: 0.0461 - accuracy: 0.7687 6/11 [===============>..............] - ETA: 0s - loss: 0.0464 - accuracy: 0.7697 7/11 [==================>...........] - ETA: 0s - loss: 0.0466 - accuracy: 0.7710 8/11 [====================>.........] - ETA: 0s - loss: 0.0467 - accuracy: 0.7729 9/11 [=======================>......] - ETA: 0s - loss: 0.0467 - accuracy: 0.773810/11 [==========================>...] - ETA: 0s - loss: 0.0467 - accuracy: 0.774611/11 [==============================] - ETA: 0s - loss: 0.0467 - accuracy: 0.774511/11 [==============================] - 1s 107ms/step - loss: 0.0467 - accuracy: 0.7745
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0540 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 0s - loss: 0.0509 - accuracy: 0.6895 3/11 [=======>......................] - ETA: 0s - loss: 0.0495 - accuracy: 0.6914 4/11 [=========>....................] - ETA: 0s - loss: 0.0482 - accuracy: 0.6958 5/11 [============>.................] - ETA: 0s - loss: 0.0475 - accuracy: 0.6966 6/11 [===============>..............] - ETA: 0s - loss: 0.0469 - accuracy: 0.6977 7/11 [==================>...........] - ETA: 0s - loss: 0.0465 - accuracy: 0.6998 8/11 [====================>.........] - ETA: 0s - loss: 0.0461 - accuracy: 0.7029 9/11 [=======================>......] - ETA: 0s - loss: 0.0458 - accuracy: 0.705210/11 [==========================>...] - ETA: 0s - loss: 0.0456 - accuracy: 0.707611/11 [==============================] - ETA: 0s - loss: 0.0453 - accuracy: 0.710411/11 [==============================] - 1s 102ms/step - loss: 0.0451 - accuracy: 0.7127
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0392 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 1s - loss: 0.0400 - accuracy: 0.7656 3/11 [=======>......................] - ETA: 0s - loss: 0.0408 - accuracy: 0.7639 4/11 [=========>....................] - ETA: 0s - loss: 0.0410 - accuracy: 0.7619 5/11 [============>.................] - ETA: 0s - loss: 0.0412 - accuracy: 0.7595 6/11 [===============>..............] - ETA: 0s - loss: 0.0413 - accuracy: 0.7562 7/11 [==================>...........] - ETA: 0s - loss: 0.0414 - accuracy: 0.7526 8/11 [====================>.........] - ETA: 0s - loss: 0.0413 - accuracy: 0.7501 9/11 [=======================>......] - ETA: 0s - loss: 0.0413 - accuracy: 0.748310/11 [==========================>...] - ETA: 0s - loss: 0.0412 - accuracy: 0.747811/11 [==============================] - ETA: 0s - loss: 0.0411 - accuracy: 0.747911/11 [==============================] - 1s 102ms/step - loss: 0.0410 - accuracy: 0.7479
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0321 - accuracy: 0.8594 2/11 [====>.........................] - ETA: 0s - loss: 0.0342 - accuracy: 0.8594 3/11 [=======>......................] - ETA: 0s - loss: 0.0351 - accuracy: 0.8533 4/11 [=========>....................] - ETA: 0s - loss: 0.0354 - accuracy: 0.8455 5/11 [============>.................] - ETA: 0s - loss: 0.0358 - accuracy: 0.8364 6/11 [===============>..............] - ETA: 0s - loss: 0.0361 - accuracy: 0.8272 7/11 [==================>...........] - ETA: 0s - loss: 0.0365 - accuracy: 0.8188 8/11 [====================>.........] - ETA: 0s - loss: 0.0367 - accuracy: 0.8111 9/11 [=======================>......] - ETA: 0s - loss: 0.0370 - accuracy: 0.804710/11 [==========================>...] - ETA: 0s - loss: 0.0372 - accuracy: 0.799311/11 [==============================] - ETA: 0s - loss: 0.0373 - accuracy: 0.794811/11 [==============================] - 1s 102ms/step - loss: 0.0374 - accuracy: 0.7912
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0373 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 0s - loss: 0.0357 - accuracy: 0.8262 3/11 [=======>......................] - ETA: 0s - loss: 0.0351 - accuracy: 0.8303 4/11 [=========>....................] - ETA: 0s - loss: 0.0348 - accuracy: 0.8293 5/11 [============>.................] - ETA: 0s - loss: 0.0346 - accuracy: 0.8303 6/11 [===============>..............] - ETA: 0s - loss: 0.0346 - accuracy: 0.8317 7/11 [==================>...........] - ETA: 0s - loss: 0.0346 - accuracy: 0.8320 8/11 [====================>.........] - ETA: 0s - loss: 0.0346 - accuracy: 0.8307 9/11 [=======================>......] - ETA: 0s - loss: 0.0347 - accuracy: 0.829610/11 [==========================>...] - ETA: 0s - loss: 0.0348 - accuracy: 0.828111/11 [==============================] - ETA: 0s - loss: 0.0349 - accuracy: 0.826511/11 [==============================] - 1s 99ms/step - loss: 0.0349 - accuracy: 0.8251
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0365 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.0358 - accuracy: 0.7598 3/11 [=======>......................] - ETA: 0s - loss: 0.0350 - accuracy: 0.7713 4/11 [=========>....................] - ETA: 0s - loss: 0.0348 - accuracy: 0.7826 5/11 [============>.................] - ETA: 0s - loss: 0.0347 - accuracy: 0.7879 6/11 [===============>..............] - ETA: 0s - loss: 0.0346 - accuracy: 0.7898 7/11 [==================>...........] - ETA: 0s - loss: 0.0346 - accuracy: 0.7918 8/11 [====================>.........] - ETA: 0s - loss: 0.0345 - accuracy: 0.7941 9/11 [=======================>......] - ETA: 0s - loss: 0.0345 - accuracy: 0.796210/11 [==========================>...] - ETA: 0s - loss: 0.0344 - accuracy: 0.798111/11 [==============================] - ETA: 0s - loss: 0.0343 - accuracy: 0.799711/11 [==============================] - 1s 101ms/step - loss: 0.0342 - accuracy: 0.8011
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0342 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.0349 - accuracy: 0.8047 3/11 [=======>......................] - ETA: 0s - loss: 0.0349 - accuracy: 0.8056 4/11 [=========>....................] - ETA: 0s - loss: 0.0346 - accuracy: 0.8068 5/11 [============>.................] - ETA: 0s - loss: 0.0341 - accuracy: 0.8070 6/11 [===============>..............] - ETA: 0s - loss: 0.0338 - accuracy: 0.8090 7/11 [==================>...........] - ETA: 0s - loss: 0.0335 - accuracy: 0.8114 8/11 [====================>.........] - ETA: 0s - loss: 0.0332 - accuracy: 0.8138 9/11 [=======================>......] - ETA: 0s - loss: 0.0331 - accuracy: 0.814710/11 [==========================>...] - ETA: 0s - loss: 0.0330 - accuracy: 0.815211/11 [==============================] - ETA: 0s - loss: 0.0329 - accuracy: 0.815511/11 [==============================] - 1s 102ms/step - loss: 0.0328 - accuracy: 0.8159
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0306 - accuracy: 0.70313/6 [==============>...............] - ETA: 0s - loss: 0.0300 - accuracy: 0.7865 5/6 [========================>.....] - ETA: 0s - loss: 0.0293 - accuracy: 0.77816/6 [==============================] - 4s 31ms/step - loss: 0.0298 - accuracy: 0.7748
2021-12-13 23:36:37.275870: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:36:37.276921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:36:37.276982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:36:37.277037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:36:37.277076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:36:37.277123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:36:37.277167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:36:37.277210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:36:37.277259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:36:37.277303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:36:37.278800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:36:37.278847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:36:37.278861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:36:37.278872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 4 1 0] pred: [0.002267   0.02048254 0.9578986  0.03006342 0.02415887]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 4 3 1 0] pred: [0.00903705 0.01502496 0.76590765 0.03571451 0.45079336]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 4 1 0] pred: [0.00167885 0.01159438 0.960538   0.0552859  0.0259521 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [0.00343648 0.7281203  0.9306439  0.00358847 0.00201175]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 4 1 0] pred: [0.00168851 0.01194686 0.95927835 0.04902023 0.02792001]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 4 0] pred: [0.00294107 0.02469486 0.77193093 0.12922117 0.02007812]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 4 0] pred: [0.00148916 0.01504782 0.9596087  0.03615093 0.01374075]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 2 0 1] pred: [0.06127557 0.01393351 0.08383408 0.872392   0.16313353]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [0.00379279 0.7863507  0.8818181  0.00443342 0.00172594]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 4 0] pred: [0.00195396 0.02418974 0.9591152  0.02513251 0.01315737]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 4 0] pred: [0.00167325 0.01853156 0.9628885  0.0358718  0.01318717]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 4 1 0] pred: [0.0018172  0.01373869 0.9593759  0.04497883 0.02789822]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 4 1 0] pred: [0.00178942 0.01142755 0.96039546 0.05959892 0.02970627]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 3 0 4] pred: [0.04257995 0.7226637  0.38637775 0.06949258 0.00590712]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 4 1 0] pred: [0.00178829 0.01351568 0.95669997 0.04619256 0.0298683 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:00 - loss: 0.2492 - accuracy: 0.2344 2/11 [====>.........................] - ETA: 1s - loss: 0.2485 - accuracy: 0.2832   3/11 [=======>......................] - ETA: 0s - loss: 0.2479 - accuracy: 0.3207 4/11 [=========>....................] - ETA: 0s - loss: 0.2472 - accuracy: 0.3441 5/11 [============>.................] - ETA: 0s - loss: 0.2465 - accuracy: 0.3637 6/11 [===============>..............] - ETA: 0s - loss: 0.2458 - accuracy: 0.3758 7/11 [==================>...........] - ETA: 0s - loss: 0.2451 - accuracy: 0.3846 8/11 [====================>.........] - ETA: 0s - loss: 0.2445 - accuracy: 0.3911 9/11 [=======================>......] - ETA: 0s - loss: 0.2438 - accuracy: 0.397010/11 [==========================>...] - ETA: 0s - loss: 0.2431 - accuracy: 0.401911/11 [==============================] - ETA: 0s - loss: 0.2424 - accuracy: 0.405811/11 [==============================] - 13s 103ms/step - loss: 0.2419 - accuracy: 0.4090
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2172 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.2164 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 0s - loss: 0.2156 - accuracy: 0.4614 4/11 [=========>....................] - ETA: 0s - loss: 0.2147 - accuracy: 0.4574 5/11 [============>.................] - ETA: 0s - loss: 0.2138 - accuracy: 0.4556 6/11 [===============>..............] - ETA: 0s - loss: 0.2129 - accuracy: 0.4534 7/11 [==================>...........] - ETA: 0s - loss: 0.2120 - accuracy: 0.4520 8/11 [====================>.........] - ETA: 0s - loss: 0.2110 - accuracy: 0.4523 9/11 [=======================>......] - ETA: 0s - loss: 0.2100 - accuracy: 0.453110/11 [==========================>...] - ETA: 0s - loss: 0.2090 - accuracy: 0.453311/11 [==============================] - ETA: 0s - loss: 0.2080 - accuracy: 0.453111/11 [==============================] - 1s 100ms/step - loss: 0.2072 - accuracy: 0.4530
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1694 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.1674 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 0s - loss: 0.1669 - accuracy: 0.4570 4/11 [=========>....................] - ETA: 0s - loss: 0.1656 - accuracy: 0.4585 5/11 [============>.................] - ETA: 0s - loss: 0.1642 - accuracy: 0.4609 6/11 [===============>..............] - ETA: 0s - loss: 0.1629 - accuracy: 0.4624 7/11 [==================>...........] - ETA: 0s - loss: 0.1616 - accuracy: 0.4628 8/11 [====================>.........] - ETA: 0s - loss: 0.1605 - accuracy: 0.4626 9/11 [=======================>......] - ETA: 0s - loss: 0.1594 - accuracy: 0.462310/11 [==========================>...] - ETA: 0s - loss: 0.1583 - accuracy: 0.461511/11 [==============================] - ETA: 0s - loss: 0.1574 - accuracy: 0.460611/11 [==============================] - 1s 103ms/step - loss: 0.1566 - accuracy: 0.4598
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1273 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.1270 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.1261 - accuracy: 0.4340 4/11 [=========>....................] - ETA: 0s - loss: 0.1253 - accuracy: 0.4364 5/11 [============>.................] - ETA: 0s - loss: 0.1246 - accuracy: 0.4394 6/11 [===============>..............] - ETA: 0s - loss: 0.1238 - accuracy: 0.4413 7/11 [==================>...........] - ETA: 0s - loss: 0.1232 - accuracy: 0.4420 8/11 [====================>.........] - ETA: 0s - loss: 0.1227 - accuracy: 0.4427 9/11 [=======================>......] - ETA: 0s - loss: 0.1222 - accuracy: 0.443410/11 [==========================>...] - ETA: 0s - loss: 0.1217 - accuracy: 0.444111/11 [==============================] - ETA: 0s - loss: 0.1213 - accuracy: 0.444711/11 [==============================] - 1s 105ms/step - loss: 0.1209 - accuracy: 0.4452
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1143 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.1147 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.1145 - accuracy: 0.4601 4/11 [=========>....................] - ETA: 0s - loss: 0.1137 - accuracy: 0.4618 5/11 [============>.................] - ETA: 0s - loss: 0.1127 - accuracy: 0.4607 6/11 [===============>..............] - ETA: 0s - loss: 0.1123 - accuracy: 0.4583 7/11 [==================>...........] - ETA: 0s - loss: 0.1120 - accuracy: 0.4576 8/11 [====================>.........] - ETA: 0s - loss: 0.1116 - accuracy: 0.4577 9/11 [=======================>......] - ETA: 0s - loss: 0.1114 - accuracy: 0.457110/11 [==========================>...] - ETA: 0s - loss: 0.1113 - accuracy: 0.456311/11 [==============================] - ETA: 0s - loss: 0.1111 - accuracy: 0.455911/11 [==============================] - 1s 104ms/step - loss: 0.1110 - accuracy: 0.4555
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1006 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.0996 - accuracy: 0.5215 3/11 [=======>......................] - ETA: 0s - loss: 0.1006 - accuracy: 0.5091 4/11 [=========>....................] - ETA: 0s - loss: 0.1018 - accuracy: 0.4961 5/11 [============>.................] - ETA: 0s - loss: 0.1027 - accuracy: 0.4866 6/11 [===============>..............] - ETA: 0s - loss: 0.1033 - accuracy: 0.4801 7/11 [==================>...........] - ETA: 0s - loss: 0.1037 - accuracy: 0.4748 8/11 [====================>.........] - ETA: 0s - loss: 0.1039 - accuracy: 0.4700 9/11 [=======================>......] - ETA: 0s - loss: 0.1039 - accuracy: 0.467410/11 [==========================>...] - ETA: 0s - loss: 0.1038 - accuracy: 0.466011/11 [==============================] - ETA: 0s - loss: 0.1036 - accuracy: 0.464811/11 [==============================] - 1s 103ms/step - loss: 0.1035 - accuracy: 0.4638
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0994 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.0981 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 0s - loss: 0.0969 - accuracy: 0.4683 4/11 [=========>....................] - ETA: 0s - loss: 0.0960 - accuracy: 0.4679 5/11 [============>.................] - ETA: 0s - loss: 0.0954 - accuracy: 0.4690 6/11 [===============>..............] - ETA: 0s - loss: 0.0949 - accuracy: 0.4699 7/11 [==================>...........] - ETA: 0s - loss: 0.0948 - accuracy: 0.4692 8/11 [====================>.........] - ETA: 0s - loss: 0.0946 - accuracy: 0.4688 9/11 [=======================>......] - ETA: 0s - loss: 0.0943 - accuracy: 0.469110/11 [==========================>...] - ETA: 0s - loss: 0.0941 - accuracy: 0.468911/11 [==============================] - ETA: 0s - loss: 0.0939 - accuracy: 0.468311/11 [==============================] - 1s 102ms/step - loss: 0.0937 - accuracy: 0.4677
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0803 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.0806 - accuracy: 0.5176 3/11 [=======>......................] - ETA: 0s - loss: 0.0811 - accuracy: 0.5126 4/11 [=========>....................] - ETA: 0s - loss: 0.0811 - accuracy: 0.5099 5/11 [============>.................] - ETA: 0s - loss: 0.0811 - accuracy: 0.5083 6/11 [===============>..............] - ETA: 0s - loss: 0.0808 - accuracy: 0.5067 7/11 [==================>...........] - ETA: 0s - loss: 0.0807 - accuracy: 0.5049 8/11 [====================>.........] - ETA: 0s - loss: 0.0807 - accuracy: 0.5036 9/11 [=======================>......] - ETA: 0s - loss: 0.0806 - accuracy: 0.502710/11 [==========================>...] - ETA: 0s - loss: 0.0805 - accuracy: 0.502211/11 [==============================] - ETA: 0s - loss: 0.0803 - accuracy: 0.501811/11 [==============================] - 1s 103ms/step - loss: 0.0802 - accuracy: 0.5015
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0773 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.0765 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.0755 - accuracy: 0.4905 4/11 [=========>....................] - ETA: 0s - loss: 0.0744 - accuracy: 0.5011 5/11 [============>.................] - ETA: 0s - loss: 0.0737 - accuracy: 0.5093 6/11 [===============>..............] - ETA: 0s - loss: 0.0729 - accuracy: 0.5173 7/11 [==================>...........] - ETA: 0s - loss: 0.0722 - accuracy: 0.5233 8/11 [====================>.........] - ETA: 0s - loss: 0.0718 - accuracy: 0.5275 9/11 [=======================>......] - ETA: 0s - loss: 0.0715 - accuracy: 0.531810/11 [==========================>...] - ETA: 0s - loss: 0.0712 - accuracy: 0.535511/11 [==============================] - ETA: 0s - loss: 0.0709 - accuracy: 0.538711/11 [==============================] - 1s 106ms/step - loss: 0.0706 - accuracy: 0.5414
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0596 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.0611 - accuracy: 0.6016 3/11 [=======>......................] - ETA: 0s - loss: 0.0611 - accuracy: 0.5998 4/11 [=========>....................] - ETA: 0s - loss: 0.0607 - accuracy: 0.6017 5/11 [============>.................] - ETA: 0s - loss: 0.0604 - accuracy: 0.6020 6/11 [===============>..............] - ETA: 0s - loss: 0.0604 - accuracy: 0.6015 7/11 [==================>...........] - ETA: 0s - loss: 0.0604 - accuracy: 0.6021 8/11 [====================>.........] - ETA: 0s - loss: 0.0604 - accuracy: 0.6029 9/11 [=======================>......] - ETA: 0s - loss: 0.0603 - accuracy: 0.602810/11 [==========================>...] - ETA: 0s - loss: 0.0603 - accuracy: 0.602111/11 [==============================] - ETA: 0s - loss: 0.0603 - accuracy: 0.601111/11 [==============================] - 1s 99ms/step - loss: 0.0603 - accuracy: 0.6003
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0536 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.0557 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.0563 - accuracy: 0.6198 4/11 [=========>....................] - ETA: 0s - loss: 0.0567 - accuracy: 0.6152 5/11 [============>.................] - ETA: 0s - loss: 0.0567 - accuracy: 0.6131 6/11 [===============>..............] - ETA: 0s - loss: 0.0567 - accuracy: 0.6134 7/11 [==================>...........] - ETA: 0s - loss: 0.0566 - accuracy: 0.6141 8/11 [====================>.........] - ETA: 0s - loss: 0.0564 - accuracy: 0.6143 9/11 [=======================>......] - ETA: 0s - loss: 0.0562 - accuracy: 0.614210/11 [==========================>...] - ETA: 0s - loss: 0.0560 - accuracy: 0.614611/11 [==============================] - ETA: 0s - loss: 0.0558 - accuracy: 0.614411/11 [==============================] - 1s 100ms/step - loss: 0.0556 - accuracy: 0.6142
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0542 - accuracy: 0.6484 2/11 [====>.........................] - ETA: 0s - loss: 0.0546 - accuracy: 0.6230 3/11 [=======>......................] - ETA: 0s - loss: 0.0538 - accuracy: 0.6202 4/11 [=========>....................] - ETA: 0s - loss: 0.0531 - accuracy: 0.6204 5/11 [============>.................] - ETA: 0s - loss: 0.0527 - accuracy: 0.6229 6/11 [===============>..............] - ETA: 0s - loss: 0.0522 - accuracy: 0.6237 7/11 [==================>...........] - ETA: 0s - loss: 0.0517 - accuracy: 0.6244 8/11 [====================>.........] - ETA: 0s - loss: 0.0514 - accuracy: 0.6244 9/11 [=======================>......] - ETA: 0s - loss: 0.0512 - accuracy: 0.624710/11 [==========================>...] - ETA: 0s - loss: 0.0510 - accuracy: 0.625611/11 [==============================] - ETA: 0s - loss: 0.0507 - accuracy: 0.626211/11 [==============================] - 1s 104ms/step - loss: 0.0505 - accuracy: 0.6267
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0497 - accuracy: 0.7188 2/11 [====>.........................] - ETA: 0s - loss: 0.0486 - accuracy: 0.7070 3/11 [=======>......................] - ETA: 0s - loss: 0.0485 - accuracy: 0.6988 4/11 [=========>....................] - ETA: 0s - loss: 0.0479 - accuracy: 0.6955 5/11 [============>.................] - ETA: 0s - loss: 0.0474 - accuracy: 0.6923 6/11 [===============>..............] - ETA: 0s - loss: 0.0469 - accuracy: 0.6902 7/11 [==================>...........] - ETA: 0s - loss: 0.0465 - accuracy: 0.6887 8/11 [====================>.........] - ETA: 0s - loss: 0.0461 - accuracy: 0.6889 9/11 [=======================>......] - ETA: 0s - loss: 0.0458 - accuracy: 0.689610/11 [==========================>...] - ETA: 0s - loss: 0.0456 - accuracy: 0.690911/11 [==============================] - ETA: 0s - loss: 0.0454 - accuracy: 0.692211/11 [==============================] - 1s 104ms/step - loss: 0.0452 - accuracy: 0.6932
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0428 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.0430 - accuracy: 0.7266 3/11 [=======>......................] - ETA: 0s - loss: 0.0425 - accuracy: 0.7231 4/11 [=========>....................] - ETA: 0s - loss: 0.0421 - accuracy: 0.7196 5/11 [============>.................] - ETA: 0s - loss: 0.0420 - accuracy: 0.7166 6/11 [===============>..............] - ETA: 0s - loss: 0.0417 - accuracy: 0.7156 7/11 [==================>...........] - ETA: 0s - loss: 0.0417 - accuracy: 0.7140 8/11 [====================>.........] - ETA: 0s - loss: 0.0415 - accuracy: 0.7131 9/11 [=======================>......] - ETA: 0s - loss: 0.0414 - accuracy: 0.711710/11 [==========================>...] - ETA: 0s - loss: 0.0413 - accuracy: 0.710711/11 [==============================] - ETA: 0s - loss: 0.0412 - accuracy: 0.710011/11 [==============================] - 1s 105ms/step - loss: 0.0410 - accuracy: 0.7094
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0351 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 0s - loss: 0.0351 - accuracy: 0.7520 3/11 [=======>......................] - ETA: 0s - loss: 0.0352 - accuracy: 0.7444 4/11 [=========>....................] - ETA: 0s - loss: 0.0356 - accuracy: 0.7433 5/11 [============>.................] - ETA: 0s - loss: 0.0359 - accuracy: 0.7443 6/11 [===============>..............] - ETA: 0s - loss: 0.0359 - accuracy: 0.7455 7/11 [==================>...........] - ETA: 0s - loss: 0.0359 - accuracy: 0.7468 8/11 [====================>.........] - ETA: 0s - loss: 0.0360 - accuracy: 0.7479 9/11 [=======================>......] - ETA: 0s - loss: 0.0360 - accuracy: 0.749910/11 [==========================>...] - ETA: 0s - loss: 0.0361 - accuracy: 0.751211/11 [==============================] - ETA: 0s - loss: 0.0361 - accuracy: 0.752411/11 [==============================] - 1s 102ms/step - loss: 0.0362 - accuracy: 0.7533
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0340 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.0344 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.0348 - accuracy: 0.8212 4/11 [=========>....................] - ETA: 0s - loss: 0.0347 - accuracy: 0.8229 5/11 [============>.................] - ETA: 0s - loss: 0.0346 - accuracy: 0.8233 6/11 [===============>..............] - ETA: 0s - loss: 0.0348 - accuracy: 0.8241 7/11 [==================>...........] - ETA: 0s - loss: 0.0350 - accuracy: 0.8244 8/11 [====================>.........] - ETA: 0s - loss: 0.0351 - accuracy: 0.8240 9/11 [=======================>......] - ETA: 0s - loss: 0.0352 - accuracy: 0.823310/11 [==========================>...] - ETA: 0s - loss: 0.0351 - accuracy: 0.822011/11 [==============================] - ETA: 0s - loss: 0.0351 - accuracy: 0.821311/11 [==============================] - 1s 100ms/step - loss: 0.0351 - accuracy: 0.8207
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0333 - accuracy: 0.8047 2/11 [====>.........................] - ETA: 1s - loss: 0.0345 - accuracy: 0.8105 3/11 [=======>......................] - ETA: 0s - loss: 0.0346 - accuracy: 0.8112 4/11 [=========>....................] - ETA: 0s - loss: 0.0346 - accuracy: 0.8125 5/11 [============>.................] - ETA: 0s - loss: 0.0345 - accuracy: 0.8128 6/11 [===============>..............] - ETA: 0s - loss: 0.0344 - accuracy: 0.8143 7/11 [==================>...........] - ETA: 0s - loss: 0.0342 - accuracy: 0.8151 8/11 [====================>.........] - ETA: 0s - loss: 0.0341 - accuracy: 0.8155 9/11 [=======================>......] - ETA: 0s - loss: 0.0339 - accuracy: 0.816310/11 [==========================>...] - ETA: 0s - loss: 0.0339 - accuracy: 0.817011/11 [==============================] - ETA: 0s - loss: 0.0338 - accuracy: 0.817611/11 [==============================] - 1s 104ms/step - loss: 0.0337 - accuracy: 0.8181
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0328 - accuracy: 0.8906 2/11 [====>.........................] - ETA: 0s - loss: 0.0331 - accuracy: 0.8828 3/11 [=======>......................] - ETA: 0s - loss: 0.0330 - accuracy: 0.8845 4/11 [=========>....................] - ETA: 0s - loss: 0.0333 - accuracy: 0.8826 5/11 [============>.................] - ETA: 0s - loss: 0.0331 - accuracy: 0.8824 6/11 [===============>..............] - ETA: 0s - loss: 0.0328 - accuracy: 0.8822 7/11 [==================>...........] - ETA: 0s - loss: 0.0325 - accuracy: 0.8829 8/11 [====================>.........] - ETA: 0s - loss: 0.0322 - accuracy: 0.8832 9/11 [=======================>......] - ETA: 0s - loss: 0.0321 - accuracy: 0.882810/11 [==========================>...] - ETA: 0s - loss: 0.0320 - accuracy: 0.881911/11 [==============================] - ETA: 0s - loss: 0.0319 - accuracy: 0.880511/11 [==============================] - 1s 101ms/step - loss: 0.0319 - accuracy: 0.8793
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0348 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.0333 - accuracy: 0.8223 3/11 [=======>......................] - ETA: 0s - loss: 0.0330 - accuracy: 0.8312 4/11 [=========>....................] - ETA: 0s - loss: 0.0329 - accuracy: 0.8328 5/11 [============>.................] - ETA: 0s - loss: 0.0329 - accuracy: 0.8344 6/11 [===============>..............] - ETA: 0s - loss: 0.0327 - accuracy: 0.8364 7/11 [==================>...........] - ETA: 0s - loss: 0.0325 - accuracy: 0.8374 8/11 [====================>.........] - ETA: 0s - loss: 0.0323 - accuracy: 0.8384 9/11 [=======================>......] - ETA: 0s - loss: 0.0320 - accuracy: 0.839410/11 [==========================>...] - ETA: 0s - loss: 0.0318 - accuracy: 0.840511/11 [==============================] - ETA: 0s - loss: 0.0316 - accuracy: 0.841711/11 [==============================] - 1s 105ms/step - loss: 0.0314 - accuracy: 0.8427
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0211 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 0s - loss: 0.0235 - accuracy: 0.8691 3/11 [=======>......................] - ETA: 0s - loss: 0.0246 - accuracy: 0.8668 4/11 [=========>....................] - ETA: 0s - loss: 0.0254 - accuracy: 0.8639 5/11 [============>.................] - ETA: 0s - loss: 0.0260 - accuracy: 0.8627 6/11 [===============>..............] - ETA: 0s - loss: 0.0263 - accuracy: 0.8626 7/11 [==================>...........] - ETA: 0s - loss: 0.0266 - accuracy: 0.8624 8/11 [====================>.........] - ETA: 0s - loss: 0.0269 - accuracy: 0.8628 9/11 [=======================>......] - ETA: 0s - loss: 0.0270 - accuracy: 0.863010/11 [==========================>...] - ETA: 0s - loss: 0.0271 - accuracy: 0.862911/11 [==============================] - ETA: 0s - loss: 0.0272 - accuracy: 0.862411/11 [==============================] - 1s 101ms/step - loss: 0.0273 - accuracy: 0.8620
Evaluate on test data
1/6 [====>.........................] - ETA: 18s - loss: 0.0344 - accuracy: 0.78913/6 [==============>...............] - ETA: 0s - loss: 0.0318 - accuracy: 0.8151 5/6 [========================>.....] - ETA: 0s - loss: 0.0317 - accuracy: 0.83136/6 [==============================] - 4s 35ms/step - loss: 0.0320 - accuracy: 0.8357
2021-12-13 23:37:24.133249: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:37:24.134065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:37:24.134112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:37:24.134155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:37:24.134187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:37:24.134215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:37:24.134254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:37:24.134282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:37:24.134312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:37:24.134345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:37:24.135506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:37:24.135541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:37:24.135552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:37:24.135559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [0.00879276 0.7621324  0.87837833 0.01119068 0.00472081]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 0 2 4 3] pred: [0.44140565 0.51929927 0.16591832 0.0020214  0.02722025]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 4 3] pred: [0.04203981 0.87857646 0.8023742  0.00535882 0.00639114]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 1 0 4] pred: [0.00276393 0.00656682 0.87689984 0.04049164 0.00145689]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 4 0] pred: [0.00170183 0.01368549 0.9524245  0.01807225 0.00179672]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 4 3 2] pred: [0.8003678  0.27009174 0.03078625 0.0420092  0.16294187]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [0.01309991 0.8631027  0.89501655 0.00890881 0.00336561]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 4 3] pred: [0.04241899 0.8436552  0.78905475 0.00361201 0.00703874]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 4 3] pred: [0.054075   0.73459166 0.71814483 0.00311926 0.01165614]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 4 0 1] pred: [0.01030469 0.00281829 0.12759659 0.8382861  0.06098193]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [3 2 4 0 1] pred: [0.01154375 0.00297201 0.1276482  0.8760413  0.0699943 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 2 4 0 1] pred: [0.01242548 0.00280669 0.10483512 0.8572295  0.07908401]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 0 4] pred: [0.00166413 0.00821283 0.9574396  0.02314323 0.00132281]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [0.01661405 0.7315295  0.86889434 0.0045526  0.00586748]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [0.02085164 0.81529224 0.84012926 0.0056141  0.00601923]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:54 - loss: 0.2506 - accuracy: 0.2656 2/11 [====>.........................] - ETA: 0s - loss: 0.2499 - accuracy: 0.2852   3/11 [=======>......................] - ETA: 0s - loss: 0.2493 - accuracy: 0.3108 4/11 [=========>....................] - ETA: 0s - loss: 0.2487 - accuracy: 0.3307 5/11 [============>.................] - ETA: 0s - loss: 0.2481 - accuracy: 0.3424 6/11 [===============>..............] - ETA: 0s - loss: 0.2475 - accuracy: 0.3520 7/11 [==================>...........] - ETA: 0s - loss: 0.2469 - accuracy: 0.3596 8/11 [====================>.........] - ETA: 0s - loss: 0.2463 - accuracy: 0.3659 9/11 [=======================>......] - ETA: 0s - loss: 0.2457 - accuracy: 0.370810/11 [==========================>...] - ETA: 0s - loss: 0.2451 - accuracy: 0.374911/11 [==============================] - ETA: 0s - loss: 0.2445 - accuracy: 0.378311/11 [==============================] - 12s 99ms/step - loss: 0.2440 - accuracy: 0.3812
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2217 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.2211 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.2205 - accuracy: 0.4410 4/11 [=========>....................] - ETA: 0s - loss: 0.2197 - accuracy: 0.4391 5/11 [============>.................] - ETA: 0s - loss: 0.2190 - accuracy: 0.4385 6/11 [===============>..............] - ETA: 0s - loss: 0.2182 - accuracy: 0.4379 7/11 [==================>...........] - ETA: 0s - loss: 0.2173 - accuracy: 0.4366 8/11 [====================>.........] - ETA: 0s - loss: 0.2165 - accuracy: 0.4367 9/11 [=======================>......] - ETA: 0s - loss: 0.2155 - accuracy: 0.437610/11 [==========================>...] - ETA: 0s - loss: 0.2146 - accuracy: 0.438111/11 [==============================] - ETA: 0s - loss: 0.2137 - accuracy: 0.438511/11 [==============================] - 1s 102ms/step - loss: 0.2129 - accuracy: 0.4389
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1789 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.1783 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 0s - loss: 0.1774 - accuracy: 0.4444 4/11 [=========>....................] - ETA: 0s - loss: 0.1767 - accuracy: 0.4393 5/11 [============>.................] - ETA: 0s - loss: 0.1756 - accuracy: 0.4392 6/11 [===============>..............] - ETA: 0s - loss: 0.1742 - accuracy: 0.4426 7/11 [==================>...........] - ETA: 0s - loss: 0.1730 - accuracy: 0.4437 8/11 [====================>.........] - ETA: 0s - loss: 0.1716 - accuracy: 0.4448 9/11 [=======================>......] - ETA: 0s - loss: 0.1703 - accuracy: 0.445310/11 [==========================>...] - ETA: 0s - loss: 0.1690 - accuracy: 0.444811/11 [==============================] - ETA: 0s - loss: 0.1676 - accuracy: 0.444711/11 [==============================] - 1s 103ms/step - loss: 0.1665 - accuracy: 0.4445
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1236 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.1212 - accuracy: 0.4941 3/11 [=======>......................] - ETA: 0s - loss: 0.1205 - accuracy: 0.4831 4/11 [=========>....................] - ETA: 0s - loss: 0.1202 - accuracy: 0.4751 5/11 [============>.................] - ETA: 0s - loss: 0.1203 - accuracy: 0.4688 6/11 [===============>..............] - ETA: 0s - loss: 0.1207 - accuracy: 0.4630 7/11 [==================>...........] - ETA: 0s - loss: 0.1208 - accuracy: 0.4603 8/11 [====================>.........] - ETA: 0s - loss: 0.1203 - accuracy: 0.4593 9/11 [=======================>......] - ETA: 0s - loss: 0.1200 - accuracy: 0.458010/11 [==========================>...] - ETA: 0s - loss: 0.1198 - accuracy: 0.456711/11 [==============================] - ETA: 0s - loss: 0.1196 - accuracy: 0.455511/11 [==============================] - 1s 102ms/step - loss: 0.1194 - accuracy: 0.4544
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1103 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.1107 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.1110 - accuracy: 0.4280 4/11 [=========>....................] - ETA: 0s - loss: 0.1112 - accuracy: 0.4308 5/11 [============>.................] - ETA: 0s - loss: 0.1109 - accuracy: 0.4347 6/11 [===============>..............] - ETA: 0s - loss: 0.1105 - accuracy: 0.4375 7/11 [==================>...........] - ETA: 0s - loss: 0.1103 - accuracy: 0.4394 8/11 [====================>.........] - ETA: 0s - loss: 0.1101 - accuracy: 0.4410 9/11 [=======================>......] - ETA: 0s - loss: 0.1101 - accuracy: 0.441610/11 [==========================>...] - ETA: 0s - loss: 0.1101 - accuracy: 0.442011/11 [==============================] - ETA: 0s - loss: 0.1101 - accuracy: 0.442111/11 [==============================] - 1s 101ms/step - loss: 0.1100 - accuracy: 0.4421
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1049 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.1058 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 0s - loss: 0.1068 - accuracy: 0.4345 4/11 [=========>....................] - ETA: 0s - loss: 0.1064 - accuracy: 0.4401 5/11 [============>.................] - ETA: 0s - loss: 0.1059 - accuracy: 0.4446 6/11 [===============>..............] - ETA: 0s - loss: 0.1056 - accuracy: 0.4454 7/11 [==================>...........] - ETA: 0s - loss: 0.1053 - accuracy: 0.4457 8/11 [====================>.........] - ETA: 0s - loss: 0.1050 - accuracy: 0.4462 9/11 [=======================>......] - ETA: 0s - loss: 0.1047 - accuracy: 0.446710/11 [==========================>...] - ETA: 0s - loss: 0.1045 - accuracy: 0.447311/11 [==============================] - ETA: 0s - loss: 0.1042 - accuracy: 0.447811/11 [==============================] - 1s 105ms/step - loss: 0.1040 - accuracy: 0.4483
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0990 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.0963 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.0955 - accuracy: 0.4358 4/11 [=========>....................] - ETA: 0s - loss: 0.0951 - accuracy: 0.4421 5/11 [============>.................] - ETA: 0s - loss: 0.0945 - accuracy: 0.4465 6/11 [===============>..............] - ETA: 0s - loss: 0.0942 - accuracy: 0.4469 7/11 [==================>...........] - ETA: 0s - loss: 0.0939 - accuracy: 0.4468 8/11 [====================>.........] - ETA: 0s - loss: 0.0936 - accuracy: 0.4482 9/11 [=======================>......] - ETA: 0s - loss: 0.0934 - accuracy: 0.449510/11 [==========================>...] - ETA: 0s - loss: 0.0932 - accuracy: 0.450511/11 [==============================] - ETA: 0s - loss: 0.0931 - accuracy: 0.451211/11 [==============================] - 1s 102ms/step - loss: 0.0930 - accuracy: 0.4517
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0859 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.0854 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 0s - loss: 0.0854 - accuracy: 0.4462 4/11 [=========>....................] - ETA: 0s - loss: 0.0855 - accuracy: 0.4499 5/11 [============>.................] - ETA: 0s - loss: 0.0851 - accuracy: 0.4543 6/11 [===============>..............] - ETA: 0s - loss: 0.0847 - accuracy: 0.4584 7/11 [==================>...........] - ETA: 0s - loss: 0.0843 - accuracy: 0.4613 8/11 [====================>.........] - ETA: 0s - loss: 0.0841 - accuracy: 0.4629 9/11 [=======================>......] - ETA: 0s - loss: 0.0839 - accuracy: 0.464610/11 [==========================>...] - ETA: 0s - loss: 0.0837 - accuracy: 0.466311/11 [==============================] - ETA: 0s - loss: 0.0834 - accuracy: 0.469011/11 [==============================] - 1s 101ms/step - loss: 0.0832 - accuracy: 0.4712
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0786 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.0772 - accuracy: 0.5098 3/11 [=======>......................] - ETA: 1s - loss: 0.0768 - accuracy: 0.5065 4/11 [=========>....................] - ETA: 0s - loss: 0.0766 - accuracy: 0.5054 5/11 [============>.................] - ETA: 0s - loss: 0.0763 - accuracy: 0.5071 6/11 [===============>..............] - ETA: 0s - loss: 0.0759 - accuracy: 0.5096 7/11 [==================>...........] - ETA: 0s - loss: 0.0754 - accuracy: 0.5132 8/11 [====================>.........] - ETA: 0s - loss: 0.0751 - accuracy: 0.5162 9/11 [=======================>......] - ETA: 0s - loss: 0.0748 - accuracy: 0.518710/11 [==========================>...] - ETA: 0s - loss: 0.0744 - accuracy: 0.521011/11 [==============================] - ETA: 0s - loss: 0.0742 - accuracy: 0.523411/11 [==============================] - 1s 112ms/step - loss: 0.0740 - accuracy: 0.5254
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0742 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 1s - loss: 0.0721 - accuracy: 0.5645 3/11 [=======>......................] - ETA: 0s - loss: 0.0719 - accuracy: 0.5647 4/11 [=========>....................] - ETA: 0s - loss: 0.0705 - accuracy: 0.5680 5/11 [============>.................] - ETA: 0s - loss: 0.0697 - accuracy: 0.5701 6/11 [===============>..............] - ETA: 0s - loss: 0.0691 - accuracy: 0.5703 7/11 [==================>...........] - ETA: 0s - loss: 0.0687 - accuracy: 0.5713 8/11 [====================>.........] - ETA: 0s - loss: 0.0684 - accuracy: 0.5718 9/11 [=======================>......] - ETA: 0s - loss: 0.0681 - accuracy: 0.572110/11 [==========================>...] - ETA: 0s - loss: 0.0678 - accuracy: 0.573111/11 [==============================] - ETA: 0s - loss: 0.0675 - accuracy: 0.574111/11 [==============================] - 1s 103ms/step - loss: 0.0673 - accuracy: 0.5749
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0647 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 0s - loss: 0.0609 - accuracy: 0.6738 3/11 [=======>......................] - ETA: 0s - loss: 0.0603 - accuracy: 0.6636 4/11 [=========>....................] - ETA: 0s - loss: 0.0602 - accuracy: 0.6540 5/11 [============>.................] - ETA: 0s - loss: 0.0599 - accuracy: 0.6460 6/11 [===============>..............] - ETA: 0s - loss: 0.0596 - accuracy: 0.6423 7/11 [==================>...........] - ETA: 0s - loss: 0.0593 - accuracy: 0.6384 8/11 [====================>.........] - ETA: 0s - loss: 0.0592 - accuracy: 0.6355 9/11 [=======================>......] - ETA: 0s - loss: 0.0591 - accuracy: 0.633110/11 [==========================>...] - ETA: 0s - loss: 0.0590 - accuracy: 0.630711/11 [==============================] - ETA: 0s - loss: 0.0590 - accuracy: 0.628811/11 [==============================] - 1s 107ms/step - loss: 0.0590 - accuracy: 0.6273
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0596 - accuracy: 0.6250 2/11 [====>.........................] - ETA: 0s - loss: 0.0581 - accuracy: 0.6055 3/11 [=======>......................] - ETA: 0s - loss: 0.0572 - accuracy: 0.6076 4/11 [=========>....................] - ETA: 0s - loss: 0.0571 - accuracy: 0.6071 5/11 [============>.................] - ETA: 0s - loss: 0.0569 - accuracy: 0.6097 6/11 [===============>..............] - ETA: 0s - loss: 0.0567 - accuracy: 0.6114 7/11 [==================>...........] - ETA: 0s - loss: 0.0566 - accuracy: 0.6121 8/11 [====================>.........] - ETA: 0s - loss: 0.0564 - accuracy: 0.6135 9/11 [=======================>......] - ETA: 0s - loss: 0.0563 - accuracy: 0.614910/11 [==========================>...] - ETA: 0s - loss: 0.0561 - accuracy: 0.616511/11 [==============================] - ETA: 0s - loss: 0.0559 - accuracy: 0.618011/11 [==============================] - 1s 102ms/step - loss: 0.0557 - accuracy: 0.6192
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0490 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 0s - loss: 0.0501 - accuracy: 0.6660 3/11 [=======>......................] - ETA: 0s - loss: 0.0500 - accuracy: 0.6558 4/11 [=========>....................] - ETA: 0s - loss: 0.0498 - accuracy: 0.6545 5/11 [============>.................] - ETA: 0s - loss: 0.0500 - accuracy: 0.6511 6/11 [===============>..............] - ETA: 0s - loss: 0.0502 - accuracy: 0.6469 7/11 [==================>...........] - ETA: 0s - loss: 0.0502 - accuracy: 0.6449 8/11 [====================>.........] - ETA: 0s - loss: 0.0503 - accuracy: 0.6422 9/11 [=======================>......] - ETA: 0s - loss: 0.0502 - accuracy: 0.641310/11 [==========================>...] - ETA: 0s - loss: 0.0501 - accuracy: 0.641011/11 [==============================] - ETA: 0s - loss: 0.0500 - accuracy: 0.641311/11 [==============================] - 1s 102ms/step - loss: 0.0499 - accuracy: 0.6415
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0462 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 0s - loss: 0.0455 - accuracy: 0.6211 3/11 [=======>......................] - ETA: 0s - loss: 0.0458 - accuracy: 0.6267 4/11 [=========>....................] - ETA: 0s - loss: 0.0460 - accuracy: 0.6307 5/11 [============>.................] - ETA: 0s - loss: 0.0463 - accuracy: 0.6342 6/11 [===============>..............] - ETA: 0s - loss: 0.0463 - accuracy: 0.6375 7/11 [==================>...........] - ETA: 0s - loss: 0.0461 - accuracy: 0.6406 8/11 [====================>.........] - ETA: 0s - loss: 0.0459 - accuracy: 0.6439 9/11 [=======================>......] - ETA: 0s - loss: 0.0457 - accuracy: 0.646010/11 [==========================>...] - ETA: 0s - loss: 0.0457 - accuracy: 0.647711/11 [==============================] - ETA: 0s - loss: 0.0457 - accuracy: 0.649011/11 [==============================] - 1s 105ms/step - loss: 0.0456 - accuracy: 0.6501
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0474 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 1s - loss: 0.0443 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.0428 - accuracy: 0.6771 4/11 [=========>....................] - ETA: 0s - loss: 0.0425 - accuracy: 0.6787 5/11 [============>.................] - ETA: 0s - loss: 0.0425 - accuracy: 0.6817 6/11 [===============>..............] - ETA: 0s - loss: 0.0425 - accuracy: 0.6864 7/11 [==================>...........] - ETA: 0s - loss: 0.0426 - accuracy: 0.6897 8/11 [====================>.........] - ETA: 0s - loss: 0.0425 - accuracy: 0.6925 9/11 [=======================>......] - ETA: 0s - loss: 0.0424 - accuracy: 0.694310/11 [==========================>...] - ETA: 0s - loss: 0.0424 - accuracy: 0.695611/11 [==============================] - ETA: 0s - loss: 0.0423 - accuracy: 0.697411/11 [==============================] - 1s 111ms/step - loss: 0.0423 - accuracy: 0.6989
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0333 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.0348 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.0352 - accuracy: 0.7448 4/11 [=========>....................] - ETA: 0s - loss: 0.0357 - accuracy: 0.7466 5/11 [============>.................] - ETA: 0s - loss: 0.0363 - accuracy: 0.7463 6/11 [===============>..............] - ETA: 0s - loss: 0.0366 - accuracy: 0.7443 7/11 [==================>...........] - ETA: 0s - loss: 0.0368 - accuracy: 0.7420 8/11 [====================>.........] - ETA: 0s - loss: 0.0371 - accuracy: 0.7378 9/11 [=======================>......] - ETA: 0s - loss: 0.0373 - accuracy: 0.734910/11 [==========================>...] - ETA: 0s - loss: 0.0374 - accuracy: 0.732911/11 [==============================] - ETA: 0s - loss: 0.0376 - accuracy: 0.731111/11 [==============================] - 1s 107ms/step - loss: 0.0377 - accuracy: 0.7296
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0293 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 0s - loss: 0.0319 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.0329 - accuracy: 0.7760 4/11 [=========>....................] - ETA: 0s - loss: 0.0333 - accuracy: 0.7793 5/11 [============>.................] - ETA: 0s - loss: 0.0337 - accuracy: 0.7822 6/11 [===============>..............] - ETA: 0s - loss: 0.0339 - accuracy: 0.7859 7/11 [==================>...........] - ETA: 0s - loss: 0.0340 - accuracy: 0.7897 8/11 [====================>.........] - ETA: 0s - loss: 0.0342 - accuracy: 0.7932 9/11 [=======================>......] - ETA: 0s - loss: 0.0343 - accuracy: 0.796110/11 [==========================>...] - ETA: 0s - loss: 0.0346 - accuracy: 0.798411/11 [==============================] - ETA: 0s - loss: 0.0348 - accuracy: 0.800211/11 [==============================] - 1s 106ms/step - loss: 0.0349 - accuracy: 0.8016
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0344 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 1s - loss: 0.0322 - accuracy: 0.7559 3/11 [=======>......................] - ETA: 0s - loss: 0.0324 - accuracy: 0.7600 4/11 [=========>....................] - ETA: 0s - loss: 0.0329 - accuracy: 0.7599 5/11 [============>.................] - ETA: 0s - loss: 0.0331 - accuracy: 0.7561 6/11 [===============>..............] - ETA: 0s - loss: 0.0332 - accuracy: 0.7514 7/11 [==================>...........] - ETA: 0s - loss: 0.0333 - accuracy: 0.7481 8/11 [====================>.........] - ETA: 0s - loss: 0.0334 - accuracy: 0.7446 9/11 [=======================>......] - ETA: 0s - loss: 0.0336 - accuracy: 0.743310/11 [==========================>...] - ETA: 0s - loss: 0.0338 - accuracy: 0.742511/11 [==============================] - ETA: 0s - loss: 0.0338 - accuracy: 0.742511/11 [==============================] - 1s 104ms/step - loss: 0.0339 - accuracy: 0.7424
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0317 - accuracy: 0.8047 2/11 [====>.........................] - ETA: 0s - loss: 0.0317 - accuracy: 0.8047 3/11 [=======>......................] - ETA: 0s - loss: 0.0318 - accuracy: 0.8038 4/11 [=========>....................] - ETA: 0s - loss: 0.0318 - accuracy: 0.8006 5/11 [============>.................] - ETA: 0s - loss: 0.0320 - accuracy: 0.7989 6/11 [===============>..............] - ETA: 0s - loss: 0.0322 - accuracy: 0.7971 7/11 [==================>...........] - ETA: 0s - loss: 0.0321 - accuracy: 0.7959 8/11 [====================>.........] - ETA: 0s - loss: 0.0320 - accuracy: 0.7956 9/11 [=======================>......] - ETA: 0s - loss: 0.0320 - accuracy: 0.795410/11 [==========================>...] - ETA: 0s - loss: 0.0320 - accuracy: 0.796011/11 [==============================] - ETA: 0s - loss: 0.0321 - accuracy: 0.797011/11 [==============================] - 1s 115ms/step - loss: 0.0321 - accuracy: 0.7977
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0257 - accuracy: 0.8359 2/11 [====>.........................] - ETA: 1s - loss: 0.0268 - accuracy: 0.8418 3/11 [=======>......................] - ETA: 0s - loss: 0.0275 - accuracy: 0.8381 4/11 [=========>....................] - ETA: 0s - loss: 0.0278 - accuracy: 0.8361 5/11 [============>.................] - ETA: 0s - loss: 0.0280 - accuracy: 0.8348 6/11 [===============>..............] - ETA: 0s - loss: 0.0281 - accuracy: 0.8322 7/11 [==================>...........] - ETA: 0s - loss: 0.0284 - accuracy: 0.8294 8/11 [====================>.........] - ETA: 0s - loss: 0.0287 - accuracy: 0.8288 9/11 [=======================>......] - ETA: 0s - loss: 0.0290 - accuracy: 0.827810/11 [==========================>...] - ETA: 0s - loss: 0.0292 - accuracy: 0.827511/11 [==============================] - ETA: 0s - loss: 0.0293 - accuracy: 0.827611/11 [==============================] - 1s 105ms/step - loss: 0.0295 - accuracy: 0.8276
Evaluate on test data
1/6 [====>.........................] - ETA: 18s - loss: 0.0280 - accuracy: 0.92973/6 [==============>...............] - ETA: 0s - loss: 0.0276 - accuracy: 0.9141 5/6 [========================>.....] - ETA: 0s - loss: 0.0290 - accuracy: 0.90476/6 [==============================] - 4s 33ms/step - loss: 0.0291 - accuracy: 0.9023
2021-12-13 23:38:11.747983: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:38:11.748974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:38:11.749031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:38:11.749083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:38:11.749123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:38:11.749161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:38:11.749197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:38:11.749245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:38:11.749283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:38:11.749321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:38:11.750723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:38:11.750761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:38:11.750773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:38:11.750784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [3.1011283e-02 8.7734419e-01 8.1786394e-01 8.9312792e-03 6.9111586e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [2.0690650e-02 8.7689674e-01 8.6310828e-01 8.4625781e-03 5.5700541e-04]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 4 0] pred: [4.1556358e-04 4.7550529e-02 9.6816713e-01 1.5938371e-02 5.3444505e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [5.6067109e-04 3.2257199e-02 9.6275771e-01 1.5833974e-02 8.9275837e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 4 0] pred: [0.00099808 0.02141085 0.94517183 0.03800964 0.00228038]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 4 2 3] pred: [0.773471   0.2638294  0.03277633 0.01372737 0.05586353]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [0.00190401 0.09732738 0.9352082  0.01135114 0.00136518]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [7.0631504e-04 3.6523163e-02 9.5227790e-01 2.9800504e-02 1.1230111e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [4 3 0 2 1] pred: [0.0683153  0.01220864 0.0497143  0.3917445  0.6323061 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [4 3 0 2 1] pred: [0.0847865  0.00609663 0.0357627  0.339004   0.7539823 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [5.2830577e-04 3.5751551e-02 9.6688706e-01 1.9976497e-02 8.3386898e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [2.725631e-02 8.751683e-01 8.258834e-01 9.245813e-03 8.035600e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 2 4 1 0] pred: [0.01158682 0.02251166 0.19589704 0.8371131  0.09359422]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [0.03335202 0.8354385  0.77805805 0.00740144 0.00091961]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 4 0] pred: [7.9497695e-04 3.5574824e-02 9.4647336e-01 3.8765401e-02 1.3504922e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:03 - loss: 0.2485 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.2478 - accuracy: 0.4531   3/11 [=======>......................] - ETA: 0s - loss: 0.2471 - accuracy: 0.4627 4/11 [=========>....................] - ETA: 0s - loss: 0.2464 - accuracy: 0.4691 5/11 [============>.................] - ETA: 0s - loss: 0.2457 - accuracy: 0.4706 6/11 [===============>..............] - ETA: 0s - loss: 0.2450 - accuracy: 0.4707 7/11 [==================>...........] - ETA: 0s - loss: 0.2443 - accuracy: 0.4703 8/11 [====================>.........] - ETA: 0s - loss: 0.2436 - accuracy: 0.4693 9/11 [=======================>......] - ETA: 0s - loss: 0.2430 - accuracy: 0.467810/11 [==========================>...] - ETA: 0s - loss: 0.2423 - accuracy: 0.466811/11 [==============================] - ETA: 0s - loss: 0.2416 - accuracy: 0.465911/11 [==============================] - 13s 107ms/step - loss: 0.2411 - accuracy: 0.4651
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2162 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.2150 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 0s - loss: 0.2141 - accuracy: 0.4709 4/11 [=========>....................] - ETA: 0s - loss: 0.2133 - accuracy: 0.4679 5/11 [============>.................] - ETA: 0s - loss: 0.2126 - accuracy: 0.4634 6/11 [===============>..............] - ETA: 0s - loss: 0.2117 - accuracy: 0.4632 7/11 [==================>...........] - ETA: 0s - loss: 0.2108 - accuracy: 0.4623 8/11 [====================>.........] - ETA: 0s - loss: 0.2099 - accuracy: 0.4609 9/11 [=======================>......] - ETA: 0s - loss: 0.2090 - accuracy: 0.460410/11 [==========================>...] - ETA: 0s - loss: 0.2080 - accuracy: 0.459711/11 [==============================] - ETA: 0s - loss: 0.2071 - accuracy: 0.459411/11 [==============================] - 1s 104ms/step - loss: 0.2063 - accuracy: 0.4592
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1703 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.1684 - accuracy: 0.4805 3/11 [=======>......................] - ETA: 0s - loss: 0.1680 - accuracy: 0.4731 4/11 [=========>....................] - ETA: 0s - loss: 0.1668 - accuracy: 0.4735 5/11 [============>.................] - ETA: 0s - loss: 0.1659 - accuracy: 0.4719 6/11 [===============>..............] - ETA: 0s - loss: 0.1648 - accuracy: 0.4705 7/11 [==================>...........] - ETA: 0s - loss: 0.1638 - accuracy: 0.4685 8/11 [====================>.........] - ETA: 0s - loss: 0.1628 - accuracy: 0.4671 9/11 [=======================>......] - ETA: 0s - loss: 0.1617 - accuracy: 0.466210/11 [==========================>...] - ETA: 0s - loss: 0.1606 - accuracy: 0.465511/11 [==============================] - ETA: 0s - loss: 0.1596 - accuracy: 0.464711/11 [==============================] - 1s 105ms/step - loss: 0.1588 - accuracy: 0.4641
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1087 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.1130 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.1149 - accuracy: 0.4965 4/11 [=========>....................] - ETA: 0s - loss: 0.1161 - accuracy: 0.4906 5/11 [============>.................] - ETA: 0s - loss: 0.1172 - accuracy: 0.4840 6/11 [===============>..............] - ETA: 0s - loss: 0.1181 - accuracy: 0.4791 7/11 [==================>...........] - ETA: 0s - loss: 0.1186 - accuracy: 0.4762 8/11 [====================>.........] - ETA: 0s - loss: 0.1191 - accuracy: 0.4735 9/11 [=======================>......] - ETA: 0s - loss: 0.1195 - accuracy: 0.470910/11 [==========================>...] - ETA: 0s - loss: 0.1197 - accuracy: 0.469311/11 [==============================] - ETA: 0s - loss: 0.1197 - accuracy: 0.468111/11 [==============================] - 1s 108ms/step - loss: 0.1198 - accuracy: 0.4672
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1108 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.1106 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.1106 - accuracy: 0.4965 4/11 [=========>....................] - ETA: 0s - loss: 0.1116 - accuracy: 0.4876 5/11 [============>.................] - ETA: 0s - loss: 0.1118 - accuracy: 0.4832 6/11 [===============>..............] - ETA: 0s - loss: 0.1122 - accuracy: 0.4793 7/11 [==================>...........] - ETA: 0s - loss: 0.1125 - accuracy: 0.4754 8/11 [====================>.........] - ETA: 0s - loss: 0.1127 - accuracy: 0.4729 9/11 [=======================>......] - ETA: 0s - loss: 0.1128 - accuracy: 0.470810/11 [==========================>...] - ETA: 0s - loss: 0.1129 - accuracy: 0.469511/11 [==============================] - ETA: 0s - loss: 0.1128 - accuracy: 0.468411/11 [==============================] - 1s 107ms/step - loss: 0.1127 - accuracy: 0.4674
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1015 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.1039 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.1046 - accuracy: 0.4792 4/11 [=========>....................] - ETA: 0s - loss: 0.1056 - accuracy: 0.4741 5/11 [============>.................] - ETA: 0s - loss: 0.1064 - accuracy: 0.4705 6/11 [===============>..............] - ETA: 0s - loss: 0.1069 - accuracy: 0.4676 7/11 [==================>...........] - ETA: 0s - loss: 0.1071 - accuracy: 0.4665 8/11 [====================>.........] - ETA: 0s - loss: 0.1073 - accuracy: 0.4652 9/11 [=======================>......] - ETA: 0s - loss: 0.1074 - accuracy: 0.464910/11 [==========================>...] - ETA: 0s - loss: 0.1074 - accuracy: 0.464611/11 [==============================] - ETA: 0s - loss: 0.1074 - accuracy: 0.463911/11 [==============================] - 1s 111ms/step - loss: 0.1074 - accuracy: 0.4633
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0984 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.0991 - accuracy: 0.4805 3/11 [=======>......................] - ETA: 0s - loss: 0.0994 - accuracy: 0.4696 4/11 [=========>....................] - ETA: 0s - loss: 0.0995 - accuracy: 0.4684 5/11 [============>.................] - ETA: 0s - loss: 0.0992 - accuracy: 0.4694 6/11 [===============>..............] - ETA: 0s - loss: 0.0991 - accuracy: 0.4702 7/11 [==================>...........] - ETA: 0s - loss: 0.0991 - accuracy: 0.4706 8/11 [====================>.........] - ETA: 0s - loss: 0.0992 - accuracy: 0.4709 9/11 [=======================>......] - ETA: 0s - loss: 0.0993 - accuracy: 0.470310/11 [==========================>...] - ETA: 0s - loss: 0.0995 - accuracy: 0.469711/11 [==============================] - ETA: 0s - loss: 0.0996 - accuracy: 0.469011/11 [==============================] - 1s 107ms/step - loss: 0.0997 - accuracy: 0.4684
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0961 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.0941 - accuracy: 0.4434 3/11 [=======>......................] - ETA: 0s - loss: 0.0938 - accuracy: 0.4423 4/11 [=========>....................] - ETA: 0s - loss: 0.0937 - accuracy: 0.4479 5/11 [============>.................] - ETA: 0s - loss: 0.0940 - accuracy: 0.4505 6/11 [===============>..............] - ETA: 0s - loss: 0.0938 - accuracy: 0.4551 7/11 [==================>...........] - ETA: 0s - loss: 0.0936 - accuracy: 0.4581 8/11 [====================>.........] - ETA: 0s - loss: 0.0934 - accuracy: 0.4603 9/11 [=======================>......] - ETA: 0s - loss: 0.0932 - accuracy: 0.462710/11 [==========================>...] - ETA: 0s - loss: 0.0931 - accuracy: 0.464011/11 [==============================] - ETA: 0s - loss: 0.0930 - accuracy: 0.465111/11 [==============================] - 1s 102ms/step - loss: 0.0929 - accuracy: 0.4660
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0793 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.0782 - accuracy: 0.5273 3/11 [=======>......................] - ETA: 1s - loss: 0.0789 - accuracy: 0.5148 4/11 [=========>....................] - ETA: 0s - loss: 0.0787 - accuracy: 0.5091 5/11 [============>.................] - ETA: 0s - loss: 0.0790 - accuracy: 0.5073 6/11 [===============>..............] - ETA: 0s - loss: 0.0792 - accuracy: 0.5054 7/11 [==================>...........] - ETA: 0s - loss: 0.0794 - accuracy: 0.5051 8/11 [====================>.........] - ETA: 0s - loss: 0.0797 - accuracy: 0.5052 9/11 [=======================>......] - ETA: 0s - loss: 0.0798 - accuracy: 0.505710/11 [==========================>...] - ETA: 0s - loss: 0.0800 - accuracy: 0.506411/11 [==============================] - ETA: 0s - loss: 0.0800 - accuracy: 0.507011/11 [==============================] - 1s 105ms/step - loss: 0.0800 - accuracy: 0.5075
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0755 - accuracy: 0.5859 2/11 [====>.........................] - ETA: 0s - loss: 0.0744 - accuracy: 0.5762 3/11 [=======>......................] - ETA: 0s - loss: 0.0732 - accuracy: 0.5707 4/11 [=========>....................] - ETA: 0s - loss: 0.0724 - accuracy: 0.5706 5/11 [============>.................] - ETA: 0s - loss: 0.0718 - accuracy: 0.5731 6/11 [===============>..............] - ETA: 0s - loss: 0.0717 - accuracy: 0.5737 7/11 [==================>...........] - ETA: 0s - loss: 0.0715 - accuracy: 0.5756 8/11 [====================>.........] - ETA: 0s - loss: 0.0714 - accuracy: 0.5773 9/11 [=======================>......] - ETA: 0s - loss: 0.0713 - accuracy: 0.578310/11 [==========================>...] - ETA: 0s - loss: 0.0712 - accuracy: 0.579511/11 [==============================] - ETA: 0s - loss: 0.0711 - accuracy: 0.580511/11 [==============================] - 1s 111ms/step - loss: 0.0710 - accuracy: 0.5813
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0600 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 0s - loss: 0.0609 - accuracy: 0.5859 3/11 [=======>......................] - ETA: 0s - loss: 0.0615 - accuracy: 0.5964 4/11 [=========>....................] - ETA: 0s - loss: 0.0616 - accuracy: 0.6025 5/11 [============>.................] - ETA: 0s - loss: 0.0614 - accuracy: 0.6067 6/11 [===============>..............] - ETA: 0s - loss: 0.0615 - accuracy: 0.6078 7/11 [==================>...........] - ETA: 0s - loss: 0.0617 - accuracy: 0.6092 8/11 [====================>.........] - ETA: 0s - loss: 0.0619 - accuracy: 0.6106 9/11 [=======================>......] - ETA: 0s - loss: 0.0620 - accuracy: 0.611710/11 [==========================>...] - ETA: 0s - loss: 0.0621 - accuracy: 0.612111/11 [==============================] - ETA: 0s - loss: 0.0622 - accuracy: 0.612311/11 [==============================] - 1s 104ms/step - loss: 0.0622 - accuracy: 0.6125
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0567 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 1s - loss: 0.0602 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.0601 - accuracy: 0.6293 4/11 [=========>....................] - ETA: 0s - loss: 0.0596 - accuracy: 0.6263 5/11 [============>.................] - ETA: 0s - loss: 0.0594 - accuracy: 0.6232 6/11 [===============>..............] - ETA: 0s - loss: 0.0591 - accuracy: 0.6237 7/11 [==================>...........] - ETA: 0s - loss: 0.0588 - accuracy: 0.6241 8/11 [====================>.........] - ETA: 0s - loss: 0.0585 - accuracy: 0.6243 9/11 [=======================>......] - ETA: 0s - loss: 0.0583 - accuracy: 0.625110/11 [==========================>...] - ETA: 0s - loss: 0.0582 - accuracy: 0.626511/11 [==============================] - ETA: 0s - loss: 0.0581 - accuracy: 0.628011/11 [==============================] - 1s 108ms/step - loss: 0.0580 - accuracy: 0.6293
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0505 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 0s - loss: 0.0541 - accuracy: 0.6660 3/11 [=======>......................] - ETA: 0s - loss: 0.0539 - accuracy: 0.6584 4/11 [=========>....................] - ETA: 0s - loss: 0.0538 - accuracy: 0.6510 5/11 [============>.................] - ETA: 0s - loss: 0.0537 - accuracy: 0.6486 6/11 [===============>..............] - ETA: 0s - loss: 0.0537 - accuracy: 0.6480 7/11 [==================>...........] - ETA: 0s - loss: 0.0537 - accuracy: 0.6469 8/11 [====================>.........] - ETA: 0s - loss: 0.0537 - accuracy: 0.6458 9/11 [=======================>......] - ETA: 0s - loss: 0.0536 - accuracy: 0.646210/11 [==========================>...] - ETA: 0s - loss: 0.0535 - accuracy: 0.647111/11 [==============================] - ETA: 0s - loss: 0.0534 - accuracy: 0.648411/11 [==============================] - 1s 108ms/step - loss: 0.0533 - accuracy: 0.6495
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0489 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.0519 - accuracy: 0.6387 3/11 [=======>......................] - ETA: 0s - loss: 0.0523 - accuracy: 0.6402 4/11 [=========>....................] - ETA: 0s - loss: 0.0521 - accuracy: 0.6369 5/11 [============>.................] - ETA: 0s - loss: 0.0515 - accuracy: 0.6398 6/11 [===============>..............] - ETA: 0s - loss: 0.0510 - accuracy: 0.6430 7/11 [==================>...........] - ETA: 0s - loss: 0.0506 - accuracy: 0.6462 8/11 [====================>.........] - ETA: 0s - loss: 0.0503 - accuracy: 0.6489 9/11 [=======================>......] - ETA: 0s - loss: 0.0501 - accuracy: 0.651410/11 [==========================>...] - ETA: 0s - loss: 0.0498 - accuracy: 0.653611/11 [==============================] - ETA: 0s - loss: 0.0497 - accuracy: 0.654611/11 [==============================] - 1s 113ms/step - loss: 0.0495 - accuracy: 0.6554
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0426 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 0s - loss: 0.0436 - accuracy: 0.6562 3/11 [=======>......................] - ETA: 0s - loss: 0.0433 - accuracy: 0.6545 4/11 [=========>....................] - ETA: 0s - loss: 0.0430 - accuracy: 0.6540 5/11 [============>.................] - ETA: 0s - loss: 0.0429 - accuracy: 0.6563 6/11 [===============>..............] - ETA: 0s - loss: 0.0431 - accuracy: 0.6569 7/11 [==================>...........] - ETA: 0s - loss: 0.0432 - accuracy: 0.6583 8/11 [====================>.........] - ETA: 0s - loss: 0.0433 - accuracy: 0.6592 9/11 [=======================>......] - ETA: 0s - loss: 0.0434 - accuracy: 0.660110/11 [==========================>...] - ETA: 0s - loss: 0.0435 - accuracy: 0.661111/11 [==============================] - ETA: 0s - loss: 0.0436 - accuracy: 0.662111/11 [==============================] - 1s 105ms/step - loss: 0.0436 - accuracy: 0.6630
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0379 - accuracy: 0.6484 2/11 [====>.........................] - ETA: 0s - loss: 0.0389 - accuracy: 0.6738 3/11 [=======>......................] - ETA: 0s - loss: 0.0397 - accuracy: 0.6819 4/11 [=========>....................] - ETA: 0s - loss: 0.0399 - accuracy: 0.6886 5/11 [============>.................] - ETA: 0s - loss: 0.0401 - accuracy: 0.6925 6/11 [===============>..............] - ETA: 0s - loss: 0.0402 - accuracy: 0.6956 7/11 [==================>...........] - ETA: 0s - loss: 0.0405 - accuracy: 0.6971 8/11 [====================>.........] - ETA: 0s - loss: 0.0406 - accuracy: 0.6971 9/11 [=======================>......] - ETA: 0s - loss: 0.0406 - accuracy: 0.696910/11 [==========================>...] - ETA: 0s - loss: 0.0407 - accuracy: 0.697511/11 [==============================] - ETA: 0s - loss: 0.0408 - accuracy: 0.698211/11 [==============================] - 1s 106ms/step - loss: 0.0408 - accuracy: 0.6988
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0372 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.0383 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.0392 - accuracy: 0.7170 4/11 [=========>....................] - ETA: 0s - loss: 0.0397 - accuracy: 0.7214 5/11 [============>.................] - ETA: 0s - loss: 0.0396 - accuracy: 0.7265 6/11 [===============>..............] - ETA: 0s - loss: 0.0395 - accuracy: 0.7282 7/11 [==================>...........] - ETA: 0s - loss: 0.0393 - accuracy: 0.7296 8/11 [====================>.........] - ETA: 0s - loss: 0.0391 - accuracy: 0.7297 9/11 [=======================>......] - ETA: 0s - loss: 0.0390 - accuracy: 0.730110/11 [==========================>...] - ETA: 0s - loss: 0.0390 - accuracy: 0.730711/11 [==============================] - ETA: 0s - loss: 0.0389 - accuracy: 0.731311/11 [==============================] - 1s 108ms/step - loss: 0.0389 - accuracy: 0.7318
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0416 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 1s - loss: 0.0396 - accuracy: 0.6914 3/11 [=======>......................] - ETA: 0s - loss: 0.0384 - accuracy: 0.7005 4/11 [=========>....................] - ETA: 0s - loss: 0.0379 - accuracy: 0.7095 5/11 [============>.................] - ETA: 0s - loss: 0.0374 - accuracy: 0.7151 6/11 [===============>..............] - ETA: 0s - loss: 0.0373 - accuracy: 0.7189 7/11 [==================>...........] - ETA: 0s - loss: 0.0372 - accuracy: 0.7219 8/11 [====================>.........] - ETA: 0s - loss: 0.0370 - accuracy: 0.7256 9/11 [=======================>......] - ETA: 0s - loss: 0.0368 - accuracy: 0.728410/11 [==========================>...] - ETA: 0s - loss: 0.0367 - accuracy: 0.730911/11 [==============================] - ETA: 0s - loss: 0.0366 - accuracy: 0.733111/11 [==============================] - 1s 107ms/step - loss: 0.0366 - accuracy: 0.7350
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0365 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 0s - loss: 0.0356 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.0357 - accuracy: 0.7821 4/11 [=========>....................] - ETA: 0s - loss: 0.0354 - accuracy: 0.7809 5/11 [============>.................] - ETA: 0s - loss: 0.0353 - accuracy: 0.7794 6/11 [===============>..............] - ETA: 0s - loss: 0.0351 - accuracy: 0.7760 7/11 [==================>...........] - ETA: 0s - loss: 0.0349 - accuracy: 0.7720 8/11 [====================>.........] - ETA: 0s - loss: 0.0348 - accuracy: 0.7684 9/11 [=======================>......] - ETA: 0s - loss: 0.0348 - accuracy: 0.765110/11 [==========================>...] - ETA: 0s - loss: 0.0347 - accuracy: 0.762511/11 [==============================] - ETA: 0s - loss: 0.0346 - accuracy: 0.761011/11 [==============================] - 1s 105ms/step - loss: 0.0345 - accuracy: 0.7597
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0368 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.0374 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.0368 - accuracy: 0.7752 4/11 [=========>....................] - ETA: 0s - loss: 0.0360 - accuracy: 0.7786 5/11 [============>.................] - ETA: 0s - loss: 0.0353 - accuracy: 0.7814 6/11 [===============>..............] - ETA: 0s - loss: 0.0348 - accuracy: 0.7831 7/11 [==================>...........] - ETA: 0s - loss: 0.0344 - accuracy: 0.7849 8/11 [====================>.........] - ETA: 0s - loss: 0.0342 - accuracy: 0.7850 9/11 [=======================>......] - ETA: 0s - loss: 0.0339 - accuracy: 0.785010/11 [==========================>...] - ETA: 0s - loss: 0.0337 - accuracy: 0.784811/11 [==============================] - ETA: 0s - loss: 0.0335 - accuracy: 0.784811/11 [==============================] - 1s 99ms/step - loss: 0.0333 - accuracy: 0.7848
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0309 - accuracy: 0.78123/6 [==============>...............] - ETA: 0s - loss: 0.0320 - accuracy: 0.7917 5/6 [========================>.....] - ETA: 0s - loss: 0.0337 - accuracy: 0.77976/6 [==============================] - 4s 32ms/step - loss: 0.0333 - accuracy: 0.7960
2021-12-13 23:38:59.378640: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:38:59.379479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:38:59.379527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:38:59.379569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:38:59.379596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:38:59.379624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:38:59.379651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:38:59.379682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:38:59.379709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:38:59.379741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:38:59.380883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:38:59.380912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:38:59.380922: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:38:59.380930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [0.00104386 0.03708306 0.9506     0.02096897 0.00312206]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [0.03584284 0.8788767  0.78576523 0.00976002 0.00726718]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [0 1 4 3 2] pred: [0.72460616 0.21641535 0.01755536 0.02851525 0.10628864]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 0 2 3 4] pred: [0.18669483 0.5264165  0.18190992 0.07866544 0.0516932 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [0.02852467 0.85905564 0.85685873 0.00991708 0.00791731]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 4 0] pred: [7.1370602e-04 3.4328312e-02 9.6948338e-01 1.5421301e-02 3.3325851e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [7.3650479e-04 3.1390190e-02 9.6617937e-01 1.6587764e-02 3.1857789e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [7.9780817e-04 7.3036164e-02 9.7514963e-01 1.9361645e-02 2.3786426e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [4.9895048e-04 1.4949203e-02 9.7187263e-01 1.4698684e-02 2.5505424e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 4 3] pred: [0.05415109 0.75556123 0.6490464  0.00894225 0.01415005]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [0.04095396 0.87316453 0.80558413 0.01164162 0.00820795]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [7.4130297e-04 3.1323016e-02 9.6655023e-01 1.6503662e-02 3.3746064e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.10058311 0.8742408  0.39129707 0.03458905 0.00822711]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [0.00097358 0.03888711 0.95222324 0.0167833  0.00361791]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 4 0] pred: [0.00210565 0.01343894 0.83069766 0.09623489 0.00995925]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:56 - loss: 0.2501 - accuracy: 0.1562 2/11 [====>.........................] - ETA: 0s - loss: 0.2495 - accuracy: 0.1738   3/11 [=======>......................] - ETA: 0s - loss: 0.2489 - accuracy: 0.2079 4/11 [=========>....................] - ETA: 0s - loss: 0.2482 - accuracy: 0.2380 5/11 [============>.................] - ETA: 0s - loss: 0.2476 - accuracy: 0.2607 6/11 [===============>..............] - ETA: 0s - loss: 0.2470 - accuracy: 0.2804 7/11 [==================>...........] - ETA: 0s - loss: 0.2464 - accuracy: 0.2963 8/11 [====================>.........] - ETA: 0s - loss: 0.2458 - accuracy: 0.3087 9/11 [=======================>......] - ETA: 0s - loss: 0.2451 - accuracy: 0.319010/11 [==========================>...] - ETA: 0s - loss: 0.2445 - accuracy: 0.328511/11 [==============================] - ETA: 0s - loss: 0.2439 - accuracy: 0.336311/11 [==============================] - 13s 104ms/step - loss: 0.2434 - accuracy: 0.3428
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2194 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.2194 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.2189 - accuracy: 0.4740 4/11 [=========>....................] - ETA: 0s - loss: 0.2182 - accuracy: 0.4766 5/11 [============>.................] - ETA: 0s - loss: 0.2174 - accuracy: 0.4762 6/11 [===============>..............] - ETA: 0s - loss: 0.2166 - accuracy: 0.4750 7/11 [==================>...........] - ETA: 0s - loss: 0.2157 - accuracy: 0.4751 8/11 [====================>.........] - ETA: 0s - loss: 0.2148 - accuracy: 0.4749 9/11 [=======================>......] - ETA: 0s - loss: 0.2140 - accuracy: 0.473710/11 [==========================>...] - ETA: 0s - loss: 0.2131 - accuracy: 0.472411/11 [==============================] - ETA: 0s - loss: 0.2123 - accuracy: 0.471211/11 [==============================] - 1s 104ms/step - loss: 0.2116 - accuracy: 0.4701
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1785 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.1772 - accuracy: 0.4180 3/11 [=======>......................] - ETA: 0s - loss: 0.1760 - accuracy: 0.4262 4/11 [=========>....................] - ETA: 0s - loss: 0.1747 - accuracy: 0.4320 5/11 [============>.................] - ETA: 0s - loss: 0.1737 - accuracy: 0.4353 6/11 [===============>..............] - ETA: 0s - loss: 0.1726 - accuracy: 0.4372 7/11 [==================>...........] - ETA: 0s - loss: 0.1714 - accuracy: 0.4394 8/11 [====================>.........] - ETA: 0s - loss: 0.1702 - accuracy: 0.4414 9/11 [=======================>......] - ETA: 0s - loss: 0.1691 - accuracy: 0.443710/11 [==========================>...] - ETA: 0s - loss: 0.1680 - accuracy: 0.445011/11 [==============================] - ETA: 0s - loss: 0.1669 - accuracy: 0.446111/11 [==============================] - 1s 108ms/step - loss: 0.1661 - accuracy: 0.4471
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1313 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.1307 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.1297 - accuracy: 0.4358 4/11 [=========>....................] - ETA: 0s - loss: 0.1290 - accuracy: 0.4347 5/11 [============>.................] - ETA: 0s - loss: 0.1280 - accuracy: 0.4356 6/11 [===============>..............] - ETA: 0s - loss: 0.1267 - accuracy: 0.4392 7/11 [==================>...........] - ETA: 0s - loss: 0.1257 - accuracy: 0.4404 8/11 [====================>.........] - ETA: 0s - loss: 0.1249 - accuracy: 0.4411 9/11 [=======================>......] - ETA: 0s - loss: 0.1241 - accuracy: 0.442210/11 [==========================>...] - ETA: 0s - loss: 0.1234 - accuracy: 0.443611/11 [==============================] - ETA: 0s - loss: 0.1228 - accuracy: 0.444911/11 [==============================] - 1s 110ms/step - loss: 0.1223 - accuracy: 0.4460
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1043 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.1050 - accuracy: 0.5020 3/11 [=======>......................] - ETA: 0s - loss: 0.1059 - accuracy: 0.4909 4/11 [=========>....................] - ETA: 0s - loss: 0.1075 - accuracy: 0.4814 5/11 [============>.................] - ETA: 0s - loss: 0.1088 - accuracy: 0.4752 6/11 [===============>..............] - ETA: 0s - loss: 0.1100 - accuracy: 0.4697 7/11 [==================>...........] - ETA: 0s - loss: 0.1103 - accuracy: 0.4675 8/11 [====================>.........] - ETA: 0s - loss: 0.1105 - accuracy: 0.4662 9/11 [=======================>......] - ETA: 0s - loss: 0.1105 - accuracy: 0.465210/11 [==========================>...] - ETA: 0s - loss: 0.1105 - accuracy: 0.464111/11 [==============================] - ETA: 0s - loss: 0.1105 - accuracy: 0.463511/11 [==============================] - 1s 105ms/step - loss: 0.1104 - accuracy: 0.4630
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1241 - accuracy: 0.3828 2/11 [====>.........................] - ETA: 0s - loss: 0.1203 - accuracy: 0.4102 3/11 [=======>......................] - ETA: 0s - loss: 0.1180 - accuracy: 0.4210 4/11 [=========>....................] - ETA: 0s - loss: 0.1157 - accuracy: 0.4271 5/11 [============>.................] - ETA: 0s - loss: 0.1142 - accuracy: 0.4304 6/11 [===============>..............] - ETA: 0s - loss: 0.1126 - accuracy: 0.4362 7/11 [==================>...........] - ETA: 0s - loss: 0.1116 - accuracy: 0.4384 8/11 [====================>.........] - ETA: 0s - loss: 0.1109 - accuracy: 0.4403 9/11 [=======================>......] - ETA: 0s - loss: 0.1102 - accuracy: 0.441110/11 [==========================>...] - ETA: 0s - loss: 0.1096 - accuracy: 0.442911/11 [==============================] - ETA: 0s - loss: 0.1090 - accuracy: 0.444211/11 [==============================] - 1s 101ms/step - loss: 0.1086 - accuracy: 0.4453
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0926 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.0938 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 0s - loss: 0.0936 - accuracy: 0.4891 4/11 [=========>....................] - ETA: 0s - loss: 0.0936 - accuracy: 0.4924 5/11 [============>.................] - ETA: 0s - loss: 0.0940 - accuracy: 0.4901 6/11 [===============>..............] - ETA: 0s - loss: 0.0944 - accuracy: 0.4859 7/11 [==================>...........] - ETA: 0s - loss: 0.0943 - accuracy: 0.4849 8/11 [====================>.........] - ETA: 0s - loss: 0.0944 - accuracy: 0.4825 9/11 [=======================>......] - ETA: 0s - loss: 0.0943 - accuracy: 0.481210/11 [==========================>...] - ETA: 0s - loss: 0.0943 - accuracy: 0.480511/11 [==============================] - ETA: 0s - loss: 0.0943 - accuracy: 0.479811/11 [==============================] - 1s 109ms/step - loss: 0.0942 - accuracy: 0.4792
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0882 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.0877 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 0s - loss: 0.0871 - accuracy: 0.4978 4/11 [=========>....................] - ETA: 0s - loss: 0.0867 - accuracy: 0.4993 5/11 [============>.................] - ETA: 0s - loss: 0.0864 - accuracy: 0.4979 6/11 [===============>..............] - ETA: 0s - loss: 0.0858 - accuracy: 0.4980 7/11 [==================>...........] - ETA: 0s - loss: 0.0854 - accuracy: 0.4985 8/11 [====================>.........] - ETA: 0s - loss: 0.0850 - accuracy: 0.4983 9/11 [=======================>......] - ETA: 0s - loss: 0.0846 - accuracy: 0.497810/11 [==========================>...] - ETA: 0s - loss: 0.0843 - accuracy: 0.497611/11 [==============================] - ETA: 0s - loss: 0.0840 - accuracy: 0.497111/11 [==============================] - 1s 111ms/step - loss: 0.0838 - accuracy: 0.4966
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0784 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.0768 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.0767 - accuracy: 0.5061 4/11 [=========>....................] - ETA: 0s - loss: 0.0760 - accuracy: 0.5046 5/11 [============>.................] - ETA: 0s - loss: 0.0756 - accuracy: 0.5086 6/11 [===============>..............] - ETA: 0s - loss: 0.0751 - accuracy: 0.5115 7/11 [==================>...........] - ETA: 0s - loss: 0.0750 - accuracy: 0.5131 8/11 [====================>.........] - ETA: 0s - loss: 0.0745 - accuracy: 0.5161 9/11 [=======================>......] - ETA: 0s - loss: 0.0741 - accuracy: 0.519410/11 [==========================>...] - ETA: 0s - loss: 0.0738 - accuracy: 0.522411/11 [==============================] - ETA: 0s - loss: 0.0736 - accuracy: 0.524511/11 [==============================] - 1s 113ms/step - loss: 0.0734 - accuracy: 0.5262
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0691 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 1s - loss: 0.0694 - accuracy: 0.5840 3/11 [=======>......................] - ETA: 0s - loss: 0.0685 - accuracy: 0.5933 4/11 [=========>....................] - ETA: 0s - loss: 0.0675 - accuracy: 0.5954 5/11 [============>.................] - ETA: 0s - loss: 0.0669 - accuracy: 0.5972 6/11 [===============>..............] - ETA: 0s - loss: 0.0667 - accuracy: 0.5975 7/11 [==================>...........] - ETA: 0s - loss: 0.0664 - accuracy: 0.5968 8/11 [====================>.........] - ETA: 0s - loss: 0.0662 - accuracy: 0.5955 9/11 [=======================>......] - ETA: 0s - loss: 0.0659 - accuracy: 0.595010/11 [==========================>...] - ETA: 0s - loss: 0.0657 - accuracy: 0.595311/11 [==============================] - ETA: 0s - loss: 0.0657 - accuracy: 0.595011/11 [==============================] - 1s 112ms/step - loss: 0.0656 - accuracy: 0.5947
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0528 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 0s - loss: 0.0535 - accuracy: 0.6055 3/11 [=======>......................] - ETA: 0s - loss: 0.0548 - accuracy: 0.6042 4/11 [=========>....................] - ETA: 0s - loss: 0.0555 - accuracy: 0.6030 5/11 [============>.................] - ETA: 0s - loss: 0.0565 - accuracy: 0.6009 6/11 [===============>..............] - ETA: 0s - loss: 0.0573 - accuracy: 0.5977 7/11 [==================>...........] - ETA: 0s - loss: 0.0576 - accuracy: 0.5962 8/11 [====================>.........] - ETA: 0s - loss: 0.0579 - accuracy: 0.5939 9/11 [=======================>......] - ETA: 0s - loss: 0.0582 - accuracy: 0.592210/11 [==========================>...] - ETA: 0s - loss: 0.0585 - accuracy: 0.590811/11 [==============================] - ETA: 0s - loss: 0.0587 - accuracy: 0.589811/11 [==============================] - 1s 109ms/step - loss: 0.0588 - accuracy: 0.5890
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0548 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 0s - loss: 0.0548 - accuracy: 0.5977 3/11 [=======>......................] - ETA: 0s - loss: 0.0566 - accuracy: 0.6068 4/11 [=========>....................] - ETA: 0s - loss: 0.0572 - accuracy: 0.6157 5/11 [============>.................] - ETA: 0s - loss: 0.0575 - accuracy: 0.6207 6/11 [===============>..............] - ETA: 0s - loss: 0.0578 - accuracy: 0.6227 7/11 [==================>...........] - ETA: 0s - loss: 0.0578 - accuracy: 0.6232 8/11 [====================>.........] - ETA: 0s - loss: 0.0578 - accuracy: 0.6228 9/11 [=======================>......] - ETA: 0s - loss: 0.0578 - accuracy: 0.622410/11 [==========================>...] - ETA: 0s - loss: 0.0577 - accuracy: 0.622111/11 [==============================] - ETA: 0s - loss: 0.0576 - accuracy: 0.621811/11 [==============================] - 1s 108ms/step - loss: 0.0575 - accuracy: 0.6216
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0412 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 0s - loss: 0.0437 - accuracy: 0.6758 3/11 [=======>......................] - ETA: 0s - loss: 0.0456 - accuracy: 0.6667 4/11 [=========>....................] - ETA: 0s - loss: 0.0471 - accuracy: 0.6626 5/11 [============>.................] - ETA: 0s - loss: 0.0482 - accuracy: 0.6610 6/11 [===============>..............] - ETA: 0s - loss: 0.0490 - accuracy: 0.6611 7/11 [==================>...........] - ETA: 0s - loss: 0.0495 - accuracy: 0.6625 8/11 [====================>.........] - ETA: 0s - loss: 0.0500 - accuracy: 0.6635 9/11 [=======================>......] - ETA: 0s - loss: 0.0503 - accuracy: 0.665210/11 [==========================>...] - ETA: 0s - loss: 0.0506 - accuracy: 0.666311/11 [==============================] - ETA: 0s - loss: 0.0508 - accuracy: 0.667311/11 [==============================] - 1s 112ms/step - loss: 0.0509 - accuracy: 0.6682
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0482 - accuracy: 0.6797 2/11 [====>.........................] - ETA: 0s - loss: 0.0483 - accuracy: 0.6836 3/11 [=======>......................] - ETA: 0s - loss: 0.0481 - accuracy: 0.6875 4/11 [=========>....................] - ETA: 0s - loss: 0.0481 - accuracy: 0.6860 5/11 [============>.................] - ETA: 0s - loss: 0.0485 - accuracy: 0.6823 6/11 [===============>..............] - ETA: 0s - loss: 0.0487 - accuracy: 0.6797 7/11 [==================>...........] - ETA: 0s - loss: 0.0487 - accuracy: 0.6786 8/11 [====================>.........] - ETA: 0s - loss: 0.0487 - accuracy: 0.6767 9/11 [=======================>......] - ETA: 0s - loss: 0.0487 - accuracy: 0.674610/11 [==========================>...] - ETA: 0s - loss: 0.0488 - accuracy: 0.672411/11 [==============================] - ETA: 0s - loss: 0.0488 - accuracy: 0.670811/11 [==============================] - 1s 107ms/step - loss: 0.0488 - accuracy: 0.6694
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0446 - accuracy: 0.7500 2/11 [====>.........................] - ETA: 0s - loss: 0.0449 - accuracy: 0.7480 3/11 [=======>......................] - ETA: 0s - loss: 0.0456 - accuracy: 0.7496 4/11 [=========>....................] - ETA: 0s - loss: 0.0457 - accuracy: 0.7502 5/11 [============>.................] - ETA: 0s - loss: 0.0454 - accuracy: 0.7495 6/11 [===============>..............] - ETA: 0s - loss: 0.0453 - accuracy: 0.7487 7/11 [==================>...........] - ETA: 0s - loss: 0.0452 - accuracy: 0.7483 8/11 [====================>.........] - ETA: 0s - loss: 0.0453 - accuracy: 0.7492 9/11 [=======================>......] - ETA: 0s - loss: 0.0454 - accuracy: 0.750210/11 [==========================>...] - ETA: 0s - loss: 0.0455 - accuracy: 0.750511/11 [==============================] - ETA: 0s - loss: 0.0455 - accuracy: 0.750211/11 [==============================] - 1s 102ms/step - loss: 0.0456 - accuracy: 0.7499
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0467 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 0s - loss: 0.0444 - accuracy: 0.7695 3/11 [=======>......................] - ETA: 0s - loss: 0.0439 - accuracy: 0.7604 4/11 [=========>....................] - ETA: 0s - loss: 0.0432 - accuracy: 0.7563 5/11 [============>.................] - ETA: 0s - loss: 0.0427 - accuracy: 0.7491 6/11 [===============>..............] - ETA: 0s - loss: 0.0424 - accuracy: 0.7443 7/11 [==================>...........] - ETA: 0s - loss: 0.0424 - accuracy: 0.7408 8/11 [====================>.........] - ETA: 0s - loss: 0.0423 - accuracy: 0.7389 9/11 [=======================>......] - ETA: 0s - loss: 0.0423 - accuracy: 0.737010/11 [==========================>...] - ETA: 0s - loss: 0.0423 - accuracy: 0.736011/11 [==============================] - ETA: 0s - loss: 0.0423 - accuracy: 0.735311/11 [==============================] - 1s 112ms/step - loss: 0.0423 - accuracy: 0.7347
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0459 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.0453 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.0445 - accuracy: 0.7517 4/11 [=========>....................] - ETA: 0s - loss: 0.0438 - accuracy: 0.7533 5/11 [============>.................] - ETA: 0s - loss: 0.0434 - accuracy: 0.7551 6/11 [===============>..............] - ETA: 0s - loss: 0.0430 - accuracy: 0.7562 7/11 [==================>...........] - ETA: 0s - loss: 0.0427 - accuracy: 0.7568 8/11 [====================>.........] - ETA: 0s - loss: 0.0423 - accuracy: 0.7582 9/11 [=======================>......] - ETA: 0s - loss: 0.0420 - accuracy: 0.760510/11 [==========================>...] - ETA: 0s - loss: 0.0417 - accuracy: 0.762111/11 [==============================] - ETA: 0s - loss: 0.0416 - accuracy: 0.763111/11 [==============================] - 1s 110ms/step - loss: 0.0414 - accuracy: 0.7640
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0420 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.0404 - accuracy: 0.7676 3/11 [=======>......................] - ETA: 0s - loss: 0.0397 - accuracy: 0.7739 4/11 [=========>....................] - ETA: 0s - loss: 0.0395 - accuracy: 0.7777 5/11 [============>.................] - ETA: 0s - loss: 0.0394 - accuracy: 0.7803 6/11 [===============>..............] - ETA: 0s - loss: 0.0392 - accuracy: 0.7845 7/11 [==================>...........] - ETA: 0s - loss: 0.0389 - accuracy: 0.7889 8/11 [====================>.........] - ETA: 0s - loss: 0.0387 - accuracy: 0.7927 9/11 [=======================>......] - ETA: 0s - loss: 0.0385 - accuracy: 0.795810/11 [==========================>...] - ETA: 0s - loss: 0.0384 - accuracy: 0.798411/11 [==============================] - ETA: 0s - loss: 0.0382 - accuracy: 0.800611/11 [==============================] - 1s 103ms/step - loss: 0.0381 - accuracy: 0.8025
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0443 - accuracy: 0.7109 2/11 [====>.........................] - ETA: 0s - loss: 0.0418 - accuracy: 0.7246 3/11 [=======>......................] - ETA: 0s - loss: 0.0399 - accuracy: 0.7426 4/11 [=========>....................] - ETA: 0s - loss: 0.0389 - accuracy: 0.7542 5/11 [============>.................] - ETA: 0s - loss: 0.0381 - accuracy: 0.7637 6/11 [===============>..............] - ETA: 0s - loss: 0.0375 - accuracy: 0.7712 7/11 [==================>...........] - ETA: 0s - loss: 0.0372 - accuracy: 0.7777 8/11 [====================>.........] - ETA: 0s - loss: 0.0370 - accuracy: 0.7829 9/11 [=======================>......] - ETA: 0s - loss: 0.0367 - accuracy: 0.787710/11 [==========================>...] - ETA: 0s - loss: 0.0365 - accuracy: 0.791911/11 [==============================] - ETA: 0s - loss: 0.0363 - accuracy: 0.795311/11 [==============================] - 1s 106ms/step - loss: 0.0362 - accuracy: 0.7982
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0291 - accuracy: 0.8047 2/11 [====>.........................] - ETA: 0s - loss: 0.0309 - accuracy: 0.7988 3/11 [=======>......................] - ETA: 0s - loss: 0.0316 - accuracy: 0.7912 4/11 [=========>....................] - ETA: 0s - loss: 0.0317 - accuracy: 0.7897 5/11 [============>.................] - ETA: 0s - loss: 0.0317 - accuracy: 0.7896 6/11 [===============>..............] - ETA: 0s - loss: 0.0318 - accuracy: 0.7904 7/11 [==================>...........] - ETA: 0s - loss: 0.0318 - accuracy: 0.7926 8/11 [====================>.........] - ETA: 0s - loss: 0.0319 - accuracy: 0.7943 9/11 [=======================>......] - ETA: 0s - loss: 0.0319 - accuracy: 0.796510/11 [==========================>...] - ETA: 0s - loss: 0.0319 - accuracy: 0.799011/11 [==============================] - ETA: 0s - loss: 0.0320 - accuracy: 0.801711/11 [==============================] - 1s 112ms/step - loss: 0.0320 - accuracy: 0.8039
Evaluate on test data
1/6 [====>.........................] - ETA: 18s - loss: 0.0392 - accuracy: 0.83593/6 [==============>...............] - ETA: 0s - loss: 0.0370 - accuracy: 0.8750 5/6 [========================>.....] - ETA: 0s - loss: 0.0361 - accuracy: 0.86096/6 [==============================] - 4s 33ms/step - loss: 0.0361 - accuracy: 0.8626
2021-12-13 23:39:47.688843: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:39:47.689825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:39:47.689882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:39:47.689941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:39:47.689978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:39:47.690015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:39:47.690054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:39:47.690090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:39:47.690129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:39:47.690171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:39:47.691563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:39:47.691600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:39:47.691613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:39:47.691623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 4 1 3 2] pred: [0.87559664 0.35975653 0.01575014 0.15880582 0.45558923]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [0.01882711 0.87471473 0.7959898  0.00430793 0.0034878 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [0.00435606 0.03679839 0.93840784 0.02998787 0.00275496]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [0.01037198 0.86300236 0.8925856  0.0039587  0.00214678]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [0.00331682 0.07279366 0.95451164 0.02460206 0.00176269]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 4 2 3] pred: [0.69223845 0.3142414  0.06043068 0.02707884 0.11585051]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 2 4 0 1] pred: [0.01264051 0.00472343 0.22581688 0.70228875 0.13730463]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [0.01266748 0.8535676  0.79590786 0.00477475 0.00336987]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 4 3] pred: [0.02398545 0.9121711  0.7685996  0.00294849 0.00331905]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [0.00391051 0.10653171 0.9167852  0.0154396  0.00225389]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [0.00360808 0.05358413 0.94717574 0.02335957 0.00231123]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [0.00459337 0.42936695 0.94003826 0.0084129  0.00142741]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [0.00852132 0.8626554  0.9382162  0.00509188 0.00207597]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [0.01483494 0.8257241  0.8404819  0.00453404 0.00259086]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [4 3 0 2 1] pred: [0.09790748 0.0102973  0.0505349  0.40409318 0.52379113]
 Top predictions indices: [4 3] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:04 - loss: 0.2518 - accuracy: 0.0156 2/11 [====>.........................] - ETA: 0s - loss: 0.2511 - accuracy: 0.0508   3/11 [=======>......................] - ETA: 0s - loss: 0.2505 - accuracy: 0.0972 4/11 [=========>....................] - ETA: 0s - loss: 0.2498 - accuracy: 0.1393 5/11 [============>.................] - ETA: 0s - loss: 0.2491 - accuracy: 0.1724 6/11 [===============>..............] - ETA: 0s - loss: 0.2485 - accuracy: 0.1970 7/11 [==================>...........] - ETA: 0s - loss: 0.2479 - accuracy: 0.2175 8/11 [====================>.........] - ETA: 0s - loss: 0.2472 - accuracy: 0.2340 9/11 [=======================>......] - ETA: 0s - loss: 0.2466 - accuracy: 0.247710/11 [==========================>...] - ETA: 0s - loss: 0.2459 - accuracy: 0.259911/11 [==============================] - ETA: 0s - loss: 0.2453 - accuracy: 0.270911/11 [==============================] - 14s 104ms/step - loss: 0.2448 - accuracy: 0.2800
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2225 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.2212 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.2203 - accuracy: 0.4358 4/11 [=========>....................] - ETA: 0s - loss: 0.2195 - accuracy: 0.4367 5/11 [============>.................] - ETA: 0s - loss: 0.2188 - accuracy: 0.4353 6/11 [===============>..............] - ETA: 0s - loss: 0.2179 - accuracy: 0.4370 7/11 [==================>...........] - ETA: 0s - loss: 0.2171 - accuracy: 0.4383 8/11 [====================>.........] - ETA: 0s - loss: 0.2162 - accuracy: 0.4393 9/11 [=======================>......] - ETA: 0s - loss: 0.2153 - accuracy: 0.440310/11 [==========================>...] - ETA: 0s - loss: 0.2144 - accuracy: 0.441811/11 [==============================] - ETA: 0s - loss: 0.2134 - accuracy: 0.442811/11 [==============================] - 1s 100ms/step - loss: 0.2127 - accuracy: 0.4437
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1806 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.1800 - accuracy: 0.4512 3/11 [=======>......................] - ETA: 0s - loss: 0.1785 - accuracy: 0.4501 4/11 [=========>....................] - ETA: 0s - loss: 0.1769 - accuracy: 0.4499 5/11 [============>.................] - ETA: 0s - loss: 0.1751 - accuracy: 0.4530 6/11 [===============>..............] - ETA: 0s - loss: 0.1735 - accuracy: 0.4550 7/11 [==================>...........] - ETA: 0s - loss: 0.1719 - accuracy: 0.4555 8/11 [====================>.........] - ETA: 0s - loss: 0.1705 - accuracy: 0.4555 9/11 [=======================>......] - ETA: 0s - loss: 0.1690 - accuracy: 0.455410/11 [==========================>...] - ETA: 0s - loss: 0.1677 - accuracy: 0.455411/11 [==============================] - ETA: 0s - loss: 0.1664 - accuracy: 0.455211/11 [==============================] - 1s 111ms/step - loss: 0.1654 - accuracy: 0.4550
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1171 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.1154 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 1s - loss: 0.1159 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.1160 - accuracy: 0.4897 5/11 [============>.................] - ETA: 0s - loss: 0.1165 - accuracy: 0.4852 6/11 [===============>..............] - ETA: 0s - loss: 0.1168 - accuracy: 0.4808 7/11 [==================>...........] - ETA: 0s - loss: 0.1171 - accuracy: 0.4763 8/11 [====================>.........] - ETA: 0s - loss: 0.1173 - accuracy: 0.4723 9/11 [=======================>......] - ETA: 0s - loss: 0.1174 - accuracy: 0.469310/11 [==========================>...] - ETA: 0s - loss: 0.1175 - accuracy: 0.467411/11 [==============================] - ETA: 0s - loss: 0.1175 - accuracy: 0.466111/11 [==============================] - 1s 117ms/step - loss: 0.1174 - accuracy: 0.4650
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1146 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.1130 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.1112 - accuracy: 0.4384 4/11 [=========>....................] - ETA: 0s - loss: 0.1116 - accuracy: 0.4382 5/11 [============>.................] - ETA: 0s - loss: 0.1116 - accuracy: 0.4405 6/11 [===============>..............] - ETA: 0s - loss: 0.1115 - accuracy: 0.4441 7/11 [==================>...........] - ETA: 0s - loss: 0.1114 - accuracy: 0.4453 8/11 [====================>.........] - ETA: 0s - loss: 0.1112 - accuracy: 0.4455 9/11 [=======================>......] - ETA: 0s - loss: 0.1111 - accuracy: 0.446410/11 [==========================>...] - ETA: 0s - loss: 0.1108 - accuracy: 0.447011/11 [==============================] - ETA: 0s - loss: 0.1107 - accuracy: 0.447611/11 [==============================] - 1s 113ms/step - loss: 0.1105 - accuracy: 0.4481
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1129 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.1124 - accuracy: 0.4160 3/11 [=======>......................] - ETA: 1s - loss: 0.1115 - accuracy: 0.4180 4/11 [=========>....................] - ETA: 0s - loss: 0.1105 - accuracy: 0.4209 5/11 [============>.................] - ETA: 0s - loss: 0.1098 - accuracy: 0.4220 6/11 [===============>..............] - ETA: 0s - loss: 0.1097 - accuracy: 0.4222 7/11 [==================>...........] - ETA: 0s - loss: 0.1094 - accuracy: 0.4225 8/11 [====================>.........] - ETA: 0s - loss: 0.1090 - accuracy: 0.4228 9/11 [=======================>......] - ETA: 0s - loss: 0.1085 - accuracy: 0.424010/11 [==========================>...] - ETA: 0s - loss: 0.1081 - accuracy: 0.426211/11 [==============================] - ETA: 0s - loss: 0.1077 - accuracy: 0.428911/11 [==============================] - 1s 116ms/step - loss: 0.1074 - accuracy: 0.4311
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1087 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.1041 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.1018 - accuracy: 0.4462 4/11 [=========>....................] - ETA: 0s - loss: 0.1011 - accuracy: 0.4523 5/11 [============>.................] - ETA: 0s - loss: 0.1004 - accuracy: 0.4568 6/11 [===============>..............] - ETA: 0s - loss: 0.0998 - accuracy: 0.4599 7/11 [==================>...........] - ETA: 0s - loss: 0.0993 - accuracy: 0.4605 8/11 [====================>.........] - ETA: 0s - loss: 0.0990 - accuracy: 0.4610 9/11 [=======================>......] - ETA: 0s - loss: 0.0987 - accuracy: 0.460810/11 [==========================>...] - ETA: 0s - loss: 0.0985 - accuracy: 0.460511/11 [==============================] - ETA: 0s - loss: 0.0982 - accuracy: 0.460811/11 [==============================] - 1s 111ms/step - loss: 0.0980 - accuracy: 0.4610
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0945 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.0943 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.0940 - accuracy: 0.4410 4/11 [=========>....................] - ETA: 0s - loss: 0.0941 - accuracy: 0.4445 5/11 [============>.................] - ETA: 0s - loss: 0.0935 - accuracy: 0.4487 6/11 [===============>..............] - ETA: 0s - loss: 0.0928 - accuracy: 0.4521 7/11 [==================>...........] - ETA: 0s - loss: 0.0920 - accuracy: 0.4552 8/11 [====================>.........] - ETA: 0s - loss: 0.0913 - accuracy: 0.4585 9/11 [=======================>......] - ETA: 0s - loss: 0.0908 - accuracy: 0.460710/11 [==========================>...] - ETA: 0s - loss: 0.0903 - accuracy: 0.463011/11 [==============================] - ETA: 0s - loss: 0.0898 - accuracy: 0.464511/11 [==============================] - 1s 108ms/step - loss: 0.0895 - accuracy: 0.4658
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0835 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.0833 - accuracy: 0.4590 3/11 [=======>......................] - ETA: 0s - loss: 0.0819 - accuracy: 0.4744 4/11 [=========>....................] - ETA: 0s - loss: 0.0806 - accuracy: 0.4827 5/11 [============>.................] - ETA: 0s - loss: 0.0797 - accuracy: 0.4887 6/11 [===============>..............] - ETA: 0s - loss: 0.0788 - accuracy: 0.4923 7/11 [==================>...........] - ETA: 0s - loss: 0.0782 - accuracy: 0.4958 8/11 [====================>.........] - ETA: 0s - loss: 0.0777 - accuracy: 0.4974 9/11 [=======================>......] - ETA: 0s - loss: 0.0774 - accuracy: 0.498110/11 [==========================>...] - ETA: 0s - loss: 0.0771 - accuracy: 0.499511/11 [==============================] - ETA: 0s - loss: 0.0769 - accuracy: 0.500211/11 [==============================] - 1s 102ms/step - loss: 0.0767 - accuracy: 0.5008
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0770 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.0734 - accuracy: 0.5371 3/11 [=======>......................] - ETA: 0s - loss: 0.0720 - accuracy: 0.5412 4/11 [=========>....................] - ETA: 0s - loss: 0.0705 - accuracy: 0.5422 5/11 [============>.................] - ETA: 0s - loss: 0.0698 - accuracy: 0.5418 6/11 [===============>..............] - ETA: 0s - loss: 0.0694 - accuracy: 0.5405 7/11 [==================>...........] - ETA: 0s - loss: 0.0692 - accuracy: 0.5397 8/11 [====================>.........] - ETA: 0s - loss: 0.0689 - accuracy: 0.5403 9/11 [=======================>......] - ETA: 0s - loss: 0.0686 - accuracy: 0.540610/11 [==========================>...] - ETA: 0s - loss: 0.0683 - accuracy: 0.541311/11 [==============================] - ETA: 0s - loss: 0.0680 - accuracy: 0.542311/11 [==============================] - 1s 108ms/step - loss: 0.0678 - accuracy: 0.5432
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0588 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.0593 - accuracy: 0.5762 3/11 [=======>......................] - ETA: 0s - loss: 0.0600 - accuracy: 0.5872 4/11 [=========>....................] - ETA: 0s - loss: 0.0603 - accuracy: 0.5908 5/11 [============>.................] - ETA: 0s - loss: 0.0604 - accuracy: 0.5886 6/11 [===============>..............] - ETA: 0s - loss: 0.0603 - accuracy: 0.5892 7/11 [==================>...........] - ETA: 0s - loss: 0.0603 - accuracy: 0.5913 8/11 [====================>.........] - ETA: 0s - loss: 0.0602 - accuracy: 0.5935 9/11 [=======================>......] - ETA: 0s - loss: 0.0601 - accuracy: 0.594210/11 [==========================>...] - ETA: 0s - loss: 0.0599 - accuracy: 0.594611/11 [==============================] - ETA: 0s - loss: 0.0598 - accuracy: 0.595311/11 [==============================] - 1s 110ms/step - loss: 0.0597 - accuracy: 0.5959
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0570 - accuracy: 0.5859 2/11 [====>.........................] - ETA: 0s - loss: 0.0567 - accuracy: 0.6055 3/11 [=======>......................] - ETA: 0s - loss: 0.0563 - accuracy: 0.6111 4/11 [=========>....................] - ETA: 0s - loss: 0.0555 - accuracy: 0.6141 5/11 [============>.................] - ETA: 0s - loss: 0.0553 - accuracy: 0.6103 6/11 [===============>..............] - ETA: 0s - loss: 0.0550 - accuracy: 0.6110 7/11 [==================>...........] - ETA: 0s - loss: 0.0549 - accuracy: 0.6130 8/11 [====================>.........] - ETA: 0s - loss: 0.0548 - accuracy: 0.6148 9/11 [=======================>......] - ETA: 0s - loss: 0.0546 - accuracy: 0.616510/11 [==========================>...] - ETA: 0s - loss: 0.0544 - accuracy: 0.617711/11 [==============================] - ETA: 0s - loss: 0.0543 - accuracy: 0.618711/11 [==============================] - 1s 109ms/step - loss: 0.0542 - accuracy: 0.6194
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0552 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.0532 - accuracy: 0.6738 3/11 [=======>......................] - ETA: 0s - loss: 0.0529 - accuracy: 0.6749 4/11 [=========>....................] - ETA: 0s - loss: 0.0530 - accuracy: 0.6795 5/11 [============>.................] - ETA: 0s - loss: 0.0528 - accuracy: 0.6786 6/11 [===============>..............] - ETA: 0s - loss: 0.0524 - accuracy: 0.6773 7/11 [==================>...........] - ETA: 0s - loss: 0.0520 - accuracy: 0.6751 8/11 [====================>.........] - ETA: 0s - loss: 0.0517 - accuracy: 0.6721 9/11 [=======================>......] - ETA: 0s - loss: 0.0514 - accuracy: 0.670310/11 [==========================>...] - ETA: 0s - loss: 0.0512 - accuracy: 0.669411/11 [==============================] - ETA: 0s - loss: 0.0510 - accuracy: 0.668811/11 [==============================] - 1s 117ms/step - loss: 0.0507 - accuracy: 0.6682
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0448 - accuracy: 0.7031 2/11 [====>.........................] - ETA: 0s - loss: 0.0443 - accuracy: 0.7051 3/11 [=======>......................] - ETA: 0s - loss: 0.0436 - accuracy: 0.7010 4/11 [=========>....................] - ETA: 0s - loss: 0.0434 - accuracy: 0.6986 5/11 [============>.................] - ETA: 0s - loss: 0.0433 - accuracy: 0.6935 6/11 [===============>..............] - ETA: 0s - loss: 0.0433 - accuracy: 0.6917 7/11 [==================>...........] - ETA: 0s - loss: 0.0436 - accuracy: 0.6911 8/11 [====================>.........] - ETA: 0s - loss: 0.0438 - accuracy: 0.6910 9/11 [=======================>......] - ETA: 0s - loss: 0.0439 - accuracy: 0.691510/11 [==========================>...] - ETA: 0s - loss: 0.0440 - accuracy: 0.692511/11 [==============================] - ETA: 0s - loss: 0.0440 - accuracy: 0.693111/11 [==============================] - 1s 117ms/step - loss: 0.0441 - accuracy: 0.6937
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0405 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 1s - loss: 0.0390 - accuracy: 0.7441 3/11 [=======>......................] - ETA: 0s - loss: 0.0389 - accuracy: 0.7365 4/11 [=========>....................] - ETA: 0s - loss: 0.0392 - accuracy: 0.7277 5/11 [============>.................] - ETA: 0s - loss: 0.0394 - accuracy: 0.7218 6/11 [===============>..............] - ETA: 0s - loss: 0.0395 - accuracy: 0.7172 7/11 [==================>...........] - ETA: 0s - loss: 0.0398 - accuracy: 0.7138 8/11 [====================>.........] - ETA: 0s - loss: 0.0399 - accuracy: 0.7113 9/11 [=======================>......] - ETA: 0s - loss: 0.0400 - accuracy: 0.710310/11 [==========================>...] - ETA: 0s - loss: 0.0401 - accuracy: 0.709811/11 [==============================] - ETA: 0s - loss: 0.0403 - accuracy: 0.709911/11 [==============================] - 1s 108ms/step - loss: 0.0403 - accuracy: 0.7100
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0432 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.0416 - accuracy: 0.7227 3/11 [=======>......................] - ETA: 0s - loss: 0.0405 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.0398 - accuracy: 0.7329 5/11 [============>.................] - ETA: 0s - loss: 0.0397 - accuracy: 0.7391 6/11 [===============>..............] - ETA: 0s - loss: 0.0396 - accuracy: 0.7442 7/11 [==================>...........] - ETA: 0s - loss: 0.0395 - accuracy: 0.7493 8/11 [====================>.........] - ETA: 0s - loss: 0.0394 - accuracy: 0.7538 9/11 [=======================>......] - ETA: 0s - loss: 0.0393 - accuracy: 0.757510/11 [==========================>...] - ETA: 0s - loss: 0.0392 - accuracy: 0.760211/11 [==============================] - ETA: 0s - loss: 0.0391 - accuracy: 0.761711/11 [==============================] - 1s 106ms/step - loss: 0.0391 - accuracy: 0.7629
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0310 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.0327 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.0341 - accuracy: 0.7717 4/11 [=========>....................] - ETA: 0s - loss: 0.0348 - accuracy: 0.7619 5/11 [============>.................] - ETA: 0s - loss: 0.0352 - accuracy: 0.7579 6/11 [===============>..............] - ETA: 0s - loss: 0.0355 - accuracy: 0.7553 7/11 [==================>...........] - ETA: 0s - loss: 0.0358 - accuracy: 0.7536 8/11 [====================>.........] - ETA: 0s - loss: 0.0359 - accuracy: 0.7524 9/11 [=======================>......] - ETA: 0s - loss: 0.0360 - accuracy: 0.751210/11 [==========================>...] - ETA: 0s - loss: 0.0360 - accuracy: 0.750211/11 [==============================] - ETA: 0s - loss: 0.0360 - accuracy: 0.749511/11 [==============================] - 1s 110ms/step - loss: 0.0361 - accuracy: 0.7490
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0357 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 1s - loss: 0.0349 - accuracy: 0.7441 3/11 [=======>......................] - ETA: 0s - loss: 0.0348 - accuracy: 0.7496 4/11 [=========>....................] - ETA: 0s - loss: 0.0351 - accuracy: 0.7555 5/11 [============>.................] - ETA: 0s - loss: 0.0353 - accuracy: 0.7588 6/11 [===============>..............] - ETA: 0s - loss: 0.0352 - accuracy: 0.7625 7/11 [==================>...........] - ETA: 0s - loss: 0.0352 - accuracy: 0.7657 8/11 [====================>.........] - ETA: 0s - loss: 0.0350 - accuracy: 0.7690 9/11 [=======================>......] - ETA: 0s - loss: 0.0350 - accuracy: 0.771010/11 [==========================>...] - ETA: 0s - loss: 0.0349 - accuracy: 0.773311/11 [==============================] - ETA: 0s - loss: 0.0349 - accuracy: 0.774811/11 [==============================] - 1s 104ms/step - loss: 0.0349 - accuracy: 0.7761
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0308 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 0s - loss: 0.0301 - accuracy: 0.8047 3/11 [=======>......................] - ETA: 0s - loss: 0.0300 - accuracy: 0.7951 4/11 [=========>....................] - ETA: 0s - loss: 0.0304 - accuracy: 0.7887 5/11 [============>.................] - ETA: 0s - loss: 0.0307 - accuracy: 0.7851 6/11 [===============>..............] - ETA: 0s - loss: 0.0310 - accuracy: 0.7831 7/11 [==================>...........] - ETA: 0s - loss: 0.0312 - accuracy: 0.7817 8/11 [====================>.........] - ETA: 0s - loss: 0.0314 - accuracy: 0.7808 9/11 [=======================>......] - ETA: 0s - loss: 0.0316 - accuracy: 0.780410/11 [==========================>...] - ETA: 0s - loss: 0.0318 - accuracy: 0.780511/11 [==============================] - ETA: 0s - loss: 0.0319 - accuracy: 0.780611/11 [==============================] - 1s 104ms/step - loss: 0.0320 - accuracy: 0.7806
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0279 - accuracy: 0.8594 2/11 [====>.........................] - ETA: 0s - loss: 0.0279 - accuracy: 0.8477 3/11 [=======>......................] - ETA: 0s - loss: 0.0286 - accuracy: 0.8420 4/11 [=========>....................] - ETA: 0s - loss: 0.0290 - accuracy: 0.8371 5/11 [============>.................] - ETA: 0s - loss: 0.0293 - accuracy: 0.8356 6/11 [===============>..............] - ETA: 0s - loss: 0.0296 - accuracy: 0.8331 7/11 [==================>...........] - ETA: 0s - loss: 0.0299 - accuracy: 0.8308 8/11 [====================>.........] - ETA: 0s - loss: 0.0301 - accuracy: 0.8285 9/11 [=======================>......] - ETA: 0s - loss: 0.0302 - accuracy: 0.826610/11 [==========================>...] - ETA: 0s - loss: 0.0303 - accuracy: 0.825011/11 [==============================] - ETA: 0s - loss: 0.0304 - accuracy: 0.823611/11 [==============================] - 1s 112ms/step - loss: 0.0305 - accuracy: 0.8224
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0317 - accuracy: 0.82033/6 [==============>...............] - ETA: 0s - loss: 0.0336 - accuracy: 0.8047 5/6 [========================>.....] - ETA: 0s - loss: 0.0332 - accuracy: 0.81096/6 [==============================] - 4s 33ms/step - loss: 0.0323 - accuracy: 0.8116
2021-12-13 23:40:36.138454: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:40:36.139266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:40:36.139312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:40:36.139353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:40:36.139385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:40:36.139413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:40:36.139446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:40:36.139475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:40:36.139506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:40:36.139538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:40:36.140682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:40:36.140711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:40:36.140721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:40:36.140729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [1.3126135e-03 3.6074072e-02 9.4359916e-01 1.2140274e-02 5.7372451e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [4 3 0 2 1] pred: [0.21015811 0.01359484 0.0502198  0.39451605 0.9052867 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [0.00692862 0.4480009  0.9599843  0.02778077 0.00204122]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [1.7805994e-03 3.9809883e-02 9.6498716e-01 1.7700613e-02 6.3937902e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [0.04274532 0.5234446  0.7890957  0.11603487 0.01742655]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [1.0934472e-03 3.2047272e-02 9.5103073e-01 1.0265291e-02 4.8956275e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [1.3470054e-03 3.4209132e-02 9.5581591e-01 1.4422685e-02 4.9650669e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [2.1235347e-03 6.7700297e-02 9.2754662e-01 1.4926791e-02 4.7847629e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [1.0989904e-03 3.2167107e-02 9.4938743e-01 9.9590123e-03 5.4317713e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [0.04555053 0.78100514 0.72551787 0.00835204 0.00578865]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [0.04502296 0.90494204 0.8303262  0.01278651 0.00751722]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 4 3] pred: [0.2043545  0.53614664 0.33942974 0.00389826 0.00692695]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.04566473 0.90197134 0.8304558  0.01390129 0.00803652]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [1.9639730e-03 2.9189944e-02 9.6840763e-01 2.3475975e-02 7.1167946e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [0 1 4 2 3] pred: [0.72302485 0.32982004 0.05680487 0.0265708  0.07641596]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:56 - loss: 0.2506 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.2500 - accuracy: 0.4355   3/11 [=======>......................] - ETA: 0s - loss: 0.2493 - accuracy: 0.4457 4/11 [=========>....................] - ETA: 0s - loss: 0.2485 - accuracy: 0.4520 5/11 [============>.................] - ETA: 0s - loss: 0.2478 - accuracy: 0.4578 6/11 [===============>..............] - ETA: 0s - loss: 0.2471 - accuracy: 0.4616 7/11 [==================>...........] - ETA: 0s - loss: 0.2464 - accuracy: 0.4628 8/11 [====================>.........] - ETA: 0s - loss: 0.2457 - accuracy: 0.4629 9/11 [=======================>......] - ETA: 0s - loss: 0.2450 - accuracy: 0.463510/11 [==========================>...] - ETA: 0s - loss: 0.2443 - accuracy: 0.463811/11 [==============================] - ETA: 0s - loss: 0.2436 - accuracy: 0.463511/11 [==============================] - 13s 107ms/step - loss: 0.2431 - accuracy: 0.4633
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2184 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.2173 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.2163 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.2155 - accuracy: 0.4453 5/11 [============>.................] - ETA: 0s - loss: 0.2146 - accuracy: 0.4456 6/11 [===============>..............] - ETA: 0s - loss: 0.2137 - accuracy: 0.4456 7/11 [==================>...........] - ETA: 0s - loss: 0.2128 - accuracy: 0.4452 8/11 [====================>.........] - ETA: 0s - loss: 0.2118 - accuracy: 0.4446 9/11 [=======================>......] - ETA: 0s - loss: 0.2109 - accuracy: 0.444310/11 [==========================>...] - ETA: 0s - loss: 0.2099 - accuracy: 0.444411/11 [==============================] - ETA: 0s - loss: 0.2090 - accuracy: 0.444911/11 [==============================] - 1s 106ms/step - loss: 0.2082 - accuracy: 0.4454
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1670 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 0s - loss: 0.1687 - accuracy: 0.5137 3/11 [=======>......................] - ETA: 0s - loss: 0.1684 - accuracy: 0.5022 4/11 [=========>....................] - ETA: 0s - loss: 0.1678 - accuracy: 0.4924 5/11 [============>.................] - ETA: 0s - loss: 0.1667 - accuracy: 0.4864 6/11 [===============>..............] - ETA: 0s - loss: 0.1656 - accuracy: 0.4821 7/11 [==================>...........] - ETA: 0s - loss: 0.1643 - accuracy: 0.4796 8/11 [====================>.........] - ETA: 0s - loss: 0.1630 - accuracy: 0.4779 9/11 [=======================>......] - ETA: 0s - loss: 0.1619 - accuracy: 0.475510/11 [==========================>...] - ETA: 0s - loss: 0.1607 - accuracy: 0.473511/11 [==============================] - ETA: 0s - loss: 0.1596 - accuracy: 0.471411/11 [==============================] - 1s 103ms/step - loss: 0.1587 - accuracy: 0.4696
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1093 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 1s - loss: 0.1135 - accuracy: 0.5254 3/11 [=======>......................] - ETA: 0s - loss: 0.1152 - accuracy: 0.5048 4/11 [=========>....................] - ETA: 0s - loss: 0.1160 - accuracy: 0.4933 5/11 [============>.................] - ETA: 0s - loss: 0.1162 - accuracy: 0.4868 6/11 [===============>..............] - ETA: 0s - loss: 0.1164 - accuracy: 0.4819 7/11 [==================>...........] - ETA: 0s - loss: 0.1167 - accuracy: 0.4778 8/11 [====================>.........] - ETA: 0s - loss: 0.1170 - accuracy: 0.4746 9/11 [=======================>......] - ETA: 0s - loss: 0.1173 - accuracy: 0.471810/11 [==========================>...] - ETA: 0s - loss: 0.1174 - accuracy: 0.469311/11 [==============================] - ETA: 0s - loss: 0.1175 - accuracy: 0.467611/11 [==============================] - 1s 110ms/step - loss: 0.1176 - accuracy: 0.4661
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1117 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.1124 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.1127 - accuracy: 0.4523 4/11 [=========>....................] - ETA: 0s - loss: 0.1132 - accuracy: 0.4510 5/11 [============>.................] - ETA: 0s - loss: 0.1129 - accuracy: 0.4539 6/11 [===============>..............] - ETA: 0s - loss: 0.1126 - accuracy: 0.4564 7/11 [==================>...........] - ETA: 0s - loss: 0.1124 - accuracy: 0.4575 8/11 [====================>.........] - ETA: 0s - loss: 0.1126 - accuracy: 0.4577 9/11 [=======================>......] - ETA: 0s - loss: 0.1128 - accuracy: 0.457110/11 [==========================>...] - ETA: 0s - loss: 0.1128 - accuracy: 0.456511/11 [==============================] - ETA: 0s - loss: 0.1128 - accuracy: 0.455911/11 [==============================] - 1s 113ms/step - loss: 0.1128 - accuracy: 0.4554
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1217 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.1171 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.1147 - accuracy: 0.4714 4/11 [=========>....................] - ETA: 0s - loss: 0.1136 - accuracy: 0.4717 5/11 [============>.................] - ETA: 0s - loss: 0.1130 - accuracy: 0.4686 6/11 [===============>..............] - ETA: 0s - loss: 0.1123 - accuracy: 0.4656 7/11 [==================>...........] - ETA: 0s - loss: 0.1118 - accuracy: 0.4638 8/11 [====================>.........] - ETA: 0s - loss: 0.1113 - accuracy: 0.4633 9/11 [=======================>......] - ETA: 0s - loss: 0.1107 - accuracy: 0.463210/11 [==========================>...] - ETA: 0s - loss: 0.1104 - accuracy: 0.462211/11 [==============================] - ETA: 0s - loss: 0.1102 - accuracy: 0.461111/11 [==============================] - 1s 112ms/step - loss: 0.1101 - accuracy: 0.4602
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1111 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.1069 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.1053 - accuracy: 0.4583 4/11 [=========>....................] - ETA: 0s - loss: 0.1040 - accuracy: 0.4609 5/11 [============>.................] - ETA: 0s - loss: 0.1033 - accuracy: 0.4613 6/11 [===============>..............] - ETA: 0s - loss: 0.1033 - accuracy: 0.4595 7/11 [==================>...........] - ETA: 0s - loss: 0.1033 - accuracy: 0.4571 8/11 [====================>.........] - ETA: 0s - loss: 0.1032 - accuracy: 0.4558 9/11 [=======================>......] - ETA: 0s - loss: 0.1030 - accuracy: 0.455710/11 [==========================>...] - ETA: 0s - loss: 0.1028 - accuracy: 0.455711/11 [==============================] - ETA: 0s - loss: 0.1026 - accuracy: 0.455911/11 [==============================] - 1s 112ms/step - loss: 0.1025 - accuracy: 0.4560
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0960 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.0962 - accuracy: 0.4434 3/11 [=======>......................] - ETA: 1s - loss: 0.0964 - accuracy: 0.4466 4/11 [=========>....................] - ETA: 0s - loss: 0.0961 - accuracy: 0.4492 5/11 [============>.................] - ETA: 0s - loss: 0.0957 - accuracy: 0.4519 6/11 [===============>..............] - ETA: 0s - loss: 0.0957 - accuracy: 0.4519 7/11 [==================>...........] - ETA: 0s - loss: 0.0954 - accuracy: 0.4540 8/11 [====================>.........] - ETA: 0s - loss: 0.0950 - accuracy: 0.4551 9/11 [=======================>......] - ETA: 0s - loss: 0.0947 - accuracy: 0.456410/11 [==========================>...] - ETA: 0s - loss: 0.0945 - accuracy: 0.456811/11 [==============================] - ETA: 0s - loss: 0.0943 - accuracy: 0.457611/11 [==============================] - 1s 109ms/step - loss: 0.0941 - accuracy: 0.4583
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0804 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.0832 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.0840 - accuracy: 0.4583 4/11 [=========>....................] - ETA: 0s - loss: 0.0844 - accuracy: 0.4575 5/11 [============>.................] - ETA: 0s - loss: 0.0844 - accuracy: 0.4620 6/11 [===============>..............] - ETA: 0s - loss: 0.0844 - accuracy: 0.4659 7/11 [==================>...........] - ETA: 0s - loss: 0.0842 - accuracy: 0.4701 8/11 [====================>.........] - ETA: 0s - loss: 0.0841 - accuracy: 0.4722 9/11 [=======================>......] - ETA: 0s - loss: 0.0840 - accuracy: 0.474310/11 [==========================>...] - ETA: 0s - loss: 0.0837 - accuracy: 0.476111/11 [==============================] - ETA: 0s - loss: 0.0835 - accuracy: 0.478111/11 [==============================] - 1s 113ms/step - loss: 0.0833 - accuracy: 0.4797
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0738 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 1s - loss: 0.0755 - accuracy: 0.5371 3/11 [=======>......................] - ETA: 0s - loss: 0.0756 - accuracy: 0.5299 4/11 [=========>....................] - ETA: 0s - loss: 0.0757 - accuracy: 0.5322 5/11 [============>.................] - ETA: 0s - loss: 0.0752 - accuracy: 0.5358 6/11 [===============>..............] - ETA: 0s - loss: 0.0747 - accuracy: 0.5361 7/11 [==================>...........] - ETA: 0s - loss: 0.0744 - accuracy: 0.5381 8/11 [====================>.........] - ETA: 0s - loss: 0.0740 - accuracy: 0.5397 9/11 [=======================>......] - ETA: 0s - loss: 0.0738 - accuracy: 0.541310/11 [==========================>...] - ETA: 0s - loss: 0.0735 - accuracy: 0.541811/11 [==============================] - ETA: 0s - loss: 0.0733 - accuracy: 0.542011/11 [==============================] - 1s 109ms/step - loss: 0.0731 - accuracy: 0.5422
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0649 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.0629 - accuracy: 0.6055 3/11 [=======>......................] - ETA: 0s - loss: 0.0626 - accuracy: 0.6059 4/11 [=========>....................] - ETA: 0s - loss: 0.0626 - accuracy: 0.6048 5/11 [============>.................] - ETA: 0s - loss: 0.0625 - accuracy: 0.6039 6/11 [===============>..............] - ETA: 0s - loss: 0.0626 - accuracy: 0.6028 7/11 [==================>...........] - ETA: 0s - loss: 0.0628 - accuracy: 0.5995 8/11 [====================>.........] - ETA: 0s - loss: 0.0629 - accuracy: 0.5967 9/11 [=======================>......] - ETA: 0s - loss: 0.0630 - accuracy: 0.593810/11 [==========================>...] - ETA: 0s - loss: 0.0631 - accuracy: 0.591911/11 [==============================] - ETA: 0s - loss: 0.0631 - accuracy: 0.590611/11 [==============================] - 1s 102ms/step - loss: 0.0632 - accuracy: 0.5895
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0598 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.0620 - accuracy: 0.5977 3/11 [=======>......................] - ETA: 0s - loss: 0.0615 - accuracy: 0.6042 4/11 [=========>....................] - ETA: 0s - loss: 0.0616 - accuracy: 0.6079 5/11 [============>.................] - ETA: 0s - loss: 0.0612 - accuracy: 0.6076 6/11 [===============>..............] - ETA: 0s - loss: 0.0606 - accuracy: 0.6074 7/11 [==================>...........] - ETA: 0s - loss: 0.0602 - accuracy: 0.6063 8/11 [====================>.........] - ETA: 0s - loss: 0.0599 - accuracy: 0.6061 9/11 [=======================>......] - ETA: 0s - loss: 0.0597 - accuracy: 0.606110/11 [==========================>...] - ETA: 0s - loss: 0.0595 - accuracy: 0.605811/11 [==============================] - ETA: 0s - loss: 0.0593 - accuracy: 0.605311/11 [==============================] - 1s 114ms/step - loss: 0.0592 - accuracy: 0.6048
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0580 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 1s - loss: 0.0577 - accuracy: 0.6211 3/11 [=======>......................] - ETA: 0s - loss: 0.0571 - accuracy: 0.6189 4/11 [=========>....................] - ETA: 0s - loss: 0.0562 - accuracy: 0.6170 5/11 [============>.................] - ETA: 0s - loss: 0.0557 - accuracy: 0.6127 6/11 [===============>..............] - ETA: 0s - loss: 0.0555 - accuracy: 0.6106 7/11 [==================>...........] - ETA: 0s - loss: 0.0551 - accuracy: 0.6106 8/11 [====================>.........] - ETA: 0s - loss: 0.0549 - accuracy: 0.6109 9/11 [=======================>......] - ETA: 0s - loss: 0.0547 - accuracy: 0.610810/11 [==========================>...] - ETA: 0s - loss: 0.0545 - accuracy: 0.610911/11 [==============================] - ETA: 0s - loss: 0.0543 - accuracy: 0.611211/11 [==============================] - 1s 119ms/step - loss: 0.0541 - accuracy: 0.6114
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0490 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.0465 - accuracy: 0.5820 3/11 [=======>......................] - ETA: 0s - loss: 0.0458 - accuracy: 0.5790 4/11 [=========>....................] - ETA: 0s - loss: 0.0459 - accuracy: 0.5846 5/11 [============>.................] - ETA: 0s - loss: 0.0460 - accuracy: 0.5921 6/11 [===============>..............] - ETA: 0s - loss: 0.0462 - accuracy: 0.5987 7/11 [==================>...........] - ETA: 0s - loss: 0.0464 - accuracy: 0.6034 8/11 [====================>.........] - ETA: 0s - loss: 0.0464 - accuracy: 0.6075 9/11 [=======================>......] - ETA: 0s - loss: 0.0465 - accuracy: 0.611510/11 [==========================>...] - ETA: 0s - loss: 0.0467 - accuracy: 0.615011/11 [==============================] - ETA: 0s - loss: 0.0468 - accuracy: 0.618311/11 [==============================] - 1s 108ms/step - loss: 0.0469 - accuracy: 0.6211
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0551 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 1s - loss: 0.0530 - accuracy: 0.6523 3/11 [=======>......................] - ETA: 0s - loss: 0.0516 - accuracy: 0.6528 4/11 [=========>....................] - ETA: 0s - loss: 0.0503 - accuracy: 0.6546 5/11 [============>.................] - ETA: 0s - loss: 0.0497 - accuracy: 0.6553 6/11 [===============>..............] - ETA: 0s - loss: 0.0490 - accuracy: 0.6554 7/11 [==================>...........] - ETA: 0s - loss: 0.0485 - accuracy: 0.6554 8/11 [====================>.........] - ETA: 0s - loss: 0.0481 - accuracy: 0.6571 9/11 [=======================>......] - ETA: 0s - loss: 0.0478 - accuracy: 0.658510/11 [==========================>...] - ETA: 0s - loss: 0.0475 - accuracy: 0.660211/11 [==============================] - ETA: 0s - loss: 0.0472 - accuracy: 0.661811/11 [==============================] - 1s 119ms/step - loss: 0.0470 - accuracy: 0.6632
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0492 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 1s - loss: 0.0498 - accuracy: 0.6777 3/11 [=======>......................] - ETA: 0s - loss: 0.0500 - accuracy: 0.6758 4/11 [=========>....................] - ETA: 0s - loss: 0.0493 - accuracy: 0.6787 5/11 [============>.................] - ETA: 0s - loss: 0.0485 - accuracy: 0.6830 6/11 [===============>..............] - ETA: 0s - loss: 0.0477 - accuracy: 0.6870 7/11 [==================>...........] - ETA: 0s - loss: 0.0472 - accuracy: 0.6899 8/11 [====================>.........] - ETA: 0s - loss: 0.0467 - accuracy: 0.6922 9/11 [=======================>......] - ETA: 0s - loss: 0.0462 - accuracy: 0.694010/11 [==========================>...] - ETA: 0s - loss: 0.0458 - accuracy: 0.696511/11 [==============================] - ETA: 0s - loss: 0.0455 - accuracy: 0.698611/11 [==============================] - 1s 114ms/step - loss: 0.0452 - accuracy: 0.7003
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0440 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 1s - loss: 0.0425 - accuracy: 0.7461 3/11 [=======>......................] - ETA: 0s - loss: 0.0419 - accuracy: 0.7405 4/11 [=========>....................] - ETA: 0s - loss: 0.0413 - accuracy: 0.7414 5/11 [============>.................] - ETA: 0s - loss: 0.0411 - accuracy: 0.7431 6/11 [===============>..............] - ETA: 0s - loss: 0.0410 - accuracy: 0.7447 7/11 [==================>...........] - ETA: 0s - loss: 0.0409 - accuracy: 0.7464 8/11 [====================>.........] - ETA: 0s - loss: 0.0407 - accuracy: 0.7481 9/11 [=======================>......] - ETA: 0s - loss: 0.0405 - accuracy: 0.748610/11 [==========================>...] - ETA: 0s - loss: 0.0404 - accuracy: 0.748511/11 [==============================] - ETA: 0s - loss: 0.0404 - accuracy: 0.748411/11 [==============================] - 1s 117ms/step - loss: 0.0403 - accuracy: 0.7484
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0338 - accuracy: 0.7109 2/11 [====>.........................] - ETA: 0s - loss: 0.0355 - accuracy: 0.7246 3/11 [=======>......................] - ETA: 0s - loss: 0.0363 - accuracy: 0.7287 4/11 [=========>....................] - ETA: 0s - loss: 0.0366 - accuracy: 0.7311 5/11 [============>.................] - ETA: 0s - loss: 0.0368 - accuracy: 0.7321 6/11 [===============>..............] - ETA: 0s - loss: 0.0371 - accuracy: 0.7322 7/11 [==================>...........] - ETA: 0s - loss: 0.0372 - accuracy: 0.7326 8/11 [====================>.........] - ETA: 0s - loss: 0.0373 - accuracy: 0.7329 9/11 [=======================>......] - ETA: 0s - loss: 0.0373 - accuracy: 0.733710/11 [==========================>...] - ETA: 0s - loss: 0.0374 - accuracy: 0.735111/11 [==============================] - ETA: 0s - loss: 0.0373 - accuracy: 0.736111/11 [==============================] - 1s 113ms/step - loss: 0.0373 - accuracy: 0.7371
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0373 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 1s - loss: 0.0354 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.0343 - accuracy: 0.7717 4/11 [=========>....................] - ETA: 0s - loss: 0.0338 - accuracy: 0.7770 5/11 [============>.................] - ETA: 0s - loss: 0.0335 - accuracy: 0.7819 6/11 [===============>..............] - ETA: 0s - loss: 0.0335 - accuracy: 0.7838 7/11 [==================>...........] - ETA: 0s - loss: 0.0337 - accuracy: 0.7855 8/11 [====================>.........] - ETA: 0s - loss: 0.0338 - accuracy: 0.7868 9/11 [=======================>......] - ETA: 0s - loss: 0.0339 - accuracy: 0.787910/11 [==========================>...] - ETA: 0s - loss: 0.0341 - accuracy: 0.789011/11 [==============================] - ETA: 0s - loss: 0.0342 - accuracy: 0.790511/11 [==============================] - 1s 116ms/step - loss: 0.0342 - accuracy: 0.7917
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0325 - accuracy: 0.8203 2/11 [====>.........................] - ETA: 0s - loss: 0.0328 - accuracy: 0.8145 3/11 [=======>......................] - ETA: 0s - loss: 0.0328 - accuracy: 0.8155 4/11 [=========>....................] - ETA: 0s - loss: 0.0330 - accuracy: 0.8162 5/11 [============>.................] - ETA: 0s - loss: 0.0332 - accuracy: 0.8174 6/11 [===============>..............] - ETA: 0s - loss: 0.0333 - accuracy: 0.8194 7/11 [==================>...........] - ETA: 0s - loss: 0.0335 - accuracy: 0.8211 8/11 [====================>.........] - ETA: 0s - loss: 0.0335 - accuracy: 0.8233 9/11 [=======================>......] - ETA: 0s - loss: 0.0335 - accuracy: 0.825410/11 [==========================>...] - ETA: 0s - loss: 0.0335 - accuracy: 0.826911/11 [==============================] - ETA: 0s - loss: 0.0334 - accuracy: 0.828211/11 [==============================] - 1s 111ms/step - loss: 0.0334 - accuracy: 0.8292
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0355 - accuracy: 0.78123/6 [==============>...............] - ETA: 0s - loss: 0.0332 - accuracy: 0.8177 5/6 [========================>.....] - ETA: 0s - loss: 0.0321 - accuracy: 0.83596/6 [==============================] - 4s 39ms/step - loss: 0.0338 - accuracy: 0.8272
2021-12-13 23:41:25.462911: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:41:25.464040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:41:25.464105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:41:25.464173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:41:25.464218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:41:25.464274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:41:25.464329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:41:25.464373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:41:25.464422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:41:25.464470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:41:25.466112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:41:25.466158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:41:25.466173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:41:25.466185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [0.02318338 0.81257284 0.83478916 0.01923367 0.00284755]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [6.5463781e-04 4.5391828e-02 9.4900298e-01 1.8625230e-02 9.6648932e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [1.3318360e-03 1.0341415e-01 9.7344100e-01 3.2431126e-02 8.8223815e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [6.9245696e-04 5.5618227e-02 9.5060766e-01 1.7119765e-02 1.3683736e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [5.8141351e-04 4.3056190e-02 9.6084380e-01 1.8131137e-02 1.1083782e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 2 0 1] pred: [0.01098585 0.00889632 0.12869903 0.7814116  0.13357979]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [5.1659346e-04 4.2626351e-02 9.6517718e-01 1.9320458e-02 9.5817447e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [0.03138825 0.822083   0.7840489  0.01609528 0.00333399]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [0.00354552 0.15159422 0.85910505 0.06225178 0.00251877]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 4 2 0 1] pred: [0.02639863 0.01346874 0.08148798 0.78788006 0.22568524]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [5.5497885e-04 4.7493339e-02 9.6063638e-01 1.9102246e-02 8.6835027e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [6.9007277e-04 5.0174177e-02 9.5079434e-01 1.9014716e-02 8.6069107e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 2 0 1] pred: [0.01197875 0.00872409 0.12148705 0.7767237  0.14844075]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [0.02878892 0.8658066  0.8310001  0.01840729 0.00261432]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [5.7828426e-04 4.4948071e-02 9.5911026e-01 1.9358456e-02 1.0415614e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:05 - loss: 0.2519 - accuracy: 0.0469 2/11 [====>.........................] - ETA: 1s - loss: 0.2512 - accuracy: 0.1426   3/11 [=======>......................] - ETA: 1s - loss: 0.2505 - accuracy: 0.2062 4/11 [=========>....................] - ETA: 0s - loss: 0.2498 - accuracy: 0.2450 5/11 [============>.................] - ETA: 0s - loss: 0.2491 - accuracy: 0.2728 6/11 [===============>..............] - ETA: 0s - loss: 0.2485 - accuracy: 0.2944 7/11 [==================>...........] - ETA: 0s - loss: 0.2478 - accuracy: 0.3115 8/11 [====================>.........] - ETA: 0s - loss: 0.2471 - accuracy: 0.3246 9/11 [=======================>......] - ETA: 0s - loss: 0.2464 - accuracy: 0.335510/11 [==========================>...] - ETA: 0s - loss: 0.2457 - accuracy: 0.344911/11 [==============================] - ETA: 0s - loss: 0.2451 - accuracy: 0.353411/11 [==============================] - 14s 115ms/step - loss: 0.2445 - accuracy: 0.3605
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2228 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.2215 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.2205 - accuracy: 0.4557 4/11 [=========>....................] - ETA: 0s - loss: 0.2196 - accuracy: 0.4600 5/11 [============>.................] - ETA: 0s - loss: 0.2187 - accuracy: 0.4598 6/11 [===============>..............] - ETA: 0s - loss: 0.2176 - accuracy: 0.4611 7/11 [==================>...........] - ETA: 0s - loss: 0.2166 - accuracy: 0.4625 8/11 [====================>.........] - ETA: 0s - loss: 0.2155 - accuracy: 0.4638 9/11 [=======================>......] - ETA: 0s - loss: 0.2144 - accuracy: 0.464710/11 [==========================>...] - ETA: 0s - loss: 0.2134 - accuracy: 0.465711/11 [==============================] - ETA: 0s - loss: 0.2124 - accuracy: 0.466111/11 [==============================] - 1s 107ms/step - loss: 0.2116 - accuracy: 0.4664
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1786 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.1776 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.1760 - accuracy: 0.4661 4/11 [=========>....................] - ETA: 0s - loss: 0.1744 - accuracy: 0.4712 5/11 [============>.................] - ETA: 0s - loss: 0.1728 - accuracy: 0.4741 6/11 [===============>..............] - ETA: 0s - loss: 0.1713 - accuracy: 0.4761 7/11 [==================>...........] - ETA: 0s - loss: 0.1699 - accuracy: 0.4771 8/11 [====================>.........] - ETA: 0s - loss: 0.1685 - accuracy: 0.4778 9/11 [=======================>......] - ETA: 0s - loss: 0.1671 - accuracy: 0.478010/11 [==========================>...] - ETA: 0s - loss: 0.1658 - accuracy: 0.477911/11 [==============================] - ETA: 0s - loss: 0.1647 - accuracy: 0.477211/11 [==============================] - 1s 114ms/step - loss: 0.1638 - accuracy: 0.4766
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1358 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.1318 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 0s - loss: 0.1305 - accuracy: 0.4414 4/11 [=========>....................] - ETA: 0s - loss: 0.1286 - accuracy: 0.4492 5/11 [============>.................] - ETA: 0s - loss: 0.1272 - accuracy: 0.4519 6/11 [===============>..............] - ETA: 0s - loss: 0.1260 - accuracy: 0.4538 7/11 [==================>...........] - ETA: 0s - loss: 0.1250 - accuracy: 0.4555 8/11 [====================>.........] - ETA: 0s - loss: 0.1243 - accuracy: 0.4569 9/11 [=======================>......] - ETA: 0s - loss: 0.1236 - accuracy: 0.457810/11 [==========================>...] - ETA: 0s - loss: 0.1229 - accuracy: 0.458811/11 [==============================] - ETA: 0s - loss: 0.1223 - accuracy: 0.459811/11 [==============================] - 1s 110ms/step - loss: 0.1219 - accuracy: 0.4606
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1111 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.1129 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.1148 - accuracy: 0.4470 4/11 [=========>....................] - ETA: 0s - loss: 0.1155 - accuracy: 0.4442 5/11 [============>.................] - ETA: 0s - loss: 0.1149 - accuracy: 0.4472 6/11 [===============>..............] - ETA: 0s - loss: 0.1146 - accuracy: 0.4480 7/11 [==================>...........] - ETA: 0s - loss: 0.1140 - accuracy: 0.4487 8/11 [====================>.........] - ETA: 0s - loss: 0.1134 - accuracy: 0.4510 9/11 [=======================>......] - ETA: 0s - loss: 0.1128 - accuracy: 0.453010/11 [==========================>...] - ETA: 0s - loss: 0.1122 - accuracy: 0.454511/11 [==============================] - ETA: 0s - loss: 0.1118 - accuracy: 0.456011/11 [==============================] - 1s 105ms/step - loss: 0.1114 - accuracy: 0.4572
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0990 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.0987 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 0s - loss: 0.0981 - accuracy: 0.5095 4/11 [=========>....................] - ETA: 0s - loss: 0.0977 - accuracy: 0.5057 5/11 [============>.................] - ETA: 0s - loss: 0.0975 - accuracy: 0.4999 6/11 [===============>..............] - ETA: 0s - loss: 0.0969 - accuracy: 0.4986 7/11 [==================>...........] - ETA: 0s - loss: 0.0967 - accuracy: 0.4962 8/11 [====================>.........] - ETA: 0s - loss: 0.0966 - accuracy: 0.4935 9/11 [=======================>......] - ETA: 0s - loss: 0.0966 - accuracy: 0.491810/11 [==========================>...] - ETA: 0s - loss: 0.0965 - accuracy: 0.490811/11 [==============================] - ETA: 0s - loss: 0.0964 - accuracy: 0.490011/11 [==============================] - 1s 117ms/step - loss: 0.0963 - accuracy: 0.4894
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0807 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.0819 - accuracy: 0.5430 3/11 [=======>......................] - ETA: 0s - loss: 0.0828 - accuracy: 0.5382 4/11 [=========>....................] - ETA: 0s - loss: 0.0836 - accuracy: 0.5335 5/11 [============>.................] - ETA: 0s - loss: 0.0844 - accuracy: 0.5293 6/11 [===============>..............] - ETA: 0s - loss: 0.0847 - accuracy: 0.5247 7/11 [==================>...........] - ETA: 0s - loss: 0.0849 - accuracy: 0.5211 8/11 [====================>.........] - ETA: 0s - loss: 0.0849 - accuracy: 0.5187 9/11 [=======================>......] - ETA: 0s - loss: 0.0848 - accuracy: 0.517110/11 [==========================>...] - ETA: 0s - loss: 0.0848 - accuracy: 0.515611/11 [==============================] - ETA: 0s - loss: 0.0847 - accuracy: 0.514411/11 [==============================] - 1s 104ms/step - loss: 0.0846 - accuracy: 0.5133
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0840 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.0832 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 0s - loss: 0.0819 - accuracy: 0.5113 4/11 [=========>....................] - ETA: 0s - loss: 0.0810 - accuracy: 0.5163 5/11 [============>.................] - ETA: 0s - loss: 0.0806 - accuracy: 0.5180 6/11 [===============>..............] - ETA: 0s - loss: 0.0803 - accuracy: 0.5181 7/11 [==================>...........] - ETA: 0s - loss: 0.0799 - accuracy: 0.5198 8/11 [====================>.........] - ETA: 0s - loss: 0.0794 - accuracy: 0.5217 9/11 [=======================>......] - ETA: 0s - loss: 0.0790 - accuracy: 0.523710/11 [==========================>...] - ETA: 0s - loss: 0.0786 - accuracy: 0.525111/11 [==============================] - ETA: 0s - loss: 0.0782 - accuracy: 0.526311/11 [==============================] - 1s 114ms/step - loss: 0.0779 - accuracy: 0.5273
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0670 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.0655 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.0654 - accuracy: 0.5243 4/11 [=========>....................] - ETA: 0s - loss: 0.0660 - accuracy: 0.5290 5/11 [============>.................] - ETA: 0s - loss: 0.0661 - accuracy: 0.5326 6/11 [===============>..............] - ETA: 0s - loss: 0.0665 - accuracy: 0.5358 7/11 [==================>...........] - ETA: 0s - loss: 0.0669 - accuracy: 0.5396 8/11 [====================>.........] - ETA: 0s - loss: 0.0673 - accuracy: 0.5421 9/11 [=======================>......] - ETA: 0s - loss: 0.0676 - accuracy: 0.543610/11 [==========================>...] - ETA: 0s - loss: 0.0678 - accuracy: 0.545211/11 [==============================] - ETA: 0s - loss: 0.0680 - accuracy: 0.546111/11 [==============================] - 1s 106ms/step - loss: 0.0680 - accuracy: 0.5469
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0669 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.0695 - accuracy: 0.5527 3/11 [=======>......................] - ETA: 0s - loss: 0.0693 - accuracy: 0.5534 4/11 [=========>....................] - ETA: 0s - loss: 0.0693 - accuracy: 0.5552 5/11 [============>.................] - ETA: 0s - loss: 0.0690 - accuracy: 0.5579 6/11 [===============>..............] - ETA: 0s - loss: 0.0688 - accuracy: 0.5615 7/11 [==================>...........] - ETA: 0s - loss: 0.0685 - accuracy: 0.5655 8/11 [====================>.........] - ETA: 0s - loss: 0.0681 - accuracy: 0.5695 9/11 [=======================>......] - ETA: 0s - loss: 0.0678 - accuracy: 0.571610/11 [==========================>...] - ETA: 0s - loss: 0.0675 - accuracy: 0.572711/11 [==============================] - ETA: 0s - loss: 0.0673 - accuracy: 0.573311/11 [==============================] - 1s 105ms/step - loss: 0.0671 - accuracy: 0.5738
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0657 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.0634 - accuracy: 0.5430 3/11 [=======>......................] - ETA: 1s - loss: 0.0632 - accuracy: 0.5538 4/11 [=========>....................] - ETA: 0s - loss: 0.0624 - accuracy: 0.5643 5/11 [============>.................] - ETA: 0s - loss: 0.0624 - accuracy: 0.5705 6/11 [===============>..............] - ETA: 0s - loss: 0.0623 - accuracy: 0.5746 7/11 [==================>...........] - ETA: 0s - loss: 0.0624 - accuracy: 0.5762 8/11 [====================>.........] - ETA: 0s - loss: 0.0623 - accuracy: 0.5778 9/11 [=======================>......] - ETA: 0s - loss: 0.0622 - accuracy: 0.578910/11 [==========================>...] - ETA: 0s - loss: 0.0621 - accuracy: 0.579811/11 [==============================] - ETA: 0s - loss: 0.0620 - accuracy: 0.580411/11 [==============================] - 1s 109ms/step - loss: 0.0619 - accuracy: 0.5809
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0596 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 0s - loss: 0.0578 - accuracy: 0.5898 3/11 [=======>......................] - ETA: 0s - loss: 0.0567 - accuracy: 0.5929 4/11 [=========>....................] - ETA: 0s - loss: 0.0571 - accuracy: 0.5902 5/11 [============>.................] - ETA: 0s - loss: 0.0574 - accuracy: 0.5893 6/11 [===============>..............] - ETA: 0s - loss: 0.0575 - accuracy: 0.5885 7/11 [==================>...........] - ETA: 0s - loss: 0.0575 - accuracy: 0.5879 8/11 [====================>.........] - ETA: 0s - loss: 0.0575 - accuracy: 0.5875 9/11 [=======================>......] - ETA: 0s - loss: 0.0574 - accuracy: 0.587310/11 [==========================>...] - ETA: 0s - loss: 0.0573 - accuracy: 0.588111/11 [==============================] - ETA: 0s - loss: 0.0573 - accuracy: 0.588711/11 [==============================] - 1s 102ms/step - loss: 0.0573 - accuracy: 0.5893
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0511 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 1s - loss: 0.0540 - accuracy: 0.5898 3/11 [=======>......................] - ETA: 1s - loss: 0.0554 - accuracy: 0.6024 4/11 [=========>....................] - ETA: 0s - loss: 0.0560 - accuracy: 0.6095 5/11 [============>.................] - ETA: 0s - loss: 0.0559 - accuracy: 0.6145 6/11 [===============>..............] - ETA: 0s - loss: 0.0558 - accuracy: 0.6169 7/11 [==================>...........] - ETA: 0s - loss: 0.0556 - accuracy: 0.6184 8/11 [====================>.........] - ETA: 0s - loss: 0.0554 - accuracy: 0.6201 9/11 [=======================>......] - ETA: 0s - loss: 0.0553 - accuracy: 0.620810/11 [==========================>...] - ETA: 0s - loss: 0.0551 - accuracy: 0.621811/11 [==============================] - ETA: 0s - loss: 0.0550 - accuracy: 0.623011/11 [==============================] - 1s 118ms/step - loss: 0.0549 - accuracy: 0.6240
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0464 - accuracy: 0.7188 2/11 [====>.........................] - ETA: 0s - loss: 0.0465 - accuracy: 0.7070 3/11 [=======>......................] - ETA: 0s - loss: 0.0479 - accuracy: 0.6997 4/11 [=========>....................] - ETA: 0s - loss: 0.0488 - accuracy: 0.6878 5/11 [============>.................] - ETA: 0s - loss: 0.0490 - accuracy: 0.6828 6/11 [===============>..............] - ETA: 0s - loss: 0.0495 - accuracy: 0.6794 7/11 [==================>...........] - ETA: 0s - loss: 0.0497 - accuracy: 0.6761 8/11 [====================>.........] - ETA: 0s - loss: 0.0499 - accuracy: 0.6739 9/11 [=======================>......] - ETA: 0s - loss: 0.0500 - accuracy: 0.672310/11 [==========================>...] - ETA: 0s - loss: 0.0500 - accuracy: 0.671511/11 [==============================] - ETA: 0s - loss: 0.0501 - accuracy: 0.671211/11 [==============================] - 1s 105ms/step - loss: 0.0501 - accuracy: 0.6709
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0507 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.0494 - accuracy: 0.7227 3/11 [=======>......................] - ETA: 0s - loss: 0.0485 - accuracy: 0.7127 4/11 [=========>....................] - ETA: 0s - loss: 0.0486 - accuracy: 0.7039 5/11 [============>.................] - ETA: 0s - loss: 0.0487 - accuracy: 0.6969 6/11 [===============>..............] - ETA: 0s - loss: 0.0487 - accuracy: 0.6947 7/11 [==================>...........] - ETA: 0s - loss: 0.0485 - accuracy: 0.6949 8/11 [====================>.........] - ETA: 0s - loss: 0.0484 - accuracy: 0.6946 9/11 [=======================>......] - ETA: 0s - loss: 0.0483 - accuracy: 0.694810/11 [==========================>...] - ETA: 0s - loss: 0.0482 - accuracy: 0.695911/11 [==============================] - ETA: 0s - loss: 0.0481 - accuracy: 0.697311/11 [==============================] - 1s 113ms/step - loss: 0.0481 - accuracy: 0.6984
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0459 - accuracy: 0.8047 2/11 [====>.........................] - ETA: 1s - loss: 0.0455 - accuracy: 0.7871 3/11 [=======>......................] - ETA: 0s - loss: 0.0455 - accuracy: 0.7791 4/11 [=========>....................] - ETA: 0s - loss: 0.0459 - accuracy: 0.7777 5/11 [============>.................] - ETA: 0s - loss: 0.0459 - accuracy: 0.7749 6/11 [===============>..............] - ETA: 0s - loss: 0.0458 - accuracy: 0.7712 7/11 [==================>...........] - ETA: 0s - loss: 0.0456 - accuracy: 0.7666 8/11 [====================>.........] - ETA: 0s - loss: 0.0454 - accuracy: 0.7629 9/11 [=======================>......] - ETA: 0s - loss: 0.0452 - accuracy: 0.760510/11 [==========================>...] - ETA: 0s - loss: 0.0451 - accuracy: 0.759311/11 [==============================] - ETA: 0s - loss: 0.0451 - accuracy: 0.758711/11 [==============================] - 1s 108ms/step - loss: 0.0450 - accuracy: 0.7581
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0489 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.0478 - accuracy: 0.8105 3/11 [=======>......................] - ETA: 0s - loss: 0.0484 - accuracy: 0.8008 4/11 [=========>....................] - ETA: 0s - loss: 0.0479 - accuracy: 0.7959 5/11 [============>.................] - ETA: 0s - loss: 0.0474 - accuracy: 0.7908 6/11 [===============>..............] - ETA: 0s - loss: 0.0469 - accuracy: 0.7883 7/11 [==================>...........] - ETA: 0s - loss: 0.0467 - accuracy: 0.7878 8/11 [====================>.........] - ETA: 0s - loss: 0.0464 - accuracy: 0.7894 9/11 [=======================>......] - ETA: 0s - loss: 0.0460 - accuracy: 0.792110/11 [==========================>...] - ETA: 0s - loss: 0.0457 - accuracy: 0.794911/11 [==============================] - ETA: 0s - loss: 0.0455 - accuracy: 0.797311/11 [==============================] - 1s 118ms/step - loss: 0.0453 - accuracy: 0.7992
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0332 - accuracy: 0.9219 2/11 [====>.........................] - ETA: 0s - loss: 0.0358 - accuracy: 0.9043 3/11 [=======>......................] - ETA: 0s - loss: 0.0366 - accuracy: 0.8859 4/11 [=========>....................] - ETA: 0s - loss: 0.0373 - accuracy: 0.8656 5/11 [============>.................] - ETA: 0s - loss: 0.0380 - accuracy: 0.8512 6/11 [===============>..............] - ETA: 0s - loss: 0.0384 - accuracy: 0.8428 7/11 [==================>...........] - ETA: 0s - loss: 0.0388 - accuracy: 0.8356 8/11 [====================>.........] - ETA: 0s - loss: 0.0391 - accuracy: 0.8311 9/11 [=======================>......] - ETA: 0s - loss: 0.0394 - accuracy: 0.828710/11 [==========================>...] - ETA: 0s - loss: 0.0395 - accuracy: 0.827711/11 [==============================] - ETA: 0s - loss: 0.0396 - accuracy: 0.827011/11 [==============================] - 1s 111ms/step - loss: 0.0397 - accuracy: 0.8264
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0453 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 0s - loss: 0.0429 - accuracy: 0.8613 3/11 [=======>......................] - ETA: 0s - loss: 0.0424 - accuracy: 0.8485 4/11 [=========>....................] - ETA: 0s - loss: 0.0419 - accuracy: 0.8337 5/11 [============>.................] - ETA: 0s - loss: 0.0414 - accuracy: 0.8269 6/11 [===============>..............] - ETA: 0s - loss: 0.0409 - accuracy: 0.8243 7/11 [==================>...........] - ETA: 0s - loss: 0.0406 - accuracy: 0.8239 8/11 [====================>.........] - ETA: 0s - loss: 0.0404 - accuracy: 0.8244 9/11 [=======================>......] - ETA: 0s - loss: 0.0403 - accuracy: 0.825410/11 [==========================>...] - ETA: 0s - loss: 0.0403 - accuracy: 0.826511/11 [==============================] - ETA: 0s - loss: 0.0403 - accuracy: 0.828011/11 [==============================] - 1s 103ms/step - loss: 0.0402 - accuracy: 0.8293
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0378 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 1s - loss: 0.0387 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0386 - accuracy: 0.8602 4/11 [=========>....................] - ETA: 0s - loss: 0.0384 - accuracy: 0.8551 5/11 [============>.................] - ETA: 0s - loss: 0.0383 - accuracy: 0.8501 6/11 [===============>..............] - ETA: 0s - loss: 0.0382 - accuracy: 0.8475 7/11 [==================>...........] - ETA: 0s - loss: 0.0380 - accuracy: 0.8463 8/11 [====================>.........] - ETA: 0s - loss: 0.0379 - accuracy: 0.8449 9/11 [=======================>......] - ETA: 0s - loss: 0.0379 - accuracy: 0.844110/11 [==========================>...] - ETA: 0s - loss: 0.0377 - accuracy: 0.843611/11 [==============================] - ETA: 0s - loss: 0.0376 - accuracy: 0.843511/11 [==============================] - 1s 113ms/step - loss: 0.0375 - accuracy: 0.8435
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0353 - accuracy: 0.87503/6 [==============>...............] - ETA: 0s - loss: 0.0409 - accuracy: 0.8594 5/6 [========================>.....] - ETA: 0s - loss: 0.0394 - accuracy: 0.86566/6 [==============================] - 4s 35ms/step - loss: 0.0399 - accuracy: 0.8683
2021-12-13 23:42:14.502725: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:42:14.503600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:42:14.503647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:42:14.503691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:42:14.503721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:42:14.503747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:42:14.503773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:42:14.503798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:42:14.503826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:42:14.503854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:42:14.505011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:42:14.505038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:42:14.505047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:42:14.505055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [0.03305045 0.9178171  0.83504844 0.0103392  0.00354695]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [0.00544965 0.05034345 0.92534363 0.01862687 0.00164455]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [0.00575712 0.07190901 0.9158722  0.01770979 0.00178257]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [0.10985449 0.58097637 0.6102787  0.03666884 0.02049178]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [0.06351939 0.95497215 0.8246583  0.01003072 0.00580874]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 2 0 1] pred: [0.04998583 0.00094315 0.17601293 0.7843872  0.25154865]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 2 4 0 1] pred: [0.04777527 0.00139907 0.2526369  0.67628    0.15157303]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [0 3 1 4 2] pred: [0.7703191  0.2854818  0.13718241 0.41517523 0.27344924]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [0.00631085 0.04250687 0.9208631  0.01978609 0.00164667]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [0.00477567 0.04138097 0.9306744  0.01814371 0.00156841]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [0.00519466 0.04990146 0.93324554 0.01774913 0.00147238]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [0.00578299 0.10980564 0.9404166  0.01573187 0.00111294]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.04160792 0.92262626 0.8328911  0.01044497 0.00439206]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [0.02365521 0.8982824  0.87565386 0.01019418 0.00232074]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [0.00506166 0.04073995 0.92866755 0.01888421 0.0016526 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:11 - loss: 0.2510 - accuracy: 0.2891 2/11 [====>.........................] - ETA: 1s - loss: 0.2504 - accuracy: 0.3164   3/11 [=======>......................] - ETA: 0s - loss: 0.2497 - accuracy: 0.3481 4/11 [=========>....................] - ETA: 0s - loss: 0.2491 - accuracy: 0.3704 5/11 [============>.................] - ETA: 0s - loss: 0.2485 - accuracy: 0.3851 6/11 [===============>..............] - ETA: 0s - loss: 0.2478 - accuracy: 0.3986 7/11 [==================>...........] - ETA: 0s - loss: 0.2472 - accuracy: 0.4070 8/11 [====================>.........] - ETA: 0s - loss: 0.2466 - accuracy: 0.4133 9/11 [=======================>......] - ETA: 0s - loss: 0.2460 - accuracy: 0.418610/11 [==========================>...] - ETA: 0s - loss: 0.2454 - accuracy: 0.423011/11 [==============================] - ETA: 0s - loss: 0.2448 - accuracy: 0.426311/11 [==============================] - 14s 108ms/step - loss: 0.2443 - accuracy: 0.4290
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2213 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.2201 - accuracy: 0.4590 3/11 [=======>......................] - ETA: 0s - loss: 0.2192 - accuracy: 0.4562 4/11 [=========>....................] - ETA: 0s - loss: 0.2186 - accuracy: 0.4549 5/11 [============>.................] - ETA: 0s - loss: 0.2179 - accuracy: 0.4542 6/11 [===============>..............] - ETA: 0s - loss: 0.2173 - accuracy: 0.4549 7/11 [==================>...........] - ETA: 0s - loss: 0.2165 - accuracy: 0.4574 8/11 [====================>.........] - ETA: 0s - loss: 0.2156 - accuracy: 0.4594 9/11 [=======================>......] - ETA: 0s - loss: 0.2148 - accuracy: 0.460610/11 [==========================>...] - ETA: 0s - loss: 0.2139 - accuracy: 0.462311/11 [==============================] - ETA: 0s - loss: 0.2130 - accuracy: 0.463511/11 [==============================] - 1s 103ms/step - loss: 0.2123 - accuracy: 0.4646
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1747 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.1737 - accuracy: 0.5059 3/11 [=======>......................] - ETA: 0s - loss: 0.1723 - accuracy: 0.5082 4/11 [=========>....................] - ETA: 0s - loss: 0.1716 - accuracy: 0.5062 5/11 [============>.................] - ETA: 0s - loss: 0.1709 - accuracy: 0.5034 6/11 [===============>..............] - ETA: 0s - loss: 0.1702 - accuracy: 0.5002 7/11 [==================>...........] - ETA: 0s - loss: 0.1694 - accuracy: 0.4967 8/11 [====================>.........] - ETA: 0s - loss: 0.1684 - accuracy: 0.4947 9/11 [=======================>......] - ETA: 0s - loss: 0.1674 - accuracy: 0.493110/11 [==========================>...] - ETA: 0s - loss: 0.1663 - accuracy: 0.492511/11 [==============================] - ETA: 0s - loss: 0.1653 - accuracy: 0.491011/11 [==============================] - 1s 112ms/step - loss: 0.1645 - accuracy: 0.4897
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1319 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.1342 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.1347 - accuracy: 0.4323 4/11 [=========>....................] - ETA: 0s - loss: 0.1338 - accuracy: 0.4341 5/11 [============>.................] - ETA: 0s - loss: 0.1330 - accuracy: 0.4360 6/11 [===============>..............] - ETA: 0s - loss: 0.1317 - accuracy: 0.4397 7/11 [==================>...........] - ETA: 0s - loss: 0.1304 - accuracy: 0.4444 8/11 [====================>.........] - ETA: 0s - loss: 0.1292 - accuracy: 0.4479 9/11 [=======================>......] - ETA: 0s - loss: 0.1280 - accuracy: 0.451510/11 [==========================>...] - ETA: 0s - loss: 0.1271 - accuracy: 0.454411/11 [==============================] - ETA: 0s - loss: 0.1263 - accuracy: 0.456311/11 [==============================] - 1s 104ms/step - loss: 0.1257 - accuracy: 0.4580
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1034 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.1087 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.1117 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.1119 - accuracy: 0.5107 5/11 [============>.................] - ETA: 0s - loss: 0.1121 - accuracy: 0.5061 6/11 [===============>..............] - ETA: 0s - loss: 0.1120 - accuracy: 0.5007 7/11 [==================>...........] - ETA: 0s - loss: 0.1122 - accuracy: 0.4960 8/11 [====================>.........] - ETA: 0s - loss: 0.1123 - accuracy: 0.4924 9/11 [=======================>......] - ETA: 0s - loss: 0.1124 - accuracy: 0.489810/11 [==========================>...] - ETA: 0s - loss: 0.1125 - accuracy: 0.487911/11 [==============================] - ETA: 0s - loss: 0.1124 - accuracy: 0.486811/11 [==============================] - 1s 109ms/step - loss: 0.1124 - accuracy: 0.4859
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1048 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.1054 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 0s - loss: 0.1060 - accuracy: 0.4926 4/11 [=========>....................] - ETA: 0s - loss: 0.1065 - accuracy: 0.4925 5/11 [============>.................] - ETA: 0s - loss: 0.1070 - accuracy: 0.4915 6/11 [===============>..............] - ETA: 0s - loss: 0.1070 - accuracy: 0.4921 7/11 [==================>...........] - ETA: 0s - loss: 0.1071 - accuracy: 0.4914 8/11 [====================>.........] - ETA: 0s - loss: 0.1070 - accuracy: 0.4914 9/11 [=======================>......] - ETA: 0s - loss: 0.1069 - accuracy: 0.490110/11 [==========================>...] - ETA: 0s - loss: 0.1069 - accuracy: 0.488911/11 [==============================] - ETA: 0s - loss: 0.1068 - accuracy: 0.487811/11 [==============================] - 1s 106ms/step - loss: 0.1068 - accuracy: 0.4868
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1057 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.1035 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.1022 - accuracy: 0.4644 4/11 [=========>....................] - ETA: 0s - loss: 0.1027 - accuracy: 0.4640 5/11 [============>.................] - ETA: 0s - loss: 0.1031 - accuracy: 0.4659 6/11 [===============>..............] - ETA: 0s - loss: 0.1029 - accuracy: 0.4686 7/11 [==================>...........] - ETA: 0s - loss: 0.1028 - accuracy: 0.4703 8/11 [====================>.........] - ETA: 0s - loss: 0.1028 - accuracy: 0.4712 9/11 [=======================>......] - ETA: 0s - loss: 0.1027 - accuracy: 0.470710/11 [==========================>...] - ETA: 0s - loss: 0.1025 - accuracy: 0.471111/11 [==============================] - ETA: 0s - loss: 0.1022 - accuracy: 0.471711/11 [==============================] - 1s 105ms/step - loss: 0.1020 - accuracy: 0.4723
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0900 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 1s - loss: 0.0899 - accuracy: 0.5332 3/11 [=======>......................] - ETA: 0s - loss: 0.0917 - accuracy: 0.5126 4/11 [=========>....................] - ETA: 0s - loss: 0.0927 - accuracy: 0.5031 5/11 [============>.................] - ETA: 0s - loss: 0.0928 - accuracy: 0.4972 6/11 [===============>..............] - ETA: 0s - loss: 0.0927 - accuracy: 0.4931 7/11 [==================>...........] - ETA: 0s - loss: 0.0926 - accuracy: 0.4910 8/11 [====================>.........] - ETA: 0s - loss: 0.0924 - accuracy: 0.4911 9/11 [=======================>......] - ETA: 0s - loss: 0.0923 - accuracy: 0.491110/11 [==========================>...] - ETA: 0s - loss: 0.0921 - accuracy: 0.490911/11 [==============================] - ETA: 0s - loss: 0.0920 - accuracy: 0.491411/11 [==============================] - 1s 111ms/step - loss: 0.0919 - accuracy: 0.4918
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0794 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.0828 - accuracy: 0.4980 3/11 [=======>......................] - ETA: 0s - loss: 0.0824 - accuracy: 0.4961 4/11 [=========>....................] - ETA: 0s - loss: 0.0820 - accuracy: 0.4961 5/11 [============>.................] - ETA: 0s - loss: 0.0820 - accuracy: 0.4972 6/11 [===============>..............] - ETA: 0s - loss: 0.0821 - accuracy: 0.4972 7/11 [==================>...........] - ETA: 0s - loss: 0.0820 - accuracy: 0.4986 8/11 [====================>.........] - ETA: 0s - loss: 0.0820 - accuracy: 0.4994 9/11 [=======================>......] - ETA: 0s - loss: 0.0821 - accuracy: 0.500010/11 [==========================>...] - ETA: 0s - loss: 0.0819 - accuracy: 0.501511/11 [==============================] - ETA: 0s - loss: 0.0817 - accuracy: 0.502811/11 [==============================] - 1s 106ms/step - loss: 0.0816 - accuracy: 0.5039
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0741 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 0s - loss: 0.0745 - accuracy: 0.5430 3/11 [=======>......................] - ETA: 0s - loss: 0.0747 - accuracy: 0.5399 4/11 [=========>....................] - ETA: 0s - loss: 0.0747 - accuracy: 0.5363 5/11 [============>.................] - ETA: 0s - loss: 0.0744 - accuracy: 0.5343 6/11 [===============>..............] - ETA: 0s - loss: 0.0742 - accuracy: 0.5343 7/11 [==================>...........] - ETA: 0s - loss: 0.0740 - accuracy: 0.5337 8/11 [====================>.........] - ETA: 0s - loss: 0.0738 - accuracy: 0.5333 9/11 [=======================>......] - ETA: 0s - loss: 0.0735 - accuracy: 0.534310/11 [==========================>...] - ETA: 0s - loss: 0.0732 - accuracy: 0.535311/11 [==============================] - ETA: 0s - loss: 0.0730 - accuracy: 0.535811/11 [==============================] - 1s 111ms/step - loss: 0.0728 - accuracy: 0.5362
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0693 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 0s - loss: 0.0669 - accuracy: 0.5820 3/11 [=======>......................] - ETA: 0s - loss: 0.0662 - accuracy: 0.5877 4/11 [=========>....................] - ETA: 0s - loss: 0.0660 - accuracy: 0.5911 5/11 [============>.................] - ETA: 0s - loss: 0.0660 - accuracy: 0.5917 6/11 [===============>..............] - ETA: 0s - loss: 0.0662 - accuracy: 0.5929 7/11 [==================>...........] - ETA: 0s - loss: 0.0662 - accuracy: 0.5959 8/11 [====================>.........] - ETA: 0s - loss: 0.0659 - accuracy: 0.5973 9/11 [=======================>......] - ETA: 0s - loss: 0.0658 - accuracy: 0.597810/11 [==========================>...] - ETA: 0s - loss: 0.0656 - accuracy: 0.597911/11 [==============================] - ETA: 0s - loss: 0.0654 - accuracy: 0.598311/11 [==============================] - 1s 112ms/step - loss: 0.0653 - accuracy: 0.5985
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0601 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.0593 - accuracy: 0.5645 3/11 [=======>......................] - ETA: 0s - loss: 0.0583 - accuracy: 0.5742 4/11 [=========>....................] - ETA: 0s - loss: 0.0587 - accuracy: 0.5781 5/11 [============>.................] - ETA: 0s - loss: 0.0590 - accuracy: 0.5822 6/11 [===============>..............] - ETA: 0s - loss: 0.0590 - accuracy: 0.5854 7/11 [==================>...........] - ETA: 0s - loss: 0.0590 - accuracy: 0.5879 8/11 [====================>.........] - ETA: 0s - loss: 0.0589 - accuracy: 0.5904 9/11 [=======================>......] - ETA: 0s - loss: 0.0588 - accuracy: 0.591810/11 [==========================>...] - ETA: 0s - loss: 0.0587 - accuracy: 0.593511/11 [==============================] - ETA: 0s - loss: 0.0586 - accuracy: 0.594911/11 [==============================] - 1s 108ms/step - loss: 0.0585 - accuracy: 0.5960
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0595 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.0588 - accuracy: 0.5801 3/11 [=======>......................] - ETA: 0s - loss: 0.0587 - accuracy: 0.5890 4/11 [=========>....................] - ETA: 0s - loss: 0.0581 - accuracy: 0.6009 5/11 [============>.................] - ETA: 0s - loss: 0.0578 - accuracy: 0.6085 6/11 [===============>..............] - ETA: 0s - loss: 0.0572 - accuracy: 0.6124 7/11 [==================>...........] - ETA: 0s - loss: 0.0569 - accuracy: 0.6143 8/11 [====================>.........] - ETA: 0s - loss: 0.0565 - accuracy: 0.6157 9/11 [=======================>......] - ETA: 0s - loss: 0.0561 - accuracy: 0.616610/11 [==========================>...] - ETA: 0s - loss: 0.0558 - accuracy: 0.617811/11 [==============================] - ETA: 0s - loss: 0.0556 - accuracy: 0.618811/11 [==============================] - 1s 109ms/step - loss: 0.0553 - accuracy: 0.6197
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0481 - accuracy: 0.6250 2/11 [====>.........................] - ETA: 1s - loss: 0.0486 - accuracy: 0.6230 3/11 [=======>......................] - ETA: 0s - loss: 0.0492 - accuracy: 0.6246 4/11 [=========>....................] - ETA: 0s - loss: 0.0496 - accuracy: 0.6261 5/11 [============>.................] - ETA: 0s - loss: 0.0498 - accuracy: 0.6275 6/11 [===============>..............] - ETA: 0s - loss: 0.0500 - accuracy: 0.6290 7/11 [==================>...........] - ETA: 0s - loss: 0.0500 - accuracy: 0.6308 8/11 [====================>.........] - ETA: 0s - loss: 0.0498 - accuracy: 0.6332 9/11 [=======================>......] - ETA: 0s - loss: 0.0498 - accuracy: 0.635910/11 [==========================>...] - ETA: 0s - loss: 0.0497 - accuracy: 0.638111/11 [==============================] - ETA: 0s - loss: 0.0496 - accuracy: 0.639811/11 [==============================] - 1s 113ms/step - loss: 0.0495 - accuracy: 0.6413
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0501 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 1s - loss: 0.0477 - accuracy: 0.6758 3/11 [=======>......................] - ETA: 0s - loss: 0.0479 - accuracy: 0.6693 4/11 [=========>....................] - ETA: 0s - loss: 0.0474 - accuracy: 0.6689 5/11 [============>.................] - ETA: 0s - loss: 0.0472 - accuracy: 0.6695 6/11 [===============>..............] - ETA: 0s - loss: 0.0470 - accuracy: 0.6693 7/11 [==================>...........] - ETA: 0s - loss: 0.0470 - accuracy: 0.6687 8/11 [====================>.........] - ETA: 0s - loss: 0.0469 - accuracy: 0.6691 9/11 [=======================>......] - ETA: 0s - loss: 0.0468 - accuracy: 0.669310/11 [==========================>...] - ETA: 0s - loss: 0.0466 - accuracy: 0.669711/11 [==============================] - ETA: 0s - loss: 0.0465 - accuracy: 0.669911/11 [==============================] - 1s 107ms/step - loss: 0.0464 - accuracy: 0.6701
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0458 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 0s - loss: 0.0442 - accuracy: 0.6543 3/11 [=======>......................] - ETA: 0s - loss: 0.0437 - accuracy: 0.6680 4/11 [=========>....................] - ETA: 0s - loss: 0.0436 - accuracy: 0.6704 5/11 [============>.................] - ETA: 0s - loss: 0.0434 - accuracy: 0.6738 6/11 [===============>..............] - ETA: 0s - loss: 0.0432 - accuracy: 0.6785 7/11 [==================>...........] - ETA: 0s - loss: 0.0431 - accuracy: 0.6822 8/11 [====================>.........] - ETA: 0s - loss: 0.0430 - accuracy: 0.6841 9/11 [=======================>......] - ETA: 0s - loss: 0.0429 - accuracy: 0.685410/11 [==========================>...] - ETA: 0s - loss: 0.0429 - accuracy: 0.686211/11 [==============================] - ETA: 0s - loss: 0.0428 - accuracy: 0.687311/11 [==============================] - 1s 108ms/step - loss: 0.0427 - accuracy: 0.6883
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0447 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 1s - loss: 0.0434 - accuracy: 0.7168 3/11 [=======>......................] - ETA: 0s - loss: 0.0425 - accuracy: 0.7166 4/11 [=========>....................] - ETA: 0s - loss: 0.0419 - accuracy: 0.7210 5/11 [============>.................] - ETA: 0s - loss: 0.0414 - accuracy: 0.7221 6/11 [===============>..............] - ETA: 0s - loss: 0.0410 - accuracy: 0.7229 7/11 [==================>...........] - ETA: 0s - loss: 0.0407 - accuracy: 0.7234 8/11 [====================>.........] - ETA: 0s - loss: 0.0405 - accuracy: 0.7233 9/11 [=======================>......] - ETA: 0s - loss: 0.0404 - accuracy: 0.723510/11 [==========================>...] - ETA: 0s - loss: 0.0403 - accuracy: 0.723911/11 [==============================] - ETA: 0s - loss: 0.0401 - accuracy: 0.724411/11 [==============================] - 1s 111ms/step - loss: 0.0400 - accuracy: 0.7249
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0406 - accuracy: 0.8047 2/11 [====>.........................] - ETA: 0s - loss: 0.0405 - accuracy: 0.7832 3/11 [=======>......................] - ETA: 0s - loss: 0.0401 - accuracy: 0.7669 4/11 [=========>....................] - ETA: 0s - loss: 0.0398 - accuracy: 0.7632 5/11 [============>.................] - ETA: 0s - loss: 0.0392 - accuracy: 0.7609 6/11 [===============>..............] - ETA: 0s - loss: 0.0389 - accuracy: 0.7588 7/11 [==================>...........] - ETA: 0s - loss: 0.0386 - accuracy: 0.7579 8/11 [====================>.........] - ETA: 0s - loss: 0.0384 - accuracy: 0.7569 9/11 [=======================>......] - ETA: 0s - loss: 0.0382 - accuracy: 0.755910/11 [==========================>...] - ETA: 0s - loss: 0.0379 - accuracy: 0.755611/11 [==============================] - ETA: 0s - loss: 0.0377 - accuracy: 0.755511/11 [==============================] - 1s 116ms/step - loss: 0.0375 - accuracy: 0.7555
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0320 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.0320 - accuracy: 0.8223 3/11 [=======>......................] - ETA: 0s - loss: 0.0328 - accuracy: 0.8207 4/11 [=========>....................] - ETA: 0s - loss: 0.0335 - accuracy: 0.8250 5/11 [============>.................] - ETA: 0s - loss: 0.0337 - accuracy: 0.8300 6/11 [===============>..............] - ETA: 0s - loss: 0.0337 - accuracy: 0.8327 7/11 [==================>...........] - ETA: 0s - loss: 0.0337 - accuracy: 0.8338 8/11 [====================>.........] - ETA: 0s - loss: 0.0338 - accuracy: 0.8339 9/11 [=======================>......] - ETA: 0s - loss: 0.0338 - accuracy: 0.832810/11 [==========================>...] - ETA: 0s - loss: 0.0338 - accuracy: 0.831311/11 [==============================] - ETA: 0s - loss: 0.0337 - accuracy: 0.830311/11 [==============================] - 1s 104ms/step - loss: 0.0337 - accuracy: 0.8294
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0292 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 0s - loss: 0.0302 - accuracy: 0.8496 3/11 [=======>......................] - ETA: 0s - loss: 0.0304 - accuracy: 0.8537 4/11 [=========>....................] - ETA: 0s - loss: 0.0309 - accuracy: 0.8542 5/11 [============>.................] - ETA: 0s - loss: 0.0309 - accuracy: 0.8533 6/11 [===============>..............] - ETA: 0s - loss: 0.0311 - accuracy: 0.8504 7/11 [==================>...........] - ETA: 0s - loss: 0.0312 - accuracy: 0.8455 8/11 [====================>.........] - ETA: 0s - loss: 0.0313 - accuracy: 0.8410 9/11 [=======================>......] - ETA: 0s - loss: 0.0313 - accuracy: 0.837410/11 [==========================>...] - ETA: 0s - loss: 0.0312 - accuracy: 0.835111/11 [==============================] - ETA: 0s - loss: 0.0312 - accuracy: 0.833711/11 [==============================] - 1s 109ms/step - loss: 0.0311 - accuracy: 0.8325
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0348 - accuracy: 0.89843/6 [==============>...............] - ETA: 0s - loss: 0.0345 - accuracy: 0.8932 5/6 [========================>.....] - ETA: 0s - loss: 0.0351 - accuracy: 0.88596/6 [==============================] - 4s 39ms/step - loss: 0.0343 - accuracy: 0.8853
2021-12-13 23:43:03.837789: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:43:03.838920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:43:03.838974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:43:03.839063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:43:03.839095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:43:03.839122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:43:03.839197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:43:03.839234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:43:03.839262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:43:03.839334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:43:03.840507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:43:03.840535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:43:03.840545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:43:03.840552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [5.07017970e-03 7.73104727e-02 9.29436088e-01 1.49103105e-02
 7.43448734e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 2 0 1] pred: [0.05829322 0.00267243 0.06049934 0.66410863 0.6179073 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [0.06798622 0.8872889  0.73255444 0.01534536 0.00982511]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [4.9701929e-03 5.1248342e-02 9.2061663e-01 1.3563186e-02 8.5017085e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [0.00787723 0.04992008 0.8870636  0.01680359 0.00114605]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 2 4 3] pred: [0.62809765 0.32115093 0.08991331 0.02725178 0.06315818]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [0.0077908  0.05843213 0.8718076  0.01525289 0.00128508]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [0.01066974 0.22121862 0.9834926  0.05109867 0.01252413]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 4 1 0] pred: [0.00470302 0.00521067 0.9605555  0.05357146 0.01314679]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 4 0 1] pred: [0.02156314 0.00609565 0.17955282 0.7639909  0.12657583]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [5.6189001e-03 5.8840334e-02 9.2921245e-01 1.3515115e-02 7.3042512e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 1 4 0] pred: [0.00869462 0.01441741 0.68271935 0.25803784 0.01381311]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.03659296 0.9050237  0.88478833 0.01405388 0.00336513]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 2 0 1] pred: [0.03370476 0.00748584 0.1671125  0.9046345  0.2136356 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [0.07753479 0.93492424 0.7771637  0.01856291 0.008394  ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:59 - loss: 0.2516 - accuracy: 0.0781 2/11 [====>.........................] - ETA: 1s - loss: 0.2509 - accuracy: 0.1484   3/11 [=======>......................] - ETA: 0s - loss: 0.2503 - accuracy: 0.1832 4/11 [=========>....................] - ETA: 0s - loss: 0.2497 - accuracy: 0.2184 5/11 [============>.................] - ETA: 0s - loss: 0.2491 - accuracy: 0.2460 6/11 [===============>..............] - ETA: 0s - loss: 0.2484 - accuracy: 0.2647 7/11 [==================>...........] - ETA: 0s - loss: 0.2478 - accuracy: 0.2806 8/11 [====================>.........] - ETA: 0s - loss: 0.2472 - accuracy: 0.2954 9/11 [=======================>......] - ETA: 0s - loss: 0.2465 - accuracy: 0.308110/11 [==========================>...] - ETA: 0s - loss: 0.2459 - accuracy: 0.319311/11 [==============================] - ETA: 0s - loss: 0.2452 - accuracy: 0.328011/11 [==============================] - 13s 110ms/step - loss: 0.2447 - accuracy: 0.3353
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2213 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.2210 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 0s - loss: 0.2203 - accuracy: 0.4492 4/11 [=========>....................] - ETA: 0s - loss: 0.2195 - accuracy: 0.4478 5/11 [============>.................] - ETA: 0s - loss: 0.2186 - accuracy: 0.4476 6/11 [===============>..............] - ETA: 0s - loss: 0.2177 - accuracy: 0.4492 7/11 [==================>...........] - ETA: 0s - loss: 0.2167 - accuracy: 0.4505 8/11 [====================>.........] - ETA: 0s - loss: 0.2158 - accuracy: 0.4508 9/11 [=======================>......] - ETA: 0s - loss: 0.2150 - accuracy: 0.450710/11 [==========================>...] - ETA: 0s - loss: 0.2140 - accuracy: 0.451111/11 [==============================] - ETA: 0s - loss: 0.2131 - accuracy: 0.452011/11 [==============================] - 1s 108ms/step - loss: 0.2124 - accuracy: 0.4528
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1770 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.1759 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.1746 - accuracy: 0.4635 4/11 [=========>....................] - ETA: 0s - loss: 0.1736 - accuracy: 0.4590 5/11 [============>.................] - ETA: 0s - loss: 0.1725 - accuracy: 0.4562 6/11 [===============>..............] - ETA: 0s - loss: 0.1712 - accuracy: 0.4570 7/11 [==================>...........] - ETA: 0s - loss: 0.1698 - accuracy: 0.4576 8/11 [====================>.........] - ETA: 0s - loss: 0.1685 - accuracy: 0.4581 9/11 [=======================>......] - ETA: 0s - loss: 0.1671 - accuracy: 0.458610/11 [==========================>...] - ETA: 0s - loss: 0.1659 - accuracy: 0.459111/11 [==============================] - ETA: 0s - loss: 0.1647 - accuracy: 0.459311/11 [==============================] - 1s 115ms/step - loss: 0.1637 - accuracy: 0.4595
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1149 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.1161 - accuracy: 0.4941 3/11 [=======>......................] - ETA: 0s - loss: 0.1171 - accuracy: 0.4848 4/11 [=========>....................] - ETA: 0s - loss: 0.1176 - accuracy: 0.4764 5/11 [============>.................] - ETA: 0s - loss: 0.1180 - accuracy: 0.4717 6/11 [===============>..............] - ETA: 0s - loss: 0.1177 - accuracy: 0.4723 7/11 [==================>...........] - ETA: 0s - loss: 0.1173 - accuracy: 0.4717 8/11 [====================>.........] - ETA: 0s - loss: 0.1172 - accuracy: 0.4706 9/11 [=======================>......] - ETA: 0s - loss: 0.1171 - accuracy: 0.469210/11 [==========================>...] - ETA: 0s - loss: 0.1170 - accuracy: 0.468511/11 [==============================] - ETA: 0s - loss: 0.1169 - accuracy: 0.467811/11 [==============================] - 1s 113ms/step - loss: 0.1169 - accuracy: 0.4673
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1074 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.1061 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.1072 - accuracy: 0.4826 4/11 [=========>....................] - ETA: 0s - loss: 0.1081 - accuracy: 0.4767 5/11 [============>.................] - ETA: 0s - loss: 0.1082 - accuracy: 0.4739 6/11 [===============>..............] - ETA: 0s - loss: 0.1080 - accuracy: 0.4739 7/11 [==================>...........] - ETA: 0s - loss: 0.1078 - accuracy: 0.4741 8/11 [====================>.........] - ETA: 0s - loss: 0.1076 - accuracy: 0.4747 9/11 [=======================>......] - ETA: 0s - loss: 0.1076 - accuracy: 0.474710/11 [==========================>...] - ETA: 0s - loss: 0.1078 - accuracy: 0.473711/11 [==============================] - ETA: 0s - loss: 0.1079 - accuracy: 0.472611/11 [==============================] - 1s 107ms/step - loss: 0.1080 - accuracy: 0.4716
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1321 - accuracy: 0.3281 2/11 [====>.........................] - ETA: 0s - loss: 0.1226 - accuracy: 0.3887 3/11 [=======>......................] - ETA: 0s - loss: 0.1197 - accuracy: 0.4076 4/11 [=========>....................] - ETA: 0s - loss: 0.1176 - accuracy: 0.4194 5/11 [============>.................] - ETA: 0s - loss: 0.1160 - accuracy: 0.4271 6/11 [===============>..............] - ETA: 0s - loss: 0.1146 - accuracy: 0.4338 7/11 [==================>...........] - ETA: 0s - loss: 0.1137 - accuracy: 0.4377 8/11 [====================>.........] - ETA: 0s - loss: 0.1128 - accuracy: 0.4401 9/11 [=======================>......] - ETA: 0s - loss: 0.1119 - accuracy: 0.442910/11 [==========================>...] - ETA: 0s - loss: 0.1110 - accuracy: 0.445011/11 [==============================] - ETA: 0s - loss: 0.1104 - accuracy: 0.446611/11 [==============================] - 1s 115ms/step - loss: 0.1098 - accuracy: 0.4480
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1067 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.1052 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.1041 - accuracy: 0.4627 4/11 [=========>....................] - ETA: 0s - loss: 0.1026 - accuracy: 0.4657 5/11 [============>.................] - ETA: 0s - loss: 0.1014 - accuracy: 0.4666 6/11 [===============>..............] - ETA: 0s - loss: 0.1007 - accuracy: 0.4656 7/11 [==================>...........] - ETA: 0s - loss: 0.1002 - accuracy: 0.4650 8/11 [====================>.........] - ETA: 0s - loss: 0.0997 - accuracy: 0.4646 9/11 [=======================>......] - ETA: 0s - loss: 0.0993 - accuracy: 0.464510/11 [==========================>...] - ETA: 0s - loss: 0.0989 - accuracy: 0.465111/11 [==============================] - ETA: 0s - loss: 0.0985 - accuracy: 0.466011/11 [==============================] - 1s 105ms/step - loss: 0.0981 - accuracy: 0.4668
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0865 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.0869 - accuracy: 0.4980 3/11 [=======>......................] - ETA: 0s - loss: 0.0873 - accuracy: 0.4848 4/11 [=========>....................] - ETA: 0s - loss: 0.0875 - accuracy: 0.4779 5/11 [============>.................] - ETA: 0s - loss: 0.0870 - accuracy: 0.4764 6/11 [===============>..............] - ETA: 0s - loss: 0.0864 - accuracy: 0.4783 7/11 [==================>...........] - ETA: 0s - loss: 0.0863 - accuracy: 0.4786 8/11 [====================>.........] - ETA: 0s - loss: 0.0861 - accuracy: 0.4787 9/11 [=======================>......] - ETA: 0s - loss: 0.0858 - accuracy: 0.479510/11 [==========================>...] - ETA: 0s - loss: 0.0855 - accuracy: 0.480111/11 [==============================] - ETA: 0s - loss: 0.0853 - accuracy: 0.480511/11 [==============================] - 1s 103ms/step - loss: 0.0851 - accuracy: 0.4808
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0775 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.0784 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 0s - loss: 0.0791 - accuracy: 0.4974 4/11 [=========>....................] - ETA: 0s - loss: 0.0782 - accuracy: 0.5029 5/11 [============>.................] - ETA: 0s - loss: 0.0776 - accuracy: 0.5036 6/11 [===============>..............] - ETA: 0s - loss: 0.0774 - accuracy: 0.5041 7/11 [==================>...........] - ETA: 0s - loss: 0.0771 - accuracy: 0.5053 8/11 [====================>.........] - ETA: 0s - loss: 0.0768 - accuracy: 0.5064 9/11 [=======================>......] - ETA: 0s - loss: 0.0764 - accuracy: 0.507910/11 [==========================>...] - ETA: 0s - loss: 0.0761 - accuracy: 0.509611/11 [==============================] - ETA: 0s - loss: 0.0758 - accuracy: 0.511111/11 [==============================] - 1s 116ms/step - loss: 0.0756 - accuracy: 0.5123
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0725 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 0s - loss: 0.0731 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.0729 - accuracy: 0.5443 4/11 [=========>....................] - ETA: 0s - loss: 0.0726 - accuracy: 0.5459 5/11 [============>.................] - ETA: 0s - loss: 0.0722 - accuracy: 0.5483 6/11 [===============>..............] - ETA: 0s - loss: 0.0716 - accuracy: 0.5504 7/11 [==================>...........] - ETA: 0s - loss: 0.0710 - accuracy: 0.5539 8/11 [====================>.........] - ETA: 0s - loss: 0.0704 - accuracy: 0.5567 9/11 [=======================>......] - ETA: 0s - loss: 0.0700 - accuracy: 0.558810/11 [==========================>...] - ETA: 0s - loss: 0.0696 - accuracy: 0.559911/11 [==============================] - ETA: 0s - loss: 0.0693 - accuracy: 0.561311/11 [==============================] - 1s 109ms/step - loss: 0.0690 - accuracy: 0.5624
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0655 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.0667 - accuracy: 0.5332 3/11 [=======>......................] - ETA: 0s - loss: 0.0663 - accuracy: 0.5456 4/11 [=========>....................] - ETA: 0s - loss: 0.0663 - accuracy: 0.5493 5/11 [============>.................] - ETA: 0s - loss: 0.0660 - accuracy: 0.5563 6/11 [===============>..............] - ETA: 0s - loss: 0.0657 - accuracy: 0.5615 7/11 [==================>...........] - ETA: 0s - loss: 0.0655 - accuracy: 0.5658 8/11 [====================>.........] - ETA: 0s - loss: 0.0653 - accuracy: 0.5696 9/11 [=======================>......] - ETA: 0s - loss: 0.0650 - accuracy: 0.572710/11 [==========================>...] - ETA: 0s - loss: 0.0647 - accuracy: 0.575411/11 [==============================] - ETA: 0s - loss: 0.0643 - accuracy: 0.577811/11 [==============================] - 1s 106ms/step - loss: 0.0640 - accuracy: 0.5798
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0586 - accuracy: 0.6094 2/11 [====>.........................] - ETA: 0s - loss: 0.0600 - accuracy: 0.6055 3/11 [=======>......................] - ETA: 0s - loss: 0.0596 - accuracy: 0.6033 4/11 [=========>....................] - ETA: 0s - loss: 0.0592 - accuracy: 0.6053 5/11 [============>.................] - ETA: 0s - loss: 0.0588 - accuracy: 0.6092 6/11 [===============>..............] - ETA: 0s - loss: 0.0586 - accuracy: 0.6108 7/11 [==================>...........] - ETA: 0s - loss: 0.0583 - accuracy: 0.6119 8/11 [====================>.........] - ETA: 0s - loss: 0.0582 - accuracy: 0.6123 9/11 [=======================>......] - ETA: 0s - loss: 0.0579 - accuracy: 0.612510/11 [==========================>...] - ETA: 0s - loss: 0.0578 - accuracy: 0.612811/11 [==============================] - ETA: 0s - loss: 0.0576 - accuracy: 0.613211/11 [==============================] - 1s 112ms/step - loss: 0.0574 - accuracy: 0.6136
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0551 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.0526 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.0519 - accuracy: 0.5877 4/11 [=========>....................] - ETA: 0s - loss: 0.0513 - accuracy: 0.5980 5/11 [============>.................] - ETA: 0s - loss: 0.0508 - accuracy: 0.6046 6/11 [===============>..............] - ETA: 0s - loss: 0.0506 - accuracy: 0.6080 7/11 [==================>...........] - ETA: 0s - loss: 0.0505 - accuracy: 0.6093 8/11 [====================>.........] - ETA: 0s - loss: 0.0506 - accuracy: 0.6114 9/11 [=======================>......] - ETA: 0s - loss: 0.0506 - accuracy: 0.612410/11 [==========================>...] - ETA: 0s - loss: 0.0507 - accuracy: 0.612811/11 [==============================] - ETA: 0s - loss: 0.0508 - accuracy: 0.613711/11 [==============================] - 1s 110ms/step - loss: 0.0509 - accuracy: 0.6144
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0381 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 1s - loss: 0.0403 - accuracy: 0.5977 3/11 [=======>......................] - ETA: 0s - loss: 0.0415 - accuracy: 0.6102 4/11 [=========>....................] - ETA: 0s - loss: 0.0422 - accuracy: 0.6174 5/11 [============>.................] - ETA: 0s - loss: 0.0427 - accuracy: 0.6201 6/11 [===============>..............] - ETA: 0s - loss: 0.0432 - accuracy: 0.6212 7/11 [==================>...........] - ETA: 0s - loss: 0.0437 - accuracy: 0.6209 8/11 [====================>.........] - ETA: 0s - loss: 0.0442 - accuracy: 0.6217 9/11 [=======================>......] - ETA: 0s - loss: 0.0445 - accuracy: 0.621610/11 [==========================>...] - ETA: 0s - loss: 0.0449 - accuracy: 0.621911/11 [==============================] - ETA: 0s - loss: 0.0452 - accuracy: 0.622311/11 [==============================] - 1s 107ms/step - loss: 0.0454 - accuracy: 0.6227
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0465 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 0s - loss: 0.0465 - accuracy: 0.6387 3/11 [=======>......................] - ETA: 0s - loss: 0.0462 - accuracy: 0.6315 4/11 [=========>....................] - ETA: 0s - loss: 0.0462 - accuracy: 0.6313 5/11 [============>.................] - ETA: 0s - loss: 0.0459 - accuracy: 0.6307 6/11 [===============>..............] - ETA: 0s - loss: 0.0460 - accuracy: 0.6306 7/11 [==================>...........] - ETA: 0s - loss: 0.0461 - accuracy: 0.6298 8/11 [====================>.........] - ETA: 0s - loss: 0.0460 - accuracy: 0.6298 9/11 [=======================>......] - ETA: 0s - loss: 0.0459 - accuracy: 0.629910/11 [==========================>...] - ETA: 0s - loss: 0.0459 - accuracy: 0.630211/11 [==============================] - ETA: 0s - loss: 0.0458 - accuracy: 0.630211/11 [==============================] - 1s 102ms/step - loss: 0.0457 - accuracy: 0.6302
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0416 - accuracy: 0.7031 2/11 [====>.........................] - ETA: 0s - loss: 0.0430 - accuracy: 0.6777 3/11 [=======>......................] - ETA: 0s - loss: 0.0443 - accuracy: 0.6636 4/11 [=========>....................] - ETA: 0s - loss: 0.0446 - accuracy: 0.6584 5/11 [============>.................] - ETA: 0s - loss: 0.0446 - accuracy: 0.6542 6/11 [===============>..............] - ETA: 0s - loss: 0.0446 - accuracy: 0.6515 7/11 [==================>...........] - ETA: 0s - loss: 0.0445 - accuracy: 0.6504 8/11 [====================>.........] - ETA: 0s - loss: 0.0444 - accuracy: 0.6499 9/11 [=======================>......] - ETA: 0s - loss: 0.0443 - accuracy: 0.650010/11 [==========================>...] - ETA: 0s - loss: 0.0442 - accuracy: 0.649911/11 [==============================] - ETA: 0s - loss: 0.0441 - accuracy: 0.650311/11 [==============================] - 1s 103ms/step - loss: 0.0440 - accuracy: 0.6506
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0416 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 1s - loss: 0.0435 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.0438 - accuracy: 0.6337 4/11 [=========>....................] - ETA: 0s - loss: 0.0438 - accuracy: 0.6388 5/11 [============>.................] - ETA: 0s - loss: 0.0433 - accuracy: 0.6436 6/11 [===============>..............] - ETA: 0s - loss: 0.0430 - accuracy: 0.6474 7/11 [==================>...........] - ETA: 0s - loss: 0.0427 - accuracy: 0.6511 8/11 [====================>.........] - ETA: 0s - loss: 0.0425 - accuracy: 0.6539 9/11 [=======================>......] - ETA: 0s - loss: 0.0424 - accuracy: 0.655510/11 [==========================>...] - ETA: 0s - loss: 0.0423 - accuracy: 0.657711/11 [==============================] - ETA: 0s - loss: 0.0421 - accuracy: 0.659811/11 [==============================] - 1s 110ms/step - loss: 0.0419 - accuracy: 0.6615
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0409 - accuracy: 0.6797 2/11 [====>.........................] - ETA: 0s - loss: 0.0393 - accuracy: 0.6816 3/11 [=======>......................] - ETA: 0s - loss: 0.0386 - accuracy: 0.6784 4/11 [=========>....................] - ETA: 0s - loss: 0.0383 - accuracy: 0.6807 5/11 [============>.................] - ETA: 0s - loss: 0.0380 - accuracy: 0.6814 6/11 [===============>..............] - ETA: 0s - loss: 0.0379 - accuracy: 0.6816 7/11 [==================>...........] - ETA: 0s - loss: 0.0378 - accuracy: 0.6816 8/11 [====================>.........] - ETA: 0s - loss: 0.0378 - accuracy: 0.6817 9/11 [=======================>......] - ETA: 0s - loss: 0.0378 - accuracy: 0.682410/11 [==========================>...] - ETA: 0s - loss: 0.0379 - accuracy: 0.683011/11 [==============================] - ETA: 0s - loss: 0.0380 - accuracy: 0.683711/11 [==============================] - 1s 116ms/step - loss: 0.0380 - accuracy: 0.6842
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0300 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 1s - loss: 0.0316 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.0330 - accuracy: 0.7240 4/11 [=========>....................] - ETA: 0s - loss: 0.0337 - accuracy: 0.7290 5/11 [============>.................] - ETA: 0s - loss: 0.0343 - accuracy: 0.7316 6/11 [===============>..............] - ETA: 0s - loss: 0.0347 - accuracy: 0.7330 7/11 [==================>...........] - ETA: 0s - loss: 0.0349 - accuracy: 0.7341 8/11 [====================>.........] - ETA: 0s - loss: 0.0351 - accuracy: 0.7353 9/11 [=======================>......] - ETA: 0s - loss: 0.0353 - accuracy: 0.736610/11 [==========================>...] - ETA: 0s - loss: 0.0355 - accuracy: 0.737911/11 [==============================] - ETA: 0s - loss: 0.0356 - accuracy: 0.738811/11 [==============================] - 1s 105ms/step - loss: 0.0357 - accuracy: 0.7395
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0383 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 0s - loss: 0.0381 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.0374 - accuracy: 0.7552 4/11 [=========>....................] - ETA: 0s - loss: 0.0368 - accuracy: 0.7559 5/11 [============>.................] - ETA: 0s - loss: 0.0364 - accuracy: 0.7578 6/11 [===============>..............] - ETA: 0s - loss: 0.0362 - accuracy: 0.7561 7/11 [==================>...........] - ETA: 0s - loss: 0.0362 - accuracy: 0.7530 8/11 [====================>.........] - ETA: 0s - loss: 0.0361 - accuracy: 0.7494 9/11 [=======================>......] - ETA: 0s - loss: 0.0360 - accuracy: 0.747610/11 [==========================>...] - ETA: 0s - loss: 0.0359 - accuracy: 0.745911/11 [==============================] - ETA: 0s - loss: 0.0358 - accuracy: 0.744211/11 [==============================] - 1s 101ms/step - loss: 0.0358 - accuracy: 0.7429
Evaluate on test data
1/6 [====>.........................] - ETA: 18s - loss: 0.0307 - accuracy: 0.73443/6 [==============>...............] - ETA: 0s - loss: 0.0335 - accuracy: 0.7057 5/6 [========================>.....] - ETA: 0s - loss: 0.0362 - accuracy: 0.69226/6 [==============================] - 4s 34ms/step - loss: 0.0360 - accuracy: 0.6941
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [0.02622756 0.723077   0.8546456  0.0122737  0.00771356]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 4 3] pred: [0.14125547 0.70816946 0.5878004  0.01088226 0.01977593]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 4 0] pred: [0.00226679 0.01261181 0.9132035  0.14035249 0.00407863]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [0.03062207 0.82275367 0.8963862  0.01080197 0.00775033]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [8.2930923e-04 4.0039182e-02 9.4491214e-01 1.3125658e-02 2.4536252e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 4 3 2] pred: [0.8323107  0.2484616  0.03621104 0.10870174 0.22204351]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [8.8495016e-04 3.7877709e-02 9.3937135e-01 1.3766229e-02 2.8723478e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 4 3] pred: [0.10293099 0.77966774 0.70152986 0.01053968 0.01840159]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 4 3] pred: [0.06618881 0.82302976 0.7316291  0.01543328 0.01655254]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [0.02159652 0.81791717 0.91585773 0.01057336 0.00640124]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 4 3] pred: [0.05208459 0.8231376  0.8292784  0.00739053 0.01125953]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [1.1006594e-03 3.2837898e-02 9.1986454e-01 1.3470978e-02 3.6132336e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [0.03042868 0.7094821  0.8526033  0.02298015 0.01399213]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [0.04407275 0.80697495 0.85212576 0.00998324 0.0106647 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [1.0530949e-03 4.0576249e-02 9.2747021e-01 1.4307022e-02 3.3348799e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Job end at lun déc 13 23:43:54 CET 2021
