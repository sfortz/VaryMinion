
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at lun déc 13 23:43:44 CET 2021
2021-12-13 23:43:45.284677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-13 23:43:50.533798: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:43:50.535550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-13 23:43:50.567986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:43:50.568036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:43:50.572429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:43:50.572483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:43:50.575494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:43:50.576469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:43:50.579964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:43:50.581891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:43:50.588586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:43:50.590211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:43:50.590262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:43:51.360734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:43:51.360799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:43:51.360816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:43:51.363398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:43:51.364755: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:43:51.365571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:43:51.365631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:43:51.365678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:43:51.365718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:43:51.365757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:43:51.365802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:43:51.365845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:43:51.365885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:43:51.365941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:43:51.367353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:43:51.367396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:43:51.367413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:43:51.367425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:43:51.368868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:43:53.208900: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:43:53.210389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:43:53.210443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:43:53.210553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:43:53.210606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:43:53.210687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:43:53.210731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:43:53.210806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:43:53.210851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:43:53.210893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:43:53.212047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:43:53.212956: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:43:53.213575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:43:53.213604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:43:53.213633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:43:53.213705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:43:53.213739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:43:53.213769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:43:53.213846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:43:53.213880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:43:53.213910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:43:53.215037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:43:53.215132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:43:53.215150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:43:53.215160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:43:53.216493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:43:53.216639: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-13 23:43:56.679043: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-13 23:43:56.679882: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 1994990000 Hz
2021-12-13 23:44:08.386150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:44:09.451291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
Number of possible configurations: 40
Begining exécution of the 30 th configuration: BPIC20.csv with GRU model, 20 epochs, 30 units, 128 batch_size, sigmoid as activation function and manhattan as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 90, 58)            3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                16200     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:34 - loss: 2.5029 - accuracy: 0.0938 3/11 [=======>......................] - ETA: 0s - loss: 2.4958 - accuracy: 0.1710   5/11 [============>.................] - ETA: 0s - loss: 2.4885 - accuracy: 0.2370 8/11 [====================>.........] - ETA: 0s - loss: 2.4773 - accuracy: 0.293610/11 [==========================>...] - ETA: 0s - loss: 2.4697 - accuracy: 0.317411/11 [==============================] - 16s 25ms/step - loss: 2.4630 - accuracy: 0.3342
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3261 - accuracy: 0.3906 3/11 [=======>......................] - ETA: 0s - loss: 2.3160 - accuracy: 0.4201 6/11 [===============>..............] - ETA: 0s - loss: 2.2994 - accuracy: 0.4335 9/11 [=======================>......] - ETA: 0s - loss: 2.2803 - accuracy: 0.438611/11 [==============================] - 0s 25ms/step - loss: 2.2612 - accuracy: 0.4435
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 2.0003 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 1.9756 - accuracy: 0.4557 6/11 [===============>..............] - ETA: 0s - loss: 1.9375 - accuracy: 0.4638 8/11 [====================>.........] - ETA: 0s - loss: 1.9123 - accuracy: 0.463611/11 [==============================] - ETA: 0s - loss: 1.8743 - accuracy: 0.462311/11 [==============================] - 0s 25ms/step - loss: 1.8641 - accuracy: 0.4619
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.3889 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 1.3325 - accuracy: 0.4673 7/11 [==================>...........] - ETA: 0s - loss: 1.2849 - accuracy: 0.4684 9/11 [=======================>......] - ETA: 0s - loss: 1.2559 - accuracy: 0.469211/11 [==============================] - 0s 25ms/step - loss: 1.2239 - accuracy: 0.4672
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7948 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.8558 - accuracy: 0.4939 6/11 [===============>..............] - ETA: 0s - loss: 0.8720 - accuracy: 0.4772 9/11 [=======================>......] - ETA: 0s - loss: 0.8759 - accuracy: 0.470411/11 [==============================] - 0s 26ms/step - loss: 0.8773 - accuracy: 0.4676
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9832 - accuracy: 0.3906 4/11 [=========>....................] - ETA: 0s - loss: 0.9356 - accuracy: 0.4191 7/11 [==================>...........] - ETA: 0s - loss: 0.9072 - accuracy: 0.4324 9/11 [=======================>......] - ETA: 0s - loss: 0.8940 - accuracy: 0.438511/11 [==============================] - 0s 25ms/step - loss: 0.8832 - accuracy: 0.4440
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8783 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8605 - accuracy: 0.4371 6/11 [===============>..............] - ETA: 0s - loss: 0.8569 - accuracy: 0.4435 8/11 [====================>.........] - ETA: 0s - loss: 0.8572 - accuracy: 0.445711/11 [==============================] - ETA: 0s - loss: 0.8552 - accuracy: 0.449211/11 [==============================] - 0s 25ms/step - loss: 0.8548 - accuracy: 0.4500
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9677 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.9226 - accuracy: 0.4349 6/11 [===============>..............] - ETA: 0s - loss: 0.9022 - accuracy: 0.4433 8/11 [====================>.........] - ETA: 0s - loss: 0.8909 - accuracy: 0.447911/11 [==============================] - ETA: 0s - loss: 0.8793 - accuracy: 0.450811/11 [==============================] - 0s 25ms/step - loss: 0.8767 - accuracy: 0.4514
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8029 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.8270 - accuracy: 0.4813 5/11 [============>.................] - ETA: 0s - loss: 0.8287 - accuracy: 0.4778 8/11 [====================>.........] - ETA: 0s - loss: 0.8320 - accuracy: 0.472111/11 [==============================] - ETA: 0s - loss: 0.8360 - accuracy: 0.468511/11 [==============================] - 0s 25ms/step - loss: 0.8370 - accuracy: 0.4677
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9255 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8817 - accuracy: 0.4527 6/11 [===============>..............] - ETA: 0s - loss: 0.8808 - accuracy: 0.4503 9/11 [=======================>......] - ETA: 0s - loss: 0.8722 - accuracy: 0.451911/11 [==============================] - 0s 24ms/step - loss: 0.8657 - accuracy: 0.4536
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8761 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.9146 - accuracy: 0.4271 5/11 [============>.................] - ETA: 0s - loss: 0.9007 - accuracy: 0.4382 8/11 [====================>.........] - ETA: 0s - loss: 0.8905 - accuracy: 0.443711/11 [==============================] - ETA: 0s - loss: 0.8794 - accuracy: 0.447511/11 [==============================] - 0s 23ms/step - loss: 0.8766 - accuracy: 0.4484
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9239 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.9036 - accuracy: 0.4180 6/11 [===============>..............] - ETA: 0s - loss: 0.8778 - accuracy: 0.4327 9/11 [=======================>......] - ETA: 0s - loss: 0.8687 - accuracy: 0.439511/11 [==============================] - 0s 24ms/step - loss: 0.8626 - accuracy: 0.4443
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8768 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.8699 - accuracy: 0.4442 6/11 [===============>..............] - ETA: 0s - loss: 0.8693 - accuracy: 0.4463 9/11 [=======================>......] - ETA: 0s - loss: 0.8600 - accuracy: 0.452411/11 [==============================] - 0s 23ms/step - loss: 0.8562 - accuracy: 0.4538
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7917 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8434 - accuracy: 0.4466 6/11 [===============>..............] - ETA: 0s - loss: 0.8479 - accuracy: 0.4490 8/11 [====================>.........] - ETA: 0s - loss: 0.8506 - accuracy: 0.449411/11 [==============================] - ETA: 0s - loss: 0.8490 - accuracy: 0.451711/11 [==============================] - 0s 24ms/step - loss: 0.8485 - accuracy: 0.4522
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7379 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 0s - loss: 0.8257 - accuracy: 0.4642 7/11 [==================>...........] - ETA: 0s - loss: 0.8354 - accuracy: 0.457810/11 [==========================>...] - ETA: 0s - loss: 0.8389 - accuracy: 0.456911/11 [==============================] - 0s 24ms/step - loss: 0.8396 - accuracy: 0.4572
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8343 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8349 - accuracy: 0.4553 5/11 [============>.................] - ETA: 0s - loss: 0.8361 - accuracy: 0.4576 8/11 [====================>.........] - ETA: 0s - loss: 0.8319 - accuracy: 0.457710/11 [==========================>...] - ETA: 0s - loss: 0.8334 - accuracy: 0.457311/11 [==============================] - 0s 25ms/step - loss: 0.8348 - accuracy: 0.4575
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9027 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.8494 - accuracy: 0.4565 6/11 [===============>..............] - ETA: 0s - loss: 0.8438 - accuracy: 0.4597 8/11 [====================>.........] - ETA: 0s - loss: 0.8392 - accuracy: 0.461211/11 [==============================] - ETA: 0s - loss: 0.8395 - accuracy: 0.460511/11 [==============================] - 0s 24ms/step - loss: 0.8396 - accuracy: 0.4603
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9618 - accuracy: 0.3750 4/11 [=========>....................] - ETA: 0s - loss: 0.9360 - accuracy: 0.3965 6/11 [===============>..............] - ETA: 0s - loss: 0.9219 - accuracy: 0.4042 9/11 [=======================>......] - ETA: 0s - loss: 0.9031 - accuracy: 0.416011/11 [==============================] - 0s 25ms/step - loss: 0.8870 - accuracy: 0.4264
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9536 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.8944 - accuracy: 0.4284 5/11 [============>.................] - ETA: 0s - loss: 0.8733 - accuracy: 0.4379 8/11 [====================>.........] - ETA: 0s - loss: 0.8578 - accuracy: 0.445211/11 [==============================] - ETA: 0s - loss: 0.8495 - accuracy: 0.450311/11 [==============================] - 0s 25ms/step - loss: 0.8481 - accuracy: 0.4510
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8408 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8538 - accuracy: 0.4332 6/11 [===============>..............] - ETA: 0s - loss: 0.8457 - accuracy: 0.4393 8/11 [====================>.........] - ETA: 0s - loss: 0.8376 - accuracy: 0.445110/11 [==========================>...] - ETA: 0s - loss: 0.8341 - accuracy: 0.448011/11 [==============================] - 0s 25ms/step - loss: 0.8317 - accuracy: 0.4500
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.8517 - accuracy: 0.45316/6 [==============================] - 5s 10ms/step - loss: 0.8007 - accuracy: 0.4603
2021-12-13 23:44:27.603860: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:44:27.604534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:44:27.604589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:44:27.604681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:44:27.604716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:44:27.604754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:44:27.604818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:44:27.604855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:44:27.604926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:44:27.604998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:44:27.605724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:44:27.605768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:44:27.605781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:44:27.605790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:44:27.606593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:44:27.606917: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:44:27.607324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:44:27.607353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:44:27.607381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:44:27.607452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:44:27.607486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:44:27.607514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:44:27.607578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:44:27.607612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:44:27.607640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:44:27.608372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:44:27.608400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:44:27.608443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:44:27.608456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:44:27.609245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [1.9021753e-04 8.6778827e-04 9.9188966e-01 7.7105255e-04 1.5318976e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [1.9363700e-04 8.6987705e-04 9.9166590e-01 8.1282499e-04 1.5671793e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 0 4] pred: [7.1560609e-04 2.1322852e-03 9.7063541e-01 2.4762107e-03 5.4273126e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 3 ============
pred sorted: [2 3 1 0 4] pred: [0.05043046 0.06246917 0.5798162  0.07486799 0.04154046]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [3.8760563e-04 1.3872994e-03 9.8359883e-01 1.2605854e-03 3.0079868e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [1.7495641e-04 8.0891803e-04 9.9259949e-01 7.7441777e-04 1.4300042e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [1.8219193e-04 8.2761090e-04 9.9222529e-01 7.9633069e-04 1.4742136e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [1.9297584e-04 8.8680728e-04 9.9153155e-01 8.0261572e-04 1.5845479e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [1.8294256e-04 8.4715761e-04 9.9218130e-01 7.6772214e-04 1.4777279e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [3.5921691e-04 1.3128864e-03 9.8470521e-01 1.2115759e-03 2.7323619e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [5.6717620e-04 2.0320166e-03 9.8141527e-01 1.4890464e-03 4.4889463e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 1 0 4] pred: [0.00550507 0.01015466 0.8360719  0.01080865 0.00339041]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [2.8753644e-04 1.1557307e-03 9.8715311e-01 1.0899226e-03 2.3120448e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [1.8454704e-04 8.4699009e-04 9.9212211e-01 7.7975017e-04 1.4928763e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [2.0031520e-04 8.9622941e-04 9.9138898e-01 8.0010534e-04 1.6022589e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:37 - loss: 2.5004 - accuracy: 0.2344 4/11 [=========>....................] - ETA: 0s - loss: 2.4899 - accuracy: 0.2954   6/11 [===============>..............] - ETA: 0s - loss: 2.4827 - accuracy: 0.3294 9/11 [=======================>......] - ETA: 0s - loss: 2.4720 - accuracy: 0.355711/11 [==============================] - ETA: 0s - loss: 2.4645 - accuracy: 0.368611/11 [==============================] - 16s 25ms/step - loss: 2.4614 - accuracy: 0.3738
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3248 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 2.3069 - accuracy: 0.4683 6/11 [===============>..............] - ETA: 0s - loss: 2.2884 - accuracy: 0.4684 8/11 [====================>.........] - ETA: 0s - loss: 2.2738 - accuracy: 0.471411/11 [==============================] - ETA: 0s - loss: 2.2524 - accuracy: 0.470211/11 [==============================] - 0s 24ms/step - loss: 2.2467 - accuracy: 0.4696
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 1.9362 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 1.9216 - accuracy: 0.5100 5/11 [============>.................] - ETA: 0s - loss: 1.9013 - accuracy: 0.4940 8/11 [====================>.........] - ETA: 0s - loss: 1.8576 - accuracy: 0.485511/11 [==============================] - ETA: 0s - loss: 1.8135 - accuracy: 0.480211/11 [==============================] - 0s 24ms/step - loss: 1.8017 - accuracy: 0.4788
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.2313 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 1.1682 - accuracy: 0.4813 6/11 [===============>..............] - ETA: 0s - loss: 1.1257 - accuracy: 0.4878 9/11 [=======================>......] - ETA: 0s - loss: 1.1012 - accuracy: 0.480511/11 [==============================] - ETA: 0s - loss: 1.0869 - accuracy: 0.477611/11 [==============================] - 0s 24ms/step - loss: 1.0813 - accuracy: 0.4764
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9268 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8764 - accuracy: 0.4822 5/11 [============>.................] - ETA: 0s - loss: 0.8670 - accuracy: 0.4770 7/11 [==================>...........] - ETA: 0s - loss: 0.8628 - accuracy: 0.473810/11 [==========================>...] - ETA: 0s - loss: 0.8599 - accuracy: 0.471211/11 [==============================] - 0s 25ms/step - loss: 0.8587 - accuracy: 0.4699
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7819 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.7969 - accuracy: 0.4920 6/11 [===============>..............] - ETA: 0s - loss: 0.8088 - accuracy: 0.4850 8/11 [====================>.........] - ETA: 0s - loss: 0.8145 - accuracy: 0.481210/11 [==========================>...] - ETA: 0s - loss: 0.8172 - accuracy: 0.479111/11 [==============================] - 0s 26ms/step - loss: 0.8203 - accuracy: 0.4765
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7981 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8345 - accuracy: 0.4583 5/11 [============>.................] - ETA: 0s - loss: 0.8354 - accuracy: 0.4590 7/11 [==================>...........] - ETA: 0s - loss: 0.8358 - accuracy: 0.4600 9/11 [=======================>......] - ETA: 0s - loss: 0.8374 - accuracy: 0.458911/11 [==============================] - 0s 26ms/step - loss: 0.8367 - accuracy: 0.4594
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9068 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.9003 - accuracy: 0.4145 5/11 [============>.................] - ETA: 0s - loss: 0.8852 - accuracy: 0.4278 8/11 [====================>.........] - ETA: 0s - loss: 0.8753 - accuracy: 0.434610/11 [==========================>...] - ETA: 0s - loss: 0.8672 - accuracy: 0.439611/11 [==============================] - 0s 26ms/step - loss: 0.8609 - accuracy: 0.4436
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7795 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8145 - accuracy: 0.4596 5/11 [============>.................] - ETA: 0s - loss: 0.8383 - accuracy: 0.4494 7/11 [==================>...........] - ETA: 0s - loss: 0.8460 - accuracy: 0.447610/11 [==========================>...] - ETA: 0s - loss: 0.8456 - accuracy: 0.450411/11 [==============================] - 0s 25ms/step - loss: 0.8428 - accuracy: 0.4526
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8414 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8226 - accuracy: 0.4761 6/11 [===============>..............] - ETA: 0s - loss: 0.8319 - accuracy: 0.4711 8/11 [====================>.........] - ETA: 0s - loss: 0.8294 - accuracy: 0.471311/11 [==============================] - ETA: 0s - loss: 0.8287 - accuracy: 0.469611/11 [==============================] - 0s 25ms/step - loss: 0.8286 - accuracy: 0.4691
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7556 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.8340 - accuracy: 0.4666 6/11 [===============>..............] - ETA: 0s - loss: 0.8340 - accuracy: 0.4645 8/11 [====================>.........] - ETA: 0s - loss: 0.8307 - accuracy: 0.465310/11 [==========================>...] - ETA: 0s - loss: 0.8299 - accuracy: 0.464811/11 [==============================] - 0s 26ms/step - loss: 0.8294 - accuracy: 0.4646
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9095 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8774 - accuracy: 0.4301 6/11 [===============>..............] - ETA: 0s - loss: 0.8651 - accuracy: 0.4395 9/11 [=======================>......] - ETA: 0s - loss: 0.8521 - accuracy: 0.448311/11 [==============================] - ETA: 0s - loss: 0.8466 - accuracy: 0.451411/11 [==============================] - 0s 25ms/step - loss: 0.8450 - accuracy: 0.4524
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7617 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.8170 - accuracy: 0.4640 5/11 [============>.................] - ETA: 0s - loss: 0.8253 - accuracy: 0.4634 7/11 [==================>...........] - ETA: 0s - loss: 0.8254 - accuracy: 0.464910/11 [==========================>...] - ETA: 0s - loss: 0.8273 - accuracy: 0.464111/11 [==============================] - 0s 25ms/step - loss: 0.8271 - accuracy: 0.4640
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7919 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8183 - accuracy: 0.4609 5/11 [============>.................] - ETA: 0s - loss: 0.8380 - accuracy: 0.4514 7/11 [==================>...........] - ETA: 0s - loss: 0.8403 - accuracy: 0.4520 9/11 [=======================>......] - ETA: 0s - loss: 0.8413 - accuracy: 0.452611/11 [==============================] - 0s 27ms/step - loss: 0.8375 - accuracy: 0.4555
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9557 - accuracy: 0.3828 3/11 [=======>......................] - ETA: 0s - loss: 0.8704 - accuracy: 0.4345 6/11 [===============>..............] - ETA: 0s - loss: 0.8493 - accuracy: 0.4475 8/11 [====================>.........] - ETA: 0s - loss: 0.8424 - accuracy: 0.451510/11 [==========================>...] - ETA: 0s - loss: 0.8393 - accuracy: 0.453711/11 [==============================] - 0s 27ms/step - loss: 0.8370 - accuracy: 0.4553
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8313 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.8246 - accuracy: 0.4514 5/11 [============>.................] - ETA: 0s - loss: 0.8265 - accuracy: 0.4556 8/11 [====================>.........] - ETA: 0s - loss: 0.8238 - accuracy: 0.460211/11 [==============================] - ETA: 0s - loss: 0.8232 - accuracy: 0.461711/11 [==============================] - 0s 25ms/step - loss: 0.8234 - accuracy: 0.4619
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8771 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8601 - accuracy: 0.4427 6/11 [===============>..............] - ETA: 0s - loss: 0.8504 - accuracy: 0.4454 9/11 [=======================>......] - ETA: 0s - loss: 0.8436 - accuracy: 0.449611/11 [==============================] - ETA: 0s - loss: 0.8396 - accuracy: 0.452211/11 [==============================] - 0s 25ms/step - loss: 0.8384 - accuracy: 0.4532
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8297 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.8774 - accuracy: 0.4344 6/11 [===============>..............] - ETA: 0s - loss: 0.8807 - accuracy: 0.4317 8/11 [====================>.........] - ETA: 0s - loss: 0.8733 - accuracy: 0.434710/11 [==========================>...] - ETA: 0s - loss: 0.8662 - accuracy: 0.438811/11 [==============================] - 0s 26ms/step - loss: 0.8593 - accuracy: 0.4429
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7451 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.7600 - accuracy: 0.4779 6/11 [===============>..............] - ETA: 0s - loss: 0.7727 - accuracy: 0.4762 8/11 [====================>.........] - ETA: 0s - loss: 0.7827 - accuracy: 0.474010/11 [==========================>...] - ETA: 0s - loss: 0.7880 - accuracy: 0.472911/11 [==============================] - 0s 27ms/step - loss: 0.7941 - accuracy: 0.4713
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6896 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.7492 - accuracy: 0.5135 6/11 [===============>..............] - ETA: 0s - loss: 0.7712 - accuracy: 0.4994 8/11 [====================>.........] - ETA: 0s - loss: 0.7825 - accuracy: 0.492710/11 [==========================>...] - ETA: 0s - loss: 0.7884 - accuracy: 0.488711/11 [==============================] - 0s 26ms/step - loss: 0.7944 - accuracy: 0.4845
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.8908 - accuracy: 0.45316/6 [==============================] - 5s 9ms/step - loss: 0.8687 - accuracy: 0.4490
2021-12-13 23:45:03.594484: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:45:03.595611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:45:03.595671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:45:03.595775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:45:03.595814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:45:03.595849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:45:03.595954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:45:03.596003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:45:03.596081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:45:03.596137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:45:03.596917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:45:03.596974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:45:03.596987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:45:03.596997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:45:03.597872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:45:03.598222: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:45:03.598635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:45:03.598663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:45:03.598691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:45:03.598761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:45:03.598796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:45:03.598825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:45:03.598903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:45:03.598944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:45:03.598975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:45:03.599740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:45:03.599769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:45:03.599780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:45:03.599789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:45:03.600580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [5.1660999e-04 6.1872462e-04 9.9802834e-01 2.8089224e-04 4.9676059e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 4 1 3 0] pred: [0.02865957 0.04161374 0.90677834 0.03964492 0.08200631]
 Top predictions indices: [2 4] vs. real classes indices: [3 4]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 0 3] pred: [8.5345830e-04 1.0142694e-03 9.9673551e-01 5.0180074e-04 9.4197009e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [5.1542657e-04 6.1827363e-04 9.9803501e-01 2.8001977e-04 4.9546018e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [5.2732084e-04 6.0689589e-04 9.9791068e-01 2.9808233e-04 5.2565674e-04]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [5.2243541e-04 6.2146125e-04 9.9803323e-01 2.8398895e-04 5.0762662e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [5.1657844e-04 6.1814755e-04 9.9802774e-01 2.8094501e-04 4.9695623e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 4 3] pred: [5.2238640e-04 6.2373036e-04 9.9799514e-01 2.8576140e-04 5.0715631e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 4 3] pred: [5.1475660e-04 6.1676104e-04 9.9803656e-01 2.8017972e-04 4.9544882e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 4 3] pred: [5.2784511e-04 6.2431704e-04 9.9796957e-01 2.8774841e-04 5.0954905e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 4 3] pred: [5.3044257e-04 6.3102780e-04 9.9796593e-01 2.9072852e-04 5.1523745e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 0 3] pred: [9.2951336e-04 1.1630362e-03 9.9642795e-01 5.6588539e-04 1.0964319e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 4 3] pred: [5.0878851e-04 6.1356602e-04 9.9804282e-01 2.7847826e-04 4.9343565e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 0 1 4 3] pred: [0.00560259 0.00340444 0.98638076 0.00270875 0.0030315 ]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [5.1639898e-04 6.1865326e-04 9.9803096e-01 2.8049326e-04 4.9635803e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:38 - loss: 2.5142 - accuracy: 0.0469 3/11 [=======>......................] - ETA: 0s - loss: 2.5060 - accuracy: 0.1437   5/11 [============>.................] - ETA: 0s - loss: 2.4981 - accuracy: 0.2041 8/11 [====================>.........] - ETA: 0s - loss: 2.4864 - accuracy: 0.261910/11 [==========================>...] - ETA: 0s - loss: 2.4784 - accuracy: 0.286111/11 [==============================] - 16s 26ms/step - loss: 2.4714 - accuracy: 0.3028
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3257 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 2.3171 - accuracy: 0.4622 6/11 [===============>..............] - ETA: 0s - loss: 2.2996 - accuracy: 0.4577 8/11 [====================>.........] - ETA: 0s - loss: 2.2878 - accuracy: 0.457310/11 [==========================>...] - ETA: 0s - loss: 2.2756 - accuracy: 0.457511/11 [==============================] - 0s 26ms/step - loss: 2.2647 - accuracy: 0.4568
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 2.0486 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 1.9989 - accuracy: 0.4769 6/11 [===============>..............] - ETA: 0s - loss: 1.9752 - accuracy: 0.4709 8/11 [====================>.........] - ETA: 0s - loss: 1.9528 - accuracy: 0.465810/11 [==========================>...] - ETA: 0s - loss: 1.9292 - accuracy: 0.462211/11 [==============================] - 0s 27ms/step - loss: 1.9078 - accuracy: 0.4607
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.4050 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 0s - loss: 1.3960 - accuracy: 0.4671 6/11 [===============>..............] - ETA: 0s - loss: 1.3683 - accuracy: 0.4603 8/11 [====================>.........] - ETA: 0s - loss: 1.3426 - accuracy: 0.458010/11 [==========================>...] - ETA: 0s - loss: 1.3185 - accuracy: 0.456811/11 [==============================] - 0s 26ms/step - loss: 1.2986 - accuracy: 0.4562
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9686 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.9302 - accuracy: 0.4445 6/11 [===============>..............] - ETA: 0s - loss: 0.9193 - accuracy: 0.4534 8/11 [====================>.........] - ETA: 0s - loss: 0.9148 - accuracy: 0.455810/11 [==========================>...] - ETA: 0s - loss: 0.9128 - accuracy: 0.455511/11 [==============================] - 0s 27ms/step - loss: 0.9117 - accuracy: 0.4551
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8255 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8276 - accuracy: 0.4905 6/11 [===============>..............] - ETA: 0s - loss: 0.8418 - accuracy: 0.4810 8/11 [====================>.........] - ETA: 0s - loss: 0.8496 - accuracy: 0.473910/11 [==========================>...] - ETA: 0s - loss: 0.8528 - accuracy: 0.469811/11 [==============================] - 0s 25ms/step - loss: 0.8548 - accuracy: 0.4670
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9169 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.8855 - accuracy: 0.4280 6/11 [===============>..............] - ETA: 0s - loss: 0.8753 - accuracy: 0.4382 9/11 [=======================>......] - ETA: 0s - loss: 0.8712 - accuracy: 0.441211/11 [==============================] - 0s 25ms/step - loss: 0.8674 - accuracy: 0.4438
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 1.0100 - accuracy: 0.3828 3/11 [=======>......................] - ETA: 0s - loss: 0.9259 - accuracy: 0.4284 5/11 [============>.................] - ETA: 0s - loss: 0.9018 - accuracy: 0.4395 7/11 [==================>...........] - ETA: 0s - loss: 0.8872 - accuracy: 0.4460 9/11 [=======================>......] - ETA: 0s - loss: 0.8799 - accuracy: 0.447911/11 [==============================] - 0s 26ms/step - loss: 0.8731 - accuracy: 0.4490
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8104 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.8261 - accuracy: 0.4676 7/11 [==================>...........] - ETA: 0s - loss: 0.8353 - accuracy: 0.462710/11 [==========================>...] - ETA: 0s - loss: 0.8384 - accuracy: 0.459711/11 [==============================] - 0s 25ms/step - loss: 0.8402 - accuracy: 0.4586
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8720 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8210 - accuracy: 0.4753 5/11 [============>.................] - ETA: 0s - loss: 0.8133 - accuracy: 0.4802 8/11 [====================>.........] - ETA: 0s - loss: 0.8226 - accuracy: 0.472411/11 [==============================] - ETA: 0s - loss: 0.8295 - accuracy: 0.467111/11 [==============================] - 0s 26ms/step - loss: 0.8310 - accuracy: 0.4659
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7223 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.7854 - accuracy: 0.5022 5/11 [============>.................] - ETA: 0s - loss: 0.8152 - accuracy: 0.4865 8/11 [====================>.........] - ETA: 0s - loss: 0.8349 - accuracy: 0.473310/11 [==========================>...] - ETA: 0s - loss: 0.8386 - accuracy: 0.468611/11 [==============================] - 0s 26ms/step - loss: 0.8401 - accuracy: 0.4661
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8007 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.8545 - accuracy: 0.4535 6/11 [===============>..............] - ETA: 0s - loss: 0.8579 - accuracy: 0.4490 8/11 [====================>.........] - ETA: 0s - loss: 0.8524 - accuracy: 0.452011/11 [==============================] - ETA: 0s - loss: 0.8492 - accuracy: 0.453311/11 [==============================] - 0s 26ms/step - loss: 0.8490 - accuracy: 0.4533
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6770 - accuracy: 0.5625 4/11 [=========>....................] - ETA: 0s - loss: 0.7625 - accuracy: 0.5142 6/11 [===============>..............] - ETA: 0s - loss: 0.7827 - accuracy: 0.5017 9/11 [=======================>......] - ETA: 0s - loss: 0.8019 - accuracy: 0.488711/11 [==============================] - ETA: 0s - loss: 0.8096 - accuracy: 0.482711/11 [==============================] - 0s 27ms/step - loss: 0.8126 - accuracy: 0.4802
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8070 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.8264 - accuracy: 0.4592 6/11 [===============>..............] - ETA: 0s - loss: 0.8410 - accuracy: 0.4588 8/11 [====================>.........] - ETA: 0s - loss: 0.8434 - accuracy: 0.458011/11 [==============================] - ETA: 0s - loss: 0.8433 - accuracy: 0.457511/11 [==============================] - 0s 26ms/step - loss: 0.8435 - accuracy: 0.4572
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8530 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8457 - accuracy: 0.4375 6/11 [===============>..............] - ETA: 0s - loss: 0.8485 - accuracy: 0.4410 8/11 [====================>.........] - ETA: 0s - loss: 0.8521 - accuracy: 0.440610/11 [==========================>...] - ETA: 0s - loss: 0.8515 - accuracy: 0.442211/11 [==============================] - 0s 26ms/step - loss: 0.8505 - accuracy: 0.4441
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8436 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.8333 - accuracy: 0.4754 6/11 [===============>..............] - ETA: 0s - loss: 0.8307 - accuracy: 0.4733 8/11 [====================>.........] - ETA: 0s - loss: 0.8278 - accuracy: 0.471311/11 [==============================] - ETA: 0s - loss: 0.8307 - accuracy: 0.467511/11 [==============================] - 0s 26ms/step - loss: 0.8319 - accuracy: 0.4663
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9147 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.9392 - accuracy: 0.3989 6/11 [===============>..............] - ETA: 0s - loss: 0.9166 - accuracy: 0.4150 9/11 [=======================>......] - ETA: 0s - loss: 0.8978 - accuracy: 0.425711/11 [==============================] - ETA: 0s - loss: 0.8885 - accuracy: 0.430411/11 [==============================] - 0s 26ms/step - loss: 0.8849 - accuracy: 0.4323
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8536 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.8515 - accuracy: 0.4442 6/11 [===============>..............] - ETA: 0s - loss: 0.8497 - accuracy: 0.4434 8/11 [====================>.........] - ETA: 0s - loss: 0.8498 - accuracy: 0.444110/11 [==========================>...] - ETA: 0s - loss: 0.8482 - accuracy: 0.445811/11 [==============================] - 0s 26ms/step - loss: 0.8475 - accuracy: 0.4470
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7206 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.7608 - accuracy: 0.5117 5/11 [============>.................] - ETA: 0s - loss: 0.7828 - accuracy: 0.4998 8/11 [====================>.........] - ETA: 0s - loss: 0.8020 - accuracy: 0.486611/11 [==============================] - ETA: 0s - loss: 0.8130 - accuracy: 0.478511/11 [==============================] - 0s 25ms/step - loss: 0.8156 - accuracy: 0.4763
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8900 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8734 - accuracy: 0.4553 5/11 [============>.................] - ETA: 0s - loss: 0.8601 - accuracy: 0.4537 8/11 [====================>.........] - ETA: 0s - loss: 0.8454 - accuracy: 0.456611/11 [==============================] - ETA: 0s - loss: 0.8428 - accuracy: 0.456211/11 [==============================] - 0s 26ms/step - loss: 0.8428 - accuracy: 0.4560
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.8289 - accuracy: 0.49226/6 [==============================] - 5s 10ms/step - loss: 0.8281 - accuracy: 0.4688
2021-12-13 23:45:39.641874: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:45:39.642840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:45:39.642899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:45:39.642950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:45:39.642980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:45:39.643030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:45:39.643078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:45:39.643110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:45:39.643141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:45:39.643177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:45:39.643871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:45:39.643914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:45:39.643926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:45:39.643943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:45:39.644681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:45:39.645053: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:45:39.645419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:45:39.645447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:45:39.645473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:45:39.645500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:45:39.645525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:45:39.645551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:45:39.645581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:45:39.645611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:45:39.645640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:45:39.646319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:45:39.646348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:45:39.646359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:45:39.646368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:45:39.647080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [4.0833597e-04 1.3859060e-03 9.9810708e-01 1.0438987e-04 2.7171153e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [4.3588207e-04 1.4175152e-03 9.9792153e-01 1.1451285e-04 3.0332513e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 4 3] pred: [4.3992093e-04 1.4258715e-03 9.9791914e-01 1.1530968e-04 3.0536088e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [4.0931298e-04 1.3797974e-03 9.9809211e-01 1.0582420e-04 2.7623662e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [4.11075569e-04 1.38513488e-03 9.98095810e-01 1.04776715e-04
 2.73705489e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [4.1039757e-04 1.3874242e-03 9.9809819e-01 1.0476922e-04 2.7308357e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [1.0860038e-03 1.8977642e-03 9.9544948e-01 2.3546966e-04 5.9929822e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 4 3] pred: [1.0820079e-03 2.4429858e-03 9.9468863e-01 3.1426773e-04 8.5446815e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 4 3] pred: [4.1025679e-04 1.3845732e-03 9.9809974e-01 1.0457907e-04 2.7306558e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 4 3] pred: [4.1316365e-04 1.3833755e-03 9.9808806e-01 1.0486597e-04 2.7502468e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 4 3] pred: [4.09744564e-04 1.38606189e-03 9.98101652e-01 1.04578976e-04
 2.72593752e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [9.6875185e-04 2.3661037e-03 9.9501848e-01 3.0104510e-04 8.4325799e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 4 3] pred: [6.0371775e-04 1.5420686e-03 9.9698228e-01 1.6662799e-04 4.7012724e-04]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [4.1380161e-04 1.3834664e-03 9.9808538e-01 1.0497202e-04 2.7545739e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [6.7477638e-04 1.8443001e-03 9.9665737e-01 1.9199871e-04 5.3107215e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:33 - loss: 2.5047 - accuracy: 0.0703 3/11 [=======>......................] - ETA: 0s - loss: 2.4973 - accuracy: 0.2092   6/11 [===============>..............] - ETA: 0s - loss: 2.4872 - accuracy: 0.2884 8/11 [====================>.........] - ETA: 0s - loss: 2.4803 - accuracy: 0.316511/11 [==============================] - ETA: 0s - loss: 2.4700 - accuracy: 0.341111/11 [==============================] - 16s 25ms/step - loss: 2.4672 - accuracy: 0.3466
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3376 - accuracy: 0.3672 4/11 [=========>....................] - ETA: 0s - loss: 2.3197 - accuracy: 0.4139 6/11 [===============>..............] - ETA: 0s - loss: 2.3069 - accuracy: 0.4266 9/11 [=======================>......] - ETA: 0s - loss: 2.2871 - accuracy: 0.436511/11 [==============================] - ETA: 0s - loss: 2.2727 - accuracy: 0.440811/11 [==============================] - 0s 26ms/step - loss: 2.2668 - accuracy: 0.4425
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 2.0101 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 1.9515 - accuracy: 0.4647 7/11 [==================>...........] - ETA: 0s - loss: 1.9047 - accuracy: 0.4672 9/11 [=======================>......] - ETA: 0s - loss: 1.8740 - accuracy: 0.465311/11 [==============================] - ETA: 0s - loss: 1.8427 - accuracy: 0.464711/11 [==============================] - 0s 26ms/step - loss: 1.8301 - accuracy: 0.4645
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.2368 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 1.2034 - accuracy: 0.4809 5/11 [============>.................] - ETA: 0s - loss: 1.1737 - accuracy: 0.4792 8/11 [====================>.........] - ETA: 0s - loss: 1.1414 - accuracy: 0.475511/11 [==============================] - ETA: 0s - loss: 1.1163 - accuracy: 0.472611/11 [==============================] - 0s 25ms/step - loss: 1.1100 - accuracy: 0.4716
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9477 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8743 - accuracy: 0.4727 5/11 [============>.................] - ETA: 0s - loss: 0.8636 - accuracy: 0.4755 7/11 [==================>...........] - ETA: 0s - loss: 0.8642 - accuracy: 0.4740 9/11 [=======================>......] - ETA: 0s - loss: 0.8668 - accuracy: 0.472011/11 [==============================] - 0s 26ms/step - loss: 0.8705 - accuracy: 0.4691
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8678 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8727 - accuracy: 0.4696 6/11 [===============>..............] - ETA: 0s - loss: 0.8791 - accuracy: 0.4656 9/11 [=======================>......] - ETA: 0s - loss: 0.8769 - accuracy: 0.464311/11 [==============================] - ETA: 0s - loss: 0.8738 - accuracy: 0.463711/11 [==============================] - 0s 25ms/step - loss: 0.8726 - accuracy: 0.4635
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9791 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.9356 - accuracy: 0.4314 6/11 [===============>..............] - ETA: 0s - loss: 0.9051 - accuracy: 0.4453 8/11 [====================>.........] - ETA: 0s - loss: 0.8938 - accuracy: 0.448910/11 [==========================>...] - ETA: 0s - loss: 0.8885 - accuracy: 0.449411/11 [==============================] - 0s 26ms/step - loss: 0.8827 - accuracy: 0.4513
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8056 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.8211 - accuracy: 0.4926 5/11 [============>.................] - ETA: 0s - loss: 0.8296 - accuracy: 0.4846 7/11 [==================>...........] - ETA: 0s - loss: 0.8368 - accuracy: 0.478410/11 [==========================>...] - ETA: 0s - loss: 0.8431 - accuracy: 0.472811/11 [==============================] - 0s 26ms/step - loss: 0.8444 - accuracy: 0.4709
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8902 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8632 - accuracy: 0.4614 5/11 [============>.................] - ETA: 0s - loss: 0.8538 - accuracy: 0.4642 7/11 [==================>...........] - ETA: 0s - loss: 0.8532 - accuracy: 0.463710/11 [==========================>...] - ETA: 0s - loss: 0.8526 - accuracy: 0.463511/11 [==============================] - 0s 26ms/step - loss: 0.8521 - accuracy: 0.4632
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8209 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8692 - accuracy: 0.4536 6/11 [===============>..............] - ETA: 0s - loss: 0.8750 - accuracy: 0.4526 8/11 [====================>.........] - ETA: 0s - loss: 0.8706 - accuracy: 0.453710/11 [==========================>...] - ETA: 0s - loss: 0.8664 - accuracy: 0.454911/11 [==============================] - 0s 25ms/step - loss: 0.8635 - accuracy: 0.4560
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9038 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8890 - accuracy: 0.4523 5/11 [============>.................] - ETA: 0s - loss: 0.8746 - accuracy: 0.4588 8/11 [====================>.........] - ETA: 0s - loss: 0.8622 - accuracy: 0.460611/11 [==============================] - ETA: 0s - loss: 0.8569 - accuracy: 0.461311/11 [==============================] - 0s 26ms/step - loss: 0.8562 - accuracy: 0.4613
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8717 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8716 - accuracy: 0.4484 5/11 [============>.................] - ETA: 0s - loss: 0.8792 - accuracy: 0.4460 7/11 [==================>...........] - ETA: 0s - loss: 0.8767 - accuracy: 0.448410/11 [==========================>...] - ETA: 0s - loss: 0.8702 - accuracy: 0.451211/11 [==============================] - 0s 26ms/step - loss: 0.8664 - accuracy: 0.4529
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9432 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.9232 - accuracy: 0.4259 6/11 [===============>..............] - ETA: 0s - loss: 0.9084 - accuracy: 0.4315 8/11 [====================>.........] - ETA: 0s - loss: 0.8965 - accuracy: 0.436711/11 [==============================] - ETA: 0s - loss: 0.8849 - accuracy: 0.442311/11 [==============================] - 0s 25ms/step - loss: 0.8817 - accuracy: 0.4438
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8478 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8801 - accuracy: 0.4449 5/11 [============>.................] - ETA: 0s - loss: 0.8848 - accuracy: 0.4435 7/11 [==================>...........] - ETA: 0s - loss: 0.8840 - accuracy: 0.4430 9/11 [=======================>......] - ETA: 0s - loss: 0.8776 - accuracy: 0.445711/11 [==============================] - 0s 27ms/step - loss: 0.8703 - accuracy: 0.4496
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8944 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.8573 - accuracy: 0.4712 6/11 [===============>..............] - ETA: 0s - loss: 0.8540 - accuracy: 0.4686 8/11 [====================>.........] - ETA: 0s - loss: 0.8527 - accuracy: 0.466411/11 [==============================] - ETA: 0s - loss: 0.8512 - accuracy: 0.464711/11 [==============================] - 0s 25ms/step - loss: 0.8508 - accuracy: 0.4644
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9783 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.9333 - accuracy: 0.4210 5/11 [============>.................] - ETA: 0s - loss: 0.9124 - accuracy: 0.4320 8/11 [====================>.........] - ETA: 0s - loss: 0.8991 - accuracy: 0.437610/11 [==========================>...] - ETA: 0s - loss: 0.8906 - accuracy: 0.441511/11 [==============================] - 0s 27ms/step - loss: 0.8832 - accuracy: 0.4448
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6989 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.7653 - accuracy: 0.5035 5/11 [============>.................] - ETA: 0s - loss: 0.7727 - accuracy: 0.4965 8/11 [====================>.........] - ETA: 0s - loss: 0.7858 - accuracy: 0.488210/11 [==========================>...] - ETA: 0s - loss: 0.7964 - accuracy: 0.483111/11 [==============================] - 0s 27ms/step - loss: 0.8046 - accuracy: 0.4795
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8156 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.8757 - accuracy: 0.4566 5/11 [============>.................] - ETA: 0s - loss: 0.8838 - accuracy: 0.4549 8/11 [====================>.........] - ETA: 0s - loss: 0.8742 - accuracy: 0.457410/11 [==========================>...] - ETA: 0s - loss: 0.8682 - accuracy: 0.458711/11 [==============================] - 0s 25ms/step - loss: 0.8644 - accuracy: 0.4591
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9563 - accuracy: 0.3828 3/11 [=======>......................] - ETA: 0s - loss: 0.9175 - accuracy: 0.4184 6/11 [===============>..............] - ETA: 0s - loss: 0.8806 - accuracy: 0.4430 9/11 [=======================>......] - ETA: 0s - loss: 0.8675 - accuracy: 0.450611/11 [==============================] - ETA: 0s - loss: 0.8633 - accuracy: 0.452611/11 [==============================] - 0s 26ms/step - loss: 0.8618 - accuracy: 0.4533
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8074 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8135 - accuracy: 0.4818 5/11 [============>.................] - ETA: 0s - loss: 0.8167 - accuracy: 0.4794 7/11 [==================>...........] - ETA: 0s - loss: 0.8211 - accuracy: 0.4761 9/11 [=======================>......] - ETA: 0s - loss: 0.8242 - accuracy: 0.474111/11 [==============================] - 0s 27ms/step - loss: 0.8291 - accuracy: 0.4712
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.8383 - accuracy: 0.45316/6 [==============================] - 5s 9ms/step - loss: 0.8325 - accuracy: 0.4533
2021-12-13 23:46:16.074467: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:46:16.075506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:46:16.075566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:46:16.075608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:46:16.075635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:46:16.075675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:46:16.075707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:46:16.075742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:46:16.075773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:46:16.075809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:46:16.076549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:46:16.076592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:46:16.076604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:46:16.076614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:46:16.077397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:46:16.077718: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:46:16.078114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:46:16.078142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:46:16.078169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:46:16.078195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:46:16.078221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:46:16.078247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:46:16.078275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:46:16.078302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:46:16.078332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:46:16.079078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:46:16.079106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:46:16.079118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:46:16.079127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:46:16.079865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [7.5004157e-04 1.3230104e-03 9.9851841e-01 5.3541583e-04 3.3430633e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [7.6451676e-04 1.3299438e-03 9.9849200e-01 5.4374331e-04 3.4047104e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [7.4952532e-04 1.3198685e-03 9.9851793e-01 5.3549238e-04 3.3353720e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [7.4750849e-04 1.3165132e-03 9.9852437e-01 5.3328252e-04 3.3193902e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [7.9961371e-04 1.3787124e-03 9.9838316e-01 5.6351261e-04 3.4885411e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 3 4] pred: [7.5088762e-04 1.3182636e-03 9.9851888e-01 5.3528743e-04 3.3359570e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [7.5764413e-04 1.3253638e-03 9.9850839e-01 5.4050545e-04 3.3692180e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [7.9002895e-04 1.3529513e-03 9.9841249e-01 5.6580856e-04 3.5935396e-04]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 3 4] pred: [7.5004128e-04 1.3199792e-03 9.9851507e-01 5.3632876e-04 3.3409669e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [7.8984007e-04 1.3581346e-03 9.9845326e-01 5.4271106e-04 3.3782335e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [7.8643666e-04 1.3552790e-03 9.9845970e-01 5.4094818e-04 3.3634622e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [2 0 1 3 4] pred: [0.01089083 0.00981818 0.9834842  0.00737865 0.00555211]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [7.4947363e-04 1.3173517e-03 9.9852151e-01 5.3451961e-04 3.3290248e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [7.4778171e-04 1.3162657e-03 9.9852377e-01 5.3353718e-04 3.3216126e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [7.4970612e-04 1.3174623e-03 9.9852115e-01 5.3463195e-04 3.3300783e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:30 - loss: 2.5052 - accuracy: 0.0469 4/11 [=========>....................] - ETA: 0s - loss: 2.4944 - accuracy: 0.1455   6/11 [===============>..............] - ETA: 0s - loss: 2.4873 - accuracy: 0.2033 9/11 [=======================>......] - ETA: 0s - loss: 2.4764 - accuracy: 0.256111/11 [==============================] - ETA: 0s - loss: 2.4693 - accuracy: 0.278811/11 [==============================] - 15s 26ms/step - loss: 2.4665 - accuracy: 0.2875
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3499 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 2.3302 - accuracy: 0.4349 5/11 [============>.................] - ETA: 0s - loss: 2.3176 - accuracy: 0.4414 8/11 [====================>.........] - ETA: 0s - loss: 2.3000 - accuracy: 0.441211/11 [==============================] - ETA: 0s - loss: 2.2795 - accuracy: 0.445511/11 [==============================] - 0s 24ms/step - loss: 2.2740 - accuracy: 0.4464
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 2.0237 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 1.9987 - accuracy: 0.4510 6/11 [===============>..............] - ETA: 0s - loss: 1.9718 - accuracy: 0.4536 8/11 [====================>.........] - ETA: 0s - loss: 1.9423 - accuracy: 0.454810/11 [==========================>...] - ETA: 0s - loss: 1.9122 - accuracy: 0.454411/11 [==============================] - 0s 25ms/step - loss: 1.8852 - accuracy: 0.4547
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.3267 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 1.2922 - accuracy: 0.4484 6/11 [===============>..............] - ETA: 0s - loss: 1.2389 - accuracy: 0.4530 8/11 [====================>.........] - ETA: 0s - loss: 1.2069 - accuracy: 0.455611/11 [==============================] - ETA: 0s - loss: 1.1721 - accuracy: 0.456811/11 [==============================] - 0s 25ms/step - loss: 1.1639 - accuracy: 0.4568
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8896 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.9106 - accuracy: 0.4427 7/11 [==================>...........] - ETA: 0s - loss: 0.9082 - accuracy: 0.441310/11 [==========================>...] - ETA: 0s - loss: 0.9001 - accuracy: 0.444211/11 [==============================] - 0s 24ms/step - loss: 0.8950 - accuracy: 0.4462
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7809 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.8242 - accuracy: 0.4619 7/11 [==================>...........] - ETA: 0s - loss: 0.8235 - accuracy: 0.4635 9/11 [=======================>......] - ETA: 0s - loss: 0.8275 - accuracy: 0.462711/11 [==============================] - ETA: 0s - loss: 0.8315 - accuracy: 0.461811/11 [==============================] - 0s 25ms/step - loss: 0.8332 - accuracy: 0.4613
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8217 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.8397 - accuracy: 0.4661 6/11 [===============>..............] - ETA: 0s - loss: 0.8353 - accuracy: 0.4672 8/11 [====================>.........] - ETA: 0s - loss: 0.8316 - accuracy: 0.467811/11 [==============================] - ETA: 0s - loss: 0.8341 - accuracy: 0.465811/11 [==============================] - 0s 25ms/step - loss: 0.8352 - accuracy: 0.4650
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7574 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.8000 - accuracy: 0.4622 6/11 [===============>..............] - ETA: 0s - loss: 0.8120 - accuracy: 0.4621 8/11 [====================>.........] - ETA: 0s - loss: 0.8189 - accuracy: 0.461210/11 [==========================>...] - ETA: 0s - loss: 0.8235 - accuracy: 0.460611/11 [==============================] - 0s 24ms/step - loss: 0.8273 - accuracy: 0.4598
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8165 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.7999 - accuracy: 0.5009 5/11 [============>.................] - ETA: 0s - loss: 0.8098 - accuracy: 0.4878 8/11 [====================>.........] - ETA: 0s - loss: 0.8245 - accuracy: 0.475610/11 [==========================>...] - ETA: 0s - loss: 0.8302 - accuracy: 0.471411/11 [==============================] - 0s 25ms/step - loss: 0.8328 - accuracy: 0.4688
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7390 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.7872 - accuracy: 0.5026 6/11 [===============>..............] - ETA: 0s - loss: 0.8097 - accuracy: 0.4860 9/11 [=======================>......] - ETA: 0s - loss: 0.8216 - accuracy: 0.476711/11 [==============================] - ETA: 0s - loss: 0.8257 - accuracy: 0.472911/11 [==============================] - 0s 25ms/step - loss: 0.8273 - accuracy: 0.4715
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8858 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.8436 - accuracy: 0.4634 6/11 [===============>..............] - ETA: 0s - loss: 0.8356 - accuracy: 0.4678 8/11 [====================>.........] - ETA: 0s - loss: 0.8367 - accuracy: 0.465510/11 [==========================>...] - ETA: 0s - loss: 0.8368 - accuracy: 0.463911/11 [==============================] - 0s 25ms/step - loss: 0.8381 - accuracy: 0.4626
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7408 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.7540 - accuracy: 0.4957 6/11 [===============>..............] - ETA: 0s - loss: 0.7768 - accuracy: 0.4866 8/11 [====================>.........] - ETA: 0s - loss: 0.7914 - accuracy: 0.480711/11 [==============================] - ETA: 0s - loss: 0.8050 - accuracy: 0.475011/11 [==============================] - 0s 25ms/step - loss: 0.8082 - accuracy: 0.4734
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9101 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.8557 - accuracy: 0.4423 5/11 [============>.................] - ETA: 0s - loss: 0.8362 - accuracy: 0.4573 7/11 [==================>...........] - ETA: 0s - loss: 0.8346 - accuracy: 0.4593 9/11 [=======================>......] - ETA: 0s - loss: 0.8356 - accuracy: 0.459211/11 [==============================] - 0s 26ms/step - loss: 0.8370 - accuracy: 0.4587
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 1.0043 - accuracy: 0.3594 4/11 [=========>....................] - ETA: 0s - loss: 0.9348 - accuracy: 0.4033 7/11 [==================>...........] - ETA: 0s - loss: 0.9045 - accuracy: 0.423510/11 [==========================>...] - ETA: 0s - loss: 0.8917 - accuracy: 0.430711/11 [==============================] - 0s 24ms/step - loss: 0.8837 - accuracy: 0.4349
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8389 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.8356 - accuracy: 0.4313 6/11 [===============>..............] - ETA: 0s - loss: 0.8467 - accuracy: 0.4317 9/11 [=======================>......] - ETA: 0s - loss: 0.8455 - accuracy: 0.438611/11 [==============================] - ETA: 0s - loss: 0.8451 - accuracy: 0.441811/11 [==============================] - 0s 25ms/step - loss: 0.8450 - accuracy: 0.4430
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9076 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.8802 - accuracy: 0.4463 6/11 [===============>..............] - ETA: 0s - loss: 0.8771 - accuracy: 0.4474 8/11 [====================>.........] - ETA: 0s - loss: 0.8737 - accuracy: 0.447811/11 [==============================] - ETA: 0s - loss: 0.8667 - accuracy: 0.449711/11 [==============================] - 0s 26ms/step - loss: 0.8647 - accuracy: 0.4503
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8929 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8527 - accuracy: 0.4583 6/11 [===============>..............] - ETA: 0s - loss: 0.8475 - accuracy: 0.4544 8/11 [====================>.........] - ETA: 0s - loss: 0.8483 - accuracy: 0.453010/11 [==========================>...] - ETA: 0s - loss: 0.8477 - accuracy: 0.453011/11 [==============================] - 0s 25ms/step - loss: 0.8468 - accuracy: 0.4535
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8698 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8493 - accuracy: 0.4549 5/11 [============>.................] - ETA: 0s - loss: 0.8225 - accuracy: 0.4654 8/11 [====================>.........] - ETA: 0s - loss: 0.8250 - accuracy: 0.463911/11 [==============================] - ETA: 0s - loss: 0.8296 - accuracy: 0.462011/11 [==============================] - 0s 23ms/step - loss: 0.8307 - accuracy: 0.4615
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8065 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.8071 - accuracy: 0.4756 6/11 [===============>..............] - ETA: 0s - loss: 0.8141 - accuracy: 0.4727 8/11 [====================>.........] - ETA: 0s - loss: 0.8192 - accuracy: 0.468810/11 [==========================>...] - ETA: 0s - loss: 0.8213 - accuracy: 0.467411/11 [==============================] - 0s 26ms/step - loss: 0.8247 - accuracy: 0.4655
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9401 - accuracy: 0.4062 4/11 [=========>....................] - ETA: 0s - loss: 0.8588 - accuracy: 0.4451 6/11 [===============>..............] - ETA: 0s - loss: 0.8473 - accuracy: 0.4503 9/11 [=======================>......] - ETA: 0s - loss: 0.8414 - accuracy: 0.453311/11 [==============================] - 0s 25ms/step - loss: 0.8410 - accuracy: 0.4542
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.7910 - accuracy: 0.50006/6 [==============================] - 5s 9ms/step - loss: 0.8368 - accuracy: 0.4632
2021-12-13 23:46:52.366569: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:46:52.367720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:46:52.367795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:46:52.367855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:46:52.367896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:46:52.367952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:46:52.367999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:46:52.368057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:46:52.368107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:46:52.368154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:46:52.369396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:46:52.369440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:46:52.369452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:46:52.369461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:46:52.370224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:46:52.370525: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:46:52.370895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:46:52.370923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:46:52.371232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:46:52.371276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:46:52.371301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:46:52.371329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:46:52.371358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:46:52.371384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:46:52.371411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:46:52.372089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:46:52.372117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:46:52.372128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:46:52.372137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:46:52.372840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 4 0 1 3] pred: [5.7365245e-04 3.9778452e-04 9.9848783e-01 3.2249090e-04 6.2690210e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 4 0 1 3] pred: [5.7345460e-04 3.9733961e-04 9.9848998e-01 3.2212801e-04 6.2643056e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 4 0 1 3] pred: [5.7687919e-04 3.9915336e-04 9.9848408e-01 3.2282990e-04 6.2848534e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 4 0 1 3] pred: [5.7837449e-04 4.0022310e-04 9.9848783e-01 3.2387310e-04 6.3044229e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 4 0 1 3] pred: [5.9397926e-04 4.0367970e-04 9.9843699e-01 3.2731082e-04 6.4726220e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 4 0 1 3] pred: [5.8709353e-04 4.0227137e-04 9.9844933e-01 3.2949116e-04 6.4607552e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 4 0 1 3] pred: [5.7403964e-04 3.9768804e-04 9.9848914e-01 3.2222478e-04 6.2662881e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 0 1 3] pred: [5.7672942e-04 3.9930004e-04 9.9848276e-01 3.2309222e-04 6.2884425e-04]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 8 ============
pred sorted: [2 4 0 1 3] pred: [5.8025349e-04 3.9438723e-04 9.9845159e-01 3.2349073e-04 6.3615269e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 4 0 1 3] pred: [5.7866256e-04 4.0077575e-04 9.9847275e-01 3.2490015e-04 6.3243730e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 4 0 1 3] pred: [5.7727739e-04 4.0004816e-04 9.9848855e-01 3.2381568e-04 6.2943820e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 4 0 1 3] pred: [5.7704444e-04 4.0032686e-04 9.9848711e-01 3.2400404e-04 6.2957196e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 4 0 1 3] pred: [0.00185035 0.00119529 0.9952427  0.00102711 0.001945  ]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 4 0 1 3] pred: [5.7379768e-04 3.9782381e-04 9.9848759e-01 3.2251244e-04 6.2697916e-04]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 14 ============
pred sorted: [2 4 0 1 3] pred: [5.7655683e-04 3.9901142e-04 9.9848455e-01 3.2276713e-04 6.2823592e-04]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:38 - loss: 2.4855 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 2.4780 - accuracy: 0.4453   6/11 [===============>..............] - ETA: 0s - loss: 2.4677 - accuracy: 0.4561 9/11 [=======================>......] - ETA: 0s - loss: 2.4568 - accuracy: 0.458711/11 [==============================] - 16s 24ms/step - loss: 2.4465 - accuracy: 0.4598
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3062 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 2.2998 - accuracy: 0.4405 6/11 [===============>..............] - ETA: 0s - loss: 2.2841 - accuracy: 0.4444 8/11 [====================>.........] - ETA: 0s - loss: 2.2717 - accuracy: 0.448711/11 [==============================] - ETA: 0s - loss: 2.2520 - accuracy: 0.451111/11 [==============================] - 0s 23ms/step - loss: 2.2466 - accuracy: 0.4519
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 1.9995 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 1.9747 - accuracy: 0.4349 5/11 [============>.................] - ETA: 0s - loss: 1.9504 - accuracy: 0.4394 8/11 [====================>.........] - ETA: 0s - loss: 1.9142 - accuracy: 0.442111/11 [==============================] - ETA: 0s - loss: 1.8727 - accuracy: 0.446811/11 [==============================] - 0s 24ms/step - loss: 1.8614 - accuracy: 0.4479
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.3254 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 1.3009 - accuracy: 0.4595 7/11 [==================>...........] - ETA: 0s - loss: 1.2670 - accuracy: 0.4542 9/11 [=======================>......] - ETA: 0s - loss: 1.2453 - accuracy: 0.452611/11 [==============================] - 0s 25ms/step - loss: 1.2122 - accuracy: 0.4541
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9996 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.9630 - accuracy: 0.4232 6/11 [===============>..............] - ETA: 0s - loss: 0.9448 - accuracy: 0.4327 8/11 [====================>.........] - ETA: 0s - loss: 0.9341 - accuracy: 0.437611/11 [==============================] - ETA: 0s - loss: 0.9194 - accuracy: 0.443511/11 [==============================] - 0s 25ms/step - loss: 0.9158 - accuracy: 0.4449
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8606 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.8910 - accuracy: 0.4308 7/11 [==================>...........] - ETA: 0s - loss: 0.8749 - accuracy: 0.438810/11 [==========================>...] - ETA: 0s - loss: 0.8675 - accuracy: 0.444211/11 [==============================] - 0s 24ms/step - loss: 0.8650 - accuracy: 0.4469
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8300 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8707 - accuracy: 0.4523 6/11 [===============>..............] - ETA: 0s - loss: 0.8633 - accuracy: 0.4524 8/11 [====================>.........] - ETA: 0s - loss: 0.8587 - accuracy: 0.453210/11 [==========================>...] - ETA: 0s - loss: 0.8560 - accuracy: 0.454511/11 [==============================] - 0s 26ms/step - loss: 0.8545 - accuracy: 0.4555
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9040 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.8653 - accuracy: 0.4421 6/11 [===============>..............] - ETA: 0s - loss: 0.8648 - accuracy: 0.4469 8/11 [====================>.........] - ETA: 0s - loss: 0.8622 - accuracy: 0.449011/11 [==============================] - ETA: 0s - loss: 0.8567 - accuracy: 0.452711/11 [==============================] - 0s 26ms/step - loss: 0.8557 - accuracy: 0.4533
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8833 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.8525 - accuracy: 0.4323 6/11 [===============>..............] - ETA: 0s - loss: 0.8483 - accuracy: 0.4453 9/11 [=======================>......] - ETA: 0s - loss: 0.8516 - accuracy: 0.449011/11 [==============================] - ETA: 0s - loss: 0.8508 - accuracy: 0.450811/11 [==============================] - 0s 25ms/step - loss: 0.8502 - accuracy: 0.4516
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9013 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8919 - accuracy: 0.4306 6/11 [===============>..............] - ETA: 0s - loss: 0.8835 - accuracy: 0.4381 8/11 [====================>.........] - ETA: 0s - loss: 0.8810 - accuracy: 0.439110/11 [==========================>...] - ETA: 0s - loss: 0.8743 - accuracy: 0.443011/11 [==============================] - 0s 25ms/step - loss: 0.8691 - accuracy: 0.4460
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9252 - accuracy: 0.4141 4/11 [=========>....................] - ETA: 0s - loss: 0.8554 - accuracy: 0.4487 7/11 [==================>...........] - ETA: 0s - loss: 0.8558 - accuracy: 0.4521 9/11 [=======================>......] - ETA: 0s - loss: 0.8529 - accuracy: 0.454811/11 [==============================] - ETA: 0s - loss: 0.8509 - accuracy: 0.456111/11 [==============================] - 0s 25ms/step - loss: 0.8502 - accuracy: 0.4565
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9164 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.9155 - accuracy: 0.4424 6/11 [===============>..............] - ETA: 0s - loss: 0.9008 - accuracy: 0.4467 8/11 [====================>.........] - ETA: 0s - loss: 0.8907 - accuracy: 0.448911/11 [==============================] - ETA: 0s - loss: 0.8777 - accuracy: 0.452511/11 [==============================] - 0s 24ms/step - loss: 0.8747 - accuracy: 0.4531
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9008 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8404 - accuracy: 0.4852 5/11 [============>.................] - ETA: 0s - loss: 0.8270 - accuracy: 0.4845 8/11 [====================>.........] - ETA: 0s - loss: 0.8306 - accuracy: 0.477011/11 [==============================] - ETA: 0s - loss: 0.8333 - accuracy: 0.472611/11 [==============================] - 0s 25ms/step - loss: 0.8339 - accuracy: 0.4716
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8546 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8216 - accuracy: 0.4748 6/11 [===============>..............] - ETA: 0s - loss: 0.8311 - accuracy: 0.4684 9/11 [=======================>......] - ETA: 0s - loss: 0.8371 - accuracy: 0.465411/11 [==============================] - ETA: 0s - loss: 0.8378 - accuracy: 0.464511/11 [==============================] - 0s 25ms/step - loss: 0.8381 - accuracy: 0.4642
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7536 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.7522 - accuracy: 0.5135 5/11 [============>.................] - ETA: 0s - loss: 0.7820 - accuracy: 0.4948 8/11 [====================>.........] - ETA: 0s - loss: 0.7983 - accuracy: 0.484610/11 [==========================>...] - ETA: 0s - loss: 0.8066 - accuracy: 0.479811/11 [==============================] - 0s 26ms/step - loss: 0.8122 - accuracy: 0.4766
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8004 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.8261 - accuracy: 0.4595 6/11 [===============>..............] - ETA: 0s - loss: 0.8361 - accuracy: 0.4568 9/11 [=======================>......] - ETA: 0s - loss: 0.8408 - accuracy: 0.457011/11 [==============================] - 0s 25ms/step - loss: 0.8413 - accuracy: 0.4576
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8538 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.8730 - accuracy: 0.4351 7/11 [==================>...........] - ETA: 0s - loss: 0.8683 - accuracy: 0.4425 9/11 [=======================>......] - ETA: 0s - loss: 0.8628 - accuracy: 0.445711/11 [==============================] - 0s 25ms/step - loss: 0.8568 - accuracy: 0.4495
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6989 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 0s - loss: 0.7657 - accuracy: 0.4972 7/11 [==================>...........] - ETA: 0s - loss: 0.7909 - accuracy: 0.4877 9/11 [=======================>......] - ETA: 0s - loss: 0.8015 - accuracy: 0.482211/11 [==============================] - 0s 25ms/step - loss: 0.8106 - accuracy: 0.4770
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8298 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.8347 - accuracy: 0.4631 6/11 [===============>..............] - ETA: 0s - loss: 0.8397 - accuracy: 0.4595 9/11 [=======================>......] - ETA: 0s - loss: 0.8418 - accuracy: 0.458611/11 [==============================] - 0s 24ms/step - loss: 0.8414 - accuracy: 0.4588
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8913 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8687 - accuracy: 0.4592 5/11 [============>.................] - ETA: 0s - loss: 0.8692 - accuracy: 0.4547 8/11 [====================>.........] - ETA: 0s - loss: 0.8567 - accuracy: 0.458111/11 [==============================] - ETA: 0s - loss: 0.8505 - accuracy: 0.459311/11 [==============================] - 0s 25ms/step - loss: 0.8495 - accuracy: 0.4594
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.9203 - accuracy: 0.35166/6 [==============================] - ETA: 0s - loss: 0.8373 - accuracy: 0.4547 6/6 [==============================] - 5s 11ms/step - loss: 0.8373 - accuracy: 0.4547
2021-12-13 23:47:28.175040: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:47:28.175648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:47:28.175709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:47:28.175752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:47:28.175779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:47:28.175814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:47:28.175848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:47:28.175882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:47:28.175916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:47:28.175959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:47:28.176655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:47:28.176698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:47:28.176711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:47:28.176721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:47:28.177488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:47:28.177827: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:47:28.178203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:47:28.178232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:47:28.178258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:47:28.178285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:47:28.178311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:47:28.178339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:47:28.178365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:47:28.178394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:47:28.178422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:47:28.179099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:47:28.179126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:47:28.179138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:47:28.179147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:47:28.179849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 4 1 0 3] pred: [3.5111327e-04 3.5725287e-04 9.9683231e-01 1.9744597e-04 7.5888808e-04]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 1 ============
pred sorted: [2 4 1 0 3] pred: [3.5310871e-04 3.5761611e-04 9.9682462e-01 1.9949312e-04 7.6289999e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 4 1 0 3] pred: [3.5327233e-04 3.5704020e-04 9.9684024e-01 1.9890965e-04 7.6027535e-04]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 3 ============
pred sorted: [2 4 1 0 3] pred: [4.1983093e-04 4.3103244e-04 9.9540800e-01 2.5954845e-04 9.8475360e-04]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 4 1 0 3] pred: [3.4114736e-04 3.6870790e-04 9.9662602e-01 1.9753315e-04 7.7883713e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 4 1 0 3] pred: [3.5167587e-04 3.5269756e-04 9.9677819e-01 1.9867632e-04 7.8547950e-04]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 6 ============
pred sorted: [2 4 1 0 3] pred: [3.4194300e-04 3.7173097e-04 9.9660194e-01 1.9681029e-04 7.7729713e-04]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 7 ============
pred sorted: [2 4 1 0 3] pred: [3.5391806e-04 3.5650370e-04 9.9683750e-01 2.0164282e-04 7.6775067e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 4 1 0 3] pred: [3.5133140e-04 3.5589110e-04 9.9685740e-01 1.9796721e-04 7.6014671e-04]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 9 ============
pred sorted: [2 4 1 0 3] pred: [3.5250344e-04 3.5884368e-04 9.9682641e-01 1.9778192e-04 7.6180481e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 4 1 0 3] pred: [3.5164290e-04 3.5607725e-04 9.9685401e-01 1.9824128e-04 7.6042308e-04]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 11 ============
pred sorted: [2 4 1 0 3] pred: [3.4560540e-04 3.8046046e-04 9.9649018e-01 2.0130414e-04 7.8473147e-04]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 12 ============
pred sorted: [2 4 1 0 3] pred: [3.5247806e-04 3.5361992e-04 9.9685669e-01 2.0053671e-04 7.6346146e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 4 1 0 3] pred: [3.3935142e-04 3.8475578e-04 9.9583924e-01 2.0952118e-04 8.2337233e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 4 1 0 3] pred: [3.3972011e-04 3.9237342e-04 9.9599409e-01 2.0646183e-04 7.9492206e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:28 - loss: 2.4985 - accuracy: 0.2734 3/11 [=======>......................] - ETA: 0s - loss: 2.4908 - accuracy: 0.3377   6/11 [===============>..............] - ETA: 0s - loss: 2.4799 - accuracy: 0.3776 9/11 [=======================>......] - ETA: 0s - loss: 2.4687 - accuracy: 0.399911/11 [==============================] - 15s 24ms/step - loss: 2.4582 - accuracy: 0.4126
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3190 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 2.3009 - accuracy: 0.4378 6/11 [===============>..............] - ETA: 0s - loss: 2.2890 - accuracy: 0.4447 9/11 [=======================>......] - ETA: 0s - loss: 2.2702 - accuracy: 0.447611/11 [==============================] - 0s 25ms/step - loss: 2.2506 - accuracy: 0.4508
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 1.9740 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 1.9625 - accuracy: 0.4727 6/11 [===============>..............] - ETA: 0s - loss: 1.9295 - accuracy: 0.4670 8/11 [====================>.........] - ETA: 0s - loss: 1.9026 - accuracy: 0.466511/11 [==============================] - ETA: 0s - loss: 1.8583 - accuracy: 0.467411/11 [==============================] - 0s 24ms/step - loss: 1.8463 - accuracy: 0.4671
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.2741 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 1.2767 - accuracy: 0.4727 6/11 [===============>..............] - ETA: 0s - loss: 1.2495 - accuracy: 0.4728 8/11 [====================>.........] - ETA: 0s - loss: 1.2283 - accuracy: 0.469910/11 [==========================>...] - ETA: 0s - loss: 1.2104 - accuracy: 0.467811/11 [==============================] - 0s 25ms/step - loss: 1.1932 - accuracy: 0.4671
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9568 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.9157 - accuracy: 0.4822 5/11 [============>.................] - ETA: 0s - loss: 0.9182 - accuracy: 0.4799 8/11 [====================>.........] - ETA: 0s - loss: 0.9159 - accuracy: 0.474211/11 [==============================] - ETA: 0s - loss: 0.9128 - accuracy: 0.471511/11 [==============================] - 0s 26ms/step - loss: 0.9122 - accuracy: 0.4708
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8977 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.8930 - accuracy: 0.4587 7/11 [==================>...........] - ETA: 0s - loss: 0.8919 - accuracy: 0.454510/11 [==========================>...] - ETA: 0s - loss: 0.8826 - accuracy: 0.457311/11 [==============================] - 0s 24ms/step - loss: 0.8795 - accuracy: 0.4583
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8718 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8289 - accuracy: 0.4818 5/11 [============>.................] - ETA: 0s - loss: 0.8163 - accuracy: 0.4887 7/11 [==================>...........] - ETA: 0s - loss: 0.8273 - accuracy: 0.482610/11 [==========================>...] - ETA: 0s - loss: 0.8365 - accuracy: 0.477511/11 [==============================] - 0s 26ms/step - loss: 0.8390 - accuracy: 0.4752
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8528 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8415 - accuracy: 0.4631 6/11 [===============>..............] - ETA: 0s - loss: 0.8390 - accuracy: 0.4623 9/11 [=======================>......] - ETA: 0s - loss: 0.8394 - accuracy: 0.463411/11 [==============================] - ETA: 0s - loss: 0.8405 - accuracy: 0.463311/11 [==============================] - 0s 25ms/step - loss: 0.8410 - accuracy: 0.4633
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8268 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.8149 - accuracy: 0.4671 7/11 [==================>...........] - ETA: 0s - loss: 0.8228 - accuracy: 0.466710/11 [==========================>...] - ETA: 0s - loss: 0.8278 - accuracy: 0.466111/11 [==============================] - 0s 25ms/step - loss: 0.8305 - accuracy: 0.4657
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8991 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8641 - accuracy: 0.4583 6/11 [===============>..............] - ETA: 0s - loss: 0.8501 - accuracy: 0.4569 8/11 [====================>.........] - ETA: 0s - loss: 0.8464 - accuracy: 0.457711/11 [==============================] - ETA: 0s - loss: 0.8460 - accuracy: 0.458311/11 [==============================] - 0s 25ms/step - loss: 0.8457 - accuracy: 0.4587
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8127 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 0s - loss: 0.8128 - accuracy: 0.4927 6/11 [===============>..............] - ETA: 0s - loss: 0.8158 - accuracy: 0.4860 8/11 [====================>.........] - ETA: 0s - loss: 0.8178 - accuracy: 0.481011/11 [==============================] - ETA: 0s - loss: 0.8222 - accuracy: 0.476711/11 [==============================] - 0s 25ms/step - loss: 0.8239 - accuracy: 0.4756
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7562 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.7888 - accuracy: 0.4991 5/11 [============>.................] - ETA: 0s - loss: 0.8049 - accuracy: 0.4899 8/11 [====================>.........] - ETA: 0s - loss: 0.8203 - accuracy: 0.480111/11 [==============================] - ETA: 0s - loss: 0.8279 - accuracy: 0.474611/11 [==============================] - 0s 26ms/step - loss: 0.8290 - accuracy: 0.4737
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9090 - accuracy: 0.3906 3/11 [=======>......................] - ETA: 0s - loss: 0.8353 - accuracy: 0.4466 5/11 [============>.................] - ETA: 0s - loss: 0.8253 - accuracy: 0.4606 8/11 [====================>.........] - ETA: 0s - loss: 0.8302 - accuracy: 0.462711/11 [==============================] - ETA: 0s - loss: 0.8337 - accuracy: 0.462411/11 [==============================] - 0s 25ms/step - loss: 0.8343 - accuracy: 0.4625
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8816 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.8444 - accuracy: 0.4674 7/11 [==================>...........] - ETA: 0s - loss: 0.8301 - accuracy: 0.4740 9/11 [=======================>......] - ETA: 0s - loss: 0.8324 - accuracy: 0.471911/11 [==============================] - 0s 26ms/step - loss: 0.8339 - accuracy: 0.4702
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7454 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8242 - accuracy: 0.4505 6/11 [===============>..............] - ETA: 0s - loss: 0.8475 - accuracy: 0.4469 8/11 [====================>.........] - ETA: 0s - loss: 0.8487 - accuracy: 0.448910/11 [==========================>...] - ETA: 0s - loss: 0.8472 - accuracy: 0.451711/11 [==============================] - 0s 26ms/step - loss: 0.8460 - accuracy: 0.4537
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8150 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8423 - accuracy: 0.4557 6/11 [===============>..............] - ETA: 0s - loss: 0.8469 - accuracy: 0.4496 9/11 [=======================>......] - ETA: 0s - loss: 0.8442 - accuracy: 0.452511/11 [==============================] - 0s 26ms/step - loss: 0.8432 - accuracy: 0.4551
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9159 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.8448 - accuracy: 0.4604 6/11 [===============>..............] - ETA: 0s - loss: 0.8478 - accuracy: 0.4583 8/11 [====================>.........] - ETA: 0s - loss: 0.8488 - accuracy: 0.458111/11 [==============================] - ETA: 0s - loss: 0.8470 - accuracy: 0.459011/11 [==============================] - 0s 26ms/step - loss: 0.8464 - accuracy: 0.4594
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8182 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.8544 - accuracy: 0.4813 5/11 [============>.................] - ETA: 0s - loss: 0.8523 - accuracy: 0.4754 7/11 [==================>...........] - ETA: 0s - loss: 0.8435 - accuracy: 0.476210/11 [==========================>...] - ETA: 0s - loss: 0.8417 - accuracy: 0.474011/11 [==============================] - 0s 26ms/step - loss: 0.8412 - accuracy: 0.4722
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8381 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.8637 - accuracy: 0.4417 6/11 [===============>..............] - ETA: 0s - loss: 0.8526 - accuracy: 0.4492 9/11 [=======================>......] - ETA: 0s - loss: 0.8475 - accuracy: 0.453411/11 [==============================] - ETA: 0s - loss: 0.8463 - accuracy: 0.455011/11 [==============================] - 0s 26ms/step - loss: 0.8457 - accuracy: 0.4557
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8687 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8686 - accuracy: 0.4679 5/11 [============>.................] - ETA: 0s - loss: 0.8619 - accuracy: 0.4643 8/11 [====================>.........] - ETA: 0s - loss: 0.8614 - accuracy: 0.460711/11 [==============================] - ETA: 0s - loss: 0.8564 - accuracy: 0.460911/11 [==============================] - 0s 26ms/step - loss: 0.8549 - accuracy: 0.4611
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 1.0090 - accuracy: 0.35166/6 [==============================] - 5s 9ms/step - loss: 0.8426 - accuracy: 0.4490
2021-12-13 23:48:04.358684: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:48:04.359290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:48:04.359346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:48:04.359388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:48:04.359415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:48:04.359450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:48:04.359484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:48:04.359515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:48:04.359549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:48:04.359583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:48:04.360341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:48:04.360385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:48:04.360397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:48:04.360406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:48:04.361225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:48:04.361567: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:48:04.361972: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:48:04.362000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:48:04.362026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:48:04.362053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:48:04.362078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:48:04.362103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:48:04.362131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:48:04.362159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:48:04.362185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:48:04.362933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:48:04.362975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:48:04.362987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:48:04.362996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:48:04.363780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 4 0 3] pred: [9.8625908e-04 4.1329339e-03 9.9375051e-01 6.2488561e-04 1.2304954e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 4 0 3] pred: [2.8459824e-04 2.2330363e-03 9.9808311e-01 1.4068186e-04 3.4843382e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 0 3] pred: [2.8229933e-04 2.2309325e-03 9.9809414e-01 1.3957843e-04 3.4481109e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 4 0 3] pred: [2.9147230e-04 2.2599634e-03 9.9804807e-01 1.4054657e-04 3.5739626e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 4 0 3] pred: [3.1632802e-04 2.3415021e-03 9.9778521e-01 1.5439047e-04 3.8306805e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 0 3] pred: [3.3169703e-04 2.3222587e-03 9.9777138e-01 1.4627834e-04 4.1409340e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 0 3] pred: [5.3479098e-04 2.9122599e-03 9.9636567e-01 2.8864472e-04 6.8374403e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 0 3] pred: [2.8228047e-04 2.2258023e-03 9.9809843e-01 1.3930374e-04 3.4564445e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 0 3] pred: [2.9574387e-04 2.2631322e-03 9.9803156e-01 1.4166886e-04 3.6267980e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 4 0 3] pred: [2.8180453e-04 2.2276540e-03 9.9809855e-01 1.3915027e-04 3.4494116e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 4 0 3] pred: [2.8175538e-04 2.2276880e-03 9.9809867e-01 1.3912996e-04 3.4487931e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 0 3] pred: [2.9154736e-04 2.2374368e-03 9.9805379e-01 1.4211942e-04 3.5849813e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 0 3] pred: [2.8802289e-04 2.2365404e-03 9.9805319e-01 1.4400863e-04 3.5256814e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 0 3] pred: [2.8177310e-04 2.2342347e-03 9.9809331e-01 1.3723852e-04 3.4775084e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 4 0 3] pred: [2.9270095e-04 2.2597625e-03 9.9804485e-01 1.4097620e-04 3.5890954e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:37 - loss: 2.5068 - accuracy: 0.0234 4/11 [=========>....................] - ETA: 0s - loss: 2.4958 - accuracy: 0.0778   7/11 [==================>...........] - ETA: 0s - loss: 2.4852 - accuracy: 0.153910/11 [==========================>...] - ETA: 0s - loss: 2.4744 - accuracy: 0.204611/11 [==============================] - 16s 23ms/step - loss: 2.4680 - accuracy: 0.2269
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3439 - accuracy: 0.4062 4/11 [=========>....................] - ETA: 0s - loss: 2.3277 - accuracy: 0.4126 6/11 [===============>..............] - ETA: 0s - loss: 2.3162 - accuracy: 0.4212 9/11 [=======================>......] - ETA: 0s - loss: 2.2973 - accuracy: 0.431711/11 [==============================] - 0s 24ms/step - loss: 2.2795 - accuracy: 0.4370
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 2.0243 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 2.0097 - accuracy: 0.4722 7/11 [==================>...........] - ETA: 0s - loss: 1.9779 - accuracy: 0.466310/11 [==========================>...] - ETA: 0s - loss: 1.9426 - accuracy: 0.463311/11 [==============================] - 0s 25ms/step - loss: 1.9214 - accuracy: 0.4619
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.4667 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 1.4614 - accuracy: 0.4379 6/11 [===============>..............] - ETA: 0s - loss: 1.4034 - accuracy: 0.4437 9/11 [=======================>......] - ETA: 0s - loss: 1.3497 - accuracy: 0.447111/11 [==============================] - 0s 25ms/step - loss: 1.3056 - accuracy: 0.4486
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9040 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.9139 - accuracy: 0.4614 6/11 [===============>..............] - ETA: 0s - loss: 0.9068 - accuracy: 0.4617 9/11 [=======================>......] - ETA: 0s - loss: 0.8990 - accuracy: 0.463011/11 [==============================] - 0s 25ms/step - loss: 0.8961 - accuracy: 0.4613
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8111 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.7891 - accuracy: 0.4790 6/11 [===============>..............] - ETA: 0s - loss: 0.8095 - accuracy: 0.4709 8/11 [====================>.........] - ETA: 0s - loss: 0.8194 - accuracy: 0.468411/11 [==============================] - ETA: 0s - loss: 0.8290 - accuracy: 0.465311/11 [==============================] - 0s 25ms/step - loss: 0.8316 - accuracy: 0.4644
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8371 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.8437 - accuracy: 0.4756 7/11 [==================>...........] - ETA: 0s - loss: 0.8505 - accuracy: 0.4691 9/11 [=======================>......] - ETA: 0s - loss: 0.8503 - accuracy: 0.467111/11 [==============================] - 0s 23ms/step - loss: 0.8513 - accuracy: 0.4643
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9903 - accuracy: 0.3906 3/11 [=======>......................] - ETA: 0s - loss: 0.9213 - accuracy: 0.4223 5/11 [============>.................] - ETA: 0s - loss: 0.8984 - accuracy: 0.4357 8/11 [====================>.........] - ETA: 0s - loss: 0.8877 - accuracy: 0.439811/11 [==============================] - ETA: 0s - loss: 0.8804 - accuracy: 0.442411/11 [==============================] - 0s 25ms/step - loss: 0.8783 - accuracy: 0.4434
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8642 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.8797 - accuracy: 0.4375 6/11 [===============>..............] - ETA: 0s - loss: 0.8712 - accuracy: 0.4463 8/11 [====================>.........] - ETA: 0s - loss: 0.8630 - accuracy: 0.453011/11 [==============================] - ETA: 0s - loss: 0.8591 - accuracy: 0.455011/11 [==============================] - 0s 25ms/step - loss: 0.8586 - accuracy: 0.4550
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 1.0656 - accuracy: 0.3438 3/11 [=======>......................] - ETA: 0s - loss: 0.9838 - accuracy: 0.3898 5/11 [============>.................] - ETA: 0s - loss: 0.9372 - accuracy: 0.4171 8/11 [====================>.........] - ETA: 0s - loss: 0.9114 - accuracy: 0.428411/11 [==============================] - ETA: 0s - loss: 0.8950 - accuracy: 0.435711/11 [==============================] - 0s 25ms/step - loss: 0.8915 - accuracy: 0.4373
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8528 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.8437 - accuracy: 0.4536 6/11 [===============>..............] - ETA: 0s - loss: 0.8464 - accuracy: 0.4561 9/11 [=======================>......] - ETA: 0s - loss: 0.8555 - accuracy: 0.453311/11 [==============================] - 0s 25ms/step - loss: 0.8554 - accuracy: 0.4534
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8571 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8456 - accuracy: 0.4640 6/11 [===============>..............] - ETA: 0s - loss: 0.8457 - accuracy: 0.4634 9/11 [=======================>......] - ETA: 0s - loss: 0.8456 - accuracy: 0.462211/11 [==============================] - 0s 24ms/step - loss: 0.8477 - accuracy: 0.4602
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9568 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.8665 - accuracy: 0.4497 5/11 [============>.................] - ETA: 0s - loss: 0.8459 - accuracy: 0.4598 8/11 [====================>.........] - ETA: 0s - loss: 0.8415 - accuracy: 0.461910/11 [==========================>...] - ETA: 0s - loss: 0.8422 - accuracy: 0.461211/11 [==============================] - 0s 25ms/step - loss: 0.8438 - accuracy: 0.4601
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7999 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.8010 - accuracy: 0.4952 6/11 [===============>..............] - ETA: 0s - loss: 0.8199 - accuracy: 0.4795 9/11 [=======================>......] - ETA: 0s - loss: 0.8328 - accuracy: 0.470111/11 [==============================] - 0s 25ms/step - loss: 0.8381 - accuracy: 0.4660
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9033 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8955 - accuracy: 0.4453 6/11 [===============>..............] - ETA: 0s - loss: 0.8864 - accuracy: 0.4417 8/11 [====================>.........] - ETA: 0s - loss: 0.8817 - accuracy: 0.443410/11 [==========================>...] - ETA: 0s - loss: 0.8758 - accuracy: 0.445611/11 [==============================] - 0s 26ms/step - loss: 0.8717 - accuracy: 0.4471
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9473 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.9098 - accuracy: 0.4323 6/11 [===============>..............] - ETA: 0s - loss: 0.8905 - accuracy: 0.4405 9/11 [=======================>......] - ETA: 0s - loss: 0.8802 - accuracy: 0.444211/11 [==============================] - ETA: 0s - loss: 0.8752 - accuracy: 0.445911/11 [==============================] - 0s 25ms/step - loss: 0.8732 - accuracy: 0.4467
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8611 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.8896 - accuracy: 0.4401 6/11 [===============>..............] - ETA: 0s - loss: 0.8749 - accuracy: 0.4504 9/11 [=======================>......] - ETA: 0s - loss: 0.8677 - accuracy: 0.453211/11 [==============================] - 0s 25ms/step - loss: 0.8638 - accuracy: 0.4537
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8775 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.8474 - accuracy: 0.4432 6/11 [===============>..............] - ETA: 0s - loss: 0.8475 - accuracy: 0.4482 8/11 [====================>.........] - ETA: 0s - loss: 0.8514 - accuracy: 0.448310/11 [==========================>...] - ETA: 0s - loss: 0.8520 - accuracy: 0.449411/11 [==============================] - 0s 26ms/step - loss: 0.8517 - accuracy: 0.4503
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9309 - accuracy: 0.3906 4/11 [=========>....................] - ETA: 0s - loss: 0.8896 - accuracy: 0.4237 6/11 [===============>..............] - ETA: 0s - loss: 0.8841 - accuracy: 0.4288 8/11 [====================>.........] - ETA: 0s - loss: 0.8801 - accuracy: 0.432411/11 [==============================] - ETA: 0s - loss: 0.8725 - accuracy: 0.438111/11 [==============================] - 0s 26ms/step - loss: 0.8706 - accuracy: 0.4395
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8886 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8802 - accuracy: 0.4340 5/11 [============>.................] - ETA: 0s - loss: 0.8639 - accuracy: 0.4432 8/11 [====================>.........] - ETA: 0s - loss: 0.8561 - accuracy: 0.448411/11 [==============================] - ETA: 0s - loss: 0.8529 - accuracy: 0.450511/11 [==============================] - 0s 25ms/step - loss: 0.8526 - accuracy: 0.4509
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.8678 - accuracy: 0.45316/6 [==============================] - 5s 10ms/step - loss: 0.8182 - accuracy: 0.4660
2021-12-13 23:48:39.911960: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:48:39.912771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:48:39.912845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:48:39.912901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:48:39.912954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:48:39.913001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:48:39.913054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:48:39.913105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:48:39.913151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:48:39.913198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:48:39.914198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:48:39.914258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:48:39.914276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:48:39.914290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:48:39.915343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:48:39.915739: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:48:39.916260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:48:39.916301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:48:39.916340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:48:39.916378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:48:39.916416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:48:39.916453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:48:39.916496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:48:39.916534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:48:39.916575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:48:39.917510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:48:39.917551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:48:39.917568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:48:39.917581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:48:39.918599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 4 1 0] pred: [1.3445847e-04 2.8302101e-04 9.9819833e-01 6.1521586e-04 5.9376837e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 4 1 0] pred: [1.3521795e-04 2.8441381e-04 9.9819869e-01 6.1657565e-04 5.9121649e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 2 ============
pred sorted: [2 3 4 1 0] pred: [1.4067181e-04 2.9765719e-04 9.9816787e-01 6.3196011e-04 6.1151601e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 4 1 0] pred: [1.3489279e-04 2.8491343e-04 9.9819982e-01 6.1626721e-04 5.9115404e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 4 1 0] pred: [1.3471952e-04 2.8411977e-04 9.9820638e-01 6.1523519e-04 5.8884756e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 4 1 0] pred: [1.4152372e-04 2.8930564e-04 9.9808359e-01 6.4126815e-04 6.2646577e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 6 ============
pred sorted: [2 3 4 1 0] pred: [1.3440117e-04 2.8418694e-04 9.9820769e-01 6.1466696e-04 5.8946828e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 7 ============
pred sorted: [2 3 4 1 0] pred: [1.3467815e-04 2.8488412e-04 9.9820697e-01 6.1386899e-04 5.8887253e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 8 ============
pred sorted: [2 3 4 1 0] pred: [1.4357590e-04 2.9344726e-04 9.9811614e-01 6.3187006e-04 6.2182447e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 4 1 0] pred: [1.3429613e-04 2.8379570e-04 9.9820912e-01 6.1406795e-04 5.8885117e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 10 ============
pred sorted: [2 3 4 1 0] pred: [1.3510417e-04 2.8460150e-04 9.9820173e-01 6.1602611e-04 5.8996014e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 4 1 0] pred: [1.3840498e-04 2.9137006e-04 9.9819845e-01 6.1627990e-04 5.9514184e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 12 ============
pred sorted: [2 3 4 1 0] pred: [1.3466891e-04 2.8384739e-04 9.9820542e-01 6.1525544e-04 5.8954611e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 4 1 0] pred: [1.3492393e-04 2.8490039e-04 9.9819785e-01 6.1596918e-04 5.9200422e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 4 0 1] pred: [0.06078036 0.06024061 0.83698887 0.08350511 0.08045883]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:29 - loss: 2.4982 - accuracy: 0.1953 4/11 [=========>....................] - ETA: 0s - loss: 2.4892 - accuracy: 0.2563   7/11 [==================>...........] - ETA: 0s - loss: 2.4800 - accuracy: 0.3127 9/11 [=======================>......] - ETA: 0s - loss: 2.4737 - accuracy: 0.335811/11 [==============================] - 15s 23ms/step - loss: 2.4648 - accuracy: 0.3574
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3489 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 2.3404 - accuracy: 0.4588 6/11 [===============>..............] - ETA: 0s - loss: 2.3253 - accuracy: 0.4615 9/11 [=======================>......] - ETA: 0s - loss: 2.3082 - accuracy: 0.461711/11 [==============================] - 0s 24ms/step - loss: 2.2923 - accuracy: 0.4598
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 2.0739 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 2.0471 - accuracy: 0.4357 7/11 [==================>...........] - ETA: 0s - loss: 2.0103 - accuracy: 0.440310/11 [==========================>...] - ETA: 0s - loss: 1.9728 - accuracy: 0.442311/11 [==============================] - 0s 25ms/step - loss: 1.9505 - accuracy: 0.4439
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.4461 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 1.4413 - accuracy: 0.4731 6/11 [===============>..............] - ETA: 0s - loss: 1.3913 - accuracy: 0.4678 9/11 [=======================>......] - ETA: 0s - loss: 1.3475 - accuracy: 0.463511/11 [==============================] - 0s 25ms/step - loss: 1.3105 - accuracy: 0.4608
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9087 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.9129 - accuracy: 0.4809 6/11 [===============>..............] - ETA: 0s - loss: 0.8968 - accuracy: 0.4805 8/11 [====================>.........] - ETA: 0s - loss: 0.8919 - accuracy: 0.479511/11 [==============================] - ETA: 0s - loss: 0.8923 - accuracy: 0.474211/11 [==============================] - 0s 25ms/step - loss: 0.8930 - accuracy: 0.4723
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7691 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.8053 - accuracy: 0.4887 6/11 [===============>..............] - ETA: 0s - loss: 0.8302 - accuracy: 0.4769 9/11 [=======================>......] - ETA: 0s - loss: 0.8408 - accuracy: 0.469811/11 [==============================] - ETA: 0s - loss: 0.8445 - accuracy: 0.466511/11 [==============================] - 0s 24ms/step - loss: 0.8460 - accuracy: 0.4653
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8464 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.8086 - accuracy: 0.4774 5/11 [============>.................] - ETA: 0s - loss: 0.8118 - accuracy: 0.4745 8/11 [====================>.........] - ETA: 0s - loss: 0.8244 - accuracy: 0.466911/11 [==============================] - ETA: 0s - loss: 0.8306 - accuracy: 0.463311/11 [==============================] - 0s 25ms/step - loss: 0.8328 - accuracy: 0.4623
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8991 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.8522 - accuracy: 0.4688 6/11 [===============>..............] - ETA: 0s - loss: 0.8566 - accuracy: 0.4609 9/11 [=======================>......] - ETA: 0s - loss: 0.8524 - accuracy: 0.458211/11 [==============================] - 0s 25ms/step - loss: 0.8521 - accuracy: 0.4568
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8261 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.8324 - accuracy: 0.4603 7/11 [==================>...........] - ETA: 0s - loss: 0.8449 - accuracy: 0.452910/11 [==========================>...] - ETA: 0s - loss: 0.8506 - accuracy: 0.450511/11 [==============================] - 0s 24ms/step - loss: 0.8508 - accuracy: 0.4507
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9307 - accuracy: 0.3906 4/11 [=========>....................] - ETA: 0s - loss: 0.8580 - accuracy: 0.4399 7/11 [==================>...........] - ETA: 0s - loss: 0.8481 - accuracy: 0.449710/11 [==========================>...] - ETA: 0s - loss: 0.8450 - accuracy: 0.452811/11 [==============================] - 0s 24ms/step - loss: 0.8458 - accuracy: 0.4526
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8253 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8494 - accuracy: 0.4562 6/11 [===============>..............] - ETA: 0s - loss: 0.8698 - accuracy: 0.4476 8/11 [====================>.........] - ETA: 0s - loss: 0.8697 - accuracy: 0.446611/11 [==============================] - ETA: 0s - loss: 0.8657 - accuracy: 0.447511/11 [==============================] - 0s 25ms/step - loss: 0.8642 - accuracy: 0.4479
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8069 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.8228 - accuracy: 0.4592 6/11 [===============>..............] - ETA: 0s - loss: 0.8314 - accuracy: 0.4559 8/11 [====================>.........] - ETA: 0s - loss: 0.8392 - accuracy: 0.452411/11 [==============================] - ETA: 0s - loss: 0.8428 - accuracy: 0.451511/11 [==============================] - 0s 24ms/step - loss: 0.8430 - accuracy: 0.4516
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8271 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8528 - accuracy: 0.4553 6/11 [===============>..............] - ETA: 0s - loss: 0.8477 - accuracy: 0.4590 8/11 [====================>.........] - ETA: 0s - loss: 0.8457 - accuracy: 0.457911/11 [==============================] - ETA: 0s - loss: 0.8443 - accuracy: 0.456811/11 [==============================] - 0s 24ms/step - loss: 0.8441 - accuracy: 0.4564
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7826 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 0s - loss: 0.8276 - accuracy: 0.4645 6/11 [===============>..............] - ETA: 0s - loss: 0.8309 - accuracy: 0.4581 9/11 [=======================>......] - ETA: 0s - loss: 0.8300 - accuracy: 0.458511/11 [==============================] - 0s 24ms/step - loss: 0.8300 - accuracy: 0.4584
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7595 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 0s - loss: 0.7980 - accuracy: 0.4909 7/11 [==================>...........] - ETA: 0s - loss: 0.8094 - accuracy: 0.479010/11 [==========================>...] - ETA: 0s - loss: 0.8139 - accuracy: 0.472811/11 [==============================] - 0s 22ms/step - loss: 0.8145 - accuracy: 0.4706
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7883 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.7759 - accuracy: 0.4861 5/11 [============>.................] - ETA: 0s - loss: 0.7796 - accuracy: 0.4816 8/11 [====================>.........] - ETA: 0s - loss: 0.7794 - accuracy: 0.479811/11 [==============================] - ETA: 0s - loss: 0.7810 - accuracy: 0.477911/11 [==============================] - 0s 24ms/step - loss: 0.7819 - accuracy: 0.4771
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7579 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.7708 - accuracy: 0.4801 7/11 [==================>...........] - ETA: 0s - loss: 0.7769 - accuracy: 0.4804 9/11 [=======================>......] - ETA: 0s - loss: 0.7741 - accuracy: 0.484011/11 [==============================] - 0s 24ms/step - loss: 0.7720 - accuracy: 0.4874
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7622 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.7958 - accuracy: 0.4991 6/11 [===============>..............] - ETA: 0s - loss: 0.7763 - accuracy: 0.5109 8/11 [====================>.........] - ETA: 0s - loss: 0.7686 - accuracy: 0.514211/11 [==============================] - ETA: 0s - loss: 0.7649 - accuracy: 0.515711/11 [==============================] - 0s 26ms/step - loss: 0.7635 - accuracy: 0.5164
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6371 - accuracy: 0.5859 3/11 [=======>......................] - ETA: 0s - loss: 0.7058 - accuracy: 0.5573 6/11 [===============>..............] - ETA: 0s - loss: 0.7219 - accuracy: 0.5469 8/11 [====================>.........] - ETA: 0s - loss: 0.7234 - accuracy: 0.545211/11 [==============================] - ETA: 0s - loss: 0.7252 - accuracy: 0.544411/11 [==============================] - 0s 25ms/step - loss: 0.7259 - accuracy: 0.5441
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7223 - accuracy: 0.5312 4/11 [=========>....................] - ETA: 0s - loss: 0.7077 - accuracy: 0.5435 7/11 [==================>...........] - ETA: 0s - loss: 0.7087 - accuracy: 0.547210/11 [==========================>...] - ETA: 0s - loss: 0.7096 - accuracy: 0.547511/11 [==============================] - 0s 24ms/step - loss: 0.7110 - accuracy: 0.5474
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.6705 - accuracy: 0.60166/6 [==============================] - 5s 9ms/step - loss: 0.6651 - accuracy: 0.5751
2021-12-13 23:49:15.535740: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:49:15.536849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:49:15.536920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:49:15.536975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:49:15.537020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:49:15.537054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:49:15.537089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:49:15.537123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:49:15.537154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:49:15.537189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:49:15.537938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:49:15.537994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:49:15.538008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:49:15.538018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:49:15.538795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:49:15.539261: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:49:15.539653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:49:15.539681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:49:15.539708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:49:15.539734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:49:15.539760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:49:15.539788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:49:15.539816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:49:15.539842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:49:15.539869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:49:15.540568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:49:15.540596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:49:15.540608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:49:15.540617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:49:15.541327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 0 1 4] pred: [4.3043093e-04 4.1421104e-04 9.9588412e-01 1.1398927e-03 3.6895031e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 0 1 4] pred: [4.3762740e-04 4.2107262e-04 9.9574888e-01 1.1644802e-03 3.7074232e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 0 1 4] pred: [4.2908694e-04 4.1315795e-04 9.9589819e-01 1.1336765e-03 3.6463854e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 3 ============
pred sorted: [3 4 2 0 1] pred: [0.00694236 0.00580719 0.07783598 0.41214994 0.08662111]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 0 1 4] pred: [4.3532214e-04 4.1796494e-04 9.9577338e-01 1.1683267e-03 3.7496875e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 5 ============
pred sorted: [3 2 4 0 1] pred: [0.00531842 0.00520585 0.1222503  0.36213115 0.06862278]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 0 1 3 4] pred: [0.00354611 0.00190341 0.9900804  0.0018898  0.00157989]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 0 1 4] pred: [4.4894210e-04 4.3152415e-04 9.9559349e-01 1.2031764e-03 3.8645373e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 8 ============
pred sorted: [2 3 0 4 1] pred: [6.8834983e-04 5.0711160e-04 9.9405426e-01 1.0912280e-03 5.7328789e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 0 1 4] pred: [4.2962332e-04 4.1406185e-04 9.9590671e-01 1.1336074e-03 3.6646656e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 4 0 1] pred: [0.00238658 0.00190487 0.4950934  0.09004139 0.01314352]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 0 1 4] pred: [4.3205015e-04 4.1487892e-04 9.9584252e-01 1.1502322e-03 3.7201477e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 2 0 1] pred: [0.00710008 0.00670823 0.03811233 0.5740742  0.11355419]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 4 0 1] pred: [0.00128584 0.00107371 0.91180074 0.01521578 0.00332925]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 2 1 0] pred: [0.0128528  0.01642658 0.01986279 0.7725669  0.3454314 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:29 - loss: 2.4926 - accuracy: 0.2656 4/11 [=========>....................] - ETA: 0s - loss: 2.4824 - accuracy: 0.3797   6/11 [===============>..............] - ETA: 0s - loss: 2.4757 - accuracy: 0.3990 9/11 [=======================>......] - ETA: 0s - loss: 2.4654 - accuracy: 0.415311/11 [==============================] - 15s 24ms/step - loss: 2.4553 - accuracy: 0.4247
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3186 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 2.3011 - accuracy: 0.4678 7/11 [==================>...........] - ETA: 0s - loss: 2.2846 - accuracy: 0.472710/11 [==========================>...] - ETA: 0s - loss: 2.2666 - accuracy: 0.472111/11 [==============================] - 0s 23ms/step - loss: 2.2556 - accuracy: 0.4709
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 2.0270 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 1.9969 - accuracy: 0.4236 6/11 [===============>..............] - ETA: 0s - loss: 1.9522 - accuracy: 0.4427 9/11 [=======================>......] - ETA: 0s - loss: 1.9076 - accuracy: 0.451011/11 [==============================] - 0s 24ms/step - loss: 1.8677 - accuracy: 0.4549
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.3300 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 1.2887 - accuracy: 0.4896 6/11 [===============>..............] - ETA: 0s - loss: 1.2356 - accuracy: 0.4885 9/11 [=======================>......] - ETA: 0s - loss: 1.2034 - accuracy: 0.484011/11 [==============================] - 0s 24ms/step - loss: 1.1799 - accuracy: 0.4795
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 1.0013 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.9288 - accuracy: 0.4574 6/11 [===============>..............] - ETA: 0s - loss: 0.9154 - accuracy: 0.4637 8/11 [====================>.........] - ETA: 0s - loss: 0.9047 - accuracy: 0.467410/11 [==========================>...] - ETA: 0s - loss: 0.8972 - accuracy: 0.467911/11 [==============================] - 0s 25ms/step - loss: 0.8937 - accuracy: 0.4674
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8006 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.7941 - accuracy: 0.5009 6/11 [===============>..............] - ETA: 0s - loss: 0.8068 - accuracy: 0.4878 9/11 [=======================>......] - ETA: 0s - loss: 0.8176 - accuracy: 0.480211/11 [==============================] - ETA: 0s - loss: 0.8218 - accuracy: 0.477311/11 [==============================] - 0s 24ms/step - loss: 0.8233 - accuracy: 0.4763
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8679 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.8203 - accuracy: 0.4818 7/11 [==================>...........] - ETA: 0s - loss: 0.8187 - accuracy: 0.4781 9/11 [=======================>......] - ETA: 0s - loss: 0.8199 - accuracy: 0.476111/11 [==============================] - ETA: 0s - loss: 0.8216 - accuracy: 0.474111/11 [==============================] - 0s 26ms/step - loss: 0.8224 - accuracy: 0.4733
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7828 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8405 - accuracy: 0.4592 6/11 [===============>..............] - ETA: 0s - loss: 0.8592 - accuracy: 0.4485 9/11 [=======================>......] - ETA: 0s - loss: 0.8484 - accuracy: 0.453011/11 [==============================] - 0s 24ms/step - loss: 0.8426 - accuracy: 0.4562
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7656 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.7995 - accuracy: 0.4785 6/11 [===============>..............] - ETA: 0s - loss: 0.8079 - accuracy: 0.4740 8/11 [====================>.........] - ETA: 0s - loss: 0.8088 - accuracy: 0.473611/11 [==============================] - ETA: 0s - loss: 0.8116 - accuracy: 0.472511/11 [==============================] - 0s 24ms/step - loss: 0.8128 - accuracy: 0.4719
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7108 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.7441 - accuracy: 0.5143 6/11 [===============>..............] - ETA: 0s - loss: 0.7510 - accuracy: 0.5116 9/11 [=======================>......] - ETA: 0s - loss: 0.7676 - accuracy: 0.500911/11 [==============================] - ETA: 0s - loss: 0.7779 - accuracy: 0.494411/11 [==============================] - 0s 25ms/step - loss: 0.7817 - accuracy: 0.4920
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8640 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.8646 - accuracy: 0.4368 6/11 [===============>..............] - ETA: 0s - loss: 0.8525 - accuracy: 0.4429 9/11 [=======================>......] - ETA: 0s - loss: 0.8448 - accuracy: 0.447011/11 [==============================] - 0s 23ms/step - loss: 0.8398 - accuracy: 0.4514
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8153 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.7945 - accuracy: 0.4764 6/11 [===============>..............] - ETA: 0s - loss: 0.8032 - accuracy: 0.4726 9/11 [=======================>......] - ETA: 0s - loss: 0.8089 - accuracy: 0.470011/11 [==============================] - 0s 25ms/step - loss: 0.8129 - accuracy: 0.4682
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9338 - accuracy: 0.4062 4/11 [=========>....................] - ETA: 0s - loss: 0.8883 - accuracy: 0.4331 7/11 [==================>...........] - ETA: 0s - loss: 0.8633 - accuracy: 0.445310/11 [==========================>...] - ETA: 0s - loss: 0.8487 - accuracy: 0.452311/11 [==============================] - 0s 24ms/step - loss: 0.8443 - accuracy: 0.4544
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8799 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.8691 - accuracy: 0.4403 7/11 [==================>...........] - ETA: 0s - loss: 0.8572 - accuracy: 0.4478 9/11 [=======================>......] - ETA: 0s - loss: 0.8504 - accuracy: 0.450811/11 [==============================] - ETA: 0s - loss: 0.8449 - accuracy: 0.453411/11 [==============================] - 0s 25ms/step - loss: 0.8430 - accuracy: 0.4544
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9411 - accuracy: 0.3906 4/11 [=========>....................] - ETA: 0s - loss: 0.8585 - accuracy: 0.4352 7/11 [==================>...........] - ETA: 0s - loss: 0.8413 - accuracy: 0.4483 9/11 [=======================>......] - ETA: 0s - loss: 0.8362 - accuracy: 0.452311/11 [==============================] - 0s 25ms/step - loss: 0.8330 - accuracy: 0.4552
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8233 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8094 - accuracy: 0.4701 5/11 [============>.................] - ETA: 0s - loss: 0.8093 - accuracy: 0.4697 7/11 [==================>...........] - ETA: 0s - loss: 0.8099 - accuracy: 0.470110/11 [==========================>...] - ETA: 0s - loss: 0.8138 - accuracy: 0.467711/11 [==============================] - 0s 24ms/step - loss: 0.8151 - accuracy: 0.4672
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7613 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.7778 - accuracy: 0.4961 6/11 [===============>..............] - ETA: 0s - loss: 0.7799 - accuracy: 0.4939 9/11 [=======================>......] - ETA: 0s - loss: 0.7868 - accuracy: 0.488011/11 [==============================] - 0s 22ms/step - loss: 0.7952 - accuracy: 0.4824
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7299 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.7803 - accuracy: 0.4935 6/11 [===============>..............] - ETA: 0s - loss: 0.7933 - accuracy: 0.4811 8/11 [====================>.........] - ETA: 0s - loss: 0.7910 - accuracy: 0.480511/11 [==============================] - ETA: 0s - loss: 0.7959 - accuracy: 0.477111/11 [==============================] - 0s 25ms/step - loss: 0.7979 - accuracy: 0.4761
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 1.0105 - accuracy: 0.4062 4/11 [=========>....................] - ETA: 0s - loss: 0.8821 - accuracy: 0.4520 7/11 [==================>...........] - ETA: 0s - loss: 0.8488 - accuracy: 0.463010/11 [==========================>...] - ETA: 0s - loss: 0.8374 - accuracy: 0.465811/11 [==============================] - 0s 25ms/step - loss: 0.8346 - accuracy: 0.4656
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7990 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.8048 - accuracy: 0.4566 6/11 [===============>..............] - ETA: 0s - loss: 0.8145 - accuracy: 0.4526 9/11 [=======================>......] - ETA: 0s - loss: 0.8132 - accuracy: 0.457511/11 [==============================] - 0s 23ms/step - loss: 0.8144 - accuracy: 0.4596
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.9863 - accuracy: 0.40626/6 [==============================] - ETA: 0s - loss: 0.8793 - accuracy: 0.4462 6/6 [==============================] - 5s 10ms/step - loss: 0.8793 - accuracy: 0.4462
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [0.00239012 0.00432085 0.9927061  0.00103137 0.00115216]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [5.9217238e-04 2.2377432e-03 9.9818295e-01 2.2368472e-04 2.2474353e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 4 3] pred: [5.9489062e-04 2.2508330e-03 9.9814928e-01 2.2594181e-04 2.2741708e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [5.8987888e-04 2.2345313e-03 9.9820328e-01 2.2145544e-04 2.2229699e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [5.8892218e-04 2.2333560e-03 9.9821246e-01 2.1990640e-04 2.2110563e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [6.9112709e-04 2.2744364e-03 9.9789810e-01 2.6585488e-04 2.8561978e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [5.8798335e-04 2.2386345e-03 9.9819869e-01 2.2022576e-04 2.2135369e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 4 3] pred: [5.8903138e-04 2.2347749e-03 9.9820650e-01 2.2057840e-04 2.2150169e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 4 3] pred: [5.8864075e-04 2.2367130e-03 9.9820590e-01 2.2060992e-04 2.2143559e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 4 3] pred: [6.2432513e-04 2.2511680e-03 9.9803513e-01 2.3817991e-04 2.3988278e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 4 3] pred: [5.8901624e-04 2.2353097e-03 9.9820721e-01 2.2050311e-04 2.2162590e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [6.0463586e-04 2.2529371e-03 9.9810386e-01 2.3244071e-04 2.3456171e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 4 3] pred: [5.8895844e-04 2.2400324e-03 9.9820089e-01 2.1998315e-04 2.2115455e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [6.6677824e-04 2.2941052e-03 9.9785030e-01 2.5814667e-04 2.6139437e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [5.9355627e-04 2.2341330e-03 9.9818748e-01 2.2224043e-04 2.2338398e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
Job end at lun déc 13 23:49:52 CET 2021
