
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at lun déc 13 23:49:54 CET 2021
2021-12-13 23:49:55.868720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-13 23:50:01.800315: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:50:01.802421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-13 23:50:01.843905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:50:01.843978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:50:01.849535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:50:01.849603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:50:01.853445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:50:01.854577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:50:01.859083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:50:01.861825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:50:01.870597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:50:01.872269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:50:01.872335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:50:02.581701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:50:02.581751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:50:02.581763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:50:02.583654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:50:02.584965: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:50:02.585562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:50:02.585608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:50:02.585643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:50:02.585678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:50:02.585705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:50:02.585731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:50:02.585760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:50:02.585791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:50:02.585827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:50:02.586873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:50:02.586904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:50:02.586915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:50:02.586924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:50:02.588000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:50:04.422116: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:50:04.423729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:50:04.423782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:50:04.423849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:50:04.423893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:50:04.423955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:50:04.424001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:50:04.424038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:50:04.424077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:50:04.424116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:50:04.425179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:50:04.426050: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:50:04.426618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:50:04.426645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:50:04.426672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:50:04.426699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:50:04.426726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:50:04.426752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:50:04.426777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:50:04.426803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:50:04.426831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:50:04.427874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:50:04.427951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:50:04.427965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:50:04.427974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:50:04.429188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:50:04.429307: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-13 23:50:08.064067: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-13 23:50:08.064762: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 1994990000 Hz
2021-12-13 23:50:19.976517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:50:21.003768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
Number of possible configurations: 40
Begining exécution of the 33 th configuration: BPIC20.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and mse as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 58)          3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                21360     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:34 - loss: 0.2559 - accuracy: 0.0859 3/11 [=======>......................] - ETA: 0s - loss: 0.2530 - accuracy: 0.2188   5/11 [============>.................] - ETA: 0s - loss: 0.2493 - accuracy: 0.2762 7/11 [==================>...........] - ETA: 0s - loss: 0.2457 - accuracy: 0.3050 9/11 [=======================>......] - ETA: 0s - loss: 0.2417 - accuracy: 0.325911/11 [==============================] - ETA: 0s - loss: 0.2378 - accuracy: 0.341811/11 [==============================] - 16s 28ms/step - loss: 0.2363 - accuracy: 0.3478
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1735 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.1680 - accuracy: 0.4540 5/11 [============>.................] - ETA: 0s - loss: 0.1644 - accuracy: 0.4507 8/11 [====================>.........] - ETA: 0s - loss: 0.1584 - accuracy: 0.453410/11 [==========================>...] - ETA: 0s - loss: 0.1548 - accuracy: 0.455411/11 [==============================] - 0s 28ms/step - loss: 0.1521 - accuracy: 0.4550
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1199 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.1155 - accuracy: 0.4392 5/11 [============>.................] - ETA: 0s - loss: 0.1144 - accuracy: 0.4474 7/11 [==================>...........] - ETA: 0s - loss: 0.1127 - accuracy: 0.4531 9/11 [=======================>......] - ETA: 0s - loss: 0.1117 - accuracy: 0.454411/11 [==============================] - ETA: 0s - loss: 0.1109 - accuracy: 0.454311/11 [==============================] - 0s 28ms/step - loss: 0.1107 - accuracy: 0.4542
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0884 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.0937 - accuracy: 0.4518 5/11 [============>.................] - ETA: 0s - loss: 0.0956 - accuracy: 0.4501 8/11 [====================>.........] - ETA: 0s - loss: 0.0964 - accuracy: 0.455010/11 [==========================>...] - ETA: 0s - loss: 0.0960 - accuracy: 0.458111/11 [==============================] - 0s 28ms/step - loss: 0.0958 - accuracy: 0.4584
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0859 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.0867 - accuracy: 0.4978 5/11 [============>.................] - ETA: 0s - loss: 0.0861 - accuracy: 0.4949 7/11 [==================>...........] - ETA: 0s - loss: 0.0855 - accuracy: 0.4922 9/11 [=======================>......] - ETA: 0s - loss: 0.0853 - accuracy: 0.489011/11 [==============================] - 0s 28ms/step - loss: 0.0849 - accuracy: 0.4879
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0815 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.0796 - accuracy: 0.5009 5/11 [============>.................] - ETA: 0s - loss: 0.0784 - accuracy: 0.5013 7/11 [==================>...........] - ETA: 0s - loss: 0.0780 - accuracy: 0.5070 9/11 [=======================>......] - ETA: 0s - loss: 0.0775 - accuracy: 0.511311/11 [==============================] - ETA: 0s - loss: 0.0770 - accuracy: 0.513111/11 [==============================] - 0s 29ms/step - loss: 0.0768 - accuracy: 0.5136
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0725 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.0713 - accuracy: 0.4931 6/11 [===============>..............] - ETA: 0s - loss: 0.0707 - accuracy: 0.5027 9/11 [=======================>......] - ETA: 0s - loss: 0.0701 - accuracy: 0.509511/11 [==============================] - ETA: 0s - loss: 0.0696 - accuracy: 0.512411/11 [==============================] - 0s 28ms/step - loss: 0.0694 - accuracy: 0.5136
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0605 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.0626 - accuracy: 0.5664 6/11 [===============>..............] - ETA: 0s - loss: 0.0625 - accuracy: 0.5560 8/11 [====================>.........] - ETA: 0s - loss: 0.0624 - accuracy: 0.556310/11 [==========================>...] - ETA: 0s - loss: 0.0622 - accuracy: 0.558111/11 [==============================] - 0s 27ms/step - loss: 0.0620 - accuracy: 0.5608
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0548 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.0535 - accuracy: 0.6727 5/11 [============>.................] - ETA: 0s - loss: 0.0533 - accuracy: 0.6611 8/11 [====================>.........] - ETA: 0s - loss: 0.0537 - accuracy: 0.655310/11 [==========================>...] - ETA: 0s - loss: 0.0539 - accuracy: 0.653311/11 [==============================] - 0s 27ms/step - loss: 0.0541 - accuracy: 0.6514
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0465 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.0510 - accuracy: 0.6944 5/11 [============>.................] - ETA: 0s - loss: 0.0519 - accuracy: 0.6961 7/11 [==================>...........] - ETA: 0s - loss: 0.0521 - accuracy: 0.6941 9/11 [=======================>......] - ETA: 0s - loss: 0.0520 - accuracy: 0.691311/11 [==============================] - ETA: 0s - loss: 0.0518 - accuracy: 0.689411/11 [==============================] - 0s 26ms/step - loss: 0.0518 - accuracy: 0.6885
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0385 - accuracy: 0.7500 4/11 [=========>....................] - ETA: 0s - loss: 0.0448 - accuracy: 0.7209 6/11 [===============>..............] - ETA: 0s - loss: 0.0457 - accuracy: 0.7177 8/11 [====================>.........] - ETA: 0s - loss: 0.0461 - accuracy: 0.716810/11 [==========================>...] - ETA: 0s - loss: 0.0463 - accuracy: 0.718611/11 [==============================] - 0s 27ms/step - loss: 0.0464 - accuracy: 0.7197
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0462 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.0456 - accuracy: 0.7062 5/11 [============>.................] - ETA: 0s - loss: 0.0462 - accuracy: 0.7020 7/11 [==================>...........] - ETA: 0s - loss: 0.0458 - accuracy: 0.7083 9/11 [=======================>......] - ETA: 0s - loss: 0.0454 - accuracy: 0.716911/11 [==============================] - ETA: 0s - loss: 0.0450 - accuracy: 0.724111/11 [==============================] - 0s 28ms/step - loss: 0.0449 - accuracy: 0.7270
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0448 - accuracy: 0.7656 3/11 [=======>......................] - ETA: 0s - loss: 0.0433 - accuracy: 0.7504 5/11 [============>.................] - ETA: 0s - loss: 0.0429 - accuracy: 0.7472 7/11 [==================>...........] - ETA: 0s - loss: 0.0420 - accuracy: 0.7518 9/11 [=======================>......] - ETA: 0s - loss: 0.0415 - accuracy: 0.756511/11 [==============================] - ETA: 0s - loss: 0.0411 - accuracy: 0.759411/11 [==============================] - 0s 29ms/step - loss: 0.0410 - accuracy: 0.7607
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0327 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.0336 - accuracy: 0.8767 5/11 [============>.................] - ETA: 0s - loss: 0.0339 - accuracy: 0.8686 7/11 [==================>...........] - ETA: 0s - loss: 0.0344 - accuracy: 0.8575 9/11 [=======================>......] - ETA: 0s - loss: 0.0348 - accuracy: 0.851211/11 [==============================] - ETA: 0s - loss: 0.0352 - accuracy: 0.846411/11 [==============================] - 0s 28ms/step - loss: 0.0353 - accuracy: 0.8445
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0301 - accuracy: 0.8047 3/11 [=======>......................] - ETA: 0s - loss: 0.0338 - accuracy: 0.8320 5/11 [============>.................] - ETA: 0s - loss: 0.0349 - accuracy: 0.8451 7/11 [==================>...........] - ETA: 0s - loss: 0.0351 - accuracy: 0.849710/11 [==========================>...] - ETA: 0s - loss: 0.0351 - accuracy: 0.846511/11 [==============================] - 0s 28ms/step - loss: 0.0350 - accuracy: 0.8421
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0321 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.0332 - accuracy: 0.7873 5/11 [============>.................] - ETA: 0s - loss: 0.0331 - accuracy: 0.8049 7/11 [==================>...........] - ETA: 0s - loss: 0.0332 - accuracy: 0.8138 9/11 [=======================>......] - ETA: 0s - loss: 0.0333 - accuracy: 0.819011/11 [==============================] - 0s 28ms/step - loss: 0.0331 - accuracy: 0.8240
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0326 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0312 - accuracy: 0.8537 5/11 [============>.................] - ETA: 0s - loss: 0.0309 - accuracy: 0.8483 7/11 [==================>...........] - ETA: 0s - loss: 0.0307 - accuracy: 0.8453 9/11 [=======================>......] - ETA: 0s - loss: 0.0306 - accuracy: 0.845211/11 [==============================] - 0s 29ms/step - loss: 0.0305 - accuracy: 0.8444
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0306 - accuracy: 0.8594 4/11 [=========>....................] - ETA: 0s - loss: 0.0291 - accuracy: 0.8597 6/11 [===============>..............] - ETA: 0s - loss: 0.0286 - accuracy: 0.8593 8/11 [====================>.........] - ETA: 0s - loss: 0.0285 - accuracy: 0.858610/11 [==========================>...] - ETA: 0s - loss: 0.0285 - accuracy: 0.857211/11 [==============================] - 0s 27ms/step - loss: 0.0285 - accuracy: 0.8565
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0307 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.0303 - accuracy: 0.8789 5/11 [============>.................] - ETA: 0s - loss: 0.0297 - accuracy: 0.8804 7/11 [==================>...........] - ETA: 0s - loss: 0.0290 - accuracy: 0.8766 9/11 [=======================>......] - ETA: 0s - loss: 0.0286 - accuracy: 0.873911/11 [==============================] - ETA: 0s - loss: 0.0284 - accuracy: 0.872711/11 [==============================] - 0s 28ms/step - loss: 0.0283 - accuracy: 0.8724
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0239 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.0260 - accuracy: 0.8824 6/11 [===============>..............] - ETA: 0s - loss: 0.0262 - accuracy: 0.8742 8/11 [====================>.........] - ETA: 0s - loss: 0.0262 - accuracy: 0.873310/11 [==========================>...] - ETA: 0s - loss: 0.0261 - accuracy: 0.873611/11 [==============================] - 0s 29ms/step - loss: 0.0260 - accuracy: 0.8729
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0411 - accuracy: 0.82036/6 [==============================] - ETA: 0s - loss: 0.0312 - accuracy: 0.8201 6/6 [==============================] - 5s 12ms/step - loss: 0.0312 - accuracy: 0.8201
2021-12-13 23:50:39.592386: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:50:39.593016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:50:39.593072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:50:39.593115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:50:39.593145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:50:39.593178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:50:39.593210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:50:39.593241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:50:39.593273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:50:39.593304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:50:39.594006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:50:39.594055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:50:39.594069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:50:39.594079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:50:39.594824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:50:39.595124: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:50:39.595496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:50:39.595524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:50:39.595549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:50:39.595576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:50:39.595600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:50:39.595625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:50:39.595649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:50:39.595674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:50:39.595698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:50:39.596377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:50:39.596406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:50:39.596417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:50:39.596425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:50:39.597139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 3 1 4] pred: [-0.02002737 -0.02590238  0.98049724 -0.02524281 -0.02874703]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [-0.003278    0.86409104  0.890665    0.04359308 -0.00190371]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [1 0 2 4 3] pred: [ 0.42347342  0.78827655  0.07638452 -0.09065931  0.05390478]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 4 1 0 3] pred: [-0.06444094 -0.01290515  0.9866061  -0.07475302  0.02877961]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 0 3 1 4] pred: [ 1.8813288e-03 -1.0978491e-02  9.7486585e-01 -2.8938428e-04
 -2.0976698e-02]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 0 1 4] pred: [ 0.01566081 -0.03866507  0.9846757   0.02580359 -0.05176369]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [-0.02877611  0.327241    0.8574708   0.04122689 -0.06859441]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [-0.00390966  0.0692293   0.9900247   0.0365474  -0.06872296]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 3 0] pred: [0.00351025 0.79972374 0.8417228  0.01308857 0.02966363]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 4 0 2 1] pred: [ 0.01000753 -0.02797595  0.00856707  0.8219033   0.09353352]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 3 4 0] pred: [-0.00187937  0.8561153   0.81042     0.02365583  0.01429961]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [-0.00660155  0.31407377  0.8766061  -0.02413103 -0.07999201]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 3 0 4] pred: [-0.00554735  0.8808529   0.7844289   0.04719375 -0.0171942 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 0 3 1 4] pred: [ 0.00378309 -0.00499626  0.9830093  -0.00105805 -0.0506261 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 2 0 1] pred: [-0.01095707 -0.11036579  0.04626342  0.7762802   0.19766675]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:38 - loss: 0.2605 - accuracy: 0.2422 3/11 [=======>......................] - ETA: 0s - loss: 0.2501 - accuracy: 0.3424   6/11 [===============>..............] - ETA: 0s - loss: 0.2404 - accuracy: 0.3932 8/11 [====================>.........] - ETA: 0s - loss: 0.2352 - accuracy: 0.409811/11 [==============================] - ETA: 0s - loss: 0.2288 - accuracy: 0.423511/11 [==============================] - 16s 26ms/step - loss: 0.2271 - accuracy: 0.4266
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1512 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.1498 - accuracy: 0.5317 5/11 [============>.................] - ETA: 0s - loss: 0.1478 - accuracy: 0.5181 7/11 [==================>...........] - ETA: 0s - loss: 0.1451 - accuracy: 0.5097 9/11 [=======================>......] - ETA: 0s - loss: 0.1421 - accuracy: 0.504711/11 [==============================] - 0s 27ms/step - loss: 0.1384 - accuracy: 0.4981
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1042 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.1012 - accuracy: 0.4809 5/11 [============>.................] - ETA: 0s - loss: 0.0995 - accuracy: 0.4891 7/11 [==================>...........] - ETA: 0s - loss: 0.0991 - accuracy: 0.488110/11 [==========================>...] - ETA: 0s - loss: 0.0988 - accuracy: 0.486111/11 [==============================] - 0s 26ms/step - loss: 0.0986 - accuracy: 0.4845
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0939 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.0911 - accuracy: 0.4731 5/11 [============>.................] - ETA: 0s - loss: 0.0898 - accuracy: 0.4732 7/11 [==================>...........] - ETA: 0s - loss: 0.0887 - accuracy: 0.474710/11 [==========================>...] - ETA: 0s - loss: 0.0876 - accuracy: 0.476411/11 [==============================] - 0s 25ms/step - loss: 0.0872 - accuracy: 0.4770
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0699 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.0732 - accuracy: 0.5117 5/11 [============>.................] - ETA: 0s - loss: 0.0741 - accuracy: 0.5057 8/11 [====================>.........] - ETA: 0s - loss: 0.0741 - accuracy: 0.503210/11 [==========================>...] - ETA: 0s - loss: 0.0742 - accuracy: 0.502111/11 [==============================] - 0s 27ms/step - loss: 0.0744 - accuracy: 0.5013
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0687 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.0708 - accuracy: 0.5282 5/11 [============>.................] - ETA: 0s - loss: 0.0708 - accuracy: 0.5309 7/11 [==================>...........] - ETA: 0s - loss: 0.0708 - accuracy: 0.5297 9/11 [=======================>......] - ETA: 0s - loss: 0.0703 - accuracy: 0.531711/11 [==============================] - 0s 26ms/step - loss: 0.0698 - accuracy: 0.5346
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0659 - accuracy: 0.6172 3/11 [=======>......................] - ETA: 0s - loss: 0.0643 - accuracy: 0.6285 6/11 [===============>..............] - ETA: 0s - loss: 0.0646 - accuracy: 0.6197 8/11 [====================>.........] - ETA: 0s - loss: 0.0648 - accuracy: 0.613611/11 [==============================] - ETA: 0s - loss: 0.0642 - accuracy: 0.610511/11 [==============================] - 0s 27ms/step - loss: 0.0641 - accuracy: 0.6101
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0601 - accuracy: 0.6641 3/11 [=======>......................] - ETA: 0s - loss: 0.0590 - accuracy: 0.6710 5/11 [============>.................] - ETA: 0s - loss: 0.0590 - accuracy: 0.6790 7/11 [==================>...........] - ETA: 0s - loss: 0.0590 - accuracy: 0.6813 9/11 [=======================>......] - ETA: 0s - loss: 0.0587 - accuracy: 0.682011/11 [==============================] - 0s 27ms/step - loss: 0.0584 - accuracy: 0.6810
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0515 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.0533 - accuracy: 0.7023 6/11 [===============>..............] - ETA: 0s - loss: 0.0534 - accuracy: 0.7102 8/11 [====================>.........] - ETA: 0s - loss: 0.0535 - accuracy: 0.709311/11 [==============================] - ETA: 0s - loss: 0.0535 - accuracy: 0.708911/11 [==============================] - 0s 27ms/step - loss: 0.0534 - accuracy: 0.7092
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0528 - accuracy: 0.6562 3/11 [=======>......................] - ETA: 0s - loss: 0.0528 - accuracy: 0.6701 6/11 [===============>..............] - ETA: 0s - loss: 0.0521 - accuracy: 0.6750 8/11 [====================>.........] - ETA: 0s - loss: 0.0517 - accuracy: 0.678810/11 [==========================>...] - ETA: 0s - loss: 0.0513 - accuracy: 0.684011/11 [==============================] - 0s 26ms/step - loss: 0.0510 - accuracy: 0.6874
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0480 - accuracy: 0.7500 4/11 [=========>....................] - ETA: 0s - loss: 0.0465 - accuracy: 0.7547 6/11 [===============>..............] - ETA: 0s - loss: 0.0464 - accuracy: 0.7516 8/11 [====================>.........] - ETA: 0s - loss: 0.0465 - accuracy: 0.745810/11 [==========================>...] - ETA: 0s - loss: 0.0467 - accuracy: 0.742811/11 [==============================] - 0s 27ms/step - loss: 0.0467 - accuracy: 0.7421
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0426 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.0427 - accuracy: 0.7717 5/11 [============>.................] - ETA: 0s - loss: 0.0437 - accuracy: 0.7576 7/11 [==================>...........] - ETA: 0s - loss: 0.0439 - accuracy: 0.7583 9/11 [=======================>......] - ETA: 0s - loss: 0.0440 - accuracy: 0.761811/11 [==============================] - ETA: 0s - loss: 0.0440 - accuracy: 0.763711/11 [==============================] - 0s 26ms/step - loss: 0.0440 - accuracy: 0.7646
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0456 - accuracy: 0.7109 3/11 [=======>......................] - ETA: 0s - loss: 0.0421 - accuracy: 0.7348 6/11 [===============>..............] - ETA: 0s - loss: 0.0408 - accuracy: 0.7564 9/11 [=======================>......] - ETA: 0s - loss: 0.0406 - accuracy: 0.767211/11 [==============================] - ETA: 0s - loss: 0.0407 - accuracy: 0.770411/11 [==============================] - 0s 25ms/step - loss: 0.0408 - accuracy: 0.7716
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0350 - accuracy: 0.8281 3/11 [=======>......................] - ETA: 0s - loss: 0.0360 - accuracy: 0.8394 5/11 [============>.................] - ETA: 0s - loss: 0.0371 - accuracy: 0.8386 7/11 [==================>...........] - ETA: 0s - loss: 0.0378 - accuracy: 0.8310 9/11 [=======================>......] - ETA: 0s - loss: 0.0384 - accuracy: 0.824911/11 [==============================] - ETA: 0s - loss: 0.0386 - accuracy: 0.823611/11 [==============================] - 0s 27ms/step - loss: 0.0386 - accuracy: 0.8234
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0399 - accuracy: 0.8516 3/11 [=======>......................] - ETA: 0s - loss: 0.0393 - accuracy: 0.8611 5/11 [============>.................] - ETA: 0s - loss: 0.0383 - accuracy: 0.8580 7/11 [==================>...........] - ETA: 0s - loss: 0.0379 - accuracy: 0.8546 9/11 [=======================>......] - ETA: 0s - loss: 0.0375 - accuracy: 0.852611/11 [==============================] - ETA: 0s - loss: 0.0374 - accuracy: 0.850311/11 [==============================] - 0s 27ms/step - loss: 0.0373 - accuracy: 0.8491
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0320 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.0332 - accuracy: 0.8025 5/11 [============>.................] - ETA: 0s - loss: 0.0340 - accuracy: 0.8082 7/11 [==================>...........] - ETA: 0s - loss: 0.0343 - accuracy: 0.811310/11 [==========================>...] - ETA: 0s - loss: 0.0346 - accuracy: 0.818311/11 [==============================] - 0s 27ms/step - loss: 0.0348 - accuracy: 0.8215
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0301 - accuracy: 0.9062 3/11 [=======>......................] - ETA: 0s - loss: 0.0304 - accuracy: 0.8832 5/11 [============>.................] - ETA: 0s - loss: 0.0307 - accuracy: 0.8756 7/11 [==================>...........] - ETA: 0s - loss: 0.0312 - accuracy: 0.8723 9/11 [=======================>......] - ETA: 0s - loss: 0.0316 - accuracy: 0.869311/11 [==============================] - 0s 25ms/step - loss: 0.0321 - accuracy: 0.8648
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0338 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0349 - accuracy: 0.8759 5/11 [============>.................] - ETA: 0s - loss: 0.0346 - accuracy: 0.8791 8/11 [====================>.........] - ETA: 0s - loss: 0.0338 - accuracy: 0.885910/11 [==========================>...] - ETA: 0s - loss: 0.0334 - accuracy: 0.888811/11 [==============================] - 0s 26ms/step - loss: 0.0332 - accuracy: 0.8904
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0269 - accuracy: 0.8594 3/11 [=======>......................] - ETA: 0s - loss: 0.0287 - accuracy: 0.8477 5/11 [============>.................] - ETA: 0s - loss: 0.0293 - accuracy: 0.8344 7/11 [==================>...........] - ETA: 0s - loss: 0.0295 - accuracy: 0.8362 9/11 [=======================>......] - ETA: 0s - loss: 0.0297 - accuracy: 0.840711/11 [==============================] - ETA: 0s - loss: 0.0297 - accuracy: 0.845511/11 [==============================] - 0s 27ms/step - loss: 0.0298 - accuracy: 0.8475
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0283 - accuracy: 0.9375 3/11 [=======>......................] - ETA: 0s - loss: 0.0285 - accuracy: 0.9266 5/11 [============>.................] - ETA: 0s - loss: 0.0279 - accuracy: 0.9209 7/11 [==================>...........] - ETA: 0s - loss: 0.0281 - accuracy: 0.9136 9/11 [=======================>......] - ETA: 0s - loss: 0.0283 - accuracy: 0.908911/11 [==============================] - ETA: 0s - loss: 0.0283 - accuracy: 0.906411/11 [==============================] - 0s 27ms/step - loss: 0.0283 - accuracy: 0.9055
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0295 - accuracy: 0.89846/6 [==============================] - ETA: 0s - loss: 0.0286 - accuracy: 0.8952 6/6 [==============================] - 5s 12ms/step - loss: 0.0286 - accuracy: 0.8952
2021-12-13 23:51:15.958757: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:51:15.960313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:51:15.960385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:51:15.960443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:51:15.960492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:51:15.960540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:51:15.960584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:51:15.960627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:51:15.960672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:51:15.960717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:51:15.961731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:51:15.961790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:51:15.961807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:51:15.961820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:51:15.962881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:51:15.963387: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:51:15.963897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:51:15.963947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:51:15.963987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:51:15.964025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:51:15.964061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:51:15.964097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:51:15.964136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:51:15.964173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:51:15.964212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:51:15.965177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:51:15.965217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:51:15.965233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:51:15.965246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:51:15.966230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [-0.00201726  0.06555256  0.9678687   0.01236174  0.01050353]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [ 0.01382908  0.94735414  0.6337122   0.00242119 -0.0044622 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [0 1 3 4 2] pred: [ 0.65401316  0.29892257 -0.10728078  0.05071563 -0.00793768]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [4 3 1 0 2] pred: [-0.06046796  0.02879446 -0.128529    0.49270344  0.82511824]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [4 3 0 1 2] pred: [-0.07661884 -0.07880777 -0.2346256   0.5883945   0.7710909 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 4 3 0] pred: [-4.3719057e-03  9.1178840e-01  7.6210093e-01 -9.4196538e-04
 -5.2796293e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [0 1 3 4 2] pred: [ 0.69911605  0.19673254 -0.20907827  0.01478783 -0.04480407]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 4 3] pred: [ 0.08193852  0.8569873   0.7574737  -0.01972044  0.01655318]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 4 0 3] pred: [-0.00240788  0.8858316   0.64437294 -0.0028596   0.01727475]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 3 0 4] pred: [-0.00857507  0.85574114  0.8015593   0.01447882 -0.01899093]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [-0.14998358  0.46657357  0.61654717  0.14557329 -0.09191423]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [-0.01491066  0.04079614  0.97618836  0.02251623 -0.00660958]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 3 4 0] pred: [-0.00996685  0.93153256  0.8661278   0.0023309  -0.00250939]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 4 3] pred: [ 0.24711852  0.66726214  0.40222323 -0.19019479  0.07135893]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 0 4] pred: [-0.0180027   0.01075217  0.9856992   0.04235818 -0.04587635]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:32 - loss: 0.2421 - accuracy: 0.1172 3/11 [=======>......................] - ETA: 0s - loss: 0.2447 - accuracy: 0.1797   5/11 [============>.................] - ETA: 0s - loss: 0.2430 - accuracy: 0.2499 7/11 [==================>...........] - ETA: 0s - loss: 0.2414 - accuracy: 0.2921 9/11 [=======================>......] - ETA: 0s - loss: 0.2392 - accuracy: 0.320311/11 [==============================] - 15s 28ms/step - loss: 0.2356 - accuracy: 0.3477
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1801 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.1766 - accuracy: 0.4345 5/11 [============>.................] - ETA: 0s - loss: 0.1717 - accuracy: 0.4462 7/11 [==================>...........] - ETA: 0s - loss: 0.1678 - accuracy: 0.4493 9/11 [=======================>......] - ETA: 0s - loss: 0.1641 - accuracy: 0.451111/11 [==============================] - 0s 27ms/step - loss: 0.1591 - accuracy: 0.4543
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1150 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.1122 - accuracy: 0.4561 6/11 [===============>..............] - ETA: 0s - loss: 0.1119 - accuracy: 0.4566 8/11 [====================>.........] - ETA: 0s - loss: 0.1117 - accuracy: 0.454111/11 [==============================] - ETA: 0s - loss: 0.1104 - accuracy: 0.455611/11 [==============================] - 0s 27ms/step - loss: 0.1101 - accuracy: 0.4560
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0978 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.1014 - accuracy: 0.4527 6/11 [===============>..............] - ETA: 0s - loss: 0.0994 - accuracy: 0.4571 8/11 [====================>.........] - ETA: 0s - loss: 0.0985 - accuracy: 0.458411/11 [==============================] - ETA: 0s - loss: 0.0976 - accuracy: 0.459011/11 [==============================] - 0s 27ms/step - loss: 0.0974 - accuracy: 0.4592
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0885 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.0870 - accuracy: 0.4375 5/11 [============>.................] - ETA: 0s - loss: 0.0865 - accuracy: 0.4474 8/11 [====================>.........] - ETA: 0s - loss: 0.0860 - accuracy: 0.458710/11 [==========================>...] - ETA: 0s - loss: 0.0858 - accuracy: 0.463611/11 [==============================] - 0s 26ms/step - loss: 0.0854 - accuracy: 0.4672
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0841 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 0s - loss: 0.0802 - accuracy: 0.5169 6/11 [===============>..............] - ETA: 0s - loss: 0.0799 - accuracy: 0.5087 8/11 [====================>.........] - ETA: 0s - loss: 0.0794 - accuracy: 0.506010/11 [==========================>...] - ETA: 0s - loss: 0.0787 - accuracy: 0.506711/11 [==============================] - 0s 28ms/step - loss: 0.0782 - accuracy: 0.5068
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0605 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.0640 - accuracy: 0.5642 5/11 [============>.................] - ETA: 0s - loss: 0.0655 - accuracy: 0.5582 7/11 [==================>...........] - ETA: 0s - loss: 0.0666 - accuracy: 0.5539 9/11 [=======================>......] - ETA: 0s - loss: 0.0671 - accuracy: 0.551911/11 [==============================] - ETA: 0s - loss: 0.0675 - accuracy: 0.551811/11 [==============================] - 0s 28ms/step - loss: 0.0676 - accuracy: 0.5517
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0736 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.0711 - accuracy: 0.5247 5/11 [============>.................] - ETA: 0s - loss: 0.0697 - accuracy: 0.5344 7/11 [==================>...........] - ETA: 0s - loss: 0.0689 - accuracy: 0.5423 9/11 [=======================>......] - ETA: 0s - loss: 0.0680 - accuracy: 0.551411/11 [==============================] - 0s 28ms/step - loss: 0.0668 - accuracy: 0.5618
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0619 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.0611 - accuracy: 0.5755 5/11 [============>.................] - ETA: 0s - loss: 0.0615 - accuracy: 0.5806 7/11 [==================>...........] - ETA: 0s - loss: 0.0615 - accuracy: 0.5869 9/11 [=======================>......] - ETA: 0s - loss: 0.0611 - accuracy: 0.594611/11 [==============================] - ETA: 0s - loss: 0.0606 - accuracy: 0.601011/11 [==============================] - 0s 27ms/step - loss: 0.0604 - accuracy: 0.6035
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0499 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.0507 - accuracy: 0.6897 5/11 [============>.................] - ETA: 0s - loss: 0.0519 - accuracy: 0.6808 7/11 [==================>...........] - ETA: 0s - loss: 0.0525 - accuracy: 0.6739 9/11 [=======================>......] - ETA: 0s - loss: 0.0529 - accuracy: 0.669211/11 [==============================] - 0s 27ms/step - loss: 0.0532 - accuracy: 0.6651
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0572 - accuracy: 0.6484 3/11 [=======>......................] - ETA: 0s - loss: 0.0535 - accuracy: 0.6753 5/11 [============>.................] - ETA: 0s - loss: 0.0528 - accuracy: 0.6790 7/11 [==================>...........] - ETA: 0s - loss: 0.0526 - accuracy: 0.6815 9/11 [=======================>......] - ETA: 0s - loss: 0.0526 - accuracy: 0.680911/11 [==============================] - 0s 27ms/step - loss: 0.0522 - accuracy: 0.6830
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0466 - accuracy: 0.7031 4/11 [=========>....................] - ETA: 0s - loss: 0.0471 - accuracy: 0.6992 7/11 [==================>...........] - ETA: 0s - loss: 0.0475 - accuracy: 0.6944 9/11 [=======================>......] - ETA: 0s - loss: 0.0477 - accuracy: 0.693711/11 [==============================] - ETA: 0s - loss: 0.0478 - accuracy: 0.694611/11 [==============================] - 0s 27ms/step - loss: 0.0478 - accuracy: 0.6950
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0411 - accuracy: 0.7656 3/11 [=======>......................] - ETA: 0s - loss: 0.0443 - accuracy: 0.7257 5/11 [============>.................] - ETA: 0s - loss: 0.0447 - accuracy: 0.7224 7/11 [==================>...........] - ETA: 0s - loss: 0.0448 - accuracy: 0.7215 9/11 [=======================>......] - ETA: 0s - loss: 0.0450 - accuracy: 0.722711/11 [==============================] - 0s 26ms/step - loss: 0.0452 - accuracy: 0.7218
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0436 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.0429 - accuracy: 0.7465 5/11 [============>.................] - ETA: 0s - loss: 0.0430 - accuracy: 0.7393 7/11 [==================>...........] - ETA: 0s - loss: 0.0430 - accuracy: 0.7383 9/11 [=======================>......] - ETA: 0s - loss: 0.0430 - accuracy: 0.737611/11 [==============================] - 0s 27ms/step - loss: 0.0432 - accuracy: 0.7380
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0441 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.0452 - accuracy: 0.7561 5/11 [============>.................] - ETA: 0s - loss: 0.0444 - accuracy: 0.7508 7/11 [==================>...........] - ETA: 0s - loss: 0.0435 - accuracy: 0.749510/11 [==========================>...] - ETA: 0s - loss: 0.0428 - accuracy: 0.749511/11 [==============================] - 0s 26ms/step - loss: 0.0425 - accuracy: 0.7489
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0336 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.0349 - accuracy: 0.7713 6/11 [===============>..............] - ETA: 0s - loss: 0.0365 - accuracy: 0.7760 8/11 [====================>.........] - ETA: 0s - loss: 0.0372 - accuracy: 0.773210/11 [==========================>...] - ETA: 0s - loss: 0.0377 - accuracy: 0.771811/11 [==============================] - 0s 27ms/step - loss: 0.0380 - accuracy: 0.7711
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0383 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.0366 - accuracy: 0.7687 5/11 [============>.................] - ETA: 0s - loss: 0.0367 - accuracy: 0.7807 7/11 [==================>...........] - ETA: 0s - loss: 0.0370 - accuracy: 0.7888 9/11 [=======================>......] - ETA: 0s - loss: 0.0370 - accuracy: 0.791711/11 [==============================] - ETA: 0s - loss: 0.0371 - accuracy: 0.791111/11 [==============================] - 0s 27ms/step - loss: 0.0371 - accuracy: 0.7907
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0382 - accuracy: 0.7656 3/11 [=======>......................] - ETA: 0s - loss: 0.0381 - accuracy: 0.7665 5/11 [============>.................] - ETA: 0s - loss: 0.0382 - accuracy: 0.7783 7/11 [==================>...........] - ETA: 0s - loss: 0.0378 - accuracy: 0.7884 9/11 [=======================>......] - ETA: 0s - loss: 0.0375 - accuracy: 0.794511/11 [==============================] - ETA: 0s - loss: 0.0372 - accuracy: 0.797511/11 [==============================] - 0s 28ms/step - loss: 0.0371 - accuracy: 0.7985
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0308 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.0332 - accuracy: 0.7457 5/11 [============>.................] - ETA: 0s - loss: 0.0340 - accuracy: 0.7386 7/11 [==================>...........] - ETA: 0s - loss: 0.0342 - accuracy: 0.7418 9/11 [=======================>......] - ETA: 0s - loss: 0.0343 - accuracy: 0.746411/11 [==============================] - ETA: 0s - loss: 0.0343 - accuracy: 0.752611/11 [==============================] - 0s 28ms/step - loss: 0.0343 - accuracy: 0.7552
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0332 - accuracy: 0.8594 3/11 [=======>......................] - ETA: 0s - loss: 0.0319 - accuracy: 0.8342 5/11 [============>.................] - ETA: 0s - loss: 0.0318 - accuracy: 0.8230 7/11 [==================>...........] - ETA: 0s - loss: 0.0320 - accuracy: 0.8166 9/11 [=======================>......] - ETA: 0s - loss: 0.0324 - accuracy: 0.813811/11 [==============================] - ETA: 0s - loss: 0.0324 - accuracy: 0.813911/11 [==============================] - 0s 28ms/step - loss: 0.0324 - accuracy: 0.8142
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0241 - accuracy: 0.88286/6 [==============================] - ETA: 0s - loss: 0.0296 - accuracy: 0.8399 6/6 [==============================] - 5s 11ms/step - loss: 0.0296 - accuracy: 0.8399
2021-12-13 23:51:52.943413: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:51:52.944024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:51:52.944077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:51:52.944118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:51:52.944145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:51:52.944176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:51:52.944210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:51:52.944242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:51:52.944272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:51:52.944303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:51:52.944994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:51:52.945036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:51:52.945048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:51:52.945057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:51:52.945791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:51:52.946144: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:51:52.946512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:51:52.946538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:51:52.946564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:51:52.946590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:51:52.946614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:51:52.946639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:51:52.946663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:51:52.946688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:51:52.946713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:51:52.947420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:51:52.947448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:51:52.947459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:51:52.947467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:51:52.948220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 4 3 0] pred: [-0.01557505  0.9353669   0.6353147   0.00542441  0.06383869]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 4 0 1] pred: [-0.00600869 -0.01074     0.9698177   0.03919572 -0.00598011]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [ 0.05854351  0.08030701  0.98441434 -0.00442988 -0.00809115]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [-0.15547884  0.3794286   0.68232346  0.00184954 -0.05996927]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 0 1 4] pred: [ 0.00504191  0.00306555  0.97917265  0.0110427  -0.00825786]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 4 0 3] pred: [0.00898147 0.92815095 0.62053573 0.00518957 0.03865599]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 0 3 4 1] pred: [ 0.00953627 -0.07956384  0.9751507  -0.0024376  -0.02778541]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [0.03395828 0.87995255 0.9327237  0.03644093 0.0308012 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [-0.04269935  0.28035632  0.98662645  0.10031662 -0.02204777]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [-9.6602701e-03  8.6094004e-01  9.4835615e-01  4.9425885e-02
  9.2610717e-05]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 4 3 0] pred: [-0.02665963  0.8409791   0.8705726   0.00902933  0.01228748]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 2 0 4 1] pred: [ 0.04851197 -0.06362447  0.10601636  0.7665333  -0.02494527]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 0 3 4 1] pred: [ 0.01554667 -0.08180808  0.9815994  -0.00723719 -0.0096773 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 4 3 0] pred: [-0.06177849  0.77111185  0.71616155 -0.04290527 -0.01965282]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [ 0.02437501  0.04325686  0.98208207 -0.0171979  -0.01194046]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:29 - loss: 0.2512 - accuracy: 0.3047 4/11 [=========>....................] - ETA: 0s - loss: 0.2474 - accuracy: 0.3501   6/11 [===============>..............] - ETA: 0s - loss: 0.2432 - accuracy: 0.3804 9/11 [=======================>......] - ETA: 0s - loss: 0.2384 - accuracy: 0.401411/11 [==============================] - ETA: 0s - loss: 0.2353 - accuracy: 0.409311/11 [==============================] - 15s 27ms/step - loss: 0.2340 - accuracy: 0.4121
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1728 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.1746 - accuracy: 0.4670 5/11 [============>.................] - ETA: 0s - loss: 0.1726 - accuracy: 0.4543 7/11 [==================>...........] - ETA: 0s - loss: 0.1703 - accuracy: 0.4468 9/11 [=======================>......] - ETA: 0s - loss: 0.1672 - accuracy: 0.445911/11 [==============================] - 0s 28ms/step - loss: 0.1628 - accuracy: 0.4470
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1213 - accuracy: 0.3828 3/11 [=======>......................] - ETA: 0s - loss: 0.1158 - accuracy: 0.4236 5/11 [============>.................] - ETA: 0s - loss: 0.1142 - accuracy: 0.4339 8/11 [====================>.........] - ETA: 0s - loss: 0.1128 - accuracy: 0.440110/11 [==========================>...] - ETA: 0s - loss: 0.1118 - accuracy: 0.442711/11 [==============================] - 0s 28ms/step - loss: 0.1109 - accuracy: 0.4445
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1040 - accuracy: 0.3750 3/11 [=======>......................] - ETA: 0s - loss: 0.1012 - accuracy: 0.4054 5/11 [============>.................] - ETA: 0s - loss: 0.0983 - accuracy: 0.4313 7/11 [==================>...........] - ETA: 0s - loss: 0.0971 - accuracy: 0.4395 9/11 [=======================>......] - ETA: 0s - loss: 0.0965 - accuracy: 0.442811/11 [==============================] - 0s 27ms/step - loss: 0.0958 - accuracy: 0.4461
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0863 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.0856 - accuracy: 0.4974 6/11 [===============>..............] - ETA: 0s - loss: 0.0848 - accuracy: 0.4945 8/11 [====================>.........] - ETA: 0s - loss: 0.0843 - accuracy: 0.492010/11 [==========================>...] - ETA: 0s - loss: 0.0837 - accuracy: 0.491011/11 [==============================] - 0s 26ms/step - loss: 0.0833 - accuracy: 0.4911
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0852 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.0810 - accuracy: 0.5148 6/11 [===============>..............] - ETA: 0s - loss: 0.0794 - accuracy: 0.5272 8/11 [====================>.........] - ETA: 0s - loss: 0.0782 - accuracy: 0.529610/11 [==========================>...] - ETA: 0s - loss: 0.0774 - accuracy: 0.531011/11 [==============================] - 0s 27ms/step - loss: 0.0767 - accuracy: 0.5319
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0735 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.0721 - accuracy: 0.5317 6/11 [===============>..............] - ETA: 0s - loss: 0.0700 - accuracy: 0.5366 8/11 [====================>.........] - ETA: 0s - loss: 0.0691 - accuracy: 0.536210/11 [==========================>...] - ETA: 0s - loss: 0.0687 - accuracy: 0.537611/11 [==============================] - 0s 27ms/step - loss: 0.0683 - accuracy: 0.5391
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0652 - accuracy: 0.6016 4/11 [=========>....................] - ETA: 0s - loss: 0.0646 - accuracy: 0.5780 6/11 [===============>..............] - ETA: 0s - loss: 0.0636 - accuracy: 0.5787 9/11 [=======================>......] - ETA: 0s - loss: 0.0629 - accuracy: 0.583511/11 [==============================] - ETA: 0s - loss: 0.0626 - accuracy: 0.588411/11 [==============================] - 0s 27ms/step - loss: 0.0624 - accuracy: 0.5905
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0596 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.0586 - accuracy: 0.6780 5/11 [============>.................] - ETA: 0s - loss: 0.0593 - accuracy: 0.6753 7/11 [==================>...........] - ETA: 0s - loss: 0.0590 - accuracy: 0.6777 9/11 [=======================>......] - ETA: 0s - loss: 0.0584 - accuracy: 0.680511/11 [==============================] - ETA: 0s - loss: 0.0581 - accuracy: 0.681311/11 [==============================] - 0s 28ms/step - loss: 0.0580 - accuracy: 0.6818
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0491 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.0516 - accuracy: 0.6918 6/11 [===============>..............] - ETA: 0s - loss: 0.0521 - accuracy: 0.6983 8/11 [====================>.........] - ETA: 0s - loss: 0.0521 - accuracy: 0.699210/11 [==========================>...] - ETA: 0s - loss: 0.0523 - accuracy: 0.699511/11 [==============================] - 0s 27ms/step - loss: 0.0525 - accuracy: 0.6996
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0485 - accuracy: 0.7031 3/11 [=======>......................] - ETA: 0s - loss: 0.0503 - accuracy: 0.7201 5/11 [============>.................] - ETA: 0s - loss: 0.0506 - accuracy: 0.7295 7/11 [==================>...........] - ETA: 0s - loss: 0.0505 - accuracy: 0.7325 9/11 [=======================>......] - ETA: 0s - loss: 0.0505 - accuracy: 0.732211/11 [==============================] - ETA: 0s - loss: 0.0504 - accuracy: 0.730411/11 [==============================] - 0s 29ms/step - loss: 0.0504 - accuracy: 0.7296
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0461 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.0468 - accuracy: 0.6840 5/11 [============>.................] - ETA: 0s - loss: 0.0471 - accuracy: 0.6967 7/11 [==================>...........] - ETA: 0s - loss: 0.0472 - accuracy: 0.7055 9/11 [=======================>......] - ETA: 0s - loss: 0.0472 - accuracy: 0.710211/11 [==============================] - 0s 27ms/step - loss: 0.0472 - accuracy: 0.7158
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0376 - accuracy: 0.7344 4/11 [=========>....................] - ETA: 0s - loss: 0.0408 - accuracy: 0.7350 7/11 [==================>...........] - ETA: 0s - loss: 0.0418 - accuracy: 0.7367 9/11 [=======================>......] - ETA: 0s - loss: 0.0424 - accuracy: 0.738311/11 [==============================] - ETA: 0s - loss: 0.0428 - accuracy: 0.739211/11 [==============================] - 0s 28ms/step - loss: 0.0429 - accuracy: 0.7395
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0429 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.0415 - accuracy: 0.7635 5/11 [============>.................] - ETA: 0s - loss: 0.0416 - accuracy: 0.7664 7/11 [==================>...........] - ETA: 0s - loss: 0.0417 - accuracy: 0.7662 9/11 [=======================>......] - ETA: 0s - loss: 0.0420 - accuracy: 0.765111/11 [==============================] - 0s 28ms/step - loss: 0.0420 - accuracy: 0.7644
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0359 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.0380 - accuracy: 0.7444 5/11 [============>.................] - ETA: 0s - loss: 0.0384 - accuracy: 0.7612 8/11 [====================>.........] - ETA: 0s - loss: 0.0387 - accuracy: 0.770410/11 [==========================>...] - ETA: 0s - loss: 0.0389 - accuracy: 0.775111/11 [==============================] - 0s 26ms/step - loss: 0.0390 - accuracy: 0.7767
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0341 - accuracy: 0.7656 3/11 [=======>......................] - ETA: 0s - loss: 0.0365 - accuracy: 0.7908 6/11 [===============>..............] - ETA: 0s - loss: 0.0373 - accuracy: 0.8135 8/11 [====================>.........] - ETA: 0s - loss: 0.0373 - accuracy: 0.817710/11 [==========================>...] - ETA: 0s - loss: 0.0372 - accuracy: 0.818111/11 [==============================] - 0s 26ms/step - loss: 0.0371 - accuracy: 0.8176
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0288 - accuracy: 0.8516 4/11 [=========>....................] - ETA: 0s - loss: 0.0320 - accuracy: 0.8481 7/11 [==================>...........] - ETA: 0s - loss: 0.0329 - accuracy: 0.8401 9/11 [=======================>......] - ETA: 0s - loss: 0.0333 - accuracy: 0.835711/11 [==============================] - ETA: 0s - loss: 0.0334 - accuracy: 0.832711/11 [==============================] - 0s 26ms/step - loss: 0.0335 - accuracy: 0.8316
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0332 - accuracy: 0.8359 4/11 [=========>....................] - ETA: 0s - loss: 0.0320 - accuracy: 0.8547 6/11 [===============>..............] - ETA: 0s - loss: 0.0317 - accuracy: 0.8517 8/11 [====================>.........] - ETA: 0s - loss: 0.0317 - accuracy: 0.852911/11 [==============================] - ETA: 0s - loss: 0.0316 - accuracy: 0.855511/11 [==============================] - 0s 28ms/step - loss: 0.0316 - accuracy: 0.8560
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0343 - accuracy: 0.9062 3/11 [=======>......................] - ETA: 0s - loss: 0.0321 - accuracy: 0.8885 5/11 [============>.................] - ETA: 0s - loss: 0.0308 - accuracy: 0.8807 7/11 [==================>...........] - ETA: 0s - loss: 0.0303 - accuracy: 0.8730 9/11 [=======================>......] - ETA: 0s - loss: 0.0301 - accuracy: 0.869111/11 [==============================] - 0s 27ms/step - loss: 0.0297 - accuracy: 0.8667
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0268 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0278 - accuracy: 0.8859 5/11 [============>.................] - ETA: 0s - loss: 0.0279 - accuracy: 0.8839 7/11 [==================>...........] - ETA: 0s - loss: 0.0278 - accuracy: 0.8813 9/11 [=======================>......] - ETA: 0s - loss: 0.0276 - accuracy: 0.881211/11 [==============================] - 0s 27ms/step - loss: 0.0274 - accuracy: 0.8814
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0326 - accuracy: 0.85166/6 [==============================] - ETA: 0s - loss: 0.0256 - accuracy: 0.8810 6/6 [==============================] - 5s 11ms/step - loss: 0.0256 - accuracy: 0.8810
2021-12-13 23:52:29.655809: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:52:29.656745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:52:29.656801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:52:29.656849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:52:29.656880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:52:29.656910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:52:29.656954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:52:29.656986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:52:29.657016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:52:29.657047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:52:29.657732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:52:29.657774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:52:29.657785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:52:29.657794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:52:29.658542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:52:29.658894: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:52:29.659275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:52:29.659302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:52:29.659328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:52:29.659354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:52:29.659379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:52:29.659404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:52:29.659428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:52:29.659452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:52:29.659477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:52:29.660181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:52:29.660208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:52:29.660219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:52:29.660228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:52:29.660983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 0 1 4] pred: [ 0.00968404  0.00852938  0.9857306   0.04556405 -0.03542691]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 0 4 1 3] pred: [ 0.03632156 -0.00457182  0.99080694 -0.0049525  -0.00101319]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 0 4 1] pred: [-0.03572138 -0.17438136  0.97464526 -0.00729843 -0.049877  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 4 3 0] pred: [-0.0814886   0.41138986  0.7279896  -0.02071332 -0.00146121]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 4 0 3 1] pred: [ 0.03489402 -0.03808682  0.994322   -0.01673407  0.04887109]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [4 3 1 0 2] pred: [-0.03023879  0.05994224 -0.07354393  0.39463082  0.8074513 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 0 4 3 2] pred: [ 0.00437622  0.9400566  -0.10260862 -0.07014123 -0.02975   ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 3 0] pred: [-0.02161055  0.64717495  0.9345723   0.04452889  0.05996507]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [-0.01108931  0.31500578  0.65913874  0.21949299 -0.0443975 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 4 3] pred: [0.01378422 0.9050845  0.82790005 0.00574959 0.00807875]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [4 3 1 0 2] pred: [-0.08097398 -0.05995006 -0.1593997   0.46054238  0.8341077 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [-0.02702355  0.18411516  0.9668207   0.05432098 -0.02094248]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 3 0 4] pred: [0.01192279 0.9046973  0.724769   0.01309764 0.00243368]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [-0.0188136   0.07159702  0.98572874 -0.01085857 -0.01722861]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [ 0.01025507  0.83189726  0.8942102   0.02590957 -0.00858239]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:31 - loss: 0.2480 - accuracy: 0.2969 3/11 [=======>......................] - ETA: 0s - loss: 0.2494 - accuracy: 0.3806   5/11 [============>.................] - ETA: 0s - loss: 0.2457 - accuracy: 0.4042 7/11 [==================>...........] - ETA: 0s - loss: 0.2411 - accuracy: 0.4174 9/11 [=======================>......] - ETA: 0s - loss: 0.2367 - accuracy: 0.425211/11 [==============================] - ETA: 0s - loss: 0.2326 - accuracy: 0.430711/11 [==============================] - 15s 29ms/step - loss: 0.2310 - accuracy: 0.4327
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1617 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.1589 - accuracy: 0.4679 5/11 [============>.................] - ETA: 0s - loss: 0.1556 - accuracy: 0.4645 7/11 [==================>...........] - ETA: 0s - loss: 0.1525 - accuracy: 0.4614 9/11 [=======================>......] - ETA: 0s - loss: 0.1497 - accuracy: 0.458411/11 [==============================] - ETA: 0s - loss: 0.1470 - accuracy: 0.456611/11 [==============================] - 0s 29ms/step - loss: 0.1460 - accuracy: 0.4558
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1107 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.1140 - accuracy: 0.4056 6/11 [===============>..............] - ETA: 0s - loss: 0.1139 - accuracy: 0.4137 8/11 [====================>.........] - ETA: 0s - loss: 0.1131 - accuracy: 0.422210/11 [==========================>...] - ETA: 0s - loss: 0.1121 - accuracy: 0.428011/11 [==============================] - 0s 27ms/step - loss: 0.1116 - accuracy: 0.4311
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1097 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.1062 - accuracy: 0.4006 5/11 [============>.................] - ETA: 0s - loss: 0.1041 - accuracy: 0.4140 7/11 [==================>...........] - ETA: 0s - loss: 0.1022 - accuracy: 0.422310/11 [==========================>...] - ETA: 0s - loss: 0.1011 - accuracy: 0.428511/11 [==============================] - 0s 28ms/step - loss: 0.1004 - accuracy: 0.4318
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0908 - accuracy: 0.3594 3/11 [=======>......................] - ETA: 0s - loss: 0.0890 - accuracy: 0.3958 5/11 [============>.................] - ETA: 0s - loss: 0.0883 - accuracy: 0.4133 7/11 [==================>...........] - ETA: 0s - loss: 0.0880 - accuracy: 0.4245 9/11 [=======================>......] - ETA: 0s - loss: 0.0873 - accuracy: 0.431311/11 [==============================] - 0s 28ms/step - loss: 0.0865 - accuracy: 0.4371
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0669 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.0700 - accuracy: 0.5035 5/11 [============>.................] - ETA: 0s - loss: 0.0720 - accuracy: 0.4883 7/11 [==================>...........] - ETA: 0s - loss: 0.0727 - accuracy: 0.4888 9/11 [=======================>......] - ETA: 0s - loss: 0.0729 - accuracy: 0.490811/11 [==============================] - 0s 27ms/step - loss: 0.0730 - accuracy: 0.4938
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0684 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.0686 - accuracy: 0.5295 5/11 [============>.................] - ETA: 0s - loss: 0.0676 - accuracy: 0.5422 7/11 [==================>...........] - ETA: 0s - loss: 0.0670 - accuracy: 0.5512 9/11 [=======================>......] - ETA: 0s - loss: 0.0666 - accuracy: 0.557611/11 [==============================] - ETA: 0s - loss: 0.0665 - accuracy: 0.561711/11 [==============================] - 0s 29ms/step - loss: 0.0664 - accuracy: 0.5632
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0604 - accuracy: 0.6328 4/11 [=========>....................] - ETA: 0s - loss: 0.0606 - accuracy: 0.6027 7/11 [==================>...........] - ETA: 0s - loss: 0.0608 - accuracy: 0.6002 9/11 [=======================>......] - ETA: 0s - loss: 0.0606 - accuracy: 0.601411/11 [==============================] - ETA: 0s - loss: 0.0605 - accuracy: 0.603611/11 [==============================] - 0s 27ms/step - loss: 0.0605 - accuracy: 0.6044
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0536 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.0544 - accuracy: 0.6476 5/11 [============>.................] - ETA: 0s - loss: 0.0549 - accuracy: 0.6461 7/11 [==================>...........] - ETA: 0s - loss: 0.0550 - accuracy: 0.646910/11 [==========================>...] - ETA: 0s - loss: 0.0551 - accuracy: 0.648311/11 [==============================] - 0s 27ms/step - loss: 0.0552 - accuracy: 0.6481
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0476 - accuracy: 0.6172 3/11 [=======>......................] - ETA: 0s - loss: 0.0491 - accuracy: 0.6263 5/11 [============>.................] - ETA: 0s - loss: 0.0496 - accuracy: 0.6300 7/11 [==================>...........] - ETA: 0s - loss: 0.0502 - accuracy: 0.6314 9/11 [=======================>......] - ETA: 0s - loss: 0.0505 - accuracy: 0.634811/11 [==============================] - ETA: 0s - loss: 0.0508 - accuracy: 0.638511/11 [==============================] - 0s 29ms/step - loss: 0.0509 - accuracy: 0.6402
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0592 - accuracy: 0.6406 4/11 [=========>....................] - ETA: 0s - loss: 0.0530 - accuracy: 0.6681 6/11 [===============>..............] - ETA: 0s - loss: 0.0518 - accuracy: 0.6756 8/11 [====================>.........] - ETA: 0s - loss: 0.0510 - accuracy: 0.684610/11 [==========================>...] - ETA: 0s - loss: 0.0506 - accuracy: 0.693011/11 [==============================] - 0s 27ms/step - loss: 0.0503 - accuracy: 0.6993
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0491 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.0502 - accuracy: 0.7005 5/11 [============>.................] - ETA: 0s - loss: 0.0498 - accuracy: 0.7091 7/11 [==================>...........] - ETA: 0s - loss: 0.0495 - accuracy: 0.7160 9/11 [=======================>......] - ETA: 0s - loss: 0.0489 - accuracy: 0.718811/11 [==============================] - ETA: 0s - loss: 0.0484 - accuracy: 0.721511/11 [==============================] - 0s 28ms/step - loss: 0.0482 - accuracy: 0.7227
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0499 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.0482 - accuracy: 0.7795 5/11 [============>.................] - ETA: 0s - loss: 0.0469 - accuracy: 0.7750 7/11 [==================>...........] - ETA: 0s - loss: 0.0460 - accuracy: 0.772210/11 [==========================>...] - ETA: 0s - loss: 0.0452 - accuracy: 0.773811/11 [==============================] - 0s 28ms/step - loss: 0.0449 - accuracy: 0.7753
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0415 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.0396 - accuracy: 0.7552 5/11 [============>.................] - ETA: 0s - loss: 0.0396 - accuracy: 0.7505 7/11 [==================>...........] - ETA: 0s - loss: 0.0398 - accuracy: 0.7488 9/11 [=======================>......] - ETA: 0s - loss: 0.0400 - accuracy: 0.750611/11 [==============================] - 0s 28ms/step - loss: 0.0402 - accuracy: 0.7583
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0331 - accuracy: 0.8594 3/11 [=======>......................] - ETA: 0s - loss: 0.0342 - accuracy: 0.8546 6/11 [===============>..............] - ETA: 0s - loss: 0.0349 - accuracy: 0.8444 8/11 [====================>.........] - ETA: 0s - loss: 0.0353 - accuracy: 0.838910/11 [==========================>...] - ETA: 0s - loss: 0.0358 - accuracy: 0.834911/11 [==============================] - 0s 29ms/step - loss: 0.0362 - accuracy: 0.8322
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0334 - accuracy: 0.8594 3/11 [=======>......................] - ETA: 0s - loss: 0.0354 - accuracy: 0.8368 5/11 [============>.................] - ETA: 0s - loss: 0.0356 - accuracy: 0.8365 7/11 [==================>...........] - ETA: 0s - loss: 0.0358 - accuracy: 0.8338 9/11 [=======================>......] - ETA: 0s - loss: 0.0358 - accuracy: 0.833611/11 [==============================] - ETA: 0s - loss: 0.0358 - accuracy: 0.835711/11 [==============================] - 0s 28ms/step - loss: 0.0358 - accuracy: 0.8365
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0399 - accuracy: 0.8984 3/11 [=======>......................] - ETA: 0s - loss: 0.0386 - accuracy: 0.8941 6/11 [===============>..............] - ETA: 0s - loss: 0.0378 - accuracy: 0.8898 8/11 [====================>.........] - ETA: 0s - loss: 0.0373 - accuracy: 0.882610/11 [==========================>...] - ETA: 0s - loss: 0.0367 - accuracy: 0.876211/11 [==============================] - 0s 27ms/step - loss: 0.0363 - accuracy: 0.8715
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0320 - accuracy: 0.9219 3/11 [=======>......................] - ETA: 0s - loss: 0.0326 - accuracy: 0.9158 5/11 [============>.................] - ETA: 0s - loss: 0.0323 - accuracy: 0.9163 7/11 [==================>...........] - ETA: 0s - loss: 0.0320 - accuracy: 0.9130 9/11 [=======================>......] - ETA: 0s - loss: 0.0319 - accuracy: 0.909411/11 [==============================] - 0s 29ms/step - loss: 0.0320 - accuracy: 0.9054
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0310 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0305 - accuracy: 0.8828 5/11 [============>.................] - ETA: 0s - loss: 0.0302 - accuracy: 0.8924 7/11 [==================>...........] - ETA: 0s - loss: 0.0302 - accuracy: 0.8982 9/11 [=======================>......] - ETA: 0s - loss: 0.0304 - accuracy: 0.902611/11 [==============================] - 0s 28ms/step - loss: 0.0304 - accuracy: 0.9073
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0281 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.0292 - accuracy: 0.8898 5/11 [============>.................] - ETA: 0s - loss: 0.0289 - accuracy: 0.8931 7/11 [==================>...........] - ETA: 0s - loss: 0.0290 - accuracy: 0.8935 9/11 [=======================>......] - ETA: 0s - loss: 0.0290 - accuracy: 0.894711/11 [==============================] - ETA: 0s - loss: 0.0290 - accuracy: 0.895711/11 [==============================] - 0s 29ms/step - loss: 0.0290 - accuracy: 0.8962
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0320 - accuracy: 0.86726/6 [==============================] - ETA: 0s - loss: 0.0329 - accuracy: 0.8810 6/6 [==============================] - 5s 10ms/step - loss: 0.0329 - accuracy: 0.8810
2021-12-13 23:53:07.107175: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:53:07.108615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:53:07.108697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:53:07.108760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:53:07.108806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:53:07.108857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:53:07.108904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:53:07.109258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:53:07.109310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:53:07.109356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:53:07.110320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:53:07.110378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:53:07.110394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:53:07.110409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:53:07.111449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:53:07.112139: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:53:07.112648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:53:07.112687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:53:07.112726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:53:07.112764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:53:07.112800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:53:07.112836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:53:07.112876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:53:07.112913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:53:07.112967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:53:07.113945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:53:07.113985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:53:07.114002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:53:07.114015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:53:07.115034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 2 0 4 1] pred: [ 0.05131658 -0.1386408   0.11962087  0.8223006   0.00619143]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [4 3 1 0 2] pred: [-0.0537389   0.02315584 -0.09607415  0.31336513  0.7667062 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [-0.02778812  0.285584    0.79635173  0.16126616 -0.06291589]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [-0.02776206  0.14308761  0.8599189   0.0607544  -0.04221703]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 4 3 0] pred: [-0.03476364  0.07091272  0.9739079  -0.0021723   0.02635339]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 3 0] pred: [-0.03199237  0.11156804  0.9732814   0.0129797   0.02812492]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [ 0.04479204  0.34357443  0.96287453  0.04444919 -0.05827281]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [4 3 1 0 2] pred: [-0.01769492  0.05111666 -0.20124745  0.19024017  0.78754103]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 4 0 1] pred: [0.01332686 0.00351079 0.96879876 0.0600524  0.01446042]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [ 0.00672546  0.03218635  0.9724319   0.01629506 -0.00940699]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 0 4 3 1] pred: [ 0.04153934 -0.04220186  0.9667361   0.0054362   0.01510977]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 3 0 4] pred: [-0.01990437  0.8153367   0.7286884  -0.01041568 -0.04627369]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [0.00488508 0.17482981 0.9647331  0.04643194 0.01911242]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 0 3] pred: [ 0.03535713  0.6085633   0.98316103 -0.19515522  0.04752277]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 4 3 0] pred: [-0.04477902  0.08503117  0.9676688   0.01483531  0.04990739]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:36 - loss: 0.2656 - accuracy: 0.3594 3/11 [=======>......................] - ETA: 0s - loss: 0.2534 - accuracy: 0.4036   5/11 [============>.................] - ETA: 0s - loss: 0.2466 - accuracy: 0.4188 7/11 [==================>...........] - ETA: 0s - loss: 0.2407 - accuracy: 0.4318 9/11 [=======================>......] - ETA: 0s - loss: 0.2355 - accuracy: 0.438611/11 [==============================] - 16s 27ms/step - loss: 0.2288 - accuracy: 0.4438
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1592 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.1549 - accuracy: 0.4562 5/11 [============>.................] - ETA: 0s - loss: 0.1509 - accuracy: 0.4557 7/11 [==================>...........] - ETA: 0s - loss: 0.1473 - accuracy: 0.4560 9/11 [=======================>......] - ETA: 0s - loss: 0.1444 - accuracy: 0.454311/11 [==============================] - ETA: 0s - loss: 0.1417 - accuracy: 0.455511/11 [==============================] - 0s 29ms/step - loss: 0.1407 - accuracy: 0.4560
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1075 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.1116 - accuracy: 0.4731 5/11 [============>.................] - ETA: 0s - loss: 0.1109 - accuracy: 0.4715 7/11 [==================>...........] - ETA: 0s - loss: 0.1101 - accuracy: 0.4732 9/11 [=======================>......] - ETA: 0s - loss: 0.1096 - accuracy: 0.470911/11 [==============================] - ETA: 0s - loss: 0.1087 - accuracy: 0.469211/11 [==============================] - 0s 29ms/step - loss: 0.1083 - accuracy: 0.4686
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0890 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.0893 - accuracy: 0.5004 5/11 [============>.................] - ETA: 0s - loss: 0.0898 - accuracy: 0.4953 8/11 [====================>.........] - ETA: 0s - loss: 0.0901 - accuracy: 0.489210/11 [==========================>...] - ETA: 0s - loss: 0.0901 - accuracy: 0.484611/11 [==============================] - 0s 28ms/step - loss: 0.0902 - accuracy: 0.4817
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0858 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.0819 - accuracy: 0.4735 5/11 [============>.................] - ETA: 0s - loss: 0.0813 - accuracy: 0.4728 7/11 [==================>...........] - ETA: 0s - loss: 0.0812 - accuracy: 0.4763 9/11 [=======================>......] - ETA: 0s - loss: 0.0808 - accuracy: 0.479511/11 [==============================] - ETA: 0s - loss: 0.0805 - accuracy: 0.481011/11 [==============================] - 0s 29ms/step - loss: 0.0804 - accuracy: 0.4814
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0784 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.0757 - accuracy: 0.5135 5/11 [============>.................] - ETA: 0s - loss: 0.0753 - accuracy: 0.5114 7/11 [==================>...........] - ETA: 0s - loss: 0.0750 - accuracy: 0.5081 9/11 [=======================>......] - ETA: 0s - loss: 0.0746 - accuracy: 0.507111/11 [==============================] - ETA: 0s - loss: 0.0742 - accuracy: 0.507411/11 [==============================] - 0s 28ms/step - loss: 0.0740 - accuracy: 0.5075
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0624 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.0665 - accuracy: 0.5169 5/11 [============>.................] - ETA: 0s - loss: 0.0674 - accuracy: 0.5156 7/11 [==================>...........] - ETA: 0s - loss: 0.0675 - accuracy: 0.518610/11 [==========================>...] - ETA: 0s - loss: 0.0669 - accuracy: 0.524311/11 [==============================] - 0s 27ms/step - loss: 0.0666 - accuracy: 0.5273
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0596 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.0616 - accuracy: 0.6549 5/11 [============>.................] - ETA: 0s - loss: 0.0613 - accuracy: 0.6454 7/11 [==================>...........] - ETA: 0s - loss: 0.0609 - accuracy: 0.636610/11 [==========================>...] - ETA: 0s - loss: 0.0605 - accuracy: 0.627111/11 [==============================] - 0s 27ms/step - loss: 0.0602 - accuracy: 0.6236
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0576 - accuracy: 0.6797 4/11 [=========>....................] - ETA: 0s - loss: 0.0558 - accuracy: 0.6846 6/11 [===============>..............] - ETA: 0s - loss: 0.0551 - accuracy: 0.6762 8/11 [====================>.........] - ETA: 0s - loss: 0.0546 - accuracy: 0.674910/11 [==========================>...] - ETA: 0s - loss: 0.0543 - accuracy: 0.675011/11 [==============================] - 0s 27ms/step - loss: 0.0541 - accuracy: 0.6757
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0545 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.0546 - accuracy: 0.7005 5/11 [============>.................] - ETA: 0s - loss: 0.0536 - accuracy: 0.7001 7/11 [==================>...........] - ETA: 0s - loss: 0.0528 - accuracy: 0.6998 9/11 [=======================>......] - ETA: 0s - loss: 0.0522 - accuracy: 0.698711/11 [==============================] - ETA: 0s - loss: 0.0517 - accuracy: 0.698211/11 [==============================] - 0s 28ms/step - loss: 0.0514 - accuracy: 0.6982
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0439 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.0439 - accuracy: 0.7010 5/11 [============>.................] - ETA: 0s - loss: 0.0443 - accuracy: 0.7035 7/11 [==================>...........] - ETA: 0s - loss: 0.0446 - accuracy: 0.7055 9/11 [=======================>......] - ETA: 0s - loss: 0.0449 - accuracy: 0.706011/11 [==============================] - 0s 29ms/step - loss: 0.0451 - accuracy: 0.7079
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0501 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.0473 - accuracy: 0.7062 5/11 [============>.................] - ETA: 0s - loss: 0.0463 - accuracy: 0.7264 7/11 [==================>...........] - ETA: 0s - loss: 0.0454 - accuracy: 0.7342 9/11 [=======================>......] - ETA: 0s - loss: 0.0449 - accuracy: 0.738511/11 [==============================] - ETA: 0s - loss: 0.0447 - accuracy: 0.739111/11 [==============================] - 0s 28ms/step - loss: 0.0446 - accuracy: 0.7392
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0392 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.0407 - accuracy: 0.7973 5/11 [============>.................] - ETA: 0s - loss: 0.0411 - accuracy: 0.7985 7/11 [==================>...........] - ETA: 0s - loss: 0.0413 - accuracy: 0.794810/11 [==========================>...] - ETA: 0s - loss: 0.0414 - accuracy: 0.785611/11 [==============================] - 0s 28ms/step - loss: 0.0414 - accuracy: 0.7810
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0388 - accuracy: 0.7656 3/11 [=======>......................] - ETA: 0s - loss: 0.0385 - accuracy: 0.7734 5/11 [============>.................] - ETA: 0s - loss: 0.0382 - accuracy: 0.7717 7/11 [==================>...........] - ETA: 0s - loss: 0.0383 - accuracy: 0.773310/11 [==========================>...] - ETA: 0s - loss: 0.0383 - accuracy: 0.773211/11 [==============================] - 0s 28ms/step - loss: 0.0384 - accuracy: 0.7737
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0359 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.0372 - accuracy: 0.7778 5/11 [============>.................] - ETA: 0s - loss: 0.0376 - accuracy: 0.7870 7/11 [==================>...........] - ETA: 0s - loss: 0.0378 - accuracy: 0.7968 9/11 [=======================>......] - ETA: 0s - loss: 0.0377 - accuracy: 0.800411/11 [==============================] - ETA: 0s - loss: 0.0376 - accuracy: 0.799811/11 [==============================] - 0s 28ms/step - loss: 0.0376 - accuracy: 0.7992
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0387 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.0374 - accuracy: 0.7661 5/11 [============>.................] - ETA: 0s - loss: 0.0370 - accuracy: 0.7733 7/11 [==================>...........] - ETA: 0s - loss: 0.0367 - accuracy: 0.7820 9/11 [=======================>......] - ETA: 0s - loss: 0.0363 - accuracy: 0.788711/11 [==============================] - 0s 28ms/step - loss: 0.0358 - accuracy: 0.7953
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0363 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.0340 - accuracy: 0.7834 6/11 [===============>..............] - ETA: 0s - loss: 0.0338 - accuracy: 0.7836 8/11 [====================>.........] - ETA: 0s - loss: 0.0337 - accuracy: 0.788610/11 [==========================>...] - ETA: 0s - loss: 0.0334 - accuracy: 0.790811/11 [==============================] - 0s 27ms/step - loss: 0.0333 - accuracy: 0.7926
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0328 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.0325 - accuracy: 0.7852 5/11 [============>.................] - ETA: 0s - loss: 0.0323 - accuracy: 0.7931 7/11 [==================>...........] - ETA: 0s - loss: 0.0319 - accuracy: 0.8003 9/11 [=======================>......] - ETA: 0s - loss: 0.0315 - accuracy: 0.805311/11 [==============================] - ETA: 0s - loss: 0.0313 - accuracy: 0.807811/11 [==============================] - 0s 28ms/step - loss: 0.0313 - accuracy: 0.8087
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0296 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.0297 - accuracy: 0.8351 5/11 [============>.................] - ETA: 0s - loss: 0.0298 - accuracy: 0.8415 8/11 [====================>.........] - ETA: 0s - loss: 0.0297 - accuracy: 0.836310/11 [==========================>...] - ETA: 0s - loss: 0.0296 - accuracy: 0.833811/11 [==============================] - 0s 27ms/step - loss: 0.0295 - accuracy: 0.8321
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0332 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0293 - accuracy: 0.8346 5/11 [============>.................] - ETA: 0s - loss: 0.0292 - accuracy: 0.8281 7/11 [==================>...........] - ETA: 0s - loss: 0.0287 - accuracy: 0.8286 9/11 [=======================>......] - ETA: 0s - loss: 0.0284 - accuracy: 0.830711/11 [==============================] - ETA: 0s - loss: 0.0282 - accuracy: 0.834011/11 [==============================] - 0s 27ms/step - loss: 0.0280 - accuracy: 0.8354
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0243 - accuracy: 0.85166/6 [==============================] - ETA: 0s - loss: 0.0283 - accuracy: 0.8541 6/6 [==============================] - 5s 11ms/step - loss: 0.0283 - accuracy: 0.8541
2021-12-13 23:53:43.825495: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:53:43.826310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:53:43.826382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:53:43.826441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:53:43.826480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:53:43.826530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:53:43.826579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:53:43.826626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:53:43.826673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:53:43.826721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:53:43.827673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:53:43.827731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:53:43.827750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:53:43.827763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:53:43.828786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:53:43.829434: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:53:43.829803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:53:43.829831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:53:43.829857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:53:43.829882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:53:43.829907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:53:43.829942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:53:43.829969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:53:43.829995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:53:43.830024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:53:43.830693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:53:43.830721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:53:43.830732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:53:43.830740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:53:43.831512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [ 0.06450708  0.8476752   0.8960495  -0.0281662   0.00408999]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 4 0 3] pred: [ 0.02382237  0.50166994  0.9661703  -0.20138393  0.10022814]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 3 0] pred: [-0.11276999  0.4035532   0.9804171  -0.00467189  0.00915914]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 4 3 0] pred: [-0.06551909  0.9193554   0.8599403  -0.02489743  0.07246124]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [ 0.02889708  0.6737865   0.86428916  0.0455572  -0.00604854]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 4 3 0] pred: [-0.04136072  0.8802346   0.87459433 -0.02935207  0.04339511]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [0 1 3 4 2] pred: [ 0.8295754   0.23411672 -0.3417127   0.12742381 -0.11950471]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 3 0 1] pred: [ 0.01577765 -0.01699987  0.99846864  0.02212182  0.02696782]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 4 0 3] pred: [-0.01818816  0.89868444  0.83760566 -0.04059969  0.02828448]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 4 0 3] pred: [-0.01194064  0.8548636   0.8588605  -0.01492648  0.02698188]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 4 0 1] pred: [2.8724961e-03 6.2860071e-04 9.9787164e-01 1.5668264e-02 8.8581648e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 4 3] pred: [ 0.19780016  0.79026824  0.7187517  -0.17732039  0.0874849 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 4 0 3 1] pred: [ 0.08501098 -0.19511507  0.97130394  0.00555371  0.09064605]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 3 0] pred: [8.0560130e-04 2.5059922e-02 9.9588674e-01 1.0834809e-02 2.1598296e-02]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 4 0 3 1] pred: [-0.00911959 -0.08834625  0.99558204 -0.06345601  0.05781171]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:27 - loss: 0.2531 - accuracy: 0.2969 3/11 [=======>......................] - ETA: 0s - loss: 0.2544 - accuracy: 0.3615   5/11 [============>.................] - ETA: 0s - loss: 0.2501 - accuracy: 0.3890 7/11 [==================>...........] - ETA: 0s - loss: 0.2457 - accuracy: 0.4043 9/11 [=======================>......] - ETA: 0s - loss: 0.2415 - accuracy: 0.414911/11 [==============================] - ETA: 0s - loss: 0.2378 - accuracy: 0.421411/11 [==============================] - 15s 28ms/step - loss: 0.2364 - accuracy: 0.4239
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1813 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.1758 - accuracy: 0.4253 5/11 [============>.................] - ETA: 0s - loss: 0.1705 - accuracy: 0.4324 7/11 [==================>...........] - ETA: 0s - loss: 0.1659 - accuracy: 0.4364 9/11 [=======================>......] - ETA: 0s - loss: 0.1615 - accuracy: 0.440311/11 [==============================] - 0s 28ms/step - loss: 0.1558 - accuracy: 0.4440
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1066 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.1025 - accuracy: 0.4332 5/11 [============>.................] - ETA: 0s - loss: 0.1019 - accuracy: 0.4418 7/11 [==================>...........] - ETA: 0s - loss: 0.1011 - accuracy: 0.4489 9/11 [=======================>......] - ETA: 0s - loss: 0.1006 - accuracy: 0.452911/11 [==============================] - 0s 28ms/step - loss: 0.1002 - accuracy: 0.4545
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0949 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.0905 - accuracy: 0.4766 5/11 [============>.................] - ETA: 0s - loss: 0.0884 - accuracy: 0.4748 7/11 [==================>...........] - ETA: 0s - loss: 0.0875 - accuracy: 0.4758 9/11 [=======================>......] - ETA: 0s - loss: 0.0869 - accuracy: 0.475011/11 [==============================] - 0s 27ms/step - loss: 0.0863 - accuracy: 0.4728
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0798 - accuracy: 0.5312 4/11 [=========>....................] - ETA: 0s - loss: 0.0784 - accuracy: 0.4878 6/11 [===============>..............] - ETA: 0s - loss: 0.0777 - accuracy: 0.4811 8/11 [====================>.........] - ETA: 0s - loss: 0.0769 - accuracy: 0.481710/11 [==========================>...] - ETA: 0s - loss: 0.0762 - accuracy: 0.483011/11 [==============================] - 0s 27ms/step - loss: 0.0758 - accuracy: 0.4840
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0673 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.0654 - accuracy: 0.5308 5/11 [============>.................] - ETA: 0s - loss: 0.0662 - accuracy: 0.5255 7/11 [==================>...........] - ETA: 0s - loss: 0.0661 - accuracy: 0.5249 9/11 [=======================>......] - ETA: 0s - loss: 0.0658 - accuracy: 0.524311/11 [==============================] - 0s 28ms/step - loss: 0.0657 - accuracy: 0.5231
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0566 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.0588 - accuracy: 0.5516 6/11 [===============>..............] - ETA: 0s - loss: 0.0598 - accuracy: 0.5569 8/11 [====================>.........] - ETA: 0s - loss: 0.0597 - accuracy: 0.560310/11 [==========================>...] - ETA: 0s - loss: 0.0595 - accuracy: 0.562011/11 [==============================] - 0s 27ms/step - loss: 0.0594 - accuracy: 0.5631
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0578 - accuracy: 0.6172 3/11 [=======>......................] - ETA: 0s - loss: 0.0560 - accuracy: 0.6124 6/11 [===============>..............] - ETA: 0s - loss: 0.0546 - accuracy: 0.6156 8/11 [====================>.........] - ETA: 0s - loss: 0.0542 - accuracy: 0.617311/11 [==============================] - ETA: 0s - loss: 0.0538 - accuracy: 0.620511/11 [==============================] - 0s 27ms/step - loss: 0.0537 - accuracy: 0.6211
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0523 - accuracy: 0.6328 4/11 [=========>....................] - ETA: 0s - loss: 0.0523 - accuracy: 0.6602 6/11 [===============>..............] - ETA: 0s - loss: 0.0516 - accuracy: 0.6617 9/11 [=======================>......] - ETA: 0s - loss: 0.0508 - accuracy: 0.664111/11 [==============================] - ETA: 0s - loss: 0.0503 - accuracy: 0.666411/11 [==============================] - 0s 26ms/step - loss: 0.0501 - accuracy: 0.6674
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0494 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.0472 - accuracy: 0.6884 5/11 [============>.................] - ETA: 0s - loss: 0.0467 - accuracy: 0.6820 7/11 [==================>...........] - ETA: 0s - loss: 0.0465 - accuracy: 0.6776 9/11 [=======================>......] - ETA: 0s - loss: 0.0462 - accuracy: 0.676011/11 [==============================] - 0s 28ms/step - loss: 0.0458 - accuracy: 0.6763
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0412 - accuracy: 0.7656 3/11 [=======>......................] - ETA: 0s - loss: 0.0410 - accuracy: 0.7496 5/11 [============>.................] - ETA: 0s - loss: 0.0415 - accuracy: 0.7301 7/11 [==================>...........] - ETA: 0s - loss: 0.0418 - accuracy: 0.7195 9/11 [=======================>......] - ETA: 0s - loss: 0.0419 - accuracy: 0.717211/11 [==============================] - 0s 28ms/step - loss: 0.0418 - accuracy: 0.7152
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0363 - accuracy: 0.7031 3/11 [=======>......................] - ETA: 0s - loss: 0.0371 - accuracy: 0.7031 5/11 [============>.................] - ETA: 0s - loss: 0.0384 - accuracy: 0.7177 7/11 [==================>...........] - ETA: 0s - loss: 0.0387 - accuracy: 0.727910/11 [==========================>...] - ETA: 0s - loss: 0.0389 - accuracy: 0.736311/11 [==============================] - 0s 28ms/step - loss: 0.0389 - accuracy: 0.7418
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0432 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.0393 - accuracy: 0.7964 5/11 [============>.................] - ETA: 0s - loss: 0.0382 - accuracy: 0.7911 7/11 [==================>...........] - ETA: 0s - loss: 0.0377 - accuracy: 0.7859 9/11 [=======================>......] - ETA: 0s - loss: 0.0375 - accuracy: 0.782411/11 [==============================] - 0s 28ms/step - loss: 0.0373 - accuracy: 0.7822
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0336 - accuracy: 0.8281 3/11 [=======>......................] - ETA: 0s - loss: 0.0336 - accuracy: 0.8216 5/11 [============>.................] - ETA: 0s - loss: 0.0344 - accuracy: 0.8170 7/11 [==================>...........] - ETA: 0s - loss: 0.0345 - accuracy: 0.8197 9/11 [=======================>......] - ETA: 0s - loss: 0.0347 - accuracy: 0.821211/11 [==============================] - ETA: 0s - loss: 0.0347 - accuracy: 0.821511/11 [==============================] - 0s 29ms/step - loss: 0.0347 - accuracy: 0.8214
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0332 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.0315 - accuracy: 0.8125 5/11 [============>.................] - ETA: 0s - loss: 0.0310 - accuracy: 0.8152 7/11 [==================>...........] - ETA: 0s - loss: 0.0313 - accuracy: 0.8147 9/11 [=======================>......] - ETA: 0s - loss: 0.0316 - accuracy: 0.812711/11 [==============================] - ETA: 0s - loss: 0.0318 - accuracy: 0.813711/11 [==============================] - 0s 28ms/step - loss: 0.0319 - accuracy: 0.8143
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0299 - accuracy: 0.9062 3/11 [=======>......................] - ETA: 0s - loss: 0.0319 - accuracy: 0.8906 5/11 [============>.................] - ETA: 0s - loss: 0.0324 - accuracy: 0.8837 7/11 [==================>...........] - ETA: 0s - loss: 0.0324 - accuracy: 0.8781 9/11 [=======================>......] - ETA: 0s - loss: 0.0323 - accuracy: 0.874411/11 [==============================] - ETA: 0s - loss: 0.0321 - accuracy: 0.871411/11 [==============================] - 0s 28ms/step - loss: 0.0321 - accuracy: 0.8701
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0257 - accuracy: 0.8359 3/11 [=======>......................] - ETA: 0s - loss: 0.0271 - accuracy: 0.8381 5/11 [============>.................] - ETA: 0s - loss: 0.0269 - accuracy: 0.8368 7/11 [==================>...........] - ETA: 0s - loss: 0.0270 - accuracy: 0.8406 9/11 [=======================>......] - ETA: 0s - loss: 0.0273 - accuracy: 0.844911/11 [==============================] - 0s 27ms/step - loss: 0.0278 - accuracy: 0.8473
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0336 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.0314 - accuracy: 0.8264 5/11 [============>.................] - ETA: 0s - loss: 0.0309 - accuracy: 0.8412 7/11 [==================>...........] - ETA: 0s - loss: 0.0306 - accuracy: 0.8492 9/11 [=======================>......] - ETA: 0s - loss: 0.0305 - accuracy: 0.846511/11 [==============================] - ETA: 0s - loss: 0.0304 - accuracy: 0.840811/11 [==============================] - 0s 29ms/step - loss: 0.0304 - accuracy: 0.8386
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0283 - accuracy: 0.7969 4/11 [=========>....................] - ETA: 0s - loss: 0.0289 - accuracy: 0.8501 7/11 [==================>...........] - ETA: 0s - loss: 0.0292 - accuracy: 0.8686 9/11 [=======================>......] - ETA: 0s - loss: 0.0290 - accuracy: 0.874811/11 [==============================] - 0s 27ms/step - loss: 0.0289 - accuracy: 0.8774
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0259 - accuracy: 0.8594 3/11 [=======>......................] - ETA: 0s - loss: 0.0256 - accuracy: 0.8646 5/11 [============>.................] - ETA: 0s - loss: 0.0255 - accuracy: 0.8693 8/11 [====================>.........] - ETA: 0s - loss: 0.0258 - accuracy: 0.871811/11 [==============================] - ETA: 0s - loss: 0.0258 - accuracy: 0.872511/11 [==============================] - 0s 27ms/step - loss: 0.0257 - accuracy: 0.8729
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0305 - accuracy: 0.90626/6 [==============================] - ETA: 0s - loss: 0.0293 - accuracy: 0.9079 6/6 [==============================] - 5s 11ms/step - loss: 0.0293 - accuracy: 0.9079
2021-12-13 23:54:20.104983: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:54:20.105798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:54:20.105871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:54:20.105940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:54:20.105987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:54:20.106034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:54:20.106080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:54:20.106125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:54:20.106167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:54:20.106216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:54:20.107187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:54:20.107241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:54:20.107260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:54:20.107272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:54:20.108280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:54:20.108757: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:54:20.109577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:54:20.109616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:54:20.109653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:54:20.109690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:54:20.109724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:54:20.109765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:54:20.109804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:54:20.109841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:54:20.109876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:54:20.110778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:54:20.110817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:54:20.110833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:54:20.110845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:54:20.111795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 3 1 4] pred: [ 0.049807    0.00130367  0.9778184   0.00133504 -0.05338828]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [ 0.05399405  0.95257837  0.67197895  0.00239067 -0.03954054]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 4 3] pred: [ 0.01122697  0.9165687   0.86972326 -0.07786328 -0.02947137]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [ 0.02986916  0.94869125  0.82490176  0.01566867 -0.00212594]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 4 0 1 3] pred: [ 0.00678496 -0.02152927  0.9932845  -0.03702841  0.06330782]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [ 0.00351609  0.90480155  0.67390174 -0.0311473  -0.03275359]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [ 0.02410346  0.83522004  0.92175114  0.05961087 -0.01295251]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [-0.07533947  0.21089943  0.80941665  0.03587262 -0.03752031]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [4 3 0 1 2] pred: [ 0.01019677 -0.02842317 -0.11898536  0.40295812  0.7148499 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 3 0 4] pred: [-0.01620324  0.92608076  0.6724169  -0.00180965 -0.03172585]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [-0.00975165  0.8081346   0.9228608   0.00868398 -0.04118273]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 2 0 1] pred: [ 0.02291561 -0.02107567  0.0378878   0.8101682   0.09591874]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 0 4] pred: [-0.00425986  0.00850099  0.99070776  0.00914401 -0.02136118]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [-0.03757469  0.08924165  0.8935035  -0.00606996 -0.01280127]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [0 1 3 4 2] pred: [ 0.7362475   0.1606041  -0.1220905   0.0681476   0.00269222]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:28 - loss: 0.2645 - accuracy: 0.0703 3/11 [=======>......................] - ETA: 0s - loss: 0.2601 - accuracy: 0.1437   5/11 [============>.................] - ETA: 0s - loss: 0.2550 - accuracy: 0.2169 7/11 [==================>...........] - ETA: 0s - loss: 0.2497 - accuracy: 0.2652 9/11 [=======================>......] - ETA: 0s - loss: 0.2451 - accuracy: 0.291611/11 [==============================] - 15s 26ms/step - loss: 0.2390 - accuracy: 0.3174
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1737 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.1690 - accuracy: 0.4427 5/11 [============>.................] - ETA: 0s - loss: 0.1644 - accuracy: 0.4512 7/11 [==================>...........] - ETA: 0s - loss: 0.1600 - accuracy: 0.4569 9/11 [=======================>......] - ETA: 0s - loss: 0.1560 - accuracy: 0.459711/11 [==============================] - ETA: 0s - loss: 0.1528 - accuracy: 0.459111/11 [==============================] - 0s 27ms/step - loss: 0.1515 - accuracy: 0.4588
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1101 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.1110 - accuracy: 0.4857 5/11 [============>.................] - ETA: 0s - loss: 0.1105 - accuracy: 0.4718 7/11 [==================>...........] - ETA: 0s - loss: 0.1096 - accuracy: 0.4684 9/11 [=======================>......] - ETA: 0s - loss: 0.1086 - accuracy: 0.468411/11 [==============================] - 0s 26ms/step - loss: 0.1081 - accuracy: 0.4659
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1038 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.1023 - accuracy: 0.4388 5/11 [============>.................] - ETA: 0s - loss: 0.1014 - accuracy: 0.4414 7/11 [==================>...........] - ETA: 0s - loss: 0.1007 - accuracy: 0.442710/11 [==========================>...] - ETA: 0s - loss: 0.0994 - accuracy: 0.447211/11 [==============================] - 0s 26ms/step - loss: 0.0988 - accuracy: 0.4491
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0887 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.0865 - accuracy: 0.4427 6/11 [===============>..............] - ETA: 0s - loss: 0.0867 - accuracy: 0.4433 8/11 [====================>.........] - ETA: 0s - loss: 0.0862 - accuracy: 0.447910/11 [==========================>...] - ETA: 0s - loss: 0.0860 - accuracy: 0.451911/11 [==============================] - 0s 27ms/step - loss: 0.0857 - accuracy: 0.4558
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0760 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.0786 - accuracy: 0.4983 5/11 [============>.................] - ETA: 0s - loss: 0.0782 - accuracy: 0.5004 7/11 [==================>...........] - ETA: 0s - loss: 0.0775 - accuracy: 0.501010/11 [==========================>...] - ETA: 0s - loss: 0.0771 - accuracy: 0.498911/11 [==============================] - 0s 25ms/step - loss: 0.0767 - accuracy: 0.4994
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0728 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.0711 - accuracy: 0.5343 6/11 [===============>..............] - ETA: 0s - loss: 0.0698 - accuracy: 0.5325 8/11 [====================>.........] - ETA: 0s - loss: 0.0693 - accuracy: 0.527810/11 [==========================>...] - ETA: 0s - loss: 0.0690 - accuracy: 0.523311/11 [==============================] - 0s 26ms/step - loss: 0.0687 - accuracy: 0.5221
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0634 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.0636 - accuracy: 0.5052 6/11 [===============>..............] - ETA: 0s - loss: 0.0629 - accuracy: 0.5185 8/11 [====================>.........] - ETA: 0s - loss: 0.0624 - accuracy: 0.525211/11 [==============================] - ETA: 0s - loss: 0.0620 - accuracy: 0.532611/11 [==============================] - 0s 25ms/step - loss: 0.0620 - accuracy: 0.5341
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0553 - accuracy: 0.6484 3/11 [=======>......................] - ETA: 0s - loss: 0.0572 - accuracy: 0.5933 5/11 [============>.................] - ETA: 0s - loss: 0.0576 - accuracy: 0.5887 8/11 [====================>.........] - ETA: 0s - loss: 0.0575 - accuracy: 0.591811/11 [==============================] - ETA: 0s - loss: 0.0574 - accuracy: 0.594311/11 [==============================] - 0s 25ms/step - loss: 0.0574 - accuracy: 0.5950
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0579 - accuracy: 0.6406 4/11 [=========>....................] - ETA: 0s - loss: 0.0550 - accuracy: 0.6239 6/11 [===============>..............] - ETA: 0s - loss: 0.0542 - accuracy: 0.6261 8/11 [====================>.........] - ETA: 0s - loss: 0.0539 - accuracy: 0.628410/11 [==========================>...] - ETA: 0s - loss: 0.0538 - accuracy: 0.630511/11 [==============================] - 0s 26ms/step - loss: 0.0536 - accuracy: 0.6322
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0526 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.0515 - accuracy: 0.6393 5/11 [============>.................] - ETA: 0s - loss: 0.0508 - accuracy: 0.6433 7/11 [==================>...........] - ETA: 0s - loss: 0.0506 - accuracy: 0.6483 9/11 [=======================>......] - ETA: 0s - loss: 0.0504 - accuracy: 0.654111/11 [==============================] - 0s 26ms/step - loss: 0.0502 - accuracy: 0.6612
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0509 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.0494 - accuracy: 0.6836 6/11 [===============>..............] - ETA: 0s - loss: 0.0479 - accuracy: 0.6850 8/11 [====================>.........] - ETA: 0s - loss: 0.0475 - accuracy: 0.685610/11 [==========================>...] - ETA: 0s - loss: 0.0472 - accuracy: 0.685911/11 [==============================] - 0s 26ms/step - loss: 0.0470 - accuracy: 0.6858
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0413 - accuracy: 0.7500 3/11 [=======>......................] - ETA: 0s - loss: 0.0416 - accuracy: 0.7396 6/11 [===============>..............] - ETA: 0s - loss: 0.0423 - accuracy: 0.7342 9/11 [=======================>......] - ETA: 0s - loss: 0.0424 - accuracy: 0.733411/11 [==============================] - ETA: 0s - loss: 0.0425 - accuracy: 0.732611/11 [==============================] - 0s 26ms/step - loss: 0.0425 - accuracy: 0.7322
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0395 - accuracy: 0.7734 4/11 [=========>....................] - ETA: 0s - loss: 0.0410 - accuracy: 0.7650 6/11 [===============>..............] - ETA: 0s - loss: 0.0411 - accuracy: 0.7586 8/11 [====================>.........] - ETA: 0s - loss: 0.0410 - accuracy: 0.755211/11 [==============================] - ETA: 0s - loss: 0.0407 - accuracy: 0.753711/11 [==============================] - 0s 26ms/step - loss: 0.0406 - accuracy: 0.7533
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0336 - accuracy: 0.7031 3/11 [=======>......................] - ETA: 0s - loss: 0.0356 - accuracy: 0.7270 5/11 [============>.................] - ETA: 0s - loss: 0.0364 - accuracy: 0.7331 7/11 [==================>...........] - ETA: 0s - loss: 0.0367 - accuracy: 0.741410/11 [==========================>...] - ETA: 0s - loss: 0.0371 - accuracy: 0.751411/11 [==============================] - 0s 26ms/step - loss: 0.0371 - accuracy: 0.7548
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0371 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.0364 - accuracy: 0.7131 5/11 [============>.................] - ETA: 0s - loss: 0.0368 - accuracy: 0.7133 7/11 [==================>...........] - ETA: 0s - loss: 0.0366 - accuracy: 0.7221 9/11 [=======================>......] - ETA: 0s - loss: 0.0363 - accuracy: 0.732011/11 [==============================] - ETA: 0s - loss: 0.0360 - accuracy: 0.742111/11 [==============================] - 0s 28ms/step - loss: 0.0359 - accuracy: 0.7460
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0308 - accuracy: 0.8516 3/11 [=======>......................] - ETA: 0s - loss: 0.0307 - accuracy: 0.8303 6/11 [===============>..............] - ETA: 0s - loss: 0.0313 - accuracy: 0.8218 9/11 [=======================>......] - ETA: 0s - loss: 0.0313 - accuracy: 0.817411/11 [==============================] - 0s 25ms/step - loss: 0.0314 - accuracy: 0.8165
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0281 - accuracy: 0.8438 4/11 [=========>....................] - ETA: 0s - loss: 0.0287 - accuracy: 0.8480 6/11 [===============>..............] - ETA: 0s - loss: 0.0289 - accuracy: 0.8447 8/11 [====================>.........] - ETA: 0s - loss: 0.0289 - accuracy: 0.841610/11 [==========================>...] - ETA: 0s - loss: 0.0290 - accuracy: 0.839811/11 [==============================] - 0s 27ms/step - loss: 0.0291 - accuracy: 0.8389
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0201 - accuracy: 0.9062 4/11 [=========>....................] - ETA: 0s - loss: 0.0240 - accuracy: 0.8730 6/11 [===============>..............] - ETA: 0s - loss: 0.0251 - accuracy: 0.8622 8/11 [====================>.........] - ETA: 0s - loss: 0.0257 - accuracy: 0.854710/11 [==========================>...] - ETA: 0s - loss: 0.0260 - accuracy: 0.849411/11 [==============================] - 0s 28ms/step - loss: 0.0263 - accuracy: 0.8460
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0249 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.0263 - accuracy: 0.8364 5/11 [============>.................] - ETA: 0s - loss: 0.0262 - accuracy: 0.8269 8/11 [====================>.........] - ETA: 0s - loss: 0.0260 - accuracy: 0.827410/11 [==========================>...] - ETA: 0s - loss: 0.0260 - accuracy: 0.830011/11 [==============================] - 0s 26ms/step - loss: 0.0259 - accuracy: 0.8325
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0405 - accuracy: 0.82035/6 [========================>.....] - ETA: 0s - loss: 0.0323 - accuracy: 0.8734 6/6 [==============================] - 5s 12ms/step - loss: 0.0325 - accuracy: 0.8725
2021-12-13 23:54:56.516105: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:54:56.516939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:54:56.517012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:54:56.517071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:54:56.517116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:54:56.517168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:54:56.517216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:54:56.517265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:54:56.517311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:54:56.517361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:54:56.518357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:54:56.518419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:54:56.518437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:54:56.518451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:54:56.519524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:54:56.520229: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:54:56.520765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:54:56.520807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:54:56.520846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:54:56.520885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:54:56.520922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:54:56.520974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:54:56.521017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:54:56.521057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:54:56.521096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:54:56.522073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:54:56.522116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:54:56.522132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:54:56.522146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:54:56.523174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [ 0.02571607  0.86720437  0.92468804  0.06360206 -0.00453418]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 4 3 0 1] pred: [-0.04329764 -0.13046268  0.6808669   0.06045635  0.17403369]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 0 4 1] pred: [-0.00231882 -0.03684878  0.96645576  0.03020589 -0.00585325]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [-0.01423349 -0.01175125  0.99196804 -0.05978334 -0.01814717]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [ 0.0013258   0.01794022  0.9907318  -0.06557635 -0.00705124]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 3 4 0] pred: [-0.03909118  0.9574956   0.80010426  0.02898832  0.00619915]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 4 3] pred: [ 0.0303993   0.97414196  0.53272796 -0.09891348  0.01215785]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [3 2 4 0 1] pred: [-0.01199587 -0.3319819   0.09234563  0.73234683  0.07884458]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 0 4 3 1] pred: [ 0.03515534 -0.00929543  0.9908535   0.00455161  0.01279198]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 3 0 4] pred: [-0.00792191  0.9545366   0.74516517  0.01726476 -0.01007503]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 4 3] pred: [-0.00172839  0.01315379  0.9872558  -0.02669417 -0.01132948]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 0 4 1] pred: [ 0.01847517 -0.09181248  0.9874662   0.03118797 -0.01336931]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 3 4 0] pred: [-0.07656143  0.9132285   0.66083467 -0.02937934 -0.03113191]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 3 0 4] pred: [-0.00295947  0.9479859   0.74278575 -0.00186174 -0.02199389]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [-0.00352937  0.04482524  0.99335235 -0.0086401  -0.04140971]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:34 - loss: 0.2467 - accuracy: 0.1406 3/11 [=======>......................] - ETA: 0s - loss: 0.2459 - accuracy: 0.2912   5/11 [============>.................] - ETA: 0s - loss: 0.2431 - accuracy: 0.3472 7/11 [==================>...........] - ETA: 0s - loss: 0.2403 - accuracy: 0.3744 9/11 [=======================>......] - ETA: 0s - loss: 0.2371 - accuracy: 0.388411/11 [==============================] - ETA: 0s - loss: 0.2339 - accuracy: 0.398411/11 [==============================] - 16s 28ms/step - loss: 0.2326 - accuracy: 0.4026
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1720 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.1674 - accuracy: 0.4588 7/11 [==================>...........] - ETA: 0s - loss: 0.1618 - accuracy: 0.4580 9/11 [=======================>......] - ETA: 0s - loss: 0.1586 - accuracy: 0.456711/11 [==============================] - ETA: 0s - loss: 0.1555 - accuracy: 0.457011/11 [==============================] - 0s 26ms/step - loss: 0.1542 - accuracy: 0.4573
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1109 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.1111 - accuracy: 0.4800 5/11 [============>.................] - ETA: 0s - loss: 0.1097 - accuracy: 0.4694 7/11 [==================>...........] - ETA: 0s - loss: 0.1087 - accuracy: 0.4672 9/11 [=======================>......] - ETA: 0s - loss: 0.1078 - accuracy: 0.463811/11 [==============================] - ETA: 0s - loss: 0.1070 - accuracy: 0.463511/11 [==============================] - 0s 28ms/step - loss: 0.1066 - accuracy: 0.4633
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0957 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.0927 - accuracy: 0.4492 6/11 [===============>..............] - ETA: 0s - loss: 0.0924 - accuracy: 0.4504 8/11 [====================>.........] - ETA: 0s - loss: 0.0917 - accuracy: 0.454210/11 [==========================>...] - ETA: 0s - loss: 0.0911 - accuracy: 0.456311/11 [==============================] - 0s 28ms/step - loss: 0.0906 - accuracy: 0.4574
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0849 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.0824 - accuracy: 0.4983 5/11 [============>.................] - ETA: 0s - loss: 0.0821 - accuracy: 0.4948 7/11 [==================>...........] - ETA: 0s - loss: 0.0826 - accuracy: 0.4892 9/11 [=======================>......] - ETA: 0s - loss: 0.0824 - accuracy: 0.485311/11 [==============================] - ETA: 0s - loss: 0.0819 - accuracy: 0.482311/11 [==============================] - 0s 28ms/step - loss: 0.0817 - accuracy: 0.4815
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0823 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.0777 - accuracy: 0.4618 6/11 [===============>..............] - ETA: 0s - loss: 0.0768 - accuracy: 0.4688 8/11 [====================>.........] - ETA: 0s - loss: 0.0761 - accuracy: 0.471611/11 [==============================] - ETA: 0s - loss: 0.0752 - accuracy: 0.474311/11 [==============================] - 0s 27ms/step - loss: 0.0749 - accuracy: 0.4749
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0746 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.0696 - accuracy: 0.4774 6/11 [===============>..............] - ETA: 0s - loss: 0.0682 - accuracy: 0.4847 8/11 [====================>.........] - ETA: 0s - loss: 0.0673 - accuracy: 0.488010/11 [==========================>...] - ETA: 0s - loss: 0.0670 - accuracy: 0.491611/11 [==============================] - 0s 27ms/step - loss: 0.0668 - accuracy: 0.4948
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0641 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.0647 - accuracy: 0.5378 5/11 [============>.................] - ETA: 0s - loss: 0.0631 - accuracy: 0.5407 7/11 [==================>...........] - ETA: 0s - loss: 0.0624 - accuracy: 0.5484 9/11 [=======================>......] - ETA: 0s - loss: 0.0618 - accuracy: 0.554111/11 [==============================] - ETA: 0s - loss: 0.0614 - accuracy: 0.558211/11 [==============================] - 0s 27ms/step - loss: 0.0612 - accuracy: 0.5597
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0562 - accuracy: 0.6328 4/11 [=========>....................] - ETA: 0s - loss: 0.0570 - accuracy: 0.6395 6/11 [===============>..............] - ETA: 0s - loss: 0.0561 - accuracy: 0.6439 8/11 [====================>.........] - ETA: 0s - loss: 0.0557 - accuracy: 0.646110/11 [==========================>...] - ETA: 0s - loss: 0.0555 - accuracy: 0.646511/11 [==============================] - 0s 26ms/step - loss: 0.0553 - accuracy: 0.6474
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0550 - accuracy: 0.7266 3/11 [=======>......................] - ETA: 0s - loss: 0.0528 - accuracy: 0.7305 5/11 [============>.................] - ETA: 0s - loss: 0.0523 - accuracy: 0.7330 8/11 [====================>.........] - ETA: 0s - loss: 0.0515 - accuracy: 0.733010/11 [==========================>...] - ETA: 0s - loss: 0.0512 - accuracy: 0.733011/11 [==============================] - 0s 26ms/step - loss: 0.0509 - accuracy: 0.7331
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0504 - accuracy: 0.7266 3/11 [=======>......................] - ETA: 0s - loss: 0.0484 - accuracy: 0.7218 5/11 [============>.................] - ETA: 0s - loss: 0.0476 - accuracy: 0.7226 7/11 [==================>...........] - ETA: 0s - loss: 0.0467 - accuracy: 0.7252 9/11 [=======================>......] - ETA: 0s - loss: 0.0462 - accuracy: 0.728811/11 [==============================] - ETA: 0s - loss: 0.0461 - accuracy: 0.731711/11 [==============================] - 0s 27ms/step - loss: 0.0461 - accuracy: 0.7331
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0442 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.0434 - accuracy: 0.7869 5/11 [============>.................] - ETA: 0s - loss: 0.0436 - accuracy: 0.7703 7/11 [==================>...........] - ETA: 0s - loss: 0.0434 - accuracy: 0.7625 9/11 [=======================>......] - ETA: 0s - loss: 0.0433 - accuracy: 0.759911/11 [==============================] - 0s 27ms/step - loss: 0.0430 - accuracy: 0.7611
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0434 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.0407 - accuracy: 0.8433 5/11 [============>.................] - ETA: 0s - loss: 0.0404 - accuracy: 0.8393 8/11 [====================>.........] - ETA: 0s - loss: 0.0405 - accuracy: 0.831810/11 [==========================>...] - ETA: 0s - loss: 0.0403 - accuracy: 0.832211/11 [==============================] - 0s 28ms/step - loss: 0.0402 - accuracy: 0.8327
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0359 - accuracy: 0.8281 4/11 [=========>....................] - ETA: 0s - loss: 0.0371 - accuracy: 0.8177 7/11 [==================>...........] - ETA: 0s - loss: 0.0368 - accuracy: 0.8244 9/11 [=======================>......] - ETA: 0s - loss: 0.0367 - accuracy: 0.826411/11 [==============================] - 0s 26ms/step - loss: 0.0369 - accuracy: 0.8284
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0395 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0391 - accuracy: 0.8859 5/11 [============>.................] - ETA: 0s - loss: 0.0389 - accuracy: 0.8876 7/11 [==================>...........] - ETA: 0s - loss: 0.0387 - accuracy: 0.879610/11 [==========================>...] - ETA: 0s - loss: 0.0381 - accuracy: 0.866011/11 [==============================] - 0s 25ms/step - loss: 0.0377 - accuracy: 0.8608
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0328 - accuracy: 0.8828 3/11 [=======>......................] - ETA: 0s - loss: 0.0333 - accuracy: 0.8772 6/11 [===============>..............] - ETA: 0s - loss: 0.0331 - accuracy: 0.8682 8/11 [====================>.........] - ETA: 0s - loss: 0.0332 - accuracy: 0.861211/11 [==============================] - ETA: 0s - loss: 0.0333 - accuracy: 0.856411/11 [==============================] - 0s 27ms/step - loss: 0.0334 - accuracy: 0.8559
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0300 - accuracy: 0.9062 4/11 [=========>....................] - ETA: 0s - loss: 0.0335 - accuracy: 0.9092 6/11 [===============>..............] - ETA: 0s - loss: 0.0336 - accuracy: 0.8935 8/11 [====================>.........] - ETA: 0s - loss: 0.0337 - accuracy: 0.876410/11 [==========================>...] - ETA: 0s - loss: 0.0337 - accuracy: 0.866811/11 [==============================] - 0s 26ms/step - loss: 0.0337 - accuracy: 0.8617
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0325 - accuracy: 0.9375 3/11 [=======>......................] - ETA: 0s - loss: 0.0311 - accuracy: 0.9314 5/11 [============>.................] - ETA: 0s - loss: 0.0312 - accuracy: 0.9217 7/11 [==================>...........] - ETA: 0s - loss: 0.0314 - accuracy: 0.9039 9/11 [=======================>......] - ETA: 0s - loss: 0.0315 - accuracy: 0.887911/11 [==============================] - 0s 26ms/step - loss: 0.0315 - accuracy: 0.8725
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0239 - accuracy: 0.9141 3/11 [=======>......................] - ETA: 0s - loss: 0.0254 - accuracy: 0.9280 5/11 [============>.................] - ETA: 0s - loss: 0.0266 - accuracy: 0.9261 7/11 [==================>...........] - ETA: 0s - loss: 0.0270 - accuracy: 0.9258 9/11 [=======================>......] - ETA: 0s - loss: 0.0274 - accuracy: 0.922411/11 [==============================] - 0s 27ms/step - loss: 0.0278 - accuracy: 0.9169
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0249 - accuracy: 0.8516 3/11 [=======>......................] - ETA: 0s - loss: 0.0259 - accuracy: 0.8594 6/11 [===============>..............] - ETA: 0s - loss: 0.0263 - accuracy: 0.8563 9/11 [=======================>......] - ETA: 0s - loss: 0.0265 - accuracy: 0.860411/11 [==============================] - ETA: 0s - loss: 0.0266 - accuracy: 0.864311/11 [==============================] - 0s 28ms/step - loss: 0.0266 - accuracy: 0.8659
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0250 - accuracy: 0.91416/6 [==============================] - ETA: 0s - loss: 0.0273 - accuracy: 0.9207 6/6 [==============================] - 5s 11ms/step - loss: 0.0273 - accuracy: 0.9207
2021-12-13 23:55:32.819819: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:55:32.820665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:55:32.820736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:55:32.820793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:55:32.820831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:55:32.820881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:55:32.820936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:55:32.820981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:55:32.821028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:55:32.821075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:55:32.822041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:55:32.822095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:55:32.822114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:55:32.822127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:55:32.823130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:55:32.823530: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:55:32.824036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:55:32.824074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:55:32.824110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:55:32.824145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:55:32.824180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:55:32.824218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:55:32.824254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:55:32.824292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:55:32.824331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:55:32.825233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:55:32.825272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:55:32.825288: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:55:32.825300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:55:32.826247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 3 1 4] pred: [ 0.00259925 -0.01022012  0.9801199  -0.00254578 -0.05743382]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 2 0 1] pred: [ 0.02161149 -0.07026442  0.09566253  0.8053162   0.12370521]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 3 4 0] pred: [-0.04750638  0.96626264  0.7333301   0.00613976  0.00401544]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [-0.01930694  0.8277076   0.8428771   0.01505098 -0.04219088]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 4 3] pred: [ 0.29963183  0.643927    0.58589643 -0.18780026  0.10170303]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 0 3] pred: [ 0.0054431   0.84086114  0.95348525 -0.04144111  0.03562369]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [-0.00829373  0.43301523  0.86481446  0.11563791 -0.00998261]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [4 3 0 1 2] pred: [-0.01966229 -0.05216404 -0.14417043  0.27638808  0.74007773]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 0 1] pred: [-0.02625759 -0.19095072  0.13659428  0.7800665   0.10724139]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 0 3 4 1] pred: [-0.00667255 -0.1604767   0.97182584 -0.03697842 -0.04903724]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 3 0 4] pred: [-0.05443994  0.95139027  0.3120737  -0.02112209 -0.06474708]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 4 3 1 0] pred: [-0.15818308  0.01417547  0.99481636  0.06526494  0.13160482]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [ 0.02390095  0.88154846  0.7609662  -0.02827169 -0.04055054]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 0 3 4 1] pred: [-0.00811713 -0.07907059  0.99133855 -0.01002713 -0.01317745]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 4 3 0] pred: [-0.04220536  0.94803196  0.78177345 -0.01577969 -0.00714872]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:26 - loss: 0.2482 - accuracy: 0.2969 3/11 [=======>......................] - ETA: 0s - loss: 0.2465 - accuracy: 0.3481   5/11 [============>.................] - ETA: 0s - loss: 0.2410 - accuracy: 0.3782 7/11 [==================>...........] - ETA: 0s - loss: 0.2361 - accuracy: 0.3960 9/11 [=======================>......] - ETA: 0s - loss: 0.2312 - accuracy: 0.407911/11 [==============================] - ETA: 0s - loss: 0.2267 - accuracy: 0.414811/11 [==============================] - 15s 27ms/step - loss: 0.2248 - accuracy: 0.4177
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1447 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.1408 - accuracy: 0.5095 5/11 [============>.................] - ETA: 0s - loss: 0.1380 - accuracy: 0.4995 7/11 [==================>...........] - ETA: 0s - loss: 0.1358 - accuracy: 0.4897 9/11 [=======================>......] - ETA: 0s - loss: 0.1340 - accuracy: 0.482511/11 [==============================] - ETA: 0s - loss: 0.1322 - accuracy: 0.479611/11 [==============================] - 0s 27ms/step - loss: 0.1315 - accuracy: 0.4786
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1100 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.1121 - accuracy: 0.4297 6/11 [===============>..............] - ETA: 0s - loss: 0.1106 - accuracy: 0.4420 8/11 [====================>.........] - ETA: 0s - loss: 0.1098 - accuracy: 0.447710/11 [==========================>...] - ETA: 0s - loss: 0.1090 - accuracy: 0.452611/11 [==============================] - 0s 27ms/step - loss: 0.1082 - accuracy: 0.4556
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0884 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.0917 - accuracy: 0.5056 5/11 [============>.................] - ETA: 0s - loss: 0.0931 - accuracy: 0.4998 7/11 [==================>...........] - ETA: 0s - loss: 0.0934 - accuracy: 0.4966 9/11 [=======================>......] - ETA: 0s - loss: 0.0935 - accuracy: 0.496411/11 [==============================] - ETA: 0s - loss: 0.0933 - accuracy: 0.496811/11 [==============================] - 0s 28ms/step - loss: 0.0933 - accuracy: 0.4969
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0810 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.0822 - accuracy: 0.5169 5/11 [============>.................] - ETA: 0s - loss: 0.0832 - accuracy: 0.5136 7/11 [==================>...........] - ETA: 0s - loss: 0.0838 - accuracy: 0.5130 9/11 [=======================>......] - ETA: 0s - loss: 0.0836 - accuracy: 0.514411/11 [==============================] - ETA: 0s - loss: 0.0834 - accuracy: 0.514911/11 [==============================] - 0s 28ms/step - loss: 0.0833 - accuracy: 0.5150
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0758 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.0763 - accuracy: 0.5230 5/11 [============>.................] - ETA: 0s - loss: 0.0755 - accuracy: 0.5311 7/11 [==================>...........] - ETA: 0s - loss: 0.0750 - accuracy: 0.5335 9/11 [=======================>......] - ETA: 0s - loss: 0.0745 - accuracy: 0.535911/11 [==============================] - ETA: 0s - loss: 0.0743 - accuracy: 0.535411/11 [==============================] - 0s 27ms/step - loss: 0.0742 - accuracy: 0.5352
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0793 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.0765 - accuracy: 0.5360 5/11 [============>.................] - ETA: 0s - loss: 0.0740 - accuracy: 0.5415 7/11 [==================>...........] - ETA: 0s - loss: 0.0725 - accuracy: 0.5445 9/11 [=======================>......] - ETA: 0s - loss: 0.0714 - accuracy: 0.546311/11 [==============================] - ETA: 0s - loss: 0.0705 - accuracy: 0.547611/11 [==============================] - 0s 27ms/step - loss: 0.0701 - accuracy: 0.5481
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0609 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.0626 - accuracy: 0.5490 5/11 [============>.................] - ETA: 0s - loss: 0.0622 - accuracy: 0.5554 7/11 [==================>...........] - ETA: 0s - loss: 0.0619 - accuracy: 0.5606 9/11 [=======================>......] - ETA: 0s - loss: 0.0618 - accuracy: 0.565111/11 [==============================] - 0s 28ms/step - loss: 0.0614 - accuracy: 0.5690
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0581 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.0558 - accuracy: 0.5734 5/11 [============>.................] - ETA: 0s - loss: 0.0552 - accuracy: 0.5811 7/11 [==================>...........] - ETA: 0s - loss: 0.0553 - accuracy: 0.5872 9/11 [=======================>......] - ETA: 0s - loss: 0.0553 - accuracy: 0.595311/11 [==============================] - 0s 27ms/step - loss: 0.0553 - accuracy: 0.6024
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0571 - accuracy: 0.6484 3/11 [=======>......................] - ETA: 0s - loss: 0.0559 - accuracy: 0.6350 5/11 [============>.................] - ETA: 0s - loss: 0.0548 - accuracy: 0.6482 7/11 [==================>...........] - ETA: 0s - loss: 0.0542 - accuracy: 0.6568 9/11 [=======================>......] - ETA: 0s - loss: 0.0538 - accuracy: 0.664011/11 [==============================] - 0s 27ms/step - loss: 0.0531 - accuracy: 0.6709
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0446 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.0449 - accuracy: 0.7509 5/11 [============>.................] - ETA: 0s - loss: 0.0461 - accuracy: 0.7482 7/11 [==================>...........] - ETA: 0s - loss: 0.0465 - accuracy: 0.7456 9/11 [=======================>......] - ETA: 0s - loss: 0.0466 - accuracy: 0.744111/11 [==============================] - ETA: 0s - loss: 0.0467 - accuracy: 0.742511/11 [==============================] - 0s 28ms/step - loss: 0.0467 - accuracy: 0.7420
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0461 - accuracy: 0.7656 3/11 [=======>......................] - ETA: 0s - loss: 0.0454 - accuracy: 0.7465 5/11 [============>.................] - ETA: 0s - loss: 0.0454 - accuracy: 0.7482 7/11 [==================>...........] - ETA: 0s - loss: 0.0451 - accuracy: 0.7497 9/11 [=======================>......] - ETA: 0s - loss: 0.0451 - accuracy: 0.753111/11 [==============================] - 0s 29ms/step - loss: 0.0449 - accuracy: 0.7573
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0391 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.0402 - accuracy: 0.7309 5/11 [============>.................] - ETA: 0s - loss: 0.0407 - accuracy: 0.7431 7/11 [==================>...........] - ETA: 0s - loss: 0.0408 - accuracy: 0.7552 9/11 [=======================>......] - ETA: 0s - loss: 0.0406 - accuracy: 0.764911/11 [==============================] - ETA: 0s - loss: 0.0407 - accuracy: 0.772411/11 [==============================] - 0s 27ms/step - loss: 0.0407 - accuracy: 0.7754
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0343 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.0355 - accuracy: 0.7921 5/11 [============>.................] - ETA: 0s - loss: 0.0361 - accuracy: 0.7869 7/11 [==================>...........] - ETA: 0s - loss: 0.0365 - accuracy: 0.7828 9/11 [=======================>......] - ETA: 0s - loss: 0.0369 - accuracy: 0.784111/11 [==============================] - ETA: 0s - loss: 0.0371 - accuracy: 0.787211/11 [==============================] - 0s 28ms/step - loss: 0.0372 - accuracy: 0.7886
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0327 - accuracy: 0.8984 3/11 [=======>......................] - ETA: 0s - loss: 0.0334 - accuracy: 0.8945 5/11 [============>.................] - ETA: 0s - loss: 0.0346 - accuracy: 0.8839 7/11 [==================>...........] - ETA: 0s - loss: 0.0350 - accuracy: 0.8765 9/11 [=======================>......] - ETA: 0s - loss: 0.0353 - accuracy: 0.873311/11 [==============================] - ETA: 0s - loss: 0.0355 - accuracy: 0.871911/11 [==============================] - 0s 28ms/step - loss: 0.0356 - accuracy: 0.8713
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0388 - accuracy: 0.8047 3/11 [=======>......................] - ETA: 0s - loss: 0.0371 - accuracy: 0.8073 5/11 [============>.................] - ETA: 0s - loss: 0.0360 - accuracy: 0.8195 7/11 [==================>...........] - ETA: 0s - loss: 0.0355 - accuracy: 0.8262 9/11 [=======================>......] - ETA: 0s - loss: 0.0353 - accuracy: 0.828911/11 [==============================] - ETA: 0s - loss: 0.0353 - accuracy: 0.829811/11 [==============================] - 0s 29ms/step - loss: 0.0353 - accuracy: 0.8300
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0364 - accuracy: 0.8047 3/11 [=======>......................] - ETA: 0s - loss: 0.0346 - accuracy: 0.8108 5/11 [============>.................] - ETA: 0s - loss: 0.0341 - accuracy: 0.8232 7/11 [==================>...........] - ETA: 0s - loss: 0.0336 - accuracy: 0.8316 9/11 [=======================>......] - ETA: 0s - loss: 0.0333 - accuracy: 0.836111/11 [==============================] - ETA: 0s - loss: 0.0333 - accuracy: 0.838411/11 [==============================] - 0s 29ms/step - loss: 0.0334 - accuracy: 0.8394
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0359 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.0346 - accuracy: 0.8780 5/11 [============>.................] - ETA: 0s - loss: 0.0343 - accuracy: 0.8698 7/11 [==================>...........] - ETA: 0s - loss: 0.0337 - accuracy: 0.8672 9/11 [=======================>......] - ETA: 0s - loss: 0.0332 - accuracy: 0.866311/11 [==============================] - 0s 27ms/step - loss: 0.0329 - accuracy: 0.8662
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0323 - accuracy: 0.9141 4/11 [=========>....................] - ETA: 0s - loss: 0.0308 - accuracy: 0.9045 6/11 [===============>..............] - ETA: 0s - loss: 0.0307 - accuracy: 0.9005 8/11 [====================>.........] - ETA: 0s - loss: 0.0307 - accuracy: 0.894410/11 [==========================>...] - ETA: 0s - loss: 0.0307 - accuracy: 0.889411/11 [==============================] - 0s 27ms/step - loss: 0.0307 - accuracy: 0.8865
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0320 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0303 - accuracy: 0.8598 5/11 [============>.................] - ETA: 0s - loss: 0.0298 - accuracy: 0.8584 7/11 [==================>...........] - ETA: 0s - loss: 0.0297 - accuracy: 0.8604 9/11 [=======================>......] - ETA: 0s - loss: 0.0296 - accuracy: 0.860511/11 [==============================] - 0s 26ms/step - loss: 0.0295 - accuracy: 0.8635
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0340 - accuracy: 0.93756/6 [==============================] - ETA: 0s - loss: 0.0321 - accuracy: 0.9207 6/6 [==============================] - 5s 11ms/step - loss: 0.0321 - accuracy: 0.9207
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 0 4 1] pred: [-0.02358448 -0.17142262  0.91487443  0.15932041 -0.07209447]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 4 0 3] pred: [-0.02614761  0.9670229   0.8035555  -0.04868331  0.0205473 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 0 3] pred: [-0.01917383  0.9000849   0.9148533  -0.06327014  0.06388205]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 3 0 4] pred: [ 0.00568398  0.9479378   0.6026551   0.0203088  -0.02825127]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 0 1 4] pred: [ 0.09170773 -0.06152906  0.9325897   0.16000395 -0.14796333]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 4 3] pred: [ 0.0470706   0.8414859   0.63422984 -0.0766247   0.00372353]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [0 1 3 4 2] pred: [ 0.7179294   0.29205075 -0.36379465  0.11284101 -0.12586991]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [-0.01537109  0.27430183  0.908045   -0.0023736  -0.00807444]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [0 1 3 2 4] pred: [ 0.60320216  0.2531579   0.05059872  0.10473894 -0.03481571]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [0.01039779 0.18585888 0.95004815 0.06289985 0.00380543]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 4 0 3] pred: [-0.0251534   0.96678007  0.81042665 -0.06057535  0.02045725]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 4 3 0] pred: [-0.03338572  0.937767    0.84628654 -0.0235325   0.06633216]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 4 0] pred: [-3.9289314e-03  3.1546738e-02  9.7386682e-01  5.4784544e-02
 -2.8660893e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [ 1.39015075e-02  1.48825973e-01  9.77784574e-01 -5.45181474e-03
  2.63635069e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 0 1 4 3] pred: [ 0.01876166  0.01616898  0.98012686 -0.01625363 -0.01512113]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Job end at lun déc 13 23:56:10 CET 2021
