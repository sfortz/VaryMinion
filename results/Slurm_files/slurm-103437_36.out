
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at lun déc 13 23:56:12 CET 2021
2021-12-13 23:56:13.720835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-13 23:56:19.101576: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:56:19.103180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-13 23:56:19.137142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:56:19.137192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:56:19.141209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:56:19.141262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:56:19.144212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:56:19.145077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:56:19.148423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:56:19.150901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:56:19.157194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:56:19.158504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:56:19.158553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:56:19.858421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:56:19.858485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:56:19.858502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:56:19.861066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:56:19.862575: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:56:19.863399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:56:19.863457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:56:19.863504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:56:19.863618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:56:19.863664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:56:19.863703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:56:19.863823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:56:19.863870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:56:19.863911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:56:19.865441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:56:19.865483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:56:19.865499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:56:19.865511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:56:19.867092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:56:21.719456: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:56:21.720793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:56:21.720848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:56:21.720942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:56:21.721005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:56:21.721095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:56:21.721138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:56:21.721216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:56:21.721259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:56:21.721297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:56:21.722414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:56:21.723314: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:56:21.723920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:56:21.723967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:56:21.723997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:56:21.724036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:56:21.724116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:56:21.724149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:56:21.724177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:56:21.724249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:56:21.724282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:56:21.725407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:56:21.725475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:56:21.725517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:56:21.725530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:56:21.726838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:56:21.727005: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-13 23:56:25.304167: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-13 23:56:25.305034: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 1994990000 Hz
2021-12-13 23:56:37.365951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:56:38.464782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
Number of possible configurations: 40
Begining exécution of the 36 th configuration: BPIC20.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, sigmoid as activation function and bin_ce as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 58)          3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                21360     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:38 - loss: 0.6922 - accuracy: 0.3906 3/11 [=======>......................] - ETA: 0s - loss: 0.6906 - accuracy: 0.3841   5/11 [============>.................] - ETA: 0s - loss: 0.6888 - accuracy: 0.4185 7/11 [==================>...........] - ETA: 0s - loss: 0.6869 - accuracy: 0.4506 9/11 [=======================>......] - ETA: 0s - loss: 0.6849 - accuracy: 0.471611/11 [==============================] - ETA: 0s - loss: 0.6830 - accuracy: 0.481911/11 [==============================] - 16s 28ms/step - loss: 0.6822 - accuracy: 0.4857
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6418 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.6406 - accuracy: 0.4592 6/11 [===============>..............] - ETA: 0s - loss: 0.6364 - accuracy: 0.4627 8/11 [====================>.........] - ETA: 0s - loss: 0.6328 - accuracy: 0.464510/11 [==========================>...] - ETA: 0s - loss: 0.6290 - accuracy: 0.462811/11 [==============================] - 0s 27ms/step - loss: 0.6255 - accuracy: 0.4616
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5427 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.5344 - accuracy: 0.4332 5/11 [============>.................] - ETA: 0s - loss: 0.5255 - accuracy: 0.4395 7/11 [==================>...........] - ETA: 0s - loss: 0.5161 - accuracy: 0.4435 9/11 [=======================>......] - ETA: 0s - loss: 0.5069 - accuracy: 0.446511/11 [==============================] - ETA: 0s - loss: 0.4982 - accuracy: 0.447611/11 [==============================] - 0s 27ms/step - loss: 0.4946 - accuracy: 0.4482
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3867 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.3699 - accuracy: 0.4601 5/11 [============>.................] - ETA: 0s - loss: 0.3651 - accuracy: 0.4621 7/11 [==================>...........] - ETA: 0s - loss: 0.3639 - accuracy: 0.4599 9/11 [=======================>......] - ETA: 0s - loss: 0.3619 - accuracy: 0.458011/11 [==============================] - ETA: 0s - loss: 0.3599 - accuracy: 0.457311/11 [==============================] - 0s 27ms/step - loss: 0.3591 - accuracy: 0.4571
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3407 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.3396 - accuracy: 0.4679 5/11 [============>.................] - ETA: 0s - loss: 0.3367 - accuracy: 0.4632 7/11 [==================>...........] - ETA: 0s - loss: 0.3361 - accuracy: 0.4559 9/11 [=======================>......] - ETA: 0s - loss: 0.3350 - accuracy: 0.452811/11 [==============================] - ETA: 0s - loss: 0.3331 - accuracy: 0.453211/11 [==============================] - 0s 27ms/step - loss: 0.3322 - accuracy: 0.4535
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2593 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.2802 - accuracy: 0.5174 5/11 [============>.................] - ETA: 0s - loss: 0.2860 - accuracy: 0.5011 7/11 [==================>...........] - ETA: 0s - loss: 0.2889 - accuracy: 0.4902 9/11 [=======================>......] - ETA: 0s - loss: 0.2901 - accuracy: 0.483311/11 [==============================] - ETA: 0s - loss: 0.2901 - accuracy: 0.480011/11 [==============================] - 0s 27ms/step - loss: 0.2900 - accuracy: 0.4789
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2847 - accuracy: 0.3984 4/11 [=========>....................] - ETA: 0s - loss: 0.2746 - accuracy: 0.4406 6/11 [===============>..............] - ETA: 0s - loss: 0.2708 - accuracy: 0.4554 8/11 [====================>.........] - ETA: 0s - loss: 0.2683 - accuracy: 0.463510/11 [==========================>...] - ETA: 0s - loss: 0.2659 - accuracy: 0.470911/11 [==============================] - 0s 27ms/step - loss: 0.2646 - accuracy: 0.4771
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2262 - accuracy: 0.5859 3/11 [=======>......................] - ETA: 0s - loss: 0.2239 - accuracy: 0.5942 5/11 [============>.................] - ETA: 0s - loss: 0.2260 - accuracy: 0.5787 7/11 [==================>...........] - ETA: 0s - loss: 0.2283 - accuracy: 0.5675 9/11 [=======================>......] - ETA: 0s - loss: 0.2289 - accuracy: 0.567511/11 [==============================] - ETA: 0s - loss: 0.2297 - accuracy: 0.569811/11 [==============================] - 0s 29ms/step - loss: 0.2300 - accuracy: 0.5708
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2485 - accuracy: 0.6484 3/11 [=======>......................] - ETA: 0s - loss: 0.2324 - accuracy: 0.6476 5/11 [============>.................] - ETA: 0s - loss: 0.2278 - accuracy: 0.6462 7/11 [==================>...........] - ETA: 0s - loss: 0.2263 - accuracy: 0.6473 9/11 [=======================>......] - ETA: 0s - loss: 0.2245 - accuracy: 0.652011/11 [==============================] - ETA: 0s - loss: 0.2227 - accuracy: 0.656711/11 [==============================] - 0s 29ms/step - loss: 0.2220 - accuracy: 0.6588
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1999 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.2008 - accuracy: 0.6988 5/11 [============>.................] - ETA: 0s - loss: 0.2006 - accuracy: 0.7000 7/11 [==================>...........] - ETA: 0s - loss: 0.2011 - accuracy: 0.6969 9/11 [=======================>......] - ETA: 0s - loss: 0.2011 - accuracy: 0.697211/11 [==============================] - ETA: 0s - loss: 0.2004 - accuracy: 0.700611/11 [==============================] - 0s 28ms/step - loss: 0.2000 - accuracy: 0.7021
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1807 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.1801 - accuracy: 0.7674 5/11 [============>.................] - ETA: 0s - loss: 0.1794 - accuracy: 0.7646 7/11 [==================>...........] - ETA: 0s - loss: 0.1804 - accuracy: 0.7629 9/11 [=======================>......] - ETA: 0s - loss: 0.1807 - accuracy: 0.763811/11 [==============================] - ETA: 0s - loss: 0.1805 - accuracy: 0.766411/11 [==============================] - 0s 28ms/step - loss: 0.1804 - accuracy: 0.7675
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1765 - accuracy: 0.7109 3/11 [=======>......................] - ETA: 0s - loss: 0.1814 - accuracy: 0.7318 5/11 [============>.................] - ETA: 0s - loss: 0.1786 - accuracy: 0.7416 7/11 [==================>...........] - ETA: 0s - loss: 0.1769 - accuracy: 0.7481 9/11 [=======================>......] - ETA: 0s - loss: 0.1753 - accuracy: 0.753011/11 [==============================] - 0s 28ms/step - loss: 0.1733 - accuracy: 0.7600
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1563 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.1558 - accuracy: 0.7973 5/11 [============>.................] - ETA: 0s - loss: 0.1559 - accuracy: 0.7971 7/11 [==================>...........] - ETA: 0s - loss: 0.1563 - accuracy: 0.790210/11 [==========================>...] - ETA: 0s - loss: 0.1564 - accuracy: 0.784811/11 [==============================] - 0s 27ms/step - loss: 0.1562 - accuracy: 0.7838
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1532 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.1513 - accuracy: 0.8333 5/11 [============>.................] - ETA: 0s - loss: 0.1512 - accuracy: 0.8462 8/11 [====================>.........] - ETA: 0s - loss: 0.1500 - accuracy: 0.839910/11 [==========================>...] - ETA: 0s - loss: 0.1496 - accuracy: 0.834411/11 [==============================] - 0s 27ms/step - loss: 0.1491 - accuracy: 0.8322
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1350 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 0s - loss: 0.1338 - accuracy: 0.8420 5/11 [============>.................] - ETA: 0s - loss: 0.1332 - accuracy: 0.8373 7/11 [==================>...........] - ETA: 0s - loss: 0.1343 - accuracy: 0.8296 9/11 [=======================>......] - ETA: 0s - loss: 0.1347 - accuracy: 0.826911/11 [==============================] - 0s 27ms/step - loss: 0.1356 - accuracy: 0.8274
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1374 - accuracy: 0.8906 3/11 [=======>......................] - ETA: 0s - loss: 0.1344 - accuracy: 0.9019 6/11 [===============>..............] - ETA: 0s - loss: 0.1310 - accuracy: 0.8869 8/11 [====================>.........] - ETA: 0s - loss: 0.1304 - accuracy: 0.876510/11 [==========================>...] - ETA: 0s - loss: 0.1300 - accuracy: 0.869511/11 [==============================] - 0s 27ms/step - loss: 0.1301 - accuracy: 0.8652
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1222 - accuracy: 0.8984 3/11 [=======>......................] - ETA: 0s - loss: 0.1213 - accuracy: 0.9171 5/11 [============>.................] - ETA: 0s - loss: 0.1219 - accuracy: 0.9167 7/11 [==================>...........] - ETA: 0s - loss: 0.1227 - accuracy: 0.9161 9/11 [=======================>......] - ETA: 0s - loss: 0.1233 - accuracy: 0.913711/11 [==============================] - ETA: 0s - loss: 0.1236 - accuracy: 0.908611/11 [==============================] - 0s 29ms/step - loss: 0.1237 - accuracy: 0.9063
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1367 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.1289 - accuracy: 0.7986 5/11 [============>.................] - ETA: 0s - loss: 0.1259 - accuracy: 0.8275 8/11 [====================>.........] - ETA: 0s - loss: 0.1256 - accuracy: 0.846910/11 [==========================>...] - ETA: 0s - loss: 0.1248 - accuracy: 0.855711/11 [==============================] - 0s 26ms/step - loss: 0.1241 - accuracy: 0.8610
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1188 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.1155 - accuracy: 0.7812 5/11 [============>.................] - ETA: 0s - loss: 0.1146 - accuracy: 0.8093 8/11 [====================>.........] - ETA: 0s - loss: 0.1153 - accuracy: 0.835110/11 [==========================>...] - ETA: 0s - loss: 0.1150 - accuracy: 0.847411/11 [==============================] - 0s 27ms/step - loss: 0.1145 - accuracy: 0.8566
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1171 - accuracy: 0.9062 3/11 [=======>......................] - ETA: 0s - loss: 0.1155 - accuracy: 0.9019 6/11 [===============>..............] - ETA: 0s - loss: 0.1140 - accuracy: 0.9035 9/11 [=======================>......] - ETA: 0s - loss: 0.1126 - accuracy: 0.904311/11 [==============================] - ETA: 0s - loss: 0.1116 - accuracy: 0.906111/11 [==============================] - 0s 26ms/step - loss: 0.1111 - accuracy: 0.9069
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.1046 - accuracy: 0.95316/6 [==============================] - ETA: 0s - loss: 0.1016 - accuracy: 0.9263 6/6 [==============================] - 5s 10ms/step - loss: 0.1016 - accuracy: 0.9263
2021-12-13 23:56:57.561883: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:56:57.562604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:56:57.562661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:56:57.562748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:56:57.562789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:56:57.562821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:56:57.562899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:56:57.562943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:56:57.562976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:56:57.563046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:56:57.563770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:56:57.563822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:56:57.563835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:56:57.563844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:56:57.564658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:56:57.565010: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:56:57.565407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:56:57.565435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:56:57.565462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:56:57.565489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:56:57.565567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:56:57.565598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:56:57.565625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:56:57.565691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:56:57.565747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:56:57.566456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:56:57.566485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:56:57.566531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:56:57.566546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:56:57.567294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [9.2998594e-03 9.4771379e-01 7.9352492e-01 2.0570192e-03 1.6289428e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [2.1739646e-03 8.8733631e-01 9.1498649e-01 1.4299789e-03 1.1933712e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 4 0] pred: [4.4440958e-04 2.9504979e-03 9.4203871e-01 2.5109449e-02 1.1410797e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [4 3 0 2 1] pred: [0.07960004 0.01508909 0.03529608 0.59614515 0.7210133 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [8.3806552e-03 8.7539518e-01 7.9497510e-01 3.6490522e-03 2.4560074e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [4.1198632e-04 4.7843259e-02 9.9087113e-01 7.4796220e-03 2.0959591e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 2 0 1] pred: [0.0196364  0.00226041 0.07253659 0.79935354 0.11699415]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [7.1202354e-03 9.5526481e-01 7.6598829e-01 1.6515896e-03 1.5943508e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 1 4 0] pred: [3.4991297e-04 3.0784253e-03 9.5661622e-01 2.2730306e-02 1.0080007e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [5.7754442e-03 9.4095457e-01 8.1207740e-01 1.5308718e-03 1.0357176e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [5.0044537e-04 2.3515945e-02 9.8063219e-01 4.8041460e-03 3.1099541e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [8.7949226e-04 4.6641216e-02 9.6788937e-01 3.8219320e-03 3.5260629e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [8.2602734e-03 9.7662008e-01 7.8350025e-01 1.6231217e-03 1.7906894e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [0 1 3 4 2] pred: [0.6936674  0.3899804  0.09402171 0.21065271 0.17310658]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [5.0371134e-04 6.0883537e-02 9.8229998e-01 2.5280842e-03 2.7564049e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:46 - loss: 0.6943 - accuracy: 0.1719 3/11 [=======>......................] - ETA: 0s - loss: 0.6922 - accuracy: 0.2153   5/11 [============>.................] - ETA: 0s - loss: 0.6902 - accuracy: 0.2595 7/11 [==================>...........] - ETA: 0s - loss: 0.6880 - accuracy: 0.2899 9/11 [=======================>......] - ETA: 0s - loss: 0.6858 - accuracy: 0.315411/11 [==============================] - 17s 27ms/step - loss: 0.6826 - accuracy: 0.3410
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6403 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.6363 - accuracy: 0.4601 5/11 [============>.................] - ETA: 0s - loss: 0.6327 - accuracy: 0.4663 7/11 [==================>...........] - ETA: 0s - loss: 0.6288 - accuracy: 0.4673 9/11 [=======================>......] - ETA: 0s - loss: 0.6243 - accuracy: 0.466711/11 [==============================] - ETA: 0s - loss: 0.6197 - accuracy: 0.465511/11 [==============================] - 0s 27ms/step - loss: 0.6178 - accuracy: 0.4648
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5109 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.5074 - accuracy: 0.5061 5/11 [============>.................] - ETA: 0s - loss: 0.5002 - accuracy: 0.4891 7/11 [==================>...........] - ETA: 0s - loss: 0.4913 - accuracy: 0.4815 9/11 [=======================>......] - ETA: 0s - loss: 0.4824 - accuracy: 0.475411/11 [==============================] - ETA: 0s - loss: 0.4739 - accuracy: 0.472211/11 [==============================] - 0s 27ms/step - loss: 0.4705 - accuracy: 0.4710
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3642 - accuracy: 0.4141 4/11 [=========>....................] - ETA: 0s - loss: 0.3651 - accuracy: 0.4235 6/11 [===============>..............] - ETA: 0s - loss: 0.3631 - accuracy: 0.4305 8/11 [====================>.........] - ETA: 0s - loss: 0.3597 - accuracy: 0.437711/11 [==============================] - ETA: 0s - loss: 0.3569 - accuracy: 0.444311/11 [==============================] - 0s 27ms/step - loss: 0.3563 - accuracy: 0.4455
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3333 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.3311 - accuracy: 0.4484 5/11 [============>.................] - ETA: 0s - loss: 0.3321 - accuracy: 0.4486 7/11 [==================>...........] - ETA: 0s - loss: 0.3306 - accuracy: 0.4522 9/11 [=======================>......] - ETA: 0s - loss: 0.3296 - accuracy: 0.454711/11 [==============================] - ETA: 0s - loss: 0.3290 - accuracy: 0.455411/11 [==============================] - 0s 28ms/step - loss: 0.3287 - accuracy: 0.4556
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2999 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.3078 - accuracy: 0.4388 5/11 [============>.................] - ETA: 0s - loss: 0.3119 - accuracy: 0.4420 8/11 [====================>.........] - ETA: 0s - loss: 0.3098 - accuracy: 0.445510/11 [==========================>...] - ETA: 0s - loss: 0.3078 - accuracy: 0.447311/11 [==============================] - 0s 26ms/step - loss: 0.3055 - accuracy: 0.4492
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2777 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.2779 - accuracy: 0.5048 5/11 [============>.................] - ETA: 0s - loss: 0.2770 - accuracy: 0.4956 7/11 [==================>...........] - ETA: 0s - loss: 0.2752 - accuracy: 0.4872 9/11 [=======================>......] - ETA: 0s - loss: 0.2735 - accuracy: 0.481511/11 [==============================] - ETA: 0s - loss: 0.2722 - accuracy: 0.478011/11 [==============================] - 0s 27ms/step - loss: 0.2717 - accuracy: 0.4769
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2737 - accuracy: 0.3906 3/11 [=======>......................] - ETA: 0s - loss: 0.2631 - accuracy: 0.4306 5/11 [============>.................] - ETA: 0s - loss: 0.2588 - accuracy: 0.4354 7/11 [==================>...........] - ETA: 0s - loss: 0.2572 - accuracy: 0.4382 9/11 [=======================>......] - ETA: 0s - loss: 0.2561 - accuracy: 0.442811/11 [==============================] - 0s 27ms/step - loss: 0.2540 - accuracy: 0.4499
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2186 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.2324 - accuracy: 0.4579 5/11 [============>.................] - ETA: 0s - loss: 0.2361 - accuracy: 0.4718 7/11 [==================>...........] - ETA: 0s - loss: 0.2356 - accuracy: 0.4814 9/11 [=======================>......] - ETA: 0s - loss: 0.2349 - accuracy: 0.493211/11 [==============================] - 0s 27ms/step - loss: 0.2336 - accuracy: 0.5053
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2390 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.2308 - accuracy: 0.5396 6/11 [===============>..............] - ETA: 0s - loss: 0.2288 - accuracy: 0.5510 8/11 [====================>.........] - ETA: 0s - loss: 0.2268 - accuracy: 0.558311/11 [==============================] - ETA: 0s - loss: 0.2234 - accuracy: 0.572911/11 [==============================] - 0s 26ms/step - loss: 0.2224 - accuracy: 0.5769
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2123 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.2090 - accuracy: 0.6237 6/11 [===============>..............] - ETA: 0s - loss: 0.2081 - accuracy: 0.6300 8/11 [====================>.........] - ETA: 0s - loss: 0.2067 - accuracy: 0.631010/11 [==========================>...] - ETA: 0s - loss: 0.2047 - accuracy: 0.633211/11 [==============================] - 0s 26ms/step - loss: 0.2030 - accuracy: 0.6353
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2074 - accuracy: 0.7500 3/11 [=======>......................] - ETA: 0s - loss: 0.2022 - accuracy: 0.7270 5/11 [============>.................] - ETA: 0s - loss: 0.1974 - accuracy: 0.7204 7/11 [==================>...........] - ETA: 0s - loss: 0.1936 - accuracy: 0.715510/11 [==========================>...] - ETA: 0s - loss: 0.1899 - accuracy: 0.712911/11 [==============================] - 0s 28ms/step - loss: 0.1884 - accuracy: 0.7149
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1867 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.1885 - accuracy: 0.7856 5/11 [============>.................] - ETA: 0s - loss: 0.1879 - accuracy: 0.7746 7/11 [==================>...........] - ETA: 0s - loss: 0.1866 - accuracy: 0.7665 9/11 [=======================>......] - ETA: 0s - loss: 0.1836 - accuracy: 0.765311/11 [==============================] - 0s 27ms/step - loss: 0.1804 - accuracy: 0.7672
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1667 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.1624 - accuracy: 0.7964 5/11 [============>.................] - ETA: 0s - loss: 0.1628 - accuracy: 0.7766 8/11 [====================>.........] - ETA: 0s - loss: 0.1627 - accuracy: 0.775610/11 [==========================>...] - ETA: 0s - loss: 0.1625 - accuracy: 0.778911/11 [==============================] - 0s 28ms/step - loss: 0.1624 - accuracy: 0.7818
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1477 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.1519 - accuracy: 0.8051 5/11 [============>.................] - ETA: 0s - loss: 0.1534 - accuracy: 0.8074 7/11 [==================>...........] - ETA: 0s - loss: 0.1528 - accuracy: 0.8099 9/11 [=======================>......] - ETA: 0s - loss: 0.1522 - accuracy: 0.813711/11 [==============================] - 0s 28ms/step - loss: 0.1523 - accuracy: 0.8165
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1346 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.1346 - accuracy: 0.8668 5/11 [============>.................] - ETA: 0s - loss: 0.1371 - accuracy: 0.8620 7/11 [==================>...........] - ETA: 0s - loss: 0.1387 - accuracy: 0.860810/11 [==========================>...] - ETA: 0s - loss: 0.1410 - accuracy: 0.856811/11 [==============================] - 0s 28ms/step - loss: 0.1419 - accuracy: 0.8552
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1507 - accuracy: 0.8438 4/11 [=========>....................] - ETA: 0s - loss: 0.1435 - accuracy: 0.8356 6/11 [===============>..............] - ETA: 0s - loss: 0.1442 - accuracy: 0.8334 8/11 [====================>.........] - ETA: 0s - loss: 0.1436 - accuracy: 0.835210/11 [==========================>...] - ETA: 0s - loss: 0.1431 - accuracy: 0.836311/11 [==============================] - 0s 28ms/step - loss: 0.1426 - accuracy: 0.8374
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1164 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.1263 - accuracy: 0.8025 5/11 [============>.................] - ETA: 0s - loss: 0.1309 - accuracy: 0.8010 7/11 [==================>...........] - ETA: 0s - loss: 0.1333 - accuracy: 0.8057 9/11 [=======================>......] - ETA: 0s - loss: 0.1349 - accuracy: 0.811811/11 [==============================] - ETA: 0s - loss: 0.1355 - accuracy: 0.817511/11 [==============================] - 0s 28ms/step - loss: 0.1357 - accuracy: 0.8198
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1319 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.1314 - accuracy: 0.8338 5/11 [============>.................] - ETA: 0s - loss: 0.1307 - accuracy: 0.8370 7/11 [==================>...........] - ETA: 0s - loss: 0.1297 - accuracy: 0.8415 9/11 [=======================>......] - ETA: 0s - loss: 0.1299 - accuracy: 0.843611/11 [==============================] - ETA: 0s - loss: 0.1296 - accuracy: 0.845511/11 [==============================] - 0s 29ms/step - loss: 0.1296 - accuracy: 0.8462
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1257 - accuracy: 0.8906 3/11 [=======>......................] - ETA: 0s - loss: 0.1221 - accuracy: 0.9041 6/11 [===============>..............] - ETA: 0s - loss: 0.1233 - accuracy: 0.8954 8/11 [====================>.........] - ETA: 0s - loss: 0.1234 - accuracy: 0.892910/11 [==========================>...] - ETA: 0s - loss: 0.1232 - accuracy: 0.890711/11 [==============================] - 0s 27ms/step - loss: 0.1229 - accuracy: 0.8890
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.1416 - accuracy: 0.85165/6 [========================>.....] - ETA: 0s - loss: 0.1323 - accuracy: 0.8391 6/6 [==============================] - 5s 12ms/step - loss: 0.1322 - accuracy: 0.8442
2021-12-13 23:57:35.314493: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:57:35.315402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:57:35.315461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:57:35.315518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:57:35.315556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:57:35.315588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:57:35.315626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:57:35.315668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:57:35.315710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:57:35.315764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:57:35.316463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:57:35.316507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:57:35.316520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:57:35.316529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:57:35.317282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:57:35.318100: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:57:35.318469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:57:35.318497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:57:35.318522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:57:35.318549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:57:35.318575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:57:35.318612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:57:35.318639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:57:35.318676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:57:35.318702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:57:35.319376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:57:35.319405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:57:35.319417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:57:35.319426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:57:35.320159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [1.0972931e-02 9.3778694e-01 8.4968597e-01 1.6276251e-03 4.7941651e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [4.4050585e-03 9.1559660e-01 8.9406753e-01 1.5560196e-03 3.1648515e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 2 0 1] pred: [0.01174032 0.01157251 0.06895179 0.7981407  0.14677763]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [1.0337144e-02 9.0415013e-01 7.1024227e-01 3.0021528e-03 4.8795243e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [6.4663170e-03 5.9704459e-01 7.7495718e-01 9.5571913e-03 6.5815053e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [1.9494636e-04 2.1073192e-02 9.8434597e-01 2.0908487e-03 7.7840814e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [1.7453251e-04 1.3283102e-02 9.8014396e-01 2.6808237e-03 6.8556496e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [1.1236726e-03 2.2858018e-01 8.9091927e-01 6.3109491e-03 1.8845985e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 1 0] pred: [0.00746251 0.0098106  0.10393302 0.72818965 0.08582139]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 0 4] pred: [4.4730926e-04 2.4048826e-03 9.1315836e-01 3.4513585e-02 3.8974619e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [1.0369669e-02 9.6197659e-01 8.1083721e-01 2.2868044e-03 5.4014334e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [0.06065225 0.4757135  0.31280968 0.03198502 0.00285509]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [1.8286251e-04 2.0414500e-02 9.8721629e-01 1.8842968e-03 7.1173308e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [2.4695724e-04 6.2076370e-03 9.6945256e-01 5.3815860e-03 7.8113044e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 2 1 0] pred: [0.00920963 0.0109783  0.07015872 0.7819901  0.12351006]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:33 - loss: 0.6916 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.6897 - accuracy: 0.4418   5/11 [============>.................] - ETA: 0s - loss: 0.6878 - accuracy: 0.4442 7/11 [==================>...........] - ETA: 0s - loss: 0.6857 - accuracy: 0.4444 9/11 [=======================>......] - ETA: 0s - loss: 0.6836 - accuracy: 0.444511/11 [==============================] - ETA: 0s - loss: 0.6814 - accuracy: 0.443711/11 [==============================] - 16s 28ms/step - loss: 0.6805 - accuracy: 0.4433
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6374 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.6327 - accuracy: 0.4206 5/11 [============>.................] - ETA: 0s - loss: 0.6289 - accuracy: 0.4219 7/11 [==================>...........] - ETA: 0s - loss: 0.6246 - accuracy: 0.4276 9/11 [=======================>......] - ETA: 0s - loss: 0.6198 - accuracy: 0.430411/11 [==============================] - 0s 29ms/step - loss: 0.6125 - accuracy: 0.4328
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5290 - accuracy: 0.3594 3/11 [=======>......................] - ETA: 0s - loss: 0.5029 - accuracy: 0.3945 5/11 [============>.................] - ETA: 0s - loss: 0.4907 - accuracy: 0.4026 7/11 [==================>...........] - ETA: 0s - loss: 0.4800 - accuracy: 0.4080 9/11 [=======================>......] - ETA: 0s - loss: 0.4696 - accuracy: 0.414511/11 [==============================] - ETA: 0s - loss: 0.4609 - accuracy: 0.419211/11 [==============================] - 0s 28ms/step - loss: 0.4576 - accuracy: 0.4210
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3814 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.3752 - accuracy: 0.4288 5/11 [============>.................] - ETA: 0s - loss: 0.3791 - accuracy: 0.4209 7/11 [==================>...........] - ETA: 0s - loss: 0.3778 - accuracy: 0.4230 9/11 [=======================>......] - ETA: 0s - loss: 0.3759 - accuracy: 0.426111/11 [==============================] - 0s 28ms/step - loss: 0.3734 - accuracy: 0.4294
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3424 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.3294 - accuracy: 0.4427 5/11 [============>.................] - ETA: 0s - loss: 0.3292 - accuracy: 0.4488 7/11 [==================>...........] - ETA: 0s - loss: 0.3292 - accuracy: 0.4497 9/11 [=======================>......] - ETA: 0s - loss: 0.3296 - accuracy: 0.449611/11 [==============================] - 0s 28ms/step - loss: 0.3300 - accuracy: 0.4472
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3289 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.3218 - accuracy: 0.4449 6/11 [===============>..............] - ETA: 0s - loss: 0.3204 - accuracy: 0.4416 8/11 [====================>.........] - ETA: 0s - loss: 0.3189 - accuracy: 0.440110/11 [==========================>...] - ETA: 0s - loss: 0.3172 - accuracy: 0.439711/11 [==============================] - 0s 28ms/step - loss: 0.3155 - accuracy: 0.4401
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3265 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.3061 - accuracy: 0.4306 5/11 [============>.................] - ETA: 0s - loss: 0.3000 - accuracy: 0.4314 7/11 [==================>...........] - ETA: 0s - loss: 0.2955 - accuracy: 0.4330 9/11 [=======================>......] - ETA: 0s - loss: 0.2919 - accuracy: 0.435711/11 [==============================] - ETA: 0s - loss: 0.2894 - accuracy: 0.437711/11 [==============================] - 0s 28ms/step - loss: 0.2885 - accuracy: 0.4384
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2786 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.2765 - accuracy: 0.4382 6/11 [===============>..............] - ETA: 0s - loss: 0.2753 - accuracy: 0.4384 8/11 [====================>.........] - ETA: 0s - loss: 0.2723 - accuracy: 0.439710/11 [==========================>...] - ETA: 0s - loss: 0.2690 - accuracy: 0.443111/11 [==============================] - 0s 28ms/step - loss: 0.2662 - accuracy: 0.4465
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2620 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.2416 - accuracy: 0.5017 5/11 [============>.................] - ETA: 0s - loss: 0.2398 - accuracy: 0.5016 7/11 [==================>...........] - ETA: 0s - loss: 0.2378 - accuracy: 0.4984 9/11 [=======================>......] - ETA: 0s - loss: 0.2361 - accuracy: 0.498811/11 [==============================] - 0s 29ms/step - loss: 0.2337 - accuracy: 0.5000
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2162 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.2137 - accuracy: 0.5326 5/11 [============>.................] - ETA: 0s - loss: 0.2131 - accuracy: 0.5479 7/11 [==================>...........] - ETA: 0s - loss: 0.2103 - accuracy: 0.5550 9/11 [=======================>......] - ETA: 0s - loss: 0.2088 - accuracy: 0.557411/11 [==============================] - ETA: 0s - loss: 0.2074 - accuracy: 0.560211/11 [==============================] - 0s 29ms/step - loss: 0.2069 - accuracy: 0.5614
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1770 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.1736 - accuracy: 0.6797 5/11 [============>.................] - ETA: 0s - loss: 0.1756 - accuracy: 0.6749 7/11 [==================>...........] - ETA: 0s - loss: 0.1777 - accuracy: 0.6715 9/11 [=======================>......] - ETA: 0s - loss: 0.1797 - accuracy: 0.667411/11 [==============================] - ETA: 0s - loss: 0.1805 - accuracy: 0.664311/11 [==============================] - 0s 28ms/step - loss: 0.1808 - accuracy: 0.6627
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1611 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.1675 - accuracy: 0.6302 5/11 [============>.................] - ETA: 0s - loss: 0.1716 - accuracy: 0.6530 7/11 [==================>...........] - ETA: 0s - loss: 0.1728 - accuracy: 0.670410/11 [==========================>...] - ETA: 0s - loss: 0.1727 - accuracy: 0.684311/11 [==============================] - 0s 28ms/step - loss: 0.1724 - accuracy: 0.6878
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1678 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.1705 - accuracy: 0.7066 5/11 [============>.................] - ETA: 0s - loss: 0.1698 - accuracy: 0.7052 7/11 [==================>...........] - ETA: 0s - loss: 0.1676 - accuracy: 0.7020 9/11 [=======================>......] - ETA: 0s - loss: 0.1665 - accuracy: 0.701111/11 [==============================] - ETA: 0s - loss: 0.1655 - accuracy: 0.701611/11 [==============================] - 0s 29ms/step - loss: 0.1650 - accuracy: 0.7019
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1574 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.1594 - accuracy: 0.7153 5/11 [============>.................] - ETA: 0s - loss: 0.1576 - accuracy: 0.7282 7/11 [==================>...........] - ETA: 0s - loss: 0.1569 - accuracy: 0.7241 9/11 [=======================>......] - ETA: 0s - loss: 0.1566 - accuracy: 0.723411/11 [==============================] - ETA: 0s - loss: 0.1562 - accuracy: 0.728211/11 [==============================] - 0s 30ms/step - loss: 0.1559 - accuracy: 0.7303
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1477 - accuracy: 0.8047 3/11 [=======>......................] - ETA: 0s - loss: 0.1454 - accuracy: 0.8090 5/11 [============>.................] - ETA: 0s - loss: 0.1459 - accuracy: 0.7957 7/11 [==================>...........] - ETA: 0s - loss: 0.1456 - accuracy: 0.7893 9/11 [=======================>......] - ETA: 0s - loss: 0.1456 - accuracy: 0.786911/11 [==============================] - ETA: 0s - loss: 0.1457 - accuracy: 0.785011/11 [==============================] - 0s 29ms/step - loss: 0.1457 - accuracy: 0.7843
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1410 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.1439 - accuracy: 0.8103 5/11 [============>.................] - ETA: 0s - loss: 0.1440 - accuracy: 0.8122 7/11 [==================>...........] - ETA: 0s - loss: 0.1438 - accuracy: 0.8147 9/11 [=======================>......] - ETA: 0s - loss: 0.1427 - accuracy: 0.819011/11 [==============================] - 0s 28ms/step - loss: 0.1413 - accuracy: 0.8222
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1335 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.1314 - accuracy: 0.8016 5/11 [============>.................] - ETA: 0s - loss: 0.1299 - accuracy: 0.8108 7/11 [==================>...........] - ETA: 0s - loss: 0.1304 - accuracy: 0.817110/11 [==========================>...] - ETA: 0s - loss: 0.1314 - accuracy: 0.821311/11 [==============================] - 0s 29ms/step - loss: 0.1316 - accuracy: 0.8234
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1332 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.1361 - accuracy: 0.7713 5/11 [============>.................] - ETA: 0s - loss: 0.1328 - accuracy: 0.7927 7/11 [==================>...........] - ETA: 0s - loss: 0.1311 - accuracy: 0.8062 9/11 [=======================>......] - ETA: 0s - loss: 0.1299 - accuracy: 0.815011/11 [==============================] - ETA: 0s - loss: 0.1291 - accuracy: 0.819311/11 [==============================] - 0s 29ms/step - loss: 0.1289 - accuracy: 0.8207
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1447 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 0s - loss: 0.1332 - accuracy: 0.8524 5/11 [============>.................] - ETA: 0s - loss: 0.1279 - accuracy: 0.8625 7/11 [==================>...........] - ETA: 0s - loss: 0.1248 - accuracy: 0.8679 9/11 [=======================>......] - ETA: 0s - loss: 0.1234 - accuracy: 0.870311/11 [==============================] - ETA: 0s - loss: 0.1224 - accuracy: 0.869611/11 [==============================] - 0s 28ms/step - loss: 0.1220 - accuracy: 0.8692
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1022 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.1172 - accuracy: 0.8012 5/11 [============>.................] - ETA: 0s - loss: 0.1160 - accuracy: 0.8169 7/11 [==================>...........] - ETA: 0s - loss: 0.1141 - accuracy: 0.8297 9/11 [=======================>......] - ETA: 0s - loss: 0.1137 - accuracy: 0.839611/11 [==============================] - ETA: 0s - loss: 0.1139 - accuracy: 0.847211/11 [==============================] - 0s 28ms/step - loss: 0.1139 - accuracy: 0.8502
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1061 - accuracy: 0.90626/6 [==============================] - ETA: 0s - loss: 0.1117 - accuracy: 0.8980 6/6 [==============================] - 5s 11ms/step - loss: 0.1117 - accuracy: 0.8980
2021-12-13 23:58:13.173041: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:58:13.173864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:58:13.173946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:58:13.174009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:58:13.174062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:58:13.174111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:58:13.174155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:58:13.174203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:58:13.174250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:58:13.174294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:58:13.175221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:58:13.175275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:58:13.175292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:58:13.175305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:58:13.176284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:58:13.176677: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:58:13.177209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:58:13.177249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:58:13.177286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:58:13.177324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:58:13.177362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:58:13.177398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:58:13.177441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:58:13.177483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:58:13.177523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:58:13.178465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:58:13.178505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:58:13.178521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:58:13.178534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:58:13.179530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [3.0716593e-04 1.3440813e-02 9.8296553e-01 1.1436816e-03 6.3216488e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 0 2 1] pred: [0.04235324 0.00828709 0.02968858 0.8480802  0.04327844]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 4 0] pred: [0.00213501 0.00596903 0.8890575  0.02798432 0.00235849]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [5.9469359e-04 3.1569681e-01 9.8176301e-01 2.1382652e-03 6.3808239e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [1.8337623e-03 8.9105570e-01 9.1261137e-01 3.5826901e-03 5.8879564e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [4 3 2 0 1] pred: [0.08290109 0.0087606  0.11275092 0.5767721  0.5781901 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [4.2430579e-04 1.0799763e-02 9.7664624e-01 1.6719509e-03 7.5569178e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [0.00518566 0.97227794 0.87615997 0.00429857 0.00112017]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [0.00701165 0.9617857  0.86870867 0.00357465 0.00173288]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [2.5990131e-04 1.6823558e-02 9.8329133e-01 1.4352000e-03 5.1816669e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [3.8378011e-04 1.1165753e-02 9.7959155e-01 1.5732126e-03 7.1524538e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [3.4189245e-04 2.3511630e-02 9.7925776e-01 1.7281413e-03 6.0720398e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [3.3747230e-04 1.2693267e-02 9.8195708e-01 1.2311343e-03 6.5650797e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [2.6884966e-04 1.5009629e-02 9.8445767e-01 1.0988095e-03 5.7554600e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [5.4541207e-04 6.6282721e-03 9.7169691e-01 5.4004649e-03 8.5351319e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:42 - loss: 0.6921 - accuracy: 0.1172 3/11 [=======>......................] - ETA: 0s - loss: 0.6904 - accuracy: 0.2196   6/11 [===============>..............] - ETA: 0s - loss: 0.6872 - accuracy: 0.2963 8/11 [====================>.........] - ETA: 0s - loss: 0.6850 - accuracy: 0.323610/11 [==========================>...] - ETA: 0s - loss: 0.6828 - accuracy: 0.342311/11 [==============================] - 17s 27ms/step - loss: 0.6807 - accuracy: 0.3566
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6394 - accuracy: 0.3438 4/11 [=========>....................] - ETA: 0s - loss: 0.6327 - accuracy: 0.3971 6/11 [===============>..............] - ETA: 0s - loss: 0.6283 - accuracy: 0.4091 8/11 [====================>.........] - ETA: 0s - loss: 0.6232 - accuracy: 0.418110/11 [==========================>...] - ETA: 0s - loss: 0.6176 - accuracy: 0.425111/11 [==============================] - 0s 28ms/step - loss: 0.6125 - accuracy: 0.4299
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4870 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.4814 - accuracy: 0.4753 5/11 [============>.................] - ETA: 0s - loss: 0.4738 - accuracy: 0.4745 7/11 [==================>...........] - ETA: 0s - loss: 0.4653 - accuracy: 0.473510/11 [==========================>...] - ETA: 0s - loss: 0.4537 - accuracy: 0.468811/11 [==============================] - 0s 27ms/step - loss: 0.4480 - accuracy: 0.4663
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4321 - accuracy: 0.3594 3/11 [=======>......................] - ETA: 0s - loss: 0.4099 - accuracy: 0.3789 5/11 [============>.................] - ETA: 0s - loss: 0.3964 - accuracy: 0.3962 7/11 [==================>...........] - ETA: 0s - loss: 0.3899 - accuracy: 0.4066 9/11 [=======================>......] - ETA: 0s - loss: 0.3841 - accuracy: 0.416411/11 [==============================] - ETA: 0s - loss: 0.3795 - accuracy: 0.423611/11 [==============================] - 0s 29ms/step - loss: 0.3778 - accuracy: 0.4261
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3603 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.3567 - accuracy: 0.4510 5/11 [============>.................] - ETA: 0s - loss: 0.3508 - accuracy: 0.4564 7/11 [==================>...........] - ETA: 0s - loss: 0.3460 - accuracy: 0.4624 9/11 [=======================>......] - ETA: 0s - loss: 0.3443 - accuracy: 0.462311/11 [==============================] - ETA: 0s - loss: 0.3435 - accuracy: 0.461011/11 [==============================] - 0s 29ms/step - loss: 0.3432 - accuracy: 0.4604
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3084 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.3153 - accuracy: 0.5052 5/11 [============>.................] - ETA: 0s - loss: 0.3168 - accuracy: 0.4941 7/11 [==================>...........] - ETA: 0s - loss: 0.3185 - accuracy: 0.4864 9/11 [=======================>......] - ETA: 0s - loss: 0.3194 - accuracy: 0.479311/11 [==============================] - ETA: 0s - loss: 0.3198 - accuracy: 0.474311/11 [==============================] - 0s 28ms/step - loss: 0.3199 - accuracy: 0.4726
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3072 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.3062 - accuracy: 0.4709 5/11 [============>.................] - ETA: 0s - loss: 0.3037 - accuracy: 0.4690 7/11 [==================>...........] - ETA: 0s - loss: 0.3036 - accuracy: 0.4645 9/11 [=======================>......] - ETA: 0s - loss: 0.3032 - accuracy: 0.460611/11 [==============================] - 0s 27ms/step - loss: 0.3022 - accuracy: 0.4584
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3020 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.2844 - accuracy: 0.4510 5/11 [============>.................] - ETA: 0s - loss: 0.2791 - accuracy: 0.4567 8/11 [====================>.........] - ETA: 0s - loss: 0.2748 - accuracy: 0.462811/11 [==============================] - ETA: 0s - loss: 0.2733 - accuracy: 0.462111/11 [==============================] - 0s 27ms/step - loss: 0.2729 - accuracy: 0.4620
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2446 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.2465 - accuracy: 0.4714 5/11 [============>.................] - ETA: 0s - loss: 0.2435 - accuracy: 0.4716 7/11 [==================>...........] - ETA: 0s - loss: 0.2429 - accuracy: 0.4715 9/11 [=======================>......] - ETA: 0s - loss: 0.2424 - accuracy: 0.472511/11 [==============================] - 0s 27ms/step - loss: 0.2415 - accuracy: 0.4752
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2331 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.2217 - accuracy: 0.5825 5/11 [============>.................] - ETA: 0s - loss: 0.2188 - accuracy: 0.5742 7/11 [==================>...........] - ETA: 0s - loss: 0.2193 - accuracy: 0.5704 9/11 [=======================>......] - ETA: 0s - loss: 0.2185 - accuracy: 0.572211/11 [==============================] - ETA: 0s - loss: 0.2176 - accuracy: 0.575011/11 [==============================] - 0s 27ms/step - loss: 0.2172 - accuracy: 0.5761
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2041 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.1993 - accuracy: 0.5846 5/11 [============>.................] - ETA: 0s - loss: 0.1986 - accuracy: 0.5927 7/11 [==================>...........] - ETA: 0s - loss: 0.1983 - accuracy: 0.5979 9/11 [=======================>......] - ETA: 0s - loss: 0.1975 - accuracy: 0.604011/11 [==============================] - ETA: 0s - loss: 0.1965 - accuracy: 0.611711/11 [==============================] - 0s 28ms/step - loss: 0.1962 - accuracy: 0.6148
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1750 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.1738 - accuracy: 0.6710 5/11 [============>.................] - ETA: 0s - loss: 0.1749 - accuracy: 0.6787 7/11 [==================>...........] - ETA: 0s - loss: 0.1767 - accuracy: 0.6852 9/11 [=======================>......] - ETA: 0s - loss: 0.1774 - accuracy: 0.693611/11 [==============================] - 0s 27ms/step - loss: 0.1771 - accuracy: 0.7014
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1754 - accuracy: 0.7031 4/11 [=========>....................] - ETA: 0s - loss: 0.1741 - accuracy: 0.7160 6/11 [===============>..............] - ETA: 0s - loss: 0.1741 - accuracy: 0.7231 8/11 [====================>.........] - ETA: 0s - loss: 0.1728 - accuracy: 0.732710/11 [==========================>...] - ETA: 0s - loss: 0.1711 - accuracy: 0.737211/11 [==============================] - 0s 28ms/step - loss: 0.1699 - accuracy: 0.7387
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1619 - accuracy: 0.7031 3/11 [=======>......................] - ETA: 0s - loss: 0.1590 - accuracy: 0.7296 5/11 [============>.................] - ETA: 0s - loss: 0.1569 - accuracy: 0.7374 7/11 [==================>...........] - ETA: 0s - loss: 0.1553 - accuracy: 0.7442 9/11 [=======================>......] - ETA: 0s - loss: 0.1545 - accuracy: 0.751711/11 [==============================] - 0s 27ms/step - loss: 0.1541 - accuracy: 0.7615
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1438 - accuracy: 0.8516 3/11 [=======>......................] - ETA: 0s - loss: 0.1407 - accuracy: 0.8251 5/11 [============>.................] - ETA: 0s - loss: 0.1401 - accuracy: 0.7978 7/11 [==================>...........] - ETA: 0s - loss: 0.1409 - accuracy: 0.7774 9/11 [=======================>......] - ETA: 0s - loss: 0.1413 - accuracy: 0.764211/11 [==============================] - ETA: 0s - loss: 0.1416 - accuracy: 0.756811/11 [==============================] - 0s 28ms/step - loss: 0.1417 - accuracy: 0.7542
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1734 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.1661 - accuracy: 0.8160 5/11 [============>.................] - ETA: 0s - loss: 0.1593 - accuracy: 0.8304 7/11 [==================>...........] - ETA: 0s - loss: 0.1547 - accuracy: 0.8348 9/11 [=======================>......] - ETA: 0s - loss: 0.1512 - accuracy: 0.836911/11 [==============================] - 0s 27ms/step - loss: 0.1471 - accuracy: 0.8377
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1214 - accuracy: 0.8359 3/11 [=======>......................] - ETA: 0s - loss: 0.1244 - accuracy: 0.7990 5/11 [============>.................] - ETA: 0s - loss: 0.1248 - accuracy: 0.7812 7/11 [==================>...........] - ETA: 0s - loss: 0.1255 - accuracy: 0.7772 9/11 [=======================>......] - ETA: 0s - loss: 0.1262 - accuracy: 0.778811/11 [==============================] - ETA: 0s - loss: 0.1265 - accuracy: 0.782111/11 [==============================] - 0s 29ms/step - loss: 0.1266 - accuracy: 0.7836
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1132 - accuracy: 0.8516 3/11 [=======>......................] - ETA: 0s - loss: 0.1121 - accuracy: 0.8737 5/11 [============>.................] - ETA: 0s - loss: 0.1149 - accuracy: 0.8720 7/11 [==================>...........] - ETA: 0s - loss: 0.1159 - accuracy: 0.8634 9/11 [=======================>......] - ETA: 0s - loss: 0.1169 - accuracy: 0.859311/11 [==============================] - ETA: 0s - loss: 0.1176 - accuracy: 0.857111/11 [==============================] - 0s 28ms/step - loss: 0.1179 - accuracy: 0.8562
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1428 - accuracy: 0.8281 3/11 [=======>......................] - ETA: 0s - loss: 0.1279 - accuracy: 0.8529 5/11 [============>.................] - ETA: 0s - loss: 0.1219 - accuracy: 0.8652 7/11 [==================>...........] - ETA: 0s - loss: 0.1196 - accuracy: 0.8678 9/11 [=======================>......] - ETA: 0s - loss: 0.1183 - accuracy: 0.866611/11 [==============================] - ETA: 0s - loss: 0.1176 - accuracy: 0.863711/11 [==============================] - 0s 28ms/step - loss: 0.1174 - accuracy: 0.8625
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0894 - accuracy: 0.8828 3/11 [=======>......................] - ETA: 0s - loss: 0.1013 - accuracy: 0.8850 5/11 [============>.................] - ETA: 0s - loss: 0.1039 - accuracy: 0.8873 7/11 [==================>...........] - ETA: 0s - loss: 0.1052 - accuracy: 0.8854 9/11 [=======================>......] - ETA: 0s - loss: 0.1063 - accuracy: 0.879911/11 [==============================] - ETA: 0s - loss: 0.1072 - accuracy: 0.875711/11 [==============================] - 0s 29ms/step - loss: 0.1075 - accuracy: 0.8741
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.1174 - accuracy: 0.87506/6 [==============================] - ETA: 0s - loss: 0.1205 - accuracy: 0.8584 6/6 [==============================] - 5s 11ms/step - loss: 0.1205 - accuracy: 0.8584
2021-12-13 23:58:50.675715: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:58:50.676314: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:58:50.676368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:58:50.676411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:58:50.676442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:58:50.676480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:58:50.676512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:58:50.676544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:58:50.676576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:58:50.676608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:58:50.677311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:58:50.677354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:58:50.677366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:58:50.677375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:58:50.678637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:58:50.678938: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:58:50.679341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:58:50.679369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:58:50.679395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:58:50.679422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:58:50.679448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:58:50.679475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:58:50.679501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:58:50.679529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:58:50.679556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:58:50.680278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:58:50.680309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:58:50.680320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:58:50.680329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:58:50.681118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [2.5629301e-03 9.1510844e-01 8.2937211e-01 2.3787834e-03 3.0294625e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [1.2954194e-03 8.8630593e-01 8.9585900e-01 1.4903898e-03 2.0788269e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [3.1291848e-04 1.4438125e-02 9.8939043e-01 2.7652767e-03 1.4420692e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 3 0 4] pred: [3.3385423e-03 9.2745042e-01 7.5417221e-01 4.2233076e-03 3.2502683e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [3.1898610e-04 1.2317871e-02 9.8970848e-01 2.7486780e-03 1.4633554e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 2 0 1] pred: [0.01563372 0.00429929 0.07597765 0.87353724 0.08843289]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 0 2 1] pred: [0.1201497  0.02639872 0.08605025 0.79099005 0.68958545]
 Top predictions indices: [3 4] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [3.5826600e-04 8.8082189e-03 9.8936754e-01 2.9726601e-03 1.5928860e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [3.5427403e-04 9.3827769e-03 9.8936886e-01 2.8733285e-03 1.5849620e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 0 4] pred: [0.00339701 0.01155809 0.6652488  0.15510288 0.00181001]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [3.8324136e-04 1.0154370e-01 9.8965985e-01 2.4713837e-03 1.3960320e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 3 0 4] pred: [2.2382322e-03 8.9092624e-01 8.4173280e-01 2.5501444e-03 2.8612127e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 2 0 1] pred: [0.02840865 0.01598001 0.08535587 0.86404675 0.10707404]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 3 0 4] pred: [3.3437249e-03 8.7566584e-01 8.0323678e-01 3.3448485e-03 3.9432969e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [1.1001587e-03 8.7465119e-01 9.1236645e-01 1.4086169e-03 1.6617516e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:42 - loss: 0.6879 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.6862 - accuracy: 0.5356   5/11 [============>.................] - ETA: 0s - loss: 0.6843 - accuracy: 0.5226 7/11 [==================>...........] - ETA: 0s - loss: 0.6824 - accuracy: 0.5117 9/11 [=======================>......] - ETA: 0s - loss: 0.6803 - accuracy: 0.505411/11 [==============================] - 17s 27ms/step - loss: 0.6774 - accuracy: 0.5013
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6367 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.6314 - accuracy: 0.4440 5/11 [============>.................] - ETA: 0s - loss: 0.6272 - accuracy: 0.4560 7/11 [==================>...........] - ETA: 0s - loss: 0.6226 - accuracy: 0.4613 9/11 [=======================>......] - ETA: 0s - loss: 0.6180 - accuracy: 0.463811/11 [==============================] - ETA: 0s - loss: 0.6132 - accuracy: 0.466211/11 [==============================] - 0s 28ms/step - loss: 0.6112 - accuracy: 0.4671
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5059 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.5012 - accuracy: 0.5226 5/11 [============>.................] - ETA: 0s - loss: 0.4936 - accuracy: 0.5017 7/11 [==================>...........] - ETA: 0s - loss: 0.4831 - accuracy: 0.4959 9/11 [=======================>......] - ETA: 0s - loss: 0.4735 - accuracy: 0.492311/11 [==============================] - ETA: 0s - loss: 0.4651 - accuracy: 0.489311/11 [==============================] - 0s 28ms/step - loss: 0.4617 - accuracy: 0.4883
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3866 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.3589 - accuracy: 0.4883 5/11 [============>.................] - ETA: 0s - loss: 0.3561 - accuracy: 0.4901 7/11 [==================>...........] - ETA: 0s - loss: 0.3563 - accuracy: 0.4892 9/11 [=======================>......] - ETA: 0s - loss: 0.3570 - accuracy: 0.488411/11 [==============================] - ETA: 0s - loss: 0.3570 - accuracy: 0.486411/11 [==============================] - 0s 28ms/step - loss: 0.3569 - accuracy: 0.4857
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3196 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.3253 - accuracy: 0.5200 5/11 [============>.................] - ETA: 0s - loss: 0.3244 - accuracy: 0.5160 7/11 [==================>...........] - ETA: 0s - loss: 0.3255 - accuracy: 0.5086 9/11 [=======================>......] - ETA: 0s - loss: 0.3261 - accuracy: 0.503111/11 [==============================] - 0s 28ms/step - loss: 0.3266 - accuracy: 0.4975
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3358 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.3235 - accuracy: 0.4510 5/11 [============>.................] - ETA: 0s - loss: 0.3185 - accuracy: 0.4621 7/11 [==================>...........] - ETA: 0s - loss: 0.3160 - accuracy: 0.468310/11 [==========================>...] - ETA: 0s - loss: 0.3138 - accuracy: 0.473711/11 [==============================] - 0s 28ms/step - loss: 0.3130 - accuracy: 0.4752
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3049 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3002 - accuracy: 0.4666 5/11 [============>.................] - ETA: 0s - loss: 0.2957 - accuracy: 0.4693 7/11 [==================>...........] - ETA: 0s - loss: 0.2927 - accuracy: 0.4727 9/11 [=======================>......] - ETA: 0s - loss: 0.2904 - accuracy: 0.476111/11 [==============================] - ETA: 0s - loss: 0.2888 - accuracy: 0.478311/11 [==============================] - 0s 28ms/step - loss: 0.2881 - accuracy: 0.4790
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2663 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.2644 - accuracy: 0.4783 5/11 [============>.................] - ETA: 0s - loss: 0.2642 - accuracy: 0.4795 7/11 [==================>...........] - ETA: 0s - loss: 0.2627 - accuracy: 0.4799 9/11 [=======================>......] - ETA: 0s - loss: 0.2605 - accuracy: 0.482611/11 [==============================] - ETA: 0s - loss: 0.2585 - accuracy: 0.485011/11 [==============================] - 0s 29ms/step - loss: 0.2576 - accuracy: 0.4862
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2727 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.2606 - accuracy: 0.5013 5/11 [============>.................] - ETA: 0s - loss: 0.2517 - accuracy: 0.5084 7/11 [==================>...........] - ETA: 0s - loss: 0.2462 - accuracy: 0.5138 9/11 [=======================>......] - ETA: 0s - loss: 0.2428 - accuracy: 0.516211/11 [==============================] - ETA: 0s - loss: 0.2397 - accuracy: 0.518311/11 [==============================] - 0s 28ms/step - loss: 0.2385 - accuracy: 0.5194
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2177 - accuracy: 0.6016 4/11 [=========>....................] - ETA: 0s - loss: 0.2155 - accuracy: 0.5999 6/11 [===============>..............] - ETA: 0s - loss: 0.2146 - accuracy: 0.6022 8/11 [====================>.........] - ETA: 0s - loss: 0.2125 - accuracy: 0.604710/11 [==========================>...] - ETA: 0s - loss: 0.2113 - accuracy: 0.607011/11 [==============================] - 0s 27ms/step - loss: 0.2107 - accuracy: 0.6090
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1894 - accuracy: 0.6328 3/11 [=======>......................] - ETA: 0s - loss: 0.1953 - accuracy: 0.6710 5/11 [============>.................] - ETA: 0s - loss: 0.1936 - accuracy: 0.6783 7/11 [==================>...........] - ETA: 0s - loss: 0.1936 - accuracy: 0.6767 9/11 [=======================>......] - ETA: 0s - loss: 0.1939 - accuracy: 0.677311/11 [==============================] - ETA: 0s - loss: 0.1939 - accuracy: 0.678811/11 [==============================] - 0s 26ms/step - loss: 0.1939 - accuracy: 0.6794
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1763 - accuracy: 0.6641 3/11 [=======>......................] - ETA: 0s - loss: 0.1793 - accuracy: 0.6714 5/11 [============>.................] - ETA: 0s - loss: 0.1812 - accuracy: 0.6896 7/11 [==================>...........] - ETA: 0s - loss: 0.1814 - accuracy: 0.698410/11 [==========================>...] - ETA: 0s - loss: 0.1817 - accuracy: 0.707111/11 [==============================] - 0s 27ms/step - loss: 0.1817 - accuracy: 0.7112
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1669 - accuracy: 0.7500 3/11 [=======>......................] - ETA: 0s - loss: 0.1715 - accuracy: 0.7578 5/11 [============>.................] - ETA: 0s - loss: 0.1721 - accuracy: 0.7585 7/11 [==================>...........] - ETA: 0s - loss: 0.1716 - accuracy: 0.7566 9/11 [=======================>......] - ETA: 0s - loss: 0.1719 - accuracy: 0.754011/11 [==============================] - ETA: 0s - loss: 0.1718 - accuracy: 0.752711/11 [==============================] - 0s 28ms/step - loss: 0.1717 - accuracy: 0.7522
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1691 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.1638 - accuracy: 0.7808 5/11 [============>.................] - ETA: 0s - loss: 0.1654 - accuracy: 0.7828 7/11 [==================>...........] - ETA: 0s - loss: 0.1643 - accuracy: 0.7827 9/11 [=======================>......] - ETA: 0s - loss: 0.1632 - accuracy: 0.780011/11 [==============================] - ETA: 0s - loss: 0.1626 - accuracy: 0.778311/11 [==============================] - 0s 28ms/step - loss: 0.1624 - accuracy: 0.7776
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1701 - accuracy: 0.7500 3/11 [=======>......................] - ETA: 0s - loss: 0.1646 - accuracy: 0.7786 5/11 [============>.................] - ETA: 0s - loss: 0.1609 - accuracy: 0.7855 7/11 [==================>...........] - ETA: 0s - loss: 0.1596 - accuracy: 0.7864 9/11 [=======================>......] - ETA: 0s - loss: 0.1580 - accuracy: 0.785911/11 [==============================] - ETA: 0s - loss: 0.1569 - accuracy: 0.784911/11 [==============================] - 0s 28ms/step - loss: 0.1565 - accuracy: 0.7843
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1703 - accuracy: 0.7500 3/11 [=======>......................] - ETA: 0s - loss: 0.1578 - accuracy: 0.7843 5/11 [============>.................] - ETA: 0s - loss: 0.1525 - accuracy: 0.7971 7/11 [==================>...........] - ETA: 0s - loss: 0.1512 - accuracy: 0.8047 9/11 [=======================>......] - ETA: 0s - loss: 0.1503 - accuracy: 0.809011/11 [==============================] - ETA: 0s - loss: 0.1491 - accuracy: 0.808511/11 [==============================] - 0s 27ms/step - loss: 0.1486 - accuracy: 0.8081
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1360 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.1381 - accuracy: 0.7339 5/11 [============>.................] - ETA: 0s - loss: 0.1405 - accuracy: 0.7308 7/11 [==================>...........] - ETA: 0s - loss: 0.1414 - accuracy: 0.7416 9/11 [=======================>......] - ETA: 0s - loss: 0.1414 - accuracy: 0.753111/11 [==============================] - ETA: 0s - loss: 0.1410 - accuracy: 0.762811/11 [==============================] - 0s 29ms/step - loss: 0.1408 - accuracy: 0.7662
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1515 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.1493 - accuracy: 0.7188 5/11 [============>.................] - ETA: 0s - loss: 0.1440 - accuracy: 0.7220 7/11 [==================>...........] - ETA: 0s - loss: 0.1409 - accuracy: 0.7352 9/11 [=======================>......] - ETA: 0s - loss: 0.1388 - accuracy: 0.748211/11 [==============================] - ETA: 0s - loss: 0.1373 - accuracy: 0.759511/11 [==============================] - 0s 28ms/step - loss: 0.1367 - accuracy: 0.7637
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1246 - accuracy: 0.8516 3/11 [=======>......................] - ETA: 0s - loss: 0.1233 - accuracy: 0.8325 5/11 [============>.................] - ETA: 0s - loss: 0.1233 - accuracy: 0.8193 7/11 [==================>...........] - ETA: 0s - loss: 0.1231 - accuracy: 0.8123 9/11 [=======================>......] - ETA: 0s - loss: 0.1230 - accuracy: 0.813111/11 [==============================] - 0s 28ms/step - loss: 0.1226 - accuracy: 0.8170
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1255 - accuracy: 0.8984 3/11 [=======>......................] - ETA: 0s - loss: 0.1180 - accuracy: 0.9036 5/11 [============>.................] - ETA: 0s - loss: 0.1165 - accuracy: 0.8908 7/11 [==================>...........] - ETA: 0s - loss: 0.1171 - accuracy: 0.8787 9/11 [=======================>......] - ETA: 0s - loss: 0.1173 - accuracy: 0.871211/11 [==============================] - 0s 29ms/step - loss: 0.1169 - accuracy: 0.8665
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.1214 - accuracy: 0.80476/6 [==============================] - ETA: 0s - loss: 0.1136 - accuracy: 0.8187 6/6 [==============================] - 5s 11ms/step - loss: 0.1136 - accuracy: 0.8187
2021-12-13 23:59:28.285771: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:59:28.286585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:59:28.286660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:59:28.286722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:59:28.286769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:59:28.286815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:59:28.286869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:59:28.286918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:59:28.286976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:59:28.287026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:59:28.287953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:59:28.288007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:59:28.288027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:59:28.288039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:59:28.289343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:59:28.289763: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:59:28.290280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:59:28.290322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:59:28.290359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:59:28.290400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:59:28.290437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:59:28.290477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:59:28.290515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:59:28.290555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:59:28.290593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:59:28.291535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:59:28.291575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:59:28.291592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:59:28.291604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:59:28.292600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 2 4 1 0] pred: [0.00457504 0.00736754 0.43768987 0.4735112  0.03178335]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [5.9782522e-04 5.9434264e-03 9.9142152e-01 3.8110511e-03 4.4897743e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [3.1723587e-03 7.1916717e-01 8.9011115e-01 3.9890155e-04 1.0315807e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [0 1 4 3 2] pred: [0.75252444 0.47832716 0.15775962 0.19815093 0.2709458 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 3 0 4] pred: [0.03726707 0.6268741  0.5623585  0.10796666 0.01821667]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 3 4] pred: [8.1470358e-04 3.1351098e-01 9.7522700e-01 1.9237235e-04 5.1618725e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 4 0] pred: [4.3315516e-04 4.0991157e-03 9.8630667e-01 1.0911077e-02 6.9518940e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [8.7416067e-04 4.0085632e-01 9.7524852e-01 2.6470461e-04 5.1343166e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [5.4878979e-03 9.1284311e-01 8.2777572e-01 1.3337198e-03 2.2271748e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 4 2 0 1] pred: [0.01938918 0.00571886 0.0980097  0.69775856 0.18726559]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [3 4 2 0 1] pred: [0.03782099 0.00805626 0.0442472  0.8295817  0.41687006]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 2 0 1] pred: [0.02475759 0.00480441 0.04749498 0.7808696  0.3147411 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [1.3080033e-02 9.5214057e-01 6.7800903e-01 1.5236274e-03 5.1205407e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [1.4665381e-03 7.6123255e-01 9.2043608e-01 1.0098312e-03 8.9885070e-05]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [1.1189247e-02 8.8487941e-01 5.7197195e-01 9.2052057e-04 3.6070900e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:41 - loss: 0.6936 - accuracy: 0.0312 3/11 [=======>......................] - ETA: 0s - loss: 0.6917 - accuracy: 0.0807   5/11 [============>.................] - ETA: 0s - loss: 0.6895 - accuracy: 0.1586 7/11 [==================>...........] - ETA: 0s - loss: 0.6872 - accuracy: 0.2104 9/11 [=======================>......] - ETA: 0s - loss: 0.6849 - accuracy: 0.243911/11 [==============================] - 16s 28ms/step - loss: 0.6814 - accuracy: 0.2776
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6336 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.6299 - accuracy: 0.4388 5/11 [============>.................] - ETA: 0s - loss: 0.6253 - accuracy: 0.4427 7/11 [==================>...........] - ETA: 0s - loss: 0.6204 - accuracy: 0.4453 9/11 [=======================>......] - ETA: 0s - loss: 0.6153 - accuracy: 0.445911/11 [==============================] - ETA: 0s - loss: 0.6094 - accuracy: 0.447411/11 [==============================] - 0s 28ms/step - loss: 0.6070 - accuracy: 0.4482
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4927 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.4830 - accuracy: 0.4562 5/11 [============>.................] - ETA: 0s - loss: 0.4739 - accuracy: 0.4499 7/11 [==================>...........] - ETA: 0s - loss: 0.4647 - accuracy: 0.4486 9/11 [=======================>......] - ETA: 0s - loss: 0.4563 - accuracy: 0.450011/11 [==============================] - ETA: 0s - loss: 0.4489 - accuracy: 0.451311/11 [==============================] - 0s 29ms/step - loss: 0.4460 - accuracy: 0.4517
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3537 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.3582 - accuracy: 0.4679 5/11 [============>.................] - ETA: 0s - loss: 0.3616 - accuracy: 0.4632 7/11 [==================>...........] - ETA: 0s - loss: 0.3633 - accuracy: 0.4572 9/11 [=======================>......] - ETA: 0s - loss: 0.3631 - accuracy: 0.455011/11 [==============================] - ETA: 0s - loss: 0.3623 - accuracy: 0.455111/11 [==============================] - 0s 29ms/step - loss: 0.3619 - accuracy: 0.4553
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3246 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.3312 - accuracy: 0.5113 5/11 [============>.................] - ETA: 0s - loss: 0.3338 - accuracy: 0.4908 7/11 [==================>...........] - ETA: 0s - loss: 0.3344 - accuracy: 0.4797 9/11 [=======================>......] - ETA: 0s - loss: 0.3343 - accuracy: 0.474011/11 [==============================] - 0s 27ms/step - loss: 0.3330 - accuracy: 0.4697
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3302 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.3204 - accuracy: 0.4627 5/11 [============>.................] - ETA: 0s - loss: 0.3185 - accuracy: 0.4567 7/11 [==================>...........] - ETA: 0s - loss: 0.3162 - accuracy: 0.4558 9/11 [=======================>......] - ETA: 0s - loss: 0.3136 - accuracy: 0.457811/11 [==============================] - ETA: 0s - loss: 0.3119 - accuracy: 0.458811/11 [==============================] - 0s 28ms/step - loss: 0.3113 - accuracy: 0.4588
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3400 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.3208 - accuracy: 0.4783 5/11 [============>.................] - ETA: 0s - loss: 0.3112 - accuracy: 0.4741 7/11 [==================>...........] - ETA: 0s - loss: 0.3070 - accuracy: 0.4676 9/11 [=======================>......] - ETA: 0s - loss: 0.3033 - accuracy: 0.464411/11 [==============================] - 0s 27ms/step - loss: 0.2981 - accuracy: 0.4631
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2760 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.2684 - accuracy: 0.4562 5/11 [============>.................] - ETA: 0s - loss: 0.2633 - accuracy: 0.4620 7/11 [==================>...........] - ETA: 0s - loss: 0.2620 - accuracy: 0.4666 9/11 [=======================>......] - ETA: 0s - loss: 0.2614 - accuracy: 0.467211/11 [==============================] - 0s 28ms/step - loss: 0.2609 - accuracy: 0.4677
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2403 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.2526 - accuracy: 0.4766 5/11 [============>.................] - ETA: 0s - loss: 0.2506 - accuracy: 0.4804 7/11 [==================>...........] - ETA: 0s - loss: 0.2500 - accuracy: 0.483010/11 [==========================>...] - ETA: 0s - loss: 0.2473 - accuracy: 0.489511/11 [==============================] - 0s 27ms/step - loss: 0.2463 - accuracy: 0.4922
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2333 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.2356 - accuracy: 0.4909 5/11 [============>.................] - ETA: 0s - loss: 0.2363 - accuracy: 0.4979 7/11 [==================>...........] - ETA: 0s - loss: 0.2335 - accuracy: 0.5055 9/11 [=======================>......] - ETA: 0s - loss: 0.2312 - accuracy: 0.512811/11 [==============================] - 0s 27ms/step - loss: 0.2291 - accuracy: 0.5224
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2096 - accuracy: 0.6641 3/11 [=======>......................] - ETA: 0s - loss: 0.2104 - accuracy: 0.6953 5/11 [============>.................] - ETA: 0s - loss: 0.2101 - accuracy: 0.7025 7/11 [==================>...........] - ETA: 0s - loss: 0.2075 - accuracy: 0.7102 9/11 [=======================>......] - ETA: 0s - loss: 0.2069 - accuracy: 0.711711/11 [==============================] - ETA: 0s - loss: 0.2064 - accuracy: 0.709811/11 [==============================] - 0s 29ms/step - loss: 0.2062 - accuracy: 0.7087
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1938 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.1874 - accuracy: 0.6688 5/11 [============>.................] - ETA: 0s - loss: 0.1867 - accuracy: 0.6729 7/11 [==================>...........] - ETA: 0s - loss: 0.1862 - accuracy: 0.6749 9/11 [=======================>......] - ETA: 0s - loss: 0.1865 - accuracy: 0.678511/11 [==============================] - ETA: 0s - loss: 0.1861 - accuracy: 0.682311/11 [==============================] - 0s 29ms/step - loss: 0.1859 - accuracy: 0.6839
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1530 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.1641 - accuracy: 0.7769 5/11 [============>.................] - ETA: 0s - loss: 0.1675 - accuracy: 0.7624 7/11 [==================>...........] - ETA: 0s - loss: 0.1687 - accuracy: 0.7591 9/11 [=======================>......] - ETA: 0s - loss: 0.1691 - accuracy: 0.758211/11 [==============================] - ETA: 0s - loss: 0.1687 - accuracy: 0.757511/11 [==============================] - 0s 29ms/step - loss: 0.1685 - accuracy: 0.7572
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1376 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.1502 - accuracy: 0.7400 5/11 [============>.................] - ETA: 0s - loss: 0.1536 - accuracy: 0.7471 7/11 [==================>...........] - ETA: 0s - loss: 0.1539 - accuracy: 0.7510 9/11 [=======================>......] - ETA: 0s - loss: 0.1544 - accuracy: 0.756911/11 [==============================] - 0s 29ms/step - loss: 0.1542 - accuracy: 0.7638
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1499 - accuracy: 0.8281 3/11 [=======>......................] - ETA: 0s - loss: 0.1515 - accuracy: 0.7934 5/11 [============>.................] - ETA: 0s - loss: 0.1493 - accuracy: 0.7835 7/11 [==================>...........] - ETA: 0s - loss: 0.1486 - accuracy: 0.7852 9/11 [=======================>......] - ETA: 0s - loss: 0.1485 - accuracy: 0.788911/11 [==============================] - ETA: 0s - loss: 0.1480 - accuracy: 0.792511/11 [==============================] - 0s 28ms/step - loss: 0.1478 - accuracy: 0.7939
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1540 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.1448 - accuracy: 0.8194 5/11 [============>.................] - ETA: 0s - loss: 0.1440 - accuracy: 0.8107 7/11 [==================>...........] - ETA: 0s - loss: 0.1428 - accuracy: 0.8066 9/11 [=======================>......] - ETA: 0s - loss: 0.1412 - accuracy: 0.807211/11 [==============================] - ETA: 0s - loss: 0.1401 - accuracy: 0.810011/11 [==============================] - 0s 28ms/step - loss: 0.1398 - accuracy: 0.8113
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1208 - accuracy: 0.8516 3/11 [=======>......................] - ETA: 0s - loss: 0.1266 - accuracy: 0.8446 5/11 [============>.................] - ETA: 0s - loss: 0.1279 - accuracy: 0.8465 7/11 [==================>...........] - ETA: 0s - loss: 0.1284 - accuracy: 0.8477 9/11 [=======================>......] - ETA: 0s - loss: 0.1287 - accuracy: 0.847411/11 [==============================] - ETA: 0s - loss: 0.1287 - accuracy: 0.846511/11 [==============================] - 0s 29ms/step - loss: 0.1287 - accuracy: 0.8462
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1385 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.1361 - accuracy: 0.8646 5/11 [============>.................] - ETA: 0s - loss: 0.1339 - accuracy: 0.8611 7/11 [==================>...........] - ETA: 0s - loss: 0.1319 - accuracy: 0.8585 9/11 [=======================>......] - ETA: 0s - loss: 0.1305 - accuracy: 0.856811/11 [==============================] - ETA: 0s - loss: 0.1294 - accuracy: 0.856311/11 [==============================] - 0s 29ms/step - loss: 0.1289 - accuracy: 0.8563
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1079 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.1152 - accuracy: 0.8763 5/11 [============>.................] - ETA: 0s - loss: 0.1170 - accuracy: 0.8743 7/11 [==================>...........] - ETA: 0s - loss: 0.1178 - accuracy: 0.8712 9/11 [=======================>......] - ETA: 0s - loss: 0.1178 - accuracy: 0.869911/11 [==============================] - 0s 28ms/step - loss: 0.1176 - accuracy: 0.8688
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1252 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.1170 - accuracy: 0.8832 5/11 [============>.................] - ETA: 0s - loss: 0.1135 - accuracy: 0.8855 7/11 [==================>...........] - ETA: 0s - loss: 0.1127 - accuracy: 0.8868 9/11 [=======================>......] - ETA: 0s - loss: 0.1127 - accuracy: 0.887611/11 [==============================] - ETA: 0s - loss: 0.1123 - accuracy: 0.887511/11 [==============================] - 0s 29ms/step - loss: 0.1121 - accuracy: 0.8873
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.0893 - accuracy: 0.89846/6 [==============================] - 5s 10ms/step - loss: 0.1177 - accuracy: 0.8711
2021-12-14 00:00:06.005389: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:00:06.006669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:00:06.006759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:00:06.006839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:00:06.006896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:00:06.006962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:00:06.007018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:00:06.007086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:00:06.007142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:00:06.007208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:00:06.008156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:00:06.008218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:00:06.008239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:00:06.008252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:00:06.009566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:00:06.010054: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:00:06.010552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:00:06.010592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:00:06.010629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:00:06.010671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:00:06.010709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:00:06.010745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:00:06.010785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:00:06.010822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:00:06.010859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:00:06.012079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:00:06.012119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:00:06.012136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:00:06.012148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:00:06.013146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [5.3639039e-03 9.3614888e-01 8.4096032e-01 1.7661562e-03 2.3153008e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [0 1 3 2 4] pred: [0.73656785 0.48350397 0.13204038 0.14241973 0.07231851]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [2.7370946e-02 9.0633130e-01 6.8252742e-01 3.2278204e-03 8.8606309e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [4.2505231e-04 7.0120175e-03 9.8815364e-01 5.6025297e-03 6.2910351e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [3.1636906e-04 6.3332478e-03 9.9017274e-01 4.1690841e-03 6.2590180e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [5.9328642e-04 1.9194412e-01 9.7234005e-01 3.7516067e-03 3.4521209e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [3.8606355e-03 9.0370023e-01 8.3169466e-01 1.9557590e-03 2.2223213e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [3.2296320e-04 6.6367453e-03 9.9021190e-01 4.1560014e-03 6.3791947e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [3.7544188e-03 9.1017324e-01 8.6744177e-01 1.7453706e-03 2.0973805e-04]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [3.8989948e-04 2.0686099e-01 9.7951263e-01 2.9550605e-03 3.0368307e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [0.03324435 0.5793595  0.69365007 0.01632019 0.00359278]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [3.1577295e-03 8.9266491e-01 8.8410383e-01 1.6386096e-03 1.9089250e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [5.4535223e-04 3.0719185e-01 9.7869712e-01 1.8091172e-03 2.0437241e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [3.3529084e-03 8.8628036e-01 8.8726634e-01 1.7993965e-03 2.2609740e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 4 0] pred: [4.1415813e-04 4.4309036e-03 9.8264945e-01 7.2037936e-03 8.1516715e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:45 - loss: 0.6943 - accuracy: 0.0859 3/11 [=======>......................] - ETA: 0s - loss: 0.6919 - accuracy: 0.1858   5/11 [============>.................] - ETA: 0s - loss: 0.6898 - accuracy: 0.2377 7/11 [==================>...........] - ETA: 0s - loss: 0.6876 - accuracy: 0.2719 9/11 [=======================>......] - ETA: 0s - loss: 0.6852 - accuracy: 0.297311/11 [==============================] - 17s 27ms/step - loss: 0.6818 - accuracy: 0.3233
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6378 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.6325 - accuracy: 0.4401 6/11 [===============>..............] - ETA: 0s - loss: 0.6254 - accuracy: 0.4490 8/11 [====================>.........] - ETA: 0s - loss: 0.6208 - accuracy: 0.449810/11 [==========================>...] - ETA: 0s - loss: 0.6155 - accuracy: 0.451411/11 [==============================] - 0s 27ms/step - loss: 0.6105 - accuracy: 0.4536
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5099 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.5002 - accuracy: 0.4288 5/11 [============>.................] - ETA: 0s - loss: 0.4921 - accuracy: 0.4350 7/11 [==================>...........] - ETA: 0s - loss: 0.4834 - accuracy: 0.4409 9/11 [=======================>......] - ETA: 0s - loss: 0.4756 - accuracy: 0.446211/11 [==============================] - 0s 27ms/step - loss: 0.4664 - accuracy: 0.4507
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3838 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.3864 - accuracy: 0.4497 5/11 [============>.................] - ETA: 0s - loss: 0.3840 - accuracy: 0.4514 7/11 [==================>...........] - ETA: 0s - loss: 0.3832 - accuracy: 0.4537 9/11 [=======================>......] - ETA: 0s - loss: 0.3819 - accuracy: 0.457111/11 [==============================] - 0s 27ms/step - loss: 0.3813 - accuracy: 0.4594
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3224 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.3328 - accuracy: 0.5095 5/11 [============>.................] - ETA: 0s - loss: 0.3394 - accuracy: 0.5023 7/11 [==================>...........] - ETA: 0s - loss: 0.3433 - accuracy: 0.4938 9/11 [=======================>......] - ETA: 0s - loss: 0.3450 - accuracy: 0.487211/11 [==============================] - 0s 27ms/step - loss: 0.3461 - accuracy: 0.4813
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3444 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3450 - accuracy: 0.4575 5/11 [============>.................] - ETA: 0s - loss: 0.3426 - accuracy: 0.4689 7/11 [==================>...........] - ETA: 0s - loss: 0.3407 - accuracy: 0.4707 9/11 [=======================>......] - ETA: 0s - loss: 0.3385 - accuracy: 0.470211/11 [==============================] - 0s 26ms/step - loss: 0.3366 - accuracy: 0.4688
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3160 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.3166 - accuracy: 0.4727 5/11 [============>.................] - ETA: 0s - loss: 0.3170 - accuracy: 0.4715 7/11 [==================>...........] - ETA: 0s - loss: 0.3157 - accuracy: 0.469410/11 [==========================>...] - ETA: 0s - loss: 0.3138 - accuracy: 0.468611/11 [==============================] - 0s 27ms/step - loss: 0.3129 - accuracy: 0.4681
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2990 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.2951 - accuracy: 0.4447 6/11 [===============>..............] - ETA: 0s - loss: 0.2935 - accuracy: 0.4522 8/11 [====================>.........] - ETA: 0s - loss: 0.2923 - accuracy: 0.457210/11 [==========================>...] - ETA: 0s - loss: 0.2910 - accuracy: 0.460411/11 [==============================] - 0s 27ms/step - loss: 0.2899 - accuracy: 0.4620
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3014 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.2875 - accuracy: 0.4606 6/11 [===============>..............] - ETA: 0s - loss: 0.2820 - accuracy: 0.4610 8/11 [====================>.........] - ETA: 0s - loss: 0.2773 - accuracy: 0.465411/11 [==============================] - ETA: 0s - loss: 0.2720 - accuracy: 0.468211/11 [==============================] - 0s 26ms/step - loss: 0.2706 - accuracy: 0.4688
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2355 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.2316 - accuracy: 0.4449 5/11 [============>.................] - ETA: 0s - loss: 0.2299 - accuracy: 0.4611 7/11 [==================>...........] - ETA: 0s - loss: 0.2298 - accuracy: 0.4659 9/11 [=======================>......] - ETA: 0s - loss: 0.2288 - accuracy: 0.470911/11 [==============================] - 0s 27ms/step - loss: 0.2276 - accuracy: 0.4782
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2156 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.2126 - accuracy: 0.5551 5/11 [============>.................] - ETA: 0s - loss: 0.2098 - accuracy: 0.5627 7/11 [==================>...........] - ETA: 0s - loss: 0.2083 - accuracy: 0.5713 9/11 [=======================>......] - ETA: 0s - loss: 0.2070 - accuracy: 0.574411/11 [==============================] - 0s 27ms/step - loss: 0.2051 - accuracy: 0.5751
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2049 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.1965 - accuracy: 0.5864 5/11 [============>.................] - ETA: 0s - loss: 0.1928 - accuracy: 0.5971 7/11 [==================>...........] - ETA: 0s - loss: 0.1901 - accuracy: 0.6011 9/11 [=======================>......] - ETA: 0s - loss: 0.1881 - accuracy: 0.604611/11 [==============================] - ETA: 0s - loss: 0.1864 - accuracy: 0.606311/11 [==============================] - 0s 28ms/step - loss: 0.1857 - accuracy: 0.6069
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1556 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.1669 - accuracy: 0.6293 5/11 [============>.................] - ETA: 0s - loss: 0.1680 - accuracy: 0.6402 7/11 [==================>...........] - ETA: 0s - loss: 0.1677 - accuracy: 0.6472 9/11 [=======================>......] - ETA: 0s - loss: 0.1675 - accuracy: 0.652311/11 [==============================] - ETA: 0s - loss: 0.1669 - accuracy: 0.654911/11 [==============================] - 0s 28ms/step - loss: 0.1666 - accuracy: 0.6557
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1654 - accuracy: 0.6562 3/11 [=======>......................] - ETA: 0s - loss: 0.1568 - accuracy: 0.6628 5/11 [============>.................] - ETA: 0s - loss: 0.1559 - accuracy: 0.6705 7/11 [==================>...........] - ETA: 0s - loss: 0.1555 - accuracy: 0.6774 9/11 [=======================>......] - ETA: 0s - loss: 0.1552 - accuracy: 0.681111/11 [==============================] - 0s 27ms/step - loss: 0.1547 - accuracy: 0.6818
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1303 - accuracy: 0.7656 3/11 [=======>......................] - ETA: 0s - loss: 0.1369 - accuracy: 0.7582 5/11 [============>.................] - ETA: 0s - loss: 0.1394 - accuracy: 0.7592 7/11 [==================>...........] - ETA: 0s - loss: 0.1408 - accuracy: 0.7530 9/11 [=======================>......] - ETA: 0s - loss: 0.1417 - accuracy: 0.746811/11 [==============================] - ETA: 0s - loss: 0.1423 - accuracy: 0.741911/11 [==============================] - 0s 28ms/step - loss: 0.1425 - accuracy: 0.7401
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1212 - accuracy: 0.7109 3/11 [=======>......................] - ETA: 0s - loss: 0.1274 - accuracy: 0.7018 5/11 [============>.................] - ETA: 0s - loss: 0.1301 - accuracy: 0.6984 8/11 [====================>.........] - ETA: 0s - loss: 0.1322 - accuracy: 0.701910/11 [==========================>...] - ETA: 0s - loss: 0.1333 - accuracy: 0.704411/11 [==============================] - 0s 27ms/step - loss: 0.1340 - accuracy: 0.7070
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1350 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.1339 - accuracy: 0.7287 5/11 [============>.................] - ETA: 0s - loss: 0.1337 - accuracy: 0.7429 7/11 [==================>...........] - ETA: 0s - loss: 0.1335 - accuracy: 0.7531 9/11 [=======================>......] - ETA: 0s - loss: 0.1330 - accuracy: 0.762011/11 [==============================] - 0s 27ms/step - loss: 0.1320 - accuracy: 0.7701
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1149 - accuracy: 0.7266 3/11 [=======>......................] - ETA: 0s - loss: 0.1147 - accuracy: 0.7370 5/11 [============>.................] - ETA: 0s - loss: 0.1156 - accuracy: 0.7486 7/11 [==================>...........] - ETA: 0s - loss: 0.1163 - accuracy: 0.7543 9/11 [=======================>......] - ETA: 0s - loss: 0.1170 - accuracy: 0.757811/11 [==============================] - ETA: 0s - loss: 0.1178 - accuracy: 0.761911/11 [==============================] - 0s 28ms/step - loss: 0.1180 - accuracy: 0.7637
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1145 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 0s - loss: 0.1083 - accuracy: 0.8524 5/11 [============>.................] - ETA: 0s - loss: 0.1078 - accuracy: 0.8529 7/11 [==================>...........] - ETA: 0s - loss: 0.1089 - accuracy: 0.8508 9/11 [=======================>......] - ETA: 0s - loss: 0.1096 - accuracy: 0.847911/11 [==============================] - 0s 27ms/step - loss: 0.1106 - accuracy: 0.8462
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1131 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.1105 - accuracy: 0.8086 5/11 [============>.................] - ETA: 0s - loss: 0.1097 - accuracy: 0.8212 7/11 [==================>...........] - ETA: 0s - loss: 0.1096 - accuracy: 0.8319 9/11 [=======================>......] - ETA: 0s - loss: 0.1096 - accuracy: 0.835311/11 [==============================] - ETA: 0s - loss: 0.1094 - accuracy: 0.835611/11 [==============================] - 0s 28ms/step - loss: 0.1093 - accuracy: 0.8357
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.1255 - accuracy: 0.74226/6 [==============================] - ETA: 0s - loss: 0.1086 - accuracy: 0.7833 6/6 [==============================] - 5s 12ms/step - loss: 0.1086 - accuracy: 0.7833
2021-12-14 00:00:43.634255: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:00:43.634863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:00:43.634920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:00:43.634970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:00:43.634999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:00:43.635030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:00:43.635061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:00:43.635097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:00:43.635129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:00:43.635162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:00:43.635889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:00:43.635939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:00:43.635952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:00:43.635962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:00:43.636718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:00:43.637022: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:00:43.637391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:00:43.637420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:00:43.637445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:00:43.637472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:00:43.637498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:00:43.637523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:00:43.637549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:00:43.637575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:00:43.637602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:00:43.638309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:00:43.638337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:00:43.638349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:00:43.638357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:00:43.639069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [1.7966806e-05 5.1599685e-03 9.9253839e-01 3.3230374e-03 5.9932820e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [0.07758612 0.62732327 0.3443933  0.00982543 0.00441152]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [4.7706179e-03 8.6659354e-01 8.8077825e-01 2.0178074e-03 7.5808249e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [4.3346724e-03 8.8425112e-01 8.2472599e-01 3.9973403e-03 6.9215801e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [1.8323486e-05 5.1548621e-03 9.9223483e-01 3.4268866e-03 6.2089408e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [3 2 0 1 4] pred: [0.01878453 0.01741032 0.04408845 0.90761393 0.01677105]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [2.6185464e-03 8.4480423e-01 8.9181262e-01 1.5758257e-03 8.8272325e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [5.0378819e-03 8.6135298e-01 8.7737483e-01 2.1021012e-03 7.5691129e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [1.8347897e-05 5.1576509e-03 9.9233830e-01 3.4208554e-03 6.1674492e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [0.00719509 0.389446   0.5817732  0.05684536 0.00154893]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [1.7701981e-05 5.0911424e-03 9.9235052e-01 3.3165400e-03 5.9951242e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 2 0 1] pred: [0.01244097 0.00887358 0.05302264 0.84495264 0.05736277]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [4.5444118e-03 8.4465784e-01 9.1388220e-01 1.6253794e-03 6.1216386e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [1.7985922e-05 5.1565403e-03 9.9249518e-01 3.3400247e-03 6.0120557e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [2.3049948e-05 9.6060587e-03 9.8947489e-01 4.2660949e-03 5.8182288e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:35 - loss: 0.6962 - accuracy: 0.2422 3/11 [=======>......................] - ETA: 0s - loss: 0.6940 - accuracy: 0.2860   5/11 [============>.................] - ETA: 0s - loss: 0.6920 - accuracy: 0.3279 7/11 [==================>...........] - ETA: 0s - loss: 0.6900 - accuracy: 0.3497 9/11 [=======================>......] - ETA: 0s - loss: 0.6879 - accuracy: 0.365311/11 [==============================] - ETA: 0s - loss: 0.6858 - accuracy: 0.376211/11 [==============================] - 16s 30ms/step - loss: 0.6850 - accuracy: 0.3804
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6454 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.6433 - accuracy: 0.4262 5/11 [============>.................] - ETA: 0s - loss: 0.6392 - accuracy: 0.4335 7/11 [==================>...........] - ETA: 0s - loss: 0.6348 - accuracy: 0.4382 9/11 [=======================>......] - ETA: 0s - loss: 0.6301 - accuracy: 0.441111/11 [==============================] - ETA: 0s - loss: 0.6252 - accuracy: 0.443811/11 [==============================] - 0s 28ms/step - loss: 0.6232 - accuracy: 0.4448
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5097 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.5105 - accuracy: 0.4818 5/11 [============>.................] - ETA: 0s - loss: 0.5044 - accuracy: 0.4727 8/11 [====================>.........] - ETA: 0s - loss: 0.4935 - accuracy: 0.466010/11 [==========================>...] - ETA: 0s - loss: 0.4862 - accuracy: 0.462611/11 [==============================] - 0s 28ms/step - loss: 0.4795 - accuracy: 0.4615
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3821 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.3765 - accuracy: 0.4809 5/11 [============>.................] - ETA: 0s - loss: 0.3745 - accuracy: 0.4775 7/11 [==================>...........] - ETA: 0s - loss: 0.3731 - accuracy: 0.4745 9/11 [=======================>......] - ETA: 0s - loss: 0.3710 - accuracy: 0.471911/11 [==============================] - ETA: 0s - loss: 0.3695 - accuracy: 0.469311/11 [==============================] - 0s 28ms/step - loss: 0.3690 - accuracy: 0.4682
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3315 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.3303 - accuracy: 0.4757 5/11 [============>.................] - ETA: 0s - loss: 0.3332 - accuracy: 0.4744 7/11 [==================>...........] - ETA: 0s - loss: 0.3355 - accuracy: 0.4727 9/11 [=======================>......] - ETA: 0s - loss: 0.3368 - accuracy: 0.470611/11 [==============================] - 0s 29ms/step - loss: 0.3368 - accuracy: 0.4674
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3025 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.3125 - accuracy: 0.4918 5/11 [============>.................] - ETA: 0s - loss: 0.3167 - accuracy: 0.4734 7/11 [==================>...........] - ETA: 0s - loss: 0.3184 - accuracy: 0.464710/11 [==========================>...] - ETA: 0s - loss: 0.3176 - accuracy: 0.460511/11 [==============================] - 0s 28ms/step - loss: 0.3165 - accuracy: 0.4599
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2762 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.2793 - accuracy: 0.5013 5/11 [============>.................] - ETA: 0s - loss: 0.2820 - accuracy: 0.4924 7/11 [==================>...........] - ETA: 0s - loss: 0.2830 - accuracy: 0.4846 9/11 [=======================>......] - ETA: 0s - loss: 0.2841 - accuracy: 0.478611/11 [==============================] - 0s 28ms/step - loss: 0.2845 - accuracy: 0.4734
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2924 - accuracy: 0.3516 4/11 [=========>....................] - ETA: 0s - loss: 0.2851 - accuracy: 0.4142 6/11 [===============>..............] - ETA: 0s - loss: 0.2775 - accuracy: 0.4305 8/11 [====================>.........] - ETA: 0s - loss: 0.2733 - accuracy: 0.438710/11 [==========================>...] - ETA: 0s - loss: 0.2702 - accuracy: 0.443711/11 [==============================] - 0s 27ms/step - loss: 0.2683 - accuracy: 0.4463
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2310 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.2439 - accuracy: 0.4475 5/11 [============>.................] - ETA: 0s - loss: 0.2452 - accuracy: 0.4602 8/11 [====================>.........] - ETA: 0s - loss: 0.2431 - accuracy: 0.469510/11 [==========================>...] - ETA: 0s - loss: 0.2413 - accuracy: 0.474211/11 [==============================] - 0s 26ms/step - loss: 0.2401 - accuracy: 0.4773
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2390 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.2307 - accuracy: 0.4983 5/11 [============>.................] - ETA: 0s - loss: 0.2260 - accuracy: 0.5152 7/11 [==================>...........] - ETA: 0s - loss: 0.2241 - accuracy: 0.531010/11 [==========================>...] - ETA: 0s - loss: 0.2216 - accuracy: 0.547311/11 [==============================] - 0s 27ms/step - loss: 0.2200 - accuracy: 0.5544
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1942 - accuracy: 0.6172 3/11 [=======>......................] - ETA: 0s - loss: 0.1905 - accuracy: 0.6302 5/11 [============>.................] - ETA: 0s - loss: 0.1900 - accuracy: 0.6327 8/11 [====================>.........] - ETA: 0s - loss: 0.1912 - accuracy: 0.635210/11 [==========================>...] - ETA: 0s - loss: 0.1914 - accuracy: 0.638611/11 [==============================] - 0s 26ms/step - loss: 0.1914 - accuracy: 0.6407
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1948 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.1831 - accuracy: 0.6927 5/11 [============>.................] - ETA: 0s - loss: 0.1807 - accuracy: 0.6812 7/11 [==================>...........] - ETA: 0s - loss: 0.1797 - accuracy: 0.680110/11 [==========================>...] - ETA: 0s - loss: 0.1785 - accuracy: 0.683211/11 [==============================] - 0s 26ms/step - loss: 0.1780 - accuracy: 0.6872
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1655 - accuracy: 0.8281 3/11 [=======>......................] - ETA: 0s - loss: 0.1682 - accuracy: 0.7847 6/11 [===============>..............] - ETA: 0s - loss: 0.1653 - accuracy: 0.7809 8/11 [====================>.........] - ETA: 0s - loss: 0.1646 - accuracy: 0.786910/11 [==========================>...] - ETA: 0s - loss: 0.1639 - accuracy: 0.791711/11 [==============================] - 0s 27ms/step - loss: 0.1637 - accuracy: 0.7947
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1756 - accuracy: 0.6328 3/11 [=======>......................] - ETA: 0s - loss: 0.1702 - accuracy: 0.6402 5/11 [============>.................] - ETA: 0s - loss: 0.1656 - accuracy: 0.6661 7/11 [==================>...........] - ETA: 0s - loss: 0.1633 - accuracy: 0.6901 9/11 [=======================>......] - ETA: 0s - loss: 0.1615 - accuracy: 0.710811/11 [==============================] - ETA: 0s - loss: 0.1601 - accuracy: 0.725311/11 [==============================] - 0s 27ms/step - loss: 0.1595 - accuracy: 0.7310
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1460 - accuracy: 0.7656 4/11 [=========>....................] - ETA: 0s - loss: 0.1475 - accuracy: 0.7345 6/11 [===============>..............] - ETA: 0s - loss: 0.1456 - accuracy: 0.7513 8/11 [====================>.........] - ETA: 0s - loss: 0.1450 - accuracy: 0.767310/11 [==========================>...] - ETA: 0s - loss: 0.1442 - accuracy: 0.779311/11 [==============================] - 0s 28ms/step - loss: 0.1437 - accuracy: 0.7878
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1297 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 0s - loss: 0.1256 - accuracy: 0.8325 5/11 [============>.................] - ETA: 0s - loss: 0.1272 - accuracy: 0.8207 8/11 [====================>.........] - ETA: 0s - loss: 0.1292 - accuracy: 0.819510/11 [==========================>...] - ETA: 0s - loss: 0.1299 - accuracy: 0.819711/11 [==============================] - 0s 27ms/step - loss: 0.1301 - accuracy: 0.8206
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1347 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.1257 - accuracy: 0.8950 5/11 [============>.................] - ETA: 0s - loss: 0.1244 - accuracy: 0.9017 7/11 [==================>...........] - ETA: 0s - loss: 0.1249 - accuracy: 0.9025 9/11 [=======================>......] - ETA: 0s - loss: 0.1248 - accuracy: 0.900911/11 [==============================] - ETA: 0s - loss: 0.1248 - accuracy: 0.897011/11 [==============================] - 0s 27ms/step - loss: 0.1247 - accuracy: 0.8955
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1054 - accuracy: 0.9062 3/11 [=======>......................] - ETA: 0s - loss: 0.1129 - accuracy: 0.9145 5/11 [============>.................] - ETA: 0s - loss: 0.1138 - accuracy: 0.9206 7/11 [==================>...........] - ETA: 0s - loss: 0.1145 - accuracy: 0.9220 9/11 [=======================>......] - ETA: 0s - loss: 0.1148 - accuracy: 0.920311/11 [==============================] - 0s 26ms/step - loss: 0.1153 - accuracy: 0.9181
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1123 - accuracy: 0.9375 3/11 [=======>......................] - ETA: 0s - loss: 0.1112 - accuracy: 0.9379 5/11 [============>.................] - ETA: 0s - loss: 0.1120 - accuracy: 0.9299 8/11 [====================>.........] - ETA: 0s - loss: 0.1116 - accuracy: 0.923910/11 [==========================>...] - ETA: 0s - loss: 0.1110 - accuracy: 0.923111/11 [==============================] - 0s 27ms/step - loss: 0.1106 - accuracy: 0.9225
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1013 - accuracy: 0.9219 3/11 [=======>......................] - ETA: 0s - loss: 0.1053 - accuracy: 0.9223 5/11 [============>.................] - ETA: 0s - loss: 0.1064 - accuracy: 0.9200 7/11 [==================>...........] - ETA: 0s - loss: 0.1063 - accuracy: 0.9217 9/11 [=======================>......] - ETA: 0s - loss: 0.1057 - accuracy: 0.923311/11 [==============================] - 0s 27ms/step - loss: 0.1048 - accuracy: 0.9250
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.0912 - accuracy: 0.92196/6 [==============================] - ETA: 0s - loss: 0.1079 - accuracy: 0.9065 6/6 [==============================] - 5s 11ms/step - loss: 0.1079 - accuracy: 0.9065
2021-12-14 00:01:21.029663: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:01:21.030643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:01:21.030735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:01:21.030814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:01:21.030863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:01:21.030937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:01:21.031001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:01:21.031067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:01:21.031128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:01:21.031196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:01:21.032252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:01:21.032323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:01:21.032346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:01:21.032360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:01:21.033421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:01:21.033869: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:01:21.034416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:01:21.034460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:01:21.034500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:01:21.034545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:01:21.034588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:01:21.034633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:01:21.034677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:01:21.034721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:01:21.034764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:01:21.035742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:01:21.035786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:01:21.035803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:01:21.035818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:01:21.036851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 3 0 4] pred: [5.2453708e-03 9.4839126e-01 7.9428577e-01 5.3929789e-03 3.7424330e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 3 0 4] pred: [4.0403600e-03 9.2734736e-01 8.5227269e-01 4.4866442e-03 2.6636079e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [0.02010616 0.92199165 0.524016   0.00955521 0.00102899]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [0 1 2 4 3] pred: [0.71396893 0.3074393  0.11900939 0.04639836 0.06901754]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [5.2790518e-04 4.2069475e-03 9.8808914e-01 3.3774341e-03 6.2377156e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 2 4 3] pred: [0.72042    0.31733721 0.11041816 0.04062858 0.05512043]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 3 0 4] pred: [4.0136678e-03 9.5481086e-01 8.3560550e-01 4.3240841e-03 3.2946101e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [5.0654489e-04 1.6812069e-02 9.7694176e-01 3.1259020e-03 7.5474221e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 3 0 4] pred: [4.0378417e-03 9.5228076e-01 8.3144784e-01 4.4798171e-03 3.2599788e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [4.8223848e-04 6.0669580e-03 9.8643315e-01 3.2085460e-03 6.7615460e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [2.5053418e-03 8.6035240e-01 9.0633440e-01 3.1210869e-03 1.9087559e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [2.4187947e-03 8.1333178e-01 8.8742888e-01 3.7482381e-03 2.4872454e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 0 4] pred: [5.1179575e-04 2.8608919e-03 9.9025273e-01 5.1339897e-03 7.1741815e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [3 2 4 1 0] pred: [0.00741077 0.02509042 0.20669843 0.795067   0.06811009]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [0.09572499 0.7321023  0.30741256 0.01473935 0.0017937 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:33 - loss: 0.6939 - accuracy: 0.1719 3/11 [=======>......................] - ETA: 0s - loss: 0.6921 - accuracy: 0.2778   5/11 [============>.................] - ETA: 0s - loss: 0.6903 - accuracy: 0.3268 7/11 [==================>...........] - ETA: 0s - loss: 0.6885 - accuracy: 0.3569 9/11 [=======================>......] - ETA: 0s - loss: 0.6866 - accuracy: 0.372311/11 [==============================] - ETA: 0s - loss: 0.6847 - accuracy: 0.382911/11 [==============================] - 16s 28ms/step - loss: 0.6839 - accuracy: 0.3868
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6433 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.6402 - accuracy: 0.5221 6/11 [===============>..............] - ETA: 0s - loss: 0.6357 - accuracy: 0.4997 8/11 [====================>.........] - ETA: 0s - loss: 0.6323 - accuracy: 0.489210/11 [==========================>...] - ETA: 0s - loss: 0.6284 - accuracy: 0.482911/11 [==============================] - 0s 27ms/step - loss: 0.6246 - accuracy: 0.4792
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5208 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.5149 - accuracy: 0.4905 5/11 [============>.................] - ETA: 0s - loss: 0.5073 - accuracy: 0.4862 7/11 [==================>...........] - ETA: 0s - loss: 0.5001 - accuracy: 0.478210/11 [==========================>...] - ETA: 0s - loss: 0.4882 - accuracy: 0.472711/11 [==============================] - 0s 28ms/step - loss: 0.4824 - accuracy: 0.4707
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4077 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3998 - accuracy: 0.4518 5/11 [============>.................] - ETA: 0s - loss: 0.3944 - accuracy: 0.4505 7/11 [==================>...........] - ETA: 0s - loss: 0.3898 - accuracy: 0.4536 9/11 [=======================>......] - ETA: 0s - loss: 0.3864 - accuracy: 0.453611/11 [==============================] - 0s 28ms/step - loss: 0.3821 - accuracy: 0.4552
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3272 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.3308 - accuracy: 0.4601 5/11 [============>.................] - ETA: 0s - loss: 0.3383 - accuracy: 0.4550 7/11 [==================>...........] - ETA: 0s - loss: 0.3391 - accuracy: 0.4571 9/11 [=======================>......] - ETA: 0s - loss: 0.3390 - accuracy: 0.457411/11 [==============================] - ETA: 0s - loss: 0.3386 - accuracy: 0.458111/11 [==============================] - 0s 28ms/step - loss: 0.3385 - accuracy: 0.4583
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3464 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.3343 - accuracy: 0.4314 5/11 [============>.................] - ETA: 0s - loss: 0.3293 - accuracy: 0.4384 7/11 [==================>...........] - ETA: 0s - loss: 0.3247 - accuracy: 0.4454 9/11 [=======================>......] - ETA: 0s - loss: 0.3210 - accuracy: 0.450311/11 [==============================] - ETA: 0s - loss: 0.3187 - accuracy: 0.452111/11 [==============================] - 0s 29ms/step - loss: 0.3178 - accuracy: 0.4529
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2940 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.2840 - accuracy: 0.4423 5/11 [============>.................] - ETA: 0s - loss: 0.2804 - accuracy: 0.4487 7/11 [==================>...........] - ETA: 0s - loss: 0.2790 - accuracy: 0.4540 9/11 [=======================>......] - ETA: 0s - loss: 0.2781 - accuracy: 0.457011/11 [==============================] - ETA: 0s - loss: 0.2769 - accuracy: 0.458611/11 [==============================] - 0s 28ms/step - loss: 0.2763 - accuracy: 0.4592
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2206 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.2311 - accuracy: 0.4909 5/11 [============>.................] - ETA: 0s - loss: 0.2356 - accuracy: 0.4808 7/11 [==================>...........] - ETA: 0s - loss: 0.2365 - accuracy: 0.4814 9/11 [=======================>......] - ETA: 0s - loss: 0.2370 - accuracy: 0.483911/11 [==============================] - 0s 28ms/step - loss: 0.2367 - accuracy: 0.4888
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2419 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.2349 - accuracy: 0.5530 5/11 [============>.................] - ETA: 0s - loss: 0.2297 - accuracy: 0.5589 7/11 [==================>...........] - ETA: 0s - loss: 0.2267 - accuracy: 0.5585 9/11 [=======================>......] - ETA: 0s - loss: 0.2239 - accuracy: 0.562011/11 [==============================] - ETA: 0s - loss: 0.2217 - accuracy: 0.567411/11 [==============================] - 0s 28ms/step - loss: 0.2208 - accuracy: 0.5697
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2049 - accuracy: 0.7031 3/11 [=======>......................] - ETA: 0s - loss: 0.2019 - accuracy: 0.7044 5/11 [============>.................] - ETA: 0s - loss: 0.1992 - accuracy: 0.6904 7/11 [==================>...........] - ETA: 0s - loss: 0.1980 - accuracy: 0.6752 9/11 [=======================>......] - ETA: 0s - loss: 0.1967 - accuracy: 0.666711/11 [==============================] - ETA: 0s - loss: 0.1959 - accuracy: 0.662911/11 [==============================] - 0s 29ms/step - loss: 0.1955 - accuracy: 0.6617
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1798 - accuracy: 0.7031 3/11 [=======>......................] - ETA: 0s - loss: 0.1814 - accuracy: 0.7044 5/11 [============>.................] - ETA: 0s - loss: 0.1783 - accuracy: 0.7020 7/11 [==================>...........] - ETA: 0s - loss: 0.1786 - accuracy: 0.6914 9/11 [=======================>......] - ETA: 0s - loss: 0.1786 - accuracy: 0.686311/11 [==============================] - 0s 28ms/step - loss: 0.1782 - accuracy: 0.6854
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1719 - accuracy: 0.7109 3/11 [=======>......................] - ETA: 0s - loss: 0.1750 - accuracy: 0.7057 5/11 [============>.................] - ETA: 0s - loss: 0.1739 - accuracy: 0.7024 7/11 [==================>...........] - ETA: 0s - loss: 0.1728 - accuracy: 0.6978 9/11 [=======================>......] - ETA: 0s - loss: 0.1717 - accuracy: 0.697511/11 [==============================] - ETA: 0s - loss: 0.1707 - accuracy: 0.698111/11 [==============================] - 0s 28ms/step - loss: 0.1703 - accuracy: 0.6984
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1553 - accuracy: 0.7109 3/11 [=======>......................] - ETA: 0s - loss: 0.1570 - accuracy: 0.6871 5/11 [============>.................] - ETA: 0s - loss: 0.1551 - accuracy: 0.6894 7/11 [==================>...........] - ETA: 0s - loss: 0.1545 - accuracy: 0.6940 9/11 [=======================>......] - ETA: 0s - loss: 0.1542 - accuracy: 0.697911/11 [==============================] - ETA: 0s - loss: 0.1541 - accuracy: 0.702311/11 [==============================] - 0s 30ms/step - loss: 0.1541 - accuracy: 0.7040
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1532 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.1545 - accuracy: 0.7148 5/11 [============>.................] - ETA: 0s - loss: 0.1506 - accuracy: 0.7271 7/11 [==================>...........] - ETA: 0s - loss: 0.1486 - accuracy: 0.734410/11 [==========================>...] - ETA: 0s - loss: 0.1475 - accuracy: 0.737811/11 [==============================] - 0s 28ms/step - loss: 0.1473 - accuracy: 0.7379
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1429 - accuracy: 0.7266 3/11 [=======>......................] - ETA: 0s - loss: 0.1469 - accuracy: 0.7422 5/11 [============>.................] - ETA: 0s - loss: 0.1466 - accuracy: 0.7538 7/11 [==================>...........] - ETA: 0s - loss: 0.1453 - accuracy: 0.7627 9/11 [=======================>......] - ETA: 0s - loss: 0.1446 - accuracy: 0.766611/11 [==============================] - ETA: 0s - loss: 0.1438 - accuracy: 0.766611/11 [==============================] - 0s 29ms/step - loss: 0.1435 - accuracy: 0.7666
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1180 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.1231 - accuracy: 0.7448 5/11 [============>.................] - ETA: 0s - loss: 0.1268 - accuracy: 0.7419 7/11 [==================>...........] - ETA: 0s - loss: 0.1279 - accuracy: 0.7414 9/11 [=======================>......] - ETA: 0s - loss: 0.1293 - accuracy: 0.740611/11 [==============================] - 0s 29ms/step - loss: 0.1307 - accuracy: 0.7415
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1206 - accuracy: 0.8594 3/11 [=======>......................] - ETA: 0s - loss: 0.1230 - accuracy: 0.8637 5/11 [============>.................] - ETA: 0s - loss: 0.1253 - accuracy: 0.8626 7/11 [==================>...........] - ETA: 0s - loss: 0.1265 - accuracy: 0.8550 9/11 [=======================>......] - ETA: 0s - loss: 0.1271 - accuracy: 0.845711/11 [==============================] - ETA: 0s - loss: 0.1271 - accuracy: 0.837411/11 [==============================] - 0s 28ms/step - loss: 0.1272 - accuracy: 0.8342
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1141 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.1216 - accuracy: 0.7921 5/11 [============>.................] - ETA: 0s - loss: 0.1232 - accuracy: 0.8055 7/11 [==================>...........] - ETA: 0s - loss: 0.1237 - accuracy: 0.8147 9/11 [=======================>......] - ETA: 0s - loss: 0.1236 - accuracy: 0.817211/11 [==============================] - 0s 28ms/step - loss: 0.1236 - accuracy: 0.8159
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1054 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.1085 - accuracy: 0.8299 5/11 [============>.................] - ETA: 0s - loss: 0.1104 - accuracy: 0.8353 7/11 [==================>...........] - ETA: 0s - loss: 0.1125 - accuracy: 0.8406 9/11 [=======================>......] - ETA: 0s - loss: 0.1142 - accuracy: 0.842211/11 [==============================] - 0s 28ms/step - loss: 0.1151 - accuracy: 0.8408
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1017 - accuracy: 0.7891 4/11 [=========>....................] - ETA: 0s - loss: 0.1162 - accuracy: 0.7747 6/11 [===============>..............] - ETA: 0s - loss: 0.1153 - accuracy: 0.7900 8/11 [====================>.........] - ETA: 0s - loss: 0.1150 - accuracy: 0.801110/11 [==========================>...] - ETA: 0s - loss: 0.1147 - accuracy: 0.809611/11 [==============================] - 0s 29ms/step - loss: 0.1146 - accuracy: 0.8144
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1189 - accuracy: 0.76566/6 [==============================] - ETA: 0s - loss: 0.1194 - accuracy: 0.7946 6/6 [==============================] - 5s 11ms/step - loss: 0.1194 - accuracy: 0.7946
2021-12-14 00:01:58.715829: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:01:58.716681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:01:58.716758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:01:58.716815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:01:58.716857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:01:58.716907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:01:58.716969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:01:58.717021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:01:58.717067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:01:58.717119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:01:58.718120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:01:58.718181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:01:58.718199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:01:58.718215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:01:58.719304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:01:58.719769: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:01:58.720317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:01:58.720362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:01:58.720403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:01:58.720443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:01:58.720483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:01:58.720525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:01:58.720565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:01:58.720608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:01:58.720647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:01:58.721665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:01:58.721708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:01:58.721726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:01:58.721739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:01:58.722829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 4 3 0] pred: [7.8309875e-04 9.4977599e-03 9.7241569e-01 1.0924372e-03 2.7814885e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [0 1 2 3 4] pred: [0.66928357 0.33554932 0.05160401 0.04585661 0.02580884]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 3 0] pred: [1.0664058e-04 8.3087822e-03 9.8893905e-01 1.9067563e-03 2.1113639e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [0 1 3 2 4] pred: [0.6450462  0.3143145  0.05321021 0.06352583 0.02925994]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [1.10768444e-04 6.21602638e-03 9.87812936e-01 3.56788863e-03
 2.29648571e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 4 0] pred: [9.1843918e-05 7.4009150e-03 9.9080127e-01 2.4532403e-03 2.0176731e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [0 1 2 3 4] pred: [0.5385743  0.33155477 0.06804724 0.06344217 0.02631944]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [0.00401893 0.85420907 0.8677562  0.0020179  0.00136126]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [9.1693313e-05 7.4281124e-03 9.9079776e-01 2.4589170e-03 2.0138496e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [0.00125916 0.7653992  0.94690746 0.0027892  0.00102839]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [3 4 2 0 1] pred: [0.04759965 0.017746   0.14721273 0.6681378  0.43493053]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [0.00185796 0.5379822  0.92682654 0.00756861 0.00170199]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [0.0018037  0.8227511  0.9321114  0.00129855 0.00103719]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [0.00376877 0.866053   0.8671095  0.00455857 0.00135352]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [0.01133925 0.47829035 0.64869267 0.03779532 0.00568538]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:43 - loss: 0.6921 - accuracy: 0.1875 3/11 [=======>......................] - ETA: 0s - loss: 0.6902 - accuracy: 0.2513   5/11 [============>.................] - ETA: 0s - loss: 0.6883 - accuracy: 0.2869 7/11 [==================>...........] - ETA: 0s - loss: 0.6863 - accuracy: 0.312710/11 [==========================>...] - ETA: 0s - loss: 0.6830 - accuracy: 0.339411/11 [==============================] - 17s 26ms/step - loss: 0.6811 - accuracy: 0.3517
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6421 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.6379 - accuracy: 0.4501 5/11 [============>.................] - ETA: 0s - loss: 0.6334 - accuracy: 0.4579 7/11 [==================>...........] - ETA: 0s - loss: 0.6291 - accuracy: 0.4588 9/11 [=======================>......] - ETA: 0s - loss: 0.6247 - accuracy: 0.460211/11 [==============================] - ETA: 0s - loss: 0.6201 - accuracy: 0.459111/11 [==============================] - 0s 28ms/step - loss: 0.6182 - accuracy: 0.4586
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5254 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.5088 - accuracy: 0.4569 6/11 [===============>..............] - ETA: 0s - loss: 0.5000 - accuracy: 0.4533 8/11 [====================>.........] - ETA: 0s - loss: 0.4917 - accuracy: 0.451910/11 [==========================>...] - ETA: 0s - loss: 0.4829 - accuracy: 0.451211/11 [==============================] - 0s 27ms/step - loss: 0.4754 - accuracy: 0.4516
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3779 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.3752 - accuracy: 0.4132 5/11 [============>.................] - ETA: 0s - loss: 0.3706 - accuracy: 0.4221 7/11 [==================>...........] - ETA: 0s - loss: 0.3673 - accuracy: 0.4295 9/11 [=======================>......] - ETA: 0s - loss: 0.3641 - accuracy: 0.435011/11 [==============================] - 0s 27ms/step - loss: 0.3618 - accuracy: 0.4396
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3839 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.3608 - accuracy: 0.4715 6/11 [===============>..............] - ETA: 0s - loss: 0.3542 - accuracy: 0.4711 9/11 [=======================>......] - ETA: 0s - loss: 0.3494 - accuracy: 0.467911/11 [==============================] - 0s 26ms/step - loss: 0.3473 - accuracy: 0.4641
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3108 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.3243 - accuracy: 0.4722 6/11 [===============>..............] - ETA: 0s - loss: 0.3226 - accuracy: 0.4709 8/11 [====================>.........] - ETA: 0s - loss: 0.3236 - accuracy: 0.468010/11 [==========================>...] - ETA: 0s - loss: 0.3233 - accuracy: 0.465811/11 [==============================] - 0s 28ms/step - loss: 0.3226 - accuracy: 0.4643
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3177 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.3178 - accuracy: 0.4392 6/11 [===============>..............] - ETA: 0s - loss: 0.3148 - accuracy: 0.4343 8/11 [====================>.........] - ETA: 0s - loss: 0.3126 - accuracy: 0.433810/11 [==========================>...] - ETA: 0s - loss: 0.3094 - accuracy: 0.438111/11 [==============================] - 0s 26ms/step - loss: 0.3068 - accuracy: 0.4422
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2810 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.2755 - accuracy: 0.4544 6/11 [===============>..............] - ETA: 0s - loss: 0.2738 - accuracy: 0.4584 9/11 [=======================>......] - ETA: 0s - loss: 0.2717 - accuracy: 0.463911/11 [==============================] - 0s 25ms/step - loss: 0.2699 - accuracy: 0.4661
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2351 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.2275 - accuracy: 0.4887 5/11 [============>.................] - ETA: 0s - loss: 0.2294 - accuracy: 0.4845 7/11 [==================>...........] - ETA: 0s - loss: 0.2311 - accuracy: 0.4866 9/11 [=======================>......] - ETA: 0s - loss: 0.2320 - accuracy: 0.487311/11 [==============================] - 0s 26ms/step - loss: 0.2315 - accuracy: 0.4892
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2018 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.2100 - accuracy: 0.5469 5/11 [============>.................] - ETA: 0s - loss: 0.2113 - accuracy: 0.5400 8/11 [====================>.........] - ETA: 0s - loss: 0.2105 - accuracy: 0.549810/11 [==========================>...] - ETA: 0s - loss: 0.2092 - accuracy: 0.554211/11 [==============================] - 0s 27ms/step - loss: 0.2079 - accuracy: 0.5587
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1978 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.1943 - accuracy: 0.5907 5/11 [============>.................] - ETA: 0s - loss: 0.1914 - accuracy: 0.6033 7/11 [==================>...........] - ETA: 0s - loss: 0.1896 - accuracy: 0.6128 9/11 [=======================>......] - ETA: 0s - loss: 0.1888 - accuracy: 0.623111/11 [==============================] - ETA: 0s - loss: 0.1874 - accuracy: 0.632211/11 [==============================] - 0s 28ms/step - loss: 0.1867 - accuracy: 0.6358
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1628 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.1681 - accuracy: 0.7096 5/11 [============>.................] - ETA: 0s - loss: 0.1690 - accuracy: 0.7152 7/11 [==================>...........] - ETA: 0s - loss: 0.1685 - accuracy: 0.7194 9/11 [=======================>......] - ETA: 0s - loss: 0.1672 - accuracy: 0.720111/11 [==============================] - ETA: 0s - loss: 0.1663 - accuracy: 0.719211/11 [==============================] - 0s 28ms/step - loss: 0.1660 - accuracy: 0.7189
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1487 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.1497 - accuracy: 0.7400 5/11 [============>.................] - ETA: 0s - loss: 0.1482 - accuracy: 0.7515 7/11 [==================>...........] - ETA: 0s - loss: 0.1481 - accuracy: 0.7540 9/11 [=======================>......] - ETA: 0s - loss: 0.1483 - accuracy: 0.753011/11 [==============================] - 0s 28ms/step - loss: 0.1487 - accuracy: 0.7528
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1494 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.1488 - accuracy: 0.8099 5/11 [============>.................] - ETA: 0s - loss: 0.1475 - accuracy: 0.8077 7/11 [==================>...........] - ETA: 0s - loss: 0.1461 - accuracy: 0.8106 9/11 [=======================>......] - ETA: 0s - loss: 0.1452 - accuracy: 0.809911/11 [==============================] - 0s 28ms/step - loss: 0.1438 - accuracy: 0.8092
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1348 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.1343 - accuracy: 0.7389 6/11 [===============>..............] - ETA: 0s - loss: 0.1344 - accuracy: 0.7423 8/11 [====================>.........] - ETA: 0s - loss: 0.1338 - accuracy: 0.751011/11 [==============================] - ETA: 0s - loss: 0.1331 - accuracy: 0.764711/11 [==============================] - 0s 25ms/step - loss: 0.1328 - accuracy: 0.7679
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1400 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.1329 - accuracy: 0.7756 6/11 [===============>..............] - ETA: 0s - loss: 0.1293 - accuracy: 0.7854 9/11 [=======================>......] - ETA: 0s - loss: 0.1267 - accuracy: 0.794111/11 [==============================] - ETA: 0s - loss: 0.1257 - accuracy: 0.797611/11 [==============================] - 0s 26ms/step - loss: 0.1253 - accuracy: 0.7988
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1108 - accuracy: 0.8281 3/11 [=======>......................] - ETA: 0s - loss: 0.1117 - accuracy: 0.8121 5/11 [============>.................] - ETA: 0s - loss: 0.1122 - accuracy: 0.8172 7/11 [==================>...........] - ETA: 0s - loss: 0.1125 - accuracy: 0.8210 9/11 [=======================>......] - ETA: 0s - loss: 0.1131 - accuracy: 0.819711/11 [==============================] - 0s 27ms/step - loss: 0.1136 - accuracy: 0.8192
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1108 - accuracy: 0.8984 3/11 [=======>......................] - ETA: 0s - loss: 0.1147 - accuracy: 0.9045 5/11 [============>.................] - ETA: 0s - loss: 0.1150 - accuracy: 0.8990 7/11 [==================>...........] - ETA: 0s - loss: 0.1143 - accuracy: 0.8916 9/11 [=======================>......] - ETA: 0s - loss: 0.1131 - accuracy: 0.885911/11 [==============================] - 0s 28ms/step - loss: 0.1117 - accuracy: 0.8798
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1252 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.1113 - accuracy: 0.8194 5/11 [============>.................] - ETA: 0s - loss: 0.1061 - accuracy: 0.8447 7/11 [==================>...........] - ETA: 0s - loss: 0.1042 - accuracy: 0.8561 9/11 [=======================>......] - ETA: 0s - loss: 0.1039 - accuracy: 0.860911/11 [==============================] - 0s 26ms/step - loss: 0.1039 - accuracy: 0.8604
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1019 - accuracy: 0.7891 4/11 [=========>....................] - ETA: 0s - loss: 0.0982 - accuracy: 0.8379 7/11 [==================>...........] - ETA: 0s - loss: 0.0990 - accuracy: 0.8630 9/11 [=======================>......] - ETA: 0s - loss: 0.0992 - accuracy: 0.871311/11 [==============================] - ETA: 0s - loss: 0.0993 - accuracy: 0.873111/11 [==============================] - 0s 27ms/step - loss: 0.0994 - accuracy: 0.8736
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1132 - accuracy: 0.81256/6 [==============================] - ETA: 0s - loss: 0.1019 - accuracy: 0.8414 6/6 [==============================] - 5s 11ms/step - loss: 0.1019 - accuracy: 0.8414
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 0 2 1] pred: [0.07926432 0.00456613 0.02939975 0.6328607  0.59508085]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [3.3024144e-03 8.7824619e-01 9.1695189e-01 1.4095368e-03 7.0241746e-05]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [2.3184172e-03 8.4826559e-01 9.5072687e-01 1.6065883e-03 3.6093301e-05]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 1 0 4] pred: [1.9551469e-04 4.3333946e-03 9.8631960e-01 7.3284963e-03 1.9261480e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [6.6952636e-03 9.5404774e-01 8.6520392e-01 1.3267392e-03 6.8640948e-05]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [3 2 4 0 1] pred: [0.00717652 0.00490854 0.09120661 0.8265318  0.05616031]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [7.620460e-03 8.797847e-01 7.579106e-01 2.620648e-03 5.002561e-05]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [2.2987034e-03 8.4466195e-01 9.5053607e-01 1.6339446e-03 3.5846460e-05]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [0 1 4 2 3] pred: [0.77855265 0.2322624  0.06120588 0.02620926 0.06698437]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 0 4] pred: [2.2310323e-04 4.2497516e-03 9.8265839e-01 8.0581186e-03 1.8688836e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [0.10027095 0.78019017 0.13172399 0.00376643 0.00084556]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [1.1823542e-03 2.7950710e-01 9.3732929e-01 3.5059466e-03 2.9844266e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 0 4] pred: [2.0622672e-04 5.4207160e-03 9.8405105e-01 6.8013733e-03 1.6879223e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [2.1783188e-04 8.6042769e-03 9.8678398e-01 5.6545357e-03 2.7933207e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [8.3098076e-03 9.2247969e-01 7.9158211e-01 1.8745180e-03 1.0469661e-04]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
Job end at mar déc 14 00:02:37 CET 2021
