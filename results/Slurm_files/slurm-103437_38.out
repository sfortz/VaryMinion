
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at mar déc 14 00:01:22 CET 2021
2021-12-14 00:01:22.784513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-14 00:01:28.365175: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:01:28.367686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-14 00:01:28.384515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:01:28.384565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:01:28.389739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:01:28.389810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:01:28.393491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:01:28.394644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:01:28.399023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:01:28.401440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:01:28.409867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:01:28.411541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:01:28.449863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:01:28.449903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:01:28.449917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:01:29.992774: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:01:29.993617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:01:29.993664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:01:29.993699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:01:29.993730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:01:29.993754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:01:29.993779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:01:29.993804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:01:29.993829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:01:29.993854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:01:29.994981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:01:29.995707: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:01:29.995729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:01:29.995739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2021-12-14 00:01:29.995824: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-14 00:01:33.065621: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-14 00:01:33.066206: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2593595000 Hz
Number of possible configurations: 40
Begining exécution of the 38 th configuration: BPIC20.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, sigmoid as activation function and mse as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 58)          3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                21360     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:58 - loss: 0.2507 - accuracy: 0.1172 2/11 [====>.........................] - ETA: 0s - loss: 0.2502 - accuracy: 0.1699   3/11 [=======>......................] - ETA: 0s - loss: 0.2497 - accuracy: 0.2131 4/11 [=========>....................] - ETA: 0s - loss: 0.2493 - accuracy: 0.2428 5/11 [============>.................] - ETA: 0s - loss: 0.2488 - accuracy: 0.2624 6/11 [===============>..............] - ETA: 0s - loss: 0.2483 - accuracy: 0.2790 7/11 [==================>...........] - ETA: 0s - loss: 0.2479 - accuracy: 0.2924 8/11 [====================>.........] - ETA: 0s - loss: 0.2474 - accuracy: 0.3041 9/11 [=======================>......] - ETA: 0s - loss: 0.2469 - accuracy: 0.314310/11 [==========================>...] - ETA: 0s - loss: 0.2464 - accuracy: 0.323511/11 [==============================] - ETA: 0s - loss: 0.2460 - accuracy: 0.331611/11 [==============================] - 13s 95ms/step - loss: 0.2456 - accuracy: 0.3384
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2297 - accuracy: 0.3750 2/11 [====>.........................] - ETA: 0s - loss: 0.2280 - accuracy: 0.4160 3/11 [=======>......................] - ETA: 0s - loss: 0.2269 - accuracy: 0.4240 4/11 [=========>....................] - ETA: 0s - loss: 0.2259 - accuracy: 0.4328 5/11 [============>.................] - ETA: 0s - loss: 0.2249 - accuracy: 0.4384 6/11 [===============>..............] - ETA: 0s - loss: 0.2240 - accuracy: 0.4396 7/11 [==================>...........] - ETA: 0s - loss: 0.2231 - accuracy: 0.4417 8/11 [====================>.........] - ETA: 0s - loss: 0.2221 - accuracy: 0.4435 9/11 [=======================>......] - ETA: 0s - loss: 0.2211 - accuracy: 0.444810/11 [==========================>...] - ETA: 0s - loss: 0.2200 - accuracy: 0.446511/11 [==============================] - ETA: 0s - loss: 0.2190 - accuracy: 0.447811/11 [==============================] - 1s 98ms/step - loss: 0.2181 - accuracy: 0.4488
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1754 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.1749 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.1738 - accuracy: 0.4653 4/11 [=========>....................] - ETA: 0s - loss: 0.1726 - accuracy: 0.4627 5/11 [============>.................] - ETA: 0s - loss: 0.1710 - accuracy: 0.4630 6/11 [===============>..............] - ETA: 0s - loss: 0.1695 - accuracy: 0.4618 7/11 [==================>...........] - ETA: 0s - loss: 0.1678 - accuracy: 0.4604 8/11 [====================>.........] - ETA: 0s - loss: 0.1661 - accuracy: 0.4597 9/11 [=======================>......] - ETA: 0s - loss: 0.1642 - accuracy: 0.459710/11 [==========================>...] - ETA: 0s - loss: 0.1625 - accuracy: 0.460011/11 [==============================] - ETA: 0s - loss: 0.1608 - accuracy: 0.460111/11 [==============================] - 1s 98ms/step - loss: 0.1595 - accuracy: 0.4601
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1054 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.1097 - accuracy: 0.4863 3/11 [=======>......................] - ETA: 0s - loss: 0.1123 - accuracy: 0.4761 4/11 [=========>....................] - ETA: 0s - loss: 0.1138 - accuracy: 0.4723 5/11 [============>.................] - ETA: 0s - loss: 0.1143 - accuracy: 0.4732 6/11 [===============>..............] - ETA: 0s - loss: 0.1151 - accuracy: 0.4722 7/11 [==================>...........] - ETA: 0s - loss: 0.1156 - accuracy: 0.4717 8/11 [====================>.........] - ETA: 0s - loss: 0.1160 - accuracy: 0.4709 9/11 [=======================>......] - ETA: 0s - loss: 0.1162 - accuracy: 0.470010/11 [==========================>...] - ETA: 0s - loss: 0.1164 - accuracy: 0.468811/11 [==============================] - ETA: 0s - loss: 0.1165 - accuracy: 0.468111/11 [==============================] - 1s 99ms/step - loss: 0.1166 - accuracy: 0.4674
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1136 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.1149 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 0s - loss: 0.1149 - accuracy: 0.4692 4/11 [=========>....................] - ETA: 0s - loss: 0.1144 - accuracy: 0.4720 5/11 [============>.................] - ETA: 0s - loss: 0.1144 - accuracy: 0.4704 6/11 [===============>..............] - ETA: 0s - loss: 0.1140 - accuracy: 0.4697 7/11 [==================>...........] - ETA: 0s - loss: 0.1139 - accuracy: 0.4675 8/11 [====================>.........] - ETA: 0s - loss: 0.1136 - accuracy: 0.4664 9/11 [=======================>......] - ETA: 0s - loss: 0.1133 - accuracy: 0.465610/11 [==========================>...] - ETA: 0s - loss: 0.1130 - accuracy: 0.465411/11 [==============================] - ETA: 0s - loss: 0.1128 - accuracy: 0.465011/11 [==============================] - 1s 102ms/step - loss: 0.1125 - accuracy: 0.4646
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0968 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.0989 - accuracy: 0.5020 3/11 [=======>......................] - ETA: 0s - loss: 0.1003 - accuracy: 0.4978 4/11 [=========>....................] - ETA: 0s - loss: 0.1014 - accuracy: 0.4954 5/11 [============>.................] - ETA: 0s - loss: 0.1022 - accuracy: 0.4898 6/11 [===============>..............] - ETA: 0s - loss: 0.1028 - accuracy: 0.4845 7/11 [==================>...........] - ETA: 0s - loss: 0.1031 - accuracy: 0.4810 8/11 [====================>.........] - ETA: 0s - loss: 0.1033 - accuracy: 0.4778 9/11 [=======================>......] - ETA: 0s - loss: 0.1034 - accuracy: 0.475310/11 [==========================>...] - ETA: 0s - loss: 0.1036 - accuracy: 0.473211/11 [==============================] - ETA: 0s - loss: 0.1036 - accuracy: 0.472011/11 [==============================] - 1s 101ms/step - loss: 0.1037 - accuracy: 0.4711
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1023 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.1037 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.1025 - accuracy: 0.4418 4/11 [=========>....................] - ETA: 0s - loss: 0.1019 - accuracy: 0.4383 5/11 [============>.................] - ETA: 0s - loss: 0.1016 - accuracy: 0.4378 6/11 [===============>..............] - ETA: 0s - loss: 0.1010 - accuracy: 0.4402 7/11 [==================>...........] - ETA: 0s - loss: 0.1006 - accuracy: 0.4419 8/11 [====================>.........] - ETA: 0s - loss: 0.1002 - accuracy: 0.4435 9/11 [=======================>......] - ETA: 0s - loss: 0.1000 - accuracy: 0.445110/11 [==========================>...] - ETA: 0s - loss: 0.0997 - accuracy: 0.446811/11 [==============================] - ETA: 0s - loss: 0.0993 - accuracy: 0.448311/11 [==============================] - 1s 96ms/step - loss: 0.0990 - accuracy: 0.4495
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0945 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.0952 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.0958 - accuracy: 0.4696 4/11 [=========>....................] - ETA: 0s - loss: 0.0950 - accuracy: 0.4694 5/11 [============>.................] - ETA: 0s - loss: 0.0944 - accuracy: 0.4668 6/11 [===============>..............] - ETA: 0s - loss: 0.0937 - accuracy: 0.4647 7/11 [==================>...........] - ETA: 0s - loss: 0.0931 - accuracy: 0.4637 8/11 [====================>.........] - ETA: 0s - loss: 0.0926 - accuracy: 0.4623 9/11 [=======================>......] - ETA: 0s - loss: 0.0921 - accuracy: 0.462210/11 [==========================>...] - ETA: 0s - loss: 0.0916 - accuracy: 0.462611/11 [==============================] - ETA: 0s - loss: 0.0911 - accuracy: 0.463011/11 [==============================] - 1s 100ms/step - loss: 0.0907 - accuracy: 0.4634
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0789 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.0777 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.0779 - accuracy: 0.4748 4/11 [=========>....................] - ETA: 0s - loss: 0.0783 - accuracy: 0.4806 5/11 [============>.................] - ETA: 0s - loss: 0.0788 - accuracy: 0.4823 6/11 [===============>..............] - ETA: 0s - loss: 0.0790 - accuracy: 0.4818 7/11 [==================>...........] - ETA: 0s - loss: 0.0790 - accuracy: 0.4822 8/11 [====================>.........] - ETA: 0s - loss: 0.0789 - accuracy: 0.4839 9/11 [=======================>......] - ETA: 0s - loss: 0.0786 - accuracy: 0.485710/11 [==========================>...] - ETA: 0s - loss: 0.0784 - accuracy: 0.487011/11 [==============================] - ETA: 0s - loss: 0.0782 - accuracy: 0.488211/11 [==============================] - 1s 100ms/step - loss: 0.0781 - accuracy: 0.4891
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0721 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 0s - loss: 0.0704 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.0695 - accuracy: 0.5365 4/11 [=========>....................] - ETA: 0s - loss: 0.0691 - accuracy: 0.5342 5/11 [============>.................] - ETA: 0s - loss: 0.0691 - accuracy: 0.5317 6/11 [===============>..............] - ETA: 0s - loss: 0.0690 - accuracy: 0.5306 7/11 [==================>...........] - ETA: 0s - loss: 0.0688 - accuracy: 0.5307 8/11 [====================>.........] - ETA: 0s - loss: 0.0685 - accuracy: 0.5316 9/11 [=======================>......] - ETA: 0s - loss: 0.0683 - accuracy: 0.532210/11 [==========================>...] - ETA: 0s - loss: 0.0681 - accuracy: 0.533111/11 [==============================] - ETA: 0s - loss: 0.0680 - accuracy: 0.534011/11 [==============================] - 1s 102ms/step - loss: 0.0678 - accuracy: 0.5347
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0674 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 0s - loss: 0.0652 - accuracy: 0.6152 3/11 [=======>......................] - ETA: 0s - loss: 0.0653 - accuracy: 0.6159 4/11 [=========>....................] - ETA: 0s - loss: 0.0653 - accuracy: 0.6113 5/11 [============>.................] - ETA: 0s - loss: 0.0644 - accuracy: 0.6128 6/11 [===============>..............] - ETA: 0s - loss: 0.0635 - accuracy: 0.6125 7/11 [==================>...........] - ETA: 0s - loss: 0.0629 - accuracy: 0.6131 8/11 [====================>.........] - ETA: 0s - loss: 0.0624 - accuracy: 0.6153 9/11 [=======================>......] - ETA: 0s - loss: 0.0620 - accuracy: 0.618010/11 [==========================>...] - ETA: 0s - loss: 0.0616 - accuracy: 0.620811/11 [==============================] - ETA: 0s - loss: 0.0612 - accuracy: 0.623811/11 [==============================] - 1s 100ms/step - loss: 0.0609 - accuracy: 0.6262
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0513 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 0s - loss: 0.0530 - accuracy: 0.7461 3/11 [=======>......................] - ETA: 0s - loss: 0.0533 - accuracy: 0.7344 4/11 [=========>....................] - ETA: 0s - loss: 0.0534 - accuracy: 0.7266 5/11 [============>.................] - ETA: 0s - loss: 0.0530 - accuracy: 0.7216 6/11 [===============>..............] - ETA: 0s - loss: 0.0528 - accuracy: 0.7183 7/11 [==================>...........] - ETA: 0s - loss: 0.0527 - accuracy: 0.7167 8/11 [====================>.........] - ETA: 0s - loss: 0.0527 - accuracy: 0.7165 9/11 [=======================>......] - ETA: 0s - loss: 0.0526 - accuracy: 0.717010/11 [==========================>...] - ETA: 0s - loss: 0.0525 - accuracy: 0.719211/11 [==============================] - ETA: 0s - loss: 0.0525 - accuracy: 0.721311/11 [==============================] - 1s 98ms/step - loss: 0.0524 - accuracy: 0.7231
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0498 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.0499 - accuracy: 0.8066 3/11 [=======>......................] - ETA: 0s - loss: 0.0493 - accuracy: 0.8008 4/11 [=========>....................] - ETA: 0s - loss: 0.0487 - accuracy: 0.7964 5/11 [============>.................] - ETA: 0s - loss: 0.0482 - accuracy: 0.7934 6/11 [===============>..............] - ETA: 0s - loss: 0.0477 - accuracy: 0.7907 7/11 [==================>...........] - ETA: 0s - loss: 0.0476 - accuracy: 0.7885 8/11 [====================>.........] - ETA: 0s - loss: 0.0476 - accuracy: 0.7865 9/11 [=======================>......] - ETA: 0s - loss: 0.0476 - accuracy: 0.785310/11 [==========================>...] - ETA: 0s - loss: 0.0475 - accuracy: 0.784511/11 [==============================] - ETA: 0s - loss: 0.0475 - accuracy: 0.784311/11 [==============================] - 1s 99ms/step - loss: 0.0474 - accuracy: 0.7841
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0382 - accuracy: 0.8516 2/11 [====>.........................] - ETA: 0s - loss: 0.0423 - accuracy: 0.8516 3/11 [=======>......................] - ETA: 0s - loss: 0.0432 - accuracy: 0.8498 4/11 [=========>....................] - ETA: 0s - loss: 0.0440 - accuracy: 0.8459 5/11 [============>.................] - ETA: 0s - loss: 0.0443 - accuracy: 0.8436 6/11 [===============>..............] - ETA: 0s - loss: 0.0443 - accuracy: 0.8390 7/11 [==================>...........] - ETA: 0s - loss: 0.0445 - accuracy: 0.8322 8/11 [====================>.........] - ETA: 0s - loss: 0.0446 - accuracy: 0.8262 9/11 [=======================>......] - ETA: 0s - loss: 0.0447 - accuracy: 0.820810/11 [==========================>...] - ETA: 0s - loss: 0.0447 - accuracy: 0.816611/11 [==============================] - ETA: 0s - loss: 0.0447 - accuracy: 0.813411/11 [==============================] - 1s 106ms/step - loss: 0.0447 - accuracy: 0.8107
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0345 - accuracy: 0.8359 2/11 [====>.........................] - ETA: 0s - loss: 0.0354 - accuracy: 0.8535 3/11 [=======>......................] - ETA: 0s - loss: 0.0365 - accuracy: 0.8676 4/11 [=========>....................] - ETA: 0s - loss: 0.0377 - accuracy: 0.8739 5/11 [============>.................] - ETA: 0s - loss: 0.0385 - accuracy: 0.8763 6/11 [===============>..............] - ETA: 0s - loss: 0.0391 - accuracy: 0.8778 7/11 [==================>...........] - ETA: 0s - loss: 0.0394 - accuracy: 0.8788 8/11 [====================>.........] - ETA: 0s - loss: 0.0398 - accuracy: 0.8788 9/11 [=======================>......] - ETA: 0s - loss: 0.0400 - accuracy: 0.878510/11 [==========================>...] - ETA: 0s - loss: 0.0402 - accuracy: 0.876011/11 [==============================] - ETA: 0s - loss: 0.0403 - accuracy: 0.873511/11 [==============================] - 1s 104ms/step - loss: 0.0405 - accuracy: 0.8714
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0344 - accuracy: 0.7891 2/11 [====>.........................] - ETA: 0s - loss: 0.0343 - accuracy: 0.8008 3/11 [=======>......................] - ETA: 0s - loss: 0.0345 - accuracy: 0.8099 4/11 [=========>....................] - ETA: 0s - loss: 0.0350 - accuracy: 0.8145 5/11 [============>.................] - ETA: 0s - loss: 0.0352 - accuracy: 0.8191 6/11 [===============>..............] - ETA: 0s - loss: 0.0353 - accuracy: 0.8217 7/11 [==================>...........] - ETA: 0s - loss: 0.0354 - accuracy: 0.8247 8/11 [====================>.........] - ETA: 0s - loss: 0.0356 - accuracy: 0.8268 9/11 [=======================>......] - ETA: 0s - loss: 0.0359 - accuracy: 0.828810/11 [==========================>...] - ETA: 0s - loss: 0.0361 - accuracy: 0.830411/11 [==============================] - ETA: 0s - loss: 0.0362 - accuracy: 0.831811/11 [==============================] - 1s 103ms/step - loss: 0.0363 - accuracy: 0.8330
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0360 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 0s - loss: 0.0358 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0353 - accuracy: 0.8689 4/11 [=========>....................] - ETA: 0s - loss: 0.0356 - accuracy: 0.8695 5/11 [============>.................] - ETA: 0s - loss: 0.0357 - accuracy: 0.8715 6/11 [===============>..............] - ETA: 0s - loss: 0.0358 - accuracy: 0.8725 7/11 [==================>...........] - ETA: 0s - loss: 0.0359 - accuracy: 0.8735 8/11 [====================>.........] - ETA: 0s - loss: 0.0359 - accuracy: 0.8742 9/11 [=======================>......] - ETA: 0s - loss: 0.0359 - accuracy: 0.874910/11 [==========================>...] - ETA: 0s - loss: 0.0358 - accuracy: 0.875911/11 [==============================] - ETA: 0s - loss: 0.0357 - accuracy: 0.876911/11 [==============================] - 1s 99ms/step - loss: 0.0357 - accuracy: 0.8778
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0285 - accuracy: 0.8594 2/11 [====>.........................] - ETA: 1s - loss: 0.0303 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0312 - accuracy: 0.8707 4/11 [=========>....................] - ETA: 0s - loss: 0.0316 - accuracy: 0.8747 5/11 [============>.................] - ETA: 0s - loss: 0.0316 - accuracy: 0.8757 6/11 [===============>..............] - ETA: 0s - loss: 0.0316 - accuracy: 0.8777 7/11 [==================>...........] - ETA: 0s - loss: 0.0317 - accuracy: 0.8805 8/11 [====================>.........] - ETA: 0s - loss: 0.0317 - accuracy: 0.8819 9/11 [=======================>......] - ETA: 0s - loss: 0.0318 - accuracy: 0.882610/11 [==========================>...] - ETA: 0s - loss: 0.0319 - accuracy: 0.883511/11 [==============================] - ETA: 0s - loss: 0.0320 - accuracy: 0.884311/11 [==============================] - 1s 101ms/step - loss: 0.0320 - accuracy: 0.8850
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0316 - accuracy: 0.9375 2/11 [====>.........................] - ETA: 0s - loss: 0.0319 - accuracy: 0.9258 3/11 [=======>......................] - ETA: 0s - loss: 0.0315 - accuracy: 0.9201 4/11 [=========>....................] - ETA: 0s - loss: 0.0314 - accuracy: 0.9137 5/11 [============>.................] - ETA: 0s - loss: 0.0318 - accuracy: 0.9094 6/11 [===============>..............] - ETA: 0s - loss: 0.0319 - accuracy: 0.9072 7/11 [==================>...........] - ETA: 0s - loss: 0.0319 - accuracy: 0.9067 8/11 [====================>.........] - ETA: 0s - loss: 0.0319 - accuracy: 0.9046 9/11 [=======================>......] - ETA: 0s - loss: 0.0318 - accuracy: 0.902510/11 [==========================>...] - ETA: 0s - loss: 0.0318 - accuracy: 0.900911/11 [==============================] - ETA: 0s - loss: 0.0317 - accuracy: 0.899011/11 [==============================] - 1s 99ms/step - loss: 0.0317 - accuracy: 0.8974
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0274 - accuracy: 0.8828 2/11 [====>.........................] - ETA: 0s - loss: 0.0289 - accuracy: 0.8906 3/11 [=======>......................] - ETA: 0s - loss: 0.0297 - accuracy: 0.8941 4/11 [=========>....................] - ETA: 0s - loss: 0.0302 - accuracy: 0.8976 5/11 [============>.................] - ETA: 0s - loss: 0.0305 - accuracy: 0.9009 6/11 [===============>..............] - ETA: 0s - loss: 0.0307 - accuracy: 0.9027 7/11 [==================>...........] - ETA: 0s - loss: 0.0310 - accuracy: 0.9043 8/11 [====================>.........] - ETA: 0s - loss: 0.0313 - accuracy: 0.9059 9/11 [=======================>......] - ETA: 0s - loss: 0.0314 - accuracy: 0.907710/11 [==========================>...] - ETA: 0s - loss: 0.0313 - accuracy: 0.909011/11 [==============================] - ETA: 0s - loss: 0.0313 - accuracy: 0.910011/11 [==============================] - 1s 103ms/step - loss: 0.0313 - accuracy: 0.9108
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0344 - accuracy: 0.85943/6 [==============>...............] - ETA: 0s - loss: 0.0329 - accuracy: 0.8438 5/6 [========================>.....] - ETA: 0s - loss: 0.0310 - accuracy: 0.83756/6 [==============================] - 4s 32ms/step - loss: 0.0310 - accuracy: 0.8385
2021-12-14 00:02:15.156046: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:02:15.157690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:02:15.157763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:02:15.157829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:02:15.157874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:02:15.157917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:02:15.157959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:02:15.158006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:02:15.158052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:02:15.158100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:02:15.159589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:02:15.159636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:02:15.159649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:02:15.159661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 2 4 0 1] pred: [0.01291993 0.00709036 0.1443986  0.7870619  0.05651766]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 1 4 0] pred: [3.3470988e-04 1.5618086e-02 9.7007191e-01 3.5290182e-02 3.6405325e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [0.00869843 0.79146326 0.8548621  0.01458243 0.00267991]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 2 0 1] pred: [0.01863956 0.00522217 0.08926746 0.7120889  0.12765864]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [0.00416571 0.6561307  0.93219626 0.01398182 0.00268948]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.01731119 0.8864129  0.84469515 0.00846469 0.00347778]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [0 1 3 4 2] pred: [0.73995453 0.30259898 0.06914371 0.10881931 0.10619184]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [7.4008107e-04 3.3297718e-02 9.7081149e-01 1.9346386e-02 5.1276386e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 3 0 4] pred: [0.04220659 0.70255655 0.4053067  0.04522416 0.00913027]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [0.04313523 0.90478885 0.6509041  0.01146746 0.0052641 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [0 1 4 3 2] pred: [0.79458964 0.24469772 0.06098634 0.09774587 0.11842418]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 2 4 0 1] pred: [0.01388672 0.00818023 0.14151183 0.84612477 0.03485906]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 3 0 4] pred: [0.01200524 0.7678331  0.7637073  0.01984623 0.00350273]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 2 0 1] pred: [0.02084386 0.01182693 0.12356311 0.7722429  0.13947853]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [4 3 0 2 1] pred: [0.11196446 0.03628337 0.08294851 0.51655287 0.68317807]
 Top predictions indices: [4 3] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:04 - loss: 0.2501 - accuracy: 0.3438 2/11 [====>.........................] - ETA: 1s - loss: 0.2494 - accuracy: 0.3906   3/11 [=======>......................] - ETA: 0s - loss: 0.2488 - accuracy: 0.4106 4/11 [=========>....................] - ETA: 0s - loss: 0.2482 - accuracy: 0.4237 5/11 [============>.................] - ETA: 0s - loss: 0.2475 - accuracy: 0.4302 6/11 [===============>..............] - ETA: 0s - loss: 0.2469 - accuracy: 0.4336 7/11 [==================>...........] - ETA: 0s - loss: 0.2463 - accuracy: 0.4365 8/11 [====================>.........] - ETA: 0s - loss: 0.2456 - accuracy: 0.4401 9/11 [=======================>......] - ETA: 0s - loss: 0.2449 - accuracy: 0.441810/11 [==========================>...] - ETA: 0s - loss: 0.2443 - accuracy: 0.443211/11 [==============================] - ETA: 0s - loss: 0.2436 - accuracy: 0.444811/11 [==============================] - 13s 101ms/step - loss: 0.2431 - accuracy: 0.4460
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2173 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.2160 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.2148 - accuracy: 0.4813 4/11 [=========>....................] - ETA: 0s - loss: 0.2138 - accuracy: 0.4806 5/11 [============>.................] - ETA: 0s - loss: 0.2127 - accuracy: 0.4776 6/11 [===============>..............] - ETA: 0s - loss: 0.2116 - accuracy: 0.4746 7/11 [==================>...........] - ETA: 0s - loss: 0.2104 - accuracy: 0.4714 8/11 [====================>.........] - ETA: 0s - loss: 0.2091 - accuracy: 0.4697 9/11 [=======================>......] - ETA: 0s - loss: 0.2077 - accuracy: 0.468910/11 [==========================>...] - ETA: 0s - loss: 0.2062 - accuracy: 0.468511/11 [==============================] - ETA: 0s - loss: 0.2048 - accuracy: 0.468411/11 [==============================] - 1s 102ms/step - loss: 0.2036 - accuracy: 0.4683
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1389 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.1439 - accuracy: 0.4863 3/11 [=======>......................] - ETA: 0s - loss: 0.1442 - accuracy: 0.4805 4/11 [=========>....................] - ETA: 0s - loss: 0.1433 - accuracy: 0.4790 5/11 [============>.................] - ETA: 0s - loss: 0.1419 - accuracy: 0.4779 6/11 [===============>..............] - ETA: 0s - loss: 0.1407 - accuracy: 0.4764 7/11 [==================>...........] - ETA: 0s - loss: 0.1395 - accuracy: 0.4754 8/11 [====================>.........] - ETA: 0s - loss: 0.1382 - accuracy: 0.4751 9/11 [=======================>......] - ETA: 0s - loss: 0.1372 - accuracy: 0.474110/11 [==========================>...] - ETA: 0s - loss: 0.1363 - accuracy: 0.473411/11 [==============================] - ETA: 0s - loss: 0.1355 - accuracy: 0.472811/11 [==============================] - 1s 98ms/step - loss: 0.1348 - accuracy: 0.4724
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1357 - accuracy: 0.3906 2/11 [====>.........................] - ETA: 0s - loss: 0.1317 - accuracy: 0.3965 3/11 [=======>......................] - ETA: 0s - loss: 0.1277 - accuracy: 0.4145 4/11 [=========>....................] - ETA: 0s - loss: 0.1257 - accuracy: 0.4246 5/11 [============>.................] - ETA: 0s - loss: 0.1237 - accuracy: 0.4332 6/11 [===============>..............] - ETA: 0s - loss: 0.1227 - accuracy: 0.4395 7/11 [==================>...........] - ETA: 0s - loss: 0.1219 - accuracy: 0.4435 8/11 [====================>.........] - ETA: 0s - loss: 0.1212 - accuracy: 0.4466 9/11 [=======================>......] - ETA: 0s - loss: 0.1206 - accuracy: 0.448510/11 [==========================>...] - ETA: 0s - loss: 0.1201 - accuracy: 0.450211/11 [==============================] - ETA: 0s - loss: 0.1196 - accuracy: 0.451811/11 [==============================] - 1s 102ms/step - loss: 0.1192 - accuracy: 0.4531
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1097 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.1081 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.1083 - accuracy: 0.4887 4/11 [=========>....................] - ETA: 0s - loss: 0.1094 - accuracy: 0.4793 5/11 [============>.................] - ETA: 0s - loss: 0.1097 - accuracy: 0.4750 6/11 [===============>..............] - ETA: 0s - loss: 0.1099 - accuracy: 0.4725 7/11 [==================>...........] - ETA: 0s - loss: 0.1096 - accuracy: 0.4724 8/11 [====================>.........] - ETA: 0s - loss: 0.1092 - accuracy: 0.4726 9/11 [=======================>......] - ETA: 0s - loss: 0.1089 - accuracy: 0.472310/11 [==========================>...] - ETA: 0s - loss: 0.1086 - accuracy: 0.472411/11 [==============================] - ETA: 0s - loss: 0.1085 - accuracy: 0.471911/11 [==============================] - 1s 97ms/step - loss: 0.1083 - accuracy: 0.4715
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1100 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.1064 - accuracy: 0.4512 3/11 [=======>......................] - ETA: 0s - loss: 0.1048 - accuracy: 0.4631 4/11 [=========>....................] - ETA: 0s - loss: 0.1037 - accuracy: 0.4674 5/11 [============>.................] - ETA: 0s - loss: 0.1028 - accuracy: 0.4705 6/11 [===============>..............] - ETA: 0s - loss: 0.1020 - accuracy: 0.4735 7/11 [==================>...........] - ETA: 0s - loss: 0.1014 - accuracy: 0.4752 8/11 [====================>.........] - ETA: 0s - loss: 0.1009 - accuracy: 0.4761 9/11 [=======================>......] - ETA: 0s - loss: 0.1005 - accuracy: 0.476310/11 [==========================>...] - ETA: 0s - loss: 0.1004 - accuracy: 0.475511/11 [==============================] - ETA: 0s - loss: 0.1002 - accuracy: 0.474911/11 [==============================] - 1s 99ms/step - loss: 0.1001 - accuracy: 0.4744
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0912 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.0905 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 0s - loss: 0.0917 - accuracy: 0.4661 4/11 [=========>....................] - ETA: 0s - loss: 0.0919 - accuracy: 0.4658 5/11 [============>.................] - ETA: 0s - loss: 0.0919 - accuracy: 0.4655 6/11 [===============>..............] - ETA: 0s - loss: 0.0918 - accuracy: 0.4636 7/11 [==================>...........] - ETA: 0s - loss: 0.0917 - accuracy: 0.4623 8/11 [====================>.........] - ETA: 0s - loss: 0.0917 - accuracy: 0.4619 9/11 [=======================>......] - ETA: 0s - loss: 0.0915 - accuracy: 0.461810/11 [==========================>...] - ETA: 0s - loss: 0.0911 - accuracy: 0.462511/11 [==============================] - ETA: 0s - loss: 0.0908 - accuracy: 0.463411/11 [==============================] - 1s 106ms/step - loss: 0.0905 - accuracy: 0.4640
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0762 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.0781 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 0s - loss: 0.0778 - accuracy: 0.4397 4/11 [=========>....................] - ETA: 0s - loss: 0.0768 - accuracy: 0.4484 5/11 [============>.................] - ETA: 0s - loss: 0.0760 - accuracy: 0.4572 6/11 [===============>..............] - ETA: 0s - loss: 0.0758 - accuracy: 0.4615 7/11 [==================>...........] - ETA: 0s - loss: 0.0755 - accuracy: 0.4644 8/11 [====================>.........] - ETA: 0s - loss: 0.0752 - accuracy: 0.4672 9/11 [=======================>......] - ETA: 0s - loss: 0.0749 - accuracy: 0.469910/11 [==========================>...] - ETA: 0s - loss: 0.0748 - accuracy: 0.471811/11 [==============================] - ETA: 0s - loss: 0.0747 - accuracy: 0.473511/11 [==============================] - 1s 102ms/step - loss: 0.0747 - accuracy: 0.4750
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0737 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.0720 - accuracy: 0.5176 3/11 [=======>......................] - ETA: 0s - loss: 0.0701 - accuracy: 0.5195 4/11 [=========>....................] - ETA: 0s - loss: 0.0688 - accuracy: 0.5273 5/11 [============>.................] - ETA: 0s - loss: 0.0684 - accuracy: 0.5328 6/11 [===============>..............] - ETA: 0s - loss: 0.0677 - accuracy: 0.5406 7/11 [==================>...........] - ETA: 0s - loss: 0.0674 - accuracy: 0.5466 8/11 [====================>.........] - ETA: 0s - loss: 0.0673 - accuracy: 0.5505 9/11 [=======================>......] - ETA: 0s - loss: 0.0671 - accuracy: 0.553410/11 [==========================>...] - ETA: 0s - loss: 0.0669 - accuracy: 0.556311/11 [==============================] - ETA: 0s - loss: 0.0668 - accuracy: 0.559111/11 [==============================] - 1s 100ms/step - loss: 0.0667 - accuracy: 0.5614
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0547 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.0566 - accuracy: 0.6641 3/11 [=======>......................] - ETA: 0s - loss: 0.0571 - accuracy: 0.6719 4/11 [=========>....................] - ETA: 0s - loss: 0.0577 - accuracy: 0.6743 5/11 [============>.................] - ETA: 0s - loss: 0.0580 - accuracy: 0.6751 6/11 [===============>..............] - ETA: 0s - loss: 0.0582 - accuracy: 0.6774 7/11 [==================>...........] - ETA: 0s - loss: 0.0583 - accuracy: 0.6806 8/11 [====================>.........] - ETA: 0s - loss: 0.0582 - accuracy: 0.6842 9/11 [=======================>......] - ETA: 0s - loss: 0.0582 - accuracy: 0.688210/11 [==========================>...] - ETA: 0s - loss: 0.0582 - accuracy: 0.691111/11 [==============================] - ETA: 0s - loss: 0.0582 - accuracy: 0.693611/11 [==============================] - 1s 107ms/step - loss: 0.0583 - accuracy: 0.6958
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0541 - accuracy: 0.7188 2/11 [====>.........................] - ETA: 0s - loss: 0.0518 - accuracy: 0.7402 3/11 [=======>......................] - ETA: 0s - loss: 0.0514 - accuracy: 0.7391 4/11 [=========>....................] - ETA: 0s - loss: 0.0512 - accuracy: 0.7355 5/11 [============>.................] - ETA: 0s - loss: 0.0512 - accuracy: 0.7287 6/11 [===============>..............] - ETA: 0s - loss: 0.0514 - accuracy: 0.7242 7/11 [==================>...........] - ETA: 0s - loss: 0.0516 - accuracy: 0.7199 8/11 [====================>.........] - ETA: 0s - loss: 0.0518 - accuracy: 0.7171 9/11 [=======================>......] - ETA: 0s - loss: 0.0521 - accuracy: 0.715310/11 [==========================>...] - ETA: 0s - loss: 0.0523 - accuracy: 0.715511/11 [==============================] - ETA: 0s - loss: 0.0524 - accuracy: 0.716711/11 [==============================] - 1s 107ms/step - loss: 0.0525 - accuracy: 0.7176
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0534 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.0548 - accuracy: 0.7695 3/11 [=======>......................] - ETA: 0s - loss: 0.0548 - accuracy: 0.7743 4/11 [=========>....................] - ETA: 0s - loss: 0.0543 - accuracy: 0.7780 5/11 [============>.................] - ETA: 0s - loss: 0.0537 - accuracy: 0.7811 6/11 [===============>..............] - ETA: 0s - loss: 0.0533 - accuracy: 0.7812 7/11 [==================>...........] - ETA: 0s - loss: 0.0529 - accuracy: 0.7807 8/11 [====================>.........] - ETA: 0s - loss: 0.0526 - accuracy: 0.7788 9/11 [=======================>......] - ETA: 0s - loss: 0.0523 - accuracy: 0.777010/11 [==========================>...] - ETA: 0s - loss: 0.0521 - accuracy: 0.775711/11 [==============================] - ETA: 0s - loss: 0.0518 - accuracy: 0.774811/11 [==============================] - 1s 102ms/step - loss: 0.0517 - accuracy: 0.7741
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0482 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.0453 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.0448 - accuracy: 0.8247 4/11 [=========>....................] - ETA: 0s - loss: 0.0444 - accuracy: 0.8250 5/11 [============>.................] - ETA: 0s - loss: 0.0440 - accuracy: 0.8244 6/11 [===============>..............] - ETA: 0s - loss: 0.0441 - accuracy: 0.8220 7/11 [==================>...........] - ETA: 0s - loss: 0.0443 - accuracy: 0.8187 8/11 [====================>.........] - ETA: 0s - loss: 0.0446 - accuracy: 0.8157 9/11 [=======================>......] - ETA: 0s - loss: 0.0448 - accuracy: 0.812010/11 [==========================>...] - ETA: 0s - loss: 0.0450 - accuracy: 0.809011/11 [==============================] - ETA: 0s - loss: 0.0451 - accuracy: 0.806711/11 [==============================] - 1s 101ms/step - loss: 0.0451 - accuracy: 0.8048
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0476 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.0463 - accuracy: 0.8242 3/11 [=======>......................] - ETA: 0s - loss: 0.0450 - accuracy: 0.8359 4/11 [=========>....................] - ETA: 0s - loss: 0.0443 - accuracy: 0.8442 5/11 [============>.................] - ETA: 0s - loss: 0.0440 - accuracy: 0.8495 6/11 [===============>..............] - ETA: 0s - loss: 0.0436 - accuracy: 0.8535 7/11 [==================>...........] - ETA: 0s - loss: 0.0435 - accuracy: 0.8556 8/11 [====================>.........] - ETA: 0s - loss: 0.0434 - accuracy: 0.8557 9/11 [=======================>......] - ETA: 0s - loss: 0.0433 - accuracy: 0.855010/11 [==========================>...] - ETA: 0s - loss: 0.0432 - accuracy: 0.853311/11 [==============================] - ETA: 0s - loss: 0.0432 - accuracy: 0.851511/11 [==============================] - 1s 103ms/step - loss: 0.0431 - accuracy: 0.8500
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0326 - accuracy: 0.8359 2/11 [====>.........................] - ETA: 0s - loss: 0.0351 - accuracy: 0.8223 3/11 [=======>......................] - ETA: 0s - loss: 0.0363 - accuracy: 0.8190 4/11 [=========>....................] - ETA: 0s - loss: 0.0369 - accuracy: 0.8188 5/11 [============>.................] - ETA: 0s - loss: 0.0372 - accuracy: 0.8198 6/11 [===============>..............] - ETA: 0s - loss: 0.0374 - accuracy: 0.8222 7/11 [==================>...........] - ETA: 0s - loss: 0.0377 - accuracy: 0.8229 8/11 [====================>.........] - ETA: 0s - loss: 0.0380 - accuracy: 0.8243 9/11 [=======================>......] - ETA: 0s - loss: 0.0382 - accuracy: 0.824710/11 [==========================>...] - ETA: 0s - loss: 0.0383 - accuracy: 0.824711/11 [==============================] - ETA: 0s - loss: 0.0384 - accuracy: 0.824611/11 [==============================] - 1s 99ms/step - loss: 0.0384 - accuracy: 0.8245
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0360 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 0s - loss: 0.0368 - accuracy: 0.8359 3/11 [=======>......................] - ETA: 0s - loss: 0.0367 - accuracy: 0.8307 4/11 [=========>....................] - ETA: 0s - loss: 0.0366 - accuracy: 0.8257 5/11 [============>.................] - ETA: 0s - loss: 0.0364 - accuracy: 0.8249 6/11 [===============>..............] - ETA: 0s - loss: 0.0363 - accuracy: 0.8248 7/11 [==================>...........] - ETA: 0s - loss: 0.0362 - accuracy: 0.8259 8/11 [====================>.........] - ETA: 0s - loss: 0.0362 - accuracy: 0.8279 9/11 [=======================>......] - ETA: 0s - loss: 0.0362 - accuracy: 0.829910/11 [==========================>...] - ETA: 0s - loss: 0.0363 - accuracy: 0.832111/11 [==============================] - ETA: 0s - loss: 0.0363 - accuracy: 0.834411/11 [==============================] - 1s 101ms/step - loss: 0.0363 - accuracy: 0.8363
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0312 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 0s - loss: 0.0319 - accuracy: 0.8301 3/11 [=======>......................] - ETA: 0s - loss: 0.0322 - accuracy: 0.8181 4/11 [=========>....................] - ETA: 0s - loss: 0.0328 - accuracy: 0.8133 5/11 [============>.................] - ETA: 0s - loss: 0.0330 - accuracy: 0.8110 6/11 [===============>..............] - ETA: 0s - loss: 0.0331 - accuracy: 0.8097 7/11 [==================>...........] - ETA: 0s - loss: 0.0332 - accuracy: 0.8095 8/11 [====================>.........] - ETA: 0s - loss: 0.0333 - accuracy: 0.8091 9/11 [=======================>......] - ETA: 0s - loss: 0.0333 - accuracy: 0.809310/11 [==========================>...] - ETA: 0s - loss: 0.0333 - accuracy: 0.809911/11 [==============================] - ETA: 0s - loss: 0.0333 - accuracy: 0.810711/11 [==============================] - 1s 103ms/step - loss: 0.0333 - accuracy: 0.8113
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0327 - accuracy: 0.9062 2/11 [====>.........................] - ETA: 0s - loss: 0.0328 - accuracy: 0.8926 3/11 [=======>......................] - ETA: 0s - loss: 0.0323 - accuracy: 0.8859 4/11 [=========>....................] - ETA: 0s - loss: 0.0327 - accuracy: 0.8787 5/11 [============>.................] - ETA: 0s - loss: 0.0328 - accuracy: 0.8761 6/11 [===============>..............] - ETA: 0s - loss: 0.0328 - accuracy: 0.8740 7/11 [==================>...........] - ETA: 0s - loss: 0.0329 - accuracy: 0.8721 8/11 [====================>.........] - ETA: 0s - loss: 0.0327 - accuracy: 0.8702 9/11 [=======================>......] - ETA: 0s - loss: 0.0326 - accuracy: 0.869110/11 [==========================>...] - ETA: 0s - loss: 0.0325 - accuracy: 0.868211/11 [==============================] - ETA: 0s - loss: 0.0323 - accuracy: 0.867411/11 [==============================] - 1s 101ms/step - loss: 0.0321 - accuracy: 0.8668
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0278 - accuracy: 0.8594 2/11 [====>.........................] - ETA: 0s - loss: 0.0298 - accuracy: 0.8574 3/11 [=======>......................] - ETA: 0s - loss: 0.0299 - accuracy: 0.8546 4/11 [=========>....................] - ETA: 0s - loss: 0.0298 - accuracy: 0.8568 5/11 [============>.................] - ETA: 0s - loss: 0.0296 - accuracy: 0.8614 6/11 [===============>..............] - ETA: 0s - loss: 0.0293 - accuracy: 0.8651 7/11 [==================>...........] - ETA: 0s - loss: 0.0292 - accuracy: 0.8677 8/11 [====================>.........] - ETA: 0s - loss: 0.0291 - accuracy: 0.8693 9/11 [=======================>......] - ETA: 0s - loss: 0.0291 - accuracy: 0.870410/11 [==========================>...] - ETA: 0s - loss: 0.0291 - accuracy: 0.871411/11 [==============================] - ETA: 0s - loss: 0.0290 - accuracy: 0.872411/11 [==============================] - 1s 98ms/step - loss: 0.0289 - accuracy: 0.8731
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0272 - accuracy: 0.8828 2/11 [====>.........................] - ETA: 0s - loss: 0.0273 - accuracy: 0.8906 3/11 [=======>......................] - ETA: 0s - loss: 0.0270 - accuracy: 0.8924 4/11 [=========>....................] - ETA: 0s - loss: 0.0266 - accuracy: 0.8949 5/11 [============>.................] - ETA: 0s - loss: 0.0267 - accuracy: 0.8953 6/11 [===============>..............] - ETA: 0s - loss: 0.0266 - accuracy: 0.8941 7/11 [==================>...........] - ETA: 0s - loss: 0.0265 - accuracy: 0.8918 8/11 [====================>.........] - ETA: 0s - loss: 0.0265 - accuracy: 0.8885 9/11 [=======================>......] - ETA: 0s - loss: 0.0264 - accuracy: 0.885010/11 [==========================>...] - ETA: 0s - loss: 0.0264 - accuracy: 0.882211/11 [==============================] - ETA: 0s - loss: 0.0264 - accuracy: 0.880311/11 [==============================] - 1s 102ms/step - loss: 0.0264 - accuracy: 0.8786
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0305 - accuracy: 0.91413/6 [==============>...............] - ETA: 0s - loss: 0.0307 - accuracy: 0.9089 5/6 [========================>.....] - ETA: 0s - loss: 0.0307 - accuracy: 0.90946/6 [==============================] - 4s 30ms/step - loss: 0.0311 - accuracy: 0.9065
2021-12-14 00:03:02.029443: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:03:02.030333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:03:02.030389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:03:02.030456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:03:02.030495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:03:02.030530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:03:02.030566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:03:02.030605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:03:02.030648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:03:02.030688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:03:02.031815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:03:02.031845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:03:02.031855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:03:02.031863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 4 0] pred: [4.6214860e-05 5.4546297e-03 9.8274934e-01 1.3637364e-02 2.3580194e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [0.04952565 0.88462543 0.630855   0.02595237 0.00472045]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [0.01623827 0.8845811  0.8023698  0.01104137 0.00170538]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.05582008 0.84007215 0.4267336  0.01670223 0.00368047]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [0.01895386 0.84611493 0.7487038  0.01659924 0.00384089]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.0161055  0.8982258  0.80683374 0.00901139 0.00164685]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 2 0 1] pred: [0.07378379 0.01091847 0.11519998 0.6289257  0.5678989 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [0.00885785 0.8905342  0.9287714  0.00678933 0.0018678 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [0.03543243 0.90633947 0.79640126 0.00917959 0.00486845]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [0.05890071 0.9613322  0.7652955  0.0115976  0.00401506]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [3 4 2 0 1] pred: [0.02264318 0.00229156 0.07993856 0.64704055 0.5435384 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [0.05097219 0.91975915 0.80287707 0.00878108 0.00574443]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [0.00333455 0.2235488  0.873772   0.1272352  0.00689256]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [5.83556830e-05 1.00696385e-02 9.84789491e-01 8.79129767e-03
 2.16567516e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [0.01310873 0.86124593 0.767506   0.00935102 0.00194743]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:55 - loss: 0.2484 - accuracy: 0.3203 2/11 [====>.........................] - ETA: 0s - loss: 0.2480 - accuracy: 0.3789   3/11 [=======>......................] - ETA: 0s - loss: 0.2475 - accuracy: 0.4193 4/11 [=========>....................] - ETA: 0s - loss: 0.2470 - accuracy: 0.4458 5/11 [============>.................] - ETA: 0s - loss: 0.2466 - accuracy: 0.4629 6/11 [===============>..............] - ETA: 0s - loss: 0.2461 - accuracy: 0.4743 7/11 [==================>...........] - ETA: 0s - loss: 0.2456 - accuracy: 0.4813 8/11 [====================>.........] - ETA: 0s - loss: 0.2452 - accuracy: 0.4858 9/11 [=======================>......] - ETA: 0s - loss: 0.2447 - accuracy: 0.488510/11 [==========================>...] - ETA: 0s - loss: 0.2442 - accuracy: 0.490011/11 [==============================] - ETA: 0s - loss: 0.2437 - accuracy: 0.490911/11 [==============================] - 13s 107ms/step - loss: 0.2434 - accuracy: 0.4917
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2246 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.2238 - accuracy: 0.4512 3/11 [=======>......................] - ETA: 0s - loss: 0.2229 - accuracy: 0.4553 4/11 [=========>....................] - ETA: 0s - loss: 0.2220 - accuracy: 0.4591 5/11 [============>.................] - ETA: 0s - loss: 0.2211 - accuracy: 0.4633 6/11 [===============>..............] - ETA: 0s - loss: 0.2203 - accuracy: 0.4627 7/11 [==================>...........] - ETA: 0s - loss: 0.2194 - accuracy: 0.4613 8/11 [====================>.........] - ETA: 0s - loss: 0.2185 - accuracy: 0.4604 9/11 [=======================>......] - ETA: 0s - loss: 0.2175 - accuracy: 0.459910/11 [==========================>...] - ETA: 0s - loss: 0.2165 - accuracy: 0.459711/11 [==============================] - ETA: 0s - loss: 0.2155 - accuracy: 0.459811/11 [==============================] - 1s 99ms/step - loss: 0.2147 - accuracy: 0.4599
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1733 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.1702 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.1685 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.1664 - accuracy: 0.4482 5/11 [============>.................] - ETA: 0s - loss: 0.1645 - accuracy: 0.4502 6/11 [===============>..............] - ETA: 0s - loss: 0.1626 - accuracy: 0.4528 7/11 [==================>...........] - ETA: 0s - loss: 0.1609 - accuracy: 0.4538 8/11 [====================>.........] - ETA: 0s - loss: 0.1593 - accuracy: 0.4539 9/11 [=======================>......] - ETA: 0s - loss: 0.1578 - accuracy: 0.454210/11 [==========================>...] - ETA: 0s - loss: 0.1562 - accuracy: 0.454511/11 [==============================] - ETA: 0s - loss: 0.1548 - accuracy: 0.454711/11 [==============================] - 1s 103ms/step - loss: 0.1537 - accuracy: 0.4548
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1113 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.1158 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.1154 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.1152 - accuracy: 0.4253 5/11 [============>.................] - ETA: 0s - loss: 0.1148 - accuracy: 0.4293 6/11 [===============>..............] - ETA: 0s - loss: 0.1146 - accuracy: 0.4333 7/11 [==================>...........] - ETA: 0s - loss: 0.1147 - accuracy: 0.4359 8/11 [====================>.........] - ETA: 0s - loss: 0.1147 - accuracy: 0.4383 9/11 [=======================>......] - ETA: 0s - loss: 0.1146 - accuracy: 0.440810/11 [==========================>...] - ETA: 0s - loss: 0.1146 - accuracy: 0.442411/11 [==============================] - ETA: 0s - loss: 0.1145 - accuracy: 0.443611/11 [==============================] - 1s 102ms/step - loss: 0.1144 - accuracy: 0.4447
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1150 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.1102 - accuracy: 0.4258 3/11 [=======>......................] - ETA: 0s - loss: 0.1072 - accuracy: 0.4418 4/11 [=========>....................] - ETA: 0s - loss: 0.1069 - accuracy: 0.4476 5/11 [============>.................] - ETA: 0s - loss: 0.1072 - accuracy: 0.4487 6/11 [===============>..............] - ETA: 0s - loss: 0.1072 - accuracy: 0.4503 7/11 [==================>...........] - ETA: 0s - loss: 0.1075 - accuracy: 0.4512 8/11 [====================>.........] - ETA: 0s - loss: 0.1077 - accuracy: 0.4517 9/11 [=======================>......] - ETA: 0s - loss: 0.1078 - accuracy: 0.452310/11 [==========================>...] - ETA: 0s - loss: 0.1081 - accuracy: 0.453311/11 [==============================] - ETA: 0s - loss: 0.1082 - accuracy: 0.453511/11 [==============================] - 1s 103ms/step - loss: 0.1084 - accuracy: 0.4537
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1083 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.1058 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 0s - loss: 0.1044 - accuracy: 0.4653 4/11 [=========>....................] - ETA: 0s - loss: 0.1040 - accuracy: 0.4618 5/11 [============>.................] - ETA: 0s - loss: 0.1039 - accuracy: 0.4591 6/11 [===============>..............] - ETA: 0s - loss: 0.1037 - accuracy: 0.4579 7/11 [==================>...........] - ETA: 0s - loss: 0.1035 - accuracy: 0.4588 8/11 [====================>.........] - ETA: 0s - loss: 0.1032 - accuracy: 0.4603 9/11 [=======================>......] - ETA: 0s - loss: 0.1031 - accuracy: 0.460310/11 [==========================>...] - ETA: 0s - loss: 0.1029 - accuracy: 0.460511/11 [==============================] - ETA: 0s - loss: 0.1027 - accuracy: 0.460311/11 [==============================] - 1s 98ms/step - loss: 0.1026 - accuracy: 0.4601
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0992 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.0982 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 0s - loss: 0.0980 - accuracy: 0.4397 4/11 [=========>....................] - ETA: 0s - loss: 0.0978 - accuracy: 0.4411 5/11 [============>.................] - ETA: 0s - loss: 0.0974 - accuracy: 0.4422 6/11 [===============>..............] - ETA: 0s - loss: 0.0972 - accuracy: 0.4438 7/11 [==================>...........] - ETA: 0s - loss: 0.0971 - accuracy: 0.4448 8/11 [====================>.........] - ETA: 0s - loss: 0.0967 - accuracy: 0.4476 9/11 [=======================>......] - ETA: 0s - loss: 0.0962 - accuracy: 0.450010/11 [==========================>...] - ETA: 0s - loss: 0.0958 - accuracy: 0.452111/11 [==============================] - ETA: 0s - loss: 0.0955 - accuracy: 0.454011/11 [==============================] - 1s 100ms/step - loss: 0.0952 - accuracy: 0.4557
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0820 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.0849 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.0845 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.0844 - accuracy: 0.4937 5/11 [============>.................] - ETA: 0s - loss: 0.0847 - accuracy: 0.4940 6/11 [===============>..............] - ETA: 0s - loss: 0.0846 - accuracy: 0.4972 7/11 [==================>...........] - ETA: 0s - loss: 0.0844 - accuracy: 0.4984 8/11 [====================>.........] - ETA: 0s - loss: 0.0842 - accuracy: 0.5004 9/11 [=======================>......] - ETA: 0s - loss: 0.0838 - accuracy: 0.502210/11 [==========================>...] - ETA: 0s - loss: 0.0835 - accuracy: 0.503511/11 [==============================] - ETA: 0s - loss: 0.0832 - accuracy: 0.504111/11 [==============================] - 1s 103ms/step - loss: 0.0830 - accuracy: 0.5045
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0705 - accuracy: 0.5859 2/11 [====>.........................] - ETA: 0s - loss: 0.0723 - accuracy: 0.5762 3/11 [=======>......................] - ETA: 0s - loss: 0.0723 - accuracy: 0.5768 4/11 [=========>....................] - ETA: 0s - loss: 0.0721 - accuracy: 0.5825 5/11 [============>.................] - ETA: 0s - loss: 0.0719 - accuracy: 0.5866 6/11 [===============>..............] - ETA: 0s - loss: 0.0717 - accuracy: 0.5911 7/11 [==================>...........] - ETA: 0s - loss: 0.0717 - accuracy: 0.5942 8/11 [====================>.........] - ETA: 0s - loss: 0.0717 - accuracy: 0.5963 9/11 [=======================>......] - ETA: 0s - loss: 0.0715 - accuracy: 0.597910/11 [==========================>...] - ETA: 0s - loss: 0.0714 - accuracy: 0.598911/11 [==============================] - ETA: 0s - loss: 0.0713 - accuracy: 0.599811/11 [==============================] - 1s 101ms/step - loss: 0.0712 - accuracy: 0.6005
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0660 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.0642 - accuracy: 0.6562 3/11 [=======>......................] - ETA: 0s - loss: 0.0654 - accuracy: 0.6476 4/11 [=========>....................] - ETA: 0s - loss: 0.0653 - accuracy: 0.6414 5/11 [============>.................] - ETA: 0s - loss: 0.0646 - accuracy: 0.6410 6/11 [===============>..............] - ETA: 0s - loss: 0.0642 - accuracy: 0.6409 7/11 [==================>...........] - ETA: 0s - loss: 0.0640 - accuracy: 0.6426 8/11 [====================>.........] - ETA: 0s - loss: 0.0638 - accuracy: 0.6452 9/11 [=======================>......] - ETA: 0s - loss: 0.0635 - accuracy: 0.647710/11 [==========================>...] - ETA: 0s - loss: 0.0633 - accuracy: 0.649611/11 [==============================] - ETA: 0s - loss: 0.0631 - accuracy: 0.651611/11 [==============================] - 1s 103ms/step - loss: 0.0630 - accuracy: 0.6533
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0556 - accuracy: 0.7109 2/11 [====>.........................] - ETA: 0s - loss: 0.0549 - accuracy: 0.7227 3/11 [=======>......................] - ETA: 0s - loss: 0.0561 - accuracy: 0.7300 4/11 [=========>....................] - ETA: 0s - loss: 0.0565 - accuracy: 0.7316 5/11 [============>.................] - ETA: 0s - loss: 0.0565 - accuracy: 0.7328 6/11 [===============>..............] - ETA: 0s - loss: 0.0564 - accuracy: 0.7322 7/11 [==================>...........] - ETA: 0s - loss: 0.0559 - accuracy: 0.7322 8/11 [====================>.........] - ETA: 0s - loss: 0.0556 - accuracy: 0.7305 9/11 [=======================>......] - ETA: 0s - loss: 0.0554 - accuracy: 0.729410/11 [==========================>...] - ETA: 0s - loss: 0.0551 - accuracy: 0.728211/11 [==============================] - ETA: 0s - loss: 0.0549 - accuracy: 0.727711/11 [==============================] - 1s 103ms/step - loss: 0.0548 - accuracy: 0.7272
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0452 - accuracy: 0.7422 2/11 [====>.........................] - ETA: 0s - loss: 0.0449 - accuracy: 0.7402 3/11 [=======>......................] - ETA: 0s - loss: 0.0462 - accuracy: 0.7391 4/11 [=========>....................] - ETA: 0s - loss: 0.0468 - accuracy: 0.7326 5/11 [============>.................] - ETA: 0s - loss: 0.0472 - accuracy: 0.7267 6/11 [===============>..............] - ETA: 0s - loss: 0.0473 - accuracy: 0.7215 7/11 [==================>...........] - ETA: 0s - loss: 0.0473 - accuracy: 0.7195 8/11 [====================>.........] - ETA: 0s - loss: 0.0474 - accuracy: 0.7195 9/11 [=======================>......] - ETA: 0s - loss: 0.0474 - accuracy: 0.720410/11 [==========================>...] - ETA: 0s - loss: 0.0475 - accuracy: 0.721411/11 [==============================] - ETA: 0s - loss: 0.0474 - accuracy: 0.722311/11 [==============================] - 1s 103ms/step - loss: 0.0474 - accuracy: 0.7231
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0444 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 1s - loss: 0.0461 - accuracy: 0.6836 3/11 [=======>......................] - ETA: 0s - loss: 0.0463 - accuracy: 0.6884 4/11 [=========>....................] - ETA: 0s - loss: 0.0461 - accuracy: 0.6921 5/11 [============>.................] - ETA: 0s - loss: 0.0457 - accuracy: 0.6952 6/11 [===============>..............] - ETA: 0s - loss: 0.0454 - accuracy: 0.6985 7/11 [==================>...........] - ETA: 0s - loss: 0.0453 - accuracy: 0.6999 8/11 [====================>.........] - ETA: 0s - loss: 0.0450 - accuracy: 0.7016 9/11 [=======================>......] - ETA: 0s - loss: 0.0448 - accuracy: 0.703110/11 [==========================>...] - ETA: 0s - loss: 0.0445 - accuracy: 0.705211/11 [==============================] - ETA: 0s - loss: 0.0444 - accuracy: 0.706911/11 [==============================] - 1s 106ms/step - loss: 0.0443 - accuracy: 0.7084
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0358 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.0366 - accuracy: 0.7832 3/11 [=======>......................] - ETA: 0s - loss: 0.0376 - accuracy: 0.7817 4/11 [=========>....................] - ETA: 0s - loss: 0.0381 - accuracy: 0.7850 5/11 [============>.................] - ETA: 0s - loss: 0.0385 - accuracy: 0.7874 6/11 [===============>..............] - ETA: 0s - loss: 0.0388 - accuracy: 0.7859 7/11 [==================>...........] - ETA: 0s - loss: 0.0390 - accuracy: 0.7852 8/11 [====================>.........] - ETA: 0s - loss: 0.0391 - accuracy: 0.7837 9/11 [=======================>......] - ETA: 0s - loss: 0.0391 - accuracy: 0.781810/11 [==========================>...] - ETA: 0s - loss: 0.0392 - accuracy: 0.780511/11 [==============================] - ETA: 0s - loss: 0.0392 - accuracy: 0.779411/11 [==============================] - 1s 103ms/step - loss: 0.0392 - accuracy: 0.7785
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0318 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 0s - loss: 0.0330 - accuracy: 0.7773 3/11 [=======>......................] - ETA: 0s - loss: 0.0334 - accuracy: 0.7769 4/11 [=========>....................] - ETA: 0s - loss: 0.0337 - accuracy: 0.7804 5/11 [============>.................] - ETA: 0s - loss: 0.0342 - accuracy: 0.7837 6/11 [===============>..............] - ETA: 0s - loss: 0.0345 - accuracy: 0.7840 7/11 [==================>...........] - ETA: 0s - loss: 0.0347 - accuracy: 0.7834 8/11 [====================>.........] - ETA: 0s - loss: 0.0348 - accuracy: 0.7830 9/11 [=======================>......] - ETA: 0s - loss: 0.0350 - accuracy: 0.781910/11 [==========================>...] - ETA: 0s - loss: 0.0351 - accuracy: 0.781611/11 [==============================] - ETA: 0s - loss: 0.0352 - accuracy: 0.781611/11 [==============================] - 1s 103ms/step - loss: 0.0353 - accuracy: 0.7817
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0352 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 0s - loss: 0.0339 - accuracy: 0.8594 3/11 [=======>......................] - ETA: 0s - loss: 0.0343 - accuracy: 0.8490 4/11 [=========>....................] - ETA: 0s - loss: 0.0346 - accuracy: 0.8413 5/11 [============>.................] - ETA: 0s - loss: 0.0351 - accuracy: 0.8305 6/11 [===============>..............] - ETA: 0s - loss: 0.0352 - accuracy: 0.8230 7/11 [==================>...........] - ETA: 0s - loss: 0.0353 - accuracy: 0.8159 8/11 [====================>.........] - ETA: 0s - loss: 0.0354 - accuracy: 0.8124 9/11 [=======================>......] - ETA: 0s - loss: 0.0353 - accuracy: 0.811310/11 [==========================>...] - ETA: 0s - loss: 0.0353 - accuracy: 0.811611/11 [==============================] - ETA: 0s - loss: 0.0352 - accuracy: 0.812611/11 [==============================] - 1s 104ms/step - loss: 0.0352 - accuracy: 0.8134
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0296 - accuracy: 0.9531 2/11 [====>.........................] - ETA: 0s - loss: 0.0277 - accuracy: 0.9180 3/11 [=======>......................] - ETA: 0s - loss: 0.0278 - accuracy: 0.8984 4/11 [=========>....................] - ETA: 0s - loss: 0.0281 - accuracy: 0.8794 5/11 [============>.................] - ETA: 0s - loss: 0.0284 - accuracy: 0.8657 6/11 [===============>..............] - ETA: 0s - loss: 0.0287 - accuracy: 0.8542 7/11 [==================>...........] - ETA: 0s - loss: 0.0289 - accuracy: 0.8476 8/11 [====================>.........] - ETA: 0s - loss: 0.0291 - accuracy: 0.8440 9/11 [=======================>......] - ETA: 0s - loss: 0.0293 - accuracy: 0.842010/11 [==========================>...] - ETA: 0s - loss: 0.0296 - accuracy: 0.841211/11 [==============================] - ETA: 0s - loss: 0.0298 - accuracy: 0.840511/11 [==============================] - 1s 101ms/step - loss: 0.0299 - accuracy: 0.8399
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0277 - accuracy: 0.8359 2/11 [====>.........................] - ETA: 0s - loss: 0.0292 - accuracy: 0.8164 3/11 [=======>......................] - ETA: 0s - loss: 0.0296 - accuracy: 0.7951 4/11 [=========>....................] - ETA: 0s - loss: 0.0299 - accuracy: 0.7858 5/11 [============>.................] - ETA: 0s - loss: 0.0299 - accuracy: 0.7811 6/11 [===============>..............] - ETA: 0s - loss: 0.0299 - accuracy: 0.7809 7/11 [==================>...........] - ETA: 0s - loss: 0.0298 - accuracy: 0.7821 8/11 [====================>.........] - ETA: 0s - loss: 0.0298 - accuracy: 0.7842 9/11 [=======================>......] - ETA: 0s - loss: 0.0298 - accuracy: 0.786210/11 [==========================>...] - ETA: 0s - loss: 0.0297 - accuracy: 0.788811/11 [==============================] - ETA: 0s - loss: 0.0297 - accuracy: 0.791311/11 [==============================] - 1s 104ms/step - loss: 0.0297 - accuracy: 0.7933
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0276 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 1s - loss: 0.0272 - accuracy: 0.7852 3/11 [=======>......................] - ETA: 0s - loss: 0.0275 - accuracy: 0.7882 4/11 [=========>....................] - ETA: 0s - loss: 0.0277 - accuracy: 0.7899 5/11 [============>.................] - ETA: 0s - loss: 0.0277 - accuracy: 0.7938 6/11 [===============>..............] - ETA: 0s - loss: 0.0275 - accuracy: 0.7988 7/11 [==================>...........] - ETA: 0s - loss: 0.0273 - accuracy: 0.8041 8/11 [====================>.........] - ETA: 0s - loss: 0.0273 - accuracy: 0.8091 9/11 [=======================>......] - ETA: 0s - loss: 0.0273 - accuracy: 0.813510/11 [==========================>...] - ETA: 0s - loss: 0.0274 - accuracy: 0.817311/11 [==============================] - ETA: 0s - loss: 0.0274 - accuracy: 0.820811/11 [==============================] - 1s 107ms/step - loss: 0.0274 - accuracy: 0.8238
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0240 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 0s - loss: 0.0235 - accuracy: 0.8105 3/11 [=======>......................] - ETA: 0s - loss: 0.0245 - accuracy: 0.8016 4/11 [=========>....................] - ETA: 0s - loss: 0.0254 - accuracy: 0.7946 5/11 [============>.................] - ETA: 0s - loss: 0.0260 - accuracy: 0.7872 6/11 [===============>..............] - ETA: 0s - loss: 0.0264 - accuracy: 0.7834 7/11 [==================>...........] - ETA: 0s - loss: 0.0266 - accuracy: 0.7828 8/11 [====================>.........] - ETA: 0s - loss: 0.0267 - accuracy: 0.7848 9/11 [=======================>......] - ETA: 0s - loss: 0.0267 - accuracy: 0.787610/11 [==========================>...] - ETA: 0s - loss: 0.0267 - accuracy: 0.791311/11 [==============================] - ETA: 0s - loss: 0.0267 - accuracy: 0.795011/11 [==============================] - 1s 103ms/step - loss: 0.0266 - accuracy: 0.7981
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0314 - accuracy: 0.89843/6 [==============>...............] - ETA: 0s - loss: 0.0294 - accuracy: 0.9271 5/6 [========================>.....] - ETA: 0s - loss: 0.0297 - accuracy: 0.92506/6 [==============================] - 4s 29ms/step - loss: 0.0295 - accuracy: 0.9207
2021-12-14 00:03:49.353892: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:03:49.354906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:03:49.354963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:03:49.355018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:03:49.355052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:03:49.355089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:03:49.355143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:03:49.355188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:03:49.355230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:03:49.355264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:03:49.356539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:03:49.356572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:03:49.356583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:03:49.356591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 3 0 4] pred: [9.2386305e-03 9.0976810e-01 8.4771347e-01 1.3904512e-02 5.7283044e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 3 0 4] pred: [1.1316508e-02 8.8214684e-01 8.4520072e-01 1.3149798e-02 6.4581633e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 3 0 4] pred: [1.1065960e-02 9.0877581e-01 8.7448263e-01 1.1214256e-02 6.0147047e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 3 0 4] pred: [8.4879696e-03 9.1283798e-01 8.8937807e-01 1.0284692e-02 5.0106645e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [3 2 4 1 0] pred: [0.0087904  0.01948026 0.08425635 0.88018036 0.07669991]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [0.00360757 0.128831   0.9087559  0.01108646 0.00109166]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 4 0] pred: [0.00195205 0.00784948 0.8042468  0.11193112 0.00440931]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 2 0 1] pred: [0.05166015 0.0472095  0.07515296 0.7600417  0.15786833]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [0.00183457 0.03423512 0.9812231  0.01932597 0.00243694]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [4 3 0 2 1] pred: [0.17032948 0.01884794 0.07730711 0.42552686 0.8566583 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [1.0556072e-02 9.0150297e-01 9.1998112e-01 9.5065236e-03 6.1824918e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 0 2 3 4] pred: [0.15443301 0.7451207  0.14243534 0.05253559 0.00284323]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 4 0] pred: [0.00173911 0.014139   0.9812281  0.01791334 0.00243118]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 4 0] pred: [0.00162718 0.01241818 0.9816898  0.01866221 0.0025461 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [1.4745116e-02 9.1817605e-01 8.1788385e-01 9.8865926e-03 5.8847666e-04]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:03 - loss: 0.2501 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.2495 - accuracy: 0.4785   3/11 [=======>......................] - ETA: 0s - loss: 0.2490 - accuracy: 0.4674 4/11 [=========>....................] - ETA: 0s - loss: 0.2485 - accuracy: 0.4600 5/11 [============>.................] - ETA: 0s - loss: 0.2478 - accuracy: 0.4561 6/11 [===============>..............] - ETA: 0s - loss: 0.2472 - accuracy: 0.4549 7/11 [==================>...........] - ETA: 0s - loss: 0.2466 - accuracy: 0.4536 8/11 [====================>.........] - ETA: 0s - loss: 0.2460 - accuracy: 0.4531 9/11 [=======================>......] - ETA: 0s - loss: 0.2453 - accuracy: 0.453210/11 [==========================>...] - ETA: 0s - loss: 0.2447 - accuracy: 0.452911/11 [==============================] - ETA: 0s - loss: 0.2440 - accuracy: 0.452611/11 [==============================] - 13s 104ms/step - loss: 0.2435 - accuracy: 0.4524
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2161 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.2154 - accuracy: 0.5098 3/11 [=======>......................] - ETA: 0s - loss: 0.2146 - accuracy: 0.4970 4/11 [=========>....................] - ETA: 0s - loss: 0.2137 - accuracy: 0.4870 5/11 [============>.................] - ETA: 0s - loss: 0.2126 - accuracy: 0.4833 6/11 [===============>..............] - ETA: 0s - loss: 0.2114 - accuracy: 0.4800 7/11 [==================>...........] - ETA: 0s - loss: 0.2101 - accuracy: 0.4776 8/11 [====================>.........] - ETA: 0s - loss: 0.2088 - accuracy: 0.4759 9/11 [=======================>......] - ETA: 0s - loss: 0.2075 - accuracy: 0.473110/11 [==========================>...] - ETA: 0s - loss: 0.2061 - accuracy: 0.471611/11 [==============================] - ETA: 0s - loss: 0.2047 - accuracy: 0.470211/11 [==============================] - 1s 107ms/step - loss: 0.2035 - accuracy: 0.4691
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1437 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.1433 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 0s - loss: 0.1405 - accuracy: 0.4792 4/11 [=========>....................] - ETA: 0s - loss: 0.1390 - accuracy: 0.4771 5/11 [============>.................] - ETA: 0s - loss: 0.1376 - accuracy: 0.4757 6/11 [===============>..............] - ETA: 0s - loss: 0.1362 - accuracy: 0.4745 7/11 [==================>...........] - ETA: 0s - loss: 0.1351 - accuracy: 0.4729 8/11 [====================>.........] - ETA: 0s - loss: 0.1342 - accuracy: 0.4717 9/11 [=======================>......] - ETA: 0s - loss: 0.1335 - accuracy: 0.470010/11 [==========================>...] - ETA: 0s - loss: 0.1329 - accuracy: 0.469111/11 [==============================] - ETA: 0s - loss: 0.1324 - accuracy: 0.467911/11 [==============================] - 1s 101ms/step - loss: 0.1320 - accuracy: 0.4669
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1214 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.1160 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.1161 - accuracy: 0.4635 4/11 [=========>....................] - ETA: 0s - loss: 0.1166 - accuracy: 0.4614 5/11 [============>.................] - ETA: 0s - loss: 0.1174 - accuracy: 0.4582 6/11 [===============>..............] - ETA: 0s - loss: 0.1175 - accuracy: 0.4589 7/11 [==================>...........] - ETA: 0s - loss: 0.1175 - accuracy: 0.4590 8/11 [====================>.........] - ETA: 0s - loss: 0.1174 - accuracy: 0.4589 9/11 [=======================>......] - ETA: 0s - loss: 0.1170 - accuracy: 0.459210/11 [==========================>...] - ETA: 0s - loss: 0.1167 - accuracy: 0.458811/11 [==============================] - ETA: 0s - loss: 0.1164 - accuracy: 0.458611/11 [==============================] - 1s 101ms/step - loss: 0.1161 - accuracy: 0.4584
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1058 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.1078 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.1085 - accuracy: 0.4683 4/11 [=========>....................] - ETA: 0s - loss: 0.1098 - accuracy: 0.4601 5/11 [============>.................] - ETA: 0s - loss: 0.1099 - accuracy: 0.4559 6/11 [===============>..............] - ETA: 0s - loss: 0.1097 - accuracy: 0.4537 7/11 [==================>...........] - ETA: 0s - loss: 0.1092 - accuracy: 0.4530 8/11 [====================>.........] - ETA: 0s - loss: 0.1090 - accuracy: 0.4529 9/11 [=======================>......] - ETA: 0s - loss: 0.1088 - accuracy: 0.452710/11 [==========================>...] - ETA: 0s - loss: 0.1086 - accuracy: 0.452811/11 [==============================] - ETA: 0s - loss: 0.1084 - accuracy: 0.453111/11 [==============================] - 1s 103ms/step - loss: 0.1082 - accuracy: 0.4533
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1151 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.1118 - accuracy: 0.4199 3/11 [=======>......................] - ETA: 0s - loss: 0.1083 - accuracy: 0.4301 4/11 [=========>....................] - ETA: 0s - loss: 0.1070 - accuracy: 0.4325 5/11 [============>.................] - ETA: 0s - loss: 0.1059 - accuracy: 0.4341 6/11 [===============>..............] - ETA: 0s - loss: 0.1053 - accuracy: 0.4347 7/11 [==================>...........] - ETA: 0s - loss: 0.1047 - accuracy: 0.4368 8/11 [====================>.........] - ETA: 0s - loss: 0.1040 - accuracy: 0.4387 9/11 [=======================>......] - ETA: 0s - loss: 0.1035 - accuracy: 0.440810/11 [==========================>...] - ETA: 0s - loss: 0.1031 - accuracy: 0.442111/11 [==============================] - ETA: 0s - loss: 0.1027 - accuracy: 0.443511/11 [==============================] - 1s 102ms/step - loss: 0.1023 - accuracy: 0.4447
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0948 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.0926 - accuracy: 0.4473 3/11 [=======>......................] - ETA: 0s - loss: 0.0923 - accuracy: 0.4596 4/11 [=========>....................] - ETA: 0s - loss: 0.0923 - accuracy: 0.4600 5/11 [============>.................] - ETA: 0s - loss: 0.0920 - accuracy: 0.4605 6/11 [===============>..............] - ETA: 0s - loss: 0.0917 - accuracy: 0.4597 7/11 [==================>...........] - ETA: 0s - loss: 0.0912 - accuracy: 0.4599 8/11 [====================>.........] - ETA: 0s - loss: 0.0908 - accuracy: 0.4607 9/11 [=======================>......] - ETA: 0s - loss: 0.0904 - accuracy: 0.460910/11 [==========================>...] - ETA: 0s - loss: 0.0903 - accuracy: 0.460711/11 [==============================] - ETA: 0s - loss: 0.0901 - accuracy: 0.461111/11 [==============================] - 1s 103ms/step - loss: 0.0900 - accuracy: 0.4614
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0900 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.0878 - accuracy: 0.4863 3/11 [=======>......................] - ETA: 0s - loss: 0.0855 - accuracy: 0.4935 4/11 [=========>....................] - ETA: 0s - loss: 0.0845 - accuracy: 0.4932 5/11 [============>.................] - ETA: 0s - loss: 0.0836 - accuracy: 0.4930 6/11 [===============>..............] - ETA: 0s - loss: 0.0828 - accuracy: 0.4957 7/11 [==================>...........] - ETA: 0s - loss: 0.0821 - accuracy: 0.4968 8/11 [====================>.........] - ETA: 0s - loss: 0.0816 - accuracy: 0.4969 9/11 [=======================>......] - ETA: 0s - loss: 0.0812 - accuracy: 0.496210/11 [==========================>...] - ETA: 0s - loss: 0.0809 - accuracy: 0.496011/11 [==============================] - ETA: 0s - loss: 0.0806 - accuracy: 0.495511/11 [==============================] - 1s 104ms/step - loss: 0.0804 - accuracy: 0.4950
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0708 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.0708 - accuracy: 0.5020 3/11 [=======>......................] - ETA: 0s - loss: 0.0708 - accuracy: 0.5065 4/11 [=========>....................] - ETA: 0s - loss: 0.0707 - accuracy: 0.5073 5/11 [============>.................] - ETA: 0s - loss: 0.0707 - accuracy: 0.5096 6/11 [===============>..............] - ETA: 0s - loss: 0.0706 - accuracy: 0.5100 7/11 [==================>...........] - ETA: 0s - loss: 0.0705 - accuracy: 0.5114 8/11 [====================>.........] - ETA: 0s - loss: 0.0704 - accuracy: 0.5121 9/11 [=======================>......] - ETA: 0s - loss: 0.0702 - accuracy: 0.512910/11 [==========================>...] - ETA: 0s - loss: 0.0699 - accuracy: 0.514411/11 [==============================] - ETA: 0s - loss: 0.0697 - accuracy: 0.515611/11 [==============================] - 1s 107ms/step - loss: 0.0695 - accuracy: 0.5166
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0590 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.0606 - accuracy: 0.5273 3/11 [=======>......................] - ETA: 0s - loss: 0.0601 - accuracy: 0.5373 4/11 [=========>....................] - ETA: 0s - loss: 0.0598 - accuracy: 0.5422 5/11 [============>.................] - ETA: 0s - loss: 0.0597 - accuracy: 0.5434 6/11 [===============>..............] - ETA: 0s - loss: 0.0596 - accuracy: 0.5459 7/11 [==================>...........] - ETA: 0s - loss: 0.0595 - accuracy: 0.5478 8/11 [====================>.........] - ETA: 0s - loss: 0.0595 - accuracy: 0.5502 9/11 [=======================>......] - ETA: 0s - loss: 0.0595 - accuracy: 0.551610/11 [==========================>...] - ETA: 0s - loss: 0.0594 - accuracy: 0.553311/11 [==============================] - ETA: 0s - loss: 0.0594 - accuracy: 0.555111/11 [==============================] - 1s 105ms/step - loss: 0.0594 - accuracy: 0.5566
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0566 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.0574 - accuracy: 0.6484 3/11 [=======>......................] - ETA: 0s - loss: 0.0563 - accuracy: 0.6589 4/11 [=========>....................] - ETA: 0s - loss: 0.0557 - accuracy: 0.6650 5/11 [============>.................] - ETA: 0s - loss: 0.0553 - accuracy: 0.6683 6/11 [===============>..............] - ETA: 0s - loss: 0.0553 - accuracy: 0.6706 7/11 [==================>...........] - ETA: 0s - loss: 0.0552 - accuracy: 0.6722 8/11 [====================>.........] - ETA: 0s - loss: 0.0550 - accuracy: 0.6743 9/11 [=======================>......] - ETA: 0s - loss: 0.0547 - accuracy: 0.675410/11 [==========================>...] - ETA: 0s - loss: 0.0546 - accuracy: 0.676211/11 [==============================] - ETA: 0s - loss: 0.0545 - accuracy: 0.676711/11 [==============================] - 1s 105ms/step - loss: 0.0544 - accuracy: 0.6772
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0451 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 0s - loss: 0.0464 - accuracy: 0.7168 3/11 [=======>......................] - ETA: 0s - loss: 0.0466 - accuracy: 0.7227 4/11 [=========>....................] - ETA: 0s - loss: 0.0466 - accuracy: 0.7222 5/11 [============>.................] - ETA: 0s - loss: 0.0467 - accuracy: 0.7199 6/11 [===============>..............] - ETA: 0s - loss: 0.0469 - accuracy: 0.7176 7/11 [==================>...........] - ETA: 0s - loss: 0.0469 - accuracy: 0.7161 8/11 [====================>.........] - ETA: 0s - loss: 0.0471 - accuracy: 0.7145 9/11 [=======================>......] - ETA: 0s - loss: 0.0473 - accuracy: 0.713110/11 [==========================>...] - ETA: 0s - loss: 0.0474 - accuracy: 0.712811/11 [==============================] - ETA: 0s - loss: 0.0476 - accuracy: 0.713211/11 [==============================] - 1s 100ms/step - loss: 0.0477 - accuracy: 0.7134
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0478 - accuracy: 0.7891 2/11 [====>.........................] - ETA: 0s - loss: 0.0488 - accuracy: 0.8008 3/11 [=======>......................] - ETA: 0s - loss: 0.0503 - accuracy: 0.7960 4/11 [=========>....................] - ETA: 0s - loss: 0.0504 - accuracy: 0.7928 5/11 [============>.................] - ETA: 0s - loss: 0.0503 - accuracy: 0.7908 6/11 [===============>..............] - ETA: 0s - loss: 0.0503 - accuracy: 0.7877 7/11 [==================>...........] - ETA: 0s - loss: 0.0501 - accuracy: 0.7853 8/11 [====================>.........] - ETA: 0s - loss: 0.0498 - accuracy: 0.7830 9/11 [=======================>......] - ETA: 0s - loss: 0.0495 - accuracy: 0.782010/11 [==========================>...] - ETA: 0s - loss: 0.0492 - accuracy: 0.781411/11 [==============================] - ETA: 0s - loss: 0.0489 - accuracy: 0.780811/11 [==============================] - 1s 109ms/step - loss: 0.0487 - accuracy: 0.7803
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0471 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 0s - loss: 0.0458 - accuracy: 0.7441 3/11 [=======>......................] - ETA: 0s - loss: 0.0458 - accuracy: 0.7391 4/11 [=========>....................] - ETA: 0s - loss: 0.0460 - accuracy: 0.7316 5/11 [============>.................] - ETA: 0s - loss: 0.0460 - accuracy: 0.7262 6/11 [===============>..............] - ETA: 0s - loss: 0.0458 - accuracy: 0.7211 7/11 [==================>...........] - ETA: 0s - loss: 0.0455 - accuracy: 0.7187 8/11 [====================>.........] - ETA: 0s - loss: 0.0454 - accuracy: 0.7179 9/11 [=======================>......] - ETA: 0s - loss: 0.0453 - accuracy: 0.719010/11 [==========================>...] - ETA: 0s - loss: 0.0451 - accuracy: 0.721311/11 [==============================] - ETA: 0s - loss: 0.0451 - accuracy: 0.723411/11 [==============================] - 1s 104ms/step - loss: 0.0450 - accuracy: 0.7251
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0380 - accuracy: 0.8359 2/11 [====>.........................] - ETA: 0s - loss: 0.0373 - accuracy: 0.8320 3/11 [=======>......................] - ETA: 0s - loss: 0.0375 - accuracy: 0.8247 4/11 [=========>....................] - ETA: 0s - loss: 0.0377 - accuracy: 0.8162 5/11 [============>.................] - ETA: 0s - loss: 0.0379 - accuracy: 0.8108 6/11 [===============>..............] - ETA: 0s - loss: 0.0382 - accuracy: 0.8072 7/11 [==================>...........] - ETA: 0s - loss: 0.0386 - accuracy: 0.8028 8/11 [====================>.........] - ETA: 0s - loss: 0.0389 - accuracy: 0.7984 9/11 [=======================>......] - ETA: 0s - loss: 0.0391 - accuracy: 0.794410/11 [==========================>...] - ETA: 0s - loss: 0.0392 - accuracy: 0.792411/11 [==============================] - ETA: 0s - loss: 0.0393 - accuracy: 0.791011/11 [==============================] - 1s 103ms/step - loss: 0.0394 - accuracy: 0.7898
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0411 - accuracy: 0.8516 2/11 [====>.........................] - ETA: 0s - loss: 0.0407 - accuracy: 0.8418 3/11 [=======>......................] - ETA: 0s - loss: 0.0400 - accuracy: 0.8390 4/11 [=========>....................] - ETA: 0s - loss: 0.0400 - accuracy: 0.8358 5/11 [============>.................] - ETA: 0s - loss: 0.0401 - accuracy: 0.8327 6/11 [===============>..............] - ETA: 0s - loss: 0.0400 - accuracy: 0.8304 7/11 [==================>...........] - ETA: 0s - loss: 0.0400 - accuracy: 0.8283 8/11 [====================>.........] - ETA: 0s - loss: 0.0399 - accuracy: 0.8279 9/11 [=======================>......] - ETA: 0s - loss: 0.0398 - accuracy: 0.828610/11 [==========================>...] - ETA: 0s - loss: 0.0395 - accuracy: 0.830111/11 [==============================] - ETA: 0s - loss: 0.0394 - accuracy: 0.831411/11 [==============================] - 1s 102ms/step - loss: 0.0392 - accuracy: 0.8324
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0320 - accuracy: 0.9219 2/11 [====>.........................] - ETA: 0s - loss: 0.0338 - accuracy: 0.9082 3/11 [=======>......................] - ETA: 0s - loss: 0.0343 - accuracy: 0.9015 4/11 [=========>....................] - ETA: 0s - loss: 0.0345 - accuracy: 0.8993 5/11 [============>.................] - ETA: 0s - loss: 0.0346 - accuracy: 0.8985 6/11 [===============>..............] - ETA: 0s - loss: 0.0345 - accuracy: 0.8952 7/11 [==================>...........] - ETA: 0s - loss: 0.0345 - accuracy: 0.8899 8/11 [====================>.........] - ETA: 0s - loss: 0.0344 - accuracy: 0.8855 9/11 [=======================>......] - ETA: 0s - loss: 0.0344 - accuracy: 0.880810/11 [==========================>...] - ETA: 0s - loss: 0.0345 - accuracy: 0.876411/11 [==============================] - ETA: 0s - loss: 0.0345 - accuracy: 0.872711/11 [==============================] - 1s 105ms/step - loss: 0.0345 - accuracy: 0.8695
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0339 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 0s - loss: 0.0340 - accuracy: 0.8789 3/11 [=======>......................] - ETA: 0s - loss: 0.0341 - accuracy: 0.8802 4/11 [=========>....................] - ETA: 0s - loss: 0.0338 - accuracy: 0.8784 5/11 [============>.................] - ETA: 0s - loss: 0.0338 - accuracy: 0.8743 6/11 [===============>..............] - ETA: 0s - loss: 0.0340 - accuracy: 0.8696 7/11 [==================>...........] - ETA: 0s - loss: 0.0341 - accuracy: 0.8655 8/11 [====================>.........] - ETA: 0s - loss: 0.0342 - accuracy: 0.8626 9/11 [=======================>......] - ETA: 0s - loss: 0.0342 - accuracy: 0.861010/11 [==========================>...] - ETA: 0s - loss: 0.0342 - accuracy: 0.860711/11 [==============================] - ETA: 0s - loss: 0.0341 - accuracy: 0.860911/11 [==============================] - 1s 101ms/step - loss: 0.0341 - accuracy: 0.8610
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0332 - accuracy: 0.8906 2/11 [====>.........................] - ETA: 0s - loss: 0.0349 - accuracy: 0.8984 3/11 [=======>......................] - ETA: 0s - loss: 0.0354 - accuracy: 0.9002 4/11 [=========>....................] - ETA: 0s - loss: 0.0355 - accuracy: 0.9036 5/11 [============>.................] - ETA: 0s - loss: 0.0353 - accuracy: 0.9045 6/11 [===============>..............] - ETA: 0s - loss: 0.0348 - accuracy: 0.9048 7/11 [==================>...........] - ETA: 0s - loss: 0.0345 - accuracy: 0.9034 8/11 [====================>.........] - ETA: 0s - loss: 0.0342 - accuracy: 0.9018 9/11 [=======================>......] - ETA: 0s - loss: 0.0339 - accuracy: 0.899810/11 [==========================>...] - ETA: 0s - loss: 0.0337 - accuracy: 0.897911/11 [==============================] - ETA: 0s - loss: 0.0335 - accuracy: 0.896011/11 [==============================] - 1s 99ms/step - loss: 0.0333 - accuracy: 0.8944
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0295 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 1s - loss: 0.0294 - accuracy: 0.8770 3/11 [=======>......................] - ETA: 0s - loss: 0.0291 - accuracy: 0.8772 4/11 [=========>....................] - ETA: 0s - loss: 0.0292 - accuracy: 0.8786 5/11 [============>.................] - ETA: 0s - loss: 0.0292 - accuracy: 0.8801 6/11 [===============>..............] - ETA: 0s - loss: 0.0293 - accuracy: 0.8812 7/11 [==================>...........] - ETA: 0s - loss: 0.0293 - accuracy: 0.8822 8/11 [====================>.........] - ETA: 0s - loss: 0.0293 - accuracy: 0.8823 9/11 [=======================>......] - ETA: 0s - loss: 0.0293 - accuracy: 0.882210/11 [==========================>...] - ETA: 0s - loss: 0.0293 - accuracy: 0.882311/11 [==============================] - ETA: 0s - loss: 0.0293 - accuracy: 0.882011/11 [==============================] - 1s 105ms/step - loss: 0.0293 - accuracy: 0.8818
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0316 - accuracy: 0.85943/6 [==============>...............] - ETA: 0s - loss: 0.0306 - accuracy: 0.8802 5/6 [========================>.....] - ETA: 0s - loss: 0.0294 - accuracy: 0.90476/6 [==============================] - 4s 30ms/step - loss: 0.0294 - accuracy: 0.9037
2021-12-14 00:04:36.863557: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:04:36.864382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:04:36.864428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:04:36.864470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:04:36.864497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:04:36.864528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:04:36.864555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:04:36.864583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:04:36.864610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:04:36.864639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:04:36.865755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:04:36.865783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:04:36.865793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:04:36.865801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 4 0] pred: [4.5365095e-04 1.4087498e-02 9.6272588e-01 3.9601415e-02 6.9706738e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 1 4 0] pred: [6.7320466e-04 2.5098354e-02 9.5427632e-01 3.2281697e-02 5.4053068e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [0.01604441 0.9270885  0.8286738  0.00618982 0.002745  ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [0.00142458 0.269189   0.9808138  0.01685926 0.00152746]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 4 0] pred: [0.00123486 0.00802875 0.85139173 0.13027972 0.00495183]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 4 3 2] pred: [0.70167804 0.33579418 0.05173582 0.17476442 0.18805325]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [0.0023343  0.19808635 0.95828295 0.027271   0.00143853]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 4 0] pred: [6.0078502e-04 1.9943982e-02 9.6077776e-01 3.5515666e-02 5.9899390e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 0 1] pred: [0.00988075 0.00623298 0.1508939  0.799534   0.02475765]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [0.00914115 0.8849591  0.8994801  0.00551364 0.00253439]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 4 0] pred: [5.2136183e-04 1.6738981e-02 9.6087259e-01 3.6288857e-02 2.9948652e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [0.04310068 0.9295755  0.5520706  0.01263461 0.00388744]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [0.00162932 0.06076193 0.8977698  0.03142866 0.00819993]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [0.0697248  0.94084054 0.27610034 0.01605004 0.00345317]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [0.02321619 0.9335501  0.74319005 0.00860426 0.00274488]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:04 - loss: 0.2499 - accuracy: 0.2734 2/11 [====>.........................] - ETA: 0s - loss: 0.2495 - accuracy: 0.2930   3/11 [=======>......................] - ETA: 0s - loss: 0.2490 - accuracy: 0.3177 4/11 [=========>....................] - ETA: 0s - loss: 0.2485 - accuracy: 0.3369 5/11 [============>.................] - ETA: 0s - loss: 0.2480 - accuracy: 0.3539 6/11 [===============>..............] - ETA: 0s - loss: 0.2475 - accuracy: 0.3668 7/11 [==================>...........] - ETA: 0s - loss: 0.2470 - accuracy: 0.3769 8/11 [====================>.........] - ETA: 0s - loss: 0.2465 - accuracy: 0.3851 9/11 [=======================>......] - ETA: 0s - loss: 0.2460 - accuracy: 0.391210/11 [==========================>...] - ETA: 0s - loss: 0.2454 - accuracy: 0.395911/11 [==============================] - ETA: 0s - loss: 0.2449 - accuracy: 0.399811/11 [==============================] - 13s 108ms/step - loss: 0.2445 - accuracy: 0.4031
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2225 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.2220 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 0s - loss: 0.2211 - accuracy: 0.5017 4/11 [=========>....................] - ETA: 0s - loss: 0.2204 - accuracy: 0.4959 5/11 [============>.................] - ETA: 0s - loss: 0.2196 - accuracy: 0.4902 6/11 [===============>..............] - ETA: 0s - loss: 0.2187 - accuracy: 0.4877 7/11 [==================>...........] - ETA: 0s - loss: 0.2177 - accuracy: 0.4869 8/11 [====================>.........] - ETA: 0s - loss: 0.2166 - accuracy: 0.4850 9/11 [=======================>......] - ETA: 0s - loss: 0.2156 - accuracy: 0.483010/11 [==========================>...] - ETA: 0s - loss: 0.2145 - accuracy: 0.481211/11 [==============================] - ETA: 0s - loss: 0.2134 - accuracy: 0.479611/11 [==============================] - 1s 102ms/step - loss: 0.2125 - accuracy: 0.4784
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1634 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.1614 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.1603 - accuracy: 0.4696 4/11 [=========>....................] - ETA: 0s - loss: 0.1593 - accuracy: 0.4655 5/11 [============>.................] - ETA: 0s - loss: 0.1578 - accuracy: 0.4652 6/11 [===============>..............] - ETA: 0s - loss: 0.1566 - accuracy: 0.4632 7/11 [==================>...........] - ETA: 0s - loss: 0.1551 - accuracy: 0.4632 8/11 [====================>.........] - ETA: 0s - loss: 0.1537 - accuracy: 0.4628 9/11 [=======================>......] - ETA: 0s - loss: 0.1524 - accuracy: 0.461810/11 [==========================>...] - ETA: 0s - loss: 0.1512 - accuracy: 0.461011/11 [==============================] - ETA: 0s - loss: 0.1499 - accuracy: 0.461311/11 [==============================] - 1s 102ms/step - loss: 0.1489 - accuracy: 0.4615
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1168 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.1147 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 0s - loss: 0.1156 - accuracy: 0.4779 4/11 [=========>....................] - ETA: 0s - loss: 0.1162 - accuracy: 0.4751 5/11 [============>.................] - ETA: 0s - loss: 0.1159 - accuracy: 0.4766 6/11 [===============>..............] - ETA: 0s - loss: 0.1155 - accuracy: 0.4781 7/11 [==================>...........] - ETA: 0s - loss: 0.1154 - accuracy: 0.4778 8/11 [====================>.........] - ETA: 0s - loss: 0.1155 - accuracy: 0.4771 9/11 [=======================>......] - ETA: 0s - loss: 0.1157 - accuracy: 0.476110/11 [==========================>...] - ETA: 0s - loss: 0.1159 - accuracy: 0.475311/11 [==============================] - ETA: 0s - loss: 0.1160 - accuracy: 0.474311/11 [==============================] - 1s 111ms/step - loss: 0.1161 - accuracy: 0.4734
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1111 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.1183 - accuracy: 0.4512 3/11 [=======>......................] - ETA: 0s - loss: 0.1186 - accuracy: 0.4562 4/11 [=========>....................] - ETA: 0s - loss: 0.1188 - accuracy: 0.4549 5/11 [============>.................] - ETA: 0s - loss: 0.1190 - accuracy: 0.4539 6/11 [===============>..............] - ETA: 0s - loss: 0.1192 - accuracy: 0.4527 7/11 [==================>...........] - ETA: 0s - loss: 0.1193 - accuracy: 0.4512 8/11 [====================>.........] - ETA: 0s - loss: 0.1191 - accuracy: 0.4517 9/11 [=======================>......] - ETA: 0s - loss: 0.1186 - accuracy: 0.453010/11 [==========================>...] - ETA: 0s - loss: 0.1181 - accuracy: 0.454411/11 [==============================] - ETA: 0s - loss: 0.1176 - accuracy: 0.455311/11 [==============================] - 1s 105ms/step - loss: 0.1172 - accuracy: 0.4560
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1145 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.1084 - accuracy: 0.5137 3/11 [=======>......................] - ETA: 0s - loss: 0.1067 - accuracy: 0.5100 4/11 [=========>....................] - ETA: 0s - loss: 0.1062 - accuracy: 0.5099 5/11 [============>.................] - ETA: 0s - loss: 0.1060 - accuracy: 0.5073 6/11 [===============>..............] - ETA: 0s - loss: 0.1064 - accuracy: 0.5018 7/11 [==================>...........] - ETA: 0s - loss: 0.1066 - accuracy: 0.4972 8/11 [====================>.........] - ETA: 0s - loss: 0.1066 - accuracy: 0.4939 9/11 [=======================>......] - ETA: 0s - loss: 0.1067 - accuracy: 0.490510/11 [==========================>...] - ETA: 0s - loss: 0.1069 - accuracy: 0.487811/11 [==============================] - ETA: 0s - loss: 0.1070 - accuracy: 0.485611/11 [==============================] - 1s 105ms/step - loss: 0.1070 - accuracy: 0.4839
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1196 - accuracy: 0.3906 2/11 [====>.........................] - ETA: 0s - loss: 0.1154 - accuracy: 0.4102 3/11 [=======>......................] - ETA: 0s - loss: 0.1118 - accuracy: 0.4288 4/11 [=========>....................] - ETA: 0s - loss: 0.1106 - accuracy: 0.4368 5/11 [============>.................] - ETA: 0s - loss: 0.1097 - accuracy: 0.4423 6/11 [===============>..............] - ETA: 0s - loss: 0.1090 - accuracy: 0.4467 7/11 [==================>...........] - ETA: 0s - loss: 0.1084 - accuracy: 0.4495 8/11 [====================>.........] - ETA: 0s - loss: 0.1076 - accuracy: 0.4529 9/11 [=======================>......] - ETA: 0s - loss: 0.1070 - accuracy: 0.455310/11 [==========================>...] - ETA: 0s - loss: 0.1065 - accuracy: 0.456811/11 [==============================] - ETA: 0s - loss: 0.1062 - accuracy: 0.457711/11 [==============================] - 1s 108ms/step - loss: 0.1059 - accuracy: 0.4585
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1055 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.1046 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 0s - loss: 0.1038 - accuracy: 0.4718 4/11 [=========>....................] - ETA: 0s - loss: 0.1031 - accuracy: 0.4705 5/11 [============>.................] - ETA: 0s - loss: 0.1024 - accuracy: 0.4714 6/11 [===============>..............] - ETA: 0s - loss: 0.1020 - accuracy: 0.4701 7/11 [==================>...........] - ETA: 0s - loss: 0.1015 - accuracy: 0.4691 8/11 [====================>.........] - ETA: 0s - loss: 0.1010 - accuracy: 0.4681 9/11 [=======================>......] - ETA: 0s - loss: 0.1007 - accuracy: 0.467610/11 [==========================>...] - ETA: 0s - loss: 0.1002 - accuracy: 0.468111/11 [==============================] - ETA: 0s - loss: 0.0997 - accuracy: 0.468911/11 [==============================] - 1s 102ms/step - loss: 0.0993 - accuracy: 0.4695
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0887 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.0848 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.0847 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 0s - loss: 0.0848 - accuracy: 0.5029 5/11 [============>.................] - ETA: 0s - loss: 0.0847 - accuracy: 0.5008 6/11 [===============>..............] - ETA: 0s - loss: 0.0845 - accuracy: 0.5020 7/11 [==================>...........] - ETA: 0s - loss: 0.0843 - accuracy: 0.5023 8/11 [====================>.........] - ETA: 0s - loss: 0.0841 - accuracy: 0.5026 9/11 [=======================>......] - ETA: 0s - loss: 0.0839 - accuracy: 0.502910/11 [==========================>...] - ETA: 0s - loss: 0.0838 - accuracy: 0.502911/11 [==============================] - ETA: 0s - loss: 0.0838 - accuracy: 0.502311/11 [==============================] - 1s 101ms/step - loss: 0.0838 - accuracy: 0.5019
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0742 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.0750 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.0750 - accuracy: 0.4783 4/11 [=========>....................] - ETA: 0s - loss: 0.0749 - accuracy: 0.4837 5/11 [============>.................] - ETA: 0s - loss: 0.0746 - accuracy: 0.4882 6/11 [===============>..............] - ETA: 0s - loss: 0.0745 - accuracy: 0.4913 7/11 [==================>...........] - ETA: 0s - loss: 0.0745 - accuracy: 0.4952 8/11 [====================>.........] - ETA: 0s - loss: 0.0744 - accuracy: 0.4975 9/11 [=======================>......] - ETA: 0s - loss: 0.0743 - accuracy: 0.499510/11 [==========================>...] - ETA: 0s - loss: 0.0742 - accuracy: 0.501011/11 [==============================] - ETA: 0s - loss: 0.0741 - accuracy: 0.502511/11 [==============================] - 1s 102ms/step - loss: 0.0740 - accuracy: 0.5037
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0734 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.0724 - accuracy: 0.5137 3/11 [=======>......................] - ETA: 0s - loss: 0.0711 - accuracy: 0.5169 4/11 [=========>....................] - ETA: 0s - loss: 0.0705 - accuracy: 0.5225 5/11 [============>.................] - ETA: 0s - loss: 0.0700 - accuracy: 0.5267 6/11 [===============>..............] - ETA: 0s - loss: 0.0695 - accuracy: 0.5318 7/11 [==================>...........] - ETA: 0s - loss: 0.0692 - accuracy: 0.5359 8/11 [====================>.........] - ETA: 0s - loss: 0.0688 - accuracy: 0.5382 9/11 [=======================>......] - ETA: 0s - loss: 0.0685 - accuracy: 0.540910/11 [==========================>...] - ETA: 0s - loss: 0.0681 - accuracy: 0.543211/11 [==============================] - ETA: 0s - loss: 0.0678 - accuracy: 0.544911/11 [==============================] - 1s 103ms/step - loss: 0.0675 - accuracy: 0.5463
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0609 - accuracy: 0.6484 2/11 [====>.........................] - ETA: 0s - loss: 0.0613 - accuracy: 0.6367 3/11 [=======>......................] - ETA: 0s - loss: 0.0601 - accuracy: 0.6311 4/11 [=========>....................] - ETA: 0s - loss: 0.0592 - accuracy: 0.6291 5/11 [============>.................] - ETA: 0s - loss: 0.0589 - accuracy: 0.6276 6/11 [===============>..............] - ETA: 0s - loss: 0.0587 - accuracy: 0.6261 7/11 [==================>...........] - ETA: 0s - loss: 0.0586 - accuracy: 0.6250 8/11 [====================>.........] - ETA: 0s - loss: 0.0584 - accuracy: 0.6237 9/11 [=======================>......] - ETA: 0s - loss: 0.0583 - accuracy: 0.623310/11 [==========================>...] - ETA: 0s - loss: 0.0582 - accuracy: 0.623111/11 [==============================] - ETA: 0s - loss: 0.0582 - accuracy: 0.622811/11 [==============================] - 1s 100ms/step - loss: 0.0581 - accuracy: 0.6226
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0491 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 0s - loss: 0.0496 - accuracy: 0.6289 3/11 [=======>......................] - ETA: 0s - loss: 0.0501 - accuracy: 0.6293 4/11 [=========>....................] - ETA: 0s - loss: 0.0512 - accuracy: 0.6331 5/11 [============>.................] - ETA: 0s - loss: 0.0521 - accuracy: 0.6381 6/11 [===============>..............] - ETA: 0s - loss: 0.0527 - accuracy: 0.6413 7/11 [==================>...........] - ETA: 0s - loss: 0.0529 - accuracy: 0.6431 8/11 [====================>.........] - ETA: 0s - loss: 0.0529 - accuracy: 0.6449 9/11 [=======================>......] - ETA: 0s - loss: 0.0529 - accuracy: 0.646210/11 [==========================>...] - ETA: 0s - loss: 0.0528 - accuracy: 0.647511/11 [==============================] - ETA: 0s - loss: 0.0527 - accuracy: 0.648511/11 [==============================] - 1s 101ms/step - loss: 0.0527 - accuracy: 0.6493
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0497 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.0485 - accuracy: 0.6484 3/11 [=======>......................] - ETA: 0s - loss: 0.0479 - accuracy: 0.6615 4/11 [=========>....................] - ETA: 0s - loss: 0.0484 - accuracy: 0.6631 5/11 [============>.................] - ETA: 0s - loss: 0.0486 - accuracy: 0.6686 6/11 [===============>..............] - ETA: 0s - loss: 0.0488 - accuracy: 0.6748 7/11 [==================>...........] - ETA: 0s - loss: 0.0488 - accuracy: 0.6788 8/11 [====================>.........] - ETA: 0s - loss: 0.0488 - accuracy: 0.6817 9/11 [=======================>......] - ETA: 0s - loss: 0.0487 - accuracy: 0.683810/11 [==========================>...] - ETA: 0s - loss: 0.0487 - accuracy: 0.685911/11 [==============================] - ETA: 0s - loss: 0.0485 - accuracy: 0.688211/11 [==============================] - 1s 111ms/step - loss: 0.0484 - accuracy: 0.6901
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0505 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 1s - loss: 0.0474 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.0457 - accuracy: 0.6693 4/11 [=========>....................] - ETA: 0s - loss: 0.0449 - accuracy: 0.6665 5/11 [============>.................] - ETA: 0s - loss: 0.0445 - accuracy: 0.6654 6/11 [===============>..............] - ETA: 0s - loss: 0.0443 - accuracy: 0.6663 7/11 [==================>...........] - ETA: 0s - loss: 0.0441 - accuracy: 0.6696 8/11 [====================>.........] - ETA: 0s - loss: 0.0439 - accuracy: 0.6734 9/11 [=======================>......] - ETA: 0s - loss: 0.0438 - accuracy: 0.677210/11 [==========================>...] - ETA: 0s - loss: 0.0437 - accuracy: 0.680411/11 [==============================] - ETA: 0s - loss: 0.0436 - accuracy: 0.682911/11 [==============================] - 1s 103ms/step - loss: 0.0436 - accuracy: 0.6850
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0386 - accuracy: 0.6797 2/11 [====>.........................] - ETA: 0s - loss: 0.0389 - accuracy: 0.7012 3/11 [=======>......................] - ETA: 0s - loss: 0.0389 - accuracy: 0.7114 4/11 [=========>....................] - ETA: 0s - loss: 0.0389 - accuracy: 0.7171 5/11 [============>.................] - ETA: 0s - loss: 0.0394 - accuracy: 0.7199 6/11 [===============>..............] - ETA: 0s - loss: 0.0396 - accuracy: 0.7221 7/11 [==================>...........] - ETA: 0s - loss: 0.0397 - accuracy: 0.7240 8/11 [====================>.........] - ETA: 0s - loss: 0.0398 - accuracy: 0.7262 9/11 [=======================>......] - ETA: 0s - loss: 0.0399 - accuracy: 0.728810/11 [==========================>...] - ETA: 0s - loss: 0.0400 - accuracy: 0.732011/11 [==============================] - ETA: 0s - loss: 0.0399 - accuracy: 0.735211/11 [==============================] - 1s 107ms/step - loss: 0.0399 - accuracy: 0.7379
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0439 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 0s - loss: 0.0418 - accuracy: 0.7871 3/11 [=======>......................] - ETA: 0s - loss: 0.0405 - accuracy: 0.7799 4/11 [=========>....................] - ETA: 0s - loss: 0.0398 - accuracy: 0.7739 5/11 [============>.................] - ETA: 0s - loss: 0.0395 - accuracy: 0.7720 6/11 [===============>..............] - ETA: 0s - loss: 0.0393 - accuracy: 0.7696 7/11 [==================>...........] - ETA: 0s - loss: 0.0392 - accuracy: 0.7681 8/11 [====================>.........] - ETA: 0s - loss: 0.0391 - accuracy: 0.7683 9/11 [=======================>......] - ETA: 0s - loss: 0.0390 - accuracy: 0.769710/11 [==========================>...] - ETA: 0s - loss: 0.0389 - accuracy: 0.771611/11 [==============================] - ETA: 0s - loss: 0.0387 - accuracy: 0.773411/11 [==============================] - 1s 105ms/step - loss: 0.0386 - accuracy: 0.7749
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0363 - accuracy: 0.7031 2/11 [====>.........................] - ETA: 0s - loss: 0.0361 - accuracy: 0.7168 3/11 [=======>......................] - ETA: 0s - loss: 0.0357 - accuracy: 0.7235 4/11 [=========>....................] - ETA: 0s - loss: 0.0354 - accuracy: 0.7282 5/11 [============>.................] - ETA: 0s - loss: 0.0352 - accuracy: 0.7354 6/11 [===============>..............] - ETA: 0s - loss: 0.0350 - accuracy: 0.7417 7/11 [==================>...........] - ETA: 0s - loss: 0.0348 - accuracy: 0.7478 8/11 [====================>.........] - ETA: 0s - loss: 0.0348 - accuracy: 0.7520 9/11 [=======================>......] - ETA: 0s - loss: 0.0348 - accuracy: 0.755610/11 [==========================>...] - ETA: 0s - loss: 0.0347 - accuracy: 0.758711/11 [==============================] - ETA: 0s - loss: 0.0346 - accuracy: 0.761311/11 [==============================] - 1s 100ms/step - loss: 0.0346 - accuracy: 0.7636
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0293 - accuracy: 0.8984 2/11 [====>.........................] - ETA: 0s - loss: 0.0308 - accuracy: 0.9004 3/11 [=======>......................] - ETA: 0s - loss: 0.0312 - accuracy: 0.8989 4/11 [=========>....................] - ETA: 0s - loss: 0.0313 - accuracy: 0.8939 5/11 [============>.................] - ETA: 0s - loss: 0.0316 - accuracy: 0.8885 6/11 [===============>..............] - ETA: 0s - loss: 0.0316 - accuracy: 0.8832 7/11 [==================>...........] - ETA: 0s - loss: 0.0316 - accuracy: 0.8784 8/11 [====================>.........] - ETA: 0s - loss: 0.0317 - accuracy: 0.8749 9/11 [=======================>......] - ETA: 0s - loss: 0.0318 - accuracy: 0.871810/11 [==========================>...] - ETA: 0s - loss: 0.0318 - accuracy: 0.869211/11 [==============================] - ETA: 0s - loss: 0.0318 - accuracy: 0.867111/11 [==============================] - 1s 103ms/step - loss: 0.0318 - accuracy: 0.8654
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0257 - accuracy: 0.8594 2/11 [====>.........................] - ETA: 0s - loss: 0.0282 - accuracy: 0.8242 3/11 [=======>......................] - ETA: 0s - loss: 0.0290 - accuracy: 0.8186 4/11 [=========>....................] - ETA: 0s - loss: 0.0296 - accuracy: 0.8171 5/11 [============>.................] - ETA: 0s - loss: 0.0297 - accuracy: 0.8180 6/11 [===============>..............] - ETA: 0s - loss: 0.0298 - accuracy: 0.8186 7/11 [==================>...........] - ETA: 0s - loss: 0.0299 - accuracy: 0.8189 8/11 [====================>.........] - ETA: 0s - loss: 0.0301 - accuracy: 0.8199 9/11 [=======================>......] - ETA: 0s - loss: 0.0301 - accuracy: 0.821910/11 [==========================>...] - ETA: 0s - loss: 0.0300 - accuracy: 0.824511/11 [==============================] - ETA: 0s - loss: 0.0300 - accuracy: 0.826911/11 [==============================] - 1s 104ms/step - loss: 0.0299 - accuracy: 0.8289
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0279 - accuracy: 0.95313/6 [==============>...............] - ETA: 0s - loss: 0.0256 - accuracy: 0.9193 5/6 [========================>.....] - ETA: 0s - loss: 0.0279 - accuracy: 0.90476/6 [==============================] - 4s 31ms/step - loss: 0.0278 - accuracy: 0.9051
2021-12-14 00:05:24.219324: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:05:24.220153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:05:24.220200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:05:24.220242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:05:24.220270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:05:24.220297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:05:24.220324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:05:24.220351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:05:24.220378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:05:24.220407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:05:24.221520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:05:24.221548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:05:24.221558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:05:24.221566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 2 0 1] pred: [0.03378028 0.01363233 0.0442591  0.88705814 0.04530099]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [0.00218424 0.01396888 0.94942623 0.01338032 0.00141034]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [2.0019412e-03 2.4382800e-02 9.5809376e-01 8.7171793e-03 9.3424320e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.02999339 0.88272583 0.76199585 0.02013391 0.00324818]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [0.01455969 0.7680105  0.80419046 0.02781981 0.00290358]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [4 3 2 0 1] pred: [0.06796786 0.01737863 0.09696704 0.45306554 0.8416672 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 2 0 1] pred: [0.02217492 0.00984722 0.0563637  0.8281052  0.12529477]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 0 4] pred: [0.00225642 0.01170969 0.9263195  0.02416271 0.00217506]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [0.02568167 0.52173644 0.5868568  0.15313867 0.00984612]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [0.02931726 0.9332379  0.7756547  0.02122253 0.00392669]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [0.0155085  0.34062946 0.48902845 0.12031552 0.00405055]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [0.02448416 0.91026986 0.77866244 0.0217599  0.00343195]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [0 1 2 3 4] pred: [0.8226136  0.29552108 0.09934741 0.09109384 0.07750195]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [0 1 3 2 4] pred: [0.810261   0.25148058 0.09092194 0.11812833 0.08995664]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [0.02829036 0.91188663 0.6875278  0.02265251 0.00363317]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:55 - loss: 0.2490 - accuracy: 0.3594 2/11 [====>.........................] - ETA: 0s - loss: 0.2485 - accuracy: 0.3984   3/11 [=======>......................] - ETA: 0s - loss: 0.2480 - accuracy: 0.4158 4/11 [=========>....................] - ETA: 0s - loss: 0.2475 - accuracy: 0.4251 5/11 [============>.................] - ETA: 0s - loss: 0.2469 - accuracy: 0.4304 6/11 [===============>..............] - ETA: 0s - loss: 0.2464 - accuracy: 0.4338 7/11 [==================>...........] - ETA: 0s - loss: 0.2459 - accuracy: 0.4359 8/11 [====================>.........] - ETA: 0s - loss: 0.2453 - accuracy: 0.4366 9/11 [=======================>......] - ETA: 0s - loss: 0.2447 - accuracy: 0.437510/11 [==========================>...] - ETA: 0s - loss: 0.2442 - accuracy: 0.437911/11 [==============================] - ETA: 0s - loss: 0.2436 - accuracy: 0.438311/11 [==============================] - 13s 105ms/step - loss: 0.2431 - accuracy: 0.4385
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2202 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.2198 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.2190 - accuracy: 0.4540 4/11 [=========>....................] - ETA: 0s - loss: 0.2180 - accuracy: 0.4572 5/11 [============>.................] - ETA: 0s - loss: 0.2169 - accuracy: 0.4604 6/11 [===============>..............] - ETA: 0s - loss: 0.2158 - accuracy: 0.4610 7/11 [==================>...........] - ETA: 0s - loss: 0.2146 - accuracy: 0.4616 8/11 [====================>.........] - ETA: 0s - loss: 0.2134 - accuracy: 0.4609 9/11 [=======================>......] - ETA: 0s - loss: 0.2122 - accuracy: 0.459710/11 [==========================>...] - ETA: 0s - loss: 0.2109 - accuracy: 0.458211/11 [==============================] - ETA: 0s - loss: 0.2097 - accuracy: 0.457511/11 [==============================] - 1s 104ms/step - loss: 0.2087 - accuracy: 0.4569
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1562 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.1559 - accuracy: 0.4395 3/11 [=======>......................] - ETA: 0s - loss: 0.1538 - accuracy: 0.4457 4/11 [=========>....................] - ETA: 0s - loss: 0.1524 - accuracy: 0.4500 5/11 [============>.................] - ETA: 0s - loss: 0.1505 - accuracy: 0.4525 6/11 [===============>..............] - ETA: 0s - loss: 0.1486 - accuracy: 0.4537 7/11 [==================>...........] - ETA: 0s - loss: 0.1469 - accuracy: 0.4536 8/11 [====================>.........] - ETA: 0s - loss: 0.1455 - accuracy: 0.4537 9/11 [=======================>......] - ETA: 0s - loss: 0.1441 - accuracy: 0.453510/11 [==========================>...] - ETA: 0s - loss: 0.1429 - accuracy: 0.453311/11 [==============================] - ETA: 0s - loss: 0.1418 - accuracy: 0.453111/11 [==============================] - 1s 101ms/step - loss: 0.1408 - accuracy: 0.4528
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1133 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.1165 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.1160 - accuracy: 0.4618 4/11 [=========>....................] - ETA: 0s - loss: 0.1163 - accuracy: 0.4582 5/11 [============>.................] - ETA: 0s - loss: 0.1164 - accuracy: 0.4575 6/11 [===============>..............] - ETA: 0s - loss: 0.1172 - accuracy: 0.4539 7/11 [==================>...........] - ETA: 0s - loss: 0.1178 - accuracy: 0.4513 8/11 [====================>.........] - ETA: 0s - loss: 0.1179 - accuracy: 0.4495 9/11 [=======================>......] - ETA: 0s - loss: 0.1179 - accuracy: 0.448910/11 [==========================>...] - ETA: 0s - loss: 0.1177 - accuracy: 0.448511/11 [==============================] - ETA: 0s - loss: 0.1174 - accuracy: 0.448711/11 [==============================] - 1s 105ms/step - loss: 0.1172 - accuracy: 0.4488
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1131 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.1152 - accuracy: 0.4316 3/11 [=======>......................] - ETA: 0s - loss: 0.1147 - accuracy: 0.4310 4/11 [=========>....................] - ETA: 0s - loss: 0.1138 - accuracy: 0.4326 5/11 [============>.................] - ETA: 0s - loss: 0.1132 - accuracy: 0.4327 6/11 [===============>..............] - ETA: 0s - loss: 0.1128 - accuracy: 0.4332 7/11 [==================>...........] - ETA: 0s - loss: 0.1126 - accuracy: 0.4340 8/11 [====================>.........] - ETA: 0s - loss: 0.1122 - accuracy: 0.4359 9/11 [=======================>......] - ETA: 0s - loss: 0.1120 - accuracy: 0.436910/11 [==========================>...] - ETA: 0s - loss: 0.1119 - accuracy: 0.437911/11 [==============================] - ETA: 0s - loss: 0.1117 - accuracy: 0.439311/11 [==============================] - 1s 110ms/step - loss: 0.1115 - accuracy: 0.4405
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1138 - accuracy: 0.3672 2/11 [====>.........................] - ETA: 0s - loss: 0.1128 - accuracy: 0.3906 3/11 [=======>......................] - ETA: 0s - loss: 0.1113 - accuracy: 0.4010 4/11 [=========>....................] - ETA: 0s - loss: 0.1104 - accuracy: 0.4087 5/11 [============>.................] - ETA: 0s - loss: 0.1098 - accuracy: 0.4138 6/11 [===============>..............] - ETA: 0s - loss: 0.1092 - accuracy: 0.4178 7/11 [==================>...........] - ETA: 0s - loss: 0.1086 - accuracy: 0.4217 8/11 [====================>.........] - ETA: 0s - loss: 0.1080 - accuracy: 0.4256 9/11 [=======================>......] - ETA: 0s - loss: 0.1073 - accuracy: 0.428610/11 [==========================>...] - ETA: 0s - loss: 0.1067 - accuracy: 0.431411/11 [==============================] - ETA: 0s - loss: 0.1062 - accuracy: 0.433711/11 [==============================] - 1s 109ms/step - loss: 0.1058 - accuracy: 0.4356
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0978 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.0972 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 0s - loss: 0.0951 - accuracy: 0.4822 4/11 [=========>....................] - ETA: 0s - loss: 0.0939 - accuracy: 0.4823 5/11 [============>.................] - ETA: 0s - loss: 0.0930 - accuracy: 0.4833 6/11 [===============>..............] - ETA: 0s - loss: 0.0926 - accuracy: 0.4820 7/11 [==================>...........] - ETA: 0s - loss: 0.0926 - accuracy: 0.4802 8/11 [====================>.........] - ETA: 0s - loss: 0.0925 - accuracy: 0.4798 9/11 [=======================>......] - ETA: 0s - loss: 0.0924 - accuracy: 0.478410/11 [==========================>...] - ETA: 0s - loss: 0.0923 - accuracy: 0.476911/11 [==============================] - ETA: 0s - loss: 0.0922 - accuracy: 0.476011/11 [==============================] - 1s 107ms/step - loss: 0.0921 - accuracy: 0.4752
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0971 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.0970 - accuracy: 0.4590 3/11 [=======>......................] - ETA: 0s - loss: 0.0944 - accuracy: 0.4692 4/11 [=========>....................] - ETA: 0s - loss: 0.0921 - accuracy: 0.4720 5/11 [============>.................] - ETA: 0s - loss: 0.0904 - accuracy: 0.4742 6/11 [===============>..............] - ETA: 0s - loss: 0.0891 - accuracy: 0.4763 7/11 [==================>...........] - ETA: 0s - loss: 0.0881 - accuracy: 0.4776 8/11 [====================>.........] - ETA: 0s - loss: 0.0872 - accuracy: 0.4778 9/11 [=======================>......] - ETA: 0s - loss: 0.0866 - accuracy: 0.478010/11 [==========================>...] - ETA: 0s - loss: 0.0860 - accuracy: 0.478011/11 [==============================] - ETA: 0s - loss: 0.0854 - accuracy: 0.478111/11 [==============================] - 1s 106ms/step - loss: 0.0849 - accuracy: 0.4783
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0639 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.0658 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 0s - loss: 0.0674 - accuracy: 0.5061 4/11 [=========>....................] - ETA: 0s - loss: 0.0687 - accuracy: 0.5002 5/11 [============>.................] - ETA: 0s - loss: 0.0691 - accuracy: 0.4973 6/11 [===============>..............] - ETA: 0s - loss: 0.0696 - accuracy: 0.4956 7/11 [==================>...........] - ETA: 0s - loss: 0.0698 - accuracy: 0.4946 8/11 [====================>.........] - ETA: 0s - loss: 0.0698 - accuracy: 0.4951 9/11 [=======================>......] - ETA: 0s - loss: 0.0698 - accuracy: 0.495710/11 [==========================>...] - ETA: 0s - loss: 0.0699 - accuracy: 0.496311/11 [==============================] - ETA: 0s - loss: 0.0701 - accuracy: 0.496811/11 [==============================] - 1s 107ms/step - loss: 0.0701 - accuracy: 0.4972
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0685 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.0673 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.0663 - accuracy: 0.5608 4/11 [=========>....................] - ETA: 0s - loss: 0.0657 - accuracy: 0.5632 5/11 [============>.................] - ETA: 0s - loss: 0.0655 - accuracy: 0.5708 6/11 [===============>..............] - ETA: 0s - loss: 0.0652 - accuracy: 0.5790 7/11 [==================>...........] - ETA: 0s - loss: 0.0652 - accuracy: 0.5840 8/11 [====================>.........] - ETA: 0s - loss: 0.0653 - accuracy: 0.5879 9/11 [=======================>......] - ETA: 0s - loss: 0.0655 - accuracy: 0.591110/11 [==========================>...] - ETA: 0s - loss: 0.0656 - accuracy: 0.593711/11 [==============================] - ETA: 0s - loss: 0.0656 - accuracy: 0.595511/11 [==============================] - 1s 109ms/step - loss: 0.0657 - accuracy: 0.5969
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0673 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 0s - loss: 0.0670 - accuracy: 0.5508 3/11 [=======>......................] - ETA: 0s - loss: 0.0657 - accuracy: 0.5521 4/11 [=========>....................] - ETA: 0s - loss: 0.0656 - accuracy: 0.5503 5/11 [============>.................] - ETA: 0s - loss: 0.0655 - accuracy: 0.5496 6/11 [===============>..............] - ETA: 0s - loss: 0.0651 - accuracy: 0.5533 7/11 [==================>...........] - ETA: 0s - loss: 0.0647 - accuracy: 0.5552 8/11 [====================>.........] - ETA: 0s - loss: 0.0644 - accuracy: 0.5575 9/11 [=======================>......] - ETA: 0s - loss: 0.0641 - accuracy: 0.560610/11 [==========================>...] - ETA: 0s - loss: 0.0638 - accuracy: 0.564311/11 [==============================] - ETA: 0s - loss: 0.0635 - accuracy: 0.568311/11 [==============================] - 1s 105ms/step - loss: 0.0633 - accuracy: 0.5717
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0569 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 0s - loss: 0.0574 - accuracy: 0.6699 3/11 [=======>......................] - ETA: 0s - loss: 0.0571 - accuracy: 0.6819 4/11 [=========>....................] - ETA: 0s - loss: 0.0570 - accuracy: 0.6823 5/11 [============>.................] - ETA: 0s - loss: 0.0569 - accuracy: 0.6836 6/11 [===============>..............] - ETA: 0s - loss: 0.0568 - accuracy: 0.6834 7/11 [==================>...........] - ETA: 0s - loss: 0.0566 - accuracy: 0.6827 8/11 [====================>.........] - ETA: 0s - loss: 0.0565 - accuracy: 0.6809 9/11 [=======================>......] - ETA: 0s - loss: 0.0564 - accuracy: 0.679610/11 [==========================>...] - ETA: 0s - loss: 0.0562 - accuracy: 0.678411/11 [==============================] - ETA: 0s - loss: 0.0561 - accuracy: 0.677411/11 [==============================] - 1s 104ms/step - loss: 0.0560 - accuracy: 0.6766
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0500 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.0516 - accuracy: 0.6758 3/11 [=======>......................] - ETA: 0s - loss: 0.0517 - accuracy: 0.6840 4/11 [=========>....................] - ETA: 0s - loss: 0.0519 - accuracy: 0.6898 5/11 [============>.................] - ETA: 0s - loss: 0.0519 - accuracy: 0.6962 6/11 [===============>..............] - ETA: 0s - loss: 0.0520 - accuracy: 0.7006 7/11 [==================>...........] - ETA: 0s - loss: 0.0520 - accuracy: 0.7048 8/11 [====================>.........] - ETA: 0s - loss: 0.0519 - accuracy: 0.7081 9/11 [=======================>......] - ETA: 0s - loss: 0.0516 - accuracy: 0.711710/11 [==========================>...] - ETA: 0s - loss: 0.0515 - accuracy: 0.714511/11 [==============================] - ETA: 0s - loss: 0.0514 - accuracy: 0.716411/11 [==============================] - 1s 105ms/step - loss: 0.0513 - accuracy: 0.7181
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0569 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.0538 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.0526 - accuracy: 0.7300 4/11 [=========>....................] - ETA: 0s - loss: 0.0516 - accuracy: 0.7267 5/11 [============>.................] - ETA: 0s - loss: 0.0509 - accuracy: 0.7239 6/11 [===============>..............] - ETA: 0s - loss: 0.0504 - accuracy: 0.7228 7/11 [==================>...........] - ETA: 0s - loss: 0.0499 - accuracy: 0.7218 8/11 [====================>.........] - ETA: 0s - loss: 0.0496 - accuracy: 0.7221 9/11 [=======================>......] - ETA: 0s - loss: 0.0494 - accuracy: 0.722310/11 [==========================>...] - ETA: 0s - loss: 0.0492 - accuracy: 0.723311/11 [==============================] - ETA: 0s - loss: 0.0490 - accuracy: 0.724511/11 [==============================] - 1s 105ms/step - loss: 0.0488 - accuracy: 0.7254
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0367 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.0387 - accuracy: 0.8027 3/11 [=======>......................] - ETA: 0s - loss: 0.0403 - accuracy: 0.7964 4/11 [=========>....................] - ETA: 0s - loss: 0.0409 - accuracy: 0.7922 5/11 [============>.................] - ETA: 0s - loss: 0.0414 - accuracy: 0.7915 6/11 [===============>..............] - ETA: 0s - loss: 0.0417 - accuracy: 0.7890 7/11 [==================>...........] - ETA: 0s - loss: 0.0420 - accuracy: 0.7882 8/11 [====================>.........] - ETA: 0s - loss: 0.0421 - accuracy: 0.7860 9/11 [=======================>......] - ETA: 0s - loss: 0.0423 - accuracy: 0.783510/11 [==========================>...] - ETA: 0s - loss: 0.0425 - accuracy: 0.781611/11 [==============================] - ETA: 0s - loss: 0.0426 - accuracy: 0.779211/11 [==============================] - 1s 108ms/step - loss: 0.0428 - accuracy: 0.7772
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0408 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.0406 - accuracy: 0.7598 3/11 [=======>......................] - ETA: 0s - loss: 0.0399 - accuracy: 0.7661 4/11 [=========>....................] - ETA: 0s - loss: 0.0401 - accuracy: 0.7640 5/11 [============>.................] - ETA: 0s - loss: 0.0401 - accuracy: 0.7646 6/11 [===============>..............] - ETA: 0s - loss: 0.0400 - accuracy: 0.7652 7/11 [==================>...........] - ETA: 0s - loss: 0.0399 - accuracy: 0.7656 8/11 [====================>.........] - ETA: 0s - loss: 0.0399 - accuracy: 0.7666 9/11 [=======================>......] - ETA: 0s - loss: 0.0400 - accuracy: 0.766610/11 [==========================>...] - ETA: 0s - loss: 0.0401 - accuracy: 0.766311/11 [==============================] - ETA: 0s - loss: 0.0402 - accuracy: 0.765811/11 [==============================] - 1s 107ms/step - loss: 0.0403 - accuracy: 0.7653
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0343 - accuracy: 0.8047 2/11 [====>.........................] - ETA: 0s - loss: 0.0364 - accuracy: 0.8340 3/11 [=======>......................] - ETA: 0s - loss: 0.0377 - accuracy: 0.8381 4/11 [=========>....................] - ETA: 0s - loss: 0.0382 - accuracy: 0.8385 5/11 [============>.................] - ETA: 0s - loss: 0.0382 - accuracy: 0.8390 6/11 [===============>..............] - ETA: 0s - loss: 0.0381 - accuracy: 0.8372 7/11 [==================>...........] - ETA: 0s - loss: 0.0382 - accuracy: 0.8341 8/11 [====================>.........] - ETA: 0s - loss: 0.0382 - accuracy: 0.8317 9/11 [=======================>......] - ETA: 0s - loss: 0.0382 - accuracy: 0.828610/11 [==========================>...] - ETA: 0s - loss: 0.0382 - accuracy: 0.825311/11 [==============================] - ETA: 0s - loss: 0.0382 - accuracy: 0.822511/11 [==============================] - 1s 107ms/step - loss: 0.0382 - accuracy: 0.8202
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0359 - accuracy: 0.8047 2/11 [====>.........................] - ETA: 0s - loss: 0.0359 - accuracy: 0.7930 3/11 [=======>......................] - ETA: 0s - loss: 0.0364 - accuracy: 0.7856 4/11 [=========>....................] - ETA: 0s - loss: 0.0365 - accuracy: 0.7811 5/11 [============>.................] - ETA: 0s - loss: 0.0366 - accuracy: 0.7805 6/11 [===============>..............] - ETA: 0s - loss: 0.0367 - accuracy: 0.7806 7/11 [==================>...........] - ETA: 0s - loss: 0.0367 - accuracy: 0.7810 8/11 [====================>.........] - ETA: 0s - loss: 0.0366 - accuracy: 0.7819 9/11 [=======================>......] - ETA: 0s - loss: 0.0367 - accuracy: 0.783110/11 [==========================>...] - ETA: 0s - loss: 0.0366 - accuracy: 0.784411/11 [==============================] - ETA: 0s - loss: 0.0366 - accuracy: 0.785711/11 [==============================] - 1s 106ms/step - loss: 0.0365 - accuracy: 0.7868
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0365 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 0s - loss: 0.0368 - accuracy: 0.8516 3/11 [=======>......................] - ETA: 0s - loss: 0.0360 - accuracy: 0.8533 4/11 [=========>....................] - ETA: 0s - loss: 0.0356 - accuracy: 0.8455 5/11 [============>.................] - ETA: 0s - loss: 0.0353 - accuracy: 0.8377 6/11 [===============>..............] - ETA: 0s - loss: 0.0352 - accuracy: 0.8300 7/11 [==================>...........] - ETA: 0s - loss: 0.0351 - accuracy: 0.8251 8/11 [====================>.........] - ETA: 0s - loss: 0.0351 - accuracy: 0.8206 9/11 [=======================>......] - ETA: 0s - loss: 0.0350 - accuracy: 0.817910/11 [==========================>...] - ETA: 0s - loss: 0.0350 - accuracy: 0.815411/11 [==============================] - ETA: 0s - loss: 0.0349 - accuracy: 0.813411/11 [==============================] - 1s 107ms/step - loss: 0.0348 - accuracy: 0.8117
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0322 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 0s - loss: 0.0321 - accuracy: 0.8457 3/11 [=======>......................] - ETA: 0s - loss: 0.0330 - accuracy: 0.8433 4/11 [=========>....................] - ETA: 0s - loss: 0.0335 - accuracy: 0.8410 5/11 [============>.................] - ETA: 0s - loss: 0.0336 - accuracy: 0.8384 6/11 [===============>..............] - ETA: 0s - loss: 0.0336 - accuracy: 0.8373 7/11 [==================>...........] - ETA: 0s - loss: 0.0335 - accuracy: 0.8362 8/11 [====================>.........] - ETA: 0s - loss: 0.0334 - accuracy: 0.8352 9/11 [=======================>......] - ETA: 0s - loss: 0.0333 - accuracy: 0.834310/11 [==========================>...] - ETA: 0s - loss: 0.0331 - accuracy: 0.833311/11 [==============================] - ETA: 0s - loss: 0.0330 - accuracy: 0.832611/11 [==============================] - 1s 105ms/step - loss: 0.0329 - accuracy: 0.8321
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0331 - accuracy: 0.71093/6 [==============>...............] - ETA: 0s - loss: 0.0316 - accuracy: 0.7656 5/6 [========================>.....] - ETA: 0s - loss: 0.0314 - accuracy: 0.76726/6 [==============================] - 4s 33ms/step - loss: 0.0311 - accuracy: 0.7790
2021-12-14 00:06:12.621788: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:06:12.622672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:06:12.622717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:06:12.622772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:06:12.622802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:06:12.622838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:06:12.622865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:06:12.622899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:06:12.622929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:06:12.622958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:06:12.624097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:06:12.624130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:06:12.624140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:06:12.624149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [0.0125297  0.19361928 0.95082915 0.02041051 0.00277916]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [0 1 3 2 4] pred: [0.5759317  0.2719901  0.11486062 0.17362046 0.03768891]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 0 4] pred: [0.00399765 0.02148122 0.97475183 0.03014129 0.00267017]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [0.01042584 0.8641329  0.92697346 0.00135779 0.00141814]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [0.0386821  0.81802046 0.57642365 0.00493991 0.00200617]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.08886722 0.8146937  0.5186347  0.0081827  0.00302473]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [0.01416105 0.8421215  0.9193262  0.00147963 0.00167185]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 2 0 1] pred: [0.02556697 0.0133411  0.10397905 0.7602595  0.10913277]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [3 4 2 0 1] pred: [0.05720904 0.01592359 0.0608508  0.8802662  0.10690343]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 0 4 1] pred: [0.10617977 0.01663288 0.10674867 0.7771671  0.0193812 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 0 4] pred: [0.00403982 0.02342212 0.9781836  0.0291416  0.00267178]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [0.02803409 0.72732    0.8506813  0.00580537 0.00301924]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 2 4 0 1] pred: [0.01636571 0.01123133 0.22040859 0.7123498  0.06996959]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [0.03534353 0.7994106  0.83794785 0.00302014 0.00216863]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 0 4] pred: [0.00385076 0.01853761 0.9740497  0.03204983 0.00260219]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:06 - loss: 0.2513 - accuracy: 0.0469 2/11 [====>.........................] - ETA: 1s - loss: 0.2508 - accuracy: 0.1035   3/11 [=======>......................] - ETA: 0s - loss: 0.2502 - accuracy: 0.1662 4/11 [=========>....................] - ETA: 0s - loss: 0.2497 - accuracy: 0.2135 5/11 [============>.................] - ETA: 0s - loss: 0.2492 - accuracy: 0.2465 6/11 [===============>..............] - ETA: 0s - loss: 0.2486 - accuracy: 0.2692 7/11 [==================>...........] - ETA: 0s - loss: 0.2481 - accuracy: 0.2865 8/11 [====================>.........] - ETA: 0s - loss: 0.2476 - accuracy: 0.3011 9/11 [=======================>......] - ETA: 0s - loss: 0.2470 - accuracy: 0.313310/11 [==========================>...] - ETA: 0s - loss: 0.2465 - accuracy: 0.323411/11 [==============================] - ETA: 0s - loss: 0.2459 - accuracy: 0.332311/11 [==============================] - 14s 111ms/step - loss: 0.2455 - accuracy: 0.3397
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2233 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.2226 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 0s - loss: 0.2221 - accuracy: 0.4818 4/11 [=========>....................] - ETA: 0s - loss: 0.2214 - accuracy: 0.4746 5/11 [============>.................] - ETA: 0s - loss: 0.2204 - accuracy: 0.4731 6/11 [===============>..............] - ETA: 0s - loss: 0.2193 - accuracy: 0.4741 7/11 [==================>...........] - ETA: 0s - loss: 0.2182 - accuracy: 0.4740 8/11 [====================>.........] - ETA: 0s - loss: 0.2171 - accuracy: 0.4732 9/11 [=======================>......] - ETA: 0s - loss: 0.2160 - accuracy: 0.472610/11 [==========================>...] - ETA: 0s - loss: 0.2148 - accuracy: 0.471911/11 [==============================] - ETA: 0s - loss: 0.2136 - accuracy: 0.471511/11 [==============================] - 1s 108ms/step - loss: 0.2126 - accuracy: 0.4712
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1678 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.1639 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.1620 - accuracy: 0.4618 4/11 [=========>....................] - ETA: 0s - loss: 0.1598 - accuracy: 0.4650 5/11 [============>.................] - ETA: 0s - loss: 0.1579 - accuracy: 0.4651 6/11 [===============>..............] - ETA: 0s - loss: 0.1562 - accuracy: 0.4646 7/11 [==================>...........] - ETA: 0s - loss: 0.1545 - accuracy: 0.4652 8/11 [====================>.........] - ETA: 0s - loss: 0.1530 - accuracy: 0.4658 9/11 [=======================>......] - ETA: 0s - loss: 0.1515 - accuracy: 0.466510/11 [==========================>...] - ETA: 0s - loss: 0.1502 - accuracy: 0.467011/11 [==============================] - ETA: 0s - loss: 0.1490 - accuracy: 0.467011/11 [==============================] - 1s 107ms/step - loss: 0.1481 - accuracy: 0.4671
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1176 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.1160 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 0s - loss: 0.1152 - accuracy: 0.4666 4/11 [=========>....................] - ETA: 0s - loss: 0.1151 - accuracy: 0.4671 5/11 [============>.................] - ETA: 0s - loss: 0.1148 - accuracy: 0.4684 6/11 [===============>..............] - ETA: 0s - loss: 0.1146 - accuracy: 0.4687 7/11 [==================>...........] - ETA: 0s - loss: 0.1145 - accuracy: 0.4690 8/11 [====================>.........] - ETA: 0s - loss: 0.1143 - accuracy: 0.4693 9/11 [=======================>......] - ETA: 0s - loss: 0.1141 - accuracy: 0.469510/11 [==========================>...] - ETA: 0s - loss: 0.1140 - accuracy: 0.469211/11 [==============================] - ETA: 0s - loss: 0.1140 - accuracy: 0.469111/11 [==============================] - 1s 110ms/step - loss: 0.1139 - accuracy: 0.4690
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1183 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.1138 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 0s - loss: 0.1115 - accuracy: 0.4822 4/11 [=========>....................] - ETA: 0s - loss: 0.1099 - accuracy: 0.4793 5/11 [============>.................] - ETA: 0s - loss: 0.1095 - accuracy: 0.4744 6/11 [===============>..............] - ETA: 0s - loss: 0.1093 - accuracy: 0.4691 7/11 [==================>...........] - ETA: 0s - loss: 0.1091 - accuracy: 0.4662 8/11 [====================>.........] - ETA: 0s - loss: 0.1088 - accuracy: 0.4643 9/11 [=======================>......] - ETA: 0s - loss: 0.1085 - accuracy: 0.463810/11 [==========================>...] - ETA: 0s - loss: 0.1083 - accuracy: 0.464111/11 [==============================] - ETA: 0s - loss: 0.1082 - accuracy: 0.464411/11 [==============================] - 1s 103ms/step - loss: 0.1081 - accuracy: 0.4647
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1004 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.0991 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 0s - loss: 0.0996 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.1001 - accuracy: 0.4961 5/11 [============>.................] - ETA: 0s - loss: 0.1004 - accuracy: 0.4916 6/11 [===============>..............] - ETA: 0s - loss: 0.1008 - accuracy: 0.4884 7/11 [==================>...........] - ETA: 0s - loss: 0.1010 - accuracy: 0.4858 8/11 [====================>.........] - ETA: 0s - loss: 0.1010 - accuracy: 0.4835 9/11 [=======================>......] - ETA: 0s - loss: 0.1010 - accuracy: 0.481510/11 [==========================>...] - ETA: 0s - loss: 0.1009 - accuracy: 0.480411/11 [==============================] - ETA: 0s - loss: 0.1009 - accuracy: 0.479411/11 [==============================] - 1s 101ms/step - loss: 0.1009 - accuracy: 0.4785
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0924 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 1s - loss: 0.0928 - accuracy: 0.5352 3/11 [=======>......................] - ETA: 0s - loss: 0.0925 - accuracy: 0.5295 4/11 [=========>....................] - ETA: 0s - loss: 0.0926 - accuracy: 0.5231 5/11 [============>.................] - ETA: 0s - loss: 0.0923 - accuracy: 0.5194 6/11 [===============>..............] - ETA: 0s - loss: 0.0919 - accuracy: 0.5160 7/11 [==================>...........] - ETA: 0s - loss: 0.0916 - accuracy: 0.5121 8/11 [====================>.........] - ETA: 0s - loss: 0.0916 - accuracy: 0.5085 9/11 [=======================>......] - ETA: 0s - loss: 0.0915 - accuracy: 0.505310/11 [==========================>...] - ETA: 0s - loss: 0.0916 - accuracy: 0.502211/11 [==============================] - ETA: 0s - loss: 0.0917 - accuracy: 0.499511/11 [==============================] - 1s 105ms/step - loss: 0.0918 - accuracy: 0.4972
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0920 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.0889 - accuracy: 0.4883 3/11 [=======>......................] - ETA: 0s - loss: 0.0881 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.0885 - accuracy: 0.4912 5/11 [============>.................] - ETA: 0s - loss: 0.0886 - accuracy: 0.4942 6/11 [===============>..............] - ETA: 0s - loss: 0.0885 - accuracy: 0.4956 7/11 [==================>...........] - ETA: 0s - loss: 0.0883 - accuracy: 0.4970 8/11 [====================>.........] - ETA: 0s - loss: 0.0878 - accuracy: 0.4973 9/11 [=======================>......] - ETA: 0s - loss: 0.0874 - accuracy: 0.497110/11 [==========================>...] - ETA: 0s - loss: 0.0870 - accuracy: 0.497611/11 [==============================] - ETA: 0s - loss: 0.0866 - accuracy: 0.498011/11 [==============================] - 1s 102ms/step - loss: 0.0863 - accuracy: 0.4984
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0775 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 1s - loss: 0.0765 - accuracy: 0.5410 3/11 [=======>......................] - ETA: 1s - loss: 0.0747 - accuracy: 0.5412 4/11 [=========>....................] - ETA: 0s - loss: 0.0746 - accuracy: 0.5417 5/11 [============>.................] - ETA: 0s - loss: 0.0744 - accuracy: 0.5480 6/11 [===============>..............] - ETA: 0s - loss: 0.0742 - accuracy: 0.5524 7/11 [==================>...........] - ETA: 0s - loss: 0.0741 - accuracy: 0.5538 8/11 [====================>.........] - ETA: 0s - loss: 0.0741 - accuracy: 0.5538 9/11 [=======================>......] - ETA: 0s - loss: 0.0740 - accuracy: 0.553410/11 [==========================>...] - ETA: 0s - loss: 0.0739 - accuracy: 0.553711/11 [==============================] - ETA: 0s - loss: 0.0738 - accuracy: 0.553711/11 [==============================] - 1s 116ms/step - loss: 0.0738 - accuracy: 0.5538
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0637 - accuracy: 0.5859 2/11 [====>.........................] - ETA: 1s - loss: 0.0648 - accuracy: 0.5879 3/11 [=======>......................] - ETA: 0s - loss: 0.0658 - accuracy: 0.5864 4/11 [=========>....................] - ETA: 0s - loss: 0.0661 - accuracy: 0.5892 5/11 [============>.................] - ETA: 0s - loss: 0.0662 - accuracy: 0.5910 6/11 [===============>..............] - ETA: 0s - loss: 0.0663 - accuracy: 0.5926 7/11 [==================>...........] - ETA: 0s - loss: 0.0663 - accuracy: 0.5943 8/11 [====================>.........] - ETA: 0s - loss: 0.0662 - accuracy: 0.5950 9/11 [=======================>......] - ETA: 0s - loss: 0.0661 - accuracy: 0.596710/11 [==========================>...] - ETA: 0s - loss: 0.0659 - accuracy: 0.597811/11 [==============================] - ETA: 0s - loss: 0.0658 - accuracy: 0.598511/11 [==============================] - 1s 106ms/step - loss: 0.0657 - accuracy: 0.5992
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0791 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.0718 - accuracy: 0.4941 3/11 [=======>......................] - ETA: 0s - loss: 0.0686 - accuracy: 0.5100 4/11 [=========>....................] - ETA: 0s - loss: 0.0666 - accuracy: 0.5280 5/11 [============>.................] - ETA: 0s - loss: 0.0652 - accuracy: 0.5443 6/11 [===============>..............] - ETA: 0s - loss: 0.0642 - accuracy: 0.5566 7/11 [==================>...........] - ETA: 0s - loss: 0.0637 - accuracy: 0.5651 8/11 [====================>.........] - ETA: 0s - loss: 0.0633 - accuracy: 0.5725 9/11 [=======================>......] - ETA: 0s - loss: 0.0630 - accuracy: 0.577610/11 [==========================>...] - ETA: 0s - loss: 0.0626 - accuracy: 0.581511/11 [==============================] - ETA: 0s - loss: 0.0621 - accuracy: 0.585011/11 [==============================] - 1s 109ms/step - loss: 0.0618 - accuracy: 0.5879
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0577 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 1s - loss: 0.0590 - accuracy: 0.6133 3/11 [=======>......................] - ETA: 0s - loss: 0.0583 - accuracy: 0.6050 4/11 [=========>....................] - ETA: 0s - loss: 0.0573 - accuracy: 0.6027 5/11 [============>.................] - ETA: 0s - loss: 0.0568 - accuracy: 0.6040 6/11 [===============>..............] - ETA: 0s - loss: 0.0564 - accuracy: 0.6082 7/11 [==================>...........] - ETA: 0s - loss: 0.0560 - accuracy: 0.6146 8/11 [====================>.........] - ETA: 0s - loss: 0.0557 - accuracy: 0.6209 9/11 [=======================>......] - ETA: 0s - loss: 0.0554 - accuracy: 0.626410/11 [==========================>...] - ETA: 0s - loss: 0.0552 - accuracy: 0.630311/11 [==============================] - ETA: 0s - loss: 0.0549 - accuracy: 0.633111/11 [==============================] - 1s 105ms/step - loss: 0.0548 - accuracy: 0.6354
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0493 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 0s - loss: 0.0478 - accuracy: 0.6680 3/11 [=======>......................] - ETA: 0s - loss: 0.0483 - accuracy: 0.6623 4/11 [=========>....................] - ETA: 0s - loss: 0.0485 - accuracy: 0.6632 5/11 [============>.................] - ETA: 0s - loss: 0.0487 - accuracy: 0.6659 6/11 [===============>..............] - ETA: 0s - loss: 0.0490 - accuracy: 0.6673 7/11 [==================>...........] - ETA: 0s - loss: 0.0491 - accuracy: 0.6688 8/11 [====================>.........] - ETA: 0s - loss: 0.0491 - accuracy: 0.6706 9/11 [=======================>......] - ETA: 0s - loss: 0.0490 - accuracy: 0.672610/11 [==========================>...] - ETA: 0s - loss: 0.0489 - accuracy: 0.674611/11 [==============================] - ETA: 0s - loss: 0.0487 - accuracy: 0.676311/11 [==============================] - 1s 105ms/step - loss: 0.0486 - accuracy: 0.6777
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0433 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.0428 - accuracy: 0.8008 3/11 [=======>......................] - ETA: 0s - loss: 0.0425 - accuracy: 0.8116 4/11 [=========>....................] - ETA: 0s - loss: 0.0427 - accuracy: 0.8182 5/11 [============>.................] - ETA: 0s - loss: 0.0431 - accuracy: 0.8230 6/11 [===============>..............] - ETA: 0s - loss: 0.0436 - accuracy: 0.8247 7/11 [==================>...........] - ETA: 0s - loss: 0.0437 - accuracy: 0.8266 8/11 [====================>.........] - ETA: 0s - loss: 0.0436 - accuracy: 0.8272 9/11 [=======================>......] - ETA: 0s - loss: 0.0436 - accuracy: 0.826310/11 [==========================>...] - ETA: 0s - loss: 0.0435 - accuracy: 0.824711/11 [==============================] - ETA: 0s - loss: 0.0435 - accuracy: 0.822511/11 [==============================] - 1s 102ms/step - loss: 0.0435 - accuracy: 0.8207
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0401 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.0419 - accuracy: 0.7207 3/11 [=======>......................] - ETA: 0s - loss: 0.0415 - accuracy: 0.7279 4/11 [=========>....................] - ETA: 0s - loss: 0.0417 - accuracy: 0.7358 5/11 [============>.................] - ETA: 0s - loss: 0.0415 - accuracy: 0.7437 6/11 [===============>..............] - ETA: 0s - loss: 0.0414 - accuracy: 0.7528 7/11 [==================>...........] - ETA: 0s - loss: 0.0413 - accuracy: 0.7605 8/11 [====================>.........] - ETA: 0s - loss: 0.0413 - accuracy: 0.7671 9/11 [=======================>......] - ETA: 0s - loss: 0.0412 - accuracy: 0.772510/11 [==========================>...] - ETA: 0s - loss: 0.0411 - accuracy: 0.777111/11 [==============================] - ETA: 0s - loss: 0.0410 - accuracy: 0.780111/11 [==============================] - 1s 102ms/step - loss: 0.0409 - accuracy: 0.7827
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0427 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 0s - loss: 0.0420 - accuracy: 0.7715 3/11 [=======>......................] - ETA: 0s - loss: 0.0411 - accuracy: 0.7895 4/11 [=========>....................] - ETA: 0s - loss: 0.0407 - accuracy: 0.7972 5/11 [============>.................] - ETA: 0s - loss: 0.0403 - accuracy: 0.8021 6/11 [===============>..............] - ETA: 0s - loss: 0.0400 - accuracy: 0.8073 7/11 [==================>...........] - ETA: 0s - loss: 0.0398 - accuracy: 0.8111 8/11 [====================>.........] - ETA: 0s - loss: 0.0397 - accuracy: 0.8129 9/11 [=======================>......] - ETA: 0s - loss: 0.0395 - accuracy: 0.814910/11 [==========================>...] - ETA: 0s - loss: 0.0394 - accuracy: 0.817011/11 [==============================] - ETA: 0s - loss: 0.0392 - accuracy: 0.819111/11 [==============================] - 1s 106ms/step - loss: 0.0391 - accuracy: 0.8208
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0366 - accuracy: 0.8906 2/11 [====>.........................] - ETA: 0s - loss: 0.0357 - accuracy: 0.8965 3/11 [=======>......................] - ETA: 0s - loss: 0.0349 - accuracy: 0.8997 4/11 [=========>....................] - ETA: 0s - loss: 0.0345 - accuracy: 0.9019 5/11 [============>.................] - ETA: 0s - loss: 0.0342 - accuracy: 0.9037 6/11 [===============>..............] - ETA: 0s - loss: 0.0341 - accuracy: 0.9028 7/11 [==================>...........] - ETA: 0s - loss: 0.0342 - accuracy: 0.9004 8/11 [====================>.........] - ETA: 0s - loss: 0.0344 - accuracy: 0.8972 9/11 [=======================>......] - ETA: 0s - loss: 0.0346 - accuracy: 0.892710/11 [==========================>...] - ETA: 0s - loss: 0.0348 - accuracy: 0.888511/11 [==============================] - ETA: 0s - loss: 0.0349 - accuracy: 0.884811/11 [==============================] - 1s 108ms/step - loss: 0.0350 - accuracy: 0.8817
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0323 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 0s - loss: 0.0327 - accuracy: 0.8730 3/11 [=======>......................] - ETA: 0s - loss: 0.0330 - accuracy: 0.8772 4/11 [=========>....................] - ETA: 0s - loss: 0.0328 - accuracy: 0.8815 5/11 [============>.................] - ETA: 0s - loss: 0.0327 - accuracy: 0.8833 6/11 [===============>..............] - ETA: 0s - loss: 0.0329 - accuracy: 0.8850 7/11 [==================>...........] - ETA: 0s - loss: 0.0329 - accuracy: 0.8866 8/11 [====================>.........] - ETA: 0s - loss: 0.0330 - accuracy: 0.8872 9/11 [=======================>......] - ETA: 0s - loss: 0.0330 - accuracy: 0.887610/11 [==========================>...] - ETA: 0s - loss: 0.0331 - accuracy: 0.887211/11 [==============================] - ETA: 0s - loss: 0.0331 - accuracy: 0.886811/11 [==============================] - 1s 105ms/step - loss: 0.0331 - accuracy: 0.8865
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0354 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 0s - loss: 0.0327 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.0329 - accuracy: 0.7839 4/11 [=========>....................] - ETA: 0s - loss: 0.0335 - accuracy: 0.7822 5/11 [============>.................] - ETA: 0s - loss: 0.0338 - accuracy: 0.7830 6/11 [===============>..............] - ETA: 0s - loss: 0.0339 - accuracy: 0.7859 7/11 [==================>...........] - ETA: 0s - loss: 0.0339 - accuracy: 0.7908 8/11 [====================>.........] - ETA: 0s - loss: 0.0337 - accuracy: 0.7959 9/11 [=======================>......] - ETA: 0s - loss: 0.0336 - accuracy: 0.800810/11 [==========================>...] - ETA: 0s - loss: 0.0335 - accuracy: 0.805911/11 [==============================] - ETA: 0s - loss: 0.0334 - accuracy: 0.810411/11 [==============================] - 1s 109ms/step - loss: 0.0333 - accuracy: 0.8142
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0317 - accuracy: 0.9375 2/11 [====>.........................] - ETA: 0s - loss: 0.0325 - accuracy: 0.9414 3/11 [=======>......................] - ETA: 0s - loss: 0.0323 - accuracy: 0.9427 4/11 [=========>....................] - ETA: 0s - loss: 0.0321 - accuracy: 0.9419 5/11 [============>.................] - ETA: 0s - loss: 0.0321 - accuracy: 0.9373 6/11 [===============>..............] - ETA: 0s - loss: 0.0320 - accuracy: 0.9330 7/11 [==================>...........] - ETA: 0s - loss: 0.0320 - accuracy: 0.9290 8/11 [====================>.........] - ETA: 0s - loss: 0.0319 - accuracy: 0.9259 9/11 [=======================>......] - ETA: 0s - loss: 0.0318 - accuracy: 0.923710/11 [==========================>...] - ETA: 0s - loss: 0.0317 - accuracy: 0.922011/11 [==============================] - ETA: 0s - loss: 0.0316 - accuracy: 0.920811/11 [==============================] - 1s 109ms/step - loss: 0.0316 - accuracy: 0.9197
Evaluate on test data
1/6 [====>.........................] - ETA: 18s - loss: 0.0378 - accuracy: 0.93753/6 [==============>...............] - ETA: 0s - loss: 0.0349 - accuracy: 0.9219 5/6 [========================>.....] - ETA: 0s - loss: 0.0331 - accuracy: 0.92036/6 [==============================] - 4s 30ms/step - loss: 0.0334 - accuracy: 0.9207
2021-12-14 00:07:01.014127: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:07:01.014978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:07:01.015034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:07:01.015077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:07:01.015108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:07:01.015144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:07:01.015173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:07:01.015206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:07:01.015234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:07:01.015264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:07:01.016385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:07:01.016414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:07:01.016424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:07:01.016433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [0.02736869 0.92998445 0.76583576 0.01057461 0.00216249]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 0 2 1] pred: [0.13931692 0.04591945 0.11252221 0.7541172  0.73015285]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [0.00465727 0.40568918 0.91013086 0.02009496 0.00193891]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [8.7839365e-04 3.0946940e-02 9.7178066e-01 2.7509242e-02 1.4129579e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [3 2 4 0 1] pred: [0.01816249 0.01152894 0.07927793 0.803005   0.07384536]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.02161923 0.93955326 0.79269814 0.00872958 0.00173751]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [0.00699937 0.7664352  0.8901398  0.01027411 0.00089723]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [0.01468864 0.93281615 0.8485989  0.00694671 0.00106129]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [0.05713117 0.8300437  0.47963792 0.02780163 0.00335792]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [0.00102434 0.04525396 0.96259975 0.02670372 0.00157017]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [0.00469166 0.43166524 0.9212178  0.01484531 0.00128612]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [4 3 0 2 1] pred: [0.34582448 0.20800006 0.2491929  0.61689836 0.6204587 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 3 0 4] pred: [0.04065976 0.44749543 0.41976637 0.06705764 0.00312477]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [8.8599324e-04 3.1277686e-02 9.7115839e-01 2.7528137e-02 1.4218390e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [0.00182253 0.12127829 0.95790106 0.01767117 0.00218105]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:05 - loss: 0.2500 - accuracy: 0.1406 2/11 [====>.........................] - ETA: 0s - loss: 0.2495 - accuracy: 0.1934   3/11 [=======>......................] - ETA: 0s - loss: 0.2490 - accuracy: 0.2201 4/11 [=========>....................] - ETA: 0s - loss: 0.2484 - accuracy: 0.2417 5/11 [============>.................] - ETA: 0s - loss: 0.2478 - accuracy: 0.2624 6/11 [===============>..............] - ETA: 0s - loss: 0.2473 - accuracy: 0.2788 7/11 [==================>...........] - ETA: 0s - loss: 0.2467 - accuracy: 0.2913 8/11 [====================>.........] - ETA: 0s - loss: 0.2462 - accuracy: 0.3005 9/11 [=======================>......] - ETA: 0s - loss: 0.2456 - accuracy: 0.308910/11 [==========================>...] - ETA: 0s - loss: 0.2450 - accuracy: 0.316011/11 [==============================] - ETA: 0s - loss: 0.2444 - accuracy: 0.322011/11 [==============================] - 14s 103ms/step - loss: 0.2440 - accuracy: 0.3270
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2221 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.2212 - accuracy: 0.4277 3/11 [=======>......................] - ETA: 0s - loss: 0.2202 - accuracy: 0.4240 4/11 [=========>....................] - ETA: 0s - loss: 0.2190 - accuracy: 0.4211 5/11 [============>.................] - ETA: 0s - loss: 0.2179 - accuracy: 0.4203 6/11 [===============>..............] - ETA: 0s - loss: 0.2167 - accuracy: 0.4206 7/11 [==================>...........] - ETA: 0s - loss: 0.2155 - accuracy: 0.4220 8/11 [====================>.........] - ETA: 0s - loss: 0.2143 - accuracy: 0.4238 9/11 [=======================>......] - ETA: 0s - loss: 0.2130 - accuracy: 0.426010/11 [==========================>...] - ETA: 0s - loss: 0.2117 - accuracy: 0.427911/11 [==============================] - ETA: 0s - loss: 0.2105 - accuracy: 0.429211/11 [==============================] - 1s 107ms/step - loss: 0.2095 - accuracy: 0.4304
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1638 - accuracy: 0.3672 2/11 [====>.........................] - ETA: 1s - loss: 0.1612 - accuracy: 0.3809 3/11 [=======>......................] - ETA: 0s - loss: 0.1588 - accuracy: 0.3937 4/11 [=========>....................] - ETA: 0s - loss: 0.1572 - accuracy: 0.3993 5/11 [============>.................] - ETA: 0s - loss: 0.1553 - accuracy: 0.4025 6/11 [===============>..............] - ETA: 0s - loss: 0.1535 - accuracy: 0.4079 7/11 [==================>...........] - ETA: 0s - loss: 0.1518 - accuracy: 0.4129 8/11 [====================>.........] - ETA: 0s - loss: 0.1502 - accuracy: 0.4165 9/11 [=======================>......] - ETA: 0s - loss: 0.1487 - accuracy: 0.419510/11 [==========================>...] - ETA: 0s - loss: 0.1475 - accuracy: 0.421811/11 [==============================] - ETA: 0s - loss: 0.1463 - accuracy: 0.423711/11 [==============================] - 1s 107ms/step - loss: 0.1454 - accuracy: 0.4253
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1178 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.1161 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.1155 - accuracy: 0.4787 4/11 [=========>....................] - ETA: 0s - loss: 0.1150 - accuracy: 0.4762 5/11 [============>.................] - ETA: 0s - loss: 0.1144 - accuracy: 0.4747 6/11 [===============>..............] - ETA: 0s - loss: 0.1142 - accuracy: 0.4724 7/11 [==================>...........] - ETA: 0s - loss: 0.1141 - accuracy: 0.4703 8/11 [====================>.........] - ETA: 0s - loss: 0.1142 - accuracy: 0.4680 9/11 [=======================>......] - ETA: 0s - loss: 0.1144 - accuracy: 0.465510/11 [==========================>...] - ETA: 0s - loss: 0.1147 - accuracy: 0.463311/11 [==============================] - ETA: 0s - loss: 0.1148 - accuracy: 0.461411/11 [==============================] - 1s 101ms/step - loss: 0.1150 - accuracy: 0.4599
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1282 - accuracy: 0.3906 2/11 [====>.........................] - ETA: 0s - loss: 0.1209 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.1200 - accuracy: 0.4028 4/11 [=========>....................] - ETA: 0s - loss: 0.1205 - accuracy: 0.4027 5/11 [============>.................] - ETA: 0s - loss: 0.1200 - accuracy: 0.4056 6/11 [===============>..............] - ETA: 0s - loss: 0.1194 - accuracy: 0.4105 7/11 [==================>...........] - ETA: 0s - loss: 0.1186 - accuracy: 0.4154 8/11 [====================>.........] - ETA: 0s - loss: 0.1180 - accuracy: 0.4191 9/11 [=======================>......] - ETA: 0s - loss: 0.1174 - accuracy: 0.422210/11 [==========================>...] - ETA: 0s - loss: 0.1170 - accuracy: 0.424311/11 [==============================] - ETA: 0s - loss: 0.1166 - accuracy: 0.426011/11 [==============================] - 1s 111ms/step - loss: 0.1163 - accuracy: 0.4274
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1046 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.1049 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.1055 - accuracy: 0.4444 4/11 [=========>....................] - ETA: 0s - loss: 0.1058 - accuracy: 0.4466 5/11 [============>.................] - ETA: 0s - loss: 0.1057 - accuracy: 0.4498 6/11 [===============>..............] - ETA: 0s - loss: 0.1056 - accuracy: 0.4510 7/11 [==================>...........] - ETA: 0s - loss: 0.1057 - accuracy: 0.4511 8/11 [====================>.........] - ETA: 0s - loss: 0.1057 - accuracy: 0.4509 9/11 [=======================>......] - ETA: 0s - loss: 0.1057 - accuracy: 0.451210/11 [==========================>...] - ETA: 0s - loss: 0.1056 - accuracy: 0.451111/11 [==============================] - ETA: 0s - loss: 0.1055 - accuracy: 0.450411/11 [==============================] - 1s 103ms/step - loss: 0.1055 - accuracy: 0.4498
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0935 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.0953 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.0961 - accuracy: 0.4627 4/11 [=========>....................] - ETA: 0s - loss: 0.0964 - accuracy: 0.4618 5/11 [============>.................] - ETA: 0s - loss: 0.0963 - accuracy: 0.4622 6/11 [===============>..............] - ETA: 0s - loss: 0.0962 - accuracy: 0.4620 7/11 [==================>...........] - ETA: 0s - loss: 0.0961 - accuracy: 0.4614 8/11 [====================>.........] - ETA: 0s - loss: 0.0960 - accuracy: 0.4605 9/11 [=======================>......] - ETA: 0s - loss: 0.0959 - accuracy: 0.459910/11 [==========================>...] - ETA: 0s - loss: 0.0959 - accuracy: 0.458811/11 [==============================] - ETA: 0s - loss: 0.0957 - accuracy: 0.458011/11 [==============================] - 1s 108ms/step - loss: 0.0956 - accuracy: 0.4574
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0990 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 1s - loss: 0.0939 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.0919 - accuracy: 0.4410 4/11 [=========>....................] - ETA: 0s - loss: 0.0903 - accuracy: 0.4430 5/11 [============>.................] - ETA: 0s - loss: 0.0891 - accuracy: 0.4451 6/11 [===============>..............] - ETA: 0s - loss: 0.0883 - accuracy: 0.4468 7/11 [==================>...........] - ETA: 0s - loss: 0.0876 - accuracy: 0.4485 8/11 [====================>.........] - ETA: 0s - loss: 0.0872 - accuracy: 0.4508 9/11 [=======================>......] - ETA: 0s - loss: 0.0867 - accuracy: 0.453810/11 [==========================>...] - ETA: 0s - loss: 0.0863 - accuracy: 0.456811/11 [==============================] - ETA: 0s - loss: 0.0858 - accuracy: 0.460011/11 [==============================] - 1s 107ms/step - loss: 0.0855 - accuracy: 0.4626
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0724 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 0s - loss: 0.0717 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.0719 - accuracy: 0.5712 4/11 [=========>....................] - ETA: 0s - loss: 0.0724 - accuracy: 0.5758 5/11 [============>.................] - ETA: 0s - loss: 0.0727 - accuracy: 0.5851 6/11 [===============>..............] - ETA: 0s - loss: 0.0729 - accuracy: 0.5950 7/11 [==================>...........] - ETA: 0s - loss: 0.0728 - accuracy: 0.6031 8/11 [====================>.........] - ETA: 0s - loss: 0.0728 - accuracy: 0.6085 9/11 [=======================>......] - ETA: 0s - loss: 0.0726 - accuracy: 0.612010/11 [==========================>...] - ETA: 0s - loss: 0.0725 - accuracy: 0.613811/11 [==============================] - ETA: 0s - loss: 0.0723 - accuracy: 0.615111/11 [==============================] - 1s 108ms/step - loss: 0.0721 - accuracy: 0.6162
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0618 - accuracy: 0.7188 2/11 [====>.........................] - ETA: 0s - loss: 0.0614 - accuracy: 0.7227 3/11 [=======>......................] - ETA: 0s - loss: 0.0613 - accuracy: 0.7248 4/11 [=========>....................] - ETA: 0s - loss: 0.0612 - accuracy: 0.7311 5/11 [============>.................] - ETA: 0s - loss: 0.0611 - accuracy: 0.7355 6/11 [===============>..............] - ETA: 0s - loss: 0.0609 - accuracy: 0.7388 7/11 [==================>...........] - ETA: 0s - loss: 0.0609 - accuracy: 0.7401 8/11 [====================>.........] - ETA: 0s - loss: 0.0611 - accuracy: 0.7401 9/11 [=======================>......] - ETA: 0s - loss: 0.0611 - accuracy: 0.739310/11 [==========================>...] - ETA: 0s - loss: 0.0612 - accuracy: 0.738111/11 [==============================] - ETA: 0s - loss: 0.0612 - accuracy: 0.737011/11 [==============================] - 1s 103ms/step - loss: 0.0613 - accuracy: 0.7360
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0683 - accuracy: 0.7188 2/11 [====>.........................] - ETA: 0s - loss: 0.0649 - accuracy: 0.7305 3/11 [=======>......................] - ETA: 0s - loss: 0.0633 - accuracy: 0.7370 4/11 [=========>....................] - ETA: 0s - loss: 0.0628 - accuracy: 0.7383 5/11 [============>.................] - ETA: 0s - loss: 0.0628 - accuracy: 0.7388 6/11 [===============>..............] - ETA: 0s - loss: 0.0623 - accuracy: 0.7428 7/11 [==================>...........] - ETA: 0s - loss: 0.0618 - accuracy: 0.7464 8/11 [====================>.........] - ETA: 0s - loss: 0.0613 - accuracy: 0.7490 9/11 [=======================>......] - ETA: 0s - loss: 0.0609 - accuracy: 0.750510/11 [==========================>...] - ETA: 0s - loss: 0.0605 - accuracy: 0.751711/11 [==============================] - ETA: 0s - loss: 0.0601 - accuracy: 0.752311/11 [==============================] - 1s 103ms/step - loss: 0.0597 - accuracy: 0.7529
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0528 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.0528 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.0527 - accuracy: 0.7700 4/11 [=========>....................] - ETA: 0s - loss: 0.0529 - accuracy: 0.7708 5/11 [============>.................] - ETA: 0s - loss: 0.0531 - accuracy: 0.7682 6/11 [===============>..............] - ETA: 0s - loss: 0.0529 - accuracy: 0.7687 7/11 [==================>...........] - ETA: 0s - loss: 0.0526 - accuracy: 0.7700 8/11 [====================>.........] - ETA: 0s - loss: 0.0525 - accuracy: 0.7705 9/11 [=======================>......] - ETA: 0s - loss: 0.0523 - accuracy: 0.770910/11 [==========================>...] - ETA: 0s - loss: 0.0522 - accuracy: 0.771011/11 [==============================] - ETA: 0s - loss: 0.0522 - accuracy: 0.771211/11 [==============================] - 1s 103ms/step - loss: 0.0521 - accuracy: 0.7714
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0496 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.0503 - accuracy: 0.7617 3/11 [=======>......................] - ETA: 0s - loss: 0.0507 - accuracy: 0.7622 4/11 [=========>....................] - ETA: 0s - loss: 0.0504 - accuracy: 0.7655 5/11 [============>.................] - ETA: 0s - loss: 0.0499 - accuracy: 0.7689 6/11 [===============>..............] - ETA: 0s - loss: 0.0495 - accuracy: 0.7721 7/11 [==================>...........] - ETA: 0s - loss: 0.0492 - accuracy: 0.7751 8/11 [====================>.........] - ETA: 0s - loss: 0.0489 - accuracy: 0.7777 9/11 [=======================>......] - ETA: 0s - loss: 0.0488 - accuracy: 0.779510/11 [==========================>...] - ETA: 0s - loss: 0.0488 - accuracy: 0.780611/11 [==============================] - ETA: 0s - loss: 0.0487 - accuracy: 0.781611/11 [==============================] - 1s 99ms/step - loss: 0.0486 - accuracy: 0.7824
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0434 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.0429 - accuracy: 0.7402 3/11 [=======>......................] - ETA: 0s - loss: 0.0426 - accuracy: 0.7487 4/11 [=========>....................] - ETA: 0s - loss: 0.0433 - accuracy: 0.7554 5/11 [============>.................] - ETA: 0s - loss: 0.0440 - accuracy: 0.7609 6/11 [===============>..............] - ETA: 0s - loss: 0.0443 - accuracy: 0.7679 7/11 [==================>...........] - ETA: 0s - loss: 0.0444 - accuracy: 0.7745 8/11 [====================>.........] - ETA: 0s - loss: 0.0445 - accuracy: 0.7800 9/11 [=======================>......] - ETA: 0s - loss: 0.0446 - accuracy: 0.784710/11 [==========================>...] - ETA: 0s - loss: 0.0447 - accuracy: 0.788711/11 [==============================] - ETA: 0s - loss: 0.0448 - accuracy: 0.792011/11 [==============================] - 1s 101ms/step - loss: 0.0448 - accuracy: 0.7948
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0402 - accuracy: 0.8516 2/11 [====>.........................] - ETA: 1s - loss: 0.0401 - accuracy: 0.8418 3/11 [=======>......................] - ETA: 0s - loss: 0.0405 - accuracy: 0.8381 4/11 [=========>....................] - ETA: 0s - loss: 0.0406 - accuracy: 0.8327 5/11 [============>.................] - ETA: 0s - loss: 0.0409 - accuracy: 0.8265 6/11 [===============>..............] - ETA: 0s - loss: 0.0411 - accuracy: 0.8200 7/11 [==================>...........] - ETA: 0s - loss: 0.0413 - accuracy: 0.8148 8/11 [====================>.........] - ETA: 0s - loss: 0.0415 - accuracy: 0.8118 9/11 [=======================>......] - ETA: 0s - loss: 0.0416 - accuracy: 0.810410/11 [==========================>...] - ETA: 0s - loss: 0.0417 - accuracy: 0.810111/11 [==============================] - ETA: 0s - loss: 0.0418 - accuracy: 0.810111/11 [==============================] - 1s 104ms/step - loss: 0.0419 - accuracy: 0.8101
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0364 - accuracy: 0.8906 2/11 [====>.........................] - ETA: 0s - loss: 0.0368 - accuracy: 0.8906 3/11 [=======>......................] - ETA: 0s - loss: 0.0370 - accuracy: 0.8854 4/11 [=========>....................] - ETA: 0s - loss: 0.0371 - accuracy: 0.8833 5/11 [============>.................] - ETA: 0s - loss: 0.0370 - accuracy: 0.8795 6/11 [===============>..............] - ETA: 0s - loss: 0.0370 - accuracy: 0.8759 7/11 [==================>...........] - ETA: 0s - loss: 0.0371 - accuracy: 0.8726 8/11 [====================>.........] - ETA: 0s - loss: 0.0373 - accuracy: 0.8685 9/11 [=======================>......] - ETA: 0s - loss: 0.0375 - accuracy: 0.865210/11 [==========================>...] - ETA: 0s - loss: 0.0377 - accuracy: 0.862911/11 [==============================] - ETA: 0s - loss: 0.0379 - accuracy: 0.861311/11 [==============================] - 1s 103ms/step - loss: 0.0380 - accuracy: 0.8600
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0458 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 0s - loss: 0.0436 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0430 - accuracy: 0.8715 4/11 [=========>....................] - ETA: 0s - loss: 0.0421 - accuracy: 0.8739 5/11 [============>.................] - ETA: 0s - loss: 0.0415 - accuracy: 0.8772 6/11 [===============>..............] - ETA: 0s - loss: 0.0408 - accuracy: 0.8801 7/11 [==================>...........] - ETA: 0s - loss: 0.0403 - accuracy: 0.8824 8/11 [====================>.........] - ETA: 0s - loss: 0.0398 - accuracy: 0.8846 9/11 [=======================>......] - ETA: 0s - loss: 0.0393 - accuracy: 0.886910/11 [==========================>...] - ETA: 0s - loss: 0.0390 - accuracy: 0.888611/11 [==============================] - ETA: 0s - loss: 0.0387 - accuracy: 0.890011/11 [==============================] - 1s 104ms/step - loss: 0.0385 - accuracy: 0.8911
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0324 - accuracy: 0.9531 2/11 [====>.........................] - ETA: 0s - loss: 0.0330 - accuracy: 0.9316 3/11 [=======>......................] - ETA: 0s - loss: 0.0330 - accuracy: 0.9240 4/11 [=========>....................] - ETA: 0s - loss: 0.0330 - accuracy: 0.9211 5/11 [============>.................] - ETA: 0s - loss: 0.0330 - accuracy: 0.9193 6/11 [===============>..............] - ETA: 0s - loss: 0.0331 - accuracy: 0.9178 7/11 [==================>...........] - ETA: 0s - loss: 0.0330 - accuracy: 0.9179 8/11 [====================>.........] - ETA: 0s - loss: 0.0329 - accuracy: 0.9183 9/11 [=======================>......] - ETA: 0s - loss: 0.0328 - accuracy: 0.918610/11 [==========================>...] - ETA: 0s - loss: 0.0329 - accuracy: 0.918811/11 [==============================] - ETA: 0s - loss: 0.0329 - accuracy: 0.919011/11 [==============================] - 1s 103ms/step - loss: 0.0329 - accuracy: 0.9193
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0333 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 0s - loss: 0.0324 - accuracy: 0.8828 3/11 [=======>......................] - ETA: 0s - loss: 0.0325 - accuracy: 0.8828 4/11 [=========>....................] - ETA: 0s - loss: 0.0326 - accuracy: 0.8823 5/11 [============>.................] - ETA: 0s - loss: 0.0328 - accuracy: 0.8824 6/11 [===============>..............] - ETA: 0s - loss: 0.0327 - accuracy: 0.8840 7/11 [==================>...........] - ETA: 0s - loss: 0.0327 - accuracy: 0.8857 8/11 [====================>.........] - ETA: 0s - loss: 0.0325 - accuracy: 0.8876 9/11 [=======================>......] - ETA: 0s - loss: 0.0324 - accuracy: 0.889310/11 [==========================>...] - ETA: 0s - loss: 0.0323 - accuracy: 0.891311/11 [==============================] - ETA: 0s - loss: 0.0321 - accuracy: 0.893111/11 [==============================] - 1s 107ms/step - loss: 0.0320 - accuracy: 0.8945
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0254 - accuracy: 0.9375 2/11 [====>.........................] - ETA: 0s - loss: 0.0275 - accuracy: 0.9277 3/11 [=======>......................] - ETA: 0s - loss: 0.0287 - accuracy: 0.9206 4/11 [=========>....................] - ETA: 0s - loss: 0.0292 - accuracy: 0.9175 5/11 [============>.................] - ETA: 0s - loss: 0.0294 - accuracy: 0.9165 6/11 [===============>..............] - ETA: 0s - loss: 0.0294 - accuracy: 0.9152 7/11 [==================>...........] - ETA: 0s - loss: 0.0294 - accuracy: 0.9146 8/11 [====================>.........] - ETA: 0s - loss: 0.0293 - accuracy: 0.9144 9/11 [=======================>......] - ETA: 0s - loss: 0.0291 - accuracy: 0.914210/11 [==========================>...] - ETA: 0s - loss: 0.0290 - accuracy: 0.914011/11 [==============================] - ETA: 0s - loss: 0.0289 - accuracy: 0.913811/11 [==============================] - 1s 105ms/step - loss: 0.0288 - accuracy: 0.9136
Evaluate on test data
1/6 [====>.........................] - ETA: 17s - loss: 0.0290 - accuracy: 0.91413/6 [==============>...............] - ETA: 0s - loss: 0.0250 - accuracy: 0.9245 5/6 [========================>.....] - ETA: 0s - loss: 0.0257 - accuracy: 0.92506/6 [==============================] - 4s 30ms/step - loss: 0.0267 - accuracy: 0.9235
2021-12-14 00:07:48.536073: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:07:48.536977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:07:48.537024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:07:48.537102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:07:48.537144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:07:48.537172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:07:48.537245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:07:48.537279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:07:48.537308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:07:48.537373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:07:48.538517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:07:48.538545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:07:48.538555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:07:48.538564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [2.5892764e-02 9.3167716e-01 8.1615496e-01 2.4103820e-03 7.5259805e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [0.00423717 0.01167709 0.9519386  0.01152998 0.00410652]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 4 1 0] pred: [0.00381595 0.00773561 0.9627341  0.02629587 0.00909504]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [0.00300965 0.01733011 0.9504125  0.00489441 0.00329366]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 0 4] pred: [0.00485528 0.01114175 0.94469017 0.01231581 0.00415054]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [1.6152769e-02 9.3035698e-01 8.5924089e-01 1.7227829e-03 5.1537156e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 4 1 0] pred: [0.00381473 0.00776434 0.95800424 0.02557269 0.00857359]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 2 0 1] pred: [0.02297929 0.01058117 0.08989948 0.8537363  0.1022765 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [0.00481248 0.2975874  0.8648819  0.0383296  0.00124729]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [0.00391862 0.01344252 0.9530798  0.00745389 0.00332579]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [0.04934248 0.37119913 0.5499693  0.1645627  0.01933473]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [1.2436986e-02 8.9383686e-01 7.7705562e-01 2.3459196e-03 4.6288967e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 4 1 0] pred: [0.00366601 0.00695008 0.95436263 0.02837908 0.009431  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 4 1 0] pred: [0.00347242 0.00774947 0.95658994 0.02849153 0.00976196]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 4 0] pred: [0.00426313 0.01078612 0.9527675  0.01308247 0.00458285]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:57 - loss: 0.2508 - accuracy: 0.1406 2/11 [====>.........................] - ETA: 0s - loss: 0.2503 - accuracy: 0.2012   3/11 [=======>......................] - ETA: 0s - loss: 0.2498 - accuracy: 0.2435 4/11 [=========>....................] - ETA: 0s - loss: 0.2493 - accuracy: 0.2769 5/11 [============>.................] - ETA: 0s - loss: 0.2488 - accuracy: 0.3021 6/11 [===============>..............] - ETA: 0s - loss: 0.2483 - accuracy: 0.3186 7/11 [==================>...........] - ETA: 0s - loss: 0.2478 - accuracy: 0.3300 8/11 [====================>.........] - ETA: 0s - loss: 0.2473 - accuracy: 0.3398 9/11 [=======================>......] - ETA: 0s - loss: 0.2468 - accuracy: 0.347410/11 [==========================>...] - ETA: 0s - loss: 0.2463 - accuracy: 0.354711/11 [==============================] - ETA: 0s - loss: 0.2457 - accuracy: 0.360911/11 [==============================] - 13s 102ms/step - loss: 0.2453 - accuracy: 0.3661
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2254 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.2246 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.2237 - accuracy: 0.4727 4/11 [=========>....................] - ETA: 0s - loss: 0.2229 - accuracy: 0.4658 5/11 [============>.................] - ETA: 0s - loss: 0.2220 - accuracy: 0.4614 6/11 [===============>..............] - ETA: 0s - loss: 0.2211 - accuracy: 0.4600 7/11 [==================>...........] - ETA: 0s - loss: 0.2201 - accuracy: 0.4576 8/11 [====================>.........] - ETA: 0s - loss: 0.2191 - accuracy: 0.4569 9/11 [=======================>......] - ETA: 0s - loss: 0.2181 - accuracy: 0.456210/11 [==========================>...] - ETA: 0s - loss: 0.2170 - accuracy: 0.455711/11 [==============================] - ETA: 0s - loss: 0.2160 - accuracy: 0.455611/11 [==============================] - 1s 103ms/step - loss: 0.2151 - accuracy: 0.4556
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1689 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.1681 - accuracy: 0.4883 3/11 [=======>......................] - ETA: 0s - loss: 0.1669 - accuracy: 0.4774 4/11 [=========>....................] - ETA: 0s - loss: 0.1646 - accuracy: 0.4748 5/11 [============>.................] - ETA: 0s - loss: 0.1625 - accuracy: 0.4729 6/11 [===============>..............] - ETA: 0s - loss: 0.1604 - accuracy: 0.4720 7/11 [==================>...........] - ETA: 0s - loss: 0.1585 - accuracy: 0.4701 8/11 [====================>.........] - ETA: 0s - loss: 0.1568 - accuracy: 0.4690 9/11 [=======================>......] - ETA: 0s - loss: 0.1552 - accuracy: 0.468010/11 [==========================>...] - ETA: 0s - loss: 0.1536 - accuracy: 0.466811/11 [==============================] - ETA: 0s - loss: 0.1522 - accuracy: 0.465811/11 [==============================] - 1s 106ms/step - loss: 0.1510 - accuracy: 0.4649
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0958 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.0987 - accuracy: 0.4473 3/11 [=======>......................] - ETA: 0s - loss: 0.1033 - accuracy: 0.4449 4/11 [=========>....................] - ETA: 0s - loss: 0.1053 - accuracy: 0.4479 5/11 [============>.................] - ETA: 0s - loss: 0.1064 - accuracy: 0.4521 6/11 [===============>..............] - ETA: 0s - loss: 0.1074 - accuracy: 0.4538 7/11 [==================>...........] - ETA: 0s - loss: 0.1083 - accuracy: 0.4546 8/11 [====================>.........] - ETA: 0s - loss: 0.1090 - accuracy: 0.4548 9/11 [=======================>......] - ETA: 0s - loss: 0.1096 - accuracy: 0.454810/11 [==========================>...] - ETA: 0s - loss: 0.1100 - accuracy: 0.455011/11 [==============================] - ETA: 0s - loss: 0.1103 - accuracy: 0.455111/11 [==============================] - 1s 101ms/step - loss: 0.1106 - accuracy: 0.4551
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1039 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.1111 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 0s - loss: 0.1121 - accuracy: 0.4353 4/11 [=========>....................] - ETA: 0s - loss: 0.1120 - accuracy: 0.4378 5/11 [============>.................] - ETA: 0s - loss: 0.1116 - accuracy: 0.4403 6/11 [===============>..............] - ETA: 0s - loss: 0.1111 - accuracy: 0.4424 7/11 [==================>...........] - ETA: 0s - loss: 0.1107 - accuracy: 0.4435 8/11 [====================>.........] - ETA: 0s - loss: 0.1103 - accuracy: 0.4444 9/11 [=======================>......] - ETA: 0s - loss: 0.1100 - accuracy: 0.445410/11 [==========================>...] - ETA: 0s - loss: 0.1097 - accuracy: 0.446011/11 [==============================] - ETA: 0s - loss: 0.1093 - accuracy: 0.446911/11 [==============================] - 1s 107ms/step - loss: 0.1090 - accuracy: 0.4476
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1085 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.1060 - accuracy: 0.4102 3/11 [=======>......................] - ETA: 0s - loss: 0.1037 - accuracy: 0.4236 4/11 [=========>....................] - ETA: 0s - loss: 0.1027 - accuracy: 0.4285 5/11 [============>.................] - ETA: 0s - loss: 0.1019 - accuracy: 0.4328 6/11 [===============>..............] - ETA: 0s - loss: 0.1014 - accuracy: 0.4362 7/11 [==================>...........] - ETA: 0s - loss: 0.1009 - accuracy: 0.4390 8/11 [====================>.........] - ETA: 0s - loss: 0.1005 - accuracy: 0.4407 9/11 [=======================>......] - ETA: 0s - loss: 0.1001 - accuracy: 0.442310/11 [==========================>...] - ETA: 0s - loss: 0.0997 - accuracy: 0.444011/11 [==============================] - ETA: 0s - loss: 0.0993 - accuracy: 0.445711/11 [==============================] - 1s 111ms/step - loss: 0.0989 - accuracy: 0.4471
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0925 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.0904 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.0894 - accuracy: 0.4783 4/11 [=========>....................] - ETA: 0s - loss: 0.0890 - accuracy: 0.4808 5/11 [============>.................] - ETA: 0s - loss: 0.0890 - accuracy: 0.4806 6/11 [===============>..............] - ETA: 0s - loss: 0.0888 - accuracy: 0.4803 7/11 [==================>...........] - ETA: 0s - loss: 0.0884 - accuracy: 0.4801 8/11 [====================>.........] - ETA: 0s - loss: 0.0881 - accuracy: 0.4800 9/11 [=======================>......] - ETA: 0s - loss: 0.0878 - accuracy: 0.480210/11 [==========================>...] - ETA: 0s - loss: 0.0877 - accuracy: 0.480311/11 [==============================] - ETA: 0s - loss: 0.0874 - accuracy: 0.480511/11 [==============================] - 1s 107ms/step - loss: 0.0873 - accuracy: 0.4807
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0835 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.0796 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.0784 - accuracy: 0.4887 4/11 [=========>....................] - ETA: 0s - loss: 0.0782 - accuracy: 0.4906 5/11 [============>.................] - ETA: 0s - loss: 0.0786 - accuracy: 0.4899 6/11 [===============>..............] - ETA: 0s - loss: 0.0785 - accuracy: 0.4888 7/11 [==================>...........] - ETA: 0s - loss: 0.0786 - accuracy: 0.4874 8/11 [====================>.........] - ETA: 0s - loss: 0.0787 - accuracy: 0.4864 9/11 [=======================>......] - ETA: 0s - loss: 0.0788 - accuracy: 0.485710/11 [==========================>...] - ETA: 0s - loss: 0.0788 - accuracy: 0.486011/11 [==============================] - ETA: 0s - loss: 0.0789 - accuracy: 0.486611/11 [==============================] - 1s 102ms/step - loss: 0.0789 - accuracy: 0.4870
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0730 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.0743 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 0s - loss: 0.0750 - accuracy: 0.4696 4/11 [=========>....................] - ETA: 0s - loss: 0.0753 - accuracy: 0.4753 5/11 [============>.................] - ETA: 0s - loss: 0.0752 - accuracy: 0.4802 6/11 [===============>..............] - ETA: 0s - loss: 0.0754 - accuracy: 0.4831 7/11 [==================>...........] - ETA: 0s - loss: 0.0756 - accuracy: 0.4868 8/11 [====================>.........] - ETA: 0s - loss: 0.0756 - accuracy: 0.4909 9/11 [=======================>......] - ETA: 0s - loss: 0.0755 - accuracy: 0.494910/11 [==========================>...] - ETA: 0s - loss: 0.0754 - accuracy: 0.499411/11 [==============================] - ETA: 0s - loss: 0.0753 - accuracy: 0.503011/11 [==============================] - 1s 104ms/step - loss: 0.0753 - accuracy: 0.5060
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0654 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 0s - loss: 0.0688 - accuracy: 0.6465 3/11 [=======>......................] - ETA: 0s - loss: 0.0702 - accuracy: 0.6289 4/11 [=========>....................] - ETA: 0s - loss: 0.0714 - accuracy: 0.6196 5/11 [============>.................] - ETA: 0s - loss: 0.0718 - accuracy: 0.6154 6/11 [===============>..............] - ETA: 0s - loss: 0.0720 - accuracy: 0.6157 7/11 [==================>...........] - ETA: 0s - loss: 0.0719 - accuracy: 0.6177 8/11 [====================>.........] - ETA: 0s - loss: 0.0719 - accuracy: 0.6209 9/11 [=======================>......] - ETA: 0s - loss: 0.0718 - accuracy: 0.622910/11 [==========================>...] - ETA: 0s - loss: 0.0717 - accuracy: 0.624711/11 [==============================] - ETA: 0s - loss: 0.0715 - accuracy: 0.626811/11 [==============================] - 1s 100ms/step - loss: 0.0714 - accuracy: 0.6284
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0627 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 0s - loss: 0.0633 - accuracy: 0.6582 3/11 [=======>......................] - ETA: 0s - loss: 0.0650 - accuracy: 0.6532 4/11 [=========>....................] - ETA: 0s - loss: 0.0657 - accuracy: 0.6530 5/11 [============>.................] - ETA: 0s - loss: 0.0659 - accuracy: 0.6558 6/11 [===============>..............] - ETA: 0s - loss: 0.0661 - accuracy: 0.6570 7/11 [==================>...........] - ETA: 0s - loss: 0.0663 - accuracy: 0.6582 8/11 [====================>.........] - ETA: 0s - loss: 0.0662 - accuracy: 0.6589 9/11 [=======================>......] - ETA: 0s - loss: 0.0663 - accuracy: 0.659610/11 [==========================>...] - ETA: 0s - loss: 0.0663 - accuracy: 0.660111/11 [==============================] - ETA: 0s - loss: 0.0663 - accuracy: 0.660411/11 [==============================] - 1s 107ms/step - loss: 0.0662 - accuracy: 0.6606
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0639 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 0s - loss: 0.0636 - accuracy: 0.6602 3/11 [=======>......................] - ETA: 0s - loss: 0.0643 - accuracy: 0.6710 4/11 [=========>....................] - ETA: 0s - loss: 0.0647 - accuracy: 0.6771 5/11 [============>.................] - ETA: 0s - loss: 0.0651 - accuracy: 0.6810 6/11 [===============>..............] - ETA: 0s - loss: 0.0650 - accuracy: 0.6849 7/11 [==================>...........] - ETA: 0s - loss: 0.0647 - accuracy: 0.6883 8/11 [====================>.........] - ETA: 0s - loss: 0.0645 - accuracy: 0.6913 9/11 [=======================>......] - ETA: 0s - loss: 0.0642 - accuracy: 0.693610/11 [==========================>...] - ETA: 0s - loss: 0.0639 - accuracy: 0.695111/11 [==============================] - ETA: 0s - loss: 0.0636 - accuracy: 0.696111/11 [==============================] - 1s 104ms/step - loss: 0.0634 - accuracy: 0.6969
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0607 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 1s - loss: 0.0578 - accuracy: 0.6445 3/11 [=======>......................] - ETA: 0s - loss: 0.0579 - accuracy: 0.6372 4/11 [=========>....................] - ETA: 0s - loss: 0.0581 - accuracy: 0.6405 5/11 [============>.................] - ETA: 0s - loss: 0.0580 - accuracy: 0.6477 6/11 [===============>..............] - ETA: 0s - loss: 0.0579 - accuracy: 0.6539 7/11 [==================>...........] - ETA: 0s - loss: 0.0578 - accuracy: 0.6608 8/11 [====================>.........] - ETA: 0s - loss: 0.0577 - accuracy: 0.6668 9/11 [=======================>......] - ETA: 0s - loss: 0.0576 - accuracy: 0.672110/11 [==========================>...] - ETA: 0s - loss: 0.0575 - accuracy: 0.676011/11 [==============================] - ETA: 0s - loss: 0.0574 - accuracy: 0.679211/11 [==============================] - 1s 108ms/step - loss: 0.0573 - accuracy: 0.6818
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0512 - accuracy: 0.6797 2/11 [====>.........................] - ETA: 0s - loss: 0.0509 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.0516 - accuracy: 0.6814 4/11 [=========>....................] - ETA: 0s - loss: 0.0518 - accuracy: 0.6839 5/11 [============>.................] - ETA: 0s - loss: 0.0518 - accuracy: 0.6871 6/11 [===============>..............] - ETA: 0s - loss: 0.0518 - accuracy: 0.6909 7/11 [==================>...........] - ETA: 0s - loss: 0.0518 - accuracy: 0.6950 8/11 [====================>.........] - ETA: 0s - loss: 0.0517 - accuracy: 0.6993 9/11 [=======================>......] - ETA: 0s - loss: 0.0517 - accuracy: 0.703910/11 [==========================>...] - ETA: 0s - loss: 0.0516 - accuracy: 0.707611/11 [==============================] - ETA: 0s - loss: 0.0515 - accuracy: 0.710311/11 [==============================] - 1s 114ms/step - loss: 0.0515 - accuracy: 0.7126
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0449 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 0s - loss: 0.0466 - accuracy: 0.7285 3/11 [=======>......................] - ETA: 0s - loss: 0.0472 - accuracy: 0.7235 4/11 [=========>....................] - ETA: 0s - loss: 0.0474 - accuracy: 0.7243 5/11 [============>.................] - ETA: 0s - loss: 0.0473 - accuracy: 0.7288 6/11 [===============>..............] - ETA: 0s - loss: 0.0474 - accuracy: 0.7319 7/11 [==================>...........] - ETA: 0s - loss: 0.0474 - accuracy: 0.7350 8/11 [====================>.........] - ETA: 0s - loss: 0.0474 - accuracy: 0.7379 9/11 [=======================>......] - ETA: 0s - loss: 0.0475 - accuracy: 0.740210/11 [==========================>...] - ETA: 0s - loss: 0.0476 - accuracy: 0.742611/11 [==============================] - ETA: 0s - loss: 0.0475 - accuracy: 0.744911/11 [==============================] - 1s 107ms/step - loss: 0.0475 - accuracy: 0.7468
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0470 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 1s - loss: 0.0458 - accuracy: 0.7832 3/11 [=======>......................] - ETA: 0s - loss: 0.0448 - accuracy: 0.7956 4/11 [=========>....................] - ETA: 0s - loss: 0.0443 - accuracy: 0.7983 5/11 [============>.................] - ETA: 0s - loss: 0.0439 - accuracy: 0.8012 6/11 [===============>..............] - ETA: 0s - loss: 0.0440 - accuracy: 0.8026 7/11 [==================>...........] - ETA: 0s - loss: 0.0440 - accuracy: 0.8045 8/11 [====================>.........] - ETA: 0s - loss: 0.0440 - accuracy: 0.8062 9/11 [=======================>......] - ETA: 0s - loss: 0.0441 - accuracy: 0.807510/11 [==========================>...] - ETA: 0s - loss: 0.0441 - accuracy: 0.807111/11 [==============================] - ETA: 0s - loss: 0.0441 - accuracy: 0.806211/11 [==============================] - 1s 110ms/step - loss: 0.0442 - accuracy: 0.8055
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0417 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 0s - loss: 0.0399 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.0399 - accuracy: 0.8186 4/11 [=========>....................] - ETA: 0s - loss: 0.0401 - accuracy: 0.8215 5/11 [============>.................] - ETA: 0s - loss: 0.0404 - accuracy: 0.8243 6/11 [===============>..............] - ETA: 0s - loss: 0.0407 - accuracy: 0.8278 7/11 [==================>...........] - ETA: 0s - loss: 0.0412 - accuracy: 0.8296 8/11 [====================>.........] - ETA: 0s - loss: 0.0415 - accuracy: 0.8325 9/11 [=======================>......] - ETA: 0s - loss: 0.0416 - accuracy: 0.834610/11 [==========================>...] - ETA: 0s - loss: 0.0417 - accuracy: 0.836111/11 [==============================] - ETA: 0s - loss: 0.0417 - accuracy: 0.837511/11 [==============================] - 1s 103ms/step - loss: 0.0418 - accuracy: 0.8386
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0349 - accuracy: 0.8203 2/11 [====>.........................] - ETA: 0s - loss: 0.0366 - accuracy: 0.8105 3/11 [=======>......................] - ETA: 0s - loss: 0.0376 - accuracy: 0.8112 4/11 [=========>....................] - ETA: 0s - loss: 0.0381 - accuracy: 0.8140 5/11 [============>.................] - ETA: 0s - loss: 0.0388 - accuracy: 0.8171 6/11 [===============>..............] - ETA: 0s - loss: 0.0392 - accuracy: 0.8205 7/11 [==================>...........] - ETA: 0s - loss: 0.0394 - accuracy: 0.8240 8/11 [====================>.........] - ETA: 0s - loss: 0.0396 - accuracy: 0.8267 9/11 [=======================>......] - ETA: 0s - loss: 0.0397 - accuracy: 0.829210/11 [==========================>...] - ETA: 0s - loss: 0.0399 - accuracy: 0.831611/11 [==============================] - ETA: 0s - loss: 0.0399 - accuracy: 0.833611/11 [==============================] - 1s 104ms/step - loss: 0.0400 - accuracy: 0.8353
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0380 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.0376 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.0379 - accuracy: 0.7474 4/11 [=========>....................] - ETA: 0s - loss: 0.0382 - accuracy: 0.7422 5/11 [============>.................] - ETA: 0s - loss: 0.0383 - accuracy: 0.7462 6/11 [===============>..............] - ETA: 0s - loss: 0.0385 - accuracy: 0.7501 7/11 [==================>...........] - ETA: 0s - loss: 0.0385 - accuracy: 0.7547 8/11 [====================>.........] - ETA: 0s - loss: 0.0384 - accuracy: 0.7594 9/11 [=======================>......] - ETA: 0s - loss: 0.0384 - accuracy: 0.764510/11 [==========================>...] - ETA: 0s - loss: 0.0384 - accuracy: 0.769211/11 [==============================] - ETA: 0s - loss: 0.0384 - accuracy: 0.773711/11 [==============================] - 1s 101ms/step - loss: 0.0384 - accuracy: 0.7775
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0392 - accuracy: 0.8984 2/11 [====>.........................] - ETA: 0s - loss: 0.0374 - accuracy: 0.8906 3/11 [=======>......................] - ETA: 0s - loss: 0.0368 - accuracy: 0.8863 4/11 [=========>....................] - ETA: 0s - loss: 0.0368 - accuracy: 0.8805 5/11 [============>.................] - ETA: 0s - loss: 0.0371 - accuracy: 0.8726 6/11 [===============>..............] - ETA: 0s - loss: 0.0371 - accuracy: 0.8693 7/11 [==================>...........] - ETA: 0s - loss: 0.0370 - accuracy: 0.8669 8/11 [====================>.........] - ETA: 0s - loss: 0.0369 - accuracy: 0.8658 9/11 [=======================>......] - ETA: 0s - loss: 0.0369 - accuracy: 0.864910/11 [==========================>...] - ETA: 0s - loss: 0.0368 - accuracy: 0.864311/11 [==============================] - ETA: 0s - loss: 0.0366 - accuracy: 0.863411/11 [==============================] - 1s 101ms/step - loss: 0.0365 - accuracy: 0.8627
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.0381 - accuracy: 0.85943/6 [==============>...............] - ETA: 0s - loss: 0.0371 - accuracy: 0.8464 5/6 [========================>.....] - ETA: 0s - loss: 0.0371 - accuracy: 0.85006/6 [==============================] - 4s 31ms/step - loss: 0.0364 - accuracy: 0.8513
2021-12-14 00:08:36.794455: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:08:36.795609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:08:36.795667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:08:36.795711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:08:36.795743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:08:36.795771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:08:36.795800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:08:36.795828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:08:36.795858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:08:36.795887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:08:36.797008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:08:36.797036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:08:36.797046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:08:36.797054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [0.01648036 0.5257202  0.81360555 0.04557982 0.01110831]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [3.8096309e-04 5.2131712e-02 9.6815753e-01 1.1145711e-02 7.4860454e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 2 0 1] pred: [0.13925612 0.08469939 0.1589176  0.6169305  0.32485393]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.07893571 0.9170692  0.69874173 0.00652918 0.00431746]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [0.02156198 0.90415144 0.86051345 0.00515455 0.00173452]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 2 0 1] pred: [0.04984581 0.01406944 0.07171011 0.7350783  0.6042648 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [5.0425529e-04 4.1467905e-02 9.5753008e-01 1.1893421e-02 7.4100494e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [4.2060018e-04 4.7169060e-02 9.6379066e-01 1.1803716e-02 7.6687336e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [0.00682178 0.7460629  0.8890579  0.00713146 0.00159845]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [0.00511038 0.19099677 0.80672884 0.06055775 0.00804871]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [0.00365838 0.43738198 0.8881478  0.02066204 0.00329655]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [0 1 4 3 2] pred: [0.6722182  0.3730197  0.18006629 0.23104349 0.2689544 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.03077164 0.9142215  0.7470548  0.00518557 0.00256726]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 2 0 1] pred: [0.00837782 0.00382635 0.14608693 0.81623363 0.19762635]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [0.07214341 0.58128154 0.6632009  0.08015326 0.03271803]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:00 - loss: 0.2492 - accuracy: 0.2344 2/11 [====>.........................] - ETA: 1s - loss: 0.2488 - accuracy: 0.2793   3/11 [=======>......................] - ETA: 0s - loss: 0.2484 - accuracy: 0.3043 4/11 [=========>....................] - ETA: 0s - loss: 0.2479 - accuracy: 0.3258 5/11 [============>.................] - ETA: 0s - loss: 0.2474 - accuracy: 0.3416 6/11 [===============>..............] - ETA: 0s - loss: 0.2470 - accuracy: 0.3530 7/11 [==================>...........] - ETA: 0s - loss: 0.2465 - accuracy: 0.3629 8/11 [====================>.........] - ETA: 0s - loss: 0.2460 - accuracy: 0.3700 9/11 [=======================>......] - ETA: 0s - loss: 0.2455 - accuracy: 0.374610/11 [==========================>...] - ETA: 0s - loss: 0.2450 - accuracy: 0.378411/11 [==============================] - ETA: 0s - loss: 0.2445 - accuracy: 0.381411/11 [==============================] - 13s 111ms/step - loss: 0.2441 - accuracy: 0.3839
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2266 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.2255 - accuracy: 0.4180 3/11 [=======>......................] - ETA: 0s - loss: 0.2245 - accuracy: 0.4123 4/11 [=========>....................] - ETA: 0s - loss: 0.2237 - accuracy: 0.4059 5/11 [============>.................] - ETA: 0s - loss: 0.2226 - accuracy: 0.4038 6/11 [===============>..............] - ETA: 0s - loss: 0.2216 - accuracy: 0.4033 7/11 [==================>...........] - ETA: 0s - loss: 0.2204 - accuracy: 0.4058 8/11 [====================>.........] - ETA: 0s - loss: 0.2192 - accuracy: 0.4088 9/11 [=======================>......] - ETA: 0s - loss: 0.2181 - accuracy: 0.411410/11 [==========================>...] - ETA: 0s - loss: 0.2169 - accuracy: 0.413611/11 [==============================] - ETA: 0s - loss: 0.2157 - accuracy: 0.415811/11 [==============================] - 1s 108ms/step - loss: 0.2147 - accuracy: 0.4176
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1811 - accuracy: 0.3438 2/11 [====>.........................] - ETA: 0s - loss: 0.1764 - accuracy: 0.3594 3/11 [=======>......................] - ETA: 0s - loss: 0.1725 - accuracy: 0.3793 4/11 [=========>....................] - ETA: 0s - loss: 0.1697 - accuracy: 0.3875 5/11 [============>.................] - ETA: 0s - loss: 0.1668 - accuracy: 0.3957 6/11 [===============>..............] - ETA: 0s - loss: 0.1644 - accuracy: 0.4011 7/11 [==================>...........] - ETA: 0s - loss: 0.1620 - accuracy: 0.4065 8/11 [====================>.........] - ETA: 0s - loss: 0.1597 - accuracy: 0.4108 9/11 [=======================>......] - ETA: 0s - loss: 0.1578 - accuracy: 0.414710/11 [==========================>...] - ETA: 0s - loss: 0.1560 - accuracy: 0.417311/11 [==============================] - ETA: 0s - loss: 0.1545 - accuracy: 0.419211/11 [==============================] - 1s 107ms/step - loss: 0.1533 - accuracy: 0.4208
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1186 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.1193 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.1189 - accuracy: 0.4280 4/11 [=========>....................] - ETA: 0s - loss: 0.1184 - accuracy: 0.4328 5/11 [============>.................] - ETA: 0s - loss: 0.1185 - accuracy: 0.4334 6/11 [===============>..............] - ETA: 0s - loss: 0.1184 - accuracy: 0.4339 7/11 [==================>...........] - ETA: 0s - loss: 0.1184 - accuracy: 0.4341 8/11 [====================>.........] - ETA: 0s - loss: 0.1185 - accuracy: 0.4343 9/11 [=======================>......] - ETA: 0s - loss: 0.1186 - accuracy: 0.434710/11 [==========================>...] - ETA: 0s - loss: 0.1186 - accuracy: 0.434811/11 [==============================] - ETA: 0s - loss: 0.1186 - accuracy: 0.435011/11 [==============================] - 1s 104ms/step - loss: 0.1185 - accuracy: 0.4353
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0989 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.1019 - accuracy: 0.4805 3/11 [=======>......................] - ETA: 0s - loss: 0.1035 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.1046 - accuracy: 0.4746 5/11 [============>.................] - ETA: 0s - loss: 0.1057 - accuracy: 0.4694 6/11 [===============>..............] - ETA: 0s - loss: 0.1066 - accuracy: 0.4656 7/11 [==================>...........] - ETA: 0s - loss: 0.1072 - accuracy: 0.4630 8/11 [====================>.........] - ETA: 0s - loss: 0.1077 - accuracy: 0.4602 9/11 [=======================>......] - ETA: 0s - loss: 0.1082 - accuracy: 0.457010/11 [==========================>...] - ETA: 0s - loss: 0.1086 - accuracy: 0.454411/11 [==============================] - ETA: 0s - loss: 0.1090 - accuracy: 0.452911/11 [==============================] - 1s 106ms/step - loss: 0.1092 - accuracy: 0.4517
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1130 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.1125 - accuracy: 0.4395 3/11 [=======>......................] - ETA: 0s - loss: 0.1123 - accuracy: 0.4327 4/11 [=========>....................] - ETA: 0s - loss: 0.1114 - accuracy: 0.4325 5/11 [============>.................] - ETA: 0s - loss: 0.1106 - accuracy: 0.4335 6/11 [===============>..............] - ETA: 0s - loss: 0.1096 - accuracy: 0.4365 7/11 [==================>...........] - ETA: 0s - loss: 0.1089 - accuracy: 0.4375 8/11 [====================>.........] - ETA: 0s - loss: 0.1084 - accuracy: 0.4380 9/11 [=======================>......] - ETA: 0s - loss: 0.1080 - accuracy: 0.438110/11 [==========================>...] - ETA: 0s - loss: 0.1075 - accuracy: 0.438611/11 [==============================] - ETA: 0s - loss: 0.1072 - accuracy: 0.438811/11 [==============================] - 1s 109ms/step - loss: 0.1069 - accuracy: 0.4390
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1031 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.1034 - accuracy: 0.4199 3/11 [=======>......................] - ETA: 0s - loss: 0.1018 - accuracy: 0.4223 4/11 [=========>....................] - ETA: 0s - loss: 0.1009 - accuracy: 0.4266 5/11 [============>.................] - ETA: 0s - loss: 0.1002 - accuracy: 0.4297 6/11 [===============>..............] - ETA: 0s - loss: 0.0995 - accuracy: 0.4323 7/11 [==================>...........] - ETA: 0s - loss: 0.0990 - accuracy: 0.4345 8/11 [====================>.........] - ETA: 0s - loss: 0.0986 - accuracy: 0.4350 9/11 [=======================>......] - ETA: 0s - loss: 0.0982 - accuracy: 0.435810/11 [==========================>...] - ETA: 0s - loss: 0.0978 - accuracy: 0.437011/11 [==============================] - ETA: 0s - loss: 0.0974 - accuracy: 0.438211/11 [==============================] - 1s 107ms/step - loss: 0.0971 - accuracy: 0.4391
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0941 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.0889 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.0875 - accuracy: 0.5243 4/11 [=========>....................] - ETA: 0s - loss: 0.0869 - accuracy: 0.5197 5/11 [============>.................] - ETA: 0s - loss: 0.0865 - accuracy: 0.5161 6/11 [===============>..............] - ETA: 0s - loss: 0.0862 - accuracy: 0.5127 7/11 [==================>...........] - ETA: 0s - loss: 0.0860 - accuracy: 0.5080 8/11 [====================>.........] - ETA: 0s - loss: 0.0860 - accuracy: 0.5033 9/11 [=======================>......] - ETA: 0s - loss: 0.0859 - accuracy: 0.499410/11 [==========================>...] - ETA: 0s - loss: 0.0859 - accuracy: 0.496111/11 [==============================] - ETA: 0s - loss: 0.0857 - accuracy: 0.493611/11 [==============================] - 1s 107ms/step - loss: 0.0855 - accuracy: 0.4914
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0819 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 0s - loss: 0.0786 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.0784 - accuracy: 0.5625 4/11 [=========>....................] - ETA: 0s - loss: 0.0781 - accuracy: 0.5557 5/11 [============>.................] - ETA: 0s - loss: 0.0780 - accuracy: 0.5523 6/11 [===============>..............] - ETA: 0s - loss: 0.0779 - accuracy: 0.5497 7/11 [==================>...........] - ETA: 0s - loss: 0.0775 - accuracy: 0.5488 8/11 [====================>.........] - ETA: 0s - loss: 0.0773 - accuracy: 0.5482 9/11 [=======================>......] - ETA: 0s - loss: 0.0772 - accuracy: 0.548910/11 [==========================>...] - ETA: 0s - loss: 0.0770 - accuracy: 0.549111/11 [==============================] - ETA: 0s - loss: 0.0768 - accuracy: 0.549111/11 [==============================] - 1s 105ms/step - loss: 0.0766 - accuracy: 0.5491
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0665 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.0677 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.0678 - accuracy: 0.6259 4/11 [=========>....................] - ETA: 0s - loss: 0.0675 - accuracy: 0.6213 5/11 [============>.................] - ETA: 0s - loss: 0.0673 - accuracy: 0.6192 6/11 [===============>..............] - ETA: 0s - loss: 0.0668 - accuracy: 0.6199 7/11 [==================>...........] - ETA: 0s - loss: 0.0665 - accuracy: 0.6191 8/11 [====================>.........] - ETA: 0s - loss: 0.0663 - accuracy: 0.6182 9/11 [=======================>......] - ETA: 0s - loss: 0.0662 - accuracy: 0.617610/11 [==========================>...] - ETA: 0s - loss: 0.0662 - accuracy: 0.617311/11 [==============================] - ETA: 0s - loss: 0.0660 - accuracy: 0.617811/11 [==============================] - 1s 108ms/step - loss: 0.0659 - accuracy: 0.6183
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0569 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.0582 - accuracy: 0.7324 3/11 [=======>......................] - ETA: 0s - loss: 0.0592 - accuracy: 0.7331 4/11 [=========>....................] - ETA: 0s - loss: 0.0590 - accuracy: 0.7378 5/11 [============>.................] - ETA: 0s - loss: 0.0589 - accuracy: 0.7371 6/11 [===============>..............] - ETA: 0s - loss: 0.0584 - accuracy: 0.7345 7/11 [==================>...........] - ETA: 0s - loss: 0.0582 - accuracy: 0.7310 8/11 [====================>.........] - ETA: 0s - loss: 0.0580 - accuracy: 0.7271 9/11 [=======================>......] - ETA: 0s - loss: 0.0578 - accuracy: 0.723110/11 [==========================>...] - ETA: 0s - loss: 0.0578 - accuracy: 0.719911/11 [==============================] - ETA: 0s - loss: 0.0578 - accuracy: 0.717511/11 [==============================] - 1s 103ms/step - loss: 0.0578 - accuracy: 0.7156
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0619 - accuracy: 0.7500 2/11 [====>.........................] - ETA: 0s - loss: 0.0609 - accuracy: 0.7324 3/11 [=======>......................] - ETA: 0s - loss: 0.0595 - accuracy: 0.7261 4/11 [=========>....................] - ETA: 0s - loss: 0.0585 - accuracy: 0.7238 5/11 [============>.................] - ETA: 0s - loss: 0.0578 - accuracy: 0.7243 6/11 [===============>..............] - ETA: 0s - loss: 0.0570 - accuracy: 0.7256 7/11 [==================>...........] - ETA: 0s - loss: 0.0563 - accuracy: 0.7265 8/11 [====================>.........] - ETA: 0s - loss: 0.0557 - accuracy: 0.7273 9/11 [=======================>......] - ETA: 0s - loss: 0.0553 - accuracy: 0.728310/11 [==========================>...] - ETA: 0s - loss: 0.0550 - accuracy: 0.730011/11 [==============================] - ETA: 0s - loss: 0.0547 - accuracy: 0.731211/11 [==============================] - 1s 102ms/step - loss: 0.0545 - accuracy: 0.7323
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0515 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 1s - loss: 0.0493 - accuracy: 0.8301 3/11 [=======>......................] - ETA: 0s - loss: 0.0484 - accuracy: 0.8190 4/11 [=========>....................] - ETA: 0s - loss: 0.0487 - accuracy: 0.8101 5/11 [============>.................] - ETA: 0s - loss: 0.0489 - accuracy: 0.8043 6/11 [===============>..............] - ETA: 0s - loss: 0.0490 - accuracy: 0.7996 7/11 [==================>...........] - ETA: 0s - loss: 0.0490 - accuracy: 0.7946 8/11 [====================>.........] - ETA: 0s - loss: 0.0489 - accuracy: 0.7910 9/11 [=======================>......] - ETA: 0s - loss: 0.0488 - accuracy: 0.789910/11 [==========================>...] - ETA: 0s - loss: 0.0488 - accuracy: 0.788611/11 [==============================] - ETA: 0s - loss: 0.0487 - accuracy: 0.787911/11 [==============================] - 1s 104ms/step - loss: 0.0486 - accuracy: 0.7873
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0485 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 0s - loss: 0.0469 - accuracy: 0.8164 3/11 [=======>......................] - ETA: 0s - loss: 0.0468 - accuracy: 0.8125 4/11 [=========>....................] - ETA: 0s - loss: 0.0468 - accuracy: 0.8110 5/11 [============>.................] - ETA: 0s - loss: 0.0466 - accuracy: 0.8138 6/11 [===============>..............] - ETA: 0s - loss: 0.0462 - accuracy: 0.8166 7/11 [==================>...........] - ETA: 0s - loss: 0.0459 - accuracy: 0.8194 8/11 [====================>.........] - ETA: 0s - loss: 0.0457 - accuracy: 0.8212 9/11 [=======================>......] - ETA: 0s - loss: 0.0454 - accuracy: 0.823210/11 [==========================>...] - ETA: 0s - loss: 0.0452 - accuracy: 0.824311/11 [==============================] - ETA: 0s - loss: 0.0451 - accuracy: 0.824611/11 [==============================] - 1s 107ms/step - loss: 0.0449 - accuracy: 0.8249
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0442 - accuracy: 0.7891 2/11 [====>.........................] - ETA: 0s - loss: 0.0437 - accuracy: 0.7910 3/11 [=======>......................] - ETA: 0s - loss: 0.0427 - accuracy: 0.7895 4/11 [=========>....................] - ETA: 0s - loss: 0.0421 - accuracy: 0.7938 5/11 [============>.................] - ETA: 0s - loss: 0.0416 - accuracy: 0.7975 6/11 [===============>..............] - ETA: 0s - loss: 0.0413 - accuracy: 0.8009 7/11 [==================>...........] - ETA: 0s - loss: 0.0413 - accuracy: 0.8030 8/11 [====================>.........] - ETA: 0s - loss: 0.0413 - accuracy: 0.8041 9/11 [=======================>......] - ETA: 0s - loss: 0.0413 - accuracy: 0.804110/11 [==========================>...] - ETA: 0s - loss: 0.0413 - accuracy: 0.803911/11 [==============================] - ETA: 0s - loss: 0.0413 - accuracy: 0.803911/11 [==============================] - 1s 101ms/step - loss: 0.0413 - accuracy: 0.8039
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0357 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 0s - loss: 0.0354 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 0s - loss: 0.0358 - accuracy: 0.8394 4/11 [=========>....................] - ETA: 0s - loss: 0.0363 - accuracy: 0.8381 5/11 [============>.................] - ETA: 0s - loss: 0.0366 - accuracy: 0.8364 6/11 [===============>..............] - ETA: 0s - loss: 0.0370 - accuracy: 0.8348 7/11 [==================>...........] - ETA: 0s - loss: 0.0372 - accuracy: 0.8346 8/11 [====================>.........] - ETA: 0s - loss: 0.0372 - accuracy: 0.8353 9/11 [=======================>......] - ETA: 0s - loss: 0.0372 - accuracy: 0.836210/11 [==========================>...] - ETA: 0s - loss: 0.0372 - accuracy: 0.837411/11 [==============================] - ETA: 0s - loss: 0.0373 - accuracy: 0.838511/11 [==============================] - 1s 104ms/step - loss: 0.0373 - accuracy: 0.8393
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0356 - accuracy: 0.8359 2/11 [====>.........................] - ETA: 0s - loss: 0.0356 - accuracy: 0.8164 3/11 [=======>......................] - ETA: 0s - loss: 0.0359 - accuracy: 0.8142 4/11 [=========>....................] - ETA: 0s - loss: 0.0361 - accuracy: 0.8162 5/11 [============>.................] - ETA: 0s - loss: 0.0361 - accuracy: 0.8202 6/11 [===============>..............] - ETA: 0s - loss: 0.0360 - accuracy: 0.8263 7/11 [==================>...........] - ETA: 0s - loss: 0.0360 - accuracy: 0.8313 8/11 [====================>.........] - ETA: 0s - loss: 0.0360 - accuracy: 0.8358 9/11 [=======================>......] - ETA: 0s - loss: 0.0359 - accuracy: 0.839310/11 [==========================>...] - ETA: 0s - loss: 0.0359 - accuracy: 0.840511/11 [==============================] - ETA: 0s - loss: 0.0359 - accuracy: 0.840811/11 [==============================] - 1s 110ms/step - loss: 0.0359 - accuracy: 0.8410
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0433 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.0415 - accuracy: 0.7246 3/11 [=======>......................] - ETA: 0s - loss: 0.0396 - accuracy: 0.7409 4/11 [=========>....................] - ETA: 0s - loss: 0.0387 - accuracy: 0.7559 5/11 [============>.................] - ETA: 0s - loss: 0.0381 - accuracy: 0.7681 6/11 [===============>..............] - ETA: 0s - loss: 0.0379 - accuracy: 0.7779 7/11 [==================>...........] - ETA: 0s - loss: 0.0377 - accuracy: 0.7870 8/11 [====================>.........] - ETA: 0s - loss: 0.0375 - accuracy: 0.7957 9/11 [=======================>......] - ETA: 0s - loss: 0.0372 - accuracy: 0.803210/11 [==========================>...] - ETA: 0s - loss: 0.0370 - accuracy: 0.808611/11 [==============================] - ETA: 0s - loss: 0.0369 - accuracy: 0.812611/11 [==============================] - 1s 111ms/step - loss: 0.0368 - accuracy: 0.8159
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0355 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 0s - loss: 0.0354 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.0358 - accuracy: 0.8012 4/11 [=========>....................] - ETA: 0s - loss: 0.0360 - accuracy: 0.8138 5/11 [============>.................] - ETA: 0s - loss: 0.0357 - accuracy: 0.8248 6/11 [===============>..............] - ETA: 0s - loss: 0.0355 - accuracy: 0.8336 7/11 [==================>...........] - ETA: 0s - loss: 0.0353 - accuracy: 0.8414 8/11 [====================>.........] - ETA: 0s - loss: 0.0351 - accuracy: 0.8479 9/11 [=======================>......] - ETA: 0s - loss: 0.0350 - accuracy: 0.853410/11 [==========================>...] - ETA: 0s - loss: 0.0349 - accuracy: 0.857611/11 [==============================] - ETA: 0s - loss: 0.0347 - accuracy: 0.860911/11 [==============================] - 1s 109ms/step - loss: 0.0346 - accuracy: 0.8636
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0322 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 1s - loss: 0.0307 - accuracy: 0.8359 3/11 [=======>......................] - ETA: 0s - loss: 0.0309 - accuracy: 0.8411 4/11 [=========>....................] - ETA: 0s - loss: 0.0311 - accuracy: 0.8481 5/11 [============>.................] - ETA: 0s - loss: 0.0315 - accuracy: 0.8557 6/11 [===============>..............] - ETA: 0s - loss: 0.0316 - accuracy: 0.8617 7/11 [==================>...........] - ETA: 0s - loss: 0.0318 - accuracy: 0.8665 8/11 [====================>.........] - ETA: 0s - loss: 0.0318 - accuracy: 0.8709 9/11 [=======================>......] - ETA: 0s - loss: 0.0317 - accuracy: 0.874310/11 [==========================>...] - ETA: 0s - loss: 0.0317 - accuracy: 0.876811/11 [==============================] - ETA: 0s - loss: 0.0316 - accuracy: 0.878911/11 [==============================] - 1s 114ms/step - loss: 0.0316 - accuracy: 0.8806
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.0257 - accuracy: 0.89843/6 [==============>...............] - ETA: 0s - loss: 0.0260 - accuracy: 0.8672 5/6 [========================>.....] - ETA: 0s - loss: 0.0270 - accuracy: 0.87036/6 [==============================] - 4s 29ms/step - loss: 0.0276 - accuracy: 0.8739
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [0.00312766 0.3458244  0.90600646 0.04950827 0.00121984]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [0.00188082 0.06494722 0.9478284  0.00858772 0.00122678]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [0.01758179 0.840477   0.81041634 0.00697315 0.00099054]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.01767609 0.92549807 0.7714803  0.00606656 0.00159588]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 3 0 4] pred: [0.00808764 0.92036533 0.84557927 0.01236665 0.00147051]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.01821846 0.89279556 0.73340535 0.00791383 0.00153655]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 0 4] pred: [1.8858910e-03 1.7099798e-02 9.6265453e-01 2.0824164e-02 9.1019273e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [0 1 3 4 2] pred: [0.7661987  0.14676592 0.02884164 0.06897897 0.05400634]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 1 0 4] pred: [0.00254798 0.00722349 0.94484115 0.0489561  0.0010258 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [0.00420952 0.863228   0.89485806 0.0207462  0.00124499]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 0 4] pred: [1.8669665e-03 1.4725208e-02 9.6273416e-01 2.0494670e-02 8.6277723e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 1 0 4] pred: [1.7707050e-03 1.6465306e-02 9.6437609e-01 1.9636452e-02 8.4283948e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.07521272 0.8726625  0.44540215 0.01014876 0.00300834]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [1.4503300e-03 7.5535715e-02 9.4939399e-01 3.6284715e-02 8.4069371e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [0.01306719 0.81394345 0.7565982  0.00897476 0.0014433 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Job end at mar déc 14 00:09:26 CET 2021
