
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at mar déc 14 00:09:06 CET 2021
2021-12-14 00:09:06.963166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-14 00:09:12.325382: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:09:12.327840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-14 00:09:12.361398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:09:12.361442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:09:12.365505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:09:12.365561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:09:12.368773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:09:12.370406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:09:12.373753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:09:12.375726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:09:12.382149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:09:12.383454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:09:12.383501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:09:13.039216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:09:13.039268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:09:13.039281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:09:13.041255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:09:13.042245: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:09:13.042834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:09:13.042878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:09:13.042913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:09:13.042957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:09:13.042984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:09:13.043018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:09:13.043047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:09:13.043074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:09:13.043103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:09:13.044186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:09:13.044216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:09:13.044228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:09:13.044237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:09:13.045331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:09:14.880081: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:09:14.881246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:09:14.881298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:09:14.881343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:09:14.881384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:09:14.881427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:09:14.881469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:09:14.881511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:09:14.881547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:09:14.881587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:09:14.882666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:09:14.883534: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:09:14.884106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:09:14.884134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:09:14.884162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:09:14.884189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:09:14.884214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:09:14.884240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:09:14.884266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:09:14.884295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:09:14.884322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:09:14.885371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:09:14.885434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:09:14.885448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:09:14.885457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:09:14.886683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:09:14.886793: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-14 00:09:18.415500: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-14 00:09:18.416222: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 1994990000 Hz
2021-12-14 00:09:30.210851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:09:31.248569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
Number of possible configurations: 40
Begining exécution of the 40 th configuration: BPIC20.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, sigmoid as activation function and manhattan as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 58)          3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                21360     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:34 - loss: 2.4993 - accuracy: 0.2500 3/11 [=======>......................] - ETA: 0s - loss: 2.4951 - accuracy: 0.3377   5/11 [============>.................] - ETA: 0s - loss: 2.4908 - accuracy: 0.3823 7/11 [==================>...........] - ETA: 0s - loss: 2.4864 - accuracy: 0.4031 9/11 [=======================>......] - ETA: 0s - loss: 2.4818 - accuracy: 0.414511/11 [==============================] - 16s 28ms/step - loss: 2.4752 - accuracy: 0.4248
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3810 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 2.3734 - accuracy: 0.4431 6/11 [===============>..............] - ETA: 0s - loss: 2.3590 - accuracy: 0.4467 9/11 [=======================>......] - ETA: 0s - loss: 2.3421 - accuracy: 0.451211/11 [==============================] - ETA: 0s - loss: 2.3291 - accuracy: 0.453211/11 [==============================] - 0s 26ms/step - loss: 2.3238 - accuracy: 0.4538
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 2.0478 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 2.0030 - accuracy: 0.4232 6/11 [===============>..............] - ETA: 0s - loss: 1.9574 - accuracy: 0.4347 8/11 [====================>.........] - ETA: 0s - loss: 1.9159 - accuracy: 0.437111/11 [==============================] - ETA: 0s - loss: 1.8483 - accuracy: 0.442611/11 [==============================] - 0s 27ms/step - loss: 1.8302 - accuracy: 0.4440
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.2488 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 1.1886 - accuracy: 0.4384 5/11 [============>.................] - ETA: 0s - loss: 1.1573 - accuracy: 0.4426 7/11 [==================>...........] - ETA: 0s - loss: 1.1290 - accuracy: 0.4484 9/11 [=======================>......] - ETA: 0s - loss: 1.1086 - accuracy: 0.451011/11 [==============================] - 0s 28ms/step - loss: 1.0865 - accuracy: 0.4528
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8935 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.9102 - accuracy: 0.4570 5/11 [============>.................] - ETA: 0s - loss: 0.9181 - accuracy: 0.4557 7/11 [==================>...........] - ETA: 0s - loss: 0.9199 - accuracy: 0.4551 9/11 [=======================>......] - ETA: 0s - loss: 0.9159 - accuracy: 0.455911/11 [==============================] - ETA: 0s - loss: 0.9117 - accuracy: 0.456811/11 [==============================] - 0s 29ms/step - loss: 0.9104 - accuracy: 0.4571
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8733 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.8829 - accuracy: 0.4507 6/11 [===============>..............] - ETA: 0s - loss: 0.8827 - accuracy: 0.4531 8/11 [====================>.........] - ETA: 0s - loss: 0.8829 - accuracy: 0.454010/11 [==========================>...] - ETA: 0s - loss: 0.8815 - accuracy: 0.454411/11 [==============================] - 0s 28ms/step - loss: 0.8791 - accuracy: 0.4553
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8416 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.8602 - accuracy: 0.4608 6/11 [===============>..............] - ETA: 0s - loss: 0.8618 - accuracy: 0.4567 8/11 [====================>.........] - ETA: 0s - loss: 0.8641 - accuracy: 0.454110/11 [==========================>...] - ETA: 0s - loss: 0.8633 - accuracy: 0.454411/11 [==============================] - 0s 27ms/step - loss: 0.8623 - accuracy: 0.4553
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9026 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8716 - accuracy: 0.4674 5/11 [============>.................] - ETA: 0s - loss: 0.8792 - accuracy: 0.4580 7/11 [==================>...........] - ETA: 0s - loss: 0.8753 - accuracy: 0.4557 9/11 [=======================>......] - ETA: 0s - loss: 0.8692 - accuracy: 0.457311/11 [==============================] - ETA: 0s - loss: 0.8658 - accuracy: 0.457811/11 [==============================] - 0s 28ms/step - loss: 0.8647 - accuracy: 0.4580
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7631 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.8031 - accuracy: 0.4835 5/11 [============>.................] - ETA: 0s - loss: 0.8286 - accuracy: 0.4715 7/11 [==================>...........] - ETA: 0s - loss: 0.8384 - accuracy: 0.4651 9/11 [=======================>......] - ETA: 0s - loss: 0.8446 - accuracy: 0.461111/11 [==============================] - ETA: 0s - loss: 0.8459 - accuracy: 0.460211/11 [==============================] - 0s 28ms/step - loss: 0.8462 - accuracy: 0.4602
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7769 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.7964 - accuracy: 0.4983 5/11 [============>.................] - ETA: 0s - loss: 0.8060 - accuracy: 0.4927 7/11 [==================>...........] - ETA: 0s - loss: 0.8073 - accuracy: 0.4902 9/11 [=======================>......] - ETA: 0s - loss: 0.8104 - accuracy: 0.486711/11 [==============================] - 0s 27ms/step - loss: 0.8196 - accuracy: 0.4800
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8335 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.8553 - accuracy: 0.4575 7/11 [==================>...........] - ETA: 0s - loss: 0.8599 - accuracy: 0.4557 9/11 [=======================>......] - ETA: 0s - loss: 0.8620 - accuracy: 0.454911/11 [==============================] - ETA: 0s - loss: 0.8602 - accuracy: 0.455411/11 [==============================] - 0s 28ms/step - loss: 0.8591 - accuracy: 0.4557
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6333 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.7064 - accuracy: 0.5443 5/11 [============>.................] - ETA: 0s - loss: 0.7478 - accuracy: 0.5193 7/11 [==================>...........] - ETA: 0s - loss: 0.7709 - accuracy: 0.5054 9/11 [=======================>......] - ETA: 0s - loss: 0.7867 - accuracy: 0.495411/11 [==============================] - ETA: 0s - loss: 0.7970 - accuracy: 0.489011/11 [==============================] - 0s 28ms/step - loss: 0.8011 - accuracy: 0.4866
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7510 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.8093 - accuracy: 0.4818 7/11 [==================>...........] - ETA: 0s - loss: 0.8199 - accuracy: 0.4734 9/11 [=======================>......] - ETA: 0s - loss: 0.8247 - accuracy: 0.469911/11 [==============================] - 0s 27ms/step - loss: 0.8296 - accuracy: 0.4672
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8906 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8883 - accuracy: 0.4440 5/11 [============>.................] - ETA: 0s - loss: 0.8815 - accuracy: 0.4488 7/11 [==================>...........] - ETA: 0s - loss: 0.8825 - accuracy: 0.4464 9/11 [=======================>......] - ETA: 0s - loss: 0.8795 - accuracy: 0.445611/11 [==============================] - ETA: 0s - loss: 0.8746 - accuracy: 0.447111/11 [==============================] - 0s 29ms/step - loss: 0.8720 - accuracy: 0.4481
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8262 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.8144 - accuracy: 0.4957 5/11 [============>.................] - ETA: 0s - loss: 0.8057 - accuracy: 0.4919 7/11 [==================>...........] - ETA: 0s - loss: 0.8071 - accuracy: 0.4886 9/11 [=======================>......] - ETA: 0s - loss: 0.8104 - accuracy: 0.484711/11 [==============================] - ETA: 0s - loss: 0.8160 - accuracy: 0.480511/11 [==============================] - 0s 28ms/step - loss: 0.8182 - accuracy: 0.4788
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7851 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8124 - accuracy: 0.4731 5/11 [============>.................] - ETA: 0s - loss: 0.8243 - accuracy: 0.4674 7/11 [==================>...........] - ETA: 0s - loss: 0.8299 - accuracy: 0.4672 9/11 [=======================>......] - ETA: 0s - loss: 0.8320 - accuracy: 0.467911/11 [==============================] - 0s 27ms/step - loss: 0.8340 - accuracy: 0.4664
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7776 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8131 - accuracy: 0.4466 5/11 [============>.................] - ETA: 0s - loss: 0.8149 - accuracy: 0.4524 7/11 [==================>...........] - ETA: 0s - loss: 0.8153 - accuracy: 0.4578 9/11 [=======================>......] - ETA: 0s - loss: 0.8180 - accuracy: 0.460011/11 [==============================] - ETA: 0s - loss: 0.8224 - accuracy: 0.459811/11 [==============================] - 0s 28ms/step - loss: 0.8240 - accuracy: 0.4598
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7855 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.7936 - accuracy: 0.4905 5/11 [============>.................] - ETA: 0s - loss: 0.7926 - accuracy: 0.4884 8/11 [====================>.........] - ETA: 0s - loss: 0.8010 - accuracy: 0.483610/11 [==========================>...] - ETA: 0s - loss: 0.8069 - accuracy: 0.479711/11 [==============================] - 0s 28ms/step - loss: 0.8125 - accuracy: 0.4764
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8240 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8188 - accuracy: 0.4731 5/11 [============>.................] - ETA: 0s - loss: 0.8069 - accuracy: 0.4803 7/11 [==================>...........] - ETA: 0s - loss: 0.8067 - accuracy: 0.4804 9/11 [=======================>......] - ETA: 0s - loss: 0.8108 - accuracy: 0.477411/11 [==============================] - 0s 27ms/step - loss: 0.8174 - accuracy: 0.4734
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8181 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8502 - accuracy: 0.4631 5/11 [============>.................] - ETA: 0s - loss: 0.8491 - accuracy: 0.4609 7/11 [==================>...........] - ETA: 0s - loss: 0.8438 - accuracy: 0.4628 9/11 [=======================>......] - ETA: 0s - loss: 0.8412 - accuracy: 0.463711/11 [==============================] - ETA: 0s - loss: 0.8402 - accuracy: 0.463211/11 [==============================] - 0s 28ms/step - loss: 0.8401 - accuracy: 0.4630
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.7925 - accuracy: 0.47666/6 [==============================] - ETA: 0s - loss: 0.8372 - accuracy: 0.4561 6/6 [==============================] - 5s 11ms/step - loss: 0.8372 - accuracy: 0.4561
2021-12-14 00:09:50.160467: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:09:50.161321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:09:50.161396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:09:50.161454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:09:50.161495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:09:50.161540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:09:50.161596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:09:50.161660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:09:50.161718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:09:50.161782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:09:50.162985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:09:50.163069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:09:50.163090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:09:50.163104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:09:50.164346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:09:50.164859: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:09:50.165377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:09:50.165434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:09:50.165481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:09:50.165519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:09:50.165555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:09:50.165591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:09:50.165627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:09:50.165664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:09:50.165699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:09:50.166611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:09:50.166651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:09:50.166668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:09:50.166680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:09:50.167634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 4 3 0] pred: [3.7423024e-04 8.7436353e-04 9.9712151e-01 4.0192026e-04 5.7850929e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 4 3 0] pred: [3.7407887e-04 8.7409152e-04 9.9712211e-01 4.0177358e-04 5.7833560e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 3 0] pred: [3.7477419e-04 8.7498868e-04 9.9711752e-01 4.0253720e-04 5.7930936e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 4 3 0] pred: [3.7641678e-04 8.7740092e-04 9.9710101e-01 4.0434737e-04 5.8221485e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 4 3 0] pred: [9.7935402e-04 2.0152770e-03 9.9053156e-01 1.1846123e-03 1.8060964e-03]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 3 0] pred: [3.7608107e-04 8.7679294e-04 9.9710613e-01 4.0384178e-04 5.8139442e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 3 0] pred: [4.0103064e-04 9.1659965e-04 9.9692839e-01 4.2902990e-04 6.1697129e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 3 0] pred: [3.7869799e-04 8.7943650e-04 9.9708146e-01 4.0438492e-04 5.8454380e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 3 0] pred: [3.7475955e-04 8.7499653e-04 9.9711692e-01 4.0250251e-04 5.7938340e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 4 3 0] pred: [3.7406795e-04 8.7413855e-04 9.9712235e-01 4.0176493e-04 5.7831442e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 4 3 0] pred: [3.7873161e-04 8.8090869e-04 9.9708408e-01 4.0670644e-04 5.8555696e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 3 0] pred: [3.7477273e-04 8.7500399e-04 9.9711704e-01 4.0250595e-04 5.7938282e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 3 0] pred: [3.7502343e-04 8.7577134e-04 9.9711573e-01 4.0286162e-04 5.7979190e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 3 0] pred: [3.7404319e-04 8.7406620e-04 9.9712259e-01 4.0172698e-04 5.7825790e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 4 3 0] pred: [3.7328497e-04 8.7805488e-04 9.9707460e-01 4.0367429e-04 5.8927224e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:40 - loss: 2.5043 - accuracy: 0.2344 4/11 [=========>....................] - ETA: 0s - loss: 2.4964 - accuracy: 0.3358   7/11 [==================>...........] - ETA: 0s - loss: 2.4884 - accuracy: 0.3705 9/11 [=======================>......] - ETA: 0s - loss: 2.4828 - accuracy: 0.382411/11 [==============================] - 16s 25ms/step - loss: 2.4746 - accuracy: 0.3954
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3671 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 2.3476 - accuracy: 0.4629 7/11 [==================>...........] - ETA: 0s - loss: 2.3263 - accuracy: 0.4647 9/11 [=======================>......] - ETA: 0s - loss: 2.3093 - accuracy: 0.465111/11 [==============================] - ETA: 0s - loss: 2.2916 - accuracy: 0.464011/11 [==============================] - 0s 25ms/step - loss: 2.2843 - accuracy: 0.4636
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 1.9089 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 1.8609 - accuracy: 0.4314 6/11 [===============>..............] - ETA: 0s - loss: 1.8029 - accuracy: 0.4275 8/11 [====================>.........] - ETA: 0s - loss: 1.7585 - accuracy: 0.432811/11 [==============================] - ETA: 0s - loss: 1.6962 - accuracy: 0.439911/11 [==============================] - 0s 26ms/step - loss: 1.6800 - accuracy: 0.4415
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.1689 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 1.1331 - accuracy: 0.4622 5/11 [============>.................] - ETA: 0s - loss: 1.1168 - accuracy: 0.4580 7/11 [==================>...........] - ETA: 0s - loss: 1.1004 - accuracy: 0.458610/11 [==========================>...] - ETA: 0s - loss: 1.0803 - accuracy: 0.458811/11 [==============================] - 0s 26ms/step - loss: 1.0710 - accuracy: 0.4589
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9263 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.9249 - accuracy: 0.4593 6/11 [===============>..............] - ETA: 0s - loss: 0.9228 - accuracy: 0.4585 8/11 [====================>.........] - ETA: 0s - loss: 0.9213 - accuracy: 0.458511/11 [==============================] - ETA: 0s - loss: 0.9215 - accuracy: 0.458011/11 [==============================] - 0s 26ms/step - loss: 0.9209 - accuracy: 0.4581
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8148 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.8464 - accuracy: 0.4922 5/11 [============>.................] - ETA: 0s - loss: 0.8494 - accuracy: 0.4887 7/11 [==================>...........] - ETA: 0s - loss: 0.8504 - accuracy: 0.4838 9/11 [=======================>......] - ETA: 0s - loss: 0.8527 - accuracy: 0.480111/11 [==============================] - ETA: 0s - loss: 0.8570 - accuracy: 0.476111/11 [==============================] - 0s 27ms/step - loss: 0.8587 - accuracy: 0.4747
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8857 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8896 - accuracy: 0.4466 5/11 [============>.................] - ETA: 0s - loss: 0.8821 - accuracy: 0.4481 8/11 [====================>.........] - ETA: 0s - loss: 0.8745 - accuracy: 0.453310/11 [==========================>...] - ETA: 0s - loss: 0.8699 - accuracy: 0.455411/11 [==============================] - 0s 26ms/step - loss: 0.8683 - accuracy: 0.4560
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 1.0294 - accuracy: 0.3828 3/11 [=======>......................] - ETA: 0s - loss: 0.9281 - accuracy: 0.4223 5/11 [============>.................] - ETA: 0s - loss: 0.8986 - accuracy: 0.4389 8/11 [====================>.........] - ETA: 0s - loss: 0.8882 - accuracy: 0.443010/11 [==========================>...] - ETA: 0s - loss: 0.8808 - accuracy: 0.446111/11 [==============================] - 0s 26ms/step - loss: 0.8761 - accuracy: 0.4482
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7188 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.7830 - accuracy: 0.4991 5/11 [============>.................] - ETA: 0s - loss: 0.8049 - accuracy: 0.4803 7/11 [==================>...........] - ETA: 0s - loss: 0.8178 - accuracy: 0.4720 9/11 [=======================>......] - ETA: 0s - loss: 0.8271 - accuracy: 0.467211/11 [==============================] - 0s 27ms/step - loss: 0.8326 - accuracy: 0.4649
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8511 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.8438 - accuracy: 0.4727 5/11 [============>.................] - ETA: 0s - loss: 0.8341 - accuracy: 0.4745 8/11 [====================>.........] - ETA: 0s - loss: 0.8303 - accuracy: 0.474010/11 [==========================>...] - ETA: 0s - loss: 0.8325 - accuracy: 0.471411/11 [==============================] - 0s 26ms/step - loss: 0.8347 - accuracy: 0.4693
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8770 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8805 - accuracy: 0.4314 5/11 [============>.................] - ETA: 0s - loss: 0.8698 - accuracy: 0.4396 7/11 [==================>...........] - ETA: 0s - loss: 0.8656 - accuracy: 0.4429 9/11 [=======================>......] - ETA: 0s - loss: 0.8647 - accuracy: 0.443811/11 [==============================] - 0s 27ms/step - loss: 0.8602 - accuracy: 0.4472
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8132 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8484 - accuracy: 0.4557 5/11 [============>.................] - ETA: 0s - loss: 0.8606 - accuracy: 0.4485 7/11 [==================>...........] - ETA: 0s - loss: 0.8608 - accuracy: 0.4481 9/11 [=======================>......] - ETA: 0s - loss: 0.8581 - accuracy: 0.449211/11 [==============================] - 0s 26ms/step - loss: 0.8546 - accuracy: 0.4514
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8489 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8841 - accuracy: 0.4492 5/11 [============>.................] - ETA: 0s - loss: 0.8801 - accuracy: 0.4504 7/11 [==================>...........] - ETA: 0s - loss: 0.8702 - accuracy: 0.454410/11 [==========================>...] - ETA: 0s - loss: 0.8600 - accuracy: 0.457411/11 [==============================] - 0s 25ms/step - loss: 0.8569 - accuracy: 0.4577
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8345 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8570 - accuracy: 0.4510 5/11 [============>.................] - ETA: 0s - loss: 0.8500 - accuracy: 0.4534 8/11 [====================>.........] - ETA: 0s - loss: 0.8411 - accuracy: 0.459810/11 [==========================>...] - ETA: 0s - loss: 0.8401 - accuracy: 0.460011/11 [==============================] - 0s 27ms/step - loss: 0.8401 - accuracy: 0.4599
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7854 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8336 - accuracy: 0.4566 6/11 [===============>..............] - ETA: 0s - loss: 0.8290 - accuracy: 0.4605 8/11 [====================>.........] - ETA: 0s - loss: 0.8307 - accuracy: 0.458711/11 [==============================] - ETA: 0s - loss: 0.8339 - accuracy: 0.458311/11 [==============================] - 0s 25ms/step - loss: 0.8343 - accuracy: 0.4584
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7659 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.7753 - accuracy: 0.5178 5/11 [============>.................] - ETA: 0s - loss: 0.7928 - accuracy: 0.5043 8/11 [====================>.........] - ETA: 0s - loss: 0.8083 - accuracy: 0.492510/11 [==========================>...] - ETA: 0s - loss: 0.8156 - accuracy: 0.485911/11 [==============================] - 0s 26ms/step - loss: 0.8195 - accuracy: 0.4814
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9811 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.8912 - accuracy: 0.4323 5/11 [============>.................] - ETA: 0s - loss: 0.8783 - accuracy: 0.4359 7/11 [==================>...........] - ETA: 0s - loss: 0.8781 - accuracy: 0.4355 9/11 [=======================>......] - ETA: 0s - loss: 0.8720 - accuracy: 0.439111/11 [==============================] - 0s 26ms/step - loss: 0.8641 - accuracy: 0.4439
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8544 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.8736 - accuracy: 0.4572 6/11 [===============>..............] - ETA: 0s - loss: 0.8592 - accuracy: 0.4609 8/11 [====================>.........] - ETA: 0s - loss: 0.8599 - accuracy: 0.458110/11 [==========================>...] - ETA: 0s - loss: 0.8575 - accuracy: 0.457811/11 [==============================] - 0s 26ms/step - loss: 0.8542 - accuracy: 0.4580
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7981 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8435 - accuracy: 0.4657 5/11 [============>.................] - ETA: 0s - loss: 0.8463 - accuracy: 0.4622 7/11 [==================>...........] - ETA: 0s - loss: 0.8442 - accuracy: 0.4621 9/11 [=======================>......] - ETA: 0s - loss: 0.8449 - accuracy: 0.460711/11 [==============================] - 0s 26ms/step - loss: 0.8428 - accuracy: 0.4604
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8322 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8193 - accuracy: 0.4744 5/11 [============>.................] - ETA: 0s - loss: 0.8169 - accuracy: 0.4748 7/11 [==================>...........] - ETA: 0s - loss: 0.8151 - accuracy: 0.475710/11 [==========================>...] - ETA: 0s - loss: 0.8187 - accuracy: 0.472511/11 [==============================] - 0s 26ms/step - loss: 0.8217 - accuracy: 0.4703
Evaluate on test data
1/6 [====>.........................] - ETA: 23s - loss: 0.7472 - accuracy: 0.50786/6 [==============================] - ETA: 0s - loss: 0.8504 - accuracy: 0.4575 6/6 [==============================] - 5s 13ms/step - loss: 0.8504 - accuracy: 0.4575
2021-12-14 00:10:27.007658: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:10:27.008513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:10:27.008595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:10:27.008665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:10:27.008714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:10:27.008765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:10:27.008815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:10:27.008861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:10:27.008911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:10:27.009269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:10:27.010268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:10:27.010327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:10:27.010345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:10:27.010359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:10:27.011379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:10:27.011780: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:10:27.012298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:10:27.012339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:10:27.012378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:10:27.012417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:10:27.012453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:10:27.012489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:10:27.012526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:10:27.012562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:10:27.012604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:10:27.013538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:10:27.013580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:10:27.013597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:10:27.013610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:10:27.014589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [4.2591133e-04 3.1374791e-03 9.9805260e-01 5.5283657e-04 3.4303253e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [6.6542445e-04 3.7749831e-03 9.9672157e-01 8.3423092e-04 5.6418811e-04]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [4.7156599e-04 3.2213128e-03 9.9785244e-01 5.9441931e-04 3.7713390e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [4.3305027e-04 3.1244818e-03 9.9804592e-01 5.5460603e-04 3.4805233e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [4.3329661e-04 3.1252184e-03 9.9804652e-01 5.5488991e-04 3.4825731e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [4.3344012e-04 3.1258275e-03 9.9804628e-01 5.5527827e-04 3.4842585e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [4.7853056e-04 3.2255123e-03 9.9777848e-01 6.0747232e-04 3.8637102e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [4.3288150e-04 3.1242054e-03 9.9804866e-01 5.5434118e-04 3.4791650e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [4.3313697e-04 3.1247225e-03 9.9804628e-01 5.5467861e-04 3.4813280e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [4.7415213e-04 3.2107912e-03 9.9781501e-01 6.0151046e-04 3.8078518e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [4.3257498e-04 3.1217590e-03 9.9804926e-01 5.5427436e-04 3.4769383e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [4.5144255e-04 3.1699981e-03 9.9797040e-01 5.7418167e-04 3.6164193e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [4.3345874e-04 3.1252631e-03 9.9804437e-01 5.5497140e-04 3.4836886e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [4.3721852e-04 3.1293856e-03 9.9801767e-01 5.5863010e-04 3.5128137e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [4.3355027e-04 3.1264266e-03 9.9804676e-01 5.5539870e-04 3.4852317e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:36 - loss: 2.5005 - accuracy: 0.0781 3/11 [=======>......................] - ETA: 0s - loss: 2.4955 - accuracy: 0.1879   5/11 [============>.................] - ETA: 0s - loss: 2.4905 - accuracy: 0.2482 7/11 [==================>...........] - ETA: 0s - loss: 2.4853 - accuracy: 0.2842 9/11 [=======================>......] - ETA: 0s - loss: 2.4798 - accuracy: 0.306511/11 [==============================] - ETA: 0s - loss: 2.4742 - accuracy: 0.323011/11 [==============================] - 16s 29ms/step - loss: 2.4719 - accuracy: 0.3294
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3526 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 2.3418 - accuracy: 0.4427 5/11 [============>.................] - ETA: 0s - loss: 2.3291 - accuracy: 0.4507 7/11 [==================>...........] - ETA: 0s - loss: 2.3157 - accuracy: 0.4502 9/11 [=======================>......] - ETA: 0s - loss: 2.2997 - accuracy: 0.449811/11 [==============================] - ETA: 0s - loss: 2.2826 - accuracy: 0.450111/11 [==============================] - 0s 29ms/step - loss: 2.2756 - accuracy: 0.4501
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 1.9333 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 1.8807 - accuracy: 0.4154 5/11 [============>.................] - ETA: 0s - loss: 1.8282 - accuracy: 0.4257 7/11 [==================>...........] - ETA: 0s - loss: 1.7736 - accuracy: 0.4353 9/11 [=======================>......] - ETA: 0s - loss: 1.7239 - accuracy: 0.440611/11 [==============================] - 0s 29ms/step - loss: 1.6651 - accuracy: 0.4430
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.1031 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 1.0963 - accuracy: 0.4353 5/11 [============>.................] - ETA: 0s - loss: 1.0814 - accuracy: 0.4368 7/11 [==================>...........] - ETA: 0s - loss: 1.0715 - accuracy: 0.4388 9/11 [=======================>......] - ETA: 0s - loss: 1.0621 - accuracy: 0.440411/11 [==============================] - ETA: 0s - loss: 1.0518 - accuracy: 0.442211/11 [==============================] - 0s 28ms/step - loss: 1.0478 - accuracy: 0.4428
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9513 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.9402 - accuracy: 0.4340 5/11 [============>.................] - ETA: 0s - loss: 0.9352 - accuracy: 0.4362 7/11 [==================>...........] - ETA: 0s - loss: 0.9287 - accuracy: 0.4386 9/11 [=======================>......] - ETA: 0s - loss: 0.9241 - accuracy: 0.441411/11 [==============================] - ETA: 0s - loss: 0.9216 - accuracy: 0.442711/11 [==============================] - 0s 28ms/step - loss: 0.9206 - accuracy: 0.4433
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9300 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.8873 - accuracy: 0.4553 5/11 [============>.................] - ETA: 0s - loss: 0.8721 - accuracy: 0.4608 8/11 [====================>.........] - ETA: 0s - loss: 0.8701 - accuracy: 0.459310/11 [==========================>...] - ETA: 0s - loss: 0.8722 - accuracy: 0.457811/11 [==============================] - 0s 27ms/step - loss: 0.8740 - accuracy: 0.4565
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8656 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.8924 - accuracy: 0.4370 6/11 [===============>..............] - ETA: 0s - loss: 0.8890 - accuracy: 0.4400 8/11 [====================>.........] - ETA: 0s - loss: 0.8803 - accuracy: 0.444510/11 [==========================>...] - ETA: 0s - loss: 0.8762 - accuracy: 0.446911/11 [==============================] - 0s 28ms/step - loss: 0.8757 - accuracy: 0.4473
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 1.0089 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.9518 - accuracy: 0.4314 5/11 [============>.................] - ETA: 0s - loss: 0.9276 - accuracy: 0.4367 7/11 [==================>...........] - ETA: 0s - loss: 0.9123 - accuracy: 0.4409 9/11 [=======================>......] - ETA: 0s - loss: 0.9038 - accuracy: 0.442711/11 [==============================] - 0s 28ms/step - loss: 0.8951 - accuracy: 0.4446
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7838 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8089 - accuracy: 0.4640 5/11 [============>.................] - ETA: 0s - loss: 0.8324 - accuracy: 0.4567 7/11 [==================>...........] - ETA: 0s - loss: 0.8451 - accuracy: 0.4530 9/11 [=======================>......] - ETA: 0s - loss: 0.8529 - accuracy: 0.450811/11 [==============================] - ETA: 0s - loss: 0.8564 - accuracy: 0.449911/11 [==============================] - 0s 29ms/step - loss: 0.8572 - accuracy: 0.4499
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8444 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8610 - accuracy: 0.4653 5/11 [============>.................] - ETA: 0s - loss: 0.8459 - accuracy: 0.4684 7/11 [==================>...........] - ETA: 0s - loss: 0.8452 - accuracy: 0.4664 9/11 [=======================>......] - ETA: 0s - loss: 0.8466 - accuracy: 0.464411/11 [==============================] - 0s 29ms/step - loss: 0.8511 - accuracy: 0.4606
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8805 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8358 - accuracy: 0.4748 5/11 [============>.................] - ETA: 0s - loss: 0.8396 - accuracy: 0.4703 7/11 [==================>...........] - ETA: 0s - loss: 0.8468 - accuracy: 0.4642 9/11 [=======================>......] - ETA: 0s - loss: 0.8523 - accuracy: 0.459511/11 [==============================] - ETA: 0s - loss: 0.8543 - accuracy: 0.457511/11 [==============================] - 0s 29ms/step - loss: 0.8550 - accuracy: 0.4568
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8219 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8172 - accuracy: 0.4614 5/11 [============>.................] - ETA: 0s - loss: 0.8385 - accuracy: 0.4532 7/11 [==================>...........] - ETA: 0s - loss: 0.8515 - accuracy: 0.4485 9/11 [=======================>......] - ETA: 0s - loss: 0.8549 - accuracy: 0.447911/11 [==============================] - ETA: 0s - loss: 0.8560 - accuracy: 0.448211/11 [==============================] - 0s 29ms/step - loss: 0.8565 - accuracy: 0.4483
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8591 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8748 - accuracy: 0.4657 5/11 [============>.................] - ETA: 0s - loss: 0.8797 - accuracy: 0.4591 7/11 [==================>...........] - ETA: 0s - loss: 0.8814 - accuracy: 0.4552 9/11 [=======================>......] - ETA: 0s - loss: 0.8798 - accuracy: 0.452211/11 [==============================] - ETA: 0s - loss: 0.8770 - accuracy: 0.451311/11 [==============================] - 0s 30ms/step - loss: 0.8757 - accuracy: 0.4511
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8684 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8659 - accuracy: 0.4553 5/11 [============>.................] - ETA: 0s - loss: 0.8588 - accuracy: 0.4584 7/11 [==================>...........] - ETA: 0s - loss: 0.8552 - accuracy: 0.4586 9/11 [=======================>......] - ETA: 0s - loss: 0.8553 - accuracy: 0.457711/11 [==============================] - ETA: 0s - loss: 0.8559 - accuracy: 0.456511/11 [==============================] - 0s 29ms/step - loss: 0.8562 - accuracy: 0.4559
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8241 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8811 - accuracy: 0.4431 5/11 [============>.................] - ETA: 0s - loss: 0.8775 - accuracy: 0.4448 7/11 [==================>...........] - ETA: 0s - loss: 0.8765 - accuracy: 0.4445 9/11 [=======================>......] - ETA: 0s - loss: 0.8759 - accuracy: 0.444411/11 [==============================] - ETA: 0s - loss: 0.8738 - accuracy: 0.444911/11 [==============================] - 0s 30ms/step - loss: 0.8726 - accuracy: 0.4453
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8324 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.8410 - accuracy: 0.4596 6/11 [===============>..............] - ETA: 0s - loss: 0.8460 - accuracy: 0.4576 8/11 [====================>.........] - ETA: 0s - loss: 0.8433 - accuracy: 0.457910/11 [==========================>...] - ETA: 0s - loss: 0.8449 - accuracy: 0.457111/11 [==============================] - 0s 29ms/step - loss: 0.8472 - accuracy: 0.4559
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8103 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8413 - accuracy: 0.4583 5/11 [============>.................] - ETA: 0s - loss: 0.8381 - accuracy: 0.4598 7/11 [==================>...........] - ETA: 0s - loss: 0.8428 - accuracy: 0.4570 9/11 [=======================>......] - ETA: 0s - loss: 0.8450 - accuracy: 0.455611/11 [==============================] - 0s 28ms/step - loss: 0.8478 - accuracy: 0.4544
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8652 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.8616 - accuracy: 0.4314 5/11 [============>.................] - ETA: 0s - loss: 0.8734 - accuracy: 0.4274 7/11 [==================>...........] - ETA: 0s - loss: 0.8753 - accuracy: 0.4285 9/11 [=======================>......] - ETA: 0s - loss: 0.8718 - accuracy: 0.432711/11 [==============================] - ETA: 0s - loss: 0.8697 - accuracy: 0.435411/11 [==============================] - 0s 29ms/step - loss: 0.8687 - accuracy: 0.4366
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8848 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.8925 - accuracy: 0.4145 5/11 [============>.................] - ETA: 0s - loss: 0.8828 - accuracy: 0.4250 7/11 [==================>...........] - ETA: 0s - loss: 0.8759 - accuracy: 0.4315 9/11 [=======================>......] - ETA: 0s - loss: 0.8702 - accuracy: 0.436511/11 [==============================] - ETA: 0s - loss: 0.8677 - accuracy: 0.439211/11 [==============================] - 0s 29ms/step - loss: 0.8669 - accuracy: 0.4400
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7213 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.7657 - accuracy: 0.5226 5/11 [============>.................] - ETA: 0s - loss: 0.7862 - accuracy: 0.5054 7/11 [==================>...........] - ETA: 0s - loss: 0.8007 - accuracy: 0.4932 9/11 [=======================>......] - ETA: 0s - loss: 0.8108 - accuracy: 0.484511/11 [==============================] - 0s 28ms/step - loss: 0.8222 - accuracy: 0.4757
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.7285 - accuracy: 0.51566/6 [==============================] - ETA: 0s - loss: 0.8088 - accuracy: 0.4759 6/6 [==============================] - 5s 10ms/step - loss: 0.8088 - accuracy: 0.4759
2021-12-14 00:11:04.616540: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:11:04.617357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:11:04.617430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:11:04.617485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:11:04.617524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:11:04.617565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:11:04.617611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:11:04.617656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:11:04.617704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:11:04.617752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:11:04.618700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:11:04.618771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:11:04.618790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:11:04.618804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:11:04.619833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:11:04.620254: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:11:04.620765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:11:04.620804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:11:04.620841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:11:04.620878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:11:04.620914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:11:04.620964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:11:04.621001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:11:04.621038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:11:04.621081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:11:04.622013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:11:04.622054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:11:04.622072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:11:04.622085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:11:04.623063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 4 3 0] pred: [2.1986027e-04 1.2924561e-03 9.9754095e-01 4.4230552e-04 4.5794412e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 4 3 0] pred: [2.2432675e-04 1.2532801e-03 9.9749821e-01 4.3586170e-04 4.5382121e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 3 0] pred: [2.2243185e-04 1.2698706e-03 9.9751651e-01 4.3860698e-04 4.5566651e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 4 3 0] pred: [2.2508450e-04 1.3186760e-03 9.9748129e-01 4.5071493e-04 4.6447950e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 4 3 0] pred: [2.2518370e-04 1.3357156e-03 9.9747890e-01 4.5501284e-04 4.6702832e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 3 0] pred: [2.2124228e-04 1.2828851e-03 9.9752778e-01 4.4093860e-04 4.5717889e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 3 0] pred: [2.2719950e-04 1.2920105e-03 9.9745959e-01 4.4600424e-04 4.6104143e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 3 0] pred: [2.2119186e-04 1.2727504e-03 9.9752849e-01 4.3820951e-04 4.5480815e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 3 0] pred: [2.2327217e-04 1.2590950e-03 9.9750745e-01 4.3662961e-04 4.5416091e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 4 3 0] pred: [2.1950774e-04 1.2928686e-03 9.9754298e-01 4.4230573e-04 4.5764868e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 4 3 0] pred: [2.1902671e-04 1.2955039e-03 9.9754864e-01 4.4225453e-04 4.5729219e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 3 0] pred: [2.2191454e-04 1.2736686e-03 9.9752182e-01 4.3914304e-04 4.5603479e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [2.9191477e-04 1.5197768e-03 9.9687093e-01 5.4263009e-04 5.3066004e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 3 0] pred: [2.2595581e-04 1.3097179e-03 9.9747294e-01 4.4916212e-04 4.6348546e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 4 3 0] pred: [2.2187455e-04 1.2742140e-03 9.9752206e-01 4.3924543e-04 4.5609064e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:29 - loss: 2.5031 - accuracy: 0.1797 3/11 [=======>......................] - ETA: 0s - loss: 2.4993 - accuracy: 0.2305   5/11 [============>.................] - ETA: 0s - loss: 2.4954 - accuracy: 0.2785 8/11 [====================>.........] - ETA: 0s - loss: 2.4893 - accuracy: 0.322910/11 [==========================>...] - ETA: 0s - loss: 2.4850 - accuracy: 0.342611/11 [==============================] - 15s 25ms/step - loss: 2.4813 - accuracy: 0.3551
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.4034 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 2.3922 - accuracy: 0.4596 6/11 [===============>..............] - ETA: 0s - loss: 2.3787 - accuracy: 0.4641 8/11 [====================>.........] - ETA: 0s - loss: 2.3686 - accuracy: 0.461810/11 [==========================>...] - ETA: 0s - loss: 2.3574 - accuracy: 0.460411/11 [==============================] - 0s 26ms/step - loss: 2.3468 - accuracy: 0.4601
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 2.0735 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 2.0443 - accuracy: 0.4805 6/11 [===============>..............] - ETA: 0s - loss: 1.9989 - accuracy: 0.4681 8/11 [====================>.........] - ETA: 0s - loss: 1.9637 - accuracy: 0.464210/11 [==========================>...] - ETA: 0s - loss: 1.9246 - accuracy: 0.462511/11 [==============================] - 0s 27ms/step - loss: 1.8896 - accuracy: 0.4618
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.3045 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 1.2642 - accuracy: 0.4508 6/11 [===============>..............] - ETA: 0s - loss: 1.2386 - accuracy: 0.4497 8/11 [====================>.........] - ETA: 0s - loss: 1.2134 - accuracy: 0.451110/11 [==========================>...] - ETA: 0s - loss: 1.1904 - accuracy: 0.452311/11 [==============================] - 0s 26ms/step - loss: 1.1721 - accuracy: 0.4533
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9088 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.9491 - accuracy: 0.4473 6/11 [===============>..............] - ETA: 0s - loss: 0.9481 - accuracy: 0.4473 8/11 [====================>.........] - ETA: 0s - loss: 0.9421 - accuracy: 0.450410/11 [==========================>...] - ETA: 0s - loss: 0.9369 - accuracy: 0.452611/11 [==============================] - 0s 28ms/step - loss: 0.9335 - accuracy: 0.4536
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6880 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.7936 - accuracy: 0.4987 5/11 [============>.................] - ETA: 0s - loss: 0.8082 - accuracy: 0.4909 7/11 [==================>...........] - ETA: 0s - loss: 0.8244 - accuracy: 0.484110/11 [==========================>...] - ETA: 0s - loss: 0.8388 - accuracy: 0.477411/11 [==============================] - 0s 27ms/step - loss: 0.8447 - accuracy: 0.4743
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9263 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.9183 - accuracy: 0.4384 5/11 [============>.................] - ETA: 0s - loss: 0.9059 - accuracy: 0.4410 7/11 [==================>...........] - ETA: 0s - loss: 0.8939 - accuracy: 0.445710/11 [==========================>...] - ETA: 0s - loss: 0.8856 - accuracy: 0.448211/11 [==============================] - 0s 28ms/step - loss: 0.8812 - accuracy: 0.4499
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9189 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.9007 - accuracy: 0.4332 5/11 [============>.................] - ETA: 0s - loss: 0.8870 - accuracy: 0.4436 7/11 [==================>...........] - ETA: 0s - loss: 0.8783 - accuracy: 0.449410/11 [==========================>...] - ETA: 0s - loss: 0.8712 - accuracy: 0.453111/11 [==============================] - 0s 28ms/step - loss: 0.8681 - accuracy: 0.4539
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7837 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.7869 - accuracy: 0.4887 6/11 [===============>..............] - ETA: 0s - loss: 0.8123 - accuracy: 0.4742 8/11 [====================>.........] - ETA: 0s - loss: 0.8223 - accuracy: 0.468910/11 [==========================>...] - ETA: 0s - loss: 0.8278 - accuracy: 0.466511/11 [==============================] - 0s 27ms/step - loss: 0.8312 - accuracy: 0.4651
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7829 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.7850 - accuracy: 0.4787 6/11 [===============>..............] - ETA: 0s - loss: 0.7844 - accuracy: 0.4841 9/11 [=======================>......] - ETA: 0s - loss: 0.7940 - accuracy: 0.479311/11 [==============================] - ETA: 0s - loss: 0.8030 - accuracy: 0.475711/11 [==============================] - 0s 28ms/step - loss: 0.8066 - accuracy: 0.4742
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9857 - accuracy: 0.3516 3/11 [=======>......................] - ETA: 0s - loss: 0.9124 - accuracy: 0.4110 5/11 [============>.................] - ETA: 0s - loss: 0.8896 - accuracy: 0.4232 7/11 [==================>...........] - ETA: 0s - loss: 0.8757 - accuracy: 0.4317 9/11 [=======================>......] - ETA: 0s - loss: 0.8712 - accuracy: 0.436011/11 [==============================] - ETA: 0s - loss: 0.8669 - accuracy: 0.439411/11 [==============================] - 0s 27ms/step - loss: 0.8650 - accuracy: 0.4410
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7587 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.7692 - accuracy: 0.4905 5/11 [============>.................] - ETA: 0s - loss: 0.7854 - accuracy: 0.4847 7/11 [==================>...........] - ETA: 0s - loss: 0.7982 - accuracy: 0.4781 9/11 [=======================>......] - ETA: 0s - loss: 0.8076 - accuracy: 0.473811/11 [==============================] - 0s 27ms/step - loss: 0.8168 - accuracy: 0.4696
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7427 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.8180 - accuracy: 0.4648 6/11 [===============>..............] - ETA: 0s - loss: 0.8415 - accuracy: 0.4521 8/11 [====================>.........] - ETA: 0s - loss: 0.8417 - accuracy: 0.452710/11 [==========================>...] - ETA: 0s - loss: 0.8418 - accuracy: 0.453711/11 [==============================] - 0s 27ms/step - loss: 0.8417 - accuracy: 0.4545
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8452 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8287 - accuracy: 0.4661 5/11 [============>.................] - ETA: 0s - loss: 0.8256 - accuracy: 0.4684 7/11 [==================>...........] - ETA: 0s - loss: 0.8292 - accuracy: 0.4677 9/11 [=======================>......] - ETA: 0s - loss: 0.8340 - accuracy: 0.466011/11 [==============================] - 0s 27ms/step - loss: 0.8358 - accuracy: 0.4641
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8004 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.8136 - accuracy: 0.4740 5/11 [============>.................] - ETA: 0s - loss: 0.8132 - accuracy: 0.4764 7/11 [==================>...........] - ETA: 0s - loss: 0.8174 - accuracy: 0.474110/11 [==========================>...] - ETA: 0s - loss: 0.8220 - accuracy: 0.469811/11 [==============================] - 0s 28ms/step - loss: 0.8249 - accuracy: 0.4679
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8716 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8724 - accuracy: 0.4470 5/11 [============>.................] - ETA: 0s - loss: 0.8586 - accuracy: 0.4549 7/11 [==================>...........] - ETA: 0s - loss: 0.8563 - accuracy: 0.4546 9/11 [=======================>......] - ETA: 0s - loss: 0.8552 - accuracy: 0.454411/11 [==============================] - 0s 29ms/step - loss: 0.8516 - accuracy: 0.4552
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7739 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.7799 - accuracy: 0.4905 5/11 [============>.................] - ETA: 0s - loss: 0.7911 - accuracy: 0.4847 8/11 [====================>.........] - ETA: 0s - loss: 0.7992 - accuracy: 0.480110/11 [==========================>...] - ETA: 0s - loss: 0.8062 - accuracy: 0.476211/11 [==============================] - 0s 27ms/step - loss: 0.8115 - accuracy: 0.4733
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9554 - accuracy: 0.4062 4/11 [=========>....................] - ETA: 0s - loss: 0.9319 - accuracy: 0.4066 6/11 [===============>..............] - ETA: 0s - loss: 0.9023 - accuracy: 0.4218 8/11 [====================>.........] - ETA: 0s - loss: 0.8829 - accuracy: 0.432310/11 [==========================>...] - ETA: 0s - loss: 0.8725 - accuracy: 0.438011/11 [==============================] - 0s 26ms/step - loss: 0.8666 - accuracy: 0.4414
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8626 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.8549 - accuracy: 0.4379 5/11 [============>.................] - ETA: 0s - loss: 0.8474 - accuracy: 0.4449 7/11 [==================>...........] - ETA: 0s - loss: 0.8446 - accuracy: 0.4479 9/11 [=======================>......] - ETA: 0s - loss: 0.8444 - accuracy: 0.448811/11 [==============================] - ETA: 0s - loss: 0.8425 - accuracy: 0.450611/11 [==============================] - 0s 28ms/step - loss: 0.8420 - accuracy: 0.4513
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8403 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8221 - accuracy: 0.4457 5/11 [============>.................] - ETA: 0s - loss: 0.8235 - accuracy: 0.4507 7/11 [==================>...........] - ETA: 0s - loss: 0.8217 - accuracy: 0.4552 9/11 [=======================>......] - ETA: 0s - loss: 0.8241 - accuracy: 0.455511/11 [==============================] - ETA: 0s - loss: 0.8262 - accuracy: 0.456211/11 [==============================] - 0s 28ms/step - loss: 0.8270 - accuracy: 0.4564
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.7909 - accuracy: 0.48446/6 [==============================] - ETA: 0s - loss: 0.8483 - accuracy: 0.4589 6/6 [==============================] - 5s 11ms/step - loss: 0.8483 - accuracy: 0.4589
2021-12-14 00:11:41.237176: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:11:41.238388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:11:41.238465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:11:41.238525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:11:41.238563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:11:41.238606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:11:41.238657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:11:41.238705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:11:41.238748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:11:41.238796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:11:41.239784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:11:41.239842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:11:41.239860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:11:41.239873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:11:41.240899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:11:41.241404: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:11:41.241940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:11:41.241979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:11:41.242018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:11:41.242055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:11:41.242091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:11:41.242126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:11:41.242166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:11:41.242203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:11:41.242243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:11:41.243210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:11:41.243252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:11:41.243270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:11:41.243283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:11:41.244296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 4 1 3 0] pred: [4.7008379e-04 1.1661102e-03 9.9801350e-01 7.0253952e-04 1.2808327e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 4 1 3 0] pred: [0.00112734 0.00232816 0.994981   0.00154725 0.00296853]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 4 1 3 0] pred: [4.3259558e-04 1.0909738e-03 9.9818879e-01 6.5316190e-04 1.1530212e-03]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [2 4 1 0 3] pred: [0.02319536 0.02441701 0.94011897 0.01815142 0.03386406]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 4 1 3 0] pred: [4.1570436e-04 1.0645534e-03 9.9826992e-01 6.3007744e-04 1.1209736e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 4 1 3 0] pred: [4.1548366e-04 1.0820142e-03 9.9825889e-01 6.2697049e-04 1.1576143e-03]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 6 ============
pred sorted: [2 4 1 3 0] pred: [4.4062349e-04 1.1243697e-03 9.9814701e-01 6.5899821e-04 1.2135613e-03]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 1 3 0] pred: [4.0783509e-04 1.0651911e-03 9.9827731e-01 6.1816938e-04 1.1614249e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 4 1 3 0] pred: [4.1823395e-04 1.0659320e-03 9.9826092e-01 6.3263380e-04 1.1209485e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 4 1 3 0] pred: [4.1700041e-04 1.0654031e-03 9.9826497e-01 6.3145492e-04 1.1214649e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 4 1 3 0] pred: [4.1365685e-04 1.0648511e-03 9.9826318e-01 6.2275142e-04 1.1536563e-03]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [2 4 1 3 0] pred: [4.1137173e-04 1.0655305e-03 9.9827921e-01 6.2692328e-04 1.1281978e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 4 1 3 0] pred: [0.01834423 0.02274164 0.92977965 0.02218395 0.04879554]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 4 1 3 0] pred: [4.1177031e-04 1.0652676e-03 9.9827862e-01 6.2717160e-04 1.1272170e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 4 1 3 0] pred: [4.1472510e-04 1.0659945e-03 9.9827087e-01 6.2967668e-04 1.1250108e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:31 - loss: 2.4983 - accuracy: 0.2109 3/11 [=======>......................] - ETA: 0s - loss: 2.4934 - accuracy: 0.3012   5/11 [============>.................] - ETA: 0s - loss: 2.4884 - accuracy: 0.3378 7/11 [==================>...........] - ETA: 0s - loss: 2.4829 - accuracy: 0.3642 9/11 [=======================>......] - ETA: 0s - loss: 2.4775 - accuracy: 0.379311/11 [==============================] - 15s 29ms/step - loss: 2.4698 - accuracy: 0.3941
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3694 - accuracy: 0.3672 3/11 [=======>......................] - ETA: 0s - loss: 2.3548 - accuracy: 0.4119 5/11 [============>.................] - ETA: 0s - loss: 2.3396 - accuracy: 0.4333 7/11 [==================>...........] - ETA: 0s - loss: 2.3257 - accuracy: 0.444710/11 [==========================>...] - ETA: 0s - loss: 2.3034 - accuracy: 0.453011/11 [==============================] - 0s 28ms/step - loss: 2.2900 - accuracy: 0.4541
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 1.8979 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 0s - loss: 1.8704 - accuracy: 0.4852 6/11 [===============>..............] - ETA: 0s - loss: 1.8397 - accuracy: 0.4781 8/11 [====================>.........] - ETA: 0s - loss: 1.8072 - accuracy: 0.474010/11 [==========================>...] - ETA: 0s - loss: 1.7746 - accuracy: 0.470311/11 [==============================] - 0s 27ms/step - loss: 1.7453 - accuracy: 0.4686
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.1900 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 1.1955 - accuracy: 0.4501 6/11 [===============>..............] - ETA: 0s - loss: 1.1603 - accuracy: 0.4547 8/11 [====================>.........] - ETA: 0s - loss: 1.1412 - accuracy: 0.456310/11 [==========================>...] - ETA: 0s - loss: 1.1256 - accuracy: 0.456911/11 [==============================] - 0s 27ms/step - loss: 1.1133 - accuracy: 0.4573
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9740 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.9545 - accuracy: 0.4701 5/11 [============>.................] - ETA: 0s - loss: 0.9392 - accuracy: 0.4675 7/11 [==================>...........] - ETA: 0s - loss: 0.9265 - accuracy: 0.4668 9/11 [=======================>......] - ETA: 0s - loss: 0.9200 - accuracy: 0.466011/11 [==============================] - ETA: 0s - loss: 0.9162 - accuracy: 0.465011/11 [==============================] - 0s 27ms/step - loss: 0.9148 - accuracy: 0.4646
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8686 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8912 - accuracy: 0.4462 6/11 [===============>..............] - ETA: 0s - loss: 0.8895 - accuracy: 0.4483 8/11 [====================>.........] - ETA: 0s - loss: 0.8832 - accuracy: 0.452110/11 [==========================>...] - ETA: 0s - loss: 0.8779 - accuracy: 0.454411/11 [==============================] - 0s 29ms/step - loss: 0.8751 - accuracy: 0.4553
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9204 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.8701 - accuracy: 0.4444 5/11 [============>.................] - ETA: 0s - loss: 0.8616 - accuracy: 0.4507 7/11 [==================>...........] - ETA: 0s - loss: 0.8574 - accuracy: 0.4542 9/11 [=======================>......] - ETA: 0s - loss: 0.8544 - accuracy: 0.456311/11 [==============================] - ETA: 0s - loss: 0.8533 - accuracy: 0.457111/11 [==============================] - 0s 29ms/step - loss: 0.8529 - accuracy: 0.4574
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9968 - accuracy: 0.3906 3/11 [=======>......................] - ETA: 0s - loss: 0.9325 - accuracy: 0.4227 5/11 [============>.................] - ETA: 0s - loss: 0.8951 - accuracy: 0.4400 7/11 [==================>...........] - ETA: 0s - loss: 0.8788 - accuracy: 0.4472 9/11 [=======================>......] - ETA: 0s - loss: 0.8690 - accuracy: 0.452011/11 [==============================] - ETA: 0s - loss: 0.8642 - accuracy: 0.453811/11 [==============================] - 0s 28ms/step - loss: 0.8625 - accuracy: 0.4543
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8063 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.8125 - accuracy: 0.4805 5/11 [============>.................] - ETA: 0s - loss: 0.8231 - accuracy: 0.4721 8/11 [====================>.........] - ETA: 0s - loss: 0.8262 - accuracy: 0.468610/11 [==========================>...] - ETA: 0s - loss: 0.8286 - accuracy: 0.466911/11 [==============================] - 0s 28ms/step - loss: 0.8305 - accuracy: 0.4657
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7370 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.7608 - accuracy: 0.5152 5/11 [============>.................] - ETA: 0s - loss: 0.7787 - accuracy: 0.5022 7/11 [==================>...........] - ETA: 0s - loss: 0.7957 - accuracy: 0.4914 9/11 [=======================>......] - ETA: 0s - loss: 0.8073 - accuracy: 0.483811/11 [==============================] - 0s 27ms/step - loss: 0.8152 - accuracy: 0.4777
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8561 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8486 - accuracy: 0.4358 5/11 [============>.................] - ETA: 0s - loss: 0.8393 - accuracy: 0.4443 7/11 [==================>...........] - ETA: 0s - loss: 0.8367 - accuracy: 0.4470 9/11 [=======================>......] - ETA: 0s - loss: 0.8358 - accuracy: 0.448711/11 [==============================] - 0s 28ms/step - loss: 0.8356 - accuracy: 0.4517
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8791 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.8455 - accuracy: 0.4353 5/11 [============>.................] - ETA: 0s - loss: 0.8457 - accuracy: 0.4425 7/11 [==================>...........] - ETA: 0s - loss: 0.8448 - accuracy: 0.446610/11 [==========================>...] - ETA: 0s - loss: 0.8443 - accuracy: 0.449611/11 [==============================] - 0s 27ms/step - loss: 0.8428 - accuracy: 0.4513
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9620 - accuracy: 0.3828 3/11 [=======>......................] - ETA: 0s - loss: 0.9129 - accuracy: 0.4141 5/11 [============>.................] - ETA: 0s - loss: 0.8926 - accuracy: 0.4286 7/11 [==================>...........] - ETA: 0s - loss: 0.8788 - accuracy: 0.4371 9/11 [=======================>......] - ETA: 0s - loss: 0.8707 - accuracy: 0.441911/11 [==============================] - 0s 28ms/step - loss: 0.8617 - accuracy: 0.4462
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8552 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8243 - accuracy: 0.4549 5/11 [============>.................] - ETA: 0s - loss: 0.8250 - accuracy: 0.4541 7/11 [==================>...........] - ETA: 0s - loss: 0.8265 - accuracy: 0.4540 9/11 [=======================>......] - ETA: 0s - loss: 0.8265 - accuracy: 0.455211/11 [==============================] - ETA: 0s - loss: 0.8270 - accuracy: 0.456511/11 [==============================] - 0s 28ms/step - loss: 0.8275 - accuracy: 0.4567
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8309 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8191 - accuracy: 0.4688 5/11 [============>.................] - ETA: 0s - loss: 0.8275 - accuracy: 0.4597 8/11 [====================>.........] - ETA: 0s - loss: 0.8267 - accuracy: 0.460810/11 [==========================>...] - ETA: 0s - loss: 0.8279 - accuracy: 0.460311/11 [==============================] - 0s 28ms/step - loss: 0.8286 - accuracy: 0.4602
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9438 - accuracy: 0.3594 3/11 [=======>......................] - ETA: 0s - loss: 0.8937 - accuracy: 0.4041 5/11 [============>.................] - ETA: 0s - loss: 0.8740 - accuracy: 0.4235 7/11 [==================>...........] - ETA: 0s - loss: 0.8625 - accuracy: 0.4340 9/11 [=======================>......] - ETA: 0s - loss: 0.8544 - accuracy: 0.440011/11 [==============================] - ETA: 0s - loss: 0.8497 - accuracy: 0.443911/11 [==============================] - 0s 29ms/step - loss: 0.8481 - accuracy: 0.4452
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8271 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.7852 - accuracy: 0.4714 5/11 [============>.................] - ETA: 0s - loss: 0.7941 - accuracy: 0.4671 7/11 [==================>...........] - ETA: 0s - loss: 0.7997 - accuracy: 0.4665 9/11 [=======================>......] - ETA: 0s - loss: 0.8036 - accuracy: 0.465911/11 [==============================] - 0s 28ms/step - loss: 0.8107 - accuracy: 0.4640
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7217 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.7558 - accuracy: 0.5030 5/11 [============>.................] - ETA: 0s - loss: 0.7725 - accuracy: 0.4924 7/11 [==================>...........] - ETA: 0s - loss: 0.7811 - accuracy: 0.4873 9/11 [=======================>......] - ETA: 0s - loss: 0.7887 - accuracy: 0.483111/11 [==============================] - 0s 28ms/step - loss: 0.7991 - accuracy: 0.4771
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9341 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.9297 - accuracy: 0.4301 5/11 [============>.................] - ETA: 0s - loss: 0.9074 - accuracy: 0.4370 7/11 [==================>...........] - ETA: 0s - loss: 0.8876 - accuracy: 0.4448 9/11 [=======================>......] - ETA: 0s - loss: 0.8764 - accuracy: 0.448711/11 [==============================] - 0s 28ms/step - loss: 0.8645 - accuracy: 0.4516
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8647 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8592 - accuracy: 0.4479 6/11 [===============>..............] - ETA: 0s - loss: 0.8499 - accuracy: 0.4470 8/11 [====================>.........] - ETA: 0s - loss: 0.8361 - accuracy: 0.453910/11 [==========================>...] - ETA: 0s - loss: 0.8307 - accuracy: 0.456711/11 [==============================] - 0s 27ms/step - loss: 0.8300 - accuracy: 0.4572
Evaluate on test data
1/6 [====>.........................] - ETA: 23s - loss: 0.8300 - accuracy: 0.45316/6 [==============================] - ETA: 0s - loss: 0.8499 - accuracy: 0.4561 6/6 [==============================] - 5s 10ms/step - loss: 0.8499 - accuracy: 0.4561
2021-12-14 00:12:18.245476: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:12:18.246345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:12:18.246422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:12:18.246479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:12:18.246525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:12:18.246572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:12:18.246621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:12:18.246667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:12:18.246713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:12:18.246764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:12:18.247755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:12:18.247819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:12:18.247837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:12:18.247851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:12:18.248915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:12:18.249641: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:12:18.250162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:12:18.250202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:12:18.250241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:12:18.250278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:12:18.250314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:12:18.250350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:12:18.250390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:12:18.250427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:12:18.250463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:12:18.251424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:12:18.251465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:12:18.251483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:12:18.251495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:12:18.252509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [7.9133810e-04 1.0689073e-03 9.9573046e-01 1.9647561e-04 3.2868388e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 0 1 4 3] pred: [1.2466006e-03 1.1757716e-03 9.9036670e-01 2.6838048e-04 5.3392159e-04]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 4 3] pred: [7.5197930e-04 1.1414640e-03 9.9625421e-01 2.0133410e-04 3.1830315e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [7.5855362e-04 1.1219147e-03 9.9617130e-01 1.9843133e-04 3.1724674e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 0 1 4 3] pred: [0.35361376 0.3019191  0.53291285 0.25629744 0.29655403]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [7.5839605e-04 1.1173227e-03 9.9614185e-01 1.9785455e-04 3.1793979e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [7.6914346e-04 1.1001047e-03 9.9603927e-01 1.9614806e-04 3.1871523e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 4 3] pred: [7.5471232e-04 1.1334049e-03 9.9621707e-01 2.0021858e-04 3.1827463e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 4 3] pred: [7.6194055e-04 1.1180856e-03 9.9614966e-01 1.9784135e-04 3.1707893e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 4 3] pred: [7.6037389e-04 1.1176335e-03 9.9613804e-01 1.9843625e-04 3.1862257e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 4 3] pred: [7.8183197e-04 1.0752769e-03 9.9585426e-01 1.9240538e-04 3.1940450e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [8.8560442e-04 1.0232277e-03 9.9428385e-01 1.9550779e-04 3.6567592e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 4 3] pred: [1.0118990e-03 1.0611690e-03 9.9432713e-01 2.1322294e-04 3.7265421e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [7.9208543e-04 1.0695929e-03 9.9577588e-01 1.9589163e-04 3.2606721e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [7.5310591e-04 1.1324228e-03 9.9621862e-01 1.9994653e-04 3.1792285e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:29 - loss: 2.4972 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 2.4927 - accuracy: 0.4627   5/11 [============>.................] - ETA: 0s - loss: 2.4881 - accuracy: 0.4516 7/11 [==================>...........] - ETA: 0s - loss: 2.4832 - accuracy: 0.4521 9/11 [=======================>......] - ETA: 0s - loss: 2.4780 - accuracy: 0.452911/11 [==============================] - 15s 27ms/step - loss: 2.4705 - accuracy: 0.4526
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3647 - accuracy: 0.3906 3/11 [=======>......................] - ETA: 0s - loss: 2.3559 - accuracy: 0.4149 5/11 [============>.................] - ETA: 0s - loss: 2.3456 - accuracy: 0.4281 7/11 [==================>...........] - ETA: 0s - loss: 2.3332 - accuracy: 0.4344 9/11 [=======================>......] - ETA: 0s - loss: 2.3195 - accuracy: 0.437611/11 [==============================] - 0s 26ms/step - loss: 2.2986 - accuracy: 0.4405
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 1.9741 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 1.9122 - accuracy: 0.4473 7/11 [==================>...........] - ETA: 0s - loss: 1.8536 - accuracy: 0.4555 9/11 [=======================>......] - ETA: 0s - loss: 1.8173 - accuracy: 0.457211/11 [==============================] - ETA: 0s - loss: 1.7844 - accuracy: 0.456211/11 [==============================] - 0s 26ms/step - loss: 1.7712 - accuracy: 0.4557
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.2057 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 1.1828 - accuracy: 0.4744 7/11 [==================>...........] - ETA: 0s - loss: 1.1628 - accuracy: 0.4674 9/11 [=======================>......] - ETA: 0s - loss: 1.1490 - accuracy: 0.464511/11 [==============================] - ETA: 0s - loss: 1.1373 - accuracy: 0.461911/11 [==============================] - 0s 26ms/step - loss: 1.1328 - accuracy: 0.4609
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8847 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.9398 - accuracy: 0.4332 5/11 [============>.................] - ETA: 0s - loss: 0.9395 - accuracy: 0.4421 8/11 [====================>.........] - ETA: 0s - loss: 0.9413 - accuracy: 0.445710/11 [==========================>...] - ETA: 0s - loss: 0.9387 - accuracy: 0.447111/11 [==============================] - 0s 26ms/step - loss: 0.9366 - accuracy: 0.4475
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8800 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8591 - accuracy: 0.4644 5/11 [============>.................] - ETA: 0s - loss: 0.8681 - accuracy: 0.4568 7/11 [==================>...........] - ETA: 0s - loss: 0.8755 - accuracy: 0.4530 9/11 [=======================>......] - ETA: 0s - loss: 0.8792 - accuracy: 0.450911/11 [==============================] - 0s 27ms/step - loss: 0.8809 - accuracy: 0.4501
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8055 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.8246 - accuracy: 0.4891 5/11 [============>.................] - ETA: 0s - loss: 0.8323 - accuracy: 0.4806 7/11 [==================>...........] - ETA: 0s - loss: 0.8480 - accuracy: 0.470110/11 [==========================>...] - ETA: 0s - loss: 0.8574 - accuracy: 0.461611/11 [==============================] - 0s 27ms/step - loss: 0.8594 - accuracy: 0.4596
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8482 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8791 - accuracy: 0.4449 6/11 [===============>..............] - ETA: 0s - loss: 0.8651 - accuracy: 0.4501 8/11 [====================>.........] - ETA: 0s - loss: 0.8668 - accuracy: 0.449010/11 [==========================>...] - ETA: 0s - loss: 0.8677 - accuracy: 0.448611/11 [==============================] - 0s 25ms/step - loss: 0.8668 - accuracy: 0.4488
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9443 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.8717 - accuracy: 0.4479 6/11 [===============>..............] - ETA: 0s - loss: 0.8613 - accuracy: 0.4505 8/11 [====================>.........] - ETA: 0s - loss: 0.8650 - accuracy: 0.449110/11 [==========================>...] - ETA: 0s - loss: 0.8652 - accuracy: 0.449211/11 [==============================] - 0s 26ms/step - loss: 0.8642 - accuracy: 0.4493
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8000 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8023 - accuracy: 0.4805 5/11 [============>.................] - ETA: 0s - loss: 0.8146 - accuracy: 0.4757 7/11 [==================>...........] - ETA: 0s - loss: 0.8223 - accuracy: 0.472510/11 [==========================>...] - ETA: 0s - loss: 0.8304 - accuracy: 0.467611/11 [==============================] - 0s 27ms/step - loss: 0.8348 - accuracy: 0.4646
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8087 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8398 - accuracy: 0.4457 5/11 [============>.................] - ETA: 0s - loss: 0.8281 - accuracy: 0.4520 7/11 [==================>...........] - ETA: 0s - loss: 0.8305 - accuracy: 0.4530 9/11 [=======================>......] - ETA: 0s - loss: 0.8342 - accuracy: 0.452711/11 [==============================] - 0s 27ms/step - loss: 0.8390 - accuracy: 0.4522
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8052 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.8160 - accuracy: 0.4809 5/11 [============>.................] - ETA: 0s - loss: 0.8158 - accuracy: 0.4759 7/11 [==================>...........] - ETA: 0s - loss: 0.8216 - accuracy: 0.4710 9/11 [=======================>......] - ETA: 0s - loss: 0.8277 - accuracy: 0.467111/11 [==============================] - 0s 27ms/step - loss: 0.8344 - accuracy: 0.4627
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8510 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8773 - accuracy: 0.4484 5/11 [============>.................] - ETA: 0s - loss: 0.8718 - accuracy: 0.4484 7/11 [==================>...........] - ETA: 0s - loss: 0.8661 - accuracy: 0.4492 9/11 [=======================>......] - ETA: 0s - loss: 0.8630 - accuracy: 0.449511/11 [==============================] - ETA: 0s - loss: 0.8614 - accuracy: 0.449311/11 [==============================] - 0s 27ms/step - loss: 0.8607 - accuracy: 0.4493
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8660 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.8681 - accuracy: 0.4544 5/11 [============>.................] - ETA: 0s - loss: 0.8573 - accuracy: 0.4513 7/11 [==================>...........] - ETA: 0s - loss: 0.8591 - accuracy: 0.4491 9/11 [=======================>......] - ETA: 0s - loss: 0.8596 - accuracy: 0.447811/11 [==============================] - ETA: 0s - loss: 0.8587 - accuracy: 0.447811/11 [==============================] - 0s 27ms/step - loss: 0.8581 - accuracy: 0.4480
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9098 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.8927 - accuracy: 0.4158 5/11 [============>.................] - ETA: 0s - loss: 0.8794 - accuracy: 0.4252 7/11 [==================>...........] - ETA: 0s - loss: 0.8708 - accuracy: 0.4300 9/11 [=======================>......] - ETA: 0s - loss: 0.8631 - accuracy: 0.434811/11 [==============================] - 0s 27ms/step - loss: 0.8591 - accuracy: 0.4389
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6995 - accuracy: 0.5703 4/11 [=========>....................] - ETA: 0s - loss: 0.7596 - accuracy: 0.5156 6/11 [===============>..............] - ETA: 0s - loss: 0.7780 - accuracy: 0.4994 8/11 [====================>.........] - ETA: 0s - loss: 0.7893 - accuracy: 0.490510/11 [==========================>...] - ETA: 0s - loss: 0.7992 - accuracy: 0.483311/11 [==============================] - 0s 27ms/step - loss: 0.8076 - accuracy: 0.4777
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6414 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.7607 - accuracy: 0.5030 5/11 [============>.................] - ETA: 0s - loss: 0.7906 - accuracy: 0.4895 7/11 [==================>...........] - ETA: 0s - loss: 0.8067 - accuracy: 0.4792 9/11 [=======================>......] - ETA: 0s - loss: 0.8175 - accuracy: 0.471511/11 [==============================] - 0s 27ms/step - loss: 0.8246 - accuracy: 0.4664
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9304 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8989 - accuracy: 0.4410 5/11 [============>.................] - ETA: 0s - loss: 0.8996 - accuracy: 0.4379 7/11 [==================>...........] - ETA: 0s - loss: 0.8911 - accuracy: 0.4416 9/11 [=======================>......] - ETA: 0s - loss: 0.8840 - accuracy: 0.442911/11 [==============================] - 0s 27ms/step - loss: 0.8759 - accuracy: 0.4443
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7382 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.8153 - accuracy: 0.4783 5/11 [============>.................] - ETA: 0s - loss: 0.8397 - accuracy: 0.4606 7/11 [==================>...........] - ETA: 0s - loss: 0.8483 - accuracy: 0.4557 9/11 [=======================>......] - ETA: 0s - loss: 0.8503 - accuracy: 0.452411/11 [==============================] - ETA: 0s - loss: 0.8501 - accuracy: 0.451711/11 [==============================] - 0s 27ms/step - loss: 0.8499 - accuracy: 0.4515
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8703 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.8276 - accuracy: 0.4614 6/11 [===============>..............] - ETA: 0s - loss: 0.8226 - accuracy: 0.4647 9/11 [=======================>......] - ETA: 0s - loss: 0.8305 - accuracy: 0.460611/11 [==============================] - ETA: 0s - loss: 0.8335 - accuracy: 0.458811/11 [==============================] - 0s 27ms/step - loss: 0.8346 - accuracy: 0.4580
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.8278 - accuracy: 0.50006/6 [==============================] - ETA: 0s - loss: 0.8195 - accuracy: 0.4759 6/6 [==============================] - 5s 12ms/step - loss: 0.8195 - accuracy: 0.4759
2021-12-14 00:12:54.576816: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:12:54.577494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:12:54.577547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:12:54.577585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:12:54.577615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:12:54.577647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:12:54.577679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:12:54.577711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:12:54.577742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:12:54.577774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:12:54.578503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:12:54.578549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:12:54.578563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:12:54.578572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:12:54.579344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:12:54.579817: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:12:54.580190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:12:54.580218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:12:54.580245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:12:54.580270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:12:54.580295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:12:54.580320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:12:54.580348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:12:54.580375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:12:54.580401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:12:54.581071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:12:54.581100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:12:54.581112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:12:54.581120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:12:54.581819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 4 3 0] pred: [1.8074883e-04 1.2276244e-03 9.9651790e-01 2.7974386e-04 1.0845523e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 4 3 0] pred: [5.0488883e-04 2.3333803e-03 9.8452985e-01 8.3454815e-04 2.2896260e-03]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 3 0] pred: [1.8491603e-04 1.2466327e-03 9.9654049e-01 2.8459908e-04 1.0986766e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 4 3 0] pred: [2.1014400e-04 1.3643476e-03 9.9547040e-01 3.2967306e-04 1.1630661e-03]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 4 3 0] pred: [1.8157886e-04 1.2309438e-03 9.9663216e-01 2.8217043e-04 1.0858022e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 3 0] pred: [1.8013635e-04 1.2257716e-03 9.9668735e-01 2.7998479e-04 1.0850959e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 3 0] pred: [1.7852306e-04 1.2217171e-03 9.9674463e-01 2.7798090e-04 1.0858472e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 3 0] pred: [1.9777476e-04 1.3134092e-03 9.9628192e-01 3.0718348e-04 1.1669914e-03]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 3 0] pred: [2.5686561e-04 1.5982417e-03 9.9329412e-01 4.3030453e-04 1.3909771e-03]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 4 3 0] pred: [1.8459524e-04 1.2443495e-03 9.9651492e-01 2.8721750e-04 1.0900939e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 4 3 0] pred: [1.7975939e-04 1.2194994e-03 9.9665701e-01 2.7814417e-04 1.0825420e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 3 0] pred: [1.7871756e-04 1.2216718e-03 9.9673766e-01 2.7813038e-04 1.0852416e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 3 0] pred: [2.0200787e-04 1.3273680e-03 9.9580115e-01 3.1326950e-04 1.1511002e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 3 0] pred: [1.7936577e-04 1.2232297e-03 9.9671656e-01 2.7892838e-04 1.0850711e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 4 1 3 0] pred: [0.1131293  0.13751982 0.66332537 0.12077722 0.15650572]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:28 - loss: 2.4994 - accuracy: 0.1875 3/11 [=======>......................] - ETA: 0s - loss: 2.4949 - accuracy: 0.2786   5/11 [============>.................] - ETA: 0s - loss: 2.4905 - accuracy: 0.3238 7/11 [==================>...........] - ETA: 0s - loss: 2.4859 - accuracy: 0.3488 9/11 [=======================>......] - ETA: 0s - loss: 2.4811 - accuracy: 0.368611/11 [==============================] - ETA: 0s - loss: 2.4761 - accuracy: 0.383111/11 [==============================] - 15s 28ms/step - loss: 2.4741 - accuracy: 0.3885
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3817 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 2.3707 - accuracy: 0.4896 5/11 [============>.................] - ETA: 0s - loss: 2.3614 - accuracy: 0.4802 7/11 [==================>...........] - ETA: 0s - loss: 2.3507 - accuracy: 0.4758 9/11 [=======================>......] - ETA: 0s - loss: 2.3387 - accuracy: 0.474711/11 [==============================] - ETA: 0s - loss: 2.3260 - accuracy: 0.474411/11 [==============================] - 0s 27ms/step - loss: 2.3207 - accuracy: 0.4744
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 2.0271 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 1.9948 - accuracy: 0.4809 5/11 [============>.................] - ETA: 0s - loss: 1.9616 - accuracy: 0.4857 7/11 [==================>...........] - ETA: 0s - loss: 1.9266 - accuracy: 0.4850 9/11 [=======================>......] - ETA: 0s - loss: 1.8914 - accuracy: 0.482011/11 [==============================] - ETA: 0s - loss: 1.8555 - accuracy: 0.480611/11 [==============================] - 0s 27ms/step - loss: 1.8409 - accuracy: 0.4800
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.2869 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 1.2415 - accuracy: 0.4609 5/11 [============>.................] - ETA: 0s - loss: 1.2136 - accuracy: 0.4591 7/11 [==================>...........] - ETA: 0s - loss: 1.1888 - accuracy: 0.4608 9/11 [=======================>......] - ETA: 0s - loss: 1.1645 - accuracy: 0.464811/11 [==============================] - ETA: 0s - loss: 1.1479 - accuracy: 0.466411/11 [==============================] - 0s 29ms/step - loss: 1.1414 - accuracy: 0.4670
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 1.0009 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.9501 - accuracy: 0.4647 6/11 [===============>..............] - ETA: 0s - loss: 0.9430 - accuracy: 0.4609 8/11 [====================>.........] - ETA: 0s - loss: 0.9367 - accuracy: 0.461210/11 [==========================>...] - ETA: 0s - loss: 0.9323 - accuracy: 0.461811/11 [==============================] - 0s 27ms/step - loss: 0.9270 - accuracy: 0.4637
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9786 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.9126 - accuracy: 0.4453 6/11 [===============>..............] - ETA: 0s - loss: 0.8753 - accuracy: 0.4641 8/11 [====================>.........] - ETA: 0s - loss: 0.8637 - accuracy: 0.469511/11 [==============================] - ETA: 0s - loss: 0.8607 - accuracy: 0.471011/11 [==============================] - 0s 27ms/step - loss: 0.8601 - accuracy: 0.4712
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8305 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.8402 - accuracy: 0.4787 5/11 [============>.................] - ETA: 0s - loss: 0.8446 - accuracy: 0.4756 8/11 [====================>.........] - ETA: 0s - loss: 0.8421 - accuracy: 0.475010/11 [==========================>...] - ETA: 0s - loss: 0.8405 - accuracy: 0.475211/11 [==============================] - 0s 27ms/step - loss: 0.8396 - accuracy: 0.4749
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8946 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8829 - accuracy: 0.4562 5/11 [============>.................] - ETA: 0s - loss: 0.8813 - accuracy: 0.4512 7/11 [==================>...........] - ETA: 0s - loss: 0.8719 - accuracy: 0.4526 9/11 [=======================>......] - ETA: 0s - loss: 0.8655 - accuracy: 0.455411/11 [==============================] - 0s 27ms/step - loss: 0.8563 - accuracy: 0.4598
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9236 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8752 - accuracy: 0.4510 5/11 [============>.................] - ETA: 0s - loss: 0.8558 - accuracy: 0.4611 7/11 [==================>...........] - ETA: 0s - loss: 0.8477 - accuracy: 0.4663 9/11 [=======================>......] - ETA: 0s - loss: 0.8432 - accuracy: 0.467911/11 [==============================] - 0s 27ms/step - loss: 0.8380 - accuracy: 0.4695
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8753 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8615 - accuracy: 0.4497 5/11 [============>.................] - ETA: 0s - loss: 0.8564 - accuracy: 0.4517 7/11 [==================>...........] - ETA: 0s - loss: 0.8485 - accuracy: 0.4543 9/11 [=======================>......] - ETA: 0s - loss: 0.8448 - accuracy: 0.456111/11 [==============================] - ETA: 0s - loss: 0.8398 - accuracy: 0.459511/11 [==============================] - 0s 28ms/step - loss: 0.8380 - accuracy: 0.4606
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6582 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.7313 - accuracy: 0.5126 6/11 [===============>..............] - ETA: 0s - loss: 0.7634 - accuracy: 0.4954 8/11 [====================>.........] - ETA: 0s - loss: 0.7732 - accuracy: 0.492010/11 [==========================>...] - ETA: 0s - loss: 0.7802 - accuracy: 0.489311/11 [==============================] - 0s 27ms/step - loss: 0.7863 - accuracy: 0.4867
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8433 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8661 - accuracy: 0.4457 5/11 [============>.................] - ETA: 0s - loss: 0.8527 - accuracy: 0.4571 8/11 [====================>.........] - ETA: 0s - loss: 0.8406 - accuracy: 0.461610/11 [==========================>...] - ETA: 0s - loss: 0.8344 - accuracy: 0.464511/11 [==============================] - 0s 27ms/step - loss: 0.8311 - accuracy: 0.4661
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6875 - accuracy: 0.5625 4/11 [=========>....................] - ETA: 0s - loss: 0.7606 - accuracy: 0.5081 6/11 [===============>..............] - ETA: 0s - loss: 0.7797 - accuracy: 0.4918 8/11 [====================>.........] - ETA: 0s - loss: 0.7846 - accuracy: 0.486910/11 [==========================>...] - ETA: 0s - loss: 0.7898 - accuracy: 0.484111/11 [==============================] - 0s 27ms/step - loss: 0.7937 - accuracy: 0.4824
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7931 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 0s - loss: 0.8509 - accuracy: 0.4598 6/11 [===============>..............] - ETA: 0s - loss: 0.8494 - accuracy: 0.4572 8/11 [====================>.........] - ETA: 0s - loss: 0.8460 - accuracy: 0.457310/11 [==========================>...] - ETA: 0s - loss: 0.8408 - accuracy: 0.459211/11 [==============================] - 0s 27ms/step - loss: 0.8360 - accuracy: 0.4616
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7502 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.7605 - accuracy: 0.5035 5/11 [============>.................] - ETA: 0s - loss: 0.7608 - accuracy: 0.4997 7/11 [==================>...........] - ETA: 0s - loss: 0.7667 - accuracy: 0.4960 9/11 [=======================>......] - ETA: 0s - loss: 0.7710 - accuracy: 0.493311/11 [==============================] - 0s 27ms/step - loss: 0.7803 - accuracy: 0.4885
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8644 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.8170 - accuracy: 0.4788 6/11 [===============>..............] - ETA: 0s - loss: 0.8069 - accuracy: 0.4846 8/11 [====================>.........] - ETA: 0s - loss: 0.8033 - accuracy: 0.485910/11 [==========================>...] - ETA: 0s - loss: 0.8037 - accuracy: 0.484511/11 [==============================] - 0s 27ms/step - loss: 0.8046 - accuracy: 0.4827
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8851 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.8765 - accuracy: 0.4288 5/11 [============>.................] - ETA: 0s - loss: 0.8639 - accuracy: 0.4370 7/11 [==================>...........] - ETA: 0s - loss: 0.8529 - accuracy: 0.4431 9/11 [=======================>......] - ETA: 0s - loss: 0.8456 - accuracy: 0.447711/11 [==============================] - ETA: 0s - loss: 0.8389 - accuracy: 0.452311/11 [==============================] - 0s 27ms/step - loss: 0.8363 - accuracy: 0.4541
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7599 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.7627 - accuracy: 0.4761 5/11 [============>.................] - ETA: 0s - loss: 0.7603 - accuracy: 0.4860 7/11 [==================>...........] - ETA: 0s - loss: 0.7671 - accuracy: 0.4869 9/11 [=======================>......] - ETA: 0s - loss: 0.7745 - accuracy: 0.485011/11 [==============================] - ETA: 0s - loss: 0.7800 - accuracy: 0.483211/11 [==============================] - 0s 28ms/step - loss: 0.7822 - accuracy: 0.4824
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7913 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.7802 - accuracy: 0.4735 5/11 [============>.................] - ETA: 0s - loss: 0.7852 - accuracy: 0.4717 7/11 [==================>...........] - ETA: 0s - loss: 0.7861 - accuracy: 0.4725 9/11 [=======================>......] - ETA: 0s - loss: 0.7876 - accuracy: 0.474611/11 [==============================] - 0s 28ms/step - loss: 0.7913 - accuracy: 0.4750
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7262 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.7840 - accuracy: 0.4813 6/11 [===============>..............] - ETA: 0s - loss: 0.8015 - accuracy: 0.4728 8/11 [====================>.........] - ETA: 0s - loss: 0.8027 - accuracy: 0.472110/11 [==========================>...] - ETA: 0s - loss: 0.8023 - accuracy: 0.473011/11 [==============================] - 0s 28ms/step - loss: 0.8018 - accuracy: 0.4736
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.8491 - accuracy: 0.42976/6 [==============================] - ETA: 0s - loss: 0.8868 - accuracy: 0.4334 6/6 [==============================] - 5s 11ms/step - loss: 0.8868 - accuracy: 0.4334
2021-12-14 00:13:30.930293: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:13:30.931111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:13:30.931183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:13:30.931240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:13:30.931283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:13:30.931324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:13:30.931365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:13:30.931406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:13:30.931447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:13:30.931490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:13:30.932398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:13:30.932450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:13:30.932467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:13:30.932480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:13:30.933477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:13:30.933961: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:13:30.934447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:13:30.934485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:13:30.934522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:13:30.934558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:13:30.934592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:13:30.934628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:13:30.934663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:13:30.934698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:13:30.934733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:13:30.935621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:13:30.935660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:13:30.935677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:13:30.935689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:13:30.936635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [8.7486109e-04 2.1642374e-03 9.9654043e-01 4.5444196e-04 4.0559372e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [8.6819357e-04 2.1393064e-03 9.9681550e-01 4.4240776e-04 3.8955486e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [9.1542967e-04 2.3989482e-03 9.9670815e-01 4.6602395e-04 3.8838328e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [8.6743978e-04 2.1441183e-03 9.9683529e-01 4.4277566e-04 3.8706284e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [9.0498128e-04 2.3538431e-03 9.9678743e-01 4.6342186e-04 3.8255315e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 3 4] pred: [8.7292754e-04 2.1735777e-03 9.9680519e-01 4.4505866e-04 3.8597934e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [0.00224756 0.00390339 0.9826471  0.00153052 0.00196254]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [9.2216121e-04 2.3678637e-03 9.9665183e-01 4.6415644e-04 3.8524778e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 3 4] pred: [8.6743652e-04 2.1414908e-03 9.9682659e-01 4.4254150e-04 3.8859920e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [8.6972659e-04 2.1443937e-03 9.9679440e-01 4.4305879e-04 3.9171681e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [9.1060769e-04 2.3729468e-03 9.9673504e-01 4.6416259e-04 3.8727731e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [8.7240327e-04 2.1727951e-03 9.9681598e-01 4.4574245e-04 3.8622576e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [8.7425357e-04 2.1735025e-03 9.9673945e-01 4.4674374e-04 3.8778063e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 0 3] pred: [7.8800833e-04 1.9561846e-03 9.9003232e-01 6.0372695e-04 8.7175932e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [1.7323013e-03 4.5705265e-03 9.9237281e-01 9.4251370e-04 8.6008158e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:28 - loss: 2.4971 - accuracy: 0.3672 3/11 [=======>......................] - ETA: 0s - loss: 2.4925 - accuracy: 0.3950   5/11 [============>.................] - ETA: 0s - loss: 2.4877 - accuracy: 0.4061 7/11 [==================>...........] - ETA: 0s - loss: 2.4827 - accuracy: 0.416610/11 [==========================>...] - ETA: 0s - loss: 2.4747 - accuracy: 0.426511/11 [==============================] - 15s 27ms/step - loss: 2.4699 - accuracy: 0.4307
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3569 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 2.3490 - accuracy: 0.4735 5/11 [============>.................] - ETA: 0s - loss: 2.3389 - accuracy: 0.4733 8/11 [====================>.........] - ETA: 0s - loss: 2.3207 - accuracy: 0.468410/11 [==========================>...] - ETA: 0s - loss: 2.3055 - accuracy: 0.467011/11 [==============================] - 0s 28ms/step - loss: 2.2913 - accuracy: 0.4663
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 1.9178 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 1.8907 - accuracy: 0.4414 5/11 [============>.................] - ETA: 0s - loss: 1.8518 - accuracy: 0.4487 7/11 [==================>...........] - ETA: 0s - loss: 1.8106 - accuracy: 0.4534 9/11 [=======================>......] - ETA: 0s - loss: 1.7721 - accuracy: 0.454411/11 [==============================] - 0s 28ms/step - loss: 1.7180 - accuracy: 0.4562
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.0927 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 1.0682 - accuracy: 0.4779 7/11 [==================>...........] - ETA: 0s - loss: 1.0484 - accuracy: 0.4767 9/11 [=======================>......] - ETA: 0s - loss: 1.0354 - accuracy: 0.477311/11 [==============================] - ETA: 0s - loss: 1.0291 - accuracy: 0.475411/11 [==============================] - 0s 28ms/step - loss: 1.0270 - accuracy: 0.4743
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9080 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.8788 - accuracy: 0.4896 5/11 [============>.................] - ETA: 0s - loss: 0.8743 - accuracy: 0.4865 7/11 [==================>...........] - ETA: 0s - loss: 0.8790 - accuracy: 0.4811 9/11 [=======================>......] - ETA: 0s - loss: 0.8823 - accuracy: 0.477411/11 [==============================] - ETA: 0s - loss: 0.8841 - accuracy: 0.474211/11 [==============================] - 0s 29ms/step - loss: 0.8844 - accuracy: 0.4732
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9145 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.9121 - accuracy: 0.4497 5/11 [============>.................] - ETA: 0s - loss: 0.8954 - accuracy: 0.4516 7/11 [==================>...........] - ETA: 0s - loss: 0.8851 - accuracy: 0.4544 9/11 [=======================>......] - ETA: 0s - loss: 0.8780 - accuracy: 0.456411/11 [==============================] - ETA: 0s - loss: 0.8746 - accuracy: 0.457511/11 [==============================] - 0s 27ms/step - loss: 0.8732 - accuracy: 0.4579
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7788 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.8137 - accuracy: 0.4918 5/11 [============>.................] - ETA: 0s - loss: 0.8203 - accuracy: 0.4834 7/11 [==================>...........] - ETA: 0s - loss: 0.8331 - accuracy: 0.4741 9/11 [=======================>......] - ETA: 0s - loss: 0.8359 - accuracy: 0.471711/11 [==============================] - ETA: 0s - loss: 0.8381 - accuracy: 0.470111/11 [==============================] - 0s 28ms/step - loss: 0.8389 - accuracy: 0.4695
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8343 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8763 - accuracy: 0.4501 6/11 [===============>..............] - ETA: 0s - loss: 0.8834 - accuracy: 0.4414 8/11 [====================>.........] - ETA: 0s - loss: 0.8798 - accuracy: 0.443010/11 [==========================>...] - ETA: 0s - loss: 0.8729 - accuracy: 0.446511/11 [==============================] - 0s 27ms/step - loss: 0.8679 - accuracy: 0.4492
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6355 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.7222 - accuracy: 0.5009 5/11 [============>.................] - ETA: 0s - loss: 0.7484 - accuracy: 0.4940 7/11 [==================>...........] - ETA: 0s - loss: 0.7647 - accuracy: 0.488610/11 [==========================>...] - ETA: 0s - loss: 0.7849 - accuracy: 0.481911/11 [==============================] - 0s 28ms/step - loss: 0.7941 - accuracy: 0.4787
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8704 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.8793 - accuracy: 0.4482 6/11 [===============>..............] - ETA: 0s - loss: 0.8816 - accuracy: 0.4451 8/11 [====================>.........] - ETA: 0s - loss: 0.8804 - accuracy: 0.445310/11 [==========================>...] - ETA: 0s - loss: 0.8760 - accuracy: 0.446711/11 [==============================] - 0s 28ms/step - loss: 0.8697 - accuracy: 0.4494
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9528 - accuracy: 0.3828 3/11 [=======>......................] - ETA: 0s - loss: 0.8793 - accuracy: 0.4366 6/11 [===============>..............] - ETA: 0s - loss: 0.8573 - accuracy: 0.4515 8/11 [====================>.........] - ETA: 0s - loss: 0.8536 - accuracy: 0.453710/11 [==========================>...] - ETA: 0s - loss: 0.8522 - accuracy: 0.454611/11 [==============================] - 0s 28ms/step - loss: 0.8497 - accuracy: 0.4560
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8426 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.8287 - accuracy: 0.4704 6/11 [===============>..............] - ETA: 0s - loss: 0.8257 - accuracy: 0.4719 8/11 [====================>.........] - ETA: 0s - loss: 0.8289 - accuracy: 0.470410/11 [==========================>...] - ETA: 0s - loss: 0.8314 - accuracy: 0.468411/11 [==============================] - 0s 28ms/step - loss: 0.8321 - accuracy: 0.4674
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9112 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.8981 - accuracy: 0.4297 5/11 [============>.................] - ETA: 0s - loss: 0.8793 - accuracy: 0.4404 7/11 [==================>...........] - ETA: 0s - loss: 0.8687 - accuracy: 0.4458 9/11 [=======================>......] - ETA: 0s - loss: 0.8590 - accuracy: 0.451411/11 [==============================] - ETA: 0s - loss: 0.8538 - accuracy: 0.453811/11 [==============================] - 0s 28ms/step - loss: 0.8522 - accuracy: 0.4546
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9354 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.9154 - accuracy: 0.4089 5/11 [============>.................] - ETA: 0s - loss: 0.8998 - accuracy: 0.4180 7/11 [==================>...........] - ETA: 0s - loss: 0.8834 - accuracy: 0.428110/11 [==========================>...] - ETA: 0s - loss: 0.8690 - accuracy: 0.437911/11 [==============================] - 0s 29ms/step - loss: 0.8632 - accuracy: 0.4420
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8407 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.8055 - accuracy: 0.4774 6/11 [===============>..............] - ETA: 0s - loss: 0.8107 - accuracy: 0.4760 8/11 [====================>.........] - ETA: 0s - loss: 0.8133 - accuracy: 0.474410/11 [==========================>...] - ETA: 0s - loss: 0.8172 - accuracy: 0.472711/11 [==============================] - 0s 28ms/step - loss: 0.8199 - accuracy: 0.4711
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8682 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8640 - accuracy: 0.4492 5/11 [============>.................] - ETA: 0s - loss: 0.8520 - accuracy: 0.4555 7/11 [==================>...........] - ETA: 0s - loss: 0.8469 - accuracy: 0.4582 9/11 [=======================>......] - ETA: 0s - loss: 0.8446 - accuracy: 0.457511/11 [==============================] - 0s 28ms/step - loss: 0.8417 - accuracy: 0.4587
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7803 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.8052 - accuracy: 0.4683 5/11 [============>.................] - ETA: 0s - loss: 0.8135 - accuracy: 0.4658 7/11 [==================>...........] - ETA: 0s - loss: 0.8205 - accuracy: 0.4633 9/11 [=======================>......] - ETA: 0s - loss: 0.8232 - accuracy: 0.463411/11 [==============================] - 0s 28ms/step - loss: 0.8260 - accuracy: 0.4632
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9015 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.8638 - accuracy: 0.4392 5/11 [============>.................] - ETA: 0s - loss: 0.8591 - accuracy: 0.4470 7/11 [==================>...........] - ETA: 0s - loss: 0.8540 - accuracy: 0.4508 9/11 [=======================>......] - ETA: 0s - loss: 0.8505 - accuracy: 0.452111/11 [==============================] - 0s 28ms/step - loss: 0.8459 - accuracy: 0.4547
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8001 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.8299 - accuracy: 0.4592 5/11 [============>.................] - ETA: 0s - loss: 0.8350 - accuracy: 0.4607 7/11 [==================>...........] - ETA: 0s - loss: 0.8366 - accuracy: 0.4617 9/11 [=======================>......] - ETA: 0s - loss: 0.8355 - accuracy: 0.462211/11 [==============================] - 0s 27ms/step - loss: 0.8341 - accuracy: 0.4626
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8774 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.8613 - accuracy: 0.4510 5/11 [============>.................] - ETA: 0s - loss: 0.8477 - accuracy: 0.4541 8/11 [====================>.........] - ETA: 0s - loss: 0.8390 - accuracy: 0.457810/11 [==========================>...] - ETA: 0s - loss: 0.8375 - accuracy: 0.458611/11 [==============================] - 0s 27ms/step - loss: 0.8364 - accuracy: 0.4593
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.8400 - accuracy: 0.46886/6 [==============================] - ETA: 0s - loss: 0.8589 - accuracy: 0.4504 6/6 [==============================] - 5s 11ms/step - loss: 0.8589 - accuracy: 0.4504
2021-12-14 00:14:07.644218: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:14:07.645207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:14:07.645292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:14:07.645367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:14:07.645521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:14:07.645580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:14:07.645633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:14:07.645765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:14:07.645825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:14:07.645959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:14:07.646946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:14:07.647007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:14:07.647027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:14:07.647040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:14:07.648192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:14:07.648690: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:14:07.649607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:14:07.649645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:14:07.649683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:14:07.649720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:14:07.649755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:14:07.649790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:14:07.649949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:14:07.649989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:14:07.650134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:14:07.651179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:14:07.651219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:14:07.651235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:14:07.651248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:14:07.652253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 1 3 4] pred: [8.4399630e-04 8.0595113e-04 9.9728441e-01 4.5289053e-04 3.2912506e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 0 1 3 4] pred: [8.1975589e-04 7.7386526e-04 9.9745315e-01 4.3942843e-04 3.2106013e-04]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 2 ============
pred sorted: [2 0 1 3 4] pred: [0.00297216 0.00265987 0.9899587  0.00157745 0.00110576]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [2 0 1 3 4] pred: [8.1093848e-04 7.6807337e-04 9.9751544e-01 4.3480995e-04 3.2034560e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 0 1 3 4] pred: [8.1340427e-04 7.6863531e-04 9.9749559e-01 4.3697751e-04 3.2107453e-04]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 0 1 3 4] pred: [8.1154879e-04 7.6905766e-04 9.9751544e-01 4.3512671e-04 3.2071568e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 0 1 3 4] pred: [8.1571995e-04 7.7100191e-04 9.9747783e-01 4.3679861e-04 3.2012456e-04]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 7 ============
pred sorted: [2 0 1 3 4] pred: [8.2450098e-04 7.8849390e-04 9.9738222e-01 4.4466663e-04 3.2687050e-04]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 8 ============
pred sorted: [2 0 1 3 4] pred: [8.3924312e-04 7.9698086e-04 9.9733281e-01 4.4950179e-04 3.2891083e-04]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 9 ============
pred sorted: [2 0 1 3 4] pred: [8.1298576e-04 7.6522992e-04 9.9748969e-01 4.3316957e-04 3.1787375e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 0 1 3 4] pred: [8.1478816e-04 7.7591586e-04 9.9742776e-01 4.3671427e-04 3.2024513e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 0 1 3 4] pred: [8.3651394e-04 7.8770419e-04 9.9738580e-01 4.4835662e-04 3.2645944e-04]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 12 ============
pred sorted: [2 0 1 3 4] pred: [8.1561157e-04 7.7574205e-04 9.9741626e-01 4.3736194e-04 3.2007971e-04]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 13 ============
pred sorted: [2 0 1 3 4] pred: [0.05452934 0.04363477 0.8830401  0.03854913 0.03012581]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 0 1 3 4] pred: [8.1126037e-04 7.6846540e-04 9.9750745e-01 4.3460957e-04 3.1984484e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:27 - loss: 2.4975 - accuracy: 0.3047 3/11 [=======>......................] - ETA: 0s - loss: 2.4920 - accuracy: 0.3555   5/11 [============>.................] - ETA: 0s - loss: 2.4867 - accuracy: 0.3796 7/11 [==================>...........] - ETA: 0s - loss: 2.4812 - accuracy: 0.3934 9/11 [=======================>......] - ETA: 0s - loss: 2.4756 - accuracy: 0.402611/11 [==============================] - 15s 27ms/step - loss: 2.4675 - accuracy: 0.4123
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3545 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 2.3441 - accuracy: 0.4518 5/11 [============>.................] - ETA: 0s - loss: 2.3350 - accuracy: 0.4523 8/11 [====================>.........] - ETA: 0s - loss: 2.3186 - accuracy: 0.454610/11 [==========================>...] - ETA: 0s - loss: 2.3052 - accuracy: 0.454311/11 [==============================] - 0s 25ms/step - loss: 2.2921 - accuracy: 0.4541
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 1.9793 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 1.9298 - accuracy: 0.4281 6/11 [===============>..............] - ETA: 0s - loss: 1.8913 - accuracy: 0.4328 8/11 [====================>.........] - ETA: 0s - loss: 1.8511 - accuracy: 0.435611/11 [==============================] - ETA: 0s - loss: 1.7910 - accuracy: 0.439711/11 [==============================] - 0s 27ms/step - loss: 1.7748 - accuracy: 0.4408
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.2129 - accuracy: 0.4062 4/11 [=========>....................] - ETA: 0s - loss: 1.1386 - accuracy: 0.4419 6/11 [===============>..............] - ETA: 0s - loss: 1.1082 - accuracy: 0.4513 8/11 [====================>.........] - ETA: 0s - loss: 1.0857 - accuracy: 0.455610/11 [==========================>...] - ETA: 0s - loss: 1.0725 - accuracy: 0.455511/11 [==============================] - 0s 26ms/step - loss: 1.0627 - accuracy: 0.4551
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9984 - accuracy: 0.3750 3/11 [=======>......................] - ETA: 0s - loss: 0.9491 - accuracy: 0.4089 6/11 [===============>..............] - ETA: 0s - loss: 0.9221 - accuracy: 0.4268 8/11 [====================>.........] - ETA: 0s - loss: 0.9120 - accuracy: 0.434110/11 [==========================>...] - ETA: 0s - loss: 0.9081 - accuracy: 0.438211/11 [==============================] - 0s 26ms/step - loss: 0.9061 - accuracy: 0.4407
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8318 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.8951 - accuracy: 0.4375 7/11 [==================>...........] - ETA: 0s - loss: 0.8989 - accuracy: 0.4346 9/11 [=======================>......] - ETA: 0s - loss: 0.8977 - accuracy: 0.435611/11 [==============================] - 0s 26ms/step - loss: 0.8912 - accuracy: 0.4398
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8691 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8613 - accuracy: 0.4497 5/11 [============>.................] - ETA: 0s - loss: 0.8607 - accuracy: 0.4532 7/11 [==================>...........] - ETA: 0s - loss: 0.8648 - accuracy: 0.452110/11 [==========================>...] - ETA: 0s - loss: 0.8674 - accuracy: 0.451911/11 [==============================] - 0s 27ms/step - loss: 0.8667 - accuracy: 0.4521
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8717 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.8838 - accuracy: 0.4327 6/11 [===============>..............] - ETA: 0s - loss: 0.8775 - accuracy: 0.4396 8/11 [====================>.........] - ETA: 0s - loss: 0.8763 - accuracy: 0.440810/11 [==========================>...] - ETA: 0s - loss: 0.8748 - accuracy: 0.442111/11 [==============================] - 0s 27ms/step - loss: 0.8722 - accuracy: 0.4439
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8371 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.8525 - accuracy: 0.4709 5/11 [============>.................] - ETA: 0s - loss: 0.8555 - accuracy: 0.4663 8/11 [====================>.........] - ETA: 0s - loss: 0.8586 - accuracy: 0.460110/11 [==========================>...] - ETA: 0s - loss: 0.8594 - accuracy: 0.458111/11 [==============================] - 0s 26ms/step - loss: 0.8590 - accuracy: 0.4573
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8970 - accuracy: 0.3828 4/11 [=========>....................] - ETA: 0s - loss: 0.8881 - accuracy: 0.4186 7/11 [==================>...........] - ETA: 0s - loss: 0.8720 - accuracy: 0.4319 9/11 [=======================>......] - ETA: 0s - loss: 0.8652 - accuracy: 0.438311/11 [==============================] - 0s 26ms/step - loss: 0.8623 - accuracy: 0.4423
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8354 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.8430 - accuracy: 0.4648 6/11 [===============>..............] - ETA: 0s - loss: 0.8421 - accuracy: 0.4626 8/11 [====================>.........] - ETA: 0s - loss: 0.8441 - accuracy: 0.459610/11 [==========================>...] - ETA: 0s - loss: 0.8455 - accuracy: 0.458611/11 [==============================] - 0s 25ms/step - loss: 0.8470 - accuracy: 0.4577
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6742 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.7337 - accuracy: 0.5161 6/11 [===============>..............] - ETA: 0s - loss: 0.7795 - accuracy: 0.4936 8/11 [====================>.........] - ETA: 0s - loss: 0.7967 - accuracy: 0.483710/11 [==========================>...] - ETA: 0s - loss: 0.8085 - accuracy: 0.477211/11 [==============================] - 0s 26ms/step - loss: 0.8159 - accuracy: 0.4732
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9264 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.8853 - accuracy: 0.4314 6/11 [===============>..............] - ETA: 0s - loss: 0.8698 - accuracy: 0.4434 8/11 [====================>.........] - ETA: 0s - loss: 0.8683 - accuracy: 0.443611/11 [==============================] - ETA: 0s - loss: 0.8632 - accuracy: 0.446811/11 [==============================] - 0s 27ms/step - loss: 0.8623 - accuracy: 0.4473
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 1.0010 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.9609 - accuracy: 0.4171 5/11 [============>.................] - ETA: 0s - loss: 0.9318 - accuracy: 0.4251 7/11 [==================>...........] - ETA: 0s - loss: 0.9148 - accuracy: 0.4311 9/11 [=======================>......] - ETA: 0s - loss: 0.9031 - accuracy: 0.435511/11 [==============================] - ETA: 0s - loss: 0.8943 - accuracy: 0.438411/11 [==============================] - 0s 27ms/step - loss: 0.8907 - accuracy: 0.4397
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8575 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.8391 - accuracy: 0.4476 7/11 [==================>...........] - ETA: 0s - loss: 0.8451 - accuracy: 0.4453 9/11 [=======================>......] - ETA: 0s - loss: 0.8484 - accuracy: 0.445211/11 [==============================] - ETA: 0s - loss: 0.8495 - accuracy: 0.446311/11 [==============================] - 0s 27ms/step - loss: 0.8497 - accuracy: 0.4469
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8766 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8845 - accuracy: 0.4366 5/11 [============>.................] - ETA: 0s - loss: 0.8792 - accuracy: 0.4365 7/11 [==================>...........] - ETA: 0s - loss: 0.8745 - accuracy: 0.437210/11 [==========================>...] - ETA: 0s - loss: 0.8688 - accuracy: 0.439711/11 [==============================] - 0s 26ms/step - loss: 0.8658 - accuracy: 0.4419
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8245 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.8492 - accuracy: 0.4488 5/11 [============>.................] - ETA: 0s - loss: 0.8497 - accuracy: 0.4473 7/11 [==================>...........] - ETA: 0s - loss: 0.8511 - accuracy: 0.4471 9/11 [=======================>......] - ETA: 0s - loss: 0.8527 - accuracy: 0.446611/11 [==============================] - 0s 27ms/step - loss: 0.8518 - accuracy: 0.4484
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7143 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.7773 - accuracy: 0.4744 5/11 [============>.................] - ETA: 0s - loss: 0.8060 - accuracy: 0.4636 8/11 [====================>.........] - ETA: 0s - loss: 0.8175 - accuracy: 0.461010/11 [==========================>...] - ETA: 0s - loss: 0.8244 - accuracy: 0.459111/11 [==============================] - 0s 27ms/step - loss: 0.8286 - accuracy: 0.4581
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8383 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8537 - accuracy: 0.4531 5/11 [============>.................] - ETA: 0s - loss: 0.8555 - accuracy: 0.4510 7/11 [==================>...........] - ETA: 0s - loss: 0.8528 - accuracy: 0.4521 9/11 [=======================>......] - ETA: 0s - loss: 0.8530 - accuracy: 0.451511/11 [==============================] - 0s 27ms/step - loss: 0.8524 - accuracy: 0.4518
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 1.0060 - accuracy: 0.3828 3/11 [=======>......................] - ETA: 0s - loss: 0.9387 - accuracy: 0.4167 5/11 [============>.................] - ETA: 0s - loss: 0.9023 - accuracy: 0.4280 7/11 [==================>...........] - ETA: 0s - loss: 0.8893 - accuracy: 0.4342 9/11 [=======================>......] - ETA: 0s - loss: 0.8799 - accuracy: 0.438311/11 [==============================] - ETA: 0s - loss: 0.8749 - accuracy: 0.440611/11 [==============================] - 0s 28ms/step - loss: 0.8728 - accuracy: 0.4416
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.9489 - accuracy: 0.42976/6 [==============================] - ETA: 0s - loss: 0.8224 - accuracy: 0.4688 6/6 [==============================] - 5s 11ms/step - loss: 0.8224 - accuracy: 0.4688
2021-12-14 00:14:43.675153: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:14:43.676389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:14:43.676467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:14:43.676529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:14:43.676572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:14:43.676619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:14:43.676668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:14:43.676715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:14:43.676758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:14:43.676805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:14:43.677758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:14:43.677818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:14:43.677835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:14:43.677849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:14:43.678883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:14:43.679384: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:14:43.679902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:14:43.679952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:14:43.679992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:14:43.680030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:14:43.680066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:14:43.680102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:14:43.680142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:14:43.680179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:14:43.680216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:14:43.681177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:14:43.681218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:14:43.681236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:14:43.681249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:14:43.682256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 0 4] pred: [3.1059986e-04 5.4544868e-04 9.9771190e-01 5.6144263e-04 2.0099479e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 1 0 4] pred: [3.3298880e-04 5.6533900e-04 9.9753100e-01 5.8348314e-04 2.1394588e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 0 4] pred: [3.1148977e-04 5.4689433e-04 9.9772531e-01 5.6669093e-04 2.0152307e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [3.5625196e-04 6.0389552e-04 9.9746943e-01 5.9899472e-04 2.2616467e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [0.00385124 0.00474361 0.9831881  0.00436082 0.00274915]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 0 4] pred: [3.1054419e-04 5.4623873e-04 9.9773067e-01 5.6583685e-04 2.0074254e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 0 4] pred: [3.1071802e-04 5.4624310e-04 9.9772960e-01 5.6584494e-04 2.0088021e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 0 4] pred: [3.1234624e-04 5.4751738e-04 9.9772042e-01 5.6683115e-04 2.0208204e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 1 0 4] pred: [3.1131640e-04 5.4647308e-04 9.9770725e-01 5.6252250e-04 2.0156459e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 0 4] pred: [3.1305038e-04 5.4800732e-04 9.9771655e-01 5.6675822e-04 2.0247530e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 0 4] pred: [3.1049977e-04 5.4614240e-04 9.9773091e-01 5.6568690e-04 2.0069756e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 1 0 4] pred: [3.1193704e-04 5.4471509e-04 9.9766397e-01 5.6143029e-04 1.9968933e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 0 4] pred: [3.3015496e-04 5.6529621e-04 9.9759078e-01 5.8478507e-04 2.1512267e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 0 4] pred: [3.1151267e-04 5.4664287e-04 9.9772519e-01 5.6597707e-04 2.0145698e-04]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [3.5391957e-04 5.9459917e-04 9.9741131e-01 5.8745651e-04 2.2225102e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:28 - loss: 2.5058 - accuracy: 0.2812 3/11 [=======>......................] - ETA: 0s - loss: 2.5002 - accuracy: 0.3242   6/11 [===============>..............] - ETA: 0s - loss: 2.4916 - accuracy: 0.3596 8/11 [====================>.........] - ETA: 0s - loss: 2.4856 - accuracy: 0.374310/11 [==========================>...] - ETA: 0s - loss: 2.4794 - accuracy: 0.384711/11 [==============================] - 15s 27ms/step - loss: 2.4741 - accuracy: 0.3911
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 2.3470 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 2.3423 - accuracy: 0.4705 5/11 [============>.................] - ETA: 0s - loss: 2.3328 - accuracy: 0.4641 7/11 [==================>...........] - ETA: 0s - loss: 2.3207 - accuracy: 0.460310/11 [==========================>...] - ETA: 0s - loss: 2.2986 - accuracy: 0.457611/11 [==============================] - 0s 27ms/step - loss: 2.2845 - accuracy: 0.4572
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 1.9156 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 1.8758 - accuracy: 0.4987 5/11 [============>.................] - ETA: 0s - loss: 1.8466 - accuracy: 0.4796 8/11 [====================>.........] - ETA: 0s - loss: 1.7860 - accuracy: 0.469610/11 [==========================>...] - ETA: 0s - loss: 1.7439 - accuracy: 0.466011/11 [==============================] - 0s 28ms/step - loss: 1.7070 - accuracy: 0.4642
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 1.1028 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 1.0556 - accuracy: 0.4297 5/11 [============>.................] - ETA: 0s - loss: 1.0378 - accuracy: 0.4427 7/11 [==================>...........] - ETA: 0s - loss: 1.0245 - accuracy: 0.4486 9/11 [=======================>......] - ETA: 0s - loss: 1.0138 - accuracy: 0.451211/11 [==============================] - 0s 27ms/step - loss: 1.0027 - accuracy: 0.4524
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9357 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.9245 - accuracy: 0.4392 5/11 [============>.................] - ETA: 0s - loss: 0.9166 - accuracy: 0.4437 7/11 [==================>...........] - ETA: 0s - loss: 0.9119 - accuracy: 0.4445 9/11 [=======================>......] - ETA: 0s - loss: 0.9074 - accuracy: 0.445311/11 [==============================] - ETA: 0s - loss: 0.9023 - accuracy: 0.446811/11 [==============================] - 0s 28ms/step - loss: 0.9002 - accuracy: 0.4475
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9350 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.8913 - accuracy: 0.4592 5/11 [============>.................] - ETA: 0s - loss: 0.8806 - accuracy: 0.4616 7/11 [==================>...........] - ETA: 0s - loss: 0.8702 - accuracy: 0.4637 9/11 [=======================>......] - ETA: 0s - loss: 0.8659 - accuracy: 0.463111/11 [==============================] - 0s 26ms/step - loss: 0.8631 - accuracy: 0.4614
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8316 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.8243 - accuracy: 0.4440 5/11 [============>.................] - ETA: 0s - loss: 0.8209 - accuracy: 0.4534 7/11 [==================>...........] - ETA: 0s - loss: 0.8200 - accuracy: 0.4580 9/11 [=======================>......] - ETA: 0s - loss: 0.8239 - accuracy: 0.459011/11 [==============================] - ETA: 0s - loss: 0.8283 - accuracy: 0.458411/11 [==============================] - 0s 28ms/step - loss: 0.8300 - accuracy: 0.4582
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8309 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.8589 - accuracy: 0.4219 5/11 [============>.................] - ETA: 0s - loss: 0.8516 - accuracy: 0.4325 7/11 [==================>...........] - ETA: 0s - loss: 0.8468 - accuracy: 0.439910/11 [==========================>...] - ETA: 0s - loss: 0.8436 - accuracy: 0.445511/11 [==============================] - 0s 27ms/step - loss: 0.8439 - accuracy: 0.4471
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9210 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.8650 - accuracy: 0.4349 6/11 [===============>..............] - ETA: 0s - loss: 0.8591 - accuracy: 0.4440 8/11 [====================>.........] - ETA: 0s - loss: 0.8568 - accuracy: 0.445910/11 [==========================>...] - ETA: 0s - loss: 0.8543 - accuracy: 0.447511/11 [==============================] - 0s 28ms/step - loss: 0.8524 - accuracy: 0.4488
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7565 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.7937 - accuracy: 0.4670 5/11 [============>.................] - ETA: 0s - loss: 0.8139 - accuracy: 0.4602 7/11 [==================>...........] - ETA: 0s - loss: 0.8239 - accuracy: 0.4560 9/11 [=======================>......] - ETA: 0s - loss: 0.8320 - accuracy: 0.452711/11 [==============================] - 0s 27ms/step - loss: 0.8351 - accuracy: 0.4529
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9398 - accuracy: 0.3906 4/11 [=========>....................] - ETA: 0s - loss: 0.8853 - accuracy: 0.4232 6/11 [===============>..............] - ETA: 0s - loss: 0.8730 - accuracy: 0.4294 9/11 [=======================>......] - ETA: 0s - loss: 0.8666 - accuracy: 0.435111/11 [==============================] - ETA: 0s - loss: 0.8617 - accuracy: 0.439111/11 [==============================] - 0s 26ms/step - loss: 0.8600 - accuracy: 0.4405
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8117 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.8414 - accuracy: 0.4609 5/11 [============>.................] - ETA: 0s - loss: 0.8343 - accuracy: 0.4616 7/11 [==================>...........] - ETA: 0s - loss: 0.8369 - accuracy: 0.4596 9/11 [=======================>......] - ETA: 0s - loss: 0.8350 - accuracy: 0.459611/11 [==============================] - 0s 26ms/step - loss: 0.8359 - accuracy: 0.4585
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7774 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.7976 - accuracy: 0.4806 7/11 [==================>...........] - ETA: 0s - loss: 0.8146 - accuracy: 0.4693 9/11 [=======================>......] - ETA: 0s - loss: 0.8166 - accuracy: 0.468011/11 [==============================] - ETA: 0s - loss: 0.8204 - accuracy: 0.465811/11 [==============================] - 0s 27ms/step - loss: 0.8219 - accuracy: 0.4649
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.9078 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.8774 - accuracy: 0.4371 5/11 [============>.................] - ETA: 0s - loss: 0.8641 - accuracy: 0.4422 7/11 [==================>...........] - ETA: 0s - loss: 0.8547 - accuracy: 0.4473 9/11 [=======================>......] - ETA: 0s - loss: 0.8500 - accuracy: 0.449611/11 [==============================] - ETA: 0s - loss: 0.8474 - accuracy: 0.451311/11 [==============================] - 0s 28ms/step - loss: 0.8466 - accuracy: 0.4516
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8926 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.8757 - accuracy: 0.4332 5/11 [============>.................] - ETA: 0s - loss: 0.8614 - accuracy: 0.4406 7/11 [==================>...........] - ETA: 0s - loss: 0.8558 - accuracy: 0.4445 9/11 [=======================>......] - ETA: 0s - loss: 0.8514 - accuracy: 0.446911/11 [==============================] - ETA: 0s - loss: 0.8495 - accuracy: 0.448111/11 [==============================] - 0s 27ms/step - loss: 0.8485 - accuracy: 0.4487
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7218 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.7904 - accuracy: 0.4648 5/11 [============>.................] - ETA: 0s - loss: 0.8144 - accuracy: 0.4569 7/11 [==================>...........] - ETA: 0s - loss: 0.8205 - accuracy: 0.4555 9/11 [=======================>......] - ETA: 0s - loss: 0.8249 - accuracy: 0.454711/11 [==============================] - ETA: 0s - loss: 0.8274 - accuracy: 0.454611/11 [==============================] - 0s 27ms/step - loss: 0.8283 - accuracy: 0.4547
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7301 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.8062 - accuracy: 0.4527 6/11 [===============>..............] - ETA: 0s - loss: 0.8157 - accuracy: 0.4556 8/11 [====================>.........] - ETA: 0s - loss: 0.8156 - accuracy: 0.458210/11 [==========================>...] - ETA: 0s - loss: 0.8197 - accuracy: 0.457811/11 [==============================] - 0s 26ms/step - loss: 0.8226 - accuracy: 0.4574
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.8456 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.8009 - accuracy: 0.4831 5/11 [============>.................] - ETA: 0s - loss: 0.7970 - accuracy: 0.4848 7/11 [==================>...........] - ETA: 0s - loss: 0.7990 - accuracy: 0.4823 9/11 [=======================>......] - ETA: 0s - loss: 0.8000 - accuracy: 0.480411/11 [==============================] - ETA: 0s - loss: 0.8052 - accuracy: 0.476711/11 [==============================] - 0s 27ms/step - loss: 0.8078 - accuracy: 0.4749
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7279 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.7432 - accuracy: 0.5056 5/11 [============>.................] - ETA: 0s - loss: 0.7659 - accuracy: 0.4934 7/11 [==================>...........] - ETA: 0s - loss: 0.7786 - accuracy: 0.4870 9/11 [=======================>......] - ETA: 0s - loss: 0.7879 - accuracy: 0.482011/11 [==============================] - ETA: 0s - loss: 0.7969 - accuracy: 0.477011/11 [==============================] - 0s 28ms/step - loss: 0.8002 - accuracy: 0.4752
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7913 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 0s - loss: 0.7823 - accuracy: 0.4967 6/11 [===============>..............] - ETA: 0s - loss: 0.7866 - accuracy: 0.4905 8/11 [====================>.........] - ETA: 0s - loss: 0.7944 - accuracy: 0.484310/11 [==========================>...] - ETA: 0s - loss: 0.7991 - accuracy: 0.480311/11 [==============================] - 0s 27ms/step - loss: 0.8053 - accuracy: 0.4761
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.8676 - accuracy: 0.45315/6 [========================>.....] - ETA: 0s - loss: 0.8382 - accuracy: 0.4734 6/6 [==============================] - 5s 12ms/step - loss: 0.8463 - accuracy: 0.4646
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [2.8188137e-04 7.9400640e-04 9.9794441e-01 2.3660931e-04 2.2362586e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [2.8605390e-04 8.0227968e-04 9.9791759e-01 2.3811702e-04 2.2697281e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [0.00875746 0.010234   0.9569923  0.00852095 0.0073915 ]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [4.0993057e-04 9.2850340e-04 9.9709880e-01 3.5343034e-04 2.8577994e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [0.04331608 0.0442788  0.8760609  0.04124729 0.03785234]
 Top predictions indices: [2 1] vs. real classes indices: [3 4]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 3 4] pred: [4.2205761e-04 9.3984447e-04 9.9702281e-01 3.6206763e-04 2.9281538e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [2.8520561e-04 8.0115057e-04 9.9792248e-01 2.3757819e-04 2.2646741e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [0.00408165 0.00470716 0.97754616 0.0034914  0.00308195]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 3 4] pred: [8.5488631e-04 1.4385696e-03 9.9422365e-01 6.9975818e-04 5.8520294e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [0.00244826 0.00295969 0.98574334 0.00193725 0.00163394]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [9.2732091e-04 1.6122751e-03 9.9375689e-01 8.7278779e-04 5.8405480e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [5.2450586e-04 1.0494961e-03 9.9632394e-01 4.2273165e-04 3.7563100e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [2.8160820e-04 7.9433253e-04 9.9794465e-01 2.3644560e-04 2.2359283e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [0.00239992 0.00288363 0.9860721  0.00188947 0.00160229]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [2.8359744e-04 7.9682417e-04 9.9791580e-01 2.3945708e-04 2.2259074e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Job end at mar déc 14 00:15:21 CET 2021
