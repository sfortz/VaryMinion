
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at lun déc 13 23:25:09 CET 2021
2021-12-13 23:25:09.872909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-13 23:25:15.056066: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:25:15.057607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-13 23:25:15.087886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:25:15.087958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:25:15.092080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:25:15.092131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:25:15.095232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:25:15.096154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:25:15.099722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:25:15.101645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:25:15.108143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:25:15.109394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:25:15.109440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:25:15.698677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:25:15.698726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:25:15.698738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:25:15.700650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:25:15.701819: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:25:15.702391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:25:15.702437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:25:15.702472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:25:15.702501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:25:15.702529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:25:15.702561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:25:15.702593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:25:15.702629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:25:15.702660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:25:15.703703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:25:15.703733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:25:15.703745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:25:15.703754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:25:15.704841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:25:17.556197: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:25:17.557522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:25:17.557573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:25:17.557617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:25:17.557656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:25:17.557690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:25:17.557723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:25:17.557757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:25:17.557791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:25:17.557827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:25:17.558917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:25:17.559765: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:25:17.560336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:25:17.560366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:25:17.560398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:25:17.560429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:25:17.560458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:25:17.560488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:25:17.560519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:25:17.560548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:25:17.560576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:25:17.561647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:25:17.561711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:25:17.561725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:25:17.561734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:25:17.562909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:25:17.563026: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-13 23:25:21.039052: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-13 23:25:21.039764: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 1994990000 Hz
2021-12-13 23:25:32.741950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:25:33.867154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
Number of possible configurations: 40
Begining exécution of the 23 th configuration: BPIC20.csv with GRU model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and mse as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 90, 58)            3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                16200     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:36 - loss: 0.2504 - accuracy: 0.1172 3/11 [=======>......................] - ETA: 0s - loss: 0.2488 - accuracy: 0.1675   5/11 [============>.................] - ETA: 0s - loss: 0.2452 - accuracy: 0.2197 7/11 [==================>...........] - ETA: 0s - loss: 0.2408 - accuracy: 0.256610/11 [==========================>...] - ETA: 0s - loss: 0.2333 - accuracy: 0.293911/11 [==============================] - 16s 24ms/step - loss: 0.2288 - accuracy: 0.3114
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1489 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.1437 - accuracy: 0.4604 7/11 [==================>...........] - ETA: 0s - loss: 0.1390 - accuracy: 0.462710/11 [==========================>...] - ETA: 0s - loss: 0.1354 - accuracy: 0.462111/11 [==============================] - 0s 25ms/step - loss: 0.1335 - accuracy: 0.4617
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1099 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.1058 - accuracy: 0.4676 6/11 [===============>..............] - ETA: 0s - loss: 0.1056 - accuracy: 0.4665 8/11 [====================>.........] - ETA: 0s - loss: 0.1055 - accuracy: 0.466911/11 [==============================] - ETA: 0s - loss: 0.1055 - accuracy: 0.466111/11 [==============================] - 0s 24ms/step - loss: 0.1055 - accuracy: 0.4655
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1046 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.1064 - accuracy: 0.4497 7/11 [==================>...........] - ETA: 0s - loss: 0.1046 - accuracy: 0.448210/11 [==========================>...] - ETA: 0s - loss: 0.1024 - accuracy: 0.453311/11 [==============================] - 0s 24ms/step - loss: 0.1013 - accuracy: 0.4562
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0833 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.0873 - accuracy: 0.5068 7/11 [==================>...........] - ETA: 0s - loss: 0.0877 - accuracy: 0.5039 9/11 [=======================>......] - ETA: 0s - loss: 0.0874 - accuracy: 0.503111/11 [==============================] - 0s 24ms/step - loss: 0.0868 - accuracy: 0.5020
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0800 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.0804 - accuracy: 0.4876 6/11 [===============>..............] - ETA: 0s - loss: 0.0787 - accuracy: 0.4950 8/11 [====================>.........] - ETA: 0s - loss: 0.0776 - accuracy: 0.499711/11 [==============================] - ETA: 0s - loss: 0.0767 - accuracy: 0.504211/11 [==============================] - 0s 25ms/step - loss: 0.0765 - accuracy: 0.5053
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0642 - accuracy: 0.5547 4/11 [=========>....................] - ETA: 0s - loss: 0.0673 - accuracy: 0.5452 7/11 [==================>...........] - ETA: 0s - loss: 0.0678 - accuracy: 0.549110/11 [==========================>...] - ETA: 0s - loss: 0.0674 - accuracy: 0.553411/11 [==============================] - 0s 23ms/step - loss: 0.0672 - accuracy: 0.5555
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0654 - accuracy: 0.6484 3/11 [=======>......................] - ETA: 0s - loss: 0.0641 - accuracy: 0.6237 6/11 [===============>..............] - ETA: 0s - loss: 0.0624 - accuracy: 0.6225 8/11 [====================>.........] - ETA: 0s - loss: 0.0621 - accuracy: 0.623911/11 [==============================] - ETA: 0s - loss: 0.0617 - accuracy: 0.624711/11 [==============================] - 0s 23ms/step - loss: 0.0616 - accuracy: 0.6249
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0540 - accuracy: 0.6406 4/11 [=========>....................] - ETA: 0s - loss: 0.0537 - accuracy: 0.6413 6/11 [===============>..............] - ETA: 0s - loss: 0.0542 - accuracy: 0.6426 9/11 [=======================>......] - ETA: 0s - loss: 0.0545 - accuracy: 0.645511/11 [==============================] - 0s 24ms/step - loss: 0.0546 - accuracy: 0.6487
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0530 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.0508 - accuracy: 0.6519 5/11 [============>.................] - ETA: 0s - loss: 0.0511 - accuracy: 0.6575 8/11 [====================>.........] - ETA: 0s - loss: 0.0509 - accuracy: 0.663311/11 [==============================] - ETA: 0s - loss: 0.0506 - accuracy: 0.664211/11 [==============================] - 0s 24ms/step - loss: 0.0506 - accuracy: 0.6646
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0508 - accuracy: 0.7109 4/11 [=========>....................] - ETA: 0s - loss: 0.0489 - accuracy: 0.7095 7/11 [==================>...........] - ETA: 0s - loss: 0.0485 - accuracy: 0.6962 9/11 [=======================>......] - ETA: 0s - loss: 0.0481 - accuracy: 0.691811/11 [==============================] - 0s 24ms/step - loss: 0.0478 - accuracy: 0.6873
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0456 - accuracy: 0.6797 4/11 [=========>....................] - ETA: 0s - loss: 0.0445 - accuracy: 0.6794 6/11 [===============>..............] - ETA: 0s - loss: 0.0445 - accuracy: 0.6783 9/11 [=======================>......] - ETA: 0s - loss: 0.0447 - accuracy: 0.676711/11 [==============================] - 0s 25ms/step - loss: 0.0446 - accuracy: 0.6766
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0442 - accuracy: 0.6641 3/11 [=======>......................] - ETA: 0s - loss: 0.0427 - accuracy: 0.7014 5/11 [============>.................] - ETA: 0s - loss: 0.0428 - accuracy: 0.7015 7/11 [==================>...........] - ETA: 0s - loss: 0.0429 - accuracy: 0.703910/11 [==========================>...] - ETA: 0s - loss: 0.0429 - accuracy: 0.703411/11 [==============================] - 0s 26ms/step - loss: 0.0427 - accuracy: 0.7020
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0344 - accuracy: 0.7578 4/11 [=========>....................] - ETA: 0s - loss: 0.0375 - accuracy: 0.7176 7/11 [==================>...........] - ETA: 0s - loss: 0.0387 - accuracy: 0.719310/11 [==========================>...] - ETA: 0s - loss: 0.0391 - accuracy: 0.718011/11 [==============================] - 0s 24ms/step - loss: 0.0393 - accuracy: 0.7165
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0349 - accuracy: 0.7266 3/11 [=======>......................] - ETA: 0s - loss: 0.0359 - accuracy: 0.7157 6/11 [===============>..............] - ETA: 0s - loss: 0.0371 - accuracy: 0.7156 9/11 [=======================>......] - ETA: 0s - loss: 0.0375 - accuracy: 0.722211/11 [==============================] - 0s 24ms/step - loss: 0.0377 - accuracy: 0.7246
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0310 - accuracy: 0.8281 4/11 [=========>....................] - ETA: 0s - loss: 0.0345 - accuracy: 0.7887 7/11 [==================>...........] - ETA: 0s - loss: 0.0357 - accuracy: 0.7741 9/11 [=======================>......] - ETA: 0s - loss: 0.0360 - accuracy: 0.768111/11 [==============================] - 0s 25ms/step - loss: 0.0362 - accuracy: 0.7626
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0416 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.0397 - accuracy: 0.7257 6/11 [===============>..............] - ETA: 0s - loss: 0.0388 - accuracy: 0.7410 9/11 [=======================>......] - ETA: 0s - loss: 0.0379 - accuracy: 0.744411/11 [==============================] - 0s 25ms/step - loss: 0.0373 - accuracy: 0.7461
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0318 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.0321 - accuracy: 0.8090 5/11 [============>.................] - ETA: 0s - loss: 0.0326 - accuracy: 0.8084 7/11 [==================>...........] - ETA: 0s - loss: 0.0330 - accuracy: 0.802310/11 [==========================>...] - ETA: 0s - loss: 0.0333 - accuracy: 0.793211/11 [==============================] - 0s 25ms/step - loss: 0.0334 - accuracy: 0.7900
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0376 - accuracy: 0.8984 4/11 [=========>....................] - ETA: 0s - loss: 0.0362 - accuracy: 0.8468 6/11 [===============>..............] - ETA: 0s - loss: 0.0352 - accuracy: 0.8354 8/11 [====================>.........] - ETA: 0s - loss: 0.0346 - accuracy: 0.827011/11 [==============================] - ETA: 0s - loss: 0.0341 - accuracy: 0.817511/11 [==============================] - 0s 24ms/step - loss: 0.0340 - accuracy: 0.8152
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0293 - accuracy: 0.8281 3/11 [=======>......................] - ETA: 0s - loss: 0.0315 - accuracy: 0.8125 5/11 [============>.................] - ETA: 0s - loss: 0.0314 - accuracy: 0.8049 7/11 [==================>...........] - ETA: 0s - loss: 0.0313 - accuracy: 0.8022 9/11 [=======================>......] - ETA: 0s - loss: 0.0312 - accuracy: 0.797011/11 [==============================] - 0s 26ms/step - loss: 0.0312 - accuracy: 0.7921
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0306 - accuracy: 0.82036/6 [==============================] - 5s 10ms/step - loss: 0.0337 - accuracy: 0.8272
2021-12-13 23:25:51.934466: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:25:51.936135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:25:51.936220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:25:51.936289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:25:51.936343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:25:51.936398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:25:51.936453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:25:51.936509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:25:51.936564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:25:51.936615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:25:51.937658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:25:51.937718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:25:51.937739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:25:51.937753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:25:51.938894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:25:51.939378: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:25:51.939916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:25:51.939969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:25:51.940013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:25:51.940056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:25:51.940097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:25:51.940142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:25:51.940184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:25:51.940225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:25:51.940270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:25:51.941248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:25:51.941290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:25:51.941307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:25:51.941320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:25:51.942332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 4 3 0] pred: [-0.09543296  0.8571477   0.75969785 -0.04991636 -0.00134568]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 3 4 0] pred: [-0.01374032  0.8528535   0.8289687   0.07195301 -0.00546489]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [ 0.02629784  0.4208045   0.8110898   0.00314536 -0.02718581]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 0 4 3 1] pred: [ 0.00756889 -0.0241132   0.97635937 -0.01931559  0.00389884]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 3 0 4] pred: [ 0.0083666   0.85915637  0.8296463   0.02182442 -0.00733965]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 0 3] pred: [ 0.00126055  0.7572717   0.9165402  -0.08922534  0.0079327 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [0.02778948 0.80405706 0.86423576 0.04130546 0.00789675]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [4 3 2 1 0] pred: [0.00470319 0.07305921 0.09278499 0.14100799 0.86376584]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 4 0 1 3] pred: [-0.00754858 -0.0270278   0.97754604 -0.03236239  0.01037336]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [ 0.02646649  0.48957253  0.9064377   0.06006285 -0.03030508]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [ 0.00640738  0.81203645  0.8904116   0.00416666 -0.01951283]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 3 4 0] pred: [-0.04469755  0.9180388   0.75914156  0.02812058 -0.00839971]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 4 3] pred: [ 0.02237119  0.79271775  0.8959248  -0.03118944  0.00481016]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [3 2 4 0 1] pred: [-0.01542258 -0.11232426  0.20696649  0.74169755  0.06608603]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 4 0 3] pred: [ 0.00120011  0.09064827  0.9617328  -0.0012572   0.04045886]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:39 - loss: 0.2513 - accuracy: 0.1094 4/11 [=========>....................] - ETA: 0s - loss: 0.2410 - accuracy: 0.2118   7/11 [==================>...........] - ETA: 0s - loss: 0.2360 - accuracy: 0.272010/11 [==========================>...] - ETA: 0s - loss: 0.2304 - accuracy: 0.306011/11 [==============================] - 16s 24ms/step - loss: 0.2270 - accuracy: 0.3222
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1651 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.1588 - accuracy: 0.4325 6/11 [===============>..............] - ETA: 0s - loss: 0.1547 - accuracy: 0.4396 8/11 [====================>.........] - ETA: 0s - loss: 0.1510 - accuracy: 0.445711/11 [==============================] - ETA: 0s - loss: 0.1467 - accuracy: 0.449911/11 [==============================] - 0s 24ms/step - loss: 0.1456 - accuracy: 0.4507
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1110 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.1129 - accuracy: 0.4583 5/11 [============>.................] - ETA: 0s - loss: 0.1124 - accuracy: 0.4557 7/11 [==================>...........] - ETA: 0s - loss: 0.1114 - accuracy: 0.455610/11 [==========================>...] - ETA: 0s - loss: 0.1102 - accuracy: 0.459111/11 [==============================] - 0s 25ms/step - loss: 0.1096 - accuracy: 0.4596
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0936 - accuracy: 0.5547 4/11 [=========>....................] - ETA: 0s - loss: 0.0987 - accuracy: 0.4992 6/11 [===============>..............] - ETA: 0s - loss: 0.0985 - accuracy: 0.4932 9/11 [=======================>......] - ETA: 0s - loss: 0.0985 - accuracy: 0.486611/11 [==============================] - 0s 24ms/step - loss: 0.0984 - accuracy: 0.4831
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0891 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.0872 - accuracy: 0.4796 6/11 [===============>..............] - ETA: 0s - loss: 0.0869 - accuracy: 0.4832 8/11 [====================>.........] - ETA: 0s - loss: 0.0869 - accuracy: 0.483111/11 [==============================] - ETA: 0s - loss: 0.0864 - accuracy: 0.486611/11 [==============================] - 0s 24ms/step - loss: 0.0863 - accuracy: 0.4876
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0763 - accuracy: 0.5859 4/11 [=========>....................] - ETA: 0s - loss: 0.0753 - accuracy: 0.5599 6/11 [===============>..............] - ETA: 0s - loss: 0.0754 - accuracy: 0.5497 9/11 [=======================>......] - ETA: 0s - loss: 0.0753 - accuracy: 0.543111/11 [==============================] - 0s 24ms/step - loss: 0.0749 - accuracy: 0.5429
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0703 - accuracy: 0.6094 3/11 [=======>......................] - ETA: 0s - loss: 0.0691 - accuracy: 0.5981 5/11 [============>.................] - ETA: 0s - loss: 0.0685 - accuracy: 0.5988 8/11 [====================>.........] - ETA: 0s - loss: 0.0679 - accuracy: 0.600810/11 [==========================>...] - ETA: 0s - loss: 0.0674 - accuracy: 0.602511/11 [==============================] - 0s 25ms/step - loss: 0.0670 - accuracy: 0.6041
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0571 - accuracy: 0.6562 4/11 [=========>....................] - ETA: 0s - loss: 0.0590 - accuracy: 0.6486 7/11 [==================>...........] - ETA: 0s - loss: 0.0593 - accuracy: 0.6460 9/11 [=======================>......] - ETA: 0s - loss: 0.0593 - accuracy: 0.646311/11 [==============================] - 0s 24ms/step - loss: 0.0591 - accuracy: 0.6477
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0515 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.0542 - accuracy: 0.7244 5/11 [============>.................] - ETA: 0s - loss: 0.0550 - accuracy: 0.7067 8/11 [====================>.........] - ETA: 0s - loss: 0.0553 - accuracy: 0.699911/11 [==============================] - ETA: 0s - loss: 0.0549 - accuracy: 0.694111/11 [==============================] - 0s 24ms/step - loss: 0.0548 - accuracy: 0.6926
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0463 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.0500 - accuracy: 0.6476 5/11 [============>.................] - ETA: 0s - loss: 0.0508 - accuracy: 0.6533 8/11 [====================>.........] - ETA: 0s - loss: 0.0512 - accuracy: 0.662510/11 [==========================>...] - ETA: 0s - loss: 0.0511 - accuracy: 0.667111/11 [==============================] - 0s 25ms/step - loss: 0.0510 - accuracy: 0.6692
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0524 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.0509 - accuracy: 0.6820 7/11 [==================>...........] - ETA: 0s - loss: 0.0507 - accuracy: 0.673210/11 [==========================>...] - ETA: 0s - loss: 0.0502 - accuracy: 0.672311/11 [==============================] - 0s 23ms/step - loss: 0.0498 - accuracy: 0.6741
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0464 - accuracy: 0.6094 4/11 [=========>....................] - ETA: 0s - loss: 0.0452 - accuracy: 0.6479 6/11 [===============>..............] - ETA: 0s - loss: 0.0456 - accuracy: 0.6543 8/11 [====================>.........] - ETA: 0s - loss: 0.0457 - accuracy: 0.659910/11 [==========================>...] - ETA: 0s - loss: 0.0457 - accuracy: 0.666011/11 [==============================] - 0s 26ms/step - loss: 0.0457 - accuracy: 0.6694
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0487 - accuracy: 0.6328 4/11 [=========>....................] - ETA: 0s - loss: 0.0450 - accuracy: 0.6833 6/11 [===============>..............] - ETA: 0s - loss: 0.0441 - accuracy: 0.6889 8/11 [====================>.........] - ETA: 0s - loss: 0.0439 - accuracy: 0.690310/11 [==========================>...] - ETA: 0s - loss: 0.0438 - accuracy: 0.689911/11 [==============================] - 0s 26ms/step - loss: 0.0438 - accuracy: 0.6893
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0471 - accuracy: 0.6641 3/11 [=======>......................] - ETA: 0s - loss: 0.0457 - accuracy: 0.6806 5/11 [============>.................] - ETA: 0s - loss: 0.0443 - accuracy: 0.6836 7/11 [==================>...........] - ETA: 0s - loss: 0.0437 - accuracy: 0.689510/11 [==========================>...] - ETA: 0s - loss: 0.0432 - accuracy: 0.692611/11 [==============================] - 0s 26ms/step - loss: 0.0430 - accuracy: 0.6932
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0443 - accuracy: 0.6250 4/11 [=========>....................] - ETA: 0s - loss: 0.0431 - accuracy: 0.6846 7/11 [==================>...........] - ETA: 0s - loss: 0.0422 - accuracy: 0.693910/11 [==========================>...] - ETA: 0s - loss: 0.0417 - accuracy: 0.694711/11 [==============================] - 0s 24ms/step - loss: 0.0415 - accuracy: 0.6961
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0450 - accuracy: 0.7812 4/11 [=========>....................] - ETA: 0s - loss: 0.0396 - accuracy: 0.7713 6/11 [===============>..............] - ETA: 0s - loss: 0.0392 - accuracy: 0.7665 9/11 [=======================>......] - ETA: 0s - loss: 0.0392 - accuracy: 0.756711/11 [==============================] - 0s 25ms/step - loss: 0.0391 - accuracy: 0.7509
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0384 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.0369 - accuracy: 0.7122 6/11 [===============>..............] - ETA: 0s - loss: 0.0362 - accuracy: 0.7177 8/11 [====================>.........] - ETA: 0s - loss: 0.0364 - accuracy: 0.720111/11 [==============================] - ETA: 0s - loss: 0.0365 - accuracy: 0.725711/11 [==============================] - 0s 25ms/step - loss: 0.0365 - accuracy: 0.7272
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0348 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.0352 - accuracy: 0.7261 5/11 [============>.................] - ETA: 0s - loss: 0.0358 - accuracy: 0.7228 8/11 [====================>.........] - ETA: 0s - loss: 0.0363 - accuracy: 0.717211/11 [==============================] - ETA: 0s - loss: 0.0363 - accuracy: 0.720711/11 [==============================] - 0s 25ms/step - loss: 0.0363 - accuracy: 0.7226
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0352 - accuracy: 0.8438 4/11 [=========>....................] - ETA: 0s - loss: 0.0340 - accuracy: 0.8135 7/11 [==================>...........] - ETA: 0s - loss: 0.0343 - accuracy: 0.7940 9/11 [=======================>......] - ETA: 0s - loss: 0.0343 - accuracy: 0.784811/11 [==============================] - 0s 24ms/step - loss: 0.0342 - accuracy: 0.7781
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0325 - accuracy: 0.8594 3/11 [=======>......................] - ETA: 0s - loss: 0.0329 - accuracy: 0.8672 5/11 [============>.................] - ETA: 0s - loss: 0.0332 - accuracy: 0.8572 7/11 [==================>...........] - ETA: 0s - loss: 0.0333 - accuracy: 0.848110/11 [==========================>...] - ETA: 0s - loss: 0.0328 - accuracy: 0.838111/11 [==============================] - 0s 25ms/step - loss: 0.0326 - accuracy: 0.8327
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.0297 - accuracy: 0.74226/6 [==============================] - 5s 10ms/step - loss: 0.0320 - accuracy: 0.7465
2021-12-13 23:26:27.791848: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:26:27.792476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:26:27.792531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:26:27.792586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:26:27.792620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:26:27.792653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:26:27.792688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:26:27.792725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:26:27.792761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:26:27.792798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:26:27.793502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:26:27.793546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:26:27.793558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:26:27.793567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:26:27.794343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:26:27.794628: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:26:27.795024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:26:27.795052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:26:27.795080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:26:27.795109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:26:27.795137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:26:27.795164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:26:27.795192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:26:27.795223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:26:27.795256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:26:27.795981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:26:27.796008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:26:27.796020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:26:27.796029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:26:27.796777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [-0.17752814  0.39155537  0.8477985   0.19890173 -0.00753237]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 4 3 0] pred: [-0.15070668  0.9422577   0.57912177 -0.00680527  0.06241203]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 0 3 4 1] pred: [ 0.06676646 -0.3274111   0.97292     0.04724394  0.03292576]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [-9.3957008e-04  2.4058552e-02  9.8117059e-01  1.6489100e-02
 -2.6431868e-02]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 0 4 3 2] pred: [ 0.22669652  0.71688694 -0.26487675 -0.12988448 -0.00644627]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 3 0] pred: [-0.0397587   0.7744707   0.90665615 -0.0107867   0.0252523 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 1 0 2 4] pred: [ 0.01949633  0.03316862 -0.01483243  0.8425443  -0.04715028]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 0 3] pred: [-0.03887948  0.65445447  0.90772796 -0.04619519 -0.00148436]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 3 0] pred: [-0.09313352  0.6992964   0.9605134  -0.08341599  0.0609563 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 4 1 3 0] pred: [-0.04473015  0.01622115  0.9848884  -0.04210629  0.02755745]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 4 1 3 0] pred: [-0.07431775 -0.00418532  0.98698    -0.05605079  0.03655626]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 3 0] pred: [-0.02181704  0.6109588   0.90682805 -0.00453301 -0.00126827]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 4 0 1] pred: [-0.0076124  -0.01928701  0.975765    0.09124818  0.00473614]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 3 0] pred: [-0.05163848  0.52761436  0.92407507 -0.03219058 -0.02096781]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 0 2 4 3] pred: [ 0.43026453  0.77086186  0.1946486  -0.05527725 -0.00765387]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:31 - loss: 0.2580 - accuracy: 0.2734 4/11 [=========>....................] - ETA: 0s - loss: 0.2529 - accuracy: 0.3254   7/11 [==================>...........] - ETA: 0s - loss: 0.2444 - accuracy: 0.3609 9/11 [=======================>......] - ETA: 0s - loss: 0.2391 - accuracy: 0.375111/11 [==============================] - 15s 24ms/step - loss: 0.2318 - accuracy: 0.3913
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1582 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.1558 - accuracy: 0.4405 5/11 [============>.................] - ETA: 0s - loss: 0.1527 - accuracy: 0.4425 8/11 [====================>.........] - ETA: 0s - loss: 0.1485 - accuracy: 0.447111/11 [==============================] - ETA: 0s - loss: 0.1449 - accuracy: 0.449411/11 [==============================] - 0s 24ms/step - loss: 0.1440 - accuracy: 0.4499
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1111 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.1101 - accuracy: 0.4622 5/11 [============>.................] - ETA: 0s - loss: 0.1105 - accuracy: 0.4571 8/11 [====================>.........] - ETA: 0s - loss: 0.1103 - accuracy: 0.454911/11 [==============================] - ETA: 0s - loss: 0.1095 - accuracy: 0.454911/11 [==============================] - 0s 24ms/step - loss: 0.1093 - accuracy: 0.4549
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1042 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.1046 - accuracy: 0.4366 6/11 [===============>..............] - ETA: 0s - loss: 0.1036 - accuracy: 0.4456 9/11 [=======================>......] - ETA: 0s - loss: 0.1026 - accuracy: 0.448311/11 [==============================] - 0s 24ms/step - loss: 0.1014 - accuracy: 0.4522
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0881 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.0915 - accuracy: 0.4470 6/11 [===============>..............] - ETA: 0s - loss: 0.0906 - accuracy: 0.4655 8/11 [====================>.........] - ETA: 0s - loss: 0.0897 - accuracy: 0.471011/11 [==============================] - ETA: 0s - loss: 0.0886 - accuracy: 0.475811/11 [==============================] - 0s 25ms/step - loss: 0.0883 - accuracy: 0.4769
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0822 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.0795 - accuracy: 0.4857 6/11 [===============>..............] - ETA: 0s - loss: 0.0785 - accuracy: 0.4994 8/11 [====================>.........] - ETA: 0s - loss: 0.0778 - accuracy: 0.507110/11 [==========================>...] - ETA: 0s - loss: 0.0770 - accuracy: 0.515711/11 [==============================] - 0s 26ms/step - loss: 0.0763 - accuracy: 0.5228
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0664 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.0664 - accuracy: 0.5851 6/11 [===============>..............] - ETA: 0s - loss: 0.0666 - accuracy: 0.5943 8/11 [====================>.........] - ETA: 0s - loss: 0.0665 - accuracy: 0.597710/11 [==========================>...] - ETA: 0s - loss: 0.0662 - accuracy: 0.599511/11 [==============================] - 0s 24ms/step - loss: 0.0658 - accuracy: 0.6001
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0613 - accuracy: 0.5781 4/11 [=========>....................] - ETA: 0s - loss: 0.0620 - accuracy: 0.5947 6/11 [===============>..............] - ETA: 0s - loss: 0.0609 - accuracy: 0.5969 8/11 [====================>.........] - ETA: 0s - loss: 0.0602 - accuracy: 0.601511/11 [==============================] - ETA: 0s - loss: 0.0595 - accuracy: 0.605711/11 [==============================] - 0s 25ms/step - loss: 0.0593 - accuracy: 0.6065
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0524 - accuracy: 0.6562 4/11 [=========>....................] - ETA: 0s - loss: 0.0519 - accuracy: 0.6724 6/11 [===============>..............] - ETA: 0s - loss: 0.0522 - accuracy: 0.6676 8/11 [====================>.........] - ETA: 0s - loss: 0.0523 - accuracy: 0.662010/11 [==========================>...] - ETA: 0s - loss: 0.0524 - accuracy: 0.657411/11 [==============================] - 0s 25ms/step - loss: 0.0525 - accuracy: 0.6543
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0529 - accuracy: 0.6016 3/11 [=======>......................] - ETA: 0s - loss: 0.0522 - accuracy: 0.6072 5/11 [============>.................] - ETA: 0s - loss: 0.0515 - accuracy: 0.6067 8/11 [====================>.........] - ETA: 0s - loss: 0.0512 - accuracy: 0.618411/11 [==============================] - ETA: 0s - loss: 0.0509 - accuracy: 0.630011/11 [==============================] - 0s 25ms/step - loss: 0.0508 - accuracy: 0.6327
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0509 - accuracy: 0.6641 4/11 [=========>....................] - ETA: 0s - loss: 0.0498 - accuracy: 0.6562 6/11 [===============>..............] - ETA: 0s - loss: 0.0493 - accuracy: 0.6607 9/11 [=======================>......] - ETA: 0s - loss: 0.0488 - accuracy: 0.662311/11 [==============================] - 0s 23ms/step - loss: 0.0484 - accuracy: 0.6620
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0476 - accuracy: 0.6484 3/11 [=======>......................] - ETA: 0s - loss: 0.0469 - accuracy: 0.6497 6/11 [===============>..............] - ETA: 0s - loss: 0.0468 - accuracy: 0.6534 8/11 [====================>.........] - ETA: 0s - loss: 0.0464 - accuracy: 0.657110/11 [==========================>...] - ETA: 0s - loss: 0.0461 - accuracy: 0.658811/11 [==============================] - 0s 25ms/step - loss: 0.0459 - accuracy: 0.6601
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0426 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.0444 - accuracy: 0.6966 5/11 [============>.................] - ETA: 0s - loss: 0.0454 - accuracy: 0.6814 8/11 [====================>.........] - ETA: 0s - loss: 0.0455 - accuracy: 0.676311/11 [==============================] - ETA: 0s - loss: 0.0451 - accuracy: 0.675411/11 [==============================] - 0s 25ms/step - loss: 0.0449 - accuracy: 0.6752
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0401 - accuracy: 0.7500 3/11 [=======>......................] - ETA: 0s - loss: 0.0402 - accuracy: 0.7322 5/11 [============>.................] - ETA: 0s - loss: 0.0408 - accuracy: 0.7276 8/11 [====================>.........] - ETA: 0s - loss: 0.0413 - accuracy: 0.719210/11 [==========================>...] - ETA: 0s - loss: 0.0415 - accuracy: 0.713311/11 [==============================] - 0s 25ms/step - loss: 0.0416 - accuracy: 0.7088
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0373 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.0394 - accuracy: 0.7161 6/11 [===============>..............] - ETA: 0s - loss: 0.0396 - accuracy: 0.7206 8/11 [====================>.........] - ETA: 0s - loss: 0.0397 - accuracy: 0.718611/11 [==============================] - ETA: 0s - loss: 0.0397 - accuracy: 0.716511/11 [==============================] - 0s 26ms/step - loss: 0.0398 - accuracy: 0.7160
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0436 - accuracy: 0.7109 4/11 [=========>....................] - ETA: 0s - loss: 0.0394 - accuracy: 0.7160 7/11 [==================>...........] - ETA: 0s - loss: 0.0384 - accuracy: 0.709810/11 [==========================>...] - ETA: 0s - loss: 0.0382 - accuracy: 0.708311/11 [==============================] - 0s 24ms/step - loss: 0.0383 - accuracy: 0.7082
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0375 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.0399 - accuracy: 0.7526 5/11 [============>.................] - ETA: 0s - loss: 0.0393 - accuracy: 0.7577 8/11 [====================>.........] - ETA: 0s - loss: 0.0385 - accuracy: 0.762111/11 [==============================] - ETA: 0s - loss: 0.0381 - accuracy: 0.764911/11 [==============================] - 0s 25ms/step - loss: 0.0380 - accuracy: 0.7656
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0341 - accuracy: 0.7500 4/11 [=========>....................] - ETA: 0s - loss: 0.0332 - accuracy: 0.7775 7/11 [==================>...........] - ETA: 0s - loss: 0.0333 - accuracy: 0.778410/11 [==========================>...] - ETA: 0s - loss: 0.0338 - accuracy: 0.774111/11 [==============================] - 0s 24ms/step - loss: 0.0340 - accuracy: 0.7717
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0384 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.0363 - accuracy: 0.7591 5/11 [============>.................] - ETA: 0s - loss: 0.0356 - accuracy: 0.7683 7/11 [==================>...........] - ETA: 0s - loss: 0.0349 - accuracy: 0.7792 9/11 [=======================>......] - ETA: 0s - loss: 0.0345 - accuracy: 0.783911/11 [==============================] - 0s 26ms/step - loss: 0.0341 - accuracy: 0.7893
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0331 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.0326 - accuracy: 0.7214 6/11 [===============>..............] - ETA: 0s - loss: 0.0321 - accuracy: 0.7349 8/11 [====================>.........] - ETA: 0s - loss: 0.0320 - accuracy: 0.742311/11 [==============================] - ETA: 0s - loss: 0.0320 - accuracy: 0.753411/11 [==============================] - 0s 25ms/step - loss: 0.0319 - accuracy: 0.7566
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.0268 - accuracy: 0.89066/6 [==============================] - 5s 10ms/step - loss: 0.0329 - accuracy: 0.8258
2021-12-13 23:27:03.733053: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:27:03.733896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:27:03.733984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:27:03.734044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:27:03.734091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:27:03.734140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:27:03.734190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:27:03.734244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:27:03.734291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:27:03.734342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:27:03.735307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:27:03.735368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:27:03.735385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:27:03.735399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:27:03.736426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:27:03.736830: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:27:03.737354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:27:03.737397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:27:03.737437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:27:03.737476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:27:03.737515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:27:03.737553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:27:03.737592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:27:03.737636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:27:03.737680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:27:03.738624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:27:03.738666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:27:03.738683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:27:03.738695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:27:03.739683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 3 1 0 2] pred: [ 0.01628892  0.10137047 -0.01920983  0.2729013   0.89213485]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [-0.12708075  0.5839224   0.7566379  -0.03484495 -0.05933217]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 2 0 4 1] pred: [ 0.02134915 -0.06435408  0.04389898  0.80983144 -0.00883049]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 3 4 0] pred: [-0.03760044  0.90842944  0.79700434  0.02342356 -0.00508142]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 4 0 3 1] pred: [ 0.02758889 -0.2361392   0.9849294  -0.09850542  0.06770007]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 4 3] pred: [ 3.6631280e-04  7.7251816e-01  5.5354655e-01 -4.7610529e-02
 -7.8791357e-04]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [ 0.1001273   0.68402874  0.8189997  -0.05992858 -0.03615615]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 3 4 0] pred: [-0.12775771  0.9654859   0.673858    0.0136591  -0.02149645]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 4 3] pred: [-0.01301583  0.12356572  0.9343574  -0.07817575 -0.03901767]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [0 1 2 3 4] pred: [ 0.6604728   0.23701769  0.13953267  0.06420106 -0.09006707]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [3 4 1 0 2] pred: [-0.01511323 -0.0072942  -0.14089037  0.86877286  0.04672944]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [ 0.00921696  0.84569544  0.8523803   0.03650488 -0.03512716]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 4 3 0] pred: [-0.01175807  0.88905996  0.6262687   0.02128057  0.03105269]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [ 0.00948719  0.73117596  0.9112385  -0.09245969 -0.04305194]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 0 3 1 4] pred: [ 0.03160461  0.00844027  0.9758658   0.01507829 -0.01955364]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:31 - loss: 0.2520 - accuracy: 0.2344 3/11 [=======>......................] - ETA: 0s - loss: 0.2479 - accuracy: 0.2687   6/11 [===============>..............] - ETA: 0s - loss: 0.2419 - accuracy: 0.2881 9/11 [=======================>......] - ETA: 0s - loss: 0.2354 - accuracy: 0.315311/11 [==============================] - 15s 25ms/step - loss: 0.2293 - accuracy: 0.3365
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1522 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.1536 - accuracy: 0.4944 6/11 [===============>..............] - ETA: 0s - loss: 0.1497 - accuracy: 0.4842 9/11 [=======================>......] - ETA: 0s - loss: 0.1456 - accuracy: 0.480811/11 [==============================] - 0s 25ms/step - loss: 0.1425 - accuracy: 0.4764
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1061 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.1048 - accuracy: 0.4683 6/11 [===============>..............] - ETA: 0s - loss: 0.1053 - accuracy: 0.4714 8/11 [====================>.........] - ETA: 0s - loss: 0.1054 - accuracy: 0.472611/11 [==============================] - ETA: 0s - loss: 0.1058 - accuracy: 0.470811/11 [==============================] - 0s 25ms/step - loss: 0.1059 - accuracy: 0.4703
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1022 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.1028 - accuracy: 0.4258 6/11 [===============>..............] - ETA: 0s - loss: 0.1022 - accuracy: 0.4311 9/11 [=======================>......] - ETA: 0s - loss: 0.1013 - accuracy: 0.439011/11 [==============================] - ETA: 0s - loss: 0.1007 - accuracy: 0.443511/11 [==============================] - 0s 26ms/step - loss: 0.1004 - accuracy: 0.4452
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0996 - accuracy: 0.3594 3/11 [=======>......................] - ETA: 0s - loss: 0.0972 - accuracy: 0.3980 5/11 [============>.................] - ETA: 0s - loss: 0.0952 - accuracy: 0.4158 8/11 [====================>.........] - ETA: 0s - loss: 0.0932 - accuracy: 0.430510/11 [==========================>...] - ETA: 0s - loss: 0.0922 - accuracy: 0.438011/11 [==============================] - 0s 26ms/step - loss: 0.0912 - accuracy: 0.4438
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0784 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.0784 - accuracy: 0.4462 5/11 [============>.................] - ETA: 0s - loss: 0.0778 - accuracy: 0.4665 7/11 [==================>...........] - ETA: 0s - loss: 0.0768 - accuracy: 0.475610/11 [==========================>...] - ETA: 0s - loss: 0.0758 - accuracy: 0.482311/11 [==============================] - 0s 25ms/step - loss: 0.0753 - accuracy: 0.4861
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0712 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.0693 - accuracy: 0.5399 6/11 [===============>..............] - ETA: 0s - loss: 0.0684 - accuracy: 0.5504 9/11 [=======================>......] - ETA: 0s - loss: 0.0673 - accuracy: 0.561011/11 [==============================] - ETA: 0s - loss: 0.0666 - accuracy: 0.567111/11 [==============================] - 0s 26ms/step - loss: 0.0664 - accuracy: 0.5695
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0634 - accuracy: 0.6094 4/11 [=========>....................] - ETA: 0s - loss: 0.0642 - accuracy: 0.6333 7/11 [==================>...........] - ETA: 0s - loss: 0.0633 - accuracy: 0.6367 9/11 [=======================>......] - ETA: 0s - loss: 0.0624 - accuracy: 0.638011/11 [==============================] - ETA: 0s - loss: 0.0615 - accuracy: 0.638211/11 [==============================] - 0s 25ms/step - loss: 0.0612 - accuracy: 0.6384
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0494 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.0505 - accuracy: 0.6645 6/11 [===============>..............] - ETA: 0s - loss: 0.0512 - accuracy: 0.6625 9/11 [=======================>......] - ETA: 0s - loss: 0.0517 - accuracy: 0.657411/11 [==============================] - ETA: 0s - loss: 0.0519 - accuracy: 0.655511/11 [==============================] - 0s 25ms/step - loss: 0.0519 - accuracy: 0.6550
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0602 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.0555 - accuracy: 0.6866 5/11 [============>.................] - ETA: 0s - loss: 0.0543 - accuracy: 0.6783 8/11 [====================>.........] - ETA: 0s - loss: 0.0529 - accuracy: 0.673111/11 [==============================] - ETA: 0s - loss: 0.0519 - accuracy: 0.670711/11 [==============================] - 0s 25ms/step - loss: 0.0517 - accuracy: 0.6703
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0494 - accuracy: 0.6484 4/11 [=========>....................] - ETA: 0s - loss: 0.0481 - accuracy: 0.6615 7/11 [==================>...........] - ETA: 0s - loss: 0.0471 - accuracy: 0.664610/11 [==========================>...] - ETA: 0s - loss: 0.0469 - accuracy: 0.668811/11 [==============================] - 0s 25ms/step - loss: 0.0468 - accuracy: 0.6707
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0449 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.0445 - accuracy: 0.7235 6/11 [===============>..............] - ETA: 0s - loss: 0.0443 - accuracy: 0.7171 8/11 [====================>.........] - ETA: 0s - loss: 0.0444 - accuracy: 0.712311/11 [==============================] - ETA: 0s - loss: 0.0444 - accuracy: 0.706511/11 [==============================] - 0s 25ms/step - loss: 0.0444 - accuracy: 0.7048
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0472 - accuracy: 0.7422 4/11 [=========>....................] - ETA: 0s - loss: 0.0460 - accuracy: 0.7111 7/11 [==================>...........] - ETA: 0s - loss: 0.0443 - accuracy: 0.7103 9/11 [=======================>......] - ETA: 0s - loss: 0.0438 - accuracy: 0.710211/11 [==============================] - ETA: 0s - loss: 0.0435 - accuracy: 0.708811/11 [==============================] - 0s 26ms/step - loss: 0.0434 - accuracy: 0.7083
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0438 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.0426 - accuracy: 0.6940 6/11 [===============>..............] - ETA: 0s - loss: 0.0420 - accuracy: 0.6945 8/11 [====================>.........] - ETA: 0s - loss: 0.0415 - accuracy: 0.697311/11 [==============================] - ETA: 0s - loss: 0.0411 - accuracy: 0.701411/11 [==============================] - 0s 25ms/step - loss: 0.0410 - accuracy: 0.7023
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0389 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.0393 - accuracy: 0.6966 5/11 [============>.................] - ETA: 0s - loss: 0.0388 - accuracy: 0.6973 7/11 [==================>...........] - ETA: 0s - loss: 0.0385 - accuracy: 0.702710/11 [==========================>...] - ETA: 0s - loss: 0.0385 - accuracy: 0.708011/11 [==============================] - 0s 26ms/step - loss: 0.0384 - accuracy: 0.7099
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0321 - accuracy: 0.7969 4/11 [=========>....................] - ETA: 0s - loss: 0.0359 - accuracy: 0.7575 6/11 [===============>..............] - ETA: 0s - loss: 0.0364 - accuracy: 0.7491 8/11 [====================>.........] - ETA: 0s - loss: 0.0366 - accuracy: 0.745411/11 [==============================] - ETA: 0s - loss: 0.0366 - accuracy: 0.740211/11 [==============================] - 0s 27ms/step - loss: 0.0366 - accuracy: 0.7390
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0340 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.0335 - accuracy: 0.7270 6/11 [===============>..............] - ETA: 0s - loss: 0.0335 - accuracy: 0.7380 9/11 [=======================>......] - ETA: 0s - loss: 0.0339 - accuracy: 0.740611/11 [==============================] - ETA: 0s - loss: 0.0340 - accuracy: 0.741611/11 [==============================] - 0s 26ms/step - loss: 0.0340 - accuracy: 0.7419
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0329 - accuracy: 0.6719 4/11 [=========>....................] - ETA: 0s - loss: 0.0326 - accuracy: 0.6846 6/11 [===============>..............] - ETA: 0s - loss: 0.0326 - accuracy: 0.6924 8/11 [====================>.........] - ETA: 0s - loss: 0.0325 - accuracy: 0.702810/11 [==========================>...] - ETA: 0s - loss: 0.0324 - accuracy: 0.711111/11 [==============================] - 0s 26ms/step - loss: 0.0325 - accuracy: 0.7182
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0300 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.0313 - accuracy: 0.7109 6/11 [===============>..............] - ETA: 0s - loss: 0.0319 - accuracy: 0.7229 8/11 [====================>.........] - ETA: 0s - loss: 0.0318 - accuracy: 0.729910/11 [==========================>...] - ETA: 0s - loss: 0.0317 - accuracy: 0.736811/11 [==============================] - 0s 27ms/step - loss: 0.0316 - accuracy: 0.7414
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0281 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 0s - loss: 0.0284 - accuracy: 0.8103 5/11 [============>.................] - ETA: 0s - loss: 0.0284 - accuracy: 0.7942 8/11 [====================>.........] - ETA: 0s - loss: 0.0287 - accuracy: 0.785010/11 [==========================>...] - ETA: 0s - loss: 0.0288 - accuracy: 0.781711/11 [==============================] - 0s 25ms/step - loss: 0.0289 - accuracy: 0.7806
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0369 - accuracy: 0.80476/6 [==============================] - ETA: 0s - loss: 0.0326 - accuracy: 0.8088 6/6 [==============================] - 5s 11ms/step - loss: 0.0326 - accuracy: 0.8088
2021-12-13 23:27:39.762053: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:27:39.762836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:27:39.762912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:27:39.762978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:27:39.763022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:27:39.763067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:27:39.763117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:27:39.763163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:27:39.763213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:27:39.763264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:27:39.764235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:27:39.764292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:27:39.764310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:27:39.764324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:27:39.765353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:27:39.765828: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:27:39.766349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:27:39.766391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:27:39.766430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:27:39.766470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:27:39.766509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:27:39.766555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:27:39.766600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:27:39.766643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:27:39.766683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:27:39.767663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:27:39.767704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:27:39.767721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:27:39.767734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:27:39.768782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [ 0.04154562  0.69982386  0.89093244 -0.02759168 -0.02728767]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 4 3 0] pred: [-0.0607955   0.52447814  0.942167   -0.04212127 -0.0352096 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 0 4 1] pred: [-0.00328678 -0.02983254  0.9600454   0.02231603 -0.02850142]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [-0.00461104  0.06575441  0.97317225  0.00343706 -0.02053789]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [ 0.02084145  0.13001062  0.9524596   0.0339381  -0.0133281 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 0 4 3 1] pred: [ 0.07015495 -0.17276913  0.9785018  -0.06755045 -0.01444201]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 4 0 1] pred: [-0.07453606 -0.3497814   0.9841037   0.07016239  0.00536262]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [-0.00498718  0.02071985  0.97052515  0.00156349 -0.01120563]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [ 1.5329538e-02  8.8963342e-01  7.7212059e-01  1.3320751e-02
 -3.8083829e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 4 3] pred: [ 0.04964293  0.21333526  0.95941055 -0.06158259 -0.04741491]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [-0.0838232   0.02514949  0.91102374 -0.01928983 -0.02885188]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [-0.00987071  0.8025011   0.8796567  -0.03167423 -0.01627225]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 0 3] pred: [-5.9023347e-02  7.7832729e-01  9.4923836e-01 -1.7527591e-01
  8.8033790e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [ 0.01955922  0.05421721  0.9629619   0.02837718 -0.02731103]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 3 4 0] pred: [-0.08773804  0.9389466   0.6724178   0.12612295  0.00639599]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:29 - loss: 0.2562 - accuracy: 0.2969 3/11 [=======>......................] - ETA: 0s - loss: 0.2435 - accuracy: 0.3628   6/11 [===============>..............] - ETA: 0s - loss: 0.2357 - accuracy: 0.3950 9/11 [=======================>......] - ETA: 0s - loss: 0.2286 - accuracy: 0.406611/11 [==============================] - ETA: 0s - loss: 0.2240 - accuracy: 0.413711/11 [==============================] - 15s 25ms/step - loss: 0.2221 - accuracy: 0.4162
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1493 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.1459 - accuracy: 0.4588 6/11 [===============>..............] - ETA: 0s - loss: 0.1432 - accuracy: 0.4587 9/11 [=======================>......] - ETA: 0s - loss: 0.1391 - accuracy: 0.458011/11 [==============================] - 0s 25ms/step - loss: 0.1358 - accuracy: 0.4581
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1084 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.1087 - accuracy: 0.4486 7/11 [==================>...........] - ETA: 0s - loss: 0.1073 - accuracy: 0.4502 9/11 [=======================>......] - ETA: 0s - loss: 0.1066 - accuracy: 0.452911/11 [==============================] - 0s 25ms/step - loss: 0.1061 - accuracy: 0.4545
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0977 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.0964 - accuracy: 0.4580 6/11 [===============>..............] - ETA: 0s - loss: 0.0964 - accuracy: 0.4549 8/11 [====================>.........] - ETA: 0s - loss: 0.0964 - accuracy: 0.453811/11 [==============================] - ETA: 0s - loss: 0.0960 - accuracy: 0.454611/11 [==============================] - 0s 24ms/step - loss: 0.0959 - accuracy: 0.4551
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0824 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.0834 - accuracy: 0.4683 6/11 [===============>..............] - ETA: 0s - loss: 0.0834 - accuracy: 0.4682 8/11 [====================>.........] - ETA: 0s - loss: 0.0832 - accuracy: 0.471111/11 [==============================] - ETA: 0s - loss: 0.0829 - accuracy: 0.473111/11 [==============================] - 0s 25ms/step - loss: 0.0828 - accuracy: 0.4732
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0731 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.0756 - accuracy: 0.4679 7/11 [==================>...........] - ETA: 0s - loss: 0.0752 - accuracy: 0.4741 9/11 [=======================>......] - ETA: 0s - loss: 0.0747 - accuracy: 0.478211/11 [==============================] - 0s 25ms/step - loss: 0.0742 - accuracy: 0.4840
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0627 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.0658 - accuracy: 0.5777 6/11 [===============>..............] - ETA: 0s - loss: 0.0676 - accuracy: 0.5695 9/11 [=======================>......] - ETA: 0s - loss: 0.0677 - accuracy: 0.566511/11 [==============================] - ETA: 0s - loss: 0.0674 - accuracy: 0.566611/11 [==============================] - 0s 25ms/step - loss: 0.0672 - accuracy: 0.5667
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0518 - accuracy: 0.6562 3/11 [=======>......................] - ETA: 0s - loss: 0.0566 - accuracy: 0.6345 6/11 [===============>..............] - ETA: 0s - loss: 0.0577 - accuracy: 0.6263 8/11 [====================>.........] - ETA: 0s - loss: 0.0582 - accuracy: 0.622611/11 [==============================] - ETA: 0s - loss: 0.0586 - accuracy: 0.621111/11 [==============================] - 0s 25ms/step - loss: 0.0587 - accuracy: 0.6206
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0556 - accuracy: 0.6641 4/11 [=========>....................] - ETA: 0s - loss: 0.0586 - accuracy: 0.6691 7/11 [==================>...........] - ETA: 0s - loss: 0.0582 - accuracy: 0.665610/11 [==========================>...] - ETA: 0s - loss: 0.0576 - accuracy: 0.664511/11 [==============================] - 0s 25ms/step - loss: 0.0572 - accuracy: 0.6638
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0538 - accuracy: 0.7422 4/11 [=========>....................] - ETA: 0s - loss: 0.0533 - accuracy: 0.7215 7/11 [==================>...........] - ETA: 0s - loss: 0.0530 - accuracy: 0.7067 9/11 [=======================>......] - ETA: 0s - loss: 0.0526 - accuracy: 0.701411/11 [==============================] - 0s 23ms/step - loss: 0.0524 - accuracy: 0.6943
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0456 - accuracy: 0.6484 4/11 [=========>....................] - ETA: 0s - loss: 0.0474 - accuracy: 0.6759 6/11 [===============>..............] - ETA: 0s - loss: 0.0483 - accuracy: 0.6790 8/11 [====================>.........] - ETA: 0s - loss: 0.0484 - accuracy: 0.679211/11 [==============================] - ETA: 0s - loss: 0.0485 - accuracy: 0.680711/11 [==============================] - 0s 24ms/step - loss: 0.0486 - accuracy: 0.6813
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0425 - accuracy: 0.7344 4/11 [=========>....................] - ETA: 0s - loss: 0.0436 - accuracy: 0.7292 6/11 [===============>..............] - ETA: 0s - loss: 0.0440 - accuracy: 0.7241 9/11 [=======================>......] - ETA: 0s - loss: 0.0445 - accuracy: 0.717811/11 [==============================] - 0s 24ms/step - loss: 0.0449 - accuracy: 0.7140
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0478 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.0458 - accuracy: 0.7235 7/11 [==================>...........] - ETA: 0s - loss: 0.0450 - accuracy: 0.7163 9/11 [=======================>......] - ETA: 0s - loss: 0.0448 - accuracy: 0.716111/11 [==============================] - 0s 24ms/step - loss: 0.0445 - accuracy: 0.7161
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0369 - accuracy: 0.7109 4/11 [=========>....................] - ETA: 0s - loss: 0.0400 - accuracy: 0.7137 7/11 [==================>...........] - ETA: 0s - loss: 0.0405 - accuracy: 0.7174 9/11 [=======================>......] - ETA: 0s - loss: 0.0407 - accuracy: 0.717911/11 [==============================] - 0s 24ms/step - loss: 0.0408 - accuracy: 0.7182
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0369 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.0374 - accuracy: 0.7878 5/11 [============>.................] - ETA: 0s - loss: 0.0375 - accuracy: 0.7873 7/11 [==================>...........] - ETA: 0s - loss: 0.0379 - accuracy: 0.785910/11 [==========================>...] - ETA: 0s - loss: 0.0383 - accuracy: 0.785511/11 [==============================] - 0s 26ms/step - loss: 0.0384 - accuracy: 0.7836
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0357 - accuracy: 0.7734 4/11 [=========>....................] - ETA: 0s - loss: 0.0381 - accuracy: 0.7594 6/11 [===============>..............] - ETA: 0s - loss: 0.0384 - accuracy: 0.7612 8/11 [====================>.........] - ETA: 0s - loss: 0.0381 - accuracy: 0.765311/11 [==============================] - ETA: 0s - loss: 0.0377 - accuracy: 0.771011/11 [==============================] - 0s 26ms/step - loss: 0.0375 - accuracy: 0.7723
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0377 - accuracy: 0.7969 4/11 [=========>....................] - ETA: 0s - loss: 0.0348 - accuracy: 0.7879 7/11 [==================>...........] - ETA: 0s - loss: 0.0341 - accuracy: 0.7821 9/11 [=======================>......] - ETA: 0s - loss: 0.0341 - accuracy: 0.777511/11 [==============================] - ETA: 0s - loss: 0.0340 - accuracy: 0.774211/11 [==============================] - 0s 25ms/step - loss: 0.0340 - accuracy: 0.7734
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0350 - accuracy: 0.8594 3/11 [=======>......................] - ETA: 0s - loss: 0.0339 - accuracy: 0.8702 6/11 [===============>..............] - ETA: 0s - loss: 0.0338 - accuracy: 0.8660 9/11 [=======================>......] - ETA: 0s - loss: 0.0335 - accuracy: 0.852611/11 [==============================] - 0s 25ms/step - loss: 0.0331 - accuracy: 0.8449
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0264 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.0280 - accuracy: 0.8207 6/11 [===============>..............] - ETA: 0s - loss: 0.0287 - accuracy: 0.8277 8/11 [====================>.........] - ETA: 0s - loss: 0.0289 - accuracy: 0.829410/11 [==========================>...] - ETA: 0s - loss: 0.0290 - accuracy: 0.828311/11 [==============================] - 0s 26ms/step - loss: 0.0290 - accuracy: 0.8273
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0284 - accuracy: 0.8594 4/11 [=========>....................] - ETA: 0s - loss: 0.0291 - accuracy: 0.8327 6/11 [===============>..............] - ETA: 0s - loss: 0.0290 - accuracy: 0.8293 8/11 [====================>.........] - ETA: 0s - loss: 0.0288 - accuracy: 0.830811/11 [==============================] - ETA: 0s - loss: 0.0286 - accuracy: 0.832711/11 [==============================] - 0s 24ms/step - loss: 0.0285 - accuracy: 0.8331
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0272 - accuracy: 0.89846/6 [==============================] - 5s 10ms/step - loss: 0.0327 - accuracy: 0.8938
2021-12-13 23:28:15.896689: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:28:15.897318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:28:15.897385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:28:15.897434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:28:15.897470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:28:15.897506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:28:15.897542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:28:15.897575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:28:15.897620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:28:15.897655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:28:15.898382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:28:15.898425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:28:15.898437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:28:15.898446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:28:15.899193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:28:15.899473: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:28:15.899842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:28:15.899871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:28:15.899899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:28:15.899946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:28:15.899986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:28:15.900013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:28:15.900043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:28:15.900070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:28:15.900099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:28:15.900772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:28:15.900800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:28:15.900811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:28:15.900820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:28:15.901534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 4 3 0] pred: [-0.13438831  0.9814428   0.57428867 -0.01443624  0.00674515]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 0 2 4 3] pred: [ 0.4197767   0.7164259   0.33503404 -0.24920492 -0.06606762]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 4 1 0 3] pred: [-0.03170684 -0.0213983   0.98709077 -0.0820742  -0.01280884]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 4 0 3 1] pred: [-6.9724829e-03 -2.1090211e-01  9.7840077e-01 -9.9849999e-02
 -4.4685593e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 0 1 4 3] pred: [ 0.0147705   0.00231048  0.98186773 -0.05046363 -0.04998661]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [-0.00570649  0.08370025  0.96732384  0.006359   -0.00933237]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 3 0 4] pred: [ 0.0325799   0.8961395   0.34152007  0.05187048 -0.02326142]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [3 2 4 1 0] pred: [-0.00516882  0.03152967  0.16444567  0.76252526  0.05027933]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 4 3] pred: [-0.0326957  -0.00377792  0.9877793  -0.06430835 -0.03295422]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 0 3 4 1] pred: [ 0.3192806  -0.16521214  0.8538373   0.18202762 -0.02227895]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [ 0.02352011  0.80336714  0.66007     0.00272115 -0.03063176]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [0 1 3 2 4] pred: [ 0.6754492   0.09538809  0.07059257  0.08099499 -0.03846801]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [ 0.04327994  0.4063366   0.9374929  -0.03387648 -0.03838989]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 4 3 0] pred: [-0.08207288  0.9468879   0.77091527 -0.04963983 -0.01952358]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [ 0.10810281  0.57683665  0.86580795  0.03865017 -0.01769043]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:38 - loss: 0.2590 - accuracy: 0.0781 3/11 [=======>......................] - ETA: 0s - loss: 0.2530 - accuracy: 0.2161   5/11 [============>.................] - ETA: 0s - loss: 0.2482 - accuracy: 0.2863 8/11 [====================>.........] - ETA: 0s - loss: 0.2414 - accuracy: 0.339410/11 [==========================>...] - ETA: 0s - loss: 0.2368 - accuracy: 0.360511/11 [==============================] - 16s 27ms/step - loss: 0.2328 - accuracy: 0.3765
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1592 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.1567 - accuracy: 0.5030 5/11 [============>.................] - ETA: 0s - loss: 0.1536 - accuracy: 0.4929 7/11 [==================>...........] - ETA: 0s - loss: 0.1506 - accuracy: 0.485610/11 [==========================>...] - ETA: 0s - loss: 0.1466 - accuracy: 0.478811/11 [==============================] - 0s 26ms/step - loss: 0.1444 - accuracy: 0.4764
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1081 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.1061 - accuracy: 0.4470 5/11 [============>.................] - ETA: 0s - loss: 0.1056 - accuracy: 0.4567 8/11 [====================>.........] - ETA: 0s - loss: 0.1051 - accuracy: 0.458010/11 [==========================>...] - ETA: 0s - loss: 0.1047 - accuracy: 0.458711/11 [==============================] - 0s 26ms/step - loss: 0.1043 - accuracy: 0.4582
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1025 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.1009 - accuracy: 0.4432 6/11 [===============>..............] - ETA: 0s - loss: 0.0984 - accuracy: 0.4488 9/11 [=======================>......] - ETA: 0s - loss: 0.0960 - accuracy: 0.455411/11 [==============================] - 0s 26ms/step - loss: 0.0951 - accuracy: 0.4581
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1001 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.0909 - accuracy: 0.4569 6/11 [===============>..............] - ETA: 0s - loss: 0.0886 - accuracy: 0.4678 8/11 [====================>.........] - ETA: 0s - loss: 0.0872 - accuracy: 0.475910/11 [==========================>...] - ETA: 0s - loss: 0.0860 - accuracy: 0.483811/11 [==============================] - 0s 25ms/step - loss: 0.0851 - accuracy: 0.4896
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0765 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.0768 - accuracy: 0.5616 5/11 [============>.................] - ETA: 0s - loss: 0.0762 - accuracy: 0.5562 8/11 [====================>.........] - ETA: 0s - loss: 0.0754 - accuracy: 0.552310/11 [==========================>...] - ETA: 0s - loss: 0.0747 - accuracy: 0.552411/11 [==============================] - 0s 25ms/step - loss: 0.0740 - accuracy: 0.5529
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0695 - accuracy: 0.5547 4/11 [=========>....................] - ETA: 0s - loss: 0.0672 - accuracy: 0.5711 7/11 [==================>...........] - ETA: 0s - loss: 0.0668 - accuracy: 0.5716 9/11 [=======================>......] - ETA: 0s - loss: 0.0666 - accuracy: 0.572711/11 [==============================] - ETA: 0s - loss: 0.0664 - accuracy: 0.574711/11 [==============================] - 0s 25ms/step - loss: 0.0663 - accuracy: 0.5756
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0660 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.0634 - accuracy: 0.5781 6/11 [===============>..............] - ETA: 0s - loss: 0.0616 - accuracy: 0.5845 8/11 [====================>.........] - ETA: 0s - loss: 0.0611 - accuracy: 0.586810/11 [==========================>...] - ETA: 0s - loss: 0.0607 - accuracy: 0.588911/11 [==============================] - 0s 25ms/step - loss: 0.0605 - accuracy: 0.5913
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0576 - accuracy: 0.6250 4/11 [=========>....................] - ETA: 0s - loss: 0.0588 - accuracy: 0.6279 6/11 [===============>..............] - ETA: 0s - loss: 0.0581 - accuracy: 0.6274 8/11 [====================>.........] - ETA: 0s - loss: 0.0575 - accuracy: 0.626510/11 [==========================>...] - ETA: 0s - loss: 0.0571 - accuracy: 0.627611/11 [==============================] - 0s 25ms/step - loss: 0.0568 - accuracy: 0.6277
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0562 - accuracy: 0.6094 4/11 [=========>....................] - ETA: 0s - loss: 0.0524 - accuracy: 0.6294 7/11 [==================>...........] - ETA: 0s - loss: 0.0518 - accuracy: 0.628410/11 [==========================>...] - ETA: 0s - loss: 0.0516 - accuracy: 0.629711/11 [==============================] - 0s 24ms/step - loss: 0.0516 - accuracy: 0.6307
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0473 - accuracy: 0.6328 4/11 [=========>....................] - ETA: 0s - loss: 0.0490 - accuracy: 0.6287 7/11 [==================>...........] - ETA: 0s - loss: 0.0487 - accuracy: 0.6311 9/11 [=======================>......] - ETA: 0s - loss: 0.0486 - accuracy: 0.632111/11 [==============================] - 0s 25ms/step - loss: 0.0486 - accuracy: 0.6335
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0460 - accuracy: 0.7109 3/11 [=======>......................] - ETA: 0s - loss: 0.0491 - accuracy: 0.6836 5/11 [============>.................] - ETA: 0s - loss: 0.0485 - accuracy: 0.6694 8/11 [====================>.........] - ETA: 0s - loss: 0.0478 - accuracy: 0.661610/11 [==========================>...] - ETA: 0s - loss: 0.0475 - accuracy: 0.659211/11 [==============================] - 0s 26ms/step - loss: 0.0473 - accuracy: 0.6586
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0468 - accuracy: 0.6484 4/11 [=========>....................] - ETA: 0s - loss: 0.0456 - accuracy: 0.6496 7/11 [==================>...........] - ETA: 0s - loss: 0.0452 - accuracy: 0.6601 9/11 [=======================>......] - ETA: 0s - loss: 0.0450 - accuracy: 0.662411/11 [==============================] - ETA: 0s - loss: 0.0448 - accuracy: 0.663411/11 [==============================] - 0s 25ms/step - loss: 0.0447 - accuracy: 0.6639
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0314 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.0372 - accuracy: 0.7163 6/11 [===============>..............] - ETA: 0s - loss: 0.0385 - accuracy: 0.7065 8/11 [====================>.........] - ETA: 0s - loss: 0.0391 - accuracy: 0.700711/11 [==============================] - ETA: 0s - loss: 0.0398 - accuracy: 0.693511/11 [==============================] - 0s 25ms/step - loss: 0.0400 - accuracy: 0.6919
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0424 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.0416 - accuracy: 0.7370 6/11 [===============>..............] - ETA: 0s - loss: 0.0415 - accuracy: 0.7252 8/11 [====================>.........] - ETA: 0s - loss: 0.0411 - accuracy: 0.720611/11 [==============================] - ETA: 0s - loss: 0.0407 - accuracy: 0.716011/11 [==============================] - 0s 27ms/step - loss: 0.0407 - accuracy: 0.7149
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0399 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.0403 - accuracy: 0.6997 5/11 [============>.................] - ETA: 0s - loss: 0.0402 - accuracy: 0.7049 7/11 [==================>...........] - ETA: 0s - loss: 0.0399 - accuracy: 0.704010/11 [==========================>...] - ETA: 0s - loss: 0.0394 - accuracy: 0.704411/11 [==============================] - 0s 25ms/step - loss: 0.0391 - accuracy: 0.7047
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0322 - accuracy: 0.7500 4/11 [=========>....................] - ETA: 0s - loss: 0.0349 - accuracy: 0.7625 6/11 [===============>..............] - ETA: 0s - loss: 0.0351 - accuracy: 0.7618 8/11 [====================>.........] - ETA: 0s - loss: 0.0355 - accuracy: 0.761110/11 [==========================>...] - ETA: 0s - loss: 0.0356 - accuracy: 0.761311/11 [==============================] - 0s 25ms/step - loss: 0.0357 - accuracy: 0.7611
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0381 - accuracy: 0.6875 4/11 [=========>....................] - ETA: 0s - loss: 0.0352 - accuracy: 0.7391 7/11 [==================>...........] - ETA: 0s - loss: 0.0337 - accuracy: 0.746110/11 [==========================>...] - ETA: 0s - loss: 0.0334 - accuracy: 0.748811/11 [==============================] - 0s 25ms/step - loss: 0.0335 - accuracy: 0.7510
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0296 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.0306 - accuracy: 0.7461 6/11 [===============>..............] - ETA: 0s - loss: 0.0308 - accuracy: 0.7632 8/11 [====================>.........] - ETA: 0s - loss: 0.0310 - accuracy: 0.771110/11 [==========================>...] - ETA: 0s - loss: 0.0311 - accuracy: 0.775711/11 [==============================] - 0s 25ms/step - loss: 0.0312 - accuracy: 0.7795
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0242 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.0265 - accuracy: 0.8338 6/11 [===============>..............] - ETA: 0s - loss: 0.0281 - accuracy: 0.8147 8/11 [====================>.........] - ETA: 0s - loss: 0.0284 - accuracy: 0.811510/11 [==========================>...] - ETA: 0s - loss: 0.0285 - accuracy: 0.808711/11 [==============================] - 0s 25ms/step - loss: 0.0286 - accuracy: 0.8072
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0289 - accuracy: 0.83596/6 [==============================] - 5s 9ms/step - loss: 0.0289 - accuracy: 0.8598
2021-12-13 23:28:51.784107: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:28:51.784919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:28:51.785003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:28:51.785064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:28:51.785104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:28:51.785155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:28:51.785201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:28:51.785245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:28:51.785290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:28:51.785336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:28:51.786261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:28:51.786315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:28:51.786332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:28:51.786345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:28:51.787327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:28:51.787737: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:28:51.788548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:28:51.788589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:28:51.788628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:28:51.788667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:28:51.788705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:28:51.788743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:28:51.788781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:28:51.788819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:28:51.788856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:28:51.790376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:28:51.790415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:28:51.790432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:28:51.790444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:28:51.791446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 0 2 4 3] pred: [ 0.27755472  0.82408047  0.03287768 -0.07412315 -0.0490606 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [0 1 3 4 2] pred: [ 0.7615603   0.24849822 -0.13858756  0.08836138 -0.01300386]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 4 0] pred: [-0.1289146   0.04935335  0.80367637  0.22304724 -0.05248433]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 0 1 4 3] pred: [ 1.3719551e-02  3.6444515e-04  9.9121040e-01 -3.4630280e-02
 -2.9414061e-02]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [ 0.07762378  0.6728811   0.82816774  0.0087848  -0.03008405]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [ 0.00945859  0.0550336   0.9809922   0.0206854  -0.03890476]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 0 3] pred: [-0.02020774  0.64407307  0.9502455  -0.06776999  0.01093966]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [0 1 3 4 2] pred: [ 0.7397771   0.21587823 -0.2743013  -0.00179273 -0.05810897]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 4 1 0] pred: [-0.05876598 -0.05450863  0.9375019   0.05723023 -0.00800768]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 4 3 0] pred: [-0.09173486  0.9346774   0.6271484   0.00328785  0.01098688]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [4.4855375e-02 5.4489899e-01 8.6774796e-01 4.3243833e-02 8.5435034e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [ 0.09992933  0.4411437   0.8896332   0.02913426 -0.00914185]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [4 3 1 2 0] pred: [-0.04848161  0.10277469  0.00823011  0.36201304  0.8205531 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [ 0.08093479  0.7786348   0.8247716   0.02288028 -0.01600732]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 3 0 4] pred: [-0.01190378  0.78180534  0.53995895  0.05744318 -0.03246193]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:32 - loss: 0.2457 - accuracy: 0.3359 3/11 [=======>......................] - ETA: 0s - loss: 0.2415 - accuracy: 0.3689   6/11 [===============>..............] - ETA: 0s - loss: 0.2336 - accuracy: 0.3920 9/11 [=======================>......] - ETA: 0s - loss: 0.2256 - accuracy: 0.406911/11 [==============================] - 15s 25ms/step - loss: 0.2189 - accuracy: 0.4152
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1456 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.1432 - accuracy: 0.4661 6/11 [===============>..............] - ETA: 0s - loss: 0.1397 - accuracy: 0.4580 8/11 [====================>.........] - ETA: 0s - loss: 0.1377 - accuracy: 0.455611/11 [==============================] - ETA: 0s - loss: 0.1351 - accuracy: 0.451811/11 [==============================] - 0s 25ms/step - loss: 0.1344 - accuracy: 0.4510
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1001 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.1049 - accuracy: 0.4319 6/11 [===============>..............] - ETA: 0s - loss: 0.1080 - accuracy: 0.4327 8/11 [====================>.........] - ETA: 0s - loss: 0.1087 - accuracy: 0.435711/11 [==============================] - ETA: 0s - loss: 0.1090 - accuracy: 0.437611/11 [==============================] - 0s 25ms/step - loss: 0.1091 - accuracy: 0.4380
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1132 - accuracy: 0.4141 4/11 [=========>....................] - ETA: 0s - loss: 0.1066 - accuracy: 0.4287 7/11 [==================>...........] - ETA: 0s - loss: 0.1044 - accuracy: 0.4366 9/11 [=======================>......] - ETA: 0s - loss: 0.1035 - accuracy: 0.439711/11 [==============================] - 0s 25ms/step - loss: 0.1028 - accuracy: 0.4427
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0887 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.0886 - accuracy: 0.4839 5/11 [============>.................] - ETA: 0s - loss: 0.0888 - accuracy: 0.4851 8/11 [====================>.........] - ETA: 0s - loss: 0.0891 - accuracy: 0.483911/11 [==============================] - ETA: 0s - loss: 0.0893 - accuracy: 0.482111/11 [==============================] - 0s 25ms/step - loss: 0.0893 - accuracy: 0.4818
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0947 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.0898 - accuracy: 0.4410 5/11 [============>.................] - ETA: 0s - loss: 0.0867 - accuracy: 0.4546 7/11 [==================>...........] - ETA: 0s - loss: 0.0848 - accuracy: 0.4638 9/11 [=======================>......] - ETA: 0s - loss: 0.0833 - accuracy: 0.472811/11 [==============================] - ETA: 0s - loss: 0.0821 - accuracy: 0.480711/11 [==============================] - 0s 26ms/step - loss: 0.0817 - accuracy: 0.4839
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0701 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.0701 - accuracy: 0.5382 5/11 [============>.................] - ETA: 0s - loss: 0.0686 - accuracy: 0.5507 7/11 [==================>...........] - ETA: 0s - loss: 0.0680 - accuracy: 0.557510/11 [==========================>...] - ETA: 0s - loss: 0.0672 - accuracy: 0.564411/11 [==============================] - 0s 24ms/step - loss: 0.0670 - accuracy: 0.5676
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0636 - accuracy: 0.6484 4/11 [=========>....................] - ETA: 0s - loss: 0.0616 - accuracy: 0.6248 7/11 [==================>...........] - ETA: 0s - loss: 0.0608 - accuracy: 0.624110/11 [==========================>...] - ETA: 0s - loss: 0.0601 - accuracy: 0.621411/11 [==============================] - 0s 25ms/step - loss: 0.0599 - accuracy: 0.6203
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0510 - accuracy: 0.6484 4/11 [=========>....................] - ETA: 0s - loss: 0.0533 - accuracy: 0.6344 7/11 [==================>...........] - ETA: 0s - loss: 0.0541 - accuracy: 0.616410/11 [==========================>...] - ETA: 0s - loss: 0.0540 - accuracy: 0.615911/11 [==============================] - 0s 25ms/step - loss: 0.0539 - accuracy: 0.6165
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0539 - accuracy: 0.6016 4/11 [=========>....................] - ETA: 0s - loss: 0.0523 - accuracy: 0.6045 6/11 [===============>..............] - ETA: 0s - loss: 0.0515 - accuracy: 0.6050 9/11 [=======================>......] - ETA: 0s - loss: 0.0508 - accuracy: 0.611411/11 [==============================] - 0s 24ms/step - loss: 0.0505 - accuracy: 0.6159
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0472 - accuracy: 0.6172 3/11 [=======>......................] - ETA: 0s - loss: 0.0463 - accuracy: 0.6428 5/11 [============>.................] - ETA: 0s - loss: 0.0467 - accuracy: 0.6453 8/11 [====================>.........] - ETA: 0s - loss: 0.0468 - accuracy: 0.643411/11 [==============================] - ETA: 0s - loss: 0.0468 - accuracy: 0.642611/11 [==============================] - 0s 24ms/step - loss: 0.0468 - accuracy: 0.6421
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0472 - accuracy: 0.5547 4/11 [=========>....................] - ETA: 0s - loss: 0.0463 - accuracy: 0.5923 6/11 [===============>..............] - ETA: 0s - loss: 0.0458 - accuracy: 0.6041 8/11 [====================>.........] - ETA: 0s - loss: 0.0457 - accuracy: 0.614411/11 [==============================] - ETA: 0s - loss: 0.0453 - accuracy: 0.626011/11 [==============================] - 0s 24ms/step - loss: 0.0452 - accuracy: 0.6285
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0434 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.0431 - accuracy: 0.6081 5/11 [============>.................] - ETA: 0s - loss: 0.0432 - accuracy: 0.6189 7/11 [==================>...........] - ETA: 0s - loss: 0.0431 - accuracy: 0.627510/11 [==========================>...] - ETA: 0s - loss: 0.0430 - accuracy: 0.636911/11 [==============================] - 0s 25ms/step - loss: 0.0428 - accuracy: 0.6412
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0368 - accuracy: 0.7031 3/11 [=======>......................] - ETA: 0s - loss: 0.0400 - accuracy: 0.6875 5/11 [============>.................] - ETA: 0s - loss: 0.0408 - accuracy: 0.6888 7/11 [==================>...........] - ETA: 0s - loss: 0.0411 - accuracy: 0.6892 9/11 [=======================>......] - ETA: 0s - loss: 0.0411 - accuracy: 0.688011/11 [==============================] - 0s 25ms/step - loss: 0.0410 - accuracy: 0.6848
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0386 - accuracy: 0.6875 4/11 [=========>....................] - ETA: 0s - loss: 0.0386 - accuracy: 0.6911 7/11 [==================>...........] - ETA: 0s - loss: 0.0389 - accuracy: 0.6998 9/11 [=======================>......] - ETA: 0s - loss: 0.0390 - accuracy: 0.705811/11 [==============================] - 0s 25ms/step - loss: 0.0390 - accuracy: 0.7130
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0364 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.0381 - accuracy: 0.6493 6/11 [===============>..............] - ETA: 0s - loss: 0.0379 - accuracy: 0.6645 8/11 [====================>.........] - ETA: 0s - loss: 0.0380 - accuracy: 0.670411/11 [==============================] - ETA: 0s - loss: 0.0379 - accuracy: 0.678811/11 [==============================] - 0s 25ms/step - loss: 0.0379 - accuracy: 0.6812
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0383 - accuracy: 0.7969 4/11 [=========>....................] - ETA: 0s - loss: 0.0372 - accuracy: 0.7904 7/11 [==================>...........] - ETA: 0s - loss: 0.0364 - accuracy: 0.783010/11 [==========================>...] - ETA: 0s - loss: 0.0363 - accuracy: 0.779311/11 [==============================] - 0s 24ms/step - loss: 0.0362 - accuracy: 0.7783
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0362 - accuracy: 0.7578 4/11 [=========>....................] - ETA: 0s - loss: 0.0346 - accuracy: 0.7760 7/11 [==================>...........] - ETA: 0s - loss: 0.0339 - accuracy: 0.7760 9/11 [=======================>......] - ETA: 0s - loss: 0.0337 - accuracy: 0.779211/11 [==============================] - 0s 24ms/step - loss: 0.0337 - accuracy: 0.7802
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0423 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.0372 - accuracy: 0.7812 6/11 [===============>..............] - ETA: 0s - loss: 0.0357 - accuracy: 0.7854 8/11 [====================>.........] - ETA: 0s - loss: 0.0352 - accuracy: 0.788510/11 [==========================>...] - ETA: 0s - loss: 0.0346 - accuracy: 0.791111/11 [==============================] - 0s 25ms/step - loss: 0.0342 - accuracy: 0.7939
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0274 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.0290 - accuracy: 0.8390 6/11 [===============>..............] - ETA: 0s - loss: 0.0296 - accuracy: 0.8400 9/11 [=======================>......] - ETA: 0s - loss: 0.0297 - accuracy: 0.839811/11 [==============================] - 0s 24ms/step - loss: 0.0298 - accuracy: 0.8404
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.0303 - accuracy: 0.82036/6 [==============================] - 5s 10ms/step - loss: 0.0322 - accuracy: 0.8314
2021-12-13 23:29:27.905451: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:29:27.906296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:29:27.906370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:29:27.906426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:29:27.906467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:29:27.906512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:29:27.906561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:29:27.906607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:29:27.906662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:29:27.906714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:29:27.907678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:29:27.907738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:29:27.907755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:29:27.907769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:29:27.908815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:29:27.909530: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:29:27.909901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:29:27.909937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:29:27.909966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:29:27.909993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:29:27.910018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:29:27.910048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:29:27.910077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:29:27.910104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:29:27.910133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:29:27.910806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:29:27.910834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:29:27.910845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:29:27.910854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:29:27.911567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 4 0 3] pred: [ 0.0222879   0.89314044  0.72908485 -0.03195247  0.0391023 ]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 4 3 1 0] pred: [-0.09707745 -0.05738863  0.98836255 -0.038484    0.04539042]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 3 0 4] pred: [-0.00469703  0.8453843   0.73005444  0.01149335 -0.01002652]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 4 0 3 1] pred: [ 6.8486007e-03 -2.1788800e-02  9.8308361e-01 -6.0041604e-04
  2.6243385e-02]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [0.00324501 0.02792398 0.9802643  0.00640768 0.00102749]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [4 3 0 1 2] pred: [0.04646577 0.04509619 0.04469201 0.19360727 0.86563164]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [4 3 0 1 2] pred: [-0.01913488 -0.08359903 -0.23886281  0.4171438   0.87873703]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [ 0.0798742   0.40592897  0.8915614   0.03592422 -0.03487544]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 3 4 0] pred: [-0.0075437   0.94347     0.5623495   0.05177347  0.00206335]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [ 0.0270083   0.8221977   0.7818284   0.02239774 -0.00613195]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 4 0 1] pred: [-0.00292995 -0.02101225  0.9802598   0.01255703  0.00161127]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 4 3 0] pred: [-0.09788335  0.8258782   0.75166875 -0.04979761  0.00164538]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 0 3] pred: [ 0.02470856  0.76904327  0.8417958  -0.03208885  0.04268964]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 0 1 4] pred: [ 0.05528439  0.01230954  0.9494462   0.08802368 -0.05296954]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 3 0 4] pred: [ 0.03030584  0.88099706  0.8122931   0.07011403 -0.02518106]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:30 - loss: 0.2445 - accuracy: 0.3047 3/11 [=======>......................] - ETA: 0s - loss: 0.2448 - accuracy: 0.3681   6/11 [===============>..............] - ETA: 0s - loss: 0.2405 - accuracy: 0.3974 9/11 [=======================>......] - ETA: 0s - loss: 0.2346 - accuracy: 0.409811/11 [==============================] - ETA: 0s - loss: 0.2306 - accuracy: 0.414311/11 [==============================] - 15s 24ms/step - loss: 0.2291 - accuracy: 0.4161
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1588 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.1568 - accuracy: 0.4466 6/11 [===============>..............] - ETA: 0s - loss: 0.1517 - accuracy: 0.4506 9/11 [=======================>......] - ETA: 0s - loss: 0.1470 - accuracy: 0.452111/11 [==============================] - 0s 25ms/step - loss: 0.1431 - accuracy: 0.4527
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1002 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.1030 - accuracy: 0.4813 6/11 [===============>..............] - ETA: 0s - loss: 0.1031 - accuracy: 0.4791 9/11 [=======================>......] - ETA: 0s - loss: 0.1036 - accuracy: 0.473011/11 [==============================] - 0s 23ms/step - loss: 0.1036 - accuracy: 0.4689
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0973 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.0966 - accuracy: 0.4783 6/11 [===============>..............] - ETA: 0s - loss: 0.0955 - accuracy: 0.4773 9/11 [=======================>......] - ETA: 0s - loss: 0.0953 - accuracy: 0.472011/11 [==============================] - 0s 23ms/step - loss: 0.0949 - accuracy: 0.4698
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0814 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.0822 - accuracy: 0.4871 7/11 [==================>...........] - ETA: 0s - loss: 0.0818 - accuracy: 0.4851 9/11 [=======================>......] - ETA: 0s - loss: 0.0816 - accuracy: 0.485611/11 [==============================] - 0s 24ms/step - loss: 0.0813 - accuracy: 0.4876
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0780 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.0743 - accuracy: 0.5029 7/11 [==================>...........] - ETA: 0s - loss: 0.0727 - accuracy: 0.516810/11 [==========================>...] - ETA: 0s - loss: 0.0719 - accuracy: 0.527811/11 [==============================] - 0s 24ms/step - loss: 0.0714 - accuracy: 0.5336
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0575 - accuracy: 0.6562 3/11 [=======>......................] - ETA: 0s - loss: 0.0595 - accuracy: 0.6502 6/11 [===============>..............] - ETA: 0s - loss: 0.0601 - accuracy: 0.6406 8/11 [====================>.........] - ETA: 0s - loss: 0.0606 - accuracy: 0.635311/11 [==============================] - ETA: 0s - loss: 0.0608 - accuracy: 0.632611/11 [==============================] - 0s 24ms/step - loss: 0.0609 - accuracy: 0.6323
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0608 - accuracy: 0.6250 4/11 [=========>....................] - ETA: 0s - loss: 0.0596 - accuracy: 0.6369 6/11 [===============>..............] - ETA: 0s - loss: 0.0587 - accuracy: 0.6413 9/11 [=======================>......] - ETA: 0s - loss: 0.0579 - accuracy: 0.648011/11 [==============================] - 0s 24ms/step - loss: 0.0573 - accuracy: 0.6495
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0521 - accuracy: 0.6641 3/11 [=======>......................] - ETA: 0s - loss: 0.0515 - accuracy: 0.6389 6/11 [===============>..............] - ETA: 0s - loss: 0.0510 - accuracy: 0.6443 8/11 [====================>.........] - ETA: 0s - loss: 0.0510 - accuracy: 0.646411/11 [==============================] - ETA: 0s - loss: 0.0510 - accuracy: 0.648811/11 [==============================] - 0s 24ms/step - loss: 0.0510 - accuracy: 0.6495
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0450 - accuracy: 0.6094 3/11 [=======>......................] - ETA: 0s - loss: 0.0474 - accuracy: 0.6298 6/11 [===============>..............] - ETA: 0s - loss: 0.0484 - accuracy: 0.6401 8/11 [====================>.........] - ETA: 0s - loss: 0.0485 - accuracy: 0.644611/11 [==============================] - ETA: 0s - loss: 0.0485 - accuracy: 0.648811/11 [==============================] - 0s 25ms/step - loss: 0.0484 - accuracy: 0.6497
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0482 - accuracy: 0.6406 4/11 [=========>....................] - ETA: 0s - loss: 0.0475 - accuracy: 0.6611 7/11 [==================>...........] - ETA: 0s - loss: 0.0472 - accuracy: 0.6728 9/11 [=======================>......] - ETA: 0s - loss: 0.0470 - accuracy: 0.675111/11 [==============================] - ETA: 0s - loss: 0.0467 - accuracy: 0.676511/11 [==============================] - 0s 25ms/step - loss: 0.0466 - accuracy: 0.6771
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0435 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.0434 - accuracy: 0.6974 6/11 [===============>..............] - ETA: 0s - loss: 0.0436 - accuracy: 0.6890 8/11 [====================>.........] - ETA: 0s - loss: 0.0438 - accuracy: 0.688911/11 [==============================] - ETA: 0s - loss: 0.0436 - accuracy: 0.692511/11 [==============================] - 0s 24ms/step - loss: 0.0436 - accuracy: 0.6935
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0407 - accuracy: 0.7031 4/11 [=========>....................] - ETA: 0s - loss: 0.0417 - accuracy: 0.7035 7/11 [==================>...........] - ETA: 0s - loss: 0.0417 - accuracy: 0.7038 9/11 [=======================>......] - ETA: 0s - loss: 0.0416 - accuracy: 0.706211/11 [==============================] - 0s 24ms/step - loss: 0.0415 - accuracy: 0.7080
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0389 - accuracy: 0.7344 4/11 [=========>....................] - ETA: 0s - loss: 0.0396 - accuracy: 0.7493 6/11 [===============>..............] - ETA: 0s - loss: 0.0389 - accuracy: 0.7500 9/11 [=======================>......] - ETA: 0s - loss: 0.0388 - accuracy: 0.750711/11 [==============================] - 0s 24ms/step - loss: 0.0389 - accuracy: 0.7503
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0336 - accuracy: 0.7500 3/11 [=======>......................] - ETA: 0s - loss: 0.0352 - accuracy: 0.7548 6/11 [===============>..............] - ETA: 0s - loss: 0.0358 - accuracy: 0.7607 9/11 [=======================>......] - ETA: 0s - loss: 0.0362 - accuracy: 0.764711/11 [==============================] - ETA: 0s - loss: 0.0363 - accuracy: 0.766811/11 [==============================] - 0s 26ms/step - loss: 0.0364 - accuracy: 0.7676
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0365 - accuracy: 0.7500 4/11 [=========>....................] - ETA: 0s - loss: 0.0386 - accuracy: 0.7502 6/11 [===============>..............] - ETA: 0s - loss: 0.0381 - accuracy: 0.7535 8/11 [====================>.........] - ETA: 0s - loss: 0.0377 - accuracy: 0.761011/11 [==============================] - ETA: 0s - loss: 0.0372 - accuracy: 0.765811/11 [==============================] - 0s 24ms/step - loss: 0.0370 - accuracy: 0.7668
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0361 - accuracy: 0.7031 3/11 [=======>......................] - ETA: 0s - loss: 0.0359 - accuracy: 0.7140 5/11 [============>.................] - ETA: 0s - loss: 0.0353 - accuracy: 0.7266 8/11 [====================>.........] - ETA: 0s - loss: 0.0348 - accuracy: 0.745511/11 [==============================] - ETA: 0s - loss: 0.0345 - accuracy: 0.756411/11 [==============================] - 0s 24ms/step - loss: 0.0344 - accuracy: 0.7590
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0264 - accuracy: 0.8203 4/11 [=========>....................] - ETA: 0s - loss: 0.0283 - accuracy: 0.8543 7/11 [==================>...........] - ETA: 0s - loss: 0.0295 - accuracy: 0.854410/11 [==========================>...] - ETA: 0s - loss: 0.0302 - accuracy: 0.844611/11 [==============================] - 0s 24ms/step - loss: 0.0305 - accuracy: 0.8399
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0294 - accuracy: 0.8594 4/11 [=========>....................] - ETA: 0s - loss: 0.0311 - accuracy: 0.8722 7/11 [==================>...........] - ETA: 0s - loss: 0.0314 - accuracy: 0.867210/11 [==========================>...] - ETA: 0s - loss: 0.0316 - accuracy: 0.852311/11 [==============================] - 0s 24ms/step - loss: 0.0315 - accuracy: 0.8462
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0291 - accuracy: 0.8125 4/11 [=========>....................] - ETA: 0s - loss: 0.0295 - accuracy: 0.8372 7/11 [==================>...........] - ETA: 0s - loss: 0.0294 - accuracy: 0.846510/11 [==========================>...] - ETA: 0s - loss: 0.0293 - accuracy: 0.847511/11 [==============================] - 0s 24ms/step - loss: 0.0293 - accuracy: 0.8471
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.0309 - accuracy: 0.89066/6 [==============================] - 5s 9ms/step - loss: 0.0305 - accuracy: 0.8881
2021-12-13 23:30:03.441813: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:30:03.442696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:30:03.442766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:30:03.442818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:30:03.442857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:30:03.442895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:30:03.442952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:30:03.442995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:30:03.443035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:30:03.443074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:30:03.444004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:30:03.444054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:30:03.444070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:30:03.444083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:30:03.445065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:30:03.445455: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:30:03.445958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:30:03.445999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:30:03.446036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:30:03.446074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:30:03.446112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:30:03.446149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:30:03.446187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:30:03.446226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:30:03.446263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:30:03.447172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:30:03.447212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:30:03.447228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:30:03.447240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:30:03.448196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 1 0 4 2] pred: [ 0.06759764  0.09464592 -0.05058217  0.8300742  -0.00160989]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [-0.01767695  0.09404851  0.95852005  0.01486396 -0.01140229]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [ 0.00124047  0.6352774   0.8126      0.07590862 -0.00667492]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [-0.02417432  0.07729648  0.8939758   0.06333318 -0.01966636]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 3 4 0] pred: [-0.10928302  0.95607483  0.12394671 -0.00353833 -0.05875958]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 3 0] pred: [-0.07186653  0.8071246   0.8561788  -0.02899046  0.00445448]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [ 3.2254681e-04  7.9784632e-01  8.9334095e-01 -7.0085824e-02
 -1.2853639e-02]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 0 3 4 1] pred: [ 1.7694427e-02 -7.2991438e-02  9.6383405e-01 -6.4380077e-04
 -3.8863670e-02]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 4 1 0 3] pred: [-0.05281884 -0.01682929  0.9798895  -0.0875045   0.00908518]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 4 0 3] pred: [-0.03903041  0.02061805  0.98263127 -0.10904443  0.01923264]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 4 3 0] pred: [-0.03006503  0.838838    0.87337655 -0.01962201  0.01364646]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 0 2 1 4] pred: [ 0.04076963 -0.12296357  0.03101736  0.6426013  -0.18733989]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 0 1 3 4] pred: [ 0.00885039 -0.01739353  0.9683622  -0.03349205 -0.05173916]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 0 3] pred: [-0.00600799  0.63947624  0.91977745 -0.07732417  0.01250534]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 0 2 4 1] pred: [ 0.04082857 -0.0272706   0.0351974   0.8217338   0.0217254 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:30 - loss: 0.2666 - accuracy: 0.1250 3/11 [=======>......................] - ETA: 0s - loss: 0.2531 - accuracy: 0.1649   6/11 [===============>..............] - ETA: 0s - loss: 0.2435 - accuracy: 0.2442 8/11 [====================>.........] - ETA: 0s - loss: 0.2380 - accuracy: 0.275110/11 [==========================>...] - ETA: 0s - loss: 0.2328 - accuracy: 0.298311/11 [==============================] - 15s 26ms/step - loss: 0.2286 - accuracy: 0.3151
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1593 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.1535 - accuracy: 0.4774 5/11 [============>.................] - ETA: 0s - loss: 0.1503 - accuracy: 0.4741 8/11 [====================>.........] - ETA: 0s - loss: 0.1459 - accuracy: 0.471911/11 [==============================] - ETA: 0s - loss: 0.1423 - accuracy: 0.469911/11 [==============================] - 0s 25ms/step - loss: 0.1413 - accuracy: 0.4693
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1059 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.1050 - accuracy: 0.4466 6/11 [===============>..............] - ETA: 0s - loss: 0.1051 - accuracy: 0.4479 8/11 [====================>.........] - ETA: 0s - loss: 0.1048 - accuracy: 0.452010/11 [==========================>...] - ETA: 0s - loss: 0.1045 - accuracy: 0.455611/11 [==============================] - 0s 26ms/step - loss: 0.1044 - accuracy: 0.4569
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0951 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 0s - loss: 0.0988 - accuracy: 0.4954 6/11 [===============>..............] - ETA: 0s - loss: 0.0985 - accuracy: 0.4931 9/11 [=======================>......] - ETA: 0s - loss: 0.0975 - accuracy: 0.491311/11 [==============================] - ETA: 0s - loss: 0.0969 - accuracy: 0.488511/11 [==============================] - 0s 25ms/step - loss: 0.0967 - accuracy: 0.4873
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0919 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.0835 - accuracy: 0.5221 6/11 [===============>..............] - ETA: 0s - loss: 0.0829 - accuracy: 0.5156 8/11 [====================>.........] - ETA: 0s - loss: 0.0825 - accuracy: 0.513411/11 [==============================] - ETA: 0s - loss: 0.0821 - accuracy: 0.512611/11 [==============================] - 0s 24ms/step - loss: 0.0820 - accuracy: 0.5125
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0780 - accuracy: 0.5469 4/11 [=========>....................] - ETA: 0s - loss: 0.0748 - accuracy: 0.5326 6/11 [===============>..............] - ETA: 0s - loss: 0.0741 - accuracy: 0.5375 9/11 [=======================>......] - ETA: 0s - loss: 0.0736 - accuracy: 0.550211/11 [==============================] - 0s 24ms/step - loss: 0.0728 - accuracy: 0.5609
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0644 - accuracy: 0.7031 3/11 [=======>......................] - ETA: 0s - loss: 0.0648 - accuracy: 0.6858 6/11 [===============>..............] - ETA: 0s - loss: 0.0645 - accuracy: 0.6622 9/11 [=======================>......] - ETA: 0s - loss: 0.0638 - accuracy: 0.652011/11 [==============================] - ETA: 0s - loss: 0.0635 - accuracy: 0.647711/11 [==============================] - 0s 26ms/step - loss: 0.0634 - accuracy: 0.6460
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0550 - accuracy: 0.6641 4/11 [=========>....................] - ETA: 0s - loss: 0.0549 - accuracy: 0.6483 7/11 [==================>...........] - ETA: 0s - loss: 0.0556 - accuracy: 0.6395 9/11 [=======================>......] - ETA: 0s - loss: 0.0556 - accuracy: 0.640611/11 [==============================] - 0s 25ms/step - loss: 0.0556 - accuracy: 0.6408
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0522 - accuracy: 0.7109 3/11 [=======>......................] - ETA: 0s - loss: 0.0543 - accuracy: 0.6723 5/11 [============>.................] - ETA: 0s - loss: 0.0544 - accuracy: 0.6574 8/11 [====================>.........] - ETA: 0s - loss: 0.0534 - accuracy: 0.655710/11 [==========================>...] - ETA: 0s - loss: 0.0530 - accuracy: 0.656711/11 [==============================] - 0s 26ms/step - loss: 0.0527 - accuracy: 0.6577
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0463 - accuracy: 0.6797 4/11 [=========>....................] - ETA: 0s - loss: 0.0473 - accuracy: 0.6709 6/11 [===============>..............] - ETA: 0s - loss: 0.0476 - accuracy: 0.6641 8/11 [====================>.........] - ETA: 0s - loss: 0.0478 - accuracy: 0.660511/11 [==============================] - ETA: 0s - loss: 0.0481 - accuracy: 0.660311/11 [==============================] - 0s 26ms/step - loss: 0.0481 - accuracy: 0.6605
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0530 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.0509 - accuracy: 0.6740 5/11 [============>.................] - ETA: 0s - loss: 0.0501 - accuracy: 0.6770 7/11 [==================>...........] - ETA: 0s - loss: 0.0495 - accuracy: 0.674210/11 [==========================>...] - ETA: 0s - loss: 0.0487 - accuracy: 0.670311/11 [==============================] - 0s 26ms/step - loss: 0.0483 - accuracy: 0.6696
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0445 - accuracy: 0.6797 4/11 [=========>....................] - ETA: 0s - loss: 0.0445 - accuracy: 0.6724 6/11 [===============>..............] - ETA: 0s - loss: 0.0438 - accuracy: 0.6712 9/11 [=======================>......] - ETA: 0s - loss: 0.0436 - accuracy: 0.668511/11 [==============================] - ETA: 0s - loss: 0.0437 - accuracy: 0.669011/11 [==============================] - 0s 26ms/step - loss: 0.0438 - accuracy: 0.6692
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0415 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.0421 - accuracy: 0.6710 6/11 [===============>..............] - ETA: 0s - loss: 0.0421 - accuracy: 0.6805 8/11 [====================>.........] - ETA: 0s - loss: 0.0420 - accuracy: 0.685210/11 [==========================>...] - ETA: 0s - loss: 0.0422 - accuracy: 0.686111/11 [==============================] - 0s 25ms/step - loss: 0.0423 - accuracy: 0.6853
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0370 - accuracy: 0.6172 4/11 [=========>....................] - ETA: 0s - loss: 0.0387 - accuracy: 0.6646 6/11 [===============>..............] - ETA: 0s - loss: 0.0396 - accuracy: 0.6724 8/11 [====================>.........] - ETA: 0s - loss: 0.0399 - accuracy: 0.679210/11 [==========================>...] - ETA: 0s - loss: 0.0401 - accuracy: 0.683611/11 [==============================] - 0s 26ms/step - loss: 0.0403 - accuracy: 0.6864
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0424 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 0s - loss: 0.0419 - accuracy: 0.7179 5/11 [============>.................] - ETA: 0s - loss: 0.0416 - accuracy: 0.7179 8/11 [====================>.........] - ETA: 0s - loss: 0.0408 - accuracy: 0.712610/11 [==========================>...] - ETA: 0s - loss: 0.0407 - accuracy: 0.711411/11 [==============================] - 0s 27ms/step - loss: 0.0405 - accuracy: 0.7109
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0389 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.0393 - accuracy: 0.7539 5/11 [============>.................] - ETA: 0s - loss: 0.0393 - accuracy: 0.7459 8/11 [====================>.........] - ETA: 0s - loss: 0.0393 - accuracy: 0.741210/11 [==========================>...] - ETA: 0s - loss: 0.0391 - accuracy: 0.740211/11 [==============================] - 0s 27ms/step - loss: 0.0390 - accuracy: 0.7393
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0448 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.0419 - accuracy: 0.7370 5/11 [============>.................] - ETA: 0s - loss: 0.0402 - accuracy: 0.7422 7/11 [==================>...........] - ETA: 0s - loss: 0.0393 - accuracy: 0.7446 9/11 [=======================>......] - ETA: 0s - loss: 0.0387 - accuracy: 0.748911/11 [==============================] - ETA: 0s - loss: 0.0383 - accuracy: 0.751711/11 [==============================] - 0s 27ms/step - loss: 0.0382 - accuracy: 0.7528
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0376 - accuracy: 0.7266 3/11 [=======>......................] - ETA: 0s - loss: 0.0364 - accuracy: 0.7352 5/11 [============>.................] - ETA: 0s - loss: 0.0355 - accuracy: 0.7340 7/11 [==================>...........] - ETA: 0s - loss: 0.0348 - accuracy: 0.7318 9/11 [=======================>......] - ETA: 0s - loss: 0.0346 - accuracy: 0.731311/11 [==============================] - 0s 27ms/step - loss: 0.0347 - accuracy: 0.7333
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0318 - accuracy: 0.8125 4/11 [=========>....................] - ETA: 0s - loss: 0.0320 - accuracy: 0.8260 6/11 [===============>..............] - ETA: 0s - loss: 0.0324 - accuracy: 0.8198 8/11 [====================>.........] - ETA: 0s - loss: 0.0326 - accuracy: 0.813210/11 [==========================>...] - ETA: 0s - loss: 0.0329 - accuracy: 0.808511/11 [==============================] - 0s 26ms/step - loss: 0.0331 - accuracy: 0.8051
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0333 - accuracy: 0.8516 3/11 [=======>......................] - ETA: 0s - loss: 0.0344 - accuracy: 0.8394 5/11 [============>.................] - ETA: 0s - loss: 0.0340 - accuracy: 0.8334 7/11 [==================>...........] - ETA: 0s - loss: 0.0339 - accuracy: 0.8316 9/11 [=======================>......] - ETA: 0s - loss: 0.0336 - accuracy: 0.827411/11 [==============================] - 0s 27ms/step - loss: 0.0333 - accuracy: 0.8214
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.0315 - accuracy: 0.68756/6 [==============================] - 5s 9ms/step - loss: 0.0331 - accuracy: 0.7507
2021-12-13 23:30:39.490088: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:30:39.491186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:30:39.491251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:30:39.491295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:30:39.491326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:30:39.491360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:30:39.491393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:30:39.491427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:30:39.491462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:30:39.491495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:30:39.492199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:30:39.492242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:30:39.492254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:30:39.492263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:30:39.493009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:30:39.493387: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:30:39.493759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:30:39.493787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:30:39.493814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:30:39.493841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:30:39.493867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:30:39.493893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:30:39.493922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:30:39.493957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:30:39.493988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:30:39.494663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:30:39.494691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:30:39.494702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:30:39.494711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:30:39.495426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 3 1 2 4] pred: [ 0.7326979   0.01012207 -0.02868884  0.08224605 -0.0365946 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 4 1 0] pred: [-0.03962298 -0.03496169  0.9808114   0.03408678 -0.0056396 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 0 1 3 4] pred: [ 0.04322233  0.04052885  0.9708272   0.03071579 -0.02527063]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 0 2 4 3] pred: [ 0.4001476   0.79871595  0.30344537 -0.03415322  0.05139285]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [ 0.05860936  0.07893825  0.9682996  -0.01472727  0.03751991]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 4 0 1] pred: [-0.0886797  -0.15934055  0.9784585   0.06248853  0.03600646]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 4 0 1 3] pred: [-0.00517601 -0.00519784  0.9809224  -0.04105334  0.04581646]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 4 3] pred: [ 0.01690914  0.72372544  0.8767101  -0.00657499 -0.0029366 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [-0.03334047  0.44569618  0.9329898   0.05873519  0.02986348]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [-0.00911978  0.64519215  0.88486195  0.04409108 -0.02117136]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [2 0 4 3 1] pred: [-0.01269049 -0.04339243  0.984231   -0.02638958 -0.01831963]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 0 1 4 2] pred: [ 0.05418998 -0.01584128 -0.06151269  0.8435286  -0.03560992]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [-0.0363287   0.83274066  0.84672666  0.01639931 -0.00520627]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 4 0 3 1] pred: [ 0.02120038 -0.00991435  0.9727475  -0.00254304  0.04081071]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 4 0 1] pred: [-0.05683096 -0.17005906  0.97127163  0.12564985 -0.02464155]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:29 - loss: 0.2573 - accuracy: 0.2109 4/11 [=========>....................] - ETA: 0s - loss: 0.2435 - accuracy: 0.3245   6/11 [===============>..............] - ETA: 0s - loss: 0.2367 - accuracy: 0.3562 9/11 [=======================>......] - ETA: 0s - loss: 0.2280 - accuracy: 0.383711/11 [==============================] - 15s 23ms/step - loss: 0.2205 - accuracy: 0.4010
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1359 - accuracy: 0.5391 4/11 [=========>....................] - ETA: 0s - loss: 0.1373 - accuracy: 0.4951 6/11 [===============>..............] - ETA: 0s - loss: 0.1355 - accuracy: 0.4883 8/11 [====================>.........] - ETA: 0s - loss: 0.1333 - accuracy: 0.485711/11 [==============================] - ETA: 0s - loss: 0.1304 - accuracy: 0.484111/11 [==============================] - 0s 25ms/step - loss: 0.1297 - accuracy: 0.4836
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1147 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.1084 - accuracy: 0.4762 7/11 [==================>...........] - ETA: 0s - loss: 0.1064 - accuracy: 0.4793 9/11 [=======================>......] - ETA: 0s - loss: 0.1054 - accuracy: 0.480211/11 [==============================] - 0s 24ms/step - loss: 0.1047 - accuracy: 0.4793
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0980 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 0s - loss: 0.0959 - accuracy: 0.5067 6/11 [===============>..............] - ETA: 0s - loss: 0.0956 - accuracy: 0.4999 9/11 [=======================>......] - ETA: 0s - loss: 0.0952 - accuracy: 0.493611/11 [==============================] - 0s 24ms/step - loss: 0.0948 - accuracy: 0.4898
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0890 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.0859 - accuracy: 0.4475 6/11 [===============>..............] - ETA: 0s - loss: 0.0844 - accuracy: 0.4634 9/11 [=======================>......] - ETA: 0s - loss: 0.0830 - accuracy: 0.475211/11 [==============================] - 0s 24ms/step - loss: 0.0823 - accuracy: 0.4824
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0780 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.0755 - accuracy: 0.5273 6/11 [===============>..............] - ETA: 0s - loss: 0.0741 - accuracy: 0.5216 9/11 [=======================>......] - ETA: 0s - loss: 0.0728 - accuracy: 0.525611/11 [==============================] - ETA: 0s - loss: 0.0721 - accuracy: 0.529911/11 [==============================] - 0s 24ms/step - loss: 0.0718 - accuracy: 0.5318
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0675 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.0648 - accuracy: 0.5807 6/11 [===============>..............] - ETA: 0s - loss: 0.0634 - accuracy: 0.5944 8/11 [====================>.........] - ETA: 0s - loss: 0.0625 - accuracy: 0.603010/11 [==========================>...] - ETA: 0s - loss: 0.0620 - accuracy: 0.608611/11 [==============================] - 0s 25ms/step - loss: 0.0618 - accuracy: 0.6119
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0621 - accuracy: 0.6406 4/11 [=========>....................] - ETA: 0s - loss: 0.0613 - accuracy: 0.6483 7/11 [==================>...........] - ETA: 0s - loss: 0.0600 - accuracy: 0.6547 9/11 [=======================>......] - ETA: 0s - loss: 0.0591 - accuracy: 0.655711/11 [==============================] - ETA: 0s - loss: 0.0584 - accuracy: 0.656211/11 [==============================] - 0s 25ms/step - loss: 0.0582 - accuracy: 0.6564
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0617 - accuracy: 0.6250 4/11 [=========>....................] - ETA: 0s - loss: 0.0559 - accuracy: 0.6732 7/11 [==================>...........] - ETA: 0s - loss: 0.0540 - accuracy: 0.6800 9/11 [=======================>......] - ETA: 0s - loss: 0.0533 - accuracy: 0.680511/11 [==============================] - ETA: 0s - loss: 0.0529 - accuracy: 0.679411/11 [==============================] - 0s 24ms/step - loss: 0.0528 - accuracy: 0.6791
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0535 - accuracy: 0.6719 4/11 [=========>....................] - ETA: 0s - loss: 0.0509 - accuracy: 0.6842 7/11 [==================>...........] - ETA: 0s - loss: 0.0499 - accuracy: 0.683510/11 [==========================>...] - ETA: 0s - loss: 0.0494 - accuracy: 0.683611/11 [==============================] - 0s 23ms/step - loss: 0.0492 - accuracy: 0.6834
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0478 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.0467 - accuracy: 0.6969 7/11 [==================>...........] - ETA: 0s - loss: 0.0469 - accuracy: 0.6865 9/11 [=======================>......] - ETA: 0s - loss: 0.0469 - accuracy: 0.687411/11 [==============================] - 0s 24ms/step - loss: 0.0466 - accuracy: 0.6885
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0371 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.0390 - accuracy: 0.7387 5/11 [============>.................] - ETA: 0s - loss: 0.0405 - accuracy: 0.7240 8/11 [====================>.........] - ETA: 0s - loss: 0.0412 - accuracy: 0.713211/11 [==============================] - ETA: 0s - loss: 0.0416 - accuracy: 0.707011/11 [==============================] - 0s 25ms/step - loss: 0.0417 - accuracy: 0.7055
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0383 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.0404 - accuracy: 0.7051 6/11 [===============>..............] - ETA: 0s - loss: 0.0406 - accuracy: 0.7023 9/11 [=======================>......] - ETA: 0s - loss: 0.0409 - accuracy: 0.704711/11 [==============================] - 0s 24ms/step - loss: 0.0410 - accuracy: 0.7056
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0383 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.0399 - accuracy: 0.6671 5/11 [============>.................] - ETA: 0s - loss: 0.0402 - accuracy: 0.6638 7/11 [==================>...........] - ETA: 0s - loss: 0.0403 - accuracy: 0.6698 9/11 [=======================>......] - ETA: 0s - loss: 0.0400 - accuracy: 0.677611/11 [==============================] - 0s 26ms/step - loss: 0.0399 - accuracy: 0.6868
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0364 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.0352 - accuracy: 0.7309 5/11 [============>.................] - ETA: 0s - loss: 0.0358 - accuracy: 0.7266 7/11 [==================>...........] - ETA: 0s - loss: 0.0360 - accuracy: 0.723410/11 [==========================>...] - ETA: 0s - loss: 0.0364 - accuracy: 0.719711/11 [==============================] - 0s 26ms/step - loss: 0.0366 - accuracy: 0.7184
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0349 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.0359 - accuracy: 0.7830 5/11 [============>.................] - ETA: 0s - loss: 0.0367 - accuracy: 0.7764 7/11 [==================>...........] - ETA: 0s - loss: 0.0366 - accuracy: 0.7769 9/11 [=======================>......] - ETA: 0s - loss: 0.0365 - accuracy: 0.775611/11 [==============================] - ETA: 0s - loss: 0.0364 - accuracy: 0.774011/11 [==============================] - 0s 26ms/step - loss: 0.0363 - accuracy: 0.7733
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0382 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.0372 - accuracy: 0.6853 5/11 [============>.................] - ETA: 0s - loss: 0.0367 - accuracy: 0.6962 7/11 [==================>...........] - ETA: 0s - loss: 0.0361 - accuracy: 0.705210/11 [==========================>...] - ETA: 0s - loss: 0.0356 - accuracy: 0.716011/11 [==============================] - 0s 25ms/step - loss: 0.0352 - accuracy: 0.7212
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0256 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.0282 - accuracy: 0.7882 5/11 [============>.................] - ETA: 0s - loss: 0.0298 - accuracy: 0.7758 8/11 [====================>.........] - ETA: 0s - loss: 0.0304 - accuracy: 0.768411/11 [==============================] - ETA: 0s - loss: 0.0306 - accuracy: 0.770311/11 [==============================] - 0s 25ms/step - loss: 0.0306 - accuracy: 0.7712
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0304 - accuracy: 0.8672 4/11 [=========>....................] - ETA: 0s - loss: 0.0293 - accuracy: 0.8247 6/11 [===============>..............] - ETA: 0s - loss: 0.0296 - accuracy: 0.8074 9/11 [=======================>......] - ETA: 0s - loss: 0.0295 - accuracy: 0.794211/11 [==============================] - ETA: 0s - loss: 0.0294 - accuracy: 0.790911/11 [==============================] - 0s 26ms/step - loss: 0.0294 - accuracy: 0.7898
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0286 - accuracy: 0.8281 4/11 [=========>....................] - ETA: 0s - loss: 0.0287 - accuracy: 0.8206 6/11 [===============>..............] - ETA: 0s - loss: 0.0286 - accuracy: 0.8156 8/11 [====================>.........] - ETA: 0s - loss: 0.0285 - accuracy: 0.812910/11 [==========================>...] - ETA: 0s - loss: 0.0283 - accuracy: 0.813311/11 [==============================] - 0s 26ms/step - loss: 0.0282 - accuracy: 0.8146
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.0279 - accuracy: 0.79696/6 [==============================] - ETA: 0s - loss: 0.0308 - accuracy: 0.7691 6/6 [==============================] - 5s 10ms/step - loss: 0.0308 - accuracy: 0.7691
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [ 0.23695375  0.6196703   0.61440206  0.11936063 -0.07158621]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 4 3 0] pred: [-0.09417443  0.27999553  0.9614871  -0.08603414  0.01510204]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 3 0] pred: [-0.03249836  0.05894705  0.96144706  0.0132096   0.02139747]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 4 3] pred: [ 0.04407154  0.85220623  0.5383573  -0.03004259  0.00340185]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [4 3 1 0 2] pred: [ 0.0248096   0.03441282 -0.05292593  0.3175215   0.88178253]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [0.01968329 0.7406202  0.83384514 0.04265814 0.00178725]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 4 3 0 1] pred: [-0.03100868 -0.04673791  0.9873683  -0.02797038 -0.00265483]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 0 1 3 4] pred: [ 0.05048056  0.04887006  0.97114426  0.02503588 -0.05463319]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 4 3 0] pred: [-0.03493676  0.8402693   0.47117463 -0.00869868  0.00211451]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [0.00104796 0.7293221  0.8783861  0.05669807 0.01987936]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 3 4 0] pred: [0.00285627 0.81527543 0.7435843  0.05895831 0.01511537]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 1 0 4] pred: [-0.02227171 -0.01618682  0.98506105  0.03816934 -0.02536876]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 0 1 4 2] pred: [ 6.2133417e-02  2.0869479e-02 -6.2465709e-02  8.7300938e-01
 -3.3316016e-04]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 3 4 0] pred: [-0.04273418  0.843388    0.69679964  0.07850634  0.00298876]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 0 4 3 1] pred: [ 0.00204537 -0.02392766  0.9839677  -0.02341983 -0.01534828]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Job end at lun déc 13 23:31:16 CET 2021
