
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at lun déc 13 23:37:32 CET 2021
2021-12-13 23:37:32.942211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-13 23:37:38.124685: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:37:38.126470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-13 23:37:38.159461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:37:38.159509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:37:38.163548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:37:38.163601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:37:38.166569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:37:38.167484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:37:38.171322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:37:38.173239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:37:38.179460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:37:38.180743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:37:38.180793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:37:38.813279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:37:38.813331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:37:38.813344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:37:38.815253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:37:38.816310: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:37:38.816873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:37:38.816939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:37:38.816990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:37:38.817023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:37:38.817064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:37:38.817108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:37:38.817140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:37:38.817170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:37:38.817207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:37:38.818276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:37:38.818306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:37:38.818318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:37:38.818327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:37:38.819420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:37:40.659799: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:37:40.661152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:37:40.661208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:37:40.661306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:37:40.661353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:37:40.661392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:37:40.661477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:37:40.661561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:37:40.661605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:37:40.661645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:37:40.662763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:37:40.663644: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:37:40.664279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:37:40.664308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:37:40.664337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:37:40.664409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:37:40.664443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:37:40.664472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:37:40.664542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:37:40.664577: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:37:40.664606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:37:40.665720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:37:40.665789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:37:40.665830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:37:40.665843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:37:40.667160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:37:40.667299: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-13 23:37:44.108405: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-13 23:37:44.109168: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 1994990000 Hz
2021-12-13 23:37:55.964722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:37:57.072322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
Number of possible configurations: 40
Begining exécution of the 27 th configuration: BPIC20.csv with GRU model, 20 epochs, 30 units, 128 batch_size, sigmoid as activation function and bin_ce-logits as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 90, 58)            3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                16200     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:36 - loss: 0.6907 - accuracy: 0.1797 3/11 [=======>......................] - ETA: 0s - loss: 0.6882 - accuracy: 0.2639   5/11 [============>.................] - ETA: 0s - loss: 0.6856 - accuracy: 0.3024 7/11 [==================>...........] - ETA: 0s - loss: 0.6829 - accuracy: 0.322410/11 [==========================>...] - ETA: 0s - loss: 0.6785 - accuracy: 0.348311/11 [==============================] - 16s 25ms/step - loss: 0.6758 - accuracy: 0.3604
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6270 - accuracy: 0.3672 3/11 [=======>......................] - ETA: 0s - loss: 0.6209 - accuracy: 0.4145 6/11 [===============>..............] - ETA: 0s - loss: 0.6139 - accuracy: 0.4293 9/11 [=======================>......] - ETA: 0s - loss: 0.6072 - accuracy: 0.435811/11 [==============================] - ETA: 0s - loss: 0.6026 - accuracy: 0.439811/11 [==============================] - 0s 24ms/step - loss: 0.6008 - accuracy: 0.4414
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5162 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.5039 - accuracy: 0.4621 6/11 [===============>..............] - ETA: 0s - loss: 0.4980 - accuracy: 0.4680 9/11 [=======================>......] - ETA: 0s - loss: 0.4902 - accuracy: 0.466011/11 [==============================] - 0s 25ms/step - loss: 0.4828 - accuracy: 0.4642
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4027 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.3890 - accuracy: 0.4463 6/11 [===============>..............] - ETA: 0s - loss: 0.3893 - accuracy: 0.4430 8/11 [====================>.........] - ETA: 0s - loss: 0.3895 - accuracy: 0.441911/11 [==============================] - ETA: 0s - loss: 0.3859 - accuracy: 0.446011/11 [==============================] - 0s 26ms/step - loss: 0.3849 - accuracy: 0.4471
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3223 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.3343 - accuracy: 0.5117 5/11 [============>.................] - ETA: 0s - loss: 0.3402 - accuracy: 0.4898 8/11 [====================>.........] - ETA: 0s - loss: 0.3428 - accuracy: 0.482011/11 [==============================] - ETA: 0s - loss: 0.3434 - accuracy: 0.477011/11 [==============================] - 0s 25ms/step - loss: 0.3437 - accuracy: 0.4755
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3481 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3513 - accuracy: 0.4453 5/11 [============>.................] - ETA: 0s - loss: 0.3504 - accuracy: 0.4386 7/11 [==================>...........] - ETA: 0s - loss: 0.3478 - accuracy: 0.436910/11 [==========================>...] - ETA: 0s - loss: 0.3425 - accuracy: 0.441911/11 [==============================] - 0s 26ms/step - loss: 0.3402 - accuracy: 0.4450
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3088 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.3084 - accuracy: 0.4720 7/11 [==================>...........] - ETA: 0s - loss: 0.3083 - accuracy: 0.471010/11 [==========================>...] - ETA: 0s - loss: 0.3080 - accuracy: 0.471511/11 [==============================] - 0s 24ms/step - loss: 0.3079 - accuracy: 0.4698
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2906 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 0s - loss: 0.2975 - accuracy: 0.4720 7/11 [==================>...........] - ETA: 0s - loss: 0.2956 - accuracy: 0.4662 9/11 [=======================>......] - ETA: 0s - loss: 0.2943 - accuracy: 0.466211/11 [==============================] - 0s 25ms/step - loss: 0.2927 - accuracy: 0.4668
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2746 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.2704 - accuracy: 0.5182 5/11 [============>.................] - ETA: 0s - loss: 0.2713 - accuracy: 0.5078 8/11 [====================>.........] - ETA: 0s - loss: 0.2706 - accuracy: 0.503411/11 [==============================] - ETA: 0s - loss: 0.2691 - accuracy: 0.500911/11 [==============================] - 0s 24ms/step - loss: 0.2689 - accuracy: 0.4999
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2618 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.2560 - accuracy: 0.5234 5/11 [============>.................] - ETA: 0s - loss: 0.2522 - accuracy: 0.5309 7/11 [==================>...........] - ETA: 0s - loss: 0.2500 - accuracy: 0.5326 9/11 [=======================>......] - ETA: 0s - loss: 0.2487 - accuracy: 0.535111/11 [==============================] - 0s 26ms/step - loss: 0.2486 - accuracy: 0.5349
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2284 - accuracy: 0.6016 4/11 [=========>....................] - ETA: 0s - loss: 0.2282 - accuracy: 0.6025 6/11 [===============>..............] - ETA: 0s - loss: 0.2285 - accuracy: 0.5971 9/11 [=======================>......] - ETA: 0s - loss: 0.2293 - accuracy: 0.589711/11 [==============================] - 0s 25ms/step - loss: 0.2303 - accuracy: 0.5847
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2584 - accuracy: 0.5469 4/11 [=========>....................] - ETA: 0s - loss: 0.2419 - accuracy: 0.5750 7/11 [==================>...........] - ETA: 0s - loss: 0.2347 - accuracy: 0.5839 9/11 [=======================>......] - ETA: 0s - loss: 0.2322 - accuracy: 0.586011/11 [==============================] - ETA: 0s - loss: 0.2301 - accuracy: 0.585611/11 [==============================] - 0s 25ms/step - loss: 0.2294 - accuracy: 0.5854
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2106 - accuracy: 0.5781 4/11 [=========>....................] - ETA: 0s - loss: 0.2077 - accuracy: 0.5848 7/11 [==================>...........] - ETA: 0s - loss: 0.2075 - accuracy: 0.5865 9/11 [=======================>......] - ETA: 0s - loss: 0.2076 - accuracy: 0.587311/11 [==============================] - 0s 24ms/step - loss: 0.2078 - accuracy: 0.5885
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1838 - accuracy: 0.6641 3/11 [=======>......................] - ETA: 0s - loss: 0.1935 - accuracy: 0.6523 6/11 [===============>..............] - ETA: 0s - loss: 0.1960 - accuracy: 0.6334 8/11 [====================>.........] - ETA: 0s - loss: 0.1972 - accuracy: 0.627011/11 [==============================] - ETA: 0s - loss: 0.1972 - accuracy: 0.623011/11 [==============================] - 0s 25ms/step - loss: 0.1972 - accuracy: 0.6222
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2116 - accuracy: 0.6406 4/11 [=========>....................] - ETA: 0s - loss: 0.1991 - accuracy: 0.6291 6/11 [===============>..............] - ETA: 0s - loss: 0.1950 - accuracy: 0.6255 8/11 [====================>.........] - ETA: 0s - loss: 0.1943 - accuracy: 0.619610/11 [==========================>...] - ETA: 0s - loss: 0.1929 - accuracy: 0.619711/11 [==============================] - 0s 25ms/step - loss: 0.1918 - accuracy: 0.6203
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1771 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.1784 - accuracy: 0.6558 5/11 [============>.................] - ETA: 0s - loss: 0.1775 - accuracy: 0.6443 8/11 [====================>.........] - ETA: 0s - loss: 0.1782 - accuracy: 0.637810/11 [==========================>...] - ETA: 0s - loss: 0.1778 - accuracy: 0.637311/11 [==============================] - 0s 25ms/step - loss: 0.1772 - accuracy: 0.6379
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1440 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.1482 - accuracy: 0.6780 6/11 [===============>..............] - ETA: 0s - loss: 0.1523 - accuracy: 0.6676 8/11 [====================>.........] - ETA: 0s - loss: 0.1548 - accuracy: 0.663410/11 [==========================>...] - ETA: 0s - loss: 0.1568 - accuracy: 0.659511/11 [==============================] - 0s 25ms/step - loss: 0.1580 - accuracy: 0.6577
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1660 - accuracy: 0.6719 4/11 [=========>....................] - ETA: 0s - loss: 0.1556 - accuracy: 0.6781 7/11 [==================>...........] - ETA: 0s - loss: 0.1544 - accuracy: 0.6781 9/11 [=======================>......] - ETA: 0s - loss: 0.1539 - accuracy: 0.678711/11 [==============================] - 0s 24ms/step - loss: 0.1535 - accuracy: 0.6806
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1498 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.1517 - accuracy: 0.7209 6/11 [===============>..............] - ETA: 0s - loss: 0.1482 - accuracy: 0.7309 8/11 [====================>.........] - ETA: 0s - loss: 0.1472 - accuracy: 0.731711/11 [==============================] - ETA: 0s - loss: 0.1457 - accuracy: 0.733611/11 [==============================] - 0s 25ms/step - loss: 0.1453 - accuracy: 0.7344
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1337 - accuracy: 0.7188 4/11 [=========>....................] - ETA: 0s - loss: 0.1301 - accuracy: 0.7238 7/11 [==================>...........] - ETA: 0s - loss: 0.1289 - accuracy: 0.7337 9/11 [=======================>......] - ETA: 0s - loss: 0.1288 - accuracy: 0.737811/11 [==============================] - 0s 25ms/step - loss: 0.1292 - accuracy: 0.7448
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.1304 - accuracy: 0.83596/6 [==============================] - ETA: 0s - loss: 0.1307 - accuracy: 0.8201 6/6 [==============================] - 5s 10ms/step - loss: 0.1307 - accuracy: 0.8201
2021-12-13 23:38:15.361889: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:38:15.362950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:38:15.363036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:38:15.363105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:38:15.363259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:38:15.363320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:38:15.363444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:38:15.363507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:38:15.363628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:38:15.363740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:38:15.364981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:38:15.365064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:38:15.365087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:38:15.365104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:38:15.366513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:38:15.367047: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:38:15.367727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:38:15.367777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:38:15.367828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:38:15.367961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:38:15.368023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:38:15.368074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:38:15.368222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:38:15.368282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:38:15.368333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:38:15.369836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:38:15.369883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:38:15.369902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:38:15.369918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:38:15.371102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [3.0599630e-03 6.0625178e-01 9.3026996e-01 1.6797754e-03 3.7948260e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [3.2273942e-04 5.7248276e-02 9.6957612e-01 2.2451151e-03 1.4806715e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 2 4 1 0] pred: [0.0029249  0.00758705 0.15973341 0.7809513  0.07905648]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.05243025 0.64450574 0.618781   0.02586076 0.01143867]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [0 1 2 4 3] pred: [0.8124205  0.6121936  0.0714483  0.03994777 0.05811768]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [3 2 4 1 0] pred: [0.00209943 0.0056553  0.19219026 0.8021878  0.05836025]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [2.6967111e-03 4.6993682e-01 9.5644557e-01 3.1765185e-03 5.1052548e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [0.00879942 0.65291625 0.8820237  0.00607535 0.00111236]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 4 3] pred: [0.07395446 0.89046824 0.7626515  0.0021347  0.00279779]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 4 1 0] pred: [0.00268024 0.00532784 0.14280337 0.81818557 0.07583037]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [3.7925295e-04 5.5608954e-02 9.6060455e-01 2.5553713e-03 1.7522922e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [3.4724217e-04 5.6143489e-02 9.6436489e-01 2.4042604e-03 1.5356562e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [1.0533225e-02 7.8783643e-01 8.6301088e-01 1.9360542e-03 6.7626580e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 2 1 0] pred: [0.01563212 0.02128338 0.06296407 0.75731605 0.2614542 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [2.9990324e-04 5.6788344e-02 9.7413212e-01 1.9500377e-03 1.3460948e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:43 - loss: 0.6889 - accuracy: 0.1641 3/11 [=======>......................] - ETA: 0s - loss: 0.6860 - accuracy: 0.2452   6/11 [===============>..............] - ETA: 0s - loss: 0.6818 - accuracy: 0.3048 8/11 [====================>.........] - ETA: 0s - loss: 0.6790 - accuracy: 0.330510/11 [==========================>...] - ETA: 0s - loss: 0.6762 - accuracy: 0.348111/11 [==============================] - 17s 25ms/step - loss: 0.6737 - accuracy: 0.3596
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6233 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.6200 - accuracy: 0.4466 6/11 [===============>..............] - ETA: 0s - loss: 0.6162 - accuracy: 0.4472 8/11 [====================>.........] - ETA: 0s - loss: 0.6124 - accuracy: 0.449110/11 [==========================>...] - ETA: 0s - loss: 0.6083 - accuracy: 0.451311/11 [==============================] - 0s 26ms/step - loss: 0.6047 - accuracy: 0.4527
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5351 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.5276 - accuracy: 0.4222 7/11 [==================>...........] - ETA: 0s - loss: 0.5182 - accuracy: 0.4329 9/11 [=======================>......] - ETA: 0s - loss: 0.5125 - accuracy: 0.437011/11 [==============================] - ETA: 0s - loss: 0.5068 - accuracy: 0.440611/11 [==============================] - 0s 25ms/step - loss: 0.5044 - accuracy: 0.4422
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4353 - accuracy: 0.3984 4/11 [=========>....................] - ETA: 0s - loss: 0.4197 - accuracy: 0.4188 7/11 [==================>...........] - ETA: 0s - loss: 0.4070 - accuracy: 0.435210/11 [==========================>...] - ETA: 0s - loss: 0.3980 - accuracy: 0.443111/11 [==============================] - 0s 25ms/step - loss: 0.3939 - accuracy: 0.4459
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3746 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.3589 - accuracy: 0.4527 5/11 [============>.................] - ETA: 0s - loss: 0.3535 - accuracy: 0.4576 7/11 [==================>...........] - ETA: 0s - loss: 0.3489 - accuracy: 0.461710/11 [==========================>...] - ETA: 0s - loss: 0.3451 - accuracy: 0.463711/11 [==============================] - 0s 26ms/step - loss: 0.3436 - accuracy: 0.4631
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2951 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.3113 - accuracy: 0.4406 6/11 [===============>..............] - ETA: 0s - loss: 0.3132 - accuracy: 0.4431 9/11 [=======================>......] - ETA: 0s - loss: 0.3140 - accuracy: 0.446511/11 [==============================] - 0s 25ms/step - loss: 0.3139 - accuracy: 0.4499
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2916 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.2895 - accuracy: 0.4614 6/11 [===============>..............] - ETA: 0s - loss: 0.2891 - accuracy: 0.4589 8/11 [====================>.........] - ETA: 0s - loss: 0.2885 - accuracy: 0.459511/11 [==============================] - ETA: 0s - loss: 0.2874 - accuracy: 0.460911/11 [==============================] - 0s 25ms/step - loss: 0.2870 - accuracy: 0.4614
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2722 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.2657 - accuracy: 0.4961 6/11 [===============>..............] - ETA: 0s - loss: 0.2634 - accuracy: 0.4925 9/11 [=======================>......] - ETA: 0s - loss: 0.2615 - accuracy: 0.492811/11 [==============================] - ETA: 0s - loss: 0.2609 - accuracy: 0.493211/11 [==============================] - 0s 25ms/step - loss: 0.2607 - accuracy: 0.4934
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2481 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.2475 - accuracy: 0.5190 7/11 [==================>...........] - ETA: 0s - loss: 0.2463 - accuracy: 0.5129 9/11 [=======================>......] - ETA: 0s - loss: 0.2454 - accuracy: 0.513811/11 [==============================] - ETA: 0s - loss: 0.2445 - accuracy: 0.515211/11 [==============================] - 0s 25ms/step - loss: 0.2441 - accuracy: 0.5155
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2203 - accuracy: 0.6094 4/11 [=========>....................] - ETA: 0s - loss: 0.2305 - accuracy: 0.5798 7/11 [==================>...........] - ETA: 0s - loss: 0.2309 - accuracy: 0.5766 9/11 [=======================>......] - ETA: 0s - loss: 0.2303 - accuracy: 0.576511/11 [==============================] - ETA: 0s - loss: 0.2296 - accuracy: 0.576411/11 [==============================] - 0s 25ms/step - loss: 0.2293 - accuracy: 0.5764
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2167 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.2108 - accuracy: 0.5855 5/11 [============>.................] - ETA: 0s - loss: 0.2141 - accuracy: 0.5819 7/11 [==================>...........] - ETA: 0s - loss: 0.2161 - accuracy: 0.5779 9/11 [=======================>......] - ETA: 0s - loss: 0.2165 - accuracy: 0.578011/11 [==============================] - ETA: 0s - loss: 0.2160 - accuracy: 0.578911/11 [==============================] - 0s 26ms/step - loss: 0.2158 - accuracy: 0.5794
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2150 - accuracy: 0.5469 4/11 [=========>....................] - ETA: 0s - loss: 0.2059 - accuracy: 0.5568 6/11 [===============>..............] - ETA: 0s - loss: 0.2042 - accuracy: 0.5625 9/11 [=======================>......] - ETA: 0s - loss: 0.2031 - accuracy: 0.568911/11 [==============================] - ETA: 0s - loss: 0.2024 - accuracy: 0.572211/11 [==============================] - 0s 26ms/step - loss: 0.2021 - accuracy: 0.5736
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1864 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.1909 - accuracy: 0.5916 5/11 [============>.................] - ETA: 0s - loss: 0.1898 - accuracy: 0.6006 7/11 [==================>...........] - ETA: 0s - loss: 0.1893 - accuracy: 0.6020 9/11 [=======================>......] - ETA: 0s - loss: 0.1887 - accuracy: 0.602711/11 [==============================] - ETA: 0s - loss: 0.1883 - accuracy: 0.601611/11 [==============================] - 0s 28ms/step - loss: 0.1881 - accuracy: 0.6009
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1534 - accuracy: 0.5625 4/11 [=========>....................] - ETA: 0s - loss: 0.1666 - accuracy: 0.5923 6/11 [===============>..............] - ETA: 0s - loss: 0.1698 - accuracy: 0.5908 8/11 [====================>.........] - ETA: 0s - loss: 0.1703 - accuracy: 0.593110/11 [==========================>...] - ETA: 0s - loss: 0.1704 - accuracy: 0.597111/11 [==============================] - 0s 26ms/step - loss: 0.1708 - accuracy: 0.5999
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1539 - accuracy: 0.6250 4/11 [=========>....................] - ETA: 0s - loss: 0.1612 - accuracy: 0.6056 6/11 [===============>..............] - ETA: 0s - loss: 0.1623 - accuracy: 0.6038 9/11 [=======================>......] - ETA: 0s - loss: 0.1624 - accuracy: 0.605211/11 [==============================] - ETA: 0s - loss: 0.1622 - accuracy: 0.609111/11 [==============================] - 0s 26ms/step - loss: 0.1621 - accuracy: 0.6106
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1781 - accuracy: 0.6562 4/11 [=========>....................] - ETA: 0s - loss: 0.1705 - accuracy: 0.6551 6/11 [===============>..............] - ETA: 0s - loss: 0.1662 - accuracy: 0.6551 8/11 [====================>.........] - ETA: 0s - loss: 0.1634 - accuracy: 0.654210/11 [==========================>...] - ETA: 0s - loss: 0.1616 - accuracy: 0.654111/11 [==============================] - 0s 26ms/step - loss: 0.1601 - accuracy: 0.6554
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1523 - accuracy: 0.6328 3/11 [=======>......................] - ETA: 0s - loss: 0.1518 - accuracy: 0.6593 5/11 [============>.................] - ETA: 0s - loss: 0.1513 - accuracy: 0.6721 7/11 [==================>...........] - ETA: 0s - loss: 0.1503 - accuracy: 0.679310/11 [==========================>...] - ETA: 0s - loss: 0.1490 - accuracy: 0.681211/11 [==============================] - 0s 26ms/step - loss: 0.1481 - accuracy: 0.6823
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1423 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.1426 - accuracy: 0.6845 5/11 [============>.................] - ETA: 0s - loss: 0.1404 - accuracy: 0.6879 7/11 [==================>...........] - ETA: 0s - loss: 0.1391 - accuracy: 0.6885 9/11 [=======================>......] - ETA: 0s - loss: 0.1386 - accuracy: 0.689711/11 [==============================] - 0s 26ms/step - loss: 0.1383 - accuracy: 0.6917
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1418 - accuracy: 0.6328 3/11 [=======>......................] - ETA: 0s - loss: 0.1372 - accuracy: 0.6693 5/11 [============>.................] - ETA: 0s - loss: 0.1363 - accuracy: 0.6737 7/11 [==================>...........] - ETA: 0s - loss: 0.1365 - accuracy: 0.678510/11 [==========================>...] - ETA: 0s - loss: 0.1353 - accuracy: 0.689311/11 [==============================] - 0s 25ms/step - loss: 0.1345 - accuracy: 0.6939
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1230 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.1245 - accuracy: 0.7591 5/11 [============>.................] - ETA: 0s - loss: 0.1244 - accuracy: 0.7538 7/11 [==================>...........] - ETA: 0s - loss: 0.1251 - accuracy: 0.749310/11 [==========================>...] - ETA: 0s - loss: 0.1253 - accuracy: 0.747911/11 [==============================] - 0s 25ms/step - loss: 0.1252 - accuracy: 0.7475
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.1299 - accuracy: 0.78126/6 [==============================] - 5s 10ms/step - loss: 0.1188 - accuracy: 0.7535
2021-12-13 23:38:52.078954: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:38:52.080386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:38:52.080466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:38:52.080608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:38:52.080667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:38:52.080716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:38:52.080822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:38:52.080917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:38:52.080978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:38:52.081105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:38:52.082171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:38:52.082232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:38:52.082250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:38:52.082264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:38:52.083401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:38:52.083872: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:38:52.084436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:38:52.084478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:38:52.084520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:38:52.084622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:38:52.084672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:38:52.084713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:38:52.084827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:38:52.084876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:38:52.084917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:38:52.085955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:38:52.085997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:38:52.086015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:38:52.086028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:38:52.087089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [0.02311728 0.7950587  0.697623   0.00480375 0.00213958]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [4 3 0 2 1] pred: [0.2738704  0.08917838 0.08934102 0.732799   0.8722454 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 2 0 1] pred: [0.01400276 0.01371287 0.18444483 0.9222022  0.31249794]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.01699615 0.8758397  0.86941385 0.00284967 0.00184489]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [8.70840449e-05 1.18174069e-02 9.70080912e-01 3.27939424e-03
 1.14760005e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.02176106 0.8355181  0.75377256 0.00319229 0.00296389]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [9.9659774e-05 1.8704435e-02 9.5771056e-01 2.9442611e-03 1.4059979e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [7.3825751e-05 8.4143505e-03 9.8118240e-01 8.2277786e-03 2.2860106e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 4 3] pred: [0.04089774 0.83172005 0.6457144  0.00337569 0.00468689]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 4 3] pred: [0.09000922 0.7547991  0.5126745  0.00286116 0.00497597]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 4 3] pred: [0.02234496 0.74656314 0.6561753  0.00286911 0.00338003]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [6.524078e-05 2.342368e-02 9.770404e-01 5.923924e-03 1.775539e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.01076153 0.82811755 0.8072059  0.00266941 0.00195728]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 2 1 0] pred: [0.01231192 0.01301559 0.18753806 0.8762755  0.23532915]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [0.00642895 0.8138896  0.8728561  0.00280393 0.00143091]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:33 - loss: 0.6916 - accuracy: 0.4141 4/11 [=========>....................] - ETA: 0s - loss: 0.6875 - accuracy: 0.4440   6/11 [===============>..............] - ETA: 0s - loss: 0.6848 - accuracy: 0.4517 9/11 [=======================>......] - ETA: 0s - loss: 0.6807 - accuracy: 0.456711/11 [==============================] - 16s 25ms/step - loss: 0.6768 - accuracy: 0.4598
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6234 - accuracy: 0.5391 4/11 [=========>....................] - ETA: 0s - loss: 0.6198 - accuracy: 0.5125 7/11 [==================>...........] - ETA: 0s - loss: 0.6145 - accuracy: 0.498110/11 [==========================>...] - ETA: 0s - loss: 0.6086 - accuracy: 0.488411/11 [==============================] - 0s 23ms/step - loss: 0.6050 - accuracy: 0.4849
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5177 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.5153 - accuracy: 0.4952 5/11 [============>.................] - ETA: 0s - loss: 0.5110 - accuracy: 0.4896 8/11 [====================>.........] - ETA: 0s - loss: 0.5019 - accuracy: 0.486910/11 [==========================>...] - ETA: 0s - loss: 0.4960 - accuracy: 0.484111/11 [==============================] - 0s 26ms/step - loss: 0.4910 - accuracy: 0.4812
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3974 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.3941 - accuracy: 0.4293 6/11 [===============>..............] - ETA: 0s - loss: 0.3828 - accuracy: 0.4457 8/11 [====================>.........] - ETA: 0s - loss: 0.3781 - accuracy: 0.451811/11 [==============================] - ETA: 0s - loss: 0.3724 - accuracy: 0.456311/11 [==============================] - 0s 26ms/step - loss: 0.3710 - accuracy: 0.4572
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3175 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.3322 - accuracy: 0.4848 6/11 [===============>..............] - ETA: 0s - loss: 0.3297 - accuracy: 0.4788 8/11 [====================>.........] - ETA: 0s - loss: 0.3300 - accuracy: 0.476011/11 [==============================] - ETA: 0s - loss: 0.3312 - accuracy: 0.473311/11 [==============================] - 0s 26ms/step - loss: 0.3313 - accuracy: 0.4728
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3354 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.3258 - accuracy: 0.4715 7/11 [==================>...........] - ETA: 0s - loss: 0.3194 - accuracy: 0.4703 9/11 [=======================>......] - ETA: 0s - loss: 0.3166 - accuracy: 0.470311/11 [==============================] - ETA: 0s - loss: 0.3149 - accuracy: 0.469711/11 [==============================] - 0s 25ms/step - loss: 0.3142 - accuracy: 0.4695
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2653 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.2791 - accuracy: 0.4881 7/11 [==================>...........] - ETA: 0s - loss: 0.2833 - accuracy: 0.481710/11 [==========================>...] - ETA: 0s - loss: 0.2831 - accuracy: 0.480511/11 [==============================] - 0s 24ms/step - loss: 0.2829 - accuracy: 0.4788
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2834 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.2716 - accuracy: 0.4339 6/11 [===============>..............] - ETA: 0s - loss: 0.2695 - accuracy: 0.4372 8/11 [====================>.........] - ETA: 0s - loss: 0.2668 - accuracy: 0.444910/11 [==========================>...] - ETA: 0s - loss: 0.2650 - accuracy: 0.451011/11 [==============================] - 0s 26ms/step - loss: 0.2639 - accuracy: 0.4551
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2302 - accuracy: 0.5312 4/11 [=========>....................] - ETA: 0s - loss: 0.2392 - accuracy: 0.5073 6/11 [===============>..............] - ETA: 0s - loss: 0.2389 - accuracy: 0.5056 8/11 [====================>.........] - ETA: 0s - loss: 0.2380 - accuracy: 0.507410/11 [==========================>...] - ETA: 0s - loss: 0.2380 - accuracy: 0.507411/11 [==============================] - 0s 25ms/step - loss: 0.2380 - accuracy: 0.5073
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2435 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.2384 - accuracy: 0.5495 5/11 [============>.................] - ETA: 0s - loss: 0.2334 - accuracy: 0.5522 7/11 [==================>...........] - ETA: 0s - loss: 0.2303 - accuracy: 0.550010/11 [==========================>...] - ETA: 0s - loss: 0.2277 - accuracy: 0.552211/11 [==============================] - 0s 27ms/step - loss: 0.2267 - accuracy: 0.5524
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2062 - accuracy: 0.6016 3/11 [=======>......................] - ETA: 0s - loss: 0.2024 - accuracy: 0.6003 5/11 [============>.................] - ETA: 0s - loss: 0.2040 - accuracy: 0.5895 7/11 [==================>...........] - ETA: 0s - loss: 0.2061 - accuracy: 0.5853 9/11 [=======================>......] - ETA: 0s - loss: 0.2073 - accuracy: 0.581811/11 [==============================] - 0s 26ms/step - loss: 0.2076 - accuracy: 0.5819
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2111 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.2017 - accuracy: 0.5508 6/11 [===============>..............] - ETA: 0s - loss: 0.2002 - accuracy: 0.5636 8/11 [====================>.........] - ETA: 0s - loss: 0.1992 - accuracy: 0.572010/11 [==========================>...] - ETA: 0s - loss: 0.1983 - accuracy: 0.578211/11 [==============================] - 0s 26ms/step - loss: 0.1977 - accuracy: 0.5821
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1999 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.1973 - accuracy: 0.6076 6/11 [===============>..............] - ETA: 0s - loss: 0.1944 - accuracy: 0.6052 8/11 [====================>.........] - ETA: 0s - loss: 0.1919 - accuracy: 0.608410/11 [==========================>...] - ETA: 0s - loss: 0.1904 - accuracy: 0.612411/11 [==============================] - 0s 26ms/step - loss: 0.1891 - accuracy: 0.6149
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1817 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.1769 - accuracy: 0.6189 5/11 [============>.................] - ETA: 0s - loss: 0.1758 - accuracy: 0.6172 7/11 [==================>...........] - ETA: 0s - loss: 0.1750 - accuracy: 0.6232 9/11 [=======================>......] - ETA: 0s - loss: 0.1739 - accuracy: 0.627411/11 [==============================] - 0s 27ms/step - loss: 0.1729 - accuracy: 0.6347
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1630 - accuracy: 0.6719 4/11 [=========>....................] - ETA: 0s - loss: 0.1575 - accuracy: 0.6714 7/11 [==================>...........] - ETA: 0s - loss: 0.1587 - accuracy: 0.6794 9/11 [=======================>......] - ETA: 0s - loss: 0.1592 - accuracy: 0.682111/11 [==============================] - ETA: 0s - loss: 0.1592 - accuracy: 0.684311/11 [==============================] - 0s 26ms/step - loss: 0.1592 - accuracy: 0.6850
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1458 - accuracy: 0.7031 3/11 [=======>......................] - ETA: 0s - loss: 0.1503 - accuracy: 0.7040 5/11 [============>.................] - ETA: 0s - loss: 0.1507 - accuracy: 0.7148 7/11 [==================>...........] - ETA: 0s - loss: 0.1516 - accuracy: 0.7227 9/11 [=======================>......] - ETA: 0s - loss: 0.1508 - accuracy: 0.726811/11 [==============================] - 0s 27ms/step - loss: 0.1503 - accuracy: 0.7280
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1455 - accuracy: 0.6953 4/11 [=========>....................] - ETA: 0s - loss: 0.1438 - accuracy: 0.7303 6/11 [===============>..............] - ETA: 0s - loss: 0.1426 - accuracy: 0.7408 9/11 [=======================>......] - ETA: 0s - loss: 0.1414 - accuracy: 0.746111/11 [==============================] - 0s 24ms/step - loss: 0.1409 - accuracy: 0.7515
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1476 - accuracy: 0.7422 4/11 [=========>....................] - ETA: 0s - loss: 0.1378 - accuracy: 0.7598 6/11 [===============>..............] - ETA: 0s - loss: 0.1377 - accuracy: 0.7635 9/11 [=======================>......] - ETA: 0s - loss: 0.1365 - accuracy: 0.767911/11 [==============================] - 0s 24ms/step - loss: 0.1352 - accuracy: 0.7754
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1335 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.1335 - accuracy: 0.8741 5/11 [============>.................] - ETA: 0s - loss: 0.1340 - accuracy: 0.8656 7/11 [==================>...........] - ETA: 0s - loss: 0.1333 - accuracy: 0.8556 9/11 [=======================>......] - ETA: 0s - loss: 0.1322 - accuracy: 0.851911/11 [==============================] - 0s 26ms/step - loss: 0.1310 - accuracy: 0.8510
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1250 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.1240 - accuracy: 0.7365 6/11 [===============>..............] - ETA: 0s - loss: 0.1239 - accuracy: 0.7436 8/11 [====================>.........] - ETA: 0s - loss: 0.1240 - accuracy: 0.755210/11 [==========================>...] - ETA: 0s - loss: 0.1238 - accuracy: 0.766911/11 [==============================] - 0s 26ms/step - loss: 0.1235 - accuracy: 0.7758
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.1279 - accuracy: 0.84386/6 [==============================] - ETA: 0s - loss: 0.1374 - accuracy: 0.8357 6/6 [==============================] - 5s 10ms/step - loss: 0.1374 - accuracy: 0.8357
2021-12-13 23:39:28.449637: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:39:28.450457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:39:28.450534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:39:28.450594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:39:28.450644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:39:28.450700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:39:28.450754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:39:28.450806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:39:28.450859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:39:28.450911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:39:28.451923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:39:28.451994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:39:28.452013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:39:28.452028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:39:28.453123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:39:28.453622: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:39:28.454173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:39:28.454218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:39:28.454261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:39:28.454303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:39:28.454345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:39:28.454386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:39:28.454435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:39:28.454482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:39:28.454530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:39:28.455519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:39:28.455563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:39:28.455581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:39:28.455594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:39:28.456632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [3.5519540e-04 2.2451218e-02 9.5490015e-01 2.6442420e-03 1.5108443e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [0.01118218 0.8451566  0.8354347  0.00345962 0.00157594]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 2 0 1] pred: [0.02824977 0.0011053  0.06360662 0.8217514  0.7841895 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [3.9717296e-04 3.0722078e-02 9.5328349e-01 2.5605676e-03 1.5724573e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [3.6098712e-04 2.3255665e-02 9.5451337e-01 2.5144813e-03 1.4730629e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 2 0 1] pred: [0.0154989  0.00105118 0.09745844 0.64975685 0.46292967]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [0.12143986 0.82607645 0.49130917 0.00513266 0.00304146]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [3.8038590e-04 2.0752469e-02 9.5236242e-01 2.7478088e-03 1.6124416e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 0 1] pred: [0.00453242 0.00181241 0.19148697 0.76317227 0.13314423]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [3.7498324e-04 2.1164196e-02 9.5235181e-01 2.8704621e-03 1.6249018e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [3.7902399e-04 2.4677305e-02 9.5404363e-01 2.4439669e-03 1.4731822e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [0 1 2 4 3] pred: [0.4839659  0.42234442 0.2460262  0.00348983 0.00413014]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 2 0 1] pred: [0.01937847 0.00104237 0.08448471 0.6428323  0.48804855]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [0 1 2 4 3] pred: [0.6582517  0.25653854 0.15148292 0.00934672 0.01171173]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 2 0 1] pred: [0.01028478 0.00436635 0.13417539 0.82493085 0.2987742 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:32 - loss: 0.6937 - accuracy: 0.0703 4/11 [=========>....................] - ETA: 0s - loss: 0.6895 - accuracy: 0.2555   6/11 [===============>..............] - ETA: 0s - loss: 0.6870 - accuracy: 0.3004 8/11 [====================>.........] - ETA: 0s - loss: 0.6846 - accuracy: 0.325510/11 [==========================>...] - ETA: 0s - loss: 0.6821 - accuracy: 0.341311/11 [==============================] - 16s 25ms/step - loss: 0.6799 - accuracy: 0.3535
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6338 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.6288 - accuracy: 0.4616 6/11 [===============>..............] - ETA: 0s - loss: 0.6254 - accuracy: 0.4648 9/11 [=======================>......] - ETA: 0s - loss: 0.6205 - accuracy: 0.460111/11 [==============================] - 0s 24ms/step - loss: 0.6153 - accuracy: 0.4596
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5473 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.5411 - accuracy: 0.4544 6/11 [===============>..............] - ETA: 0s - loss: 0.5320 - accuracy: 0.4585 8/11 [====================>.........] - ETA: 0s - loss: 0.5264 - accuracy: 0.456610/11 [==========================>...] - ETA: 0s - loss: 0.5205 - accuracy: 0.456511/11 [==============================] - 0s 25ms/step - loss: 0.5151 - accuracy: 0.4571
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4075 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.4072 - accuracy: 0.4527 5/11 [============>.................] - ETA: 0s - loss: 0.4044 - accuracy: 0.4496 8/11 [====================>.........] - ETA: 0s - loss: 0.3992 - accuracy: 0.448111/11 [==============================] - ETA: 0s - loss: 0.3940 - accuracy: 0.450811/11 [==============================] - 0s 25ms/step - loss: 0.3927 - accuracy: 0.4515
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3315 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.3544 - accuracy: 0.4771 7/11 [==================>...........] - ETA: 0s - loss: 0.3566 - accuracy: 0.4647 9/11 [=======================>......] - ETA: 0s - loss: 0.3566 - accuracy: 0.462211/11 [==============================] - 0s 25ms/step - loss: 0.3557 - accuracy: 0.4617
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3384 - accuracy: 0.4141 4/11 [=========>....................] - ETA: 0s - loss: 0.3393 - accuracy: 0.4372 6/11 [===============>..............] - ETA: 0s - loss: 0.3418 - accuracy: 0.4403 9/11 [=======================>......] - ETA: 0s - loss: 0.3418 - accuracy: 0.445811/11 [==============================] - 0s 24ms/step - loss: 0.3400 - accuracy: 0.4490
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3069 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.3122 - accuracy: 0.4349 6/11 [===============>..............] - ETA: 0s - loss: 0.3150 - accuracy: 0.4336 8/11 [====================>.........] - ETA: 0s - loss: 0.3148 - accuracy: 0.437711/11 [==============================] - ETA: 0s - loss: 0.3137 - accuracy: 0.445311/11 [==============================] - 0s 24ms/step - loss: 0.3134 - accuracy: 0.4472
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2881 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.2876 - accuracy: 0.5049 7/11 [==================>...........] - ETA: 0s - loss: 0.2870 - accuracy: 0.4961 9/11 [=======================>......] - ETA: 0s - loss: 0.2866 - accuracy: 0.490911/11 [==============================] - ETA: 0s - loss: 0.2860 - accuracy: 0.487811/11 [==============================] - 0s 24ms/step - loss: 0.2857 - accuracy: 0.4866
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2471 - accuracy: 0.5859 3/11 [=======>......................] - ETA: 0s - loss: 0.2476 - accuracy: 0.5304 6/11 [===============>..............] - ETA: 0s - loss: 0.2534 - accuracy: 0.4974 9/11 [=======================>......] - ETA: 0s - loss: 0.2541 - accuracy: 0.489111/11 [==============================] - 0s 23ms/step - loss: 0.2534 - accuracy: 0.4888
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2247 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.2288 - accuracy: 0.5278 6/11 [===============>..............] - ETA: 0s - loss: 0.2288 - accuracy: 0.5203 9/11 [=======================>......] - ETA: 0s - loss: 0.2283 - accuracy: 0.517911/11 [==============================] - 0s 25ms/step - loss: 0.2276 - accuracy: 0.5195
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2053 - accuracy: 0.6328 3/11 [=======>......................] - ETA: 0s - loss: 0.2056 - accuracy: 0.6007 6/11 [===============>..............] - ETA: 0s - loss: 0.2048 - accuracy: 0.5831 8/11 [====================>.........] - ETA: 0s - loss: 0.2055 - accuracy: 0.578411/11 [==============================] - ETA: 0s - loss: 0.2053 - accuracy: 0.578211/11 [==============================] - 0s 25ms/step - loss: 0.2054 - accuracy: 0.5782
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2201 - accuracy: 0.5938 3/11 [=======>......................] - ETA: 0s - loss: 0.2034 - accuracy: 0.5786 6/11 [===============>..............] - ETA: 0s - loss: 0.1969 - accuracy: 0.5882 9/11 [=======================>......] - ETA: 0s - loss: 0.1949 - accuracy: 0.594311/11 [==============================] - ETA: 0s - loss: 0.1941 - accuracy: 0.596611/11 [==============================] - 0s 26ms/step - loss: 0.1937 - accuracy: 0.5974
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2001 - accuracy: 0.5859 4/11 [=========>....................] - ETA: 0s - loss: 0.1849 - accuracy: 0.5978 7/11 [==================>...........] - ETA: 0s - loss: 0.1828 - accuracy: 0.6033 9/11 [=======================>......] - ETA: 0s - loss: 0.1826 - accuracy: 0.606711/11 [==============================] - 0s 25ms/step - loss: 0.1813 - accuracy: 0.6116
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1780 - accuracy: 0.6719 4/11 [=========>....................] - ETA: 0s - loss: 0.1692 - accuracy: 0.6476 7/11 [==================>...........] - ETA: 0s - loss: 0.1677 - accuracy: 0.6416 9/11 [=======================>......] - ETA: 0s - loss: 0.1667 - accuracy: 0.640411/11 [==============================] - 0s 24ms/step - loss: 0.1660 - accuracy: 0.6380
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1450 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.1575 - accuracy: 0.6914 6/11 [===============>..............] - ETA: 0s - loss: 0.1574 - accuracy: 0.7080 8/11 [====================>.........] - ETA: 0s - loss: 0.1567 - accuracy: 0.717011/11 [==============================] - ETA: 0s - loss: 0.1561 - accuracy: 0.726511/11 [==============================] - 0s 24ms/step - loss: 0.1559 - accuracy: 0.7290
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1674 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.1595 - accuracy: 0.7096 6/11 [===============>..............] - ETA: 0s - loss: 0.1557 - accuracy: 0.7162 9/11 [=======================>......] - ETA: 0s - loss: 0.1523 - accuracy: 0.722411/11 [==============================] - 0s 24ms/step - loss: 0.1503 - accuracy: 0.7312
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1541 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.1412 - accuracy: 0.8207 6/11 [===============>..............] - ETA: 0s - loss: 0.1386 - accuracy: 0.8106 8/11 [====================>.........] - ETA: 0s - loss: 0.1379 - accuracy: 0.798011/11 [==============================] - ETA: 0s - loss: 0.1372 - accuracy: 0.788511/11 [==============================] - 0s 26ms/step - loss: 0.1370 - accuracy: 0.7868
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1254 - accuracy: 0.8359 4/11 [=========>....................] - ETA: 0s - loss: 0.1256 - accuracy: 0.8442 6/11 [===============>..............] - ETA: 0s - loss: 0.1263 - accuracy: 0.8504 9/11 [=======================>......] - ETA: 0s - loss: 0.1269 - accuracy: 0.852511/11 [==============================] - 0s 24ms/step - loss: 0.1267 - accuracy: 0.8528
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1343 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.1305 - accuracy: 0.7917 6/11 [===============>..............] - ETA: 0s - loss: 0.1271 - accuracy: 0.8017 8/11 [====================>.........] - ETA: 0s - loss: 0.1253 - accuracy: 0.809011/11 [==============================] - ETA: 0s - loss: 0.1235 - accuracy: 0.819211/11 [==============================] - 0s 24ms/step - loss: 0.1231 - accuracy: 0.8218
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1210 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 0s - loss: 0.1199 - accuracy: 0.8351 6/11 [===============>..............] - ETA: 0s - loss: 0.1178 - accuracy: 0.8282 9/11 [=======================>......] - ETA: 0s - loss: 0.1172 - accuracy: 0.827111/11 [==============================] - 0s 23ms/step - loss: 0.1159 - accuracy: 0.8287
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1189 - accuracy: 0.85946/6 [==============================] - ETA: 0s - loss: 0.1176 - accuracy: 0.8739 6/6 [==============================] - 5s 10ms/step - loss: 0.1176 - accuracy: 0.8739
2021-12-13 23:40:04.512696: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:40:04.514188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:40:04.514272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:40:04.514338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:40:04.514383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:40:04.514436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:40:04.514489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:40:04.514546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:40:04.514598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:40:04.514653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:40:04.515659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:40:04.515722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:40:04.515741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:40:04.515756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:40:04.516838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:40:04.517315: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:40:04.517882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:40:04.517939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:40:04.517985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:40:04.518028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:40:04.518068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:40:04.518115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:40:04.518162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:40:04.518203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:40:04.518249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:40:04.519276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:40:04.519319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:40:04.519338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:40:04.519352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:40:04.520438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [0.01766331 0.75360054 0.8312296  0.00320197 0.00084453]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [1.6809423e-02 7.5829822e-01 8.4062201e-01 3.1634700e-03 8.0370641e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 0 4] pred: [4.1752114e-04 1.0116864e-02 9.5542353e-01 1.0604646e-02 3.2687301e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 1 4 0] pred: [3.0891155e-04 5.3305109e-03 9.7826630e-01 1.8339174e-02 4.2265770e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [1.3189695e-02 8.1553835e-01 8.4041959e-01 3.4520829e-03 5.2474742e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 0 4] pred: [3.4568878e-04 5.9024477e-03 9.7941935e-01 1.1720042e-02 2.7347595e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [0.02739689 0.7745785  0.7788715  0.00286098 0.00110049]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [0.07337699 0.87057084 0.39384925 0.0018721  0.00107026]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [0.023666   0.89171565 0.59333    0.00521758 0.00113238]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [4.7086002e-03 8.8038689e-01 8.7947762e-01 4.1302615e-03 1.8986510e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [4.3322015e-04 1.4688908e-01 9.5446289e-01 6.7141936e-03 2.2623195e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [1.4095133e-02 8.4677672e-01 8.2820749e-01 3.1389929e-03 5.9391133e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 0 4] pred: [4.4430434e-04 6.1835293e-03 9.6688932e-01 1.1493837e-02 3.7994140e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 4 0] pred: [5.80499356e-04 1.23550845e-02 9.03216124e-01 7.74219632e-02
 2.15631770e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [0 4 1 3 2] pred: [0.8830637  0.46394622 0.01971027 0.1822335  0.6169378 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:32 - loss: 0.6962 - accuracy: 0.1719 4/11 [=========>....................] - ETA: 0s - loss: 0.6919 - accuracy: 0.2401   6/11 [===============>..............] - ETA: 0s - loss: 0.6893 - accuracy: 0.2796 8/11 [====================>.........] - ETA: 0s - loss: 0.6865 - accuracy: 0.310011/11 [==============================] - ETA: 0s - loss: 0.6825 - accuracy: 0.337011/11 [==============================] - 16s 24ms/step - loss: 0.6814 - accuracy: 0.3429
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6307 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.6273 - accuracy: 0.4787 6/11 [===============>..............] - ETA: 0s - loss: 0.6243 - accuracy: 0.4681 8/11 [====================>.........] - ETA: 0s - loss: 0.6206 - accuracy: 0.464910/11 [==========================>...] - ETA: 0s - loss: 0.6165 - accuracy: 0.463411/11 [==============================] - 0s 26ms/step - loss: 0.6128 - accuracy: 0.4634
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5545 - accuracy: 0.3672 3/11 [=======>......................] - ETA: 0s - loss: 0.5407 - accuracy: 0.4041 5/11 [============>.................] - ETA: 0s - loss: 0.5313 - accuracy: 0.4214 7/11 [==================>...........] - ETA: 0s - loss: 0.5229 - accuracy: 0.4304 9/11 [=======================>......] - ETA: 0s - loss: 0.5150 - accuracy: 0.435911/11 [==============================] - 0s 27ms/step - loss: 0.5044 - accuracy: 0.4430
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3930 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.3962 - accuracy: 0.4365 7/11 [==================>...........] - ETA: 0s - loss: 0.3938 - accuracy: 0.4403 9/11 [=======================>......] - ETA: 0s - loss: 0.3906 - accuracy: 0.442911/11 [==============================] - 0s 25ms/step - loss: 0.3852 - accuracy: 0.4475
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3917 - accuracy: 0.4141 4/11 [=========>....................] - ETA: 0s - loss: 0.3810 - accuracy: 0.4344 6/11 [===============>..............] - ETA: 0s - loss: 0.3754 - accuracy: 0.4429 9/11 [=======================>......] - ETA: 0s - loss: 0.3684 - accuracy: 0.449711/11 [==============================] - 0s 25ms/step - loss: 0.3629 - accuracy: 0.4530
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3132 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.3211 - accuracy: 0.4957 5/11 [============>.................] - ETA: 0s - loss: 0.3223 - accuracy: 0.4882 8/11 [====================>.........] - ETA: 0s - loss: 0.3244 - accuracy: 0.480711/11 [==============================] - ETA: 0s - loss: 0.3247 - accuracy: 0.477611/11 [==============================] - 0s 25ms/step - loss: 0.3250 - accuracy: 0.4765
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2880 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.3005 - accuracy: 0.4629 6/11 [===============>..............] - ETA: 0s - loss: 0.3025 - accuracy: 0.4638 9/11 [=======================>......] - ETA: 0s - loss: 0.3034 - accuracy: 0.464311/11 [==============================] - 0s 24ms/step - loss: 0.3041 - accuracy: 0.4642
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2815 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.2904 - accuracy: 0.4504 6/11 [===============>..............] - ETA: 0s - loss: 0.2903 - accuracy: 0.4515 9/11 [=======================>......] - ETA: 0s - loss: 0.2892 - accuracy: 0.455211/11 [==============================] - 0s 25ms/step - loss: 0.2877 - accuracy: 0.4577
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2541 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.2539 - accuracy: 0.4948 5/11 [============>.................] - ETA: 0s - loss: 0.2539 - accuracy: 0.5007 7/11 [==================>...........] - ETA: 0s - loss: 0.2544 - accuracy: 0.5015 9/11 [=======================>......] - ETA: 0s - loss: 0.2545 - accuracy: 0.500511/11 [==============================] - 0s 26ms/step - loss: 0.2545 - accuracy: 0.4985
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2330 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.2336 - accuracy: 0.5269 6/11 [===============>..............] - ETA: 0s - loss: 0.2337 - accuracy: 0.5326 8/11 [====================>.........] - ETA: 0s - loss: 0.2327 - accuracy: 0.535811/11 [==============================] - ETA: 0s - loss: 0.2317 - accuracy: 0.540111/11 [==============================] - 0s 26ms/step - loss: 0.2314 - accuracy: 0.5411
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2153 - accuracy: 0.5469 4/11 [=========>....................] - ETA: 0s - loss: 0.2125 - accuracy: 0.5669 6/11 [===============>..............] - ETA: 0s - loss: 0.2114 - accuracy: 0.5727 9/11 [=======================>......] - ETA: 0s - loss: 0.2094 - accuracy: 0.577711/11 [==============================] - ETA: 0s - loss: 0.2091 - accuracy: 0.577511/11 [==============================] - 0s 26ms/step - loss: 0.2090 - accuracy: 0.5775
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1978 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.2041 - accuracy: 0.5777 5/11 [============>.................] - ETA: 0s - loss: 0.2025 - accuracy: 0.5801 8/11 [====================>.........] - ETA: 0s - loss: 0.1998 - accuracy: 0.584611/11 [==============================] - ETA: 0s - loss: 0.1979 - accuracy: 0.585611/11 [==============================] - 0s 26ms/step - loss: 0.1975 - accuracy: 0.5861
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1602 - accuracy: 0.6484 4/11 [=========>....................] - ETA: 0s - loss: 0.1738 - accuracy: 0.6364 7/11 [==================>...........] - ETA: 0s - loss: 0.1741 - accuracy: 0.632910/11 [==========================>...] - ETA: 0s - loss: 0.1752 - accuracy: 0.627011/11 [==============================] - 0s 24ms/step - loss: 0.1755 - accuracy: 0.6246
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1463 - accuracy: 0.6094 3/11 [=======>......................] - ETA: 0s - loss: 0.1555 - accuracy: 0.6315 6/11 [===============>..............] - ETA: 0s - loss: 0.1603 - accuracy: 0.6366 9/11 [=======================>......] - ETA: 0s - loss: 0.1612 - accuracy: 0.642511/11 [==============================] - 0s 26ms/step - loss: 0.1621 - accuracy: 0.6438
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1529 - accuracy: 0.6562 4/11 [=========>....................] - ETA: 0s - loss: 0.1569 - accuracy: 0.6628 6/11 [===============>..............] - ETA: 0s - loss: 0.1565 - accuracy: 0.6657 9/11 [=======================>......] - ETA: 0s - loss: 0.1555 - accuracy: 0.664311/11 [==============================] - ETA: 0s - loss: 0.1553 - accuracy: 0.663611/11 [==============================] - 0s 26ms/step - loss: 0.1552 - accuracy: 0.6631
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1478 - accuracy: 0.7031 4/11 [=========>....................] - ETA: 0s - loss: 0.1468 - accuracy: 0.7279 6/11 [===============>..............] - ETA: 0s - loss: 0.1458 - accuracy: 0.7324 9/11 [=======================>......] - ETA: 0s - loss: 0.1461 - accuracy: 0.731511/11 [==============================] - 0s 26ms/step - loss: 0.1460 - accuracy: 0.7281
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1459 - accuracy: 0.6484 3/11 [=======>......................] - ETA: 0s - loss: 0.1434 - accuracy: 0.6714 5/11 [============>.................] - ETA: 0s - loss: 0.1403 - accuracy: 0.6796 7/11 [==================>...........] - ETA: 0s - loss: 0.1401 - accuracy: 0.681410/11 [==========================>...] - ETA: 0s - loss: 0.1397 - accuracy: 0.685111/11 [==============================] - 0s 26ms/step - loss: 0.1393 - accuracy: 0.6895
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1328 - accuracy: 0.8125 4/11 [=========>....................] - ETA: 0s - loss: 0.1309 - accuracy: 0.7812 7/11 [==================>...........] - ETA: 0s - loss: 0.1307 - accuracy: 0.769910/11 [==========================>...] - ETA: 0s - loss: 0.1306 - accuracy: 0.761011/11 [==============================] - 0s 25ms/step - loss: 0.1305 - accuracy: 0.7583
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1307 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.1344 - accuracy: 0.7786 6/11 [===============>..............] - ETA: 0s - loss: 0.1317 - accuracy: 0.7669 9/11 [=======================>......] - ETA: 0s - loss: 0.1294 - accuracy: 0.759111/11 [==============================] - ETA: 0s - loss: 0.1283 - accuracy: 0.759711/11 [==============================] - 0s 25ms/step - loss: 0.1279 - accuracy: 0.7601
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.0983 - accuracy: 0.8516 4/11 [=========>....................] - ETA: 0s - loss: 0.1111 - accuracy: 0.8605 6/11 [===============>..............] - ETA: 0s - loss: 0.1134 - accuracy: 0.8569 8/11 [====================>.........] - ETA: 0s - loss: 0.1138 - accuracy: 0.852310/11 [==========================>...] - ETA: 0s - loss: 0.1143 - accuracy: 0.845711/11 [==============================] - 0s 25ms/step - loss: 0.1149 - accuracy: 0.8397
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1119 - accuracy: 0.73446/6 [==============================] - 5s 9ms/step - loss: 0.1250 - accuracy: 0.7210
2021-12-13 23:40:41.125392: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:40:41.126212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:40:41.126287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:40:41.126349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:40:41.126392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:40:41.126442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:40:41.126492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:40:41.126542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:40:41.126592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:40:41.126640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:40:41.127607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:40:41.127668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:40:41.127686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:40:41.127700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:40:41.128725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:40:41.129395: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:40:41.129765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:40:41.129793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:40:41.129821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:40:41.129849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:40:41.129876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:40:41.129918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:40:41.129959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:40:41.129999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:40:41.130026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:40:41.130707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:40:41.130735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:40:41.130747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:40:41.130756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:40:41.131514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [4.6710509e-05 2.1693900e-02 9.8200315e-01 3.8421501e-03 1.3403875e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [2.095855e-03 5.749758e-01 8.686573e-01 5.393500e-03 8.051306e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 4 0] pred: [3.7861151e-05 1.4224118e-02 9.8316264e-01 3.6778240e-03 1.5472037e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [4.1072133e-05 1.5096928e-02 9.8321193e-01 3.4696714e-03 1.4957243e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [4.0279141e-05 1.5769953e-02 9.8280519e-01 3.6949271e-03 1.5206193e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 4 0] pred: [3.8473569e-05 1.5502614e-02 9.8278111e-01 3.8020876e-03 1.5056417e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [4 3 2 0 1] pred: [0.0242162  0.00728263 0.05338535 0.51604545 0.71629626]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 4 0] pred: [5.1595598e-05 8.0597652e-03 9.4490099e-01 1.2876089e-02 3.2176692e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [2.9949795e-03 7.6679778e-01 8.7764961e-01 4.3696533e-03 6.4631633e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 4 0] pred: [8.2939041e-05 1.0003716e-02 8.8113678e-01 3.2348257e-02 4.1449722e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [4.8846603e-05 2.0916447e-02 9.7822833e-01 4.5101652e-03 1.5751956e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [4.1723117e-05 1.8911997e-02 9.8224002e-01 3.9592059e-03 1.4186422e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [3.4961281e-03 7.6590693e-01 8.9336032e-01 4.5712451e-03 7.1221992e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [3.9153721e-05 1.4257673e-02 9.8249775e-01 3.7175454e-03 1.5415039e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 4 1 0] pred: [2.6979434e-04 7.3667318e-03 4.8261514e-01 2.4303563e-01 1.3896790e-02]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:38 - loss: 0.6914 - accuracy: 0.2188 3/11 [=======>......................] - ETA: 0s - loss: 0.6885 - accuracy: 0.3112   6/11 [===============>..............] - ETA: 0s - loss: 0.6844 - accuracy: 0.3518 8/11 [====================>.........] - ETA: 0s - loss: 0.6815 - accuracy: 0.367710/11 [==========================>...] - ETA: 0s - loss: 0.6786 - accuracy: 0.380111/11 [==============================] - 16s 26ms/step - loss: 0.6761 - accuracy: 0.3887
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6229 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.6197 - accuracy: 0.4831 5/11 [============>.................] - ETA: 0s - loss: 0.6158 - accuracy: 0.4781 8/11 [====================>.........] - ETA: 0s - loss: 0.6103 - accuracy: 0.468910/11 [==========================>...] - ETA: 0s - loss: 0.6066 - accuracy: 0.464211/11 [==============================] - 0s 25ms/step - loss: 0.6030 - accuracy: 0.4618
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5282 - accuracy: 0.4062 4/11 [=========>....................] - ETA: 0s - loss: 0.5195 - accuracy: 0.4274 7/11 [==================>...........] - ETA: 0s - loss: 0.5101 - accuracy: 0.4356 9/11 [=======================>......] - ETA: 0s - loss: 0.5037 - accuracy: 0.438311/11 [==============================] - 0s 24ms/step - loss: 0.4949 - accuracy: 0.4411
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3929 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.3936 - accuracy: 0.4418 6/11 [===============>..............] - ETA: 0s - loss: 0.3883 - accuracy: 0.4460 8/11 [====================>.........] - ETA: 0s - loss: 0.3843 - accuracy: 0.447910/11 [==========================>...] - ETA: 0s - loss: 0.3808 - accuracy: 0.449111/11 [==============================] - 0s 26ms/step - loss: 0.3785 - accuracy: 0.4492
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3291 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.3446 - accuracy: 0.4341 6/11 [===============>..............] - ETA: 0s - loss: 0.3446 - accuracy: 0.4423 9/11 [=======================>......] - ETA: 0s - loss: 0.3452 - accuracy: 0.447211/11 [==============================] - 0s 25ms/step - loss: 0.3456 - accuracy: 0.4474
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3137 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.3079 - accuracy: 0.4440 5/11 [============>.................] - ETA: 0s - loss: 0.3133 - accuracy: 0.4415 8/11 [====================>.........] - ETA: 0s - loss: 0.3163 - accuracy: 0.441010/11 [==========================>...] - ETA: 0s - loss: 0.3176 - accuracy: 0.442711/11 [==============================] - 0s 25ms/step - loss: 0.3186 - accuracy: 0.4441
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3148 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.3167 - accuracy: 0.4705 6/11 [===============>..............] - ETA: 0s - loss: 0.3136 - accuracy: 0.4650 9/11 [=======================>......] - ETA: 0s - loss: 0.3105 - accuracy: 0.462911/11 [==============================] - 0s 25ms/step - loss: 0.3089 - accuracy: 0.4604
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2929 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.2926 - accuracy: 0.4720 6/11 [===============>..............] - ETA: 0s - loss: 0.2925 - accuracy: 0.4649 8/11 [====================>.........] - ETA: 0s - loss: 0.2911 - accuracy: 0.463211/11 [==============================] - ETA: 0s - loss: 0.2892 - accuracy: 0.462811/11 [==============================] - 0s 25ms/step - loss: 0.2886 - accuracy: 0.4628
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2498 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.2508 - accuracy: 0.5187 6/11 [===============>..............] - ETA: 0s - loss: 0.2532 - accuracy: 0.5079 9/11 [=======================>......] - ETA: 0s - loss: 0.2537 - accuracy: 0.501011/11 [==============================] - 0s 26ms/step - loss: 0.2542 - accuracy: 0.4950
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2211 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.2304 - accuracy: 0.4470 5/11 [============>.................] - ETA: 0s - loss: 0.2324 - accuracy: 0.4664 8/11 [====================>.........] - ETA: 0s - loss: 0.2310 - accuracy: 0.486311/11 [==============================] - ETA: 0s - loss: 0.2299 - accuracy: 0.496111/11 [==============================] - 0s 25ms/step - loss: 0.2296 - accuracy: 0.4988
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2226 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.2200 - accuracy: 0.5299 5/11 [============>.................] - ETA: 0s - loss: 0.2174 - accuracy: 0.5408 7/11 [==================>...........] - ETA: 0s - loss: 0.2153 - accuracy: 0.547610/11 [==========================>...] - ETA: 0s - loss: 0.2111 - accuracy: 0.555811/11 [==============================] - 0s 26ms/step - loss: 0.2091 - accuracy: 0.5599
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1821 - accuracy: 0.6094 3/11 [=======>......................] - ETA: 0s - loss: 0.1808 - accuracy: 0.6011 6/11 [===============>..............] - ETA: 0s - loss: 0.1818 - accuracy: 0.5989 8/11 [====================>.........] - ETA: 0s - loss: 0.1818 - accuracy: 0.604410/11 [==========================>...] - ETA: 0s - loss: 0.1812 - accuracy: 0.608311/11 [==============================] - 0s 26ms/step - loss: 0.1808 - accuracy: 0.6113
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1614 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.1645 - accuracy: 0.6853 5/11 [============>.................] - ETA: 0s - loss: 0.1648 - accuracy: 0.6828 7/11 [==================>...........] - ETA: 0s - loss: 0.1654 - accuracy: 0.676710/11 [==========================>...] - ETA: 0s - loss: 0.1651 - accuracy: 0.671011/11 [==============================] - 0s 25ms/step - loss: 0.1649 - accuracy: 0.6694
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1542 - accuracy: 0.6641 4/11 [=========>....................] - ETA: 0s - loss: 0.1542 - accuracy: 0.6610 6/11 [===============>..............] - ETA: 0s - loss: 0.1547 - accuracy: 0.6732 9/11 [=======================>......] - ETA: 0s - loss: 0.1549 - accuracy: 0.686611/11 [==============================] - 0s 25ms/step - loss: 0.1545 - accuracy: 0.6906
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1396 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.1448 - accuracy: 0.7296 5/11 [============>.................] - ETA: 0s - loss: 0.1469 - accuracy: 0.7148 7/11 [==================>...........] - ETA: 0s - loss: 0.1475 - accuracy: 0.710510/11 [==========================>...] - ETA: 0s - loss: 0.1469 - accuracy: 0.710211/11 [==============================] - 0s 27ms/step - loss: 0.1465 - accuracy: 0.7113
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1383 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 0s - loss: 0.1428 - accuracy: 0.7582 6/11 [===============>..............] - ETA: 0s - loss: 0.1421 - accuracy: 0.7439 8/11 [====================>.........] - ETA: 0s - loss: 0.1413 - accuracy: 0.741410/11 [==========================>...] - ETA: 0s - loss: 0.1401 - accuracy: 0.740611/11 [==============================] - 0s 26ms/step - loss: 0.1393 - accuracy: 0.7403
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1282 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.1214 - accuracy: 0.7917 6/11 [===============>..............] - ETA: 0s - loss: 0.1233 - accuracy: 0.7733 8/11 [====================>.........] - ETA: 0s - loss: 0.1235 - accuracy: 0.766710/11 [==========================>...] - ETA: 0s - loss: 0.1237 - accuracy: 0.764411/11 [==============================] - 0s 26ms/step - loss: 0.1243 - accuracy: 0.7637
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1133 - accuracy: 0.8047 4/11 [=========>....................] - ETA: 0s - loss: 0.1191 - accuracy: 0.8021 6/11 [===============>..............] - ETA: 0s - loss: 0.1211 - accuracy: 0.7990 8/11 [====================>.........] - ETA: 0s - loss: 0.1218 - accuracy: 0.794911/11 [==============================] - ETA: 0s - loss: 0.1218 - accuracy: 0.791311/11 [==============================] - 0s 25ms/step - loss: 0.1217 - accuracy: 0.7906
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1155 - accuracy: 0.8672 4/11 [=========>....................] - ETA: 0s - loss: 0.1133 - accuracy: 0.8254 6/11 [===============>..............] - ETA: 0s - loss: 0.1133 - accuracy: 0.8199 8/11 [====================>.........] - ETA: 0s - loss: 0.1136 - accuracy: 0.817010/11 [==========================>...] - ETA: 0s - loss: 0.1137 - accuracy: 0.814711/11 [==============================] - 0s 26ms/step - loss: 0.1138 - accuracy: 0.8133
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1118 - accuracy: 0.7656 4/11 [=========>....................] - ETA: 0s - loss: 0.1183 - accuracy: 0.7645 6/11 [===============>..............] - ETA: 0s - loss: 0.1167 - accuracy: 0.7646 8/11 [====================>.........] - ETA: 0s - loss: 0.1151 - accuracy: 0.767410/11 [==========================>...] - ETA: 0s - loss: 0.1140 - accuracy: 0.771811/11 [==============================] - 0s 25ms/step - loss: 0.1131 - accuracy: 0.7760
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1309 - accuracy: 0.84386/6 [==============================] - ETA: 0s - loss: 0.1191 - accuracy: 0.8144 6/6 [==============================] - 5s 10ms/step - loss: 0.1191 - accuracy: 0.8144
2021-12-13 23:41:17.256426: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:41:17.257481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:41:17.257542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:41:17.257588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:41:17.257620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:41:17.257654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:41:17.257692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:41:17.257727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:41:17.257778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:41:17.257813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:41:17.258516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:41:17.258560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:41:17.258573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:41:17.258582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:41:17.259621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:41:17.259954: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:41:17.260321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:41:17.260350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:41:17.260378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:41:17.260405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:41:17.260431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:41:17.260458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:41:17.260488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:41:17.260515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:41:17.260543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:41:17.261225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:41:17.261253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:41:17.261265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:41:17.261274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:41:17.261988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 3 0 4] pred: [0.00330121 0.8433194  0.6625466  0.00389522 0.00107011]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [2.7635731e-03 9.0529341e-01 7.9900879e-01 1.7232406e-03 6.0383423e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 0 4] pred: [0.00285035 0.00367708 0.9774959  0.02448781 0.00283342]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [1.8965825e-03 8.8088030e-01 8.5315770e-01 1.2845497e-03 4.0074743e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 0 4] pred: [0.00198622 0.00526009 0.984791   0.02065415 0.0013204 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [2.1784792e-03 9.1162747e-01 7.1083695e-01 1.5366253e-03 9.0175902e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [1.7955088e-03 8.6888862e-01 9.1081429e-01 8.6642092e-04 3.0566173e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [3 2 4 0 1] pred: [0.0152465  0.00318533 0.12327581 0.76048195 0.07464988]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 3 4] pred: [5.9430260e-04 7.4596530e-01 9.3742073e-01 5.2813895e-04 1.8965700e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 0 4] pred: [1.9441870e-03 9.4908038e-03 9.8381054e-01 1.4010896e-02 8.4321538e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [4 3 2 0 1] pred: [0.04153418 0.00952664 0.05167183 0.35858342 0.79297006]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 2 4 0 1] pred: [0.01214381 0.00276517 0.13537744 0.8081519  0.05733604]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [1.71213446e-03 1.24634905e-02 9.75830317e-01 7.42464373e-03
 7.30037456e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [0.00425933 0.9311145  0.63249093 0.0027742  0.00105718]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 0 4] pred: [0.00221527 0.00571188 0.98295516 0.01759264 0.00135171]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:30 - loss: 0.6958 - accuracy: 0.0547 3/11 [=======>......................] - ETA: 0s - loss: 0.6932 - accuracy: 0.0985   5/11 [============>.................] - ETA: 0s - loss: 0.6906 - accuracy: 0.1742 8/11 [====================>.........] - ETA: 0s - loss: 0.6866 - accuracy: 0.240411/11 [==============================] - ETA: 0s - loss: 0.6827 - accuracy: 0.279711/11 [==============================] - 15s 23ms/step - loss: 0.6817 - accuracy: 0.2887
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6335 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.6301 - accuracy: 0.4497 6/11 [===============>..............] - ETA: 0s - loss: 0.6269 - accuracy: 0.4457 9/11 [=======================>......] - ETA: 0s - loss: 0.6215 - accuracy: 0.446011/11 [==============================] - 0s 23ms/step - loss: 0.6162 - accuracy: 0.4478
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5456 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.5363 - accuracy: 0.4535 7/11 [==================>...........] - ETA: 0s - loss: 0.5269 - accuracy: 0.459810/11 [==========================>...] - ETA: 0s - loss: 0.5181 - accuracy: 0.460411/11 [==============================] - 0s 23ms/step - loss: 0.5134 - accuracy: 0.4590
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4140 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.4050 - accuracy: 0.4795 7/11 [==================>...........] - ETA: 0s - loss: 0.4008 - accuracy: 0.468010/11 [==========================>...] - ETA: 0s - loss: 0.3969 - accuracy: 0.463111/11 [==============================] - 0s 23ms/step - loss: 0.3947 - accuracy: 0.4612
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3517 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.3693 - accuracy: 0.4492 6/11 [===============>..............] - ETA: 0s - loss: 0.3661 - accuracy: 0.4478 9/11 [=======================>......] - ETA: 0s - loss: 0.3610 - accuracy: 0.449311/11 [==============================] - 0s 23ms/step - loss: 0.3587 - accuracy: 0.4506
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3590 - accuracy: 0.3672 3/11 [=======>......................] - ETA: 0s - loss: 0.3552 - accuracy: 0.3889 6/11 [===============>..............] - ETA: 0s - loss: 0.3510 - accuracy: 0.4101 9/11 [=======================>......] - ETA: 0s - loss: 0.3472 - accuracy: 0.420011/11 [==============================] - 0s 22ms/step - loss: 0.3448 - accuracy: 0.4272
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2891 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.3134 - accuracy: 0.4661 7/11 [==================>...........] - ETA: 0s - loss: 0.3156 - accuracy: 0.462810/11 [==========================>...] - ETA: 0s - loss: 0.3161 - accuracy: 0.460211/11 [==============================] - 0s 23ms/step - loss: 0.3161 - accuracy: 0.4593
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3137 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.3129 - accuracy: 0.4302 7/11 [==================>...........] - ETA: 0s - loss: 0.3077 - accuracy: 0.438810/11 [==========================>...] - ETA: 0s - loss: 0.3036 - accuracy: 0.444911/11 [==============================] - 0s 21ms/step - loss: 0.3015 - accuracy: 0.4482
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3052 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.2822 - accuracy: 0.4720 7/11 [==================>...........] - ETA: 0s - loss: 0.2744 - accuracy: 0.474610/11 [==========================>...] - ETA: 0s - loss: 0.2714 - accuracy: 0.473311/11 [==============================] - 0s 22ms/step - loss: 0.2701 - accuracy: 0.4734
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2629 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 0s - loss: 0.2500 - accuracy: 0.4759 6/11 [===============>..............] - ETA: 0s - loss: 0.2482 - accuracy: 0.4841 8/11 [====================>.........] - ETA: 0s - loss: 0.2468 - accuracy: 0.487711/11 [==============================] - ETA: 0s - loss: 0.2445 - accuracy: 0.493011/11 [==============================] - 0s 24ms/step - loss: 0.2440 - accuracy: 0.4938
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2436 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 0s - loss: 0.2324 - accuracy: 0.5360 7/11 [==================>...........] - ETA: 0s - loss: 0.2279 - accuracy: 0.535910/11 [==========================>...] - ETA: 0s - loss: 0.2251 - accuracy: 0.536511/11 [==============================] - 0s 23ms/step - loss: 0.2237 - accuracy: 0.5357
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2030 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.1982 - accuracy: 0.5699 6/11 [===============>..............] - ETA: 0s - loss: 0.2005 - accuracy: 0.5656 9/11 [=======================>......] - ETA: 0s - loss: 0.2019 - accuracy: 0.566411/11 [==============================] - 0s 22ms/step - loss: 0.2016 - accuracy: 0.5690
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1783 - accuracy: 0.5547 4/11 [=========>....................] - ETA: 0s - loss: 0.1922 - accuracy: 0.5527 7/11 [==================>...........] - ETA: 0s - loss: 0.1928 - accuracy: 0.567710/11 [==========================>...] - ETA: 0s - loss: 0.1918 - accuracy: 0.576011/11 [==============================] - 0s 24ms/step - loss: 0.1911 - accuracy: 0.5795
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1737 - accuracy: 0.5781 4/11 [=========>....................] - ETA: 0s - loss: 0.1742 - accuracy: 0.6084 7/11 [==================>...........] - ETA: 0s - loss: 0.1748 - accuracy: 0.621510/11 [==========================>...] - ETA: 0s - loss: 0.1751 - accuracy: 0.630511/11 [==============================] - 0s 24ms/step - loss: 0.1750 - accuracy: 0.6353
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1523 - accuracy: 0.6172 4/11 [=========>....................] - ETA: 0s - loss: 0.1556 - accuracy: 0.6484 7/11 [==================>...........] - ETA: 0s - loss: 0.1591 - accuracy: 0.659510/11 [==========================>...] - ETA: 0s - loss: 0.1608 - accuracy: 0.669311/11 [==============================] - 0s 24ms/step - loss: 0.1614 - accuracy: 0.6735
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1617 - accuracy: 0.6953 4/11 [=========>....................] - ETA: 0s - loss: 0.1644 - accuracy: 0.6774 6/11 [===============>..............] - ETA: 0s - loss: 0.1620 - accuracy: 0.6830 9/11 [=======================>......] - ETA: 0s - loss: 0.1602 - accuracy: 0.693611/11 [==============================] - 0s 25ms/step - loss: 0.1591 - accuracy: 0.7005
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1566 - accuracy: 0.7578 4/11 [=========>....................] - ETA: 0s - loss: 0.1439 - accuracy: 0.7515 7/11 [==================>...........] - ETA: 0s - loss: 0.1438 - accuracy: 0.757210/11 [==========================>...] - ETA: 0s - loss: 0.1444 - accuracy: 0.761411/11 [==============================] - 0s 23ms/step - loss: 0.1444 - accuracy: 0.7629
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1312 - accuracy: 0.8828 4/11 [=========>....................] - ETA: 0s - loss: 0.1386 - accuracy: 0.8571 7/11 [==================>...........] - ETA: 0s - loss: 0.1370 - accuracy: 0.8464 9/11 [=======================>......] - ETA: 0s - loss: 0.1368 - accuracy: 0.838311/11 [==============================] - 0s 24ms/step - loss: 0.1366 - accuracy: 0.8320
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1232 - accuracy: 0.8047 4/11 [=========>....................] - ETA: 0s - loss: 0.1182 - accuracy: 0.8325 7/11 [==================>...........] - ETA: 0s - loss: 0.1204 - accuracy: 0.825510/11 [==========================>...] - ETA: 0s - loss: 0.1217 - accuracy: 0.819011/11 [==============================] - 0s 23ms/step - loss: 0.1226 - accuracy: 0.8183
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1121 - accuracy: 0.8984 4/11 [=========>....................] - ETA: 0s - loss: 0.1275 - accuracy: 0.8607 7/11 [==================>...........] - ETA: 0s - loss: 0.1256 - accuracy: 0.851110/11 [==========================>...] - ETA: 0s - loss: 0.1241 - accuracy: 0.848911/11 [==============================] - 0s 23ms/step - loss: 0.1236 - accuracy: 0.8482
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1105 - accuracy: 0.88286/6 [==============================] - ETA: 0s - loss: 0.1197 - accuracy: 0.8782 6/6 [==============================] - 5s 11ms/step - loss: 0.1197 - accuracy: 0.8782
2021-12-13 23:41:53.225967: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:41:53.226768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:41:53.226841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:41:53.226899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:41:53.226953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:41:53.227004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:41:53.227053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:41:53.227106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:41:53.227154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:41:53.227205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:41:53.228171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:41:53.228231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:41:53.228248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:41:53.228262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:41:53.229517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:41:53.229805: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:41:53.230183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:41:53.230212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:41:53.230240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:41:53.230267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:41:53.230294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:41:53.230325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:41:53.230355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:41:53.230383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:41:53.230410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:41:53.231124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:41:53.231152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:41:53.231164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:41:53.231172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:41:53.231915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [2.3288280e-04 1.9443829e-02 9.7621208e-01 5.9815352e-03 3.4063109e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [2.8360714e-03 6.3513726e-01 9.0107304e-01 5.3065997e-03 5.8212300e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [0.00855864 0.7964498  0.72889465 0.00447894 0.00106476]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [1.7198432e-02 9.3518007e-01 8.0683953e-01 3.0126383e-03 9.3231921e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [4 3 0 2 1] pred: [0.09709303 0.00679794 0.02190918 0.54858434 0.88927734]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.0932984  0.806043   0.5179832  0.01642876 0.00915442]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 4 0] pred: [0.00285413 0.00936864 0.75307024 0.05830761 0.00493888]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [0.03364278 0.7649545  0.65978736 0.01039225 0.00429795]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [0 4 1 3 2] pred: [0.8289735  0.34563786 0.02461899 0.2587233  0.40550116]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [9.3114078e-03 9.1060263e-01 8.5912657e-01 3.4743208e-03 6.5722852e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [4.6916297e-04 9.6173279e-02 9.5276350e-01 5.5988887e-03 2.7877072e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 2 4 0 1] pred: [0.04788234 0.00859528 0.16582233 0.80769646 0.11593218]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [2.6866695e-04 3.9269704e-02 9.7101825e-01 6.5096579e-03 2.7414659e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [6.3888780e-03 8.7224710e-01 8.8477302e-01 4.5746784e-03 7.7754195e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [3.3083613e-04 3.0487033e-02 9.6932328e-01 8.4406128e-03 4.3583036e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:37 - loss: 0.6906 - accuracy: 0.3438 3/11 [=======>......................] - ETA: 0s - loss: 0.6879 - accuracy: 0.3342   5/11 [============>.................] - ETA: 0s - loss: 0.6850 - accuracy: 0.3488 7/11 [==================>...........] - ETA: 0s - loss: 0.6821 - accuracy: 0.365010/11 [==========================>...] - ETA: 0s - loss: 0.6778 - accuracy: 0.381111/11 [==============================] - 16s 25ms/step - loss: 0.6752 - accuracy: 0.3887
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6206 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.6194 - accuracy: 0.4770 5/11 [============>.................] - ETA: 0s - loss: 0.6155 - accuracy: 0.4778 7/11 [==================>...........] - ETA: 0s - loss: 0.6117 - accuracy: 0.4719 9/11 [=======================>......] - ETA: 0s - loss: 0.6075 - accuracy: 0.467711/11 [==============================] - ETA: 0s - loss: 0.6030 - accuracy: 0.466711/11 [==============================] - 0s 28ms/step - loss: 0.6012 - accuracy: 0.4663
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5326 - accuracy: 0.3828 3/11 [=======>......................] - ETA: 0s - loss: 0.5185 - accuracy: 0.4397 6/11 [===============>..............] - ETA: 0s - loss: 0.5042 - accuracy: 0.4651 9/11 [=======================>......] - ETA: 0s - loss: 0.4943 - accuracy: 0.469111/11 [==============================] - 0s 24ms/step - loss: 0.4855 - accuracy: 0.4678
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3704 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.3797 - accuracy: 0.4450 7/11 [==================>...........] - ETA: 0s - loss: 0.3810 - accuracy: 0.443510/11 [==========================>...] - ETA: 0s - loss: 0.3769 - accuracy: 0.448011/11 [==============================] - 0s 25ms/step - loss: 0.3744 - accuracy: 0.4505
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3220 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.3305 - accuracy: 0.4223 6/11 [===============>..............] - ETA: 0s - loss: 0.3345 - accuracy: 0.4348 8/11 [====================>.........] - ETA: 0s - loss: 0.3352 - accuracy: 0.440810/11 [==========================>...] - ETA: 0s - loss: 0.3360 - accuracy: 0.444711/11 [==============================] - 0s 25ms/step - loss: 0.3367 - accuracy: 0.4477
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3262 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.3276 - accuracy: 0.4683 5/11 [============>.................] - ETA: 0s - loss: 0.3273 - accuracy: 0.4640 8/11 [====================>.........] - ETA: 0s - loss: 0.3274 - accuracy: 0.461110/11 [==========================>...] - ETA: 0s - loss: 0.3269 - accuracy: 0.461011/11 [==============================] - 0s 26ms/step - loss: 0.3264 - accuracy: 0.4613
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2976 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.3080 - accuracy: 0.4629 6/11 [===============>..............] - ETA: 0s - loss: 0.3068 - accuracy: 0.4658 8/11 [====================>.........] - ETA: 0s - loss: 0.3062 - accuracy: 0.466710/11 [==========================>...] - ETA: 0s - loss: 0.3063 - accuracy: 0.467611/11 [==============================] - 0s 27ms/step - loss: 0.3063 - accuracy: 0.4683
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2858 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 0s - loss: 0.2911 - accuracy: 0.4946 6/11 [===============>..............] - ETA: 0s - loss: 0.2927 - accuracy: 0.4874 9/11 [=======================>......] - ETA: 0s - loss: 0.2935 - accuracy: 0.480911/11 [==============================] - 0s 26ms/step - loss: 0.2926 - accuracy: 0.4811
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2845 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.2837 - accuracy: 0.4722 6/11 [===============>..............] - ETA: 0s - loss: 0.2804 - accuracy: 0.4804 8/11 [====================>.........] - ETA: 0s - loss: 0.2795 - accuracy: 0.483610/11 [==========================>...] - ETA: 0s - loss: 0.2786 - accuracy: 0.484911/11 [==============================] - 0s 26ms/step - loss: 0.2776 - accuracy: 0.4865
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2484 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.2483 - accuracy: 0.5191 6/11 [===============>..............] - ETA: 0s - loss: 0.2542 - accuracy: 0.5116 8/11 [====================>.........] - ETA: 0s - loss: 0.2551 - accuracy: 0.511910/11 [==========================>...] - ETA: 0s - loss: 0.2557 - accuracy: 0.511811/11 [==============================] - 0s 27ms/step - loss: 0.2559 - accuracy: 0.5119
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2498 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.2506 - accuracy: 0.5352 5/11 [============>.................] - ETA: 0s - loss: 0.2495 - accuracy: 0.5293 8/11 [====================>.........] - ETA: 0s - loss: 0.2481 - accuracy: 0.529510/11 [==========================>...] - ETA: 0s - loss: 0.2472 - accuracy: 0.531211/11 [==============================] - 0s 27ms/step - loss: 0.2461 - accuracy: 0.5317
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2149 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.2271 - accuracy: 0.5438 5/11 [============>.................] - ETA: 0s - loss: 0.2270 - accuracy: 0.5526 7/11 [==================>...........] - ETA: 0s - loss: 0.2272 - accuracy: 0.5498 9/11 [=======================>......] - ETA: 0s - loss: 0.2275 - accuracy: 0.547511/11 [==============================] - 0s 27ms/step - loss: 0.2266 - accuracy: 0.5482
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2354 - accuracy: 0.6250 4/11 [=========>....................] - ETA: 0s - loss: 0.2240 - accuracy: 0.5986 6/11 [===============>..............] - ETA: 0s - loss: 0.2189 - accuracy: 0.5954 8/11 [====================>.........] - ETA: 0s - loss: 0.2164 - accuracy: 0.590011/11 [==============================] - ETA: 0s - loss: 0.2141 - accuracy: 0.585911/11 [==============================] - 0s 26ms/step - loss: 0.2135 - accuracy: 0.5852
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1763 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.1850 - accuracy: 0.5781 6/11 [===============>..............] - ETA: 0s - loss: 0.1906 - accuracy: 0.5859 9/11 [=======================>......] - ETA: 0s - loss: 0.1913 - accuracy: 0.590611/11 [==============================] - 0s 24ms/step - loss: 0.1917 - accuracy: 0.5920
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1803 - accuracy: 0.6016 3/11 [=======>......................] - ETA: 0s - loss: 0.1806 - accuracy: 0.6063 5/11 [============>.................] - ETA: 0s - loss: 0.1829 - accuracy: 0.6107 8/11 [====================>.........] - ETA: 0s - loss: 0.1832 - accuracy: 0.618810/11 [==========================>...] - ETA: 0s - loss: 0.1834 - accuracy: 0.619211/11 [==============================] - 0s 26ms/step - loss: 0.1830 - accuracy: 0.6200
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1813 - accuracy: 0.6094 4/11 [=========>....................] - ETA: 0s - loss: 0.1756 - accuracy: 0.6221 6/11 [===============>..............] - ETA: 0s - loss: 0.1743 - accuracy: 0.6224 9/11 [=======================>......] - ETA: 0s - loss: 0.1726 - accuracy: 0.624211/11 [==============================] - ETA: 0s - loss: 0.1721 - accuracy: 0.627011/11 [==============================] - 0s 25ms/step - loss: 0.1719 - accuracy: 0.6282
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1659 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.1654 - accuracy: 0.6359 6/11 [===============>..............] - ETA: 0s - loss: 0.1668 - accuracy: 0.6271 8/11 [====================>.........] - ETA: 0s - loss: 0.1663 - accuracy: 0.628510/11 [==========================>...] - ETA: 0s - loss: 0.1654 - accuracy: 0.629411/11 [==============================] - 0s 26ms/step - loss: 0.1643 - accuracy: 0.6322
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1524 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.1519 - accuracy: 0.7389 6/11 [===============>..............] - ETA: 0s - loss: 0.1515 - accuracy: 0.7406 9/11 [=======================>......] - ETA: 0s - loss: 0.1509 - accuracy: 0.735911/11 [==============================] - 0s 25ms/step - loss: 0.1504 - accuracy: 0.7303
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1405 - accuracy: 0.6797 4/11 [=========>....................] - ETA: 0s - loss: 0.1390 - accuracy: 0.6794 6/11 [===============>..............] - ETA: 0s - loss: 0.1384 - accuracy: 0.6839 8/11 [====================>.........] - ETA: 0s - loss: 0.1392 - accuracy: 0.686010/11 [==========================>...] - ETA: 0s - loss: 0.1394 - accuracy: 0.688011/11 [==============================] - 0s 26ms/step - loss: 0.1395 - accuracy: 0.6898
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1501 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 0s - loss: 0.1384 - accuracy: 0.7530 6/11 [===============>..............] - ETA: 0s - loss: 0.1348 - accuracy: 0.7611 9/11 [=======================>......] - ETA: 0s - loss: 0.1344 - accuracy: 0.763111/11 [==============================] - ETA: 0s - loss: 0.1343 - accuracy: 0.759511/11 [==============================] - 0s 25ms/step - loss: 0.1342 - accuracy: 0.7581
Evaluate on test data
1/6 [====>.........................] - ETA: 23s - loss: 0.1354 - accuracy: 0.68756/6 [==============================] - 5s 9ms/step - loss: 0.1362 - accuracy: 0.6941
2021-12-13 23:42:29.243831: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:42:29.244689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:42:29.244771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:42:29.244834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:42:29.244881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:42:29.244943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:42:29.245002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:42:29.245058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:42:29.245114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:42:29.245169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:42:29.246235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:42:29.246302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:42:29.246321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:42:29.246337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:42:29.247467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:42:29.247913: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:42:29.248521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:42:29.248568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:42:29.248613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:42:29.248658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:42:29.248701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:42:29.248750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:42:29.248798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:42:29.248842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:42:29.248890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:42:29.250244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:42:29.250289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:42:29.250307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:42:29.250321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:42:29.251404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 1 2 0] pred: [0.01993177 0.05141433 0.03184394 0.7497491  0.17670366]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [6.1137429e-03 7.1667820e-01 7.9033452e-01 1.0221865e-02 5.3161709e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 0 2 3 4] pred: [0.31783235 0.354176   0.1339254  0.08832096 0.04499546]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 1 4 0] pred: [1.8012553e-04 9.5979962e-03 8.7817055e-01 5.6020409e-02 1.4224722e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [3.4575707e-03 6.0471320e-01 8.9966291e-01 4.3950211e-03 2.1332542e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 2 1 0] pred: [0.0114528  0.02209721 0.07665654 0.8164944  0.2625319 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [2.5686363e-04 4.4879224e-02 9.8083258e-01 2.4932425e-03 1.5535447e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [1.9220205e-02 7.9908216e-01 7.7310574e-01 6.1119469e-03 5.7677832e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [0 1 2 4 3] pred: [0.6929594  0.4985385  0.09490252 0.01327351 0.01749427]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [2.903482e-04 5.390729e-02 9.825653e-01 2.290573e-03 1.507579e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [3.4753941e-03 6.1284095e-01 9.3389714e-01 4.3906835e-03 2.3390220e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [1.3643604e-02 7.7585745e-01 8.2225376e-01 6.4398292e-03 4.8922858e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.22924393 0.7304839  0.29629818 0.00556869 0.00272368]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [9.0565998e-03 7.6082432e-01 8.7010181e-01 5.2769720e-03 4.0071824e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 2 1 0] pred: [0.02002633 0.02254973 0.09140501 0.53774154 0.51637703]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:38 - loss: 0.6982 - accuracy: 0.1094 3/11 [=======>......................] - ETA: 0s - loss: 0.6951 - accuracy: 0.2292   6/11 [===============>..............] - ETA: 0s - loss: 0.6907 - accuracy: 0.3124 9/11 [=======================>......] - ETA: 0s - loss: 0.6864 - accuracy: 0.349311/11 [==============================] - 16s 23ms/step - loss: 0.6826 - accuracy: 0.3685
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6273 - accuracy: 0.5469 4/11 [=========>....................] - ETA: 0s - loss: 0.6246 - accuracy: 0.5091 7/11 [==================>...........] - ETA: 0s - loss: 0.6198 - accuracy: 0.499210/11 [==========================>...] - ETA: 0s - loss: 0.6148 - accuracy: 0.489811/11 [==============================] - 0s 23ms/step - loss: 0.6116 - accuracy: 0.4855
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5333 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.5265 - accuracy: 0.4645 7/11 [==================>...........] - ETA: 0s - loss: 0.5191 - accuracy: 0.4658 9/11 [=======================>......] - ETA: 0s - loss: 0.5134 - accuracy: 0.467211/11 [==============================] - 0s 24ms/step - loss: 0.5063 - accuracy: 0.4667
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4010 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.3986 - accuracy: 0.4521 6/11 [===============>..............] - ETA: 0s - loss: 0.3955 - accuracy: 0.4547 9/11 [=======================>......] - ETA: 0s - loss: 0.3916 - accuracy: 0.455311/11 [==============================] - 0s 23ms/step - loss: 0.3886 - accuracy: 0.4571
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3543 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.3543 - accuracy: 0.4832 7/11 [==================>...........] - ETA: 0s - loss: 0.3567 - accuracy: 0.476510/11 [==========================>...] - ETA: 0s - loss: 0.3554 - accuracy: 0.472711/11 [==============================] - 0s 23ms/step - loss: 0.3546 - accuracy: 0.4713
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3471 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.3429 - accuracy: 0.4948 7/11 [==================>...........] - ETA: 0s - loss: 0.3402 - accuracy: 0.478110/11 [==========================>...] - ETA: 0s - loss: 0.3372 - accuracy: 0.475711/11 [==============================] - 0s 23ms/step - loss: 0.3360 - accuracy: 0.4737
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3063 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.3086 - accuracy: 0.4893 7/11 [==================>...........] - ETA: 0s - loss: 0.3099 - accuracy: 0.481010/11 [==========================>...] - ETA: 0s - loss: 0.3104 - accuracy: 0.476711/11 [==============================] - 0s 24ms/step - loss: 0.3104 - accuracy: 0.4750
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2826 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.2851 - accuracy: 0.4733 7/11 [==================>...........] - ETA: 0s - loss: 0.2852 - accuracy: 0.473110/11 [==========================>...] - ETA: 0s - loss: 0.2868 - accuracy: 0.473511/11 [==============================] - 0s 23ms/step - loss: 0.2872 - accuracy: 0.4742
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2859 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.2816 - accuracy: 0.4733 7/11 [==================>...........] - ETA: 0s - loss: 0.2787 - accuracy: 0.481310/11 [==========================>...] - ETA: 0s - loss: 0.2765 - accuracy: 0.484611/11 [==============================] - 0s 24ms/step - loss: 0.2750 - accuracy: 0.4863
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2455 - accuracy: 0.5547 4/11 [=========>....................] - ETA: 0s - loss: 0.2438 - accuracy: 0.5378 7/11 [==================>...........] - ETA: 0s - loss: 0.2458 - accuracy: 0.527410/11 [==========================>...] - ETA: 0s - loss: 0.2462 - accuracy: 0.523211/11 [==============================] - 0s 24ms/step - loss: 0.2462 - accuracy: 0.5223
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2595 - accuracy: 0.5391 4/11 [=========>....................] - ETA: 0s - loss: 0.2449 - accuracy: 0.5503 7/11 [==================>...........] - ETA: 0s - loss: 0.2402 - accuracy: 0.561410/11 [==========================>...] - ETA: 0s - loss: 0.2371 - accuracy: 0.568011/11 [==============================] - 0s 24ms/step - loss: 0.2356 - accuracy: 0.5725
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2187 - accuracy: 0.6172 4/11 [=========>....................] - ETA: 0s - loss: 0.2187 - accuracy: 0.5858 7/11 [==================>...........] - ETA: 0s - loss: 0.2174 - accuracy: 0.586210/11 [==========================>...] - ETA: 0s - loss: 0.2159 - accuracy: 0.591211/11 [==============================] - 0s 22ms/step - loss: 0.2152 - accuracy: 0.5955
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2134 - accuracy: 0.5938 4/11 [=========>....................] - ETA: 0s - loss: 0.2017 - accuracy: 0.6235 7/11 [==================>...........] - ETA: 0s - loss: 0.1989 - accuracy: 0.633110/11 [==========================>...] - ETA: 0s - loss: 0.1982 - accuracy: 0.637211/11 [==============================] - 0s 22ms/step - loss: 0.1978 - accuracy: 0.6377
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1696 - accuracy: 0.6719 4/11 [=========>....................] - ETA: 0s - loss: 0.1730 - accuracy: 0.6810 7/11 [==================>...........] - ETA: 0s - loss: 0.1755 - accuracy: 0.671810/11 [==========================>...] - ETA: 0s - loss: 0.1765 - accuracy: 0.667311/11 [==============================] - 0s 23ms/step - loss: 0.1770 - accuracy: 0.6659
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1809 - accuracy: 0.7344 4/11 [=========>....................] - ETA: 0s - loss: 0.1757 - accuracy: 0.6898 7/11 [==================>...........] - ETA: 0s - loss: 0.1717 - accuracy: 0.681310/11 [==========================>...] - ETA: 0s - loss: 0.1692 - accuracy: 0.682811/11 [==============================] - 0s 23ms/step - loss: 0.1682 - accuracy: 0.6825
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1361 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.1432 - accuracy: 0.6940 6/11 [===============>..............] - ETA: 0s - loss: 0.1444 - accuracy: 0.6902 9/11 [=======================>......] - ETA: 0s - loss: 0.1444 - accuracy: 0.687811/11 [==============================] - 0s 23ms/step - loss: 0.1450 - accuracy: 0.6871
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1266 - accuracy: 0.7500 4/11 [=========>....................] - ETA: 0s - loss: 0.1335 - accuracy: 0.7544 7/11 [==================>...........] - ETA: 0s - loss: 0.1353 - accuracy: 0.754210/11 [==========================>...] - ETA: 0s - loss: 0.1359 - accuracy: 0.757711/11 [==============================] - 0s 23ms/step - loss: 0.1358 - accuracy: 0.7589
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1266 - accuracy: 0.7578 4/11 [=========>....................] - ETA: 0s - loss: 0.1296 - accuracy: 0.7661 7/11 [==================>...........] - ETA: 0s - loss: 0.1278 - accuracy: 0.763310/11 [==========================>...] - ETA: 0s - loss: 0.1268 - accuracy: 0.762711/11 [==============================] - 0s 24ms/step - loss: 0.1264 - accuracy: 0.7632
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1061 - accuracy: 0.8359 4/11 [=========>....................] - ETA: 0s - loss: 0.1138 - accuracy: 0.8249 7/11 [==================>...........] - ETA: 0s - loss: 0.1162 - accuracy: 0.816910/11 [==========================>...] - ETA: 0s - loss: 0.1171 - accuracy: 0.813211/11 [==============================] - 0s 24ms/step - loss: 0.1169 - accuracy: 0.8120
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1130 - accuracy: 0.7812 4/11 [=========>....................] - ETA: 0s - loss: 0.1086 - accuracy: 0.7900 7/11 [==================>...........] - ETA: 0s - loss: 0.1078 - accuracy: 0.796010/11 [==========================>...] - ETA: 0s - loss: 0.1080 - accuracy: 0.797911/11 [==============================] - 0s 23ms/step - loss: 0.1080 - accuracy: 0.7978
Evaluate on test data
1/6 [====>.........................] - ETA: 23s - loss: 0.0950 - accuracy: 0.76566/6 [==============================] - ETA: 0s - loss: 0.1035 - accuracy: 0.7380 6/6 [==============================] - 5s 11ms/step - loss: 0.1035 - accuracy: 0.7380
2021-12-13 23:43:04.899005: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:43:04.900026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:43:04.900124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:43:04.900217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:43:04.900260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:43:04.900304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:43:04.900349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:43:04.900394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:43:04.900439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:43:04.900484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:43:04.901504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:43:04.901560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:43:04.901578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:43:04.901591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:43:04.902642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-13 23:43:04.903183: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:43:04.903708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-13 23:43:04.903748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:43:04.903787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:43:04.903826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:43:04.903863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:43:04.903901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:43:04.903951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:43:04.903992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:43:04.904031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:43:04.904996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-13 23:43:04.905036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:43:04.905054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:43:04.905067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:43:04.906071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [2.3310659e-03 7.3769242e-01 9.2476141e-01 3.0302149e-03 2.6402582e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 3 0 4] pred: [0.04269513 0.821972   0.16845372 0.0658206  0.00507887]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [1.4853779e-03 6.6256726e-01 8.7027234e-01 6.0352189e-03 3.3162622e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [5.8744106e-05 1.4123457e-02 9.8605818e-01 5.1874365e-03 4.8541417e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [4.3781150e-05 2.5685983e-02 9.8750728e-01 3.9594313e-03 2.9457186e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 4 0] pred: [4.3189480e-05 4.0012680e-02 9.9258423e-01 4.0227897e-03 1.8859019e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [5.6642351e-05 2.1376692e-02 9.8785943e-01 5.0417869e-03 3.4939512e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [0 1 4 2 3] pred: [0.80890554 0.24502794 0.03544474 0.00894896 0.05396202]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [8.6209868e-05 2.2238510e-02 9.8259950e-01 5.1851212e-03 5.4325006e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [5.1561436e-03 8.0222958e-01 8.5633576e-01 3.4107554e-03 3.7556246e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [3 2 4 1 0] pred: [0.0019553  0.00613523 0.09521684 0.80655354 0.06332013]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [0 1 4 3 2] pred: [0.8410953  0.21185547 0.01586303 0.0209265  0.07564901]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [4 3 2 0 1] pred: [0.03867395 0.00176601 0.05036996 0.25248832 0.67007804]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [1.4370575e-04 2.3881424e-02 9.6879017e-01 4.4477317e-03 6.3859741e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [4.9306713e-03 7.4361217e-01 8.7797850e-01 2.8958332e-03 3.9526363e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:38 - loss: 0.6920 - accuracy: 0.2656 3/11 [=======>......................] - ETA: 0s - loss: 0.6891 - accuracy: 0.3194   6/11 [===============>..............] - ETA: 0s - loss: 0.6847 - accuracy: 0.3740 9/11 [=======================>......] - ETA: 0s - loss: 0.6803 - accuracy: 0.393911/11 [==============================] - 16s 24ms/step - loss: 0.6762 - accuracy: 0.4050
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6252 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.6200 - accuracy: 0.4648 5/11 [============>.................] - ETA: 0s - loss: 0.6155 - accuracy: 0.4636 7/11 [==================>...........] - ETA: 0s - loss: 0.6114 - accuracy: 0.460010/11 [==========================>...] - ETA: 0s - loss: 0.6048 - accuracy: 0.460211/11 [==============================] - 0s 25ms/step - loss: 0.6007 - accuracy: 0.4609
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5262 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.5163 - accuracy: 0.4314 5/11 [============>.................] - ETA: 0s - loss: 0.5092 - accuracy: 0.4336 7/11 [==================>...........] - ETA: 0s - loss: 0.5020 - accuracy: 0.4346 9/11 [=======================>......] - ETA: 0s - loss: 0.4947 - accuracy: 0.439611/11 [==============================] - 0s 25ms/step - loss: 0.4855 - accuracy: 0.4458
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3814 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.3812 - accuracy: 0.4609 6/11 [===============>..............] - ETA: 0s - loss: 0.3776 - accuracy: 0.4592 8/11 [====================>.........] - ETA: 0s - loss: 0.3751 - accuracy: 0.459610/11 [==========================>...] - ETA: 0s - loss: 0.3740 - accuracy: 0.459611/11 [==============================] - 0s 25ms/step - loss: 0.3726 - accuracy: 0.4605
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3389 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.3484 - accuracy: 0.4753 5/11 [============>.................] - ETA: 0s - loss: 0.3488 - accuracy: 0.4700 8/11 [====================>.........] - ETA: 0s - loss: 0.3466 - accuracy: 0.470610/11 [==========================>...] - ETA: 0s - loss: 0.3460 - accuracy: 0.469211/11 [==============================] - 0s 26ms/step - loss: 0.3454 - accuracy: 0.4685
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3104 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.3280 - accuracy: 0.4818 6/11 [===============>..............] - ETA: 0s - loss: 0.3293 - accuracy: 0.4754 8/11 [====================>.........] - ETA: 0s - loss: 0.3289 - accuracy: 0.472511/11 [==============================] - ETA: 0s - loss: 0.3274 - accuracy: 0.471211/11 [==============================] - 0s 25ms/step - loss: 0.3271 - accuracy: 0.4706
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3053 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.3070 - accuracy: 0.4930 7/11 [==================>...........] - ETA: 0s - loss: 0.3079 - accuracy: 0.4831 9/11 [=======================>......] - ETA: 0s - loss: 0.3077 - accuracy: 0.479911/11 [==============================] - 0s 25ms/step - loss: 0.3063 - accuracy: 0.4770
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2952 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 0s - loss: 0.2933 - accuracy: 0.4805 6/11 [===============>..............] - ETA: 0s - loss: 0.2903 - accuracy: 0.4776 8/11 [====================>.........] - ETA: 0s - loss: 0.2882 - accuracy: 0.474910/11 [==========================>...] - ETA: 0s - loss: 0.2868 - accuracy: 0.473811/11 [==============================] - 0s 24ms/step - loss: 0.2852 - accuracy: 0.4743
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2607 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.2602 - accuracy: 0.4761 5/11 [============>.................] - ETA: 0s - loss: 0.2600 - accuracy: 0.4832 7/11 [==================>...........] - ETA: 0s - loss: 0.2588 - accuracy: 0.488510/11 [==========================>...] - ETA: 0s - loss: 0.2575 - accuracy: 0.492611/11 [==============================] - 0s 26ms/step - loss: 0.2570 - accuracy: 0.4942
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2372 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 0s - loss: 0.2332 - accuracy: 0.5570 6/11 [===============>..............] - ETA: 0s - loss: 0.2340 - accuracy: 0.5580 9/11 [=======================>......] - ETA: 0s - loss: 0.2349 - accuracy: 0.557611/11 [==============================] - 0s 24ms/step - loss: 0.2350 - accuracy: 0.5564
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2269 - accuracy: 0.5938 3/11 [=======>......................] - ETA: 0s - loss: 0.2186 - accuracy: 0.5929 6/11 [===============>..............] - ETA: 0s - loss: 0.2172 - accuracy: 0.5833 8/11 [====================>.........] - ETA: 0s - loss: 0.2175 - accuracy: 0.578511/11 [==============================] - ETA: 0s - loss: 0.2182 - accuracy: 0.576611/11 [==============================] - 0s 24ms/step - loss: 0.2184 - accuracy: 0.5768
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2054 - accuracy: 0.6016 4/11 [=========>....................] - ETA: 0s - loss: 0.2055 - accuracy: 0.6025 6/11 [===============>..............] - ETA: 0s - loss: 0.2055 - accuracy: 0.6024 9/11 [=======================>......] - ETA: 0s - loss: 0.2066 - accuracy: 0.601511/11 [==============================] - 0s 24ms/step - loss: 0.2064 - accuracy: 0.6006
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2084 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.1993 - accuracy: 0.5777 6/11 [===============>..............] - ETA: 0s - loss: 0.1972 - accuracy: 0.5939 9/11 [=======================>......] - ETA: 0s - loss: 0.1958 - accuracy: 0.604811/11 [==============================] - 0s 25ms/step - loss: 0.1946 - accuracy: 0.6102
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1921 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.1808 - accuracy: 0.6632 6/11 [===============>..............] - ETA: 0s - loss: 0.1797 - accuracy: 0.6488 9/11 [=======================>......] - ETA: 0s - loss: 0.1795 - accuracy: 0.646211/11 [==============================] - ETA: 0s - loss: 0.1791 - accuracy: 0.649311/11 [==============================] - 0s 26ms/step - loss: 0.1789 - accuracy: 0.6508
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1742 - accuracy: 0.6094 3/11 [=======>......................] - ETA: 0s - loss: 0.1686 - accuracy: 0.6576 6/11 [===============>..............] - ETA: 0s - loss: 0.1685 - accuracy: 0.6674 8/11 [====================>.........] - ETA: 0s - loss: 0.1676 - accuracy: 0.670610/11 [==========================>...] - ETA: 0s - loss: 0.1669 - accuracy: 0.674911/11 [==============================] - 0s 26ms/step - loss: 0.1662 - accuracy: 0.6793
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1438 - accuracy: 0.7266 3/11 [=======>......................] - ETA: 0s - loss: 0.1501 - accuracy: 0.7335 5/11 [============>.................] - ETA: 0s - loss: 0.1513 - accuracy: 0.7281 8/11 [====================>.........] - ETA: 0s - loss: 0.1520 - accuracy: 0.723810/11 [==========================>...] - ETA: 0s - loss: 0.1515 - accuracy: 0.724511/11 [==============================] - 0s 26ms/step - loss: 0.1514 - accuracy: 0.7253
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1237 - accuracy: 0.7109 3/11 [=======>......................] - ETA: 0s - loss: 0.1296 - accuracy: 0.7292 5/11 [============>.................] - ETA: 0s - loss: 0.1327 - accuracy: 0.7380 8/11 [====================>.........] - ETA: 0s - loss: 0.1347 - accuracy: 0.742210/11 [==========================>...] - ETA: 0s - loss: 0.1355 - accuracy: 0.743911/11 [==============================] - 0s 25ms/step - loss: 0.1360 - accuracy: 0.7445
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1308 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 0s - loss: 0.1318 - accuracy: 0.8316 5/11 [============>.................] - ETA: 0s - loss: 0.1322 - accuracy: 0.8218 8/11 [====================>.........] - ETA: 0s - loss: 0.1320 - accuracy: 0.809311/11 [==============================] - ETA: 0s - loss: 0.1311 - accuracy: 0.803411/11 [==============================] - 0s 24ms/step - loss: 0.1309 - accuracy: 0.8025
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1149 - accuracy: 0.8594 4/11 [=========>....................] - ETA: 0s - loss: 0.1178 - accuracy: 0.8742 6/11 [===============>..............] - ETA: 0s - loss: 0.1193 - accuracy: 0.8710 8/11 [====================>.........] - ETA: 0s - loss: 0.1193 - accuracy: 0.868011/11 [==============================] - ETA: 0s - loss: 0.1194 - accuracy: 0.863811/11 [==============================] - 0s 25ms/step - loss: 0.1194 - accuracy: 0.8627
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1077 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.1157 - accuracy: 0.7431 6/11 [===============>..............] - ETA: 0s - loss: 0.1146 - accuracy: 0.7696 9/11 [=======================>......] - ETA: 0s - loss: 0.1140 - accuracy: 0.790611/11 [==============================] - 0s 23ms/step - loss: 0.1143 - accuracy: 0.8058
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.1302 - accuracy: 0.84386/6 [==============================] - ETA: 0s - loss: 0.1170 - accuracy: 0.8555 6/6 [==============================] - 5s 10ms/step - loss: 0.1170 - accuracy: 0.8555
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [1.1760948e-03 1.8671961e-01 9.3898088e-01 2.4333538e-03 6.7889858e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [7.2470144e-03 4.4451553e-01 9.1587269e-01 8.6437771e-03 3.5848326e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [3.7765165e-03 5.1687473e-01 8.9851278e-01 2.5309932e-03 7.6175595e-05]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [9.2605426e-04 2.9783111e-02 9.1178429e-01 1.2036184e-02 4.1596696e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [7.8609232e-03 7.9440600e-01 8.5473931e-01 2.9465477e-03 1.3712223e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 3 0 4] pred: [0.01429302 0.75822735 0.6816759  0.03935958 0.00186822]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [5.8073044e-04 3.4642726e-02 9.7711986e-01 3.1533407e-03 1.1135325e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [8.74475576e-04 1.72789562e-02 9.42547321e-01 1.33559955e-02
 3.53143550e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [2.1206487e-02 8.9531928e-01 7.9109854e-01 3.2905340e-03 4.5747595e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [1.0828189e-02 8.3307791e-01 8.4203660e-01 3.1271072e-03 2.0873538e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [7.1935880e-04 2.8980033e-02 9.7342253e-01 4.0265284e-03 1.7687360e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [8.9607835e-03 6.6712767e-01 7.5015330e-01 2.1459494e-02 7.0101401e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [1.1201325e-02 8.9649898e-01 7.0274687e-01 6.4099864e-03 4.3870835e-04]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [0.07119631 0.6692975  0.5397547  0.00330058 0.00067432]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [1.5867097e-02 8.0462909e-01 7.5172603e-01 3.3007246e-03 3.7781437e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Job end at lun déc 13 23:43:42 CET 2021
