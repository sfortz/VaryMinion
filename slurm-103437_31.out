
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at lun déc 13 23:43:55 CET 2021
2021-12-13 23:43:56.664418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-13 23:44:01.931557: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:44:01.933165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-13 23:44:01.944329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:44:01.944371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:44:01.948650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:44:01.948694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:44:01.951796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:44:01.953074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:44:01.956479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:44:01.958736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:44:01.964754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:44:01.966033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:44:01.997180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:44:01.997222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:44:01.997237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:44:03.550713: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:44:03.551553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:44:03.551598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:44:03.551629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:44:03.551708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:44:03.551737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:44:03.551762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:44:03.551809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:44:03.551859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:44:03.551885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:44:03.553076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:44:03.553753: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:44:03.553775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:44:03.553784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2021-12-13 23:44:03.553889: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-13 23:44:06.615241: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-13 23:44:06.615852: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2593570000 Hz
Number of possible configurations: 40
Begining exécution of the 31 th configuration: BPIC20.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and bin_ce as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 58)          3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                21360     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:56 - loss: 3.4453 - accuracy: 0.0938 2/11 [====>.........................] - ETA: 0s - loss: 3.2528 - accuracy: 0.1562   3/11 [=======>......................] - ETA: 0s - loss: 3.0764 - accuracy: 0.1910 4/11 [=========>....................] - ETA: 0s - loss: 2.8955 - accuracy: 0.2145 5/11 [============>.................] - ETA: 0s - loss: 2.7356 - accuracy: 0.2313 6/11 [===============>..............] - ETA: 0s - loss: 2.5954 - accuracy: 0.2429 7/11 [==================>...........] - ETA: 0s - loss: 2.4723 - accuracy: 0.2517 8/11 [====================>.........] - ETA: 0s - loss: 2.3651 - accuracy: 0.2603 9/11 [=======================>......] - ETA: 0s - loss: 2.2708 - accuracy: 0.267310/11 [==========================>...] - ETA: 0s - loss: 2.1874 - accuracy: 0.273211/11 [==============================] - ETA: 0s - loss: 2.1145 - accuracy: 0.278111/11 [==============================] - 13s 102ms/step - loss: 2.0538 - accuracy: 0.2821
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6783 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.6660 - accuracy: 0.3945 3/11 [=======>......................] - ETA: 0s - loss: 0.6543 - accuracy: 0.3845 4/11 [=========>....................] - ETA: 0s - loss: 0.6470 - accuracy: 0.3905 5/11 [============>.................] - ETA: 0s - loss: 0.6434 - accuracy: 0.3977 6/11 [===============>..............] - ETA: 0s - loss: 0.6403 - accuracy: 0.4061 7/11 [==================>...........] - ETA: 0s - loss: 0.6373 - accuracy: 0.4153 8/11 [====================>.........] - ETA: 0s - loss: 0.6347 - accuracy: 0.4226 9/11 [=======================>......] - ETA: 0s - loss: 0.6324 - accuracy: 0.428910/11 [==========================>...] - ETA: 0s - loss: 0.6299 - accuracy: 0.434911/11 [==============================] - ETA: 0s - loss: 0.6278 - accuracy: 0.439711/11 [==============================] - 1s 97ms/step - loss: 0.6260 - accuracy: 0.4437
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5303 - accuracy: 0.5859 2/11 [====>.........................] - ETA: 1s - loss: 0.5362 - accuracy: 0.5664 3/11 [=======>......................] - ETA: 0s - loss: 0.5369 - accuracy: 0.5599 4/11 [=========>....................] - ETA: 0s - loss: 0.5374 - accuracy: 0.5547 5/11 [============>.................] - ETA: 0s - loss: 0.5375 - accuracy: 0.5528 6/11 [===============>..............] - ETA: 0s - loss: 0.5377 - accuracy: 0.5507 7/11 [==================>...........] - ETA: 0s - loss: 0.5371 - accuracy: 0.5503 8/11 [====================>.........] - ETA: 0s - loss: 0.5365 - accuracy: 0.5482 9/11 [=======================>......] - ETA: 0s - loss: 0.5360 - accuracy: 0.545110/11 [==========================>...] - ETA: 0s - loss: 0.5353 - accuracy: 0.542311/11 [==============================] - ETA: 0s - loss: 0.5347 - accuracy: 0.539611/11 [==============================] - 1s 108ms/step - loss: 0.5342 - accuracy: 0.5374
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4761 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.4766 - accuracy: 0.5254 3/11 [=======>......................] - ETA: 0s - loss: 0.4774 - accuracy: 0.5308 4/11 [=========>....................] - ETA: 0s - loss: 0.4776 - accuracy: 0.5314 5/11 [============>.................] - ETA: 0s - loss: 0.4785 - accuracy: 0.5289 6/11 [===============>..............] - ETA: 0s - loss: 0.4791 - accuracy: 0.5265 7/11 [==================>...........] - ETA: 0s - loss: 0.4793 - accuracy: 0.5238 8/11 [====================>.........] - ETA: 0s - loss: 0.4792 - accuracy: 0.5214 9/11 [=======================>......] - ETA: 0s - loss: 0.4789 - accuracy: 0.519410/11 [==========================>...] - ETA: 0s - loss: 0.4786 - accuracy: 0.517111/11 [==============================] - ETA: 0s - loss: 0.4784 - accuracy: 0.514811/11 [==============================] - 1s 101ms/step - loss: 0.4782 - accuracy: 0.5129
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4302 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.4322 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.4345 - accuracy: 0.5069 4/11 [=========>....................] - ETA: 0s - loss: 0.4360 - accuracy: 0.4984 5/11 [============>.................] - ETA: 0s - loss: 0.4370 - accuracy: 0.4928 6/11 [===============>..............] - ETA: 0s - loss: 0.4374 - accuracy: 0.4896 7/11 [==================>...........] - ETA: 0s - loss: 0.4369 - accuracy: 0.4895 8/11 [====================>.........] - ETA: 0s - loss: 0.4365 - accuracy: 0.4891 9/11 [=======================>......] - ETA: 0s - loss: 0.4358 - accuracy: 0.489410/11 [==========================>...] - ETA: 0s - loss: 0.4351 - accuracy: 0.489311/11 [==============================] - ETA: 0s - loss: 0.4345 - accuracy: 0.489111/11 [==============================] - 1s 103ms/step - loss: 0.4341 - accuracy: 0.4889
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4147 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.4063 - accuracy: 0.4473 3/11 [=======>......................] - ETA: 0s - loss: 0.4051 - accuracy: 0.4553 4/11 [=========>....................] - ETA: 0s - loss: 0.4038 - accuracy: 0.4587 5/11 [============>.................] - ETA: 0s - loss: 0.4034 - accuracy: 0.4591 6/11 [===============>..............] - ETA: 0s - loss: 0.4020 - accuracy: 0.4616 7/11 [==================>...........] - ETA: 0s - loss: 0.4004 - accuracy: 0.4636 8/11 [====================>.........] - ETA: 0s - loss: 0.3985 - accuracy: 0.4658 9/11 [=======================>......] - ETA: 0s - loss: 0.3965 - accuracy: 0.468210/11 [==========================>...] - ETA: 0s - loss: 0.3946 - accuracy: 0.470211/11 [==============================] - ETA: 0s - loss: 0.3930 - accuracy: 0.471711/11 [==============================] - 1s 99ms/step - loss: 0.3916 - accuracy: 0.4729
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3600 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.3547 - accuracy: 0.4883 3/11 [=======>......................] - ETA: 0s - loss: 0.3497 - accuracy: 0.4913 4/11 [=========>....................] - ETA: 0s - loss: 0.3455 - accuracy: 0.4964 5/11 [============>.................] - ETA: 0s - loss: 0.3429 - accuracy: 0.4996 6/11 [===============>..............] - ETA: 0s - loss: 0.3411 - accuracy: 0.5006 7/11 [==================>...........] - ETA: 0s - loss: 0.3395 - accuracy: 0.4998 8/11 [====================>.........] - ETA: 0s - loss: 0.3380 - accuracy: 0.4993 9/11 [=======================>......] - ETA: 0s - loss: 0.3366 - accuracy: 0.499110/11 [==========================>...] - ETA: 0s - loss: 0.3357 - accuracy: 0.498611/11 [==============================] - ETA: 0s - loss: 0.3352 - accuracy: 0.497511/11 [==============================] - 1s 97ms/step - loss: 0.3347 - accuracy: 0.4965
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3054 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.3071 - accuracy: 0.4863 3/11 [=======>......................] - ETA: 0s - loss: 0.3080 - accuracy: 0.4883 4/11 [=========>....................] - ETA: 0s - loss: 0.3091 - accuracy: 0.4858 5/11 [============>.................] - ETA: 0s - loss: 0.3080 - accuracy: 0.4862 6/11 [===============>..............] - ETA: 0s - loss: 0.3081 - accuracy: 0.4865 7/11 [==================>...........] - ETA: 0s - loss: 0.3077 - accuracy: 0.4872 8/11 [====================>.........] - ETA: 0s - loss: 0.3074 - accuracy: 0.4869 9/11 [=======================>......] - ETA: 0s - loss: 0.3068 - accuracy: 0.486810/11 [==========================>...] - ETA: 0s - loss: 0.3059 - accuracy: 0.487111/11 [==============================] - ETA: 0s - loss: 0.3051 - accuracy: 0.487411/11 [==============================] - 1s 100ms/step - loss: 0.3044 - accuracy: 0.4876
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2634 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.2710 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.2752 - accuracy: 0.4753 4/11 [=========>....................] - ETA: 0s - loss: 0.2755 - accuracy: 0.4761 5/11 [============>.................] - ETA: 0s - loss: 0.2764 - accuracy: 0.4765 6/11 [===============>..............] - ETA: 0s - loss: 0.2760 - accuracy: 0.4787 7/11 [==================>...........] - ETA: 0s - loss: 0.2759 - accuracy: 0.4811 8/11 [====================>.........] - ETA: 0s - loss: 0.2754 - accuracy: 0.4830 9/11 [=======================>......] - ETA: 0s - loss: 0.2754 - accuracy: 0.483710/11 [==========================>...] - ETA: 0s - loss: 0.2756 - accuracy: 0.484511/11 [==============================] - ETA: 0s - loss: 0.2756 - accuracy: 0.484911/11 [==============================] - 1s 98ms/step - loss: 0.2757 - accuracy: 0.4853
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2945 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.2918 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 0s - loss: 0.2905 - accuracy: 0.4631 4/11 [=========>....................] - ETA: 0s - loss: 0.2870 - accuracy: 0.4670 5/11 [============>.................] - ETA: 0s - loss: 0.2834 - accuracy: 0.4704 6/11 [===============>..............] - ETA: 0s - loss: 0.2810 - accuracy: 0.4721 7/11 [==================>...........] - ETA: 0s - loss: 0.2783 - accuracy: 0.4747 8/11 [====================>.........] - ETA: 0s - loss: 0.2762 - accuracy: 0.4773 9/11 [=======================>......] - ETA: 0s - loss: 0.2748 - accuracy: 0.479110/11 [==========================>...] - ETA: 0s - loss: 0.2733 - accuracy: 0.481311/11 [==============================] - ETA: 0s - loss: 0.2721 - accuracy: 0.482811/11 [==============================] - 1s 98ms/step - loss: 0.2712 - accuracy: 0.4840
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2596 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.2606 - accuracy: 0.5176 3/11 [=======>......................] - ETA: 0s - loss: 0.2583 - accuracy: 0.5100 4/11 [=========>....................] - ETA: 0s - loss: 0.2566 - accuracy: 0.5070 5/11 [============>.................] - ETA: 0s - loss: 0.2550 - accuracy: 0.5047 6/11 [===============>..............] - ETA: 0s - loss: 0.2532 - accuracy: 0.5037 7/11 [==================>...........] - ETA: 0s - loss: 0.2527 - accuracy: 0.5028 8/11 [====================>.........] - ETA: 0s - loss: 0.2521 - accuracy: 0.5036 9/11 [=======================>......] - ETA: 0s - loss: 0.2515 - accuracy: 0.504010/11 [==========================>...] - ETA: 0s - loss: 0.2512 - accuracy: 0.504411/11 [==============================] - ETA: 0s - loss: 0.2510 - accuracy: 0.504711/11 [==============================] - 1s 101ms/step - loss: 0.2509 - accuracy: 0.5050
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2649 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.2546 - accuracy: 0.5020 3/11 [=======>......................] - ETA: 0s - loss: 0.2490 - accuracy: 0.5100 4/11 [=========>....................] - ETA: 0s - loss: 0.2471 - accuracy: 0.5129 5/11 [============>.................] - ETA: 0s - loss: 0.2474 - accuracy: 0.5143 6/11 [===============>..............] - ETA: 0s - loss: 0.2471 - accuracy: 0.5154 7/11 [==================>...........] - ETA: 0s - loss: 0.2463 - accuracy: 0.5161 8/11 [====================>.........] - ETA: 0s - loss: 0.2458 - accuracy: 0.5158 9/11 [=======================>......] - ETA: 0s - loss: 0.2451 - accuracy: 0.515910/11 [==========================>...] - ETA: 0s - loss: 0.2447 - accuracy: 0.515211/11 [==============================] - ETA: 0s - loss: 0.2439 - accuracy: 0.515111/11 [==============================] - 1s 101ms/step - loss: 0.2433 - accuracy: 0.5150
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2413 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.2352 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 0s - loss: 0.2339 - accuracy: 0.4952 4/11 [=========>....................] - ETA: 0s - loss: 0.2315 - accuracy: 0.5037 5/11 [============>.................] - ETA: 0s - loss: 0.2304 - accuracy: 0.5067 6/11 [===============>..............] - ETA: 0s - loss: 0.2289 - accuracy: 0.5100 7/11 [==================>...........] - ETA: 0s - loss: 0.2284 - accuracy: 0.5120 8/11 [====================>.........] - ETA: 0s - loss: 0.2285 - accuracy: 0.5129 9/11 [=======================>......] - ETA: 0s - loss: 0.2281 - accuracy: 0.514310/11 [==========================>...] - ETA: 0s - loss: 0.2278 - accuracy: 0.515311/11 [==============================] - ETA: 0s - loss: 0.2276 - accuracy: 0.515911/11 [==============================] - 1s 101ms/step - loss: 0.2274 - accuracy: 0.5164
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2405 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.2356 - accuracy: 0.4590 3/11 [=======>......................] - ETA: 0s - loss: 0.2314 - accuracy: 0.4753 4/11 [=========>....................] - ETA: 0s - loss: 0.2304 - accuracy: 0.4849 5/11 [============>.................] - ETA: 0s - loss: 0.2280 - accuracy: 0.4951 6/11 [===============>..............] - ETA: 0s - loss: 0.2270 - accuracy: 0.5022 7/11 [==================>...........] - ETA: 0s - loss: 0.2257 - accuracy: 0.5073 8/11 [====================>.........] - ETA: 0s - loss: 0.2246 - accuracy: 0.5102 9/11 [=======================>......] - ETA: 0s - loss: 0.2235 - accuracy: 0.513010/11 [==========================>...] - ETA: 0s - loss: 0.2224 - accuracy: 0.515511/11 [==============================] - ETA: 0s - loss: 0.2217 - accuracy: 0.517011/11 [==============================] - 1s 98ms/step - loss: 0.2211 - accuracy: 0.5183
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2234 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.2185 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 0s - loss: 0.2171 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 0s - loss: 0.2153 - accuracy: 0.5293 5/11 [============>.................] - ETA: 0s - loss: 0.2145 - accuracy: 0.5312 6/11 [===============>..............] - ETA: 0s - loss: 0.2140 - accuracy: 0.5312 7/11 [==================>...........] - ETA: 0s - loss: 0.2132 - accuracy: 0.5303 8/11 [====================>.........] - ETA: 0s - loss: 0.2122 - accuracy: 0.5311 9/11 [=======================>......] - ETA: 0s - loss: 0.2113 - accuracy: 0.533110/11 [==========================>...] - ETA: 0s - loss: 0.2106 - accuracy: 0.534611/11 [==============================] - ETA: 0s - loss: 0.2100 - accuracy: 0.535111/11 [==============================] - 1s 99ms/step - loss: 0.2095 - accuracy: 0.5354
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1914 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.1956 - accuracy: 0.6035 3/11 [=======>......................] - ETA: 0s - loss: 0.1997 - accuracy: 0.5994 4/11 [=========>....................] - ETA: 0s - loss: 0.2013 - accuracy: 0.5946 5/11 [============>.................] - ETA: 0s - loss: 0.2025 - accuracy: 0.5900 6/11 [===============>..............] - ETA: 0s - loss: 0.2029 - accuracy: 0.5857 7/11 [==================>...........] - ETA: 0s - loss: 0.2028 - accuracy: 0.5814 8/11 [====================>.........] - ETA: 0s - loss: 0.2025 - accuracy: 0.5773 9/11 [=======================>......] - ETA: 0s - loss: 0.2018 - accuracy: 0.574310/11 [==========================>...] - ETA: 0s - loss: 0.2012 - accuracy: 0.571811/11 [==============================] - ETA: 0s - loss: 0.2007 - accuracy: 0.569711/11 [==============================] - 1s 100ms/step - loss: 0.2003 - accuracy: 0.5679
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1788 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 0s - loss: 0.1847 - accuracy: 0.5508 3/11 [=======>......................] - ETA: 0s - loss: 0.1867 - accuracy: 0.5469 4/11 [=========>....................] - ETA: 0s - loss: 0.1880 - accuracy: 0.5435 5/11 [============>.................] - ETA: 0s - loss: 0.1876 - accuracy: 0.5429 6/11 [===============>..............] - ETA: 0s - loss: 0.1869 - accuracy: 0.5436 7/11 [==================>...........] - ETA: 0s - loss: 0.1869 - accuracy: 0.5445 8/11 [====================>.........] - ETA: 0s - loss: 0.1870 - accuracy: 0.5453 9/11 [=======================>......] - ETA: 0s - loss: 0.1875 - accuracy: 0.545510/11 [==========================>...] - ETA: 0s - loss: 0.1876 - accuracy: 0.546311/11 [==============================] - ETA: 0s - loss: 0.1877 - accuracy: 0.547311/11 [==============================] - 1s 102ms/step - loss: 0.1878 - accuracy: 0.5481
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1948 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.1933 - accuracy: 0.5273 3/11 [=======>......................] - ETA: 0s - loss: 0.1927 - accuracy: 0.5391 4/11 [=========>....................] - ETA: 0s - loss: 0.1917 - accuracy: 0.5454 5/11 [============>.................] - ETA: 0s - loss: 0.1916 - accuracy: 0.5488 6/11 [===============>..............] - ETA: 0s - loss: 0.1909 - accuracy: 0.5539 7/11 [==================>...........] - ETA: 0s - loss: 0.1900 - accuracy: 0.5577 8/11 [====================>.........] - ETA: 0s - loss: 0.1892 - accuracy: 0.5596 9/11 [=======================>......] - ETA: 0s - loss: 0.1887 - accuracy: 0.560410/11 [==========================>...] - ETA: 0s - loss: 0.1883 - accuracy: 0.561511/11 [==============================] - ETA: 0s - loss: 0.1878 - accuracy: 0.562211/11 [==============================] - 1s 103ms/step - loss: 0.1873 - accuracy: 0.5627
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1866 - accuracy: 0.6250 2/11 [====>.........................] - ETA: 0s - loss: 0.1876 - accuracy: 0.6172 3/11 [=======>......................] - ETA: 0s - loss: 0.1885 - accuracy: 0.6094 4/11 [=========>....................] - ETA: 0s - loss: 0.1875 - accuracy: 0.6045 5/11 [============>.................] - ETA: 0s - loss: 0.1865 - accuracy: 0.6017 6/11 [===============>..............] - ETA: 0s - loss: 0.1864 - accuracy: 0.5978 7/11 [==================>...........] - ETA: 0s - loss: 0.1854 - accuracy: 0.5983 8/11 [====================>.........] - ETA: 0s - loss: 0.1843 - accuracy: 0.5979 9/11 [=======================>......] - ETA: 0s - loss: 0.1833 - accuracy: 0.597510/11 [==========================>...] - ETA: 0s - loss: 0.1827 - accuracy: 0.596411/11 [==============================] - ETA: 0s - loss: 0.1821 - accuracy: 0.595411/11 [==============================] - 1s 98ms/step - loss: 0.1817 - accuracy: 0.5947
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1784 - accuracy: 0.6094 2/11 [====>.........................] - ETA: 0s - loss: 0.1802 - accuracy: 0.5977 3/11 [=======>......................] - ETA: 0s - loss: 0.1805 - accuracy: 0.5903 4/11 [=========>....................] - ETA: 0s - loss: 0.1813 - accuracy: 0.5887 5/11 [============>.................] - ETA: 0s - loss: 0.1808 - accuracy: 0.5888 6/11 [===============>..............] - ETA: 0s - loss: 0.1797 - accuracy: 0.5905 7/11 [==================>...........] - ETA: 0s - loss: 0.1789 - accuracy: 0.5919 8/11 [====================>.........] - ETA: 0s - loss: 0.1780 - accuracy: 0.5938 9/11 [=======================>......] - ETA: 0s - loss: 0.1778 - accuracy: 0.594910/11 [==========================>...] - ETA: 0s - loss: 0.1774 - accuracy: 0.596211/11 [==============================] - ETA: 0s - loss: 0.1769 - accuracy: 0.596911/11 [==============================] - 1s 100ms/step - loss: 0.1764 - accuracy: 0.5976
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.1959 - accuracy: 0.57813/6 [==============>...............] - ETA: 0s - loss: 0.2022 - accuracy: 0.5495 5/6 [========================>.....] - ETA: 0s - loss: 0.1889 - accuracy: 0.55166/6 [==============================] - 4s 28ms/step - loss: 0.1843 - accuracy: 0.5552
2021-12-13 23:44:48.551251: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:44:48.552222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:44:48.552801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:44:48.552852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:44:48.552890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:44:48.552918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:44:48.552945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:44:48.552972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:44:48.553000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:44:48.553028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:44:48.554247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:44:48.554274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:44:48.554284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:44:48.554291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [-0.0331224   0.5024714   0.53276086 -0.06853222 -0.4130167 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 4 0 1] pred: [-0.8022031  -0.8215358   0.99108464 -0.18682916 -0.36098036]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [-0.06596377  0.63429815  0.7460605  -0.1459299  -0.5799624 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [4 3 2 0 1] pred: [-0.35824108 -0.54606634 -0.01037415  0.5658951   0.5854869 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [4 3 2 0 1] pred: [-0.15412404 -0.32502726 -0.02510325  0.4094172   0.47577894]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 4 0] pred: [-0.7626511  -0.5670263   0.9894661  -0.21695161 -0.591694  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [4 3 2 0 1] pred: [-0.15327269 -0.29573834 -0.01972571  0.34967273  0.42307124]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [ 0.11610582  0.7053046   0.70309484 -0.21906038 -0.524181  ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 3 4] pred: [-0.00951797  0.29348415  0.32113504 -0.02028118 -0.21958935]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 4 1 0] pred: [-0.34591982 -0.33249816  0.25516552  0.5655345   0.15011787]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 4 0] pred: [-0.6661784  -0.11201052  0.9574385  -0.11137998 -0.64763284]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [-0.1498138   0.66535914  0.84781444 -0.2644744  -0.70102775]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 4 1 0] pred: [-0.7668771  -0.7298831   0.99237615 -0.2468755  -0.42591852]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [ 0.06084904  0.73893595  0.7795349  -0.2359294  -0.5953773 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 2 1 4 0] pred: [-0.09334794  0.08348038  0.21664852  0.2531562  -0.01688304]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:02 - loss: 2.8785 - accuracy: 0.2344 2/11 [====>.........................] - ETA: 0s - loss: 2.7055 - accuracy: 0.2793   3/11 [=======>......................] - ETA: 0s - loss: 2.5044 - accuracy: 0.2956 4/11 [=========>....................] - ETA: 0s - loss: 2.3415 - accuracy: 0.3110 5/11 [============>.................] - ETA: 0s - loss: 2.2056 - accuracy: 0.3226 6/11 [===============>..............] - ETA: 0s - loss: 2.0927 - accuracy: 0.3317 7/11 [==================>...........] - ETA: 0s - loss: 1.9978 - accuracy: 0.3400 8/11 [====================>.........] - ETA: 0s - loss: 1.9163 - accuracy: 0.3482 9/11 [=======================>......] - ETA: 0s - loss: 1.8465 - accuracy: 0.355810/11 [==========================>...] - ETA: 0s - loss: 1.7848 - accuracy: 0.362911/11 [==============================] - ETA: 0s - loss: 1.7312 - accuracy: 0.368711/11 [==============================] - 13s 105ms/step - loss: 1.6865 - accuracy: 0.3736
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7008 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.6999 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 0s - loss: 0.7038 - accuracy: 0.4657 4/11 [=========>....................] - ETA: 0s - loss: 0.7064 - accuracy: 0.4591 5/11 [============>.................] - ETA: 0s - loss: 0.7048 - accuracy: 0.4573 6/11 [===============>..............] - ETA: 0s - loss: 0.7027 - accuracy: 0.4544 7/11 [==================>...........] - ETA: 0s - loss: 0.6998 - accuracy: 0.4547 8/11 [====================>.........] - ETA: 0s - loss: 0.6964 - accuracy: 0.4550 9/11 [=======================>......] - ETA: 0s - loss: 0.6933 - accuracy: 0.455210/11 [==========================>...] - ETA: 0s - loss: 0.6901 - accuracy: 0.455811/11 [==============================] - ETA: 0s - loss: 0.6881 - accuracy: 0.456111/11 [==============================] - 1s 99ms/step - loss: 0.6864 - accuracy: 0.4563
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6466 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.6305 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.6182 - accuracy: 0.4410 4/11 [=========>....................] - ETA: 0s - loss: 0.6063 - accuracy: 0.4450 5/11 [============>.................] - ETA: 0s - loss: 0.6021 - accuracy: 0.4438 6/11 [===============>..............] - ETA: 0s - loss: 0.5998 - accuracy: 0.4432 7/11 [==================>...........] - ETA: 0s - loss: 0.5960 - accuracy: 0.4432 8/11 [====================>.........] - ETA: 0s - loss: 0.5928 - accuracy: 0.4438 9/11 [=======================>......] - ETA: 0s - loss: 0.5903 - accuracy: 0.445010/11 [==========================>...] - ETA: 0s - loss: 0.5874 - accuracy: 0.446511/11 [==============================] - ETA: 0s - loss: 0.5855 - accuracy: 0.447211/11 [==============================] - 1s 98ms/step - loss: 0.5840 - accuracy: 0.4478
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4489 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.4935 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.5183 - accuracy: 0.4462 4/11 [=========>....................] - ETA: 0s - loss: 0.5270 - accuracy: 0.4435 5/11 [============>.................] - ETA: 0s - loss: 0.5267 - accuracy: 0.4439 6/11 [===============>..............] - ETA: 0s - loss: 0.5246 - accuracy: 0.4459 7/11 [==================>...........] - ETA: 0s - loss: 0.5224 - accuracy: 0.4471 8/11 [====================>.........] - ETA: 0s - loss: 0.5203 - accuracy: 0.4484 9/11 [=======================>......] - ETA: 0s - loss: 0.5182 - accuracy: 0.448910/11 [==========================>...] - ETA: 0s - loss: 0.5168 - accuracy: 0.449411/11 [==============================] - ETA: 0s - loss: 0.5149 - accuracy: 0.449811/11 [==============================] - 1s 97ms/step - loss: 0.5133 - accuracy: 0.4501
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5782 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 0s - loss: 0.5189 - accuracy: 0.5371 3/11 [=======>......................] - ETA: 0s - loss: 0.5019 - accuracy: 0.5239 4/11 [=========>....................] - ETA: 0s - loss: 0.4928 - accuracy: 0.5120 5/11 [============>.................] - ETA: 0s - loss: 0.4875 - accuracy: 0.5034 6/11 [===============>..............] - ETA: 0s - loss: 0.4831 - accuracy: 0.4965 7/11 [==================>...........] - ETA: 0s - loss: 0.4825 - accuracy: 0.4903 8/11 [====================>.........] - ETA: 0s - loss: 0.4819 - accuracy: 0.4857 9/11 [=======================>......] - ETA: 0s - loss: 0.4806 - accuracy: 0.482510/11 [==========================>...] - ETA: 0s - loss: 0.4787 - accuracy: 0.480111/11 [==============================] - ETA: 0s - loss: 0.4773 - accuracy: 0.477611/11 [==============================] - 1s 100ms/step - loss: 0.4760 - accuracy: 0.4756
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4333 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.4265 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.4168 - accuracy: 0.4644 4/11 [=========>....................] - ETA: 0s - loss: 0.4188 - accuracy: 0.4626 5/11 [============>.................] - ETA: 0s - loss: 0.4205 - accuracy: 0.4613 6/11 [===============>..............] - ETA: 0s - loss: 0.4216 - accuracy: 0.4606 7/11 [==================>...........] - ETA: 0s - loss: 0.4208 - accuracy: 0.4595 8/11 [====================>.........] - ETA: 0s - loss: 0.4221 - accuracy: 0.4582 9/11 [=======================>......] - ETA: 0s - loss: 0.4232 - accuracy: 0.457710/11 [==========================>...] - ETA: 0s - loss: 0.4246 - accuracy: 0.457111/11 [==============================] - ETA: 0s - loss: 0.4257 - accuracy: 0.457011/11 [==============================] - 1s 99ms/step - loss: 0.4266 - accuracy: 0.4568
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5220 - accuracy: 0.3672 2/11 [====>.........................] - ETA: 0s - loss: 0.4720 - accuracy: 0.4082 3/11 [=======>......................] - ETA: 0s - loss: 0.4566 - accuracy: 0.4249 4/11 [=========>....................] - ETA: 0s - loss: 0.4514 - accuracy: 0.4334 5/11 [============>.................] - ETA: 0s - loss: 0.4430 - accuracy: 0.4396 6/11 [===============>..............] - ETA: 0s - loss: 0.4362 - accuracy: 0.4440 7/11 [==================>...........] - ETA: 0s - loss: 0.4310 - accuracy: 0.4466 8/11 [====================>.........] - ETA: 0s - loss: 0.4274 - accuracy: 0.4482 9/11 [=======================>......] - ETA: 0s - loss: 0.4249 - accuracy: 0.449810/11 [==========================>...] - ETA: 0s - loss: 0.4233 - accuracy: 0.450911/11 [==============================] - ETA: 0s - loss: 0.4225 - accuracy: 0.451611/11 [==============================] - 1s 102ms/step - loss: 0.4217 - accuracy: 0.4521
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3855 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.3954 - accuracy: 0.4941 3/11 [=======>......................] - ETA: 0s - loss: 0.3950 - accuracy: 0.4831 4/11 [=========>....................] - ETA: 0s - loss: 0.3927 - accuracy: 0.4795 5/11 [============>.................] - ETA: 0s - loss: 0.3887 - accuracy: 0.4802 6/11 [===============>..............] - ETA: 0s - loss: 0.3846 - accuracy: 0.4802 7/11 [==================>...........] - ETA: 0s - loss: 0.3839 - accuracy: 0.4787 8/11 [====================>.........] - ETA: 0s - loss: 0.3840 - accuracy: 0.4764 9/11 [=======================>......] - ETA: 0s - loss: 0.3837 - accuracy: 0.475210/11 [==========================>...] - ETA: 0s - loss: 0.3849 - accuracy: 0.473311/11 [==============================] - ETA: 0s - loss: 0.3859 - accuracy: 0.472011/11 [==============================] - 1s 105ms/step - loss: 0.3868 - accuracy: 0.4710
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3123 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.3433 - accuracy: 0.5020 3/11 [=======>......................] - ETA: 0s - loss: 0.3497 - accuracy: 0.4874 4/11 [=========>....................] - ETA: 0s - loss: 0.3611 - accuracy: 0.4832 5/11 [============>.................] - ETA: 0s - loss: 0.3638 - accuracy: 0.4807 6/11 [===============>..............] - ETA: 0s - loss: 0.3687 - accuracy: 0.4769 7/11 [==================>...........] - ETA: 0s - loss: 0.3725 - accuracy: 0.4742 8/11 [====================>.........] - ETA: 0s - loss: 0.3744 - accuracy: 0.4720 9/11 [=======================>......] - ETA: 0s - loss: 0.3754 - accuracy: 0.471110/11 [==========================>...] - ETA: 0s - loss: 0.3757 - accuracy: 0.470311/11 [==============================] - ETA: 0s - loss: 0.3761 - accuracy: 0.469911/11 [==============================] - 1s 98ms/step - loss: 0.3764 - accuracy: 0.4696
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4151 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.4194 - accuracy: 0.4277 3/11 [=======>......................] - ETA: 0s - loss: 0.4088 - accuracy: 0.4449 4/11 [=========>....................] - ETA: 0s - loss: 0.3956 - accuracy: 0.4572 5/11 [============>.................] - ETA: 0s - loss: 0.3825 - accuracy: 0.4679 6/11 [===============>..............] - ETA: 0s - loss: 0.3730 - accuracy: 0.4737 7/11 [==================>...........] - ETA: 0s - loss: 0.3653 - accuracy: 0.4786 8/11 [====================>.........] - ETA: 0s - loss: 0.3583 - accuracy: 0.4818 9/11 [=======================>......] - ETA: 0s - loss: 0.3528 - accuracy: 0.483110/11 [==========================>...] - ETA: 0s - loss: 0.3478 - accuracy: 0.484311/11 [==============================] - ETA: 0s - loss: 0.3431 - accuracy: 0.485411/11 [==============================] - 1s 97ms/step - loss: 0.3391 - accuracy: 0.4863
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1988 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.2076 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.2146 - accuracy: 0.5130 4/11 [=========>....................] - ETA: 0s - loss: 0.2166 - accuracy: 0.5044 5/11 [============>.................] - ETA: 0s - loss: 0.2182 - accuracy: 0.5016 6/11 [===============>..............] - ETA: 0s - loss: 0.2187 - accuracy: 0.5044 7/11 [==================>...........] - ETA: 0s - loss: 0.2193 - accuracy: 0.5063 8/11 [====================>.........] - ETA: 0s - loss: 0.2195 - accuracy: 0.5092 9/11 [=======================>......] - ETA: 0s - loss: 0.2196 - accuracy: 0.511610/11 [==========================>...] - ETA: 0s - loss: 0.2198 - accuracy: 0.513911/11 [==============================] - ETA: 0s - loss: 0.2199 - accuracy: 0.515311/11 [==============================] - 1s 102ms/step - loss: 0.2200 - accuracy: 0.5165
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2202 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 0s - loss: 0.2276 - accuracy: 0.5293 3/11 [=======>......................] - ETA: 0s - loss: 0.2268 - accuracy: 0.5317 4/11 [=========>....................] - ETA: 0s - loss: 0.2252 - accuracy: 0.5335 5/11 [============>.................] - ETA: 0s - loss: 0.2237 - accuracy: 0.5328 6/11 [===============>..............] - ETA: 0s - loss: 0.2224 - accuracy: 0.5342 7/11 [==================>...........] - ETA: 0s - loss: 0.2213 - accuracy: 0.5348 8/11 [====================>.........] - ETA: 0s - loss: 0.2203 - accuracy: 0.5353 9/11 [=======================>......] - ETA: 0s - loss: 0.2194 - accuracy: 0.536210/11 [==========================>...] - ETA: 0s - loss: 0.2183 - accuracy: 0.537011/11 [==============================] - ETA: 0s - loss: 0.2176 - accuracy: 0.537511/11 [==============================] - 1s 103ms/step - loss: 0.2171 - accuracy: 0.5380
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1938 - accuracy: 0.6250 2/11 [====>.........................] - ETA: 0s - loss: 0.1929 - accuracy: 0.6035 3/11 [=======>......................] - ETA: 0s - loss: 0.1983 - accuracy: 0.5881 4/11 [=========>....................] - ETA: 0s - loss: 0.2011 - accuracy: 0.5793 5/11 [============>.................] - ETA: 0s - loss: 0.2013 - accuracy: 0.5753 6/11 [===============>..............] - ETA: 0s - loss: 0.2010 - accuracy: 0.5740 7/11 [==================>...........] - ETA: 0s - loss: 0.2002 - accuracy: 0.5730 8/11 [====================>.........] - ETA: 0s - loss: 0.1995 - accuracy: 0.5713 9/11 [=======================>......] - ETA: 0s - loss: 0.1993 - accuracy: 0.569910/11 [==========================>...] - ETA: 0s - loss: 0.1990 - accuracy: 0.569011/11 [==============================] - ETA: 0s - loss: 0.1991 - accuracy: 0.567711/11 [==============================] - 1s 103ms/step - loss: 0.1992 - accuracy: 0.5666
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2060 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.2077 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.2049 - accuracy: 0.5434 4/11 [=========>....................] - ETA: 0s - loss: 0.2025 - accuracy: 0.5472 5/11 [============>.................] - ETA: 0s - loss: 0.2005 - accuracy: 0.5518 6/11 [===============>..............] - ETA: 0s - loss: 0.1988 - accuracy: 0.5545 7/11 [==================>...........] - ETA: 0s - loss: 0.1975 - accuracy: 0.5561 8/11 [====================>.........] - ETA: 0s - loss: 0.1965 - accuracy: 0.5571 9/11 [=======================>......] - ETA: 0s - loss: 0.1956 - accuracy: 0.559110/11 [==========================>...] - ETA: 0s - loss: 0.1950 - accuracy: 0.559711/11 [==============================] - ETA: 0s - loss: 0.1946 - accuracy: 0.560011/11 [==============================] - 1s 104ms/step - loss: 0.1942 - accuracy: 0.5602
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1772 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.1826 - accuracy: 0.5684 3/11 [=======>......................] - ETA: 0s - loss: 0.1829 - accuracy: 0.5681 4/11 [=========>....................] - ETA: 0s - loss: 0.1820 - accuracy: 0.5736 5/11 [============>.................] - ETA: 0s - loss: 0.1815 - accuracy: 0.5742 6/11 [===============>..............] - ETA: 0s - loss: 0.1821 - accuracy: 0.5727 7/11 [==================>...........] - ETA: 0s - loss: 0.1822 - accuracy: 0.5723 8/11 [====================>.........] - ETA: 0s - loss: 0.1823 - accuracy: 0.5727 9/11 [=======================>......] - ETA: 0s - loss: 0.1823 - accuracy: 0.572410/11 [==========================>...] - ETA: 0s - loss: 0.1824 - accuracy: 0.572111/11 [==============================] - ETA: 0s - loss: 0.1823 - accuracy: 0.571911/11 [==============================] - 1s 100ms/step - loss: 0.1823 - accuracy: 0.5717
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1798 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.1855 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.1853 - accuracy: 0.5399 4/11 [=========>....................] - ETA: 0s - loss: 0.1838 - accuracy: 0.5436 5/11 [============>.................] - ETA: 0s - loss: 0.1823 - accuracy: 0.5493 6/11 [===============>..............] - ETA: 0s - loss: 0.1812 - accuracy: 0.5536 7/11 [==================>...........] - ETA: 0s - loss: 0.1807 - accuracy: 0.5578 8/11 [====================>.........] - ETA: 0s - loss: 0.1803 - accuracy: 0.5611 9/11 [=======================>......] - ETA: 0s - loss: 0.1797 - accuracy: 0.563810/11 [==========================>...] - ETA: 0s - loss: 0.1793 - accuracy: 0.566011/11 [==============================] - ETA: 0s - loss: 0.1789 - accuracy: 0.567811/11 [==============================] - 1s 101ms/step - loss: 0.1785 - accuracy: 0.5693
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1904 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 0s - loss: 0.1817 - accuracy: 0.6055 3/11 [=======>......................] - ETA: 0s - loss: 0.1784 - accuracy: 0.6024 4/11 [=========>....................] - ETA: 0s - loss: 0.1760 - accuracy: 0.6042 5/11 [============>.................] - ETA: 0s - loss: 0.1745 - accuracy: 0.6049 6/11 [===============>..............] - ETA: 0s - loss: 0.1737 - accuracy: 0.6037 7/11 [==================>...........] - ETA: 0s - loss: 0.1726 - accuracy: 0.6032 8/11 [====================>.........] - ETA: 0s - loss: 0.1718 - accuracy: 0.6033 9/11 [=======================>......] - ETA: 0s - loss: 0.1713 - accuracy: 0.603710/11 [==========================>...] - ETA: 0s - loss: 0.1710 - accuracy: 0.603711/11 [==============================] - ETA: 0s - loss: 0.1708 - accuracy: 0.603611/11 [==============================] - 1s 105ms/step - loss: 0.1706 - accuracy: 0.6036
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1649 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 0s - loss: 0.1650 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.1651 - accuracy: 0.5712 4/11 [=========>....................] - ETA: 0s - loss: 0.1648 - accuracy: 0.5734 5/11 [============>.................] - ETA: 0s - loss: 0.1646 - accuracy: 0.5781 6/11 [===============>..............] - ETA: 0s - loss: 0.1646 - accuracy: 0.5822 7/11 [==================>...........] - ETA: 0s - loss: 0.1644 - accuracy: 0.5853 8/11 [====================>.........] - ETA: 0s - loss: 0.1643 - accuracy: 0.5878 9/11 [=======================>......] - ETA: 0s - loss: 0.1642 - accuracy: 0.589910/11 [==========================>...] - ETA: 0s - loss: 0.1640 - accuracy: 0.591511/11 [==============================] - ETA: 0s - loss: 0.1639 - accuracy: 0.592711/11 [==============================] - 1s 104ms/step - loss: 0.1638 - accuracy: 0.5938
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1897 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.1766 - accuracy: 0.5918 3/11 [=======>......................] - ETA: 0s - loss: 0.1734 - accuracy: 0.5951 4/11 [=========>....................] - ETA: 0s - loss: 0.1710 - accuracy: 0.5991 5/11 [============>.................] - ETA: 0s - loss: 0.1694 - accuracy: 0.6015 6/11 [===============>..............] - ETA: 0s - loss: 0.1683 - accuracy: 0.6041 7/11 [==================>...........] - ETA: 0s - loss: 0.1675 - accuracy: 0.6057 8/11 [====================>.........] - ETA: 0s - loss: 0.1665 - accuracy: 0.6067 9/11 [=======================>......] - ETA: 0s - loss: 0.1656 - accuracy: 0.608110/11 [==========================>...] - ETA: 0s - loss: 0.1649 - accuracy: 0.608911/11 [==============================] - ETA: 0s - loss: 0.1642 - accuracy: 0.609811/11 [==============================] - 1s 99ms/step - loss: 0.1637 - accuracy: 0.6106
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1730 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 0s - loss: 0.1715 - accuracy: 0.5938 3/11 [=======>......................] - ETA: 0s - loss: 0.1676 - accuracy: 0.5972 4/11 [=========>....................] - ETA: 0s - loss: 0.1662 - accuracy: 0.5988 5/11 [============>.................] - ETA: 0s - loss: 0.1648 - accuracy: 0.6037 6/11 [===============>..............] - ETA: 0s - loss: 0.1634 - accuracy: 0.6064 7/11 [==================>...........] - ETA: 0s - loss: 0.1621 - accuracy: 0.6083 8/11 [====================>.........] - ETA: 0s - loss: 0.1611 - accuracy: 0.6097 9/11 [=======================>......] - ETA: 0s - loss: 0.1601 - accuracy: 0.611610/11 [==========================>...] - ETA: 0s - loss: 0.1595 - accuracy: 0.613311/11 [==============================] - ETA: 0s - loss: 0.1589 - accuracy: 0.614711/11 [==============================] - 1s 100ms/step - loss: 0.1584 - accuracy: 0.6160
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.1510 - accuracy: 0.63283/6 [==============>...............] - ETA: 0s - loss: 0.1433 - accuracy: 0.6380 5/6 [========================>.....] - ETA: 0s - loss: 0.1524 - accuracy: 0.62976/6 [==============================] - 4s 30ms/step - loss: 0.1553 - accuracy: 0.6261
2021-12-13 23:45:35.011604: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:45:35.012877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:45:35.012924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:45:35.012976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:45:35.013009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:45:35.013042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:45:35.013078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:45:35.013115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:45:35.013147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:45:35.013185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:45:35.014358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:45:35.014392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:45:35.014402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:45:35.014409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [-0.2546166   0.6620296   0.7276268  -0.29522744 -0.40461284]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [-0.10026725  0.76541704  0.8654981  -0.57004    -0.39910045]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [-0.26121843 -0.15158388  0.9433114  -0.2686023  -0.4182068 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [-0.24336529  0.6658588   0.839851   -0.31500322 -0.43941426]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 0 4 1 3] pred: [-0.15744798 -0.6556394   0.9803667  -0.7488654  -0.64123416]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 0 4 3 1] pred: [-0.08680584 -0.665012    0.9737497  -0.6357004  -0.5413954 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 4 0] pred: [-0.34654272 -0.07557277  0.87587285 -0.01570459 -0.30379173]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [-0.28931367  0.7642168   0.89437217 -0.44972023 -0.4842117 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 0 3 4 1] pred: [-0.11660098 -0.7330682   0.96044976 -0.36473778 -0.42466536]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 0 3 4 1] pred: [-0.15699641 -0.7292025   0.97888917 -0.49585786 -0.56411225]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [-0.3345906   0.73761266  0.8067007  -0.34723246 -0.44933087]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 0 4 1] pred: [-0.31922412 -0.4105963   0.92615014 -0.0570959  -0.38909668]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [-0.15160385  0.27205727  0.7059148   0.00966888 -0.14974111]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [0 2 1 4 3] pred: [ 0.4025474   0.22932237  0.23655865 -0.04567391 -0.02796207]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [-0.14936021  0.77737623  0.890723   -0.6076329  -0.4540466 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:56 - loss: 3.6481 - accuracy: 0.1562 2/11 [====>.........................] - ETA: 0s - loss: 3.3600 - accuracy: 0.1758   3/11 [=======>......................] - ETA: 0s - loss: 3.1041 - accuracy: 0.1979 4/11 [=========>....................] - ETA: 0s - loss: 2.9082 - accuracy: 0.2231 5/11 [============>.................] - ETA: 0s - loss: 2.7494 - accuracy: 0.2473 6/11 [===============>..............] - ETA: 0s - loss: 2.6156 - accuracy: 0.2670 7/11 [==================>...........] - ETA: 0s - loss: 2.5025 - accuracy: 0.2821 8/11 [====================>.........] - ETA: 0s - loss: 2.4033 - accuracy: 0.2944 9/11 [=======================>......] - ETA: 0s - loss: 2.3147 - accuracy: 0.306510/11 [==========================>...] - ETA: 0s - loss: 2.2366 - accuracy: 0.316611/11 [==============================] - ETA: 0s - loss: 2.1684 - accuracy: 0.325111/11 [==============================] - 13s 102ms/step - loss: 2.1116 - accuracy: 0.3323
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8333 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.8091 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.7998 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.7923 - accuracy: 0.4644 5/11 [============>.................] - ETA: 0s - loss: 0.7875 - accuracy: 0.4646 6/11 [===============>..............] - ETA: 0s - loss: 0.7841 - accuracy: 0.4629 7/11 [==================>...........] - ETA: 0s - loss: 0.7801 - accuracy: 0.4626 8/11 [====================>.........] - ETA: 0s - loss: 0.7765 - accuracy: 0.4619 9/11 [=======================>......] - ETA: 0s - loss: 0.7736 - accuracy: 0.460610/11 [==========================>...] - ETA: 0s - loss: 0.7704 - accuracy: 0.460111/11 [==============================] - ETA: 0s - loss: 0.7671 - accuracy: 0.460211/11 [==============================] - 1s 103ms/step - loss: 0.7644 - accuracy: 0.4602
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6833 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.6878 - accuracy: 0.4316 3/11 [=======>......................] - ETA: 0s - loss: 0.6861 - accuracy: 0.4388 4/11 [=========>....................] - ETA: 0s - loss: 0.6829 - accuracy: 0.4473 5/11 [============>.................] - ETA: 0s - loss: 0.6806 - accuracy: 0.4516 6/11 [===============>..............] - ETA: 0s - loss: 0.6791 - accuracy: 0.4540 7/11 [==================>...........] - ETA: 0s - loss: 0.6779 - accuracy: 0.4548 8/11 [====================>.........] - ETA: 0s - loss: 0.6771 - accuracy: 0.4553 9/11 [=======================>......] - ETA: 0s - loss: 0.6762 - accuracy: 0.455610/11 [==========================>...] - ETA: 0s - loss: 0.6753 - accuracy: 0.456511/11 [==============================] - ETA: 0s - loss: 0.6744 - accuracy: 0.457111/11 [==============================] - 1s 98ms/step - loss: 0.6737 - accuracy: 0.4575
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6703 - accuracy: 0.3828 2/11 [====>.........................] - ETA: 0s - loss: 0.6670 - accuracy: 0.3887 3/11 [=======>......................] - ETA: 0s - loss: 0.6597 - accuracy: 0.4076 4/11 [=========>....................] - ETA: 0s - loss: 0.6563 - accuracy: 0.4194 5/11 [============>.................] - ETA: 0s - loss: 0.6536 - accuracy: 0.4274 6/11 [===============>..............] - ETA: 0s - loss: 0.6513 - accuracy: 0.4326 7/11 [==================>...........] - ETA: 0s - loss: 0.6505 - accuracy: 0.4350 8/11 [====================>.........] - ETA: 0s - loss: 0.6493 - accuracy: 0.4375 9/11 [=======================>......] - ETA: 0s - loss: 0.6481 - accuracy: 0.439810/11 [==========================>...] - ETA: 0s - loss: 0.6469 - accuracy: 0.442011/11 [==============================] - ETA: 0s - loss: 0.6458 - accuracy: 0.444211/11 [==============================] - 1s 100ms/step - loss: 0.6449 - accuracy: 0.4461
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6547 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.6400 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.6330 - accuracy: 0.4592 4/11 [=========>....................] - ETA: 0s - loss: 0.6288 - accuracy: 0.4650 5/11 [============>.................] - ETA: 0s - loss: 0.6269 - accuracy: 0.4673 6/11 [===============>..............] - ETA: 0s - loss: 0.6256 - accuracy: 0.4678 7/11 [==================>...........] - ETA: 0s - loss: 0.6236 - accuracy: 0.4697 8/11 [====================>.........] - ETA: 0s - loss: 0.6219 - accuracy: 0.4703 9/11 [=======================>......] - ETA: 0s - loss: 0.6210 - accuracy: 0.470110/11 [==========================>...] - ETA: 0s - loss: 0.6203 - accuracy: 0.470411/11 [==============================] - ETA: 0s - loss: 0.6198 - accuracy: 0.470511/11 [==============================] - 1s 99ms/step - loss: 0.6195 - accuracy: 0.4705
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5978 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.5943 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 1s - loss: 0.5968 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.5978 - accuracy: 0.4771 5/11 [============>.................] - ETA: 0s - loss: 0.5979 - accuracy: 0.4785 6/11 [===============>..............] - ETA: 0s - loss: 0.5984 - accuracy: 0.4780 7/11 [==================>...........] - ETA: 0s - loss: 0.5988 - accuracy: 0.4771 8/11 [====================>.........] - ETA: 0s - loss: 0.5988 - accuracy: 0.4769 9/11 [=======================>......] - ETA: 0s - loss: 0.5989 - accuracy: 0.476410/11 [==========================>...] - ETA: 0s - loss: 0.5989 - accuracy: 0.476211/11 [==============================] - ETA: 0s - loss: 0.5990 - accuracy: 0.475811/11 [==============================] - 1s 109ms/step - loss: 0.5990 - accuracy: 0.4754
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5889 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.5892 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 0s - loss: 0.5885 - accuracy: 0.5009 4/11 [=========>....................] - ETA: 0s - loss: 0.5869 - accuracy: 0.5007 5/11 [============>.................] - ETA: 0s - loss: 0.5867 - accuracy: 0.4983 6/11 [===============>..............] - ETA: 0s - loss: 0.5867 - accuracy: 0.4951 7/11 [==================>...........] - ETA: 0s - loss: 0.5869 - accuracy: 0.4918 8/11 [====================>.........] - ETA: 0s - loss: 0.5871 - accuracy: 0.4899 9/11 [=======================>......] - ETA: 0s - loss: 0.5872 - accuracy: 0.488410/11 [==========================>...] - ETA: 0s - loss: 0.5871 - accuracy: 0.486911/11 [==============================] - ETA: 0s - loss: 0.5869 - accuracy: 0.485411/11 [==============================] - 1s 104ms/step - loss: 0.5868 - accuracy: 0.4842
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6025 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.5933 - accuracy: 0.4473 3/11 [=======>......................] - ETA: 0s - loss: 0.5923 - accuracy: 0.4475 4/11 [=========>....................] - ETA: 0s - loss: 0.5911 - accuracy: 0.4474 5/11 [============>.................] - ETA: 0s - loss: 0.5892 - accuracy: 0.4514 6/11 [===============>..............] - ETA: 0s - loss: 0.5885 - accuracy: 0.4528 7/11 [==================>...........] - ETA: 0s - loss: 0.5875 - accuracy: 0.4541 8/11 [====================>.........] - ETA: 0s - loss: 0.5866 - accuracy: 0.4549 9/11 [=======================>......] - ETA: 0s - loss: 0.5857 - accuracy: 0.456210/11 [==========================>...] - ETA: 0s - loss: 0.5848 - accuracy: 0.457511/11 [==============================] - ETA: 0s - loss: 0.5837 - accuracy: 0.459111/11 [==============================] - 1s 100ms/step - loss: 0.5827 - accuracy: 0.4605
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5387 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.5435 - accuracy: 0.5176 3/11 [=======>......................] - ETA: 0s - loss: 0.5450 - accuracy: 0.5126 4/11 [=========>....................] - ETA: 0s - loss: 0.5467 - accuracy: 0.5109 5/11 [============>.................] - ETA: 0s - loss: 0.5490 - accuracy: 0.5090 6/11 [===============>..............] - ETA: 0s - loss: 0.5509 - accuracy: 0.5064 7/11 [==================>...........] - ETA: 0s - loss: 0.5526 - accuracy: 0.5031 8/11 [====================>.........] - ETA: 0s - loss: 0.5537 - accuracy: 0.5009 9/11 [=======================>......] - ETA: 0s - loss: 0.5547 - accuracy: 0.498010/11 [==========================>...] - ETA: 0s - loss: 0.5552 - accuracy: 0.496011/11 [==============================] - ETA: 0s - loss: 0.5557 - accuracy: 0.494211/11 [==============================] - 1s 102ms/step - loss: 0.5560 - accuracy: 0.4927
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5398 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.5426 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.5439 - accuracy: 0.5026 4/11 [=========>....................] - ETA: 0s - loss: 0.5457 - accuracy: 0.4976 5/11 [============>.................] - ETA: 0s - loss: 0.5462 - accuracy: 0.4930 6/11 [===============>..............] - ETA: 0s - loss: 0.5463 - accuracy: 0.4907 7/11 [==================>...........] - ETA: 0s - loss: 0.5464 - accuracy: 0.4882 8/11 [====================>.........] - ETA: 0s - loss: 0.5463 - accuracy: 0.4867 9/11 [=======================>......] - ETA: 0s - loss: 0.5463 - accuracy: 0.485110/11 [==========================>...] - ETA: 0s - loss: 0.5465 - accuracy: 0.483911/11 [==============================] - ETA: 0s - loss: 0.5466 - accuracy: 0.483011/11 [==============================] - 1s 111ms/step - loss: 0.5467 - accuracy: 0.4823
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5473 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.5452 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 0s - loss: 0.5436 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.5428 - accuracy: 0.4683 5/11 [============>.................] - ETA: 0s - loss: 0.5413 - accuracy: 0.4705 6/11 [===============>..............] - ETA: 0s - loss: 0.5407 - accuracy: 0.4720 7/11 [==================>...........] - ETA: 0s - loss: 0.5398 - accuracy: 0.4741 8/11 [====================>.........] - ETA: 0s - loss: 0.5391 - accuracy: 0.4754 9/11 [=======================>......] - ETA: 0s - loss: 0.5385 - accuracy: 0.476110/11 [==========================>...] - ETA: 0s - loss: 0.5381 - accuracy: 0.476511/11 [==============================] - ETA: 0s - loss: 0.5378 - accuracy: 0.476511/11 [==============================] - 1s 105ms/step - loss: 0.5376 - accuracy: 0.4764
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5218 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.5274 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 0s - loss: 0.5277 - accuracy: 0.4744 4/11 [=========>....................] - ETA: 0s - loss: 0.5278 - accuracy: 0.4735 5/11 [============>.................] - ETA: 0s - loss: 0.5280 - accuracy: 0.4719 6/11 [===============>..............] - ETA: 0s - loss: 0.5277 - accuracy: 0.4712 7/11 [==================>...........] - ETA: 0s - loss: 0.5271 - accuracy: 0.4718 8/11 [====================>.........] - ETA: 0s - loss: 0.5266 - accuracy: 0.4727 9/11 [=======================>......] - ETA: 0s - loss: 0.5266 - accuracy: 0.472710/11 [==========================>...] - ETA: 0s - loss: 0.5265 - accuracy: 0.473111/11 [==============================] - ETA: 0s - loss: 0.5263 - accuracy: 0.474111/11 [==============================] - 1s 101ms/step - loss: 0.5260 - accuracy: 0.4749
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5269 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.5223 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.5194 - accuracy: 0.4653 4/11 [=========>....................] - ETA: 0s - loss: 0.5164 - accuracy: 0.4735 5/11 [============>.................] - ETA: 0s - loss: 0.5142 - accuracy: 0.4797 6/11 [===============>..............] - ETA: 0s - loss: 0.5134 - accuracy: 0.4827 7/11 [==================>...........] - ETA: 0s - loss: 0.5130 - accuracy: 0.4842 8/11 [====================>.........] - ETA: 0s - loss: 0.5129 - accuracy: 0.4848 9/11 [=======================>......] - ETA: 0s - loss: 0.5127 - accuracy: 0.485110/11 [==========================>...] - ETA: 0s - loss: 0.5125 - accuracy: 0.485711/11 [==============================] - ETA: 0s - loss: 0.5124 - accuracy: 0.486011/11 [==============================] - 1s 108ms/step - loss: 0.5123 - accuracy: 0.4862
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4929 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.4966 - accuracy: 0.5332 3/11 [=======>......................] - ETA: 0s - loss: 0.4956 - accuracy: 0.5378 4/11 [=========>....................] - ETA: 0s - loss: 0.4976 - accuracy: 0.5288 5/11 [============>.................] - ETA: 0s - loss: 0.4980 - accuracy: 0.5246 6/11 [===============>..............] - ETA: 0s - loss: 0.4978 - accuracy: 0.5227 7/11 [==================>...........] - ETA: 0s - loss: 0.4977 - accuracy: 0.5207 8/11 [====================>.........] - ETA: 0s - loss: 0.4976 - accuracy: 0.5181 9/11 [=======================>......] - ETA: 0s - loss: 0.4978 - accuracy: 0.515610/11 [==========================>...] - ETA: 0s - loss: 0.4979 - accuracy: 0.513411/11 [==============================] - ETA: 0s - loss: 0.4980 - accuracy: 0.511411/11 [==============================] - 1s 105ms/step - loss: 0.4981 - accuracy: 0.5097
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4982 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.4951 - accuracy: 0.5352 3/11 [=======>......................] - ETA: 0s - loss: 0.4924 - accuracy: 0.5295 4/11 [=========>....................] - ETA: 0s - loss: 0.4910 - accuracy: 0.5251 5/11 [============>.................] - ETA: 0s - loss: 0.4902 - accuracy: 0.5210 6/11 [===============>..............] - ETA: 0s - loss: 0.4894 - accuracy: 0.5188 7/11 [==================>...........] - ETA: 0s - loss: 0.4892 - accuracy: 0.5159 8/11 [====================>.........] - ETA: 0s - loss: 0.4891 - accuracy: 0.5132 9/11 [=======================>......] - ETA: 0s - loss: 0.4891 - accuracy: 0.510610/11 [==========================>...] - ETA: 0s - loss: 0.4891 - accuracy: 0.508511/11 [==============================] - ETA: 0s - loss: 0.4889 - accuracy: 0.506911/11 [==============================] - 1s 101ms/step - loss: 0.4887 - accuracy: 0.5055
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4832 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.4904 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 0s - loss: 0.4908 - accuracy: 0.4670 4/11 [=========>....................] - ETA: 0s - loss: 0.4904 - accuracy: 0.4689 5/11 [============>.................] - ETA: 0s - loss: 0.4887 - accuracy: 0.4720 6/11 [===============>..............] - ETA: 0s - loss: 0.4878 - accuracy: 0.4738 7/11 [==================>...........] - ETA: 0s - loss: 0.4865 - accuracy: 0.4762 8/11 [====================>.........] - ETA: 0s - loss: 0.4852 - accuracy: 0.4784 9/11 [=======================>......] - ETA: 0s - loss: 0.4843 - accuracy: 0.479810/11 [==========================>...] - ETA: 0s - loss: 0.4835 - accuracy: 0.480911/11 [==============================] - ETA: 0s - loss: 0.4827 - accuracy: 0.481911/11 [==============================] - 1s 99ms/step - loss: 0.4820 - accuracy: 0.4826
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4804 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.4765 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 0s - loss: 0.4757 - accuracy: 0.5026 4/11 [=========>....................] - ETA: 0s - loss: 0.4737 - accuracy: 0.5010 5/11 [============>.................] - ETA: 0s - loss: 0.4727 - accuracy: 0.4967 6/11 [===============>..............] - ETA: 0s - loss: 0.4713 - accuracy: 0.4955 7/11 [==================>...........] - ETA: 0s - loss: 0.4701 - accuracy: 0.4952 8/11 [====================>.........] - ETA: 0s - loss: 0.4690 - accuracy: 0.4953 9/11 [=======================>......] - ETA: 0s - loss: 0.4683 - accuracy: 0.495010/11 [==========================>...] - ETA: 0s - loss: 0.4678 - accuracy: 0.494411/11 [==============================] - ETA: 0s - loss: 0.4674 - accuracy: 0.494211/11 [==============================] - 1s 103ms/step - loss: 0.4670 - accuracy: 0.4940
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4677 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.4688 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.4661 - accuracy: 0.4436 4/11 [=========>....................] - ETA: 0s - loss: 0.4643 - accuracy: 0.4494 5/11 [============>.................] - ETA: 0s - loss: 0.4631 - accuracy: 0.4545 6/11 [===============>..............] - ETA: 0s - loss: 0.4620 - accuracy: 0.4601 7/11 [==================>...........] - ETA: 0s - loss: 0.4610 - accuracy: 0.4644 8/11 [====================>.........] - ETA: 0s - loss: 0.4599 - accuracy: 0.4684 9/11 [=======================>......] - ETA: 0s - loss: 0.4589 - accuracy: 0.471410/11 [==========================>...] - ETA: 0s - loss: 0.4579 - accuracy: 0.473911/11 [==============================] - ETA: 0s - loss: 0.4572 - accuracy: 0.475811/11 [==============================] - 1s 100ms/step - loss: 0.4567 - accuracy: 0.4775
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4403 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.4421 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.4416 - accuracy: 0.4874 4/11 [=========>....................] - ETA: 0s - loss: 0.4405 - accuracy: 0.4935 5/11 [============>.................] - ETA: 0s - loss: 0.4398 - accuracy: 0.4998 6/11 [===============>..............] - ETA: 0s - loss: 0.4398 - accuracy: 0.5024 7/11 [==================>...........] - ETA: 0s - loss: 0.4396 - accuracy: 0.5037 8/11 [====================>.........] - ETA: 0s - loss: 0.4395 - accuracy: 0.5040 9/11 [=======================>......] - ETA: 0s - loss: 0.4396 - accuracy: 0.503110/11 [==========================>...] - ETA: 0s - loss: 0.4394 - accuracy: 0.502711/11 [==============================] - ETA: 0s - loss: 0.4392 - accuracy: 0.502611/11 [==============================] - 1s 105ms/step - loss: 0.4391 - accuracy: 0.5025
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4271 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.4233 - accuracy: 0.5273 3/11 [=======>......................] - ETA: 0s - loss: 0.4239 - accuracy: 0.5226 4/11 [=========>....................] - ETA: 0s - loss: 0.4237 - accuracy: 0.5238 5/11 [============>.................] - ETA: 0s - loss: 0.4244 - accuracy: 0.5206 6/11 [===============>..............] - ETA: 0s - loss: 0.4252 - accuracy: 0.5161 7/11 [==================>...........] - ETA: 0s - loss: 0.4253 - accuracy: 0.5141 8/11 [====================>.........] - ETA: 0s - loss: 0.4250 - accuracy: 0.5138 9/11 [=======================>......] - ETA: 0s - loss: 0.4249 - accuracy: 0.513110/11 [==========================>...] - ETA: 0s - loss: 0.4248 - accuracy: 0.512711/11 [==============================] - ETA: 0s - loss: 0.4247 - accuracy: 0.511711/11 [==============================] - 1s 101ms/step - loss: 0.4247 - accuracy: 0.5108
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.4487 - accuracy: 0.45313/6 [==============>...............] - ETA: 0s - loss: 0.4250 - accuracy: 0.4948 5/6 [========================>.....] - ETA: 0s - loss: 0.4222 - accuracy: 0.49386/6 [==============================] - 4s 30ms/step - loss: 0.4224 - accuracy: 0.4929
2021-12-13 23:46:22.060121: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:46:22.061000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:46:22.061053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:46:22.061139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:46:22.061173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:46:22.061201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:46:22.061286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:46:22.061318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:46:22.061345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:46:22.061410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:46:22.062598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:46:22.062626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:46:22.062636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:46:22.062644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [ 0.03682477  0.13903369  0.16393566  0.00246148 -0.01769789]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [3 2 4 1 0] pred: [-0.06329879  0.07228338  0.14968842  0.16009821  0.09119708]
 Top predictions indices: [3 2] vs. real classes indices: [3 4]
Jaccard Score: 0.3333333333333333
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [-0.00632011  0.26961797  0.31124812 -0.02035455 -0.09464779]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [ 0.01865668  0.30764395  0.34613287 -0.04168508 -0.09782756]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [ 0.00737804  0.19654554  0.23923728 -0.00251127 -0.05990464]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 4 0] pred: [-0.05309803  0.17014238  0.27559406  0.02315976 -0.0082266 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 2 1 0] pred: [-0.20674795  0.04807017  0.2204716   0.3052831   0.2666708 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [ 0.02623207  0.13226496  0.17843524 -0.00542131 -0.03178621]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 3 4] pred: [ 0.00231482  0.24487558  0.32398427 -0.02156335 -0.06851476]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [-0.04511443  0.18735984  0.30417672  0.02213955 -0.00760591]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [3 2 1 4 0] pred: [-0.09184382  0.08576653  0.12761937  0.19029866  0.08566947]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [ 0.02933132  0.18061025  0.24056312 -0.03063773 -0.05485749]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [ 0.0046488   0.13481261  0.15474464  0.04742851 -0.04203533]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [ 0.04646362  0.16370076  0.18981227 -0.00322679 -0.04255746]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [ 0.02452874  0.1338228   0.18133016 -0.01133602 -0.03410034]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:55 - loss: 1.5617 - accuracy: 0.2422 2/11 [====>.........................] - ETA: 0s - loss: 1.4326 - accuracy: 0.2773   3/11 [=======>......................] - ETA: 0s - loss: 1.3448 - accuracy: 0.3064 4/11 [=========>....................] - ETA: 0s - loss: 1.2783 - accuracy: 0.3299 5/11 [============>.................] - ETA: 0s - loss: 1.2264 - accuracy: 0.3464 6/11 [===============>..............] - ETA: 0s - loss: 1.1845 - accuracy: 0.3586 7/11 [==================>...........] - ETA: 0s - loss: 1.1484 - accuracy: 0.3689 8/11 [====================>.........] - ETA: 0s - loss: 1.1174 - accuracy: 0.3761 9/11 [=======================>......] - ETA: 0s - loss: 1.0898 - accuracy: 0.383010/11 [==========================>...] - ETA: 0s - loss: 1.0656 - accuracy: 0.388711/11 [==============================] - ETA: 0s - loss: 1.0446 - accuracy: 0.393211/11 [==============================] - 13s 103ms/step - loss: 1.0271 - accuracy: 0.3969
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6052 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.5979 - accuracy: 0.4434 3/11 [=======>......................] - ETA: 0s - loss: 0.5974 - accuracy: 0.4414 4/11 [=========>....................] - ETA: 0s - loss: 0.5976 - accuracy: 0.4360 5/11 [============>.................] - ETA: 0s - loss: 0.5963 - accuracy: 0.4335 6/11 [===============>..............] - ETA: 0s - loss: 0.5946 - accuracy: 0.4333 7/11 [==================>...........] - ETA: 0s - loss: 0.5924 - accuracy: 0.4345 8/11 [====================>.........] - ETA: 0s - loss: 0.5904 - accuracy: 0.4358 9/11 [=======================>......] - ETA: 0s - loss: 0.5881 - accuracy: 0.437810/11 [==========================>...] - ETA: 0s - loss: 0.5858 - accuracy: 0.439511/11 [==============================] - ETA: 0s - loss: 0.5836 - accuracy: 0.440911/11 [==============================] - 1s 105ms/step - loss: 0.5818 - accuracy: 0.4421
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4867 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.4859 - accuracy: 0.4941 3/11 [=======>......................] - ETA: 0s - loss: 0.4903 - accuracy: 0.4848 4/11 [=========>....................] - ETA: 0s - loss: 0.4918 - accuracy: 0.4793 5/11 [============>.................] - ETA: 0s - loss: 0.4923 - accuracy: 0.4753 6/11 [===============>..............] - ETA: 0s - loss: 0.4919 - accuracy: 0.4729 7/11 [==================>...........] - ETA: 0s - loss: 0.4911 - accuracy: 0.4720 8/11 [====================>.........] - ETA: 0s - loss: 0.4902 - accuracy: 0.4712 9/11 [=======================>......] - ETA: 0s - loss: 0.4894 - accuracy: 0.470010/11 [==========================>...] - ETA: 0s - loss: 0.4884 - accuracy: 0.468811/11 [==============================] - ETA: 0s - loss: 0.4876 - accuracy: 0.467511/11 [==============================] - 1s 103ms/step - loss: 0.4868 - accuracy: 0.4664
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4623 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 1s - loss: 0.4549 - accuracy: 0.4238 3/11 [=======>......................] - ETA: 0s - loss: 0.4516 - accuracy: 0.4266 4/11 [=========>....................] - ETA: 0s - loss: 0.4488 - accuracy: 0.4284 5/11 [============>.................] - ETA: 0s - loss: 0.4467 - accuracy: 0.4290 6/11 [===============>..............] - ETA: 0s - loss: 0.4441 - accuracy: 0.4334 7/11 [==================>...........] - ETA: 0s - loss: 0.4418 - accuracy: 0.4367 8/11 [====================>.........] - ETA: 0s - loss: 0.4398 - accuracy: 0.4386 9/11 [=======================>......] - ETA: 0s - loss: 0.4379 - accuracy: 0.440410/11 [==========================>...] - ETA: 0s - loss: 0.4362 - accuracy: 0.441611/11 [==============================] - ETA: 0s - loss: 0.4345 - accuracy: 0.442711/11 [==============================] - 1s 104ms/step - loss: 0.4331 - accuracy: 0.4437
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3894 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.3913 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.3886 - accuracy: 0.4193 4/11 [=========>....................] - ETA: 0s - loss: 0.3864 - accuracy: 0.4229 5/11 [============>.................] - ETA: 0s - loss: 0.3850 - accuracy: 0.4277 6/11 [===============>..............] - ETA: 0s - loss: 0.3834 - accuracy: 0.4328 7/11 [==================>...........] - ETA: 0s - loss: 0.3819 - accuracy: 0.4366 8/11 [====================>.........] - ETA: 0s - loss: 0.3808 - accuracy: 0.4391 9/11 [=======================>......] - ETA: 0s - loss: 0.3798 - accuracy: 0.441110/11 [==========================>...] - ETA: 0s - loss: 0.3788 - accuracy: 0.442611/11 [==============================] - ETA: 0s - loss: 0.3781 - accuracy: 0.443711/11 [==============================] - 1s 100ms/step - loss: 0.3774 - accuracy: 0.4446
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3644 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.3573 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.3538 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.3524 - accuracy: 0.4746 5/11 [============>.................] - ETA: 0s - loss: 0.3514 - accuracy: 0.4709 6/11 [===============>..............] - ETA: 0s - loss: 0.3504 - accuracy: 0.4673 7/11 [==================>...........] - ETA: 0s - loss: 0.3492 - accuracy: 0.4647 8/11 [====================>.........] - ETA: 0s - loss: 0.3481 - accuracy: 0.4631 9/11 [=======================>......] - ETA: 0s - loss: 0.3471 - accuracy: 0.462410/11 [==========================>...] - ETA: 0s - loss: 0.3462 - accuracy: 0.461811/11 [==============================] - ETA: 0s - loss: 0.3453 - accuracy: 0.461211/11 [==============================] - 1s 105ms/step - loss: 0.3446 - accuracy: 0.4607
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3538 - accuracy: 0.3906 2/11 [====>.........................] - ETA: 1s - loss: 0.3491 - accuracy: 0.3965 3/11 [=======>......................] - ETA: 0s - loss: 0.3433 - accuracy: 0.4032 4/11 [=========>....................] - ETA: 0s - loss: 0.3397 - accuracy: 0.4089 5/11 [============>.................] - ETA: 0s - loss: 0.3363 - accuracy: 0.4143 6/11 [===============>..............] - ETA: 0s - loss: 0.3337 - accuracy: 0.4171 7/11 [==================>...........] - ETA: 0s - loss: 0.3313 - accuracy: 0.4201 8/11 [====================>.........] - ETA: 0s - loss: 0.3296 - accuracy: 0.4237 9/11 [=======================>......] - ETA: 0s - loss: 0.3279 - accuracy: 0.426510/11 [==========================>...] - ETA: 0s - loss: 0.3262 - accuracy: 0.429011/11 [==============================] - ETA: 0s - loss: 0.3248 - accuracy: 0.431411/11 [==============================] - 1s 103ms/step - loss: 0.3235 - accuracy: 0.4334
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3032 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.2947 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.2946 - accuracy: 0.4991 4/11 [=========>....................] - ETA: 0s - loss: 0.2940 - accuracy: 0.4901 5/11 [============>.................] - ETA: 0s - loss: 0.2945 - accuracy: 0.4830 6/11 [===============>..............] - ETA: 0s - loss: 0.2943 - accuracy: 0.4798 7/11 [==================>...........] - ETA: 0s - loss: 0.2948 - accuracy: 0.4764 8/11 [====================>.........] - ETA: 0s - loss: 0.2950 - accuracy: 0.4736 9/11 [=======================>......] - ETA: 0s - loss: 0.2950 - accuracy: 0.471010/11 [==========================>...] - ETA: 0s - loss: 0.2946 - accuracy: 0.469411/11 [==============================] - ETA: 0s - loss: 0.2943 - accuracy: 0.468311/11 [==============================] - 1s 105ms/step - loss: 0.2941 - accuracy: 0.4673
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2800 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.2840 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.2801 - accuracy: 0.4479 4/11 [=========>....................] - ETA: 0s - loss: 0.2784 - accuracy: 0.4507 5/11 [============>.................] - ETA: 0s - loss: 0.2775 - accuracy: 0.4537 6/11 [===============>..............] - ETA: 0s - loss: 0.2768 - accuracy: 0.4553 7/11 [==================>...........] - ETA: 0s - loss: 0.2768 - accuracy: 0.4547 8/11 [====================>.........] - ETA: 0s - loss: 0.2763 - accuracy: 0.4540 9/11 [=======================>......] - ETA: 0s - loss: 0.2760 - accuracy: 0.453810/11 [==========================>...] - ETA: 0s - loss: 0.2758 - accuracy: 0.454011/11 [==============================] - ETA: 0s - loss: 0.2755 - accuracy: 0.454311/11 [==============================] - 1s 106ms/step - loss: 0.2753 - accuracy: 0.4546
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2652 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.2692 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.2696 - accuracy: 0.4497 4/11 [=========>....................] - ETA: 0s - loss: 0.2683 - accuracy: 0.4491 5/11 [============>.................] - ETA: 0s - loss: 0.2674 - accuracy: 0.4499 6/11 [===============>..............] - ETA: 0s - loss: 0.2662 - accuracy: 0.4508 7/11 [==================>...........] - ETA: 0s - loss: 0.2652 - accuracy: 0.4513 8/11 [====================>.........] - ETA: 0s - loss: 0.2648 - accuracy: 0.4508 9/11 [=======================>......] - ETA: 0s - loss: 0.2640 - accuracy: 0.451710/11 [==========================>...] - ETA: 0s - loss: 0.2633 - accuracy: 0.452611/11 [==============================] - ETA: 0s - loss: 0.2627 - accuracy: 0.453211/11 [==============================] - 1s 104ms/step - loss: 0.2621 - accuracy: 0.4537
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2542 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.2490 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 0s - loss: 0.2493 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.2483 - accuracy: 0.4482 5/11 [============>.................] - ETA: 0s - loss: 0.2483 - accuracy: 0.4470 6/11 [===============>..............] - ETA: 0s - loss: 0.2483 - accuracy: 0.4454 7/11 [==================>...........] - ETA: 0s - loss: 0.2479 - accuracy: 0.4446 8/11 [====================>.........] - ETA: 0s - loss: 0.2472 - accuracy: 0.4453 9/11 [=======================>......] - ETA: 0s - loss: 0.2462 - accuracy: 0.446410/11 [==========================>...] - ETA: 0s - loss: 0.2454 - accuracy: 0.447511/11 [==============================] - ETA: 0s - loss: 0.2447 - accuracy: 0.448711/11 [==============================] - 1s 104ms/step - loss: 0.2440 - accuracy: 0.4497
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2416 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.2372 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.2301 - accuracy: 0.4514 4/11 [=========>....................] - ETA: 0s - loss: 0.2263 - accuracy: 0.4582 5/11 [============>.................] - ETA: 0s - loss: 0.2244 - accuracy: 0.4600 6/11 [===============>..............] - ETA: 0s - loss: 0.2232 - accuracy: 0.4621 7/11 [==================>...........] - ETA: 0s - loss: 0.2229 - accuracy: 0.4621 8/11 [====================>.........] - ETA: 0s - loss: 0.2227 - accuracy: 0.4625 9/11 [=======================>......] - ETA: 0s - loss: 0.2226 - accuracy: 0.462910/11 [==========================>...] - ETA: 0s - loss: 0.2226 - accuracy: 0.463111/11 [==============================] - ETA: 0s - loss: 0.2224 - accuracy: 0.463411/11 [==============================] - 1s 107ms/step - loss: 0.2222 - accuracy: 0.4636
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2093 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.2100 - accuracy: 0.4121 3/11 [=======>......................] - ETA: 0s - loss: 0.2080 - accuracy: 0.4258 4/11 [=========>....................] - ETA: 0s - loss: 0.2069 - accuracy: 0.4346 5/11 [============>.................] - ETA: 0s - loss: 0.2069 - accuracy: 0.4389 6/11 [===============>..............] - ETA: 0s - loss: 0.2063 - accuracy: 0.4447 7/11 [==================>...........] - ETA: 0s - loss: 0.2063 - accuracy: 0.4477 8/11 [====================>.........] - ETA: 0s - loss: 0.2064 - accuracy: 0.4502 9/11 [=======================>......] - ETA: 0s - loss: 0.2065 - accuracy: 0.452810/11 [==========================>...] - ETA: 0s - loss: 0.2066 - accuracy: 0.454411/11 [==============================] - ETA: 0s - loss: 0.2066 - accuracy: 0.456011/11 [==============================] - 1s 107ms/step - loss: 0.2066 - accuracy: 0.4573
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1899 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.1921 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 0s - loss: 0.1923 - accuracy: 0.4848 4/11 [=========>....................] - ETA: 0s - loss: 0.1939 - accuracy: 0.4813 5/11 [============>.................] - ETA: 0s - loss: 0.1960 - accuracy: 0.4794 6/11 [===============>..............] - ETA: 0s - loss: 0.1977 - accuracy: 0.4785 7/11 [==================>...........] - ETA: 0s - loss: 0.1985 - accuracy: 0.4774 8/11 [====================>.........] - ETA: 0s - loss: 0.1987 - accuracy: 0.4771 9/11 [=======================>......] - ETA: 0s - loss: 0.1987 - accuracy: 0.477010/11 [==========================>...] - ETA: 0s - loss: 0.1984 - accuracy: 0.477011/11 [==============================] - ETA: 0s - loss: 0.1981 - accuracy: 0.476811/11 [==============================] - 1s 107ms/step - loss: 0.1979 - accuracy: 0.4767
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1836 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.1822 - accuracy: 0.5371 3/11 [=======>......................] - ETA: 0s - loss: 0.1866 - accuracy: 0.5178 4/11 [=========>....................] - ETA: 0s - loss: 0.1884 - accuracy: 0.5124 5/11 [============>.................] - ETA: 0s - loss: 0.1891 - accuracy: 0.5086 6/11 [===============>..............] - ETA: 0s - loss: 0.1894 - accuracy: 0.5061 7/11 [==================>...........] - ETA: 0s - loss: 0.1898 - accuracy: 0.5049 8/11 [====================>.........] - ETA: 0s - loss: 0.1899 - accuracy: 0.5044 9/11 [=======================>......] - ETA: 0s - loss: 0.1896 - accuracy: 0.504810/11 [==========================>...] - ETA: 0s - loss: 0.1894 - accuracy: 0.504611/11 [==============================] - ETA: 0s - loss: 0.1891 - accuracy: 0.504511/11 [==============================] - 1s 102ms/step - loss: 0.1888 - accuracy: 0.5044
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1639 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.1668 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.1712 - accuracy: 0.5165 4/11 [=========>....................] - ETA: 0s - loss: 0.1720 - accuracy: 0.5182 5/11 [============>.................] - ETA: 0s - loss: 0.1734 - accuracy: 0.5199 6/11 [===============>..............] - ETA: 0s - loss: 0.1733 - accuracy: 0.5209 7/11 [==================>...........] - ETA: 0s - loss: 0.1739 - accuracy: 0.5203 8/11 [====================>.........] - ETA: 0s - loss: 0.1745 - accuracy: 0.5197 9/11 [=======================>......] - ETA: 0s - loss: 0.1750 - accuracy: 0.519210/11 [==========================>...] - ETA: 0s - loss: 0.1753 - accuracy: 0.519011/11 [==============================] - ETA: 0s - loss: 0.1756 - accuracy: 0.518911/11 [==============================] - 1s 108ms/step - loss: 0.1759 - accuracy: 0.5187
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1683 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.1676 - accuracy: 0.5898 3/11 [=======>......................] - ETA: 0s - loss: 0.1695 - accuracy: 0.5859 4/11 [=========>....................] - ETA: 0s - loss: 0.1691 - accuracy: 0.5786 5/11 [============>.................] - ETA: 0s - loss: 0.1687 - accuracy: 0.5735 6/11 [===============>..............] - ETA: 0s - loss: 0.1688 - accuracy: 0.5682 7/11 [==================>...........] - ETA: 0s - loss: 0.1694 - accuracy: 0.5636 8/11 [====================>.........] - ETA: 0s - loss: 0.1694 - accuracy: 0.5609 9/11 [=======================>......] - ETA: 0s - loss: 0.1694 - accuracy: 0.558710/11 [==========================>...] - ETA: 0s - loss: 0.1694 - accuracy: 0.556511/11 [==============================] - ETA: 0s - loss: 0.1696 - accuracy: 0.554811/11 [==============================] - 1s 107ms/step - loss: 0.1698 - accuracy: 0.5534
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1708 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 0s - loss: 0.1750 - accuracy: 0.5918 3/11 [=======>......................] - ETA: 0s - loss: 0.1757 - accuracy: 0.5872 4/11 [=========>....................] - ETA: 0s - loss: 0.1745 - accuracy: 0.5859 5/11 [============>.................] - ETA: 0s - loss: 0.1732 - accuracy: 0.5862 6/11 [===============>..............] - ETA: 0s - loss: 0.1724 - accuracy: 0.5866 7/11 [==================>...........] - ETA: 0s - loss: 0.1718 - accuracy: 0.5857 8/11 [====================>.........] - ETA: 0s - loss: 0.1714 - accuracy: 0.5848 9/11 [=======================>......] - ETA: 0s - loss: 0.1709 - accuracy: 0.583910/11 [==========================>...] - ETA: 0s - loss: 0.1704 - accuracy: 0.582811/11 [==============================] - ETA: 0s - loss: 0.1700 - accuracy: 0.581511/11 [==============================] - 1s 105ms/step - loss: 0.1696 - accuracy: 0.5803
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1771 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.1732 - accuracy: 0.5684 3/11 [=======>......................] - ETA: 0s - loss: 0.1695 - accuracy: 0.5777 4/11 [=========>....................] - ETA: 0s - loss: 0.1681 - accuracy: 0.5846 5/11 [============>.................] - ETA: 0s - loss: 0.1670 - accuracy: 0.5930 6/11 [===============>..............] - ETA: 0s - loss: 0.1663 - accuracy: 0.5981 7/11 [==================>...........] - ETA: 0s - loss: 0.1654 - accuracy: 0.6031 8/11 [====================>.........] - ETA: 0s - loss: 0.1643 - accuracy: 0.6083 9/11 [=======================>......] - ETA: 0s - loss: 0.1635 - accuracy: 0.612410/11 [==========================>...] - ETA: 0s - loss: 0.1631 - accuracy: 0.616011/11 [==============================] - ETA: 0s - loss: 0.1627 - accuracy: 0.619611/11 [==============================] - 1s 111ms/step - loss: 0.1624 - accuracy: 0.6227
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1662 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 0s - loss: 0.1603 - accuracy: 0.6348 3/11 [=======>......................] - ETA: 0s - loss: 0.1586 - accuracy: 0.6332 4/11 [=========>....................] - ETA: 0s - loss: 0.1559 - accuracy: 0.6390 5/11 [============>.................] - ETA: 0s - loss: 0.1541 - accuracy: 0.6434 6/11 [===============>..............] - ETA: 0s - loss: 0.1539 - accuracy: 0.6473 7/11 [==================>...........] - ETA: 0s - loss: 0.1537 - accuracy: 0.6500 8/11 [====================>.........] - ETA: 0s - loss: 0.1536 - accuracy: 0.6537 9/11 [=======================>......] - ETA: 0s - loss: 0.1537 - accuracy: 0.656210/11 [==========================>...] - ETA: 0s - loss: 0.1536 - accuracy: 0.658111/11 [==============================] - ETA: 0s - loss: 0.1534 - accuracy: 0.659411/11 [==============================] - 1s 110ms/step - loss: 0.1533 - accuracy: 0.6605
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.1419 - accuracy: 0.71883/6 [==============>...............] - ETA: 0s - loss: 0.1567 - accuracy: 0.7370 5/6 [========================>.....] - ETA: 0s - loss: 0.1604 - accuracy: 0.70316/6 [==============================] - 4s 30ms/step - loss: 0.1612 - accuracy: 0.6969
2021-12-13 23:47:09.987864: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:47:09.988681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:47:09.988729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:47:09.988769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:47:09.988798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:47:09.988824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:47:09.988850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:47:09.988876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:47:09.988902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:47:09.988932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:47:09.990081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:47:09.990109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:47:09.990118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:47:09.990125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 4 0 1] pred: [-0.73030734 -0.81306696  0.9899676  -0.4286173  -0.4970958 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 2 0 1] pred: [-0.10658913 -0.4312814  -0.00505402  0.4777226   0.42816052]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 4 3] pred: [-0.35938165  0.76187366  0.925922   -0.6576166  -0.6554144 ]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 3 0 4] pred: [-0.20768166  0.5320336   0.46611354  0.02812283 -0.21808843]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 4 3 0 1] pred: [-0.6412792 -0.7847133  0.991585  -0.5471269 -0.5300151]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 4 0 1] pred: [-0.6161161  -0.9564385   0.99411947 -0.2670887  -0.44939315]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [-0.10198995  0.77586937  0.80893224 -0.33015794 -0.5043735 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [-0.29325023  0.7719736   0.84147865 -0.2300608  -0.51396465]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 0 1] pred: [-0.06498269 -0.21183684  0.3927613   0.5136177   0.09276752]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 4 2 0 1] pred: [-0.06817455 -0.27660283  0.08043226  0.35742518  0.18327492]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [-0.53536016  0.85011613  0.930807   -0.56922513 -0.6924752 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [-0.17798303  0.73270047  0.80363864 -0.19148509 -0.4647736 ]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [-0.70150274 -0.17646182  0.9704432  -0.3584929  -0.5240902 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 4 0 1] pred: [-0.34051576 -0.6718965   0.7300645   0.4349452   0.04242612]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [-0.12810622  0.8316699   0.84503335 -0.50903535 -0.58723694]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:03 - loss: 2.1476 - accuracy: 0.3359 2/11 [====>.........................] - ETA: 0s - loss: 1.8805 - accuracy: 0.3711   3/11 [=======>......................] - ETA: 0s - loss: 1.7122 - accuracy: 0.3845 4/11 [=========>....................] - ETA: 0s - loss: 1.5913 - accuracy: 0.3939 5/11 [============>.................] - ETA: 0s - loss: 1.5003 - accuracy: 0.4001 6/11 [===============>..............] - ETA: 0s - loss: 1.4273 - accuracy: 0.4083 7/11 [==================>...........] - ETA: 0s - loss: 1.3676 - accuracy: 0.4144 8/11 [====================>.........] - ETA: 0s - loss: 1.3184 - accuracy: 0.4180 9/11 [=======================>......] - ETA: 0s - loss: 1.2757 - accuracy: 0.422210/11 [==========================>...] - ETA: 0s - loss: 1.2383 - accuracy: 0.425911/11 [==============================] - ETA: 0s - loss: 1.2060 - accuracy: 0.429111/11 [==============================] - 13s 106ms/step - loss: 1.1791 - accuracy: 0.4317
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6032 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.5970 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 0s - loss: 0.5926 - accuracy: 0.4605 4/11 [=========>....................] - ETA: 0s - loss: 0.5874 - accuracy: 0.4626 5/11 [============>.................] - ETA: 0s - loss: 0.5822 - accuracy: 0.4669 6/11 [===============>..............] - ETA: 0s - loss: 0.5774 - accuracy: 0.4696 7/11 [==================>...........] - ETA: 0s - loss: 0.5727 - accuracy: 0.4728 8/11 [====================>.........] - ETA: 0s - loss: 0.5686 - accuracy: 0.4742 9/11 [=======================>......] - ETA: 0s - loss: 0.5648 - accuracy: 0.474810/11 [==========================>...] - ETA: 0s - loss: 0.5612 - accuracy: 0.475711/11 [==============================] - ETA: 0s - loss: 0.5579 - accuracy: 0.476011/11 [==============================] - 1s 109ms/step - loss: 0.5551 - accuracy: 0.4762
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4775 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 1s - loss: 0.4666 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 0s - loss: 0.4621 - accuracy: 0.4592 4/11 [=========>....................] - ETA: 0s - loss: 0.4569 - accuracy: 0.4689 5/11 [============>.................] - ETA: 0s - loss: 0.4532 - accuracy: 0.4723 6/11 [===============>..............] - ETA: 0s - loss: 0.4501 - accuracy: 0.4732 7/11 [==================>...........] - ETA: 0s - loss: 0.4469 - accuracy: 0.4734 8/11 [====================>.........] - ETA: 0s - loss: 0.4444 - accuracy: 0.4726 9/11 [=======================>......] - ETA: 0s - loss: 0.4416 - accuracy: 0.472210/11 [==========================>...] - ETA: 0s - loss: 0.4391 - accuracy: 0.472211/11 [==============================] - ETA: 0s - loss: 0.4367 - accuracy: 0.472011/11 [==============================] - 1s 110ms/step - loss: 0.4347 - accuracy: 0.4718
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3881 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.3830 - accuracy: 0.4395 3/11 [=======>......................] - ETA: 0s - loss: 0.3781 - accuracy: 0.4414 4/11 [=========>....................] - ETA: 0s - loss: 0.3738 - accuracy: 0.4448 5/11 [============>.................] - ETA: 0s - loss: 0.3708 - accuracy: 0.4487 6/11 [===============>..............] - ETA: 0s - loss: 0.3685 - accuracy: 0.4494 7/11 [==================>...........] - ETA: 0s - loss: 0.3662 - accuracy: 0.4515 8/11 [====================>.........] - ETA: 0s - loss: 0.3641 - accuracy: 0.4533 9/11 [=======================>......] - ETA: 0s - loss: 0.3620 - accuracy: 0.455310/11 [==========================>...] - ETA: 0s - loss: 0.3601 - accuracy: 0.456511/11 [==============================] - ETA: 0s - loss: 0.3585 - accuracy: 0.456911/11 [==============================] - 1s 106ms/step - loss: 0.3573 - accuracy: 0.4573
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3048 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.3155 - accuracy: 0.4590 3/11 [=======>......................] - ETA: 0s - loss: 0.3189 - accuracy: 0.4588 4/11 [=========>....................] - ETA: 0s - loss: 0.3182 - accuracy: 0.4613 5/11 [============>.................] - ETA: 0s - loss: 0.3179 - accuracy: 0.4609 6/11 [===============>..............] - ETA: 0s - loss: 0.3171 - accuracy: 0.4618 7/11 [==================>...........] - ETA: 0s - loss: 0.3169 - accuracy: 0.4624 8/11 [====================>.........] - ETA: 0s - loss: 0.3167 - accuracy: 0.4627 9/11 [=======================>......] - ETA: 0s - loss: 0.3163 - accuracy: 0.462510/11 [==========================>...] - ETA: 0s - loss: 0.3156 - accuracy: 0.462911/11 [==============================] - ETA: 0s - loss: 0.3151 - accuracy: 0.463011/11 [==============================] - 1s 103ms/step - loss: 0.3146 - accuracy: 0.4631
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2962 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.2927 - accuracy: 0.4473 3/11 [=======>......................] - ETA: 0s - loss: 0.2943 - accuracy: 0.4484 4/11 [=========>....................] - ETA: 0s - loss: 0.2930 - accuracy: 0.4578 5/11 [============>.................] - ETA: 0s - loss: 0.2935 - accuracy: 0.4613 6/11 [===============>..............] - ETA: 0s - loss: 0.2938 - accuracy: 0.4632 7/11 [==================>...........] - ETA: 0s - loss: 0.2937 - accuracy: 0.4646 8/11 [====================>.........] - ETA: 0s - loss: 0.2938 - accuracy: 0.4652 9/11 [=======================>......] - ETA: 0s - loss: 0.2938 - accuracy: 0.465310/11 [==========================>...] - ETA: 0s - loss: 0.2937 - accuracy: 0.465111/11 [==============================] - ETA: 0s - loss: 0.2933 - accuracy: 0.465411/11 [==============================] - 1s 105ms/step - loss: 0.2931 - accuracy: 0.4656
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3005 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.2880 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 0s - loss: 0.2871 - accuracy: 0.4492 4/11 [=========>....................] - ETA: 0s - loss: 0.2863 - accuracy: 0.4463 5/11 [============>.................] - ETA: 0s - loss: 0.2865 - accuracy: 0.4455 6/11 [===============>..............] - ETA: 0s - loss: 0.2863 - accuracy: 0.4452 7/11 [==================>...........] - ETA: 0s - loss: 0.2857 - accuracy: 0.4462 8/11 [====================>.........] - ETA: 0s - loss: 0.2852 - accuracy: 0.4473 9/11 [=======================>......] - ETA: 0s - loss: 0.2847 - accuracy: 0.448710/11 [==========================>...] - ETA: 0s - loss: 0.2841 - accuracy: 0.451011/11 [==============================] - ETA: 0s - loss: 0.2834 - accuracy: 0.453011/11 [==============================] - 1s 106ms/step - loss: 0.2828 - accuracy: 0.4546
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2610 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.2591 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 0s - loss: 0.2597 - accuracy: 0.4848 4/11 [=========>....................] - ETA: 0s - loss: 0.2584 - accuracy: 0.4837 5/11 [============>.................] - ETA: 0s - loss: 0.2579 - accuracy: 0.4864 6/11 [===============>..............] - ETA: 0s - loss: 0.2573 - accuracy: 0.4893 7/11 [==================>...........] - ETA: 0s - loss: 0.2572 - accuracy: 0.4903 8/11 [====================>.........] - ETA: 0s - loss: 0.2575 - accuracy: 0.4902 9/11 [=======================>......] - ETA: 0s - loss: 0.2578 - accuracy: 0.489610/11 [==========================>...] - ETA: 0s - loss: 0.2580 - accuracy: 0.488611/11 [==============================] - ETA: 0s - loss: 0.2584 - accuracy: 0.487811/11 [==============================] - 1s 109ms/step - loss: 0.2587 - accuracy: 0.4871
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2520 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.2502 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.2519 - accuracy: 0.4818 4/11 [=========>....................] - ETA: 0s - loss: 0.2540 - accuracy: 0.4775 5/11 [============>.................] - ETA: 0s - loss: 0.2550 - accuracy: 0.4758 6/11 [===============>..............] - ETA: 0s - loss: 0.2552 - accuracy: 0.4759 7/11 [==================>...........] - ETA: 0s - loss: 0.2552 - accuracy: 0.4766 8/11 [====================>.........] - ETA: 0s - loss: 0.2554 - accuracy: 0.4769 9/11 [=======================>......] - ETA: 0s - loss: 0.2549 - accuracy: 0.478310/11 [==========================>...] - ETA: 0s - loss: 0.2542 - accuracy: 0.479311/11 [==============================] - ETA: 0s - loss: 0.2537 - accuracy: 0.479911/11 [==============================] - 1s 104ms/step - loss: 0.2533 - accuracy: 0.4804
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2566 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.2528 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.2493 - accuracy: 0.4822 4/11 [=========>....................] - ETA: 0s - loss: 0.2482 - accuracy: 0.4832 5/11 [============>.................] - ETA: 0s - loss: 0.2480 - accuracy: 0.4813 6/11 [===============>..............] - ETA: 0s - loss: 0.2458 - accuracy: 0.4829 7/11 [==================>...........] - ETA: 0s - loss: 0.2440 - accuracy: 0.4855 8/11 [====================>.........] - ETA: 0s - loss: 0.2426 - accuracy: 0.4873 9/11 [=======================>......] - ETA: 0s - loss: 0.2415 - accuracy: 0.488810/11 [==========================>...] - ETA: 0s - loss: 0.2404 - accuracy: 0.490011/11 [==============================] - ETA: 0s - loss: 0.2396 - accuracy: 0.490511/11 [==============================] - 1s 107ms/step - loss: 0.2390 - accuracy: 0.4909
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1990 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 0s - loss: 0.2074 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.2124 - accuracy: 0.5226 4/11 [=========>....................] - ETA: 0s - loss: 0.2134 - accuracy: 0.5228 5/11 [============>.................] - ETA: 0s - loss: 0.2130 - accuracy: 0.5226 6/11 [===============>..............] - ETA: 0s - loss: 0.2131 - accuracy: 0.5217 7/11 [==================>...........] - ETA: 0s - loss: 0.2132 - accuracy: 0.5224 8/11 [====================>.........] - ETA: 0s - loss: 0.2134 - accuracy: 0.5228 9/11 [=======================>......] - ETA: 0s - loss: 0.2133 - accuracy: 0.522610/11 [==========================>...] - ETA: 0s - loss: 0.2133 - accuracy: 0.521611/11 [==============================] - ETA: 0s - loss: 0.2134 - accuracy: 0.520711/11 [==============================] - 1s 106ms/step - loss: 0.2134 - accuracy: 0.5199
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2035 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.2102 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 0s - loss: 0.2077 - accuracy: 0.5139 4/11 [=========>....................] - ETA: 0s - loss: 0.2075 - accuracy: 0.5085 5/11 [============>.................] - ETA: 0s - loss: 0.2062 - accuracy: 0.5083 6/11 [===============>..............] - ETA: 0s - loss: 0.2060 - accuracy: 0.5082 7/11 [==================>...........] - ETA: 0s - loss: 0.2052 - accuracy: 0.5083 8/11 [====================>.........] - ETA: 0s - loss: 0.2045 - accuracy: 0.5097 9/11 [=======================>......] - ETA: 0s - loss: 0.2040 - accuracy: 0.511610/11 [==========================>...] - ETA: 0s - loss: 0.2032 - accuracy: 0.513411/11 [==============================] - ETA: 0s - loss: 0.2025 - accuracy: 0.514711/11 [==============================] - 1s 106ms/step - loss: 0.2019 - accuracy: 0.5157
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1971 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.1960 - accuracy: 0.4805 3/11 [=======>......................] - ETA: 0s - loss: 0.1966 - accuracy: 0.4861 4/11 [=========>....................] - ETA: 0s - loss: 0.1958 - accuracy: 0.4910 5/11 [============>.................] - ETA: 0s - loss: 0.1949 - accuracy: 0.4978 6/11 [===============>..............] - ETA: 0s - loss: 0.1935 - accuracy: 0.5028 7/11 [==================>...........] - ETA: 0s - loss: 0.1927 - accuracy: 0.5073 8/11 [====================>.........] - ETA: 0s - loss: 0.1921 - accuracy: 0.5120 9/11 [=======================>......] - ETA: 0s - loss: 0.1911 - accuracy: 0.516510/11 [==========================>...] - ETA: 0s - loss: 0.1900 - accuracy: 0.520911/11 [==============================] - ETA: 0s - loss: 0.1890 - accuracy: 0.525311/11 [==============================] - 1s 110ms/step - loss: 0.1882 - accuracy: 0.5289
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1687 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.1664 - accuracy: 0.5820 3/11 [=======>......................] - ETA: 0s - loss: 0.1658 - accuracy: 0.5773 4/11 [=========>....................] - ETA: 0s - loss: 0.1664 - accuracy: 0.5799 5/11 [============>.................] - ETA: 0s - loss: 0.1666 - accuracy: 0.5817 6/11 [===============>..............] - ETA: 0s - loss: 0.1663 - accuracy: 0.5846 7/11 [==================>...........] - ETA: 0s - loss: 0.1663 - accuracy: 0.5875 8/11 [====================>.........] - ETA: 0s - loss: 0.1664 - accuracy: 0.5899 9/11 [=======================>......] - ETA: 0s - loss: 0.1666 - accuracy: 0.592310/11 [==========================>...] - ETA: 0s - loss: 0.1668 - accuracy: 0.595111/11 [==============================] - ETA: 0s - loss: 0.1669 - accuracy: 0.597611/11 [==============================] - 1s 109ms/step - loss: 0.1669 - accuracy: 0.5997
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1561 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 0s - loss: 0.1575 - accuracy: 0.6816 3/11 [=======>......................] - ETA: 0s - loss: 0.1585 - accuracy: 0.6766 4/11 [=========>....................] - ETA: 0s - loss: 0.1594 - accuracy: 0.6715 5/11 [============>.................] - ETA: 0s - loss: 0.1602 - accuracy: 0.6682 6/11 [===============>..............] - ETA: 0s - loss: 0.1602 - accuracy: 0.6655 7/11 [==================>...........] - ETA: 0s - loss: 0.1602 - accuracy: 0.6648 8/11 [====================>.........] - ETA: 0s - loss: 0.1600 - accuracy: 0.6632 9/11 [=======================>......] - ETA: 0s - loss: 0.1597 - accuracy: 0.660910/11 [==========================>...] - ETA: 0s - loss: 0.1594 - accuracy: 0.658811/11 [==============================] - ETA: 0s - loss: 0.1590 - accuracy: 0.657511/11 [==============================] - 1s 105ms/step - loss: 0.1587 - accuracy: 0.6564
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1536 - accuracy: 0.6797 2/11 [====>.........................] - ETA: 0s - loss: 0.1544 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.1542 - accuracy: 0.6858 4/11 [=========>....................] - ETA: 0s - loss: 0.1548 - accuracy: 0.6852 5/11 [============>.................] - ETA: 0s - loss: 0.1543 - accuracy: 0.6851 6/11 [===============>..............] - ETA: 0s - loss: 0.1535 - accuracy: 0.6857 7/11 [==================>...........] - ETA: 0s - loss: 0.1528 - accuracy: 0.6863 8/11 [====================>.........] - ETA: 0s - loss: 0.1523 - accuracy: 0.6860 9/11 [=======================>......] - ETA: 0s - loss: 0.1518 - accuracy: 0.686510/11 [==========================>...] - ETA: 0s - loss: 0.1511 - accuracy: 0.687311/11 [==============================] - ETA: 0s - loss: 0.1505 - accuracy: 0.688111/11 [==============================] - 1s 103ms/step - loss: 0.1500 - accuracy: 0.6889
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0972 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 0s - loss: 0.1085 - accuracy: 0.7461 3/11 [=======>......................] - ETA: 0s - loss: 0.1150 - accuracy: 0.7361 4/11 [=========>....................] - ETA: 0s - loss: 0.1194 - accuracy: 0.7303 5/11 [============>.................] - ETA: 0s - loss: 0.1224 - accuracy: 0.7277 6/11 [===============>..............] - ETA: 0s - loss: 0.1245 - accuracy: 0.7251 7/11 [==================>...........] - ETA: 0s - loss: 0.1263 - accuracy: 0.7229 8/11 [====================>.........] - ETA: 0s - loss: 0.1274 - accuracy: 0.7223 9/11 [=======================>......] - ETA: 0s - loss: 0.1285 - accuracy: 0.721710/11 [==========================>...] - ETA: 0s - loss: 0.1293 - accuracy: 0.721611/11 [==============================] - ETA: 0s - loss: 0.1300 - accuracy: 0.721611/11 [==============================] - 1s 107ms/step - loss: 0.1305 - accuracy: 0.7217
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1210 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 1s - loss: 0.1252 - accuracy: 0.7305 3/11 [=======>......................] - ETA: 0s - loss: 0.1283 - accuracy: 0.7292 4/11 [=========>....................] - ETA: 0s - loss: 0.1295 - accuracy: 0.7334 5/11 [============>.................] - ETA: 0s - loss: 0.1306 - accuracy: 0.7345 6/11 [===============>..............] - ETA: 0s - loss: 0.1312 - accuracy: 0.7365 7/11 [==================>...........] - ETA: 0s - loss: 0.1315 - accuracy: 0.7382 8/11 [====================>.........] - ETA: 0s - loss: 0.1316 - accuracy: 0.7403 9/11 [=======================>......] - ETA: 0s - loss: 0.1317 - accuracy: 0.741210/11 [==========================>...] - ETA: 0s - loss: 0.1315 - accuracy: 0.742011/11 [==============================] - ETA: 0s - loss: 0.1314 - accuracy: 0.742511/11 [==============================] - 1s 109ms/step - loss: 0.1314 - accuracy: 0.7428
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1102 - accuracy: 0.7891 2/11 [====>.........................] - ETA: 0s - loss: 0.1172 - accuracy: 0.7773 3/11 [=======>......................] - ETA: 0s - loss: 0.1204 - accuracy: 0.7760 4/11 [=========>....................] - ETA: 0s - loss: 0.1229 - accuracy: 0.7754 5/11 [============>.................] - ETA: 0s - loss: 0.1237 - accuracy: 0.7775 6/11 [===============>..............] - ETA: 0s - loss: 0.1239 - accuracy: 0.7777 7/11 [==================>...........] - ETA: 0s - loss: 0.1243 - accuracy: 0.7760 8/11 [====================>.........] - ETA: 0s - loss: 0.1246 - accuracy: 0.7742 9/11 [=======================>......] - ETA: 0s - loss: 0.1245 - accuracy: 0.773410/11 [==========================>...] - ETA: 0s - loss: 0.1245 - accuracy: 0.772711/11 [==============================] - ETA: 0s - loss: 0.1245 - accuracy: 0.772211/11 [==============================] - 1s 103ms/step - loss: 0.1246 - accuracy: 0.7717
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1198 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 0s - loss: 0.1245 - accuracy: 0.7617 3/11 [=======>......................] - ETA: 0s - loss: 0.1249 - accuracy: 0.7639 4/11 [=========>....................] - ETA: 0s - loss: 0.1250 - accuracy: 0.7643 5/11 [============>.................] - ETA: 0s - loss: 0.1255 - accuracy: 0.7643 6/11 [===============>..............] - ETA: 0s - loss: 0.1252 - accuracy: 0.7662 7/11 [==================>...........] - ETA: 0s - loss: 0.1248 - accuracy: 0.7682 8/11 [====================>.........] - ETA: 0s - loss: 0.1243 - accuracy: 0.7698 9/11 [=======================>......] - ETA: 0s - loss: 0.1240 - accuracy: 0.770710/11 [==========================>...] - ETA: 0s - loss: 0.1237 - accuracy: 0.770711/11 [==============================] - ETA: 0s - loss: 0.1234 - accuracy: 0.770511/11 [==============================] - 1s 103ms/step - loss: 0.1231 - accuracy: 0.7703
Evaluate on test data
1/6 [====>.........................] - ETA: 18s - loss: 0.1346 - accuracy: 0.75783/6 [==============>...............] - ETA: 0s - loss: 0.1312 - accuracy: 0.6901 5/6 [========================>.....] - ETA: 0s - loss: 0.1318 - accuracy: 0.70476/6 [==============================] - 4s 28ms/step - loss: 0.1319 - accuracy: 0.7082
2021-12-13 23:47:57.985611: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:47:57.986990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:47:57.987050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:47:57.987121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:47:57.987160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:47:57.987195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:47:57.987247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:47:57.987286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:47:57.987332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:47:57.987373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:47:57.988757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:47:57.988792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:47:57.988805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:47:57.988815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 4 3] pred: [-0.1573818   0.8544294   0.8161257  -0.61934423 -0.58823305]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 1 4 0] pred: [-0.4964024  -0.05568108  0.7691561   0.08173816 -0.3672363 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 0 4 1] pred: [-0.5004354  -0.97451293  0.9956225   0.00286258 -0.8939674 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [-0.49724498  0.60375816  0.9349527  -0.564422   -0.7748895 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 4 3] pred: [-0.5284578   0.90316206  0.85727596 -0.6766268  -0.56158835]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 4 3] pred: [ 0.00516585  0.903206    0.7566656  -0.72080606 -0.5707599 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 0 4] pred: [-0.7431557  -0.6848859   0.98143864 -0.21907866 -0.8586528 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 3 0 4] pred: [-0.33162266  0.6517794   0.5743834  -0.14920345 -0.37120506]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 0 1] pred: [-0.02064438 -0.21945867  0.1258296   0.61119974  0.09839262]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 4 3] pred: [-0.79539627 -0.69542015  0.9978875  -0.9418286  -0.91555   ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [-0.1178769   0.7247265   0.62704146 -0.2841229  -0.46239227]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [-0.01946392  0.7104624   0.38027164 -0.15549183 -0.2953276 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [-0.31159467  0.65930647  0.80258435 -0.1737277  -0.62411004]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 4 3] pred: [-0.19409382  0.8789662   0.74237704 -0.70360214 -0.42437238]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [-0.6969989  0.7312405  0.9698798 -0.838699  -0.8610752]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:05 - loss: 3.0867 - accuracy: 0.1172 2/11 [====>.........................] - ETA: 0s - loss: 2.6627 - accuracy: 0.1797   3/11 [=======>......................] - ETA: 0s - loss: 2.4123 - accuracy: 0.2118 4/11 [=========>....................] - ETA: 0s - loss: 2.2322 - accuracy: 0.2331 5/11 [============>.................] - ETA: 0s - loss: 2.0960 - accuracy: 0.2502 6/11 [===============>..............] - ETA: 0s - loss: 1.9863 - accuracy: 0.2662 7/11 [==================>...........] - ETA: 0s - loss: 1.8952 - accuracy: 0.2819 8/11 [====================>.........] - ETA: 0s - loss: 1.8175 - accuracy: 0.2961 9/11 [=======================>......] - ETA: 0s - loss: 1.7504 - accuracy: 0.308810/11 [==========================>...] - ETA: 0s - loss: 1.6916 - accuracy: 0.320011/11 [==============================] - ETA: 0s - loss: 1.6407 - accuracy: 0.329711/11 [==============================] - 14s 104ms/step - loss: 1.5983 - accuracy: 0.3378
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6757 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.6752 - accuracy: 0.4512 3/11 [=======>......................] - ETA: 0s - loss: 0.6712 - accuracy: 0.4614 4/11 [=========>....................] - ETA: 0s - loss: 0.6638 - accuracy: 0.4754 5/11 [============>.................] - ETA: 0s - loss: 0.6588 - accuracy: 0.4822 6/11 [===============>..............] - ETA: 0s - loss: 0.6546 - accuracy: 0.4858 7/11 [==================>...........] - ETA: 0s - loss: 0.6512 - accuracy: 0.4877 8/11 [====================>.........] - ETA: 0s - loss: 0.6483 - accuracy: 0.4883 9/11 [=======================>......] - ETA: 0s - loss: 0.6451 - accuracy: 0.488610/11 [==========================>...] - ETA: 0s - loss: 0.6421 - accuracy: 0.489011/11 [==============================] - ETA: 0s - loss: 0.6394 - accuracy: 0.489411/11 [==============================] - 1s 106ms/step - loss: 0.6371 - accuracy: 0.4898
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5475 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.5448 - accuracy: 0.4863 3/11 [=======>......................] - ETA: 0s - loss: 0.5430 - accuracy: 0.4909 4/11 [=========>....................] - ETA: 0s - loss: 0.5411 - accuracy: 0.4907 5/11 [============>.................] - ETA: 0s - loss: 0.5402 - accuracy: 0.4895 6/11 [===============>..............] - ETA: 0s - loss: 0.5390 - accuracy: 0.4886 7/11 [==================>...........] - ETA: 0s - loss: 0.5371 - accuracy: 0.4896 8/11 [====================>.........] - ETA: 0s - loss: 0.5356 - accuracy: 0.4891 9/11 [=======================>......] - ETA: 0s - loss: 0.5341 - accuracy: 0.488110/11 [==========================>...] - ETA: 0s - loss: 0.5328 - accuracy: 0.486711/11 [==============================] - ETA: 0s - loss: 0.5316 - accuracy: 0.485611/11 [==============================] - 1s 102ms/step - loss: 0.5306 - accuracy: 0.4848
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4785 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.4720 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 0s - loss: 0.4713 - accuracy: 0.5043 4/11 [=========>....................] - ETA: 0s - loss: 0.4719 - accuracy: 0.4974 5/11 [============>.................] - ETA: 0s - loss: 0.4715 - accuracy: 0.4926 6/11 [===============>..............] - ETA: 0s - loss: 0.4706 - accuracy: 0.4886 7/11 [==================>...........] - ETA: 0s - loss: 0.4695 - accuracy: 0.4863 8/11 [====================>.........] - ETA: 0s - loss: 0.4688 - accuracy: 0.4840 9/11 [=======================>......] - ETA: 0s - loss: 0.4678 - accuracy: 0.482810/11 [==========================>...] - ETA: 0s - loss: 0.4668 - accuracy: 0.481811/11 [==============================] - ETA: 0s - loss: 0.4659 - accuracy: 0.481011/11 [==============================] - 1s 101ms/step - loss: 0.4652 - accuracy: 0.4802
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4127 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 0s - loss: 0.4140 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.4172 - accuracy: 0.5035 4/11 [=========>....................] - ETA: 0s - loss: 0.4185 - accuracy: 0.4919 5/11 [============>.................] - ETA: 0s - loss: 0.4186 - accuracy: 0.4860 6/11 [===============>..............] - ETA: 0s - loss: 0.4191 - accuracy: 0.4794 7/11 [==================>...........] - ETA: 0s - loss: 0.4187 - accuracy: 0.4758 8/11 [====================>.........] - ETA: 0s - loss: 0.4180 - accuracy: 0.4738 9/11 [=======================>......] - ETA: 0s - loss: 0.4171 - accuracy: 0.472510/11 [==========================>...] - ETA: 0s - loss: 0.4160 - accuracy: 0.472111/11 [==============================] - ETA: 0s - loss: 0.4150 - accuracy: 0.471511/11 [==============================] - 1s 111ms/step - loss: 0.4142 - accuracy: 0.4711
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3747 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.3815 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 0s - loss: 0.3815 - accuracy: 0.4479 4/11 [=========>....................] - ETA: 0s - loss: 0.3797 - accuracy: 0.4521 5/11 [============>.................] - ETA: 0s - loss: 0.3776 - accuracy: 0.4570 6/11 [===============>..............] - ETA: 0s - loss: 0.3754 - accuracy: 0.4622 7/11 [==================>...........] - ETA: 0s - loss: 0.3738 - accuracy: 0.4646 8/11 [====================>.........] - ETA: 0s - loss: 0.3725 - accuracy: 0.4651 9/11 [=======================>......] - ETA: 0s - loss: 0.3714 - accuracy: 0.465210/11 [==========================>...] - ETA: 0s - loss: 0.3702 - accuracy: 0.464911/11 [==============================] - ETA: 0s - loss: 0.3693 - accuracy: 0.464511/11 [==============================] - 1s 105ms/step - loss: 0.3685 - accuracy: 0.4642
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3265 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.3276 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.3309 - accuracy: 0.4748 4/11 [=========>....................] - ETA: 0s - loss: 0.3320 - accuracy: 0.4709 5/11 [============>.................] - ETA: 0s - loss: 0.3325 - accuracy: 0.4692 6/11 [===============>..............] - ETA: 0s - loss: 0.3334 - accuracy: 0.4667 7/11 [==================>...........] - ETA: 0s - loss: 0.3338 - accuracy: 0.4643 8/11 [====================>.........] - ETA: 0s - loss: 0.3337 - accuracy: 0.4630 9/11 [=======================>......] - ETA: 0s - loss: 0.3332 - accuracy: 0.462610/11 [==========================>...] - ETA: 0s - loss: 0.3328 - accuracy: 0.462211/11 [==============================] - ETA: 0s - loss: 0.3323 - accuracy: 0.462011/11 [==============================] - 1s 108ms/step - loss: 0.3319 - accuracy: 0.4618
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3041 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.3164 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 0s - loss: 0.3191 - accuracy: 0.4614 4/11 [=========>....................] - ETA: 0s - loss: 0.3197 - accuracy: 0.4578 5/11 [============>.................] - ETA: 0s - loss: 0.3197 - accuracy: 0.4550 6/11 [===============>..............] - ETA: 0s - loss: 0.3195 - accuracy: 0.4534 7/11 [==================>...........] - ETA: 0s - loss: 0.3194 - accuracy: 0.4518 8/11 [====================>.........] - ETA: 0s - loss: 0.3186 - accuracy: 0.4528 9/11 [=======================>......] - ETA: 0s - loss: 0.3182 - accuracy: 0.452310/11 [==========================>...] - ETA: 0s - loss: 0.3175 - accuracy: 0.453011/11 [==============================] - ETA: 0s - loss: 0.3167 - accuracy: 0.453711/11 [==============================] - 1s 100ms/step - loss: 0.3160 - accuracy: 0.4543
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3196 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.3151 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 0s - loss: 0.3131 - accuracy: 0.4414 4/11 [=========>....................] - ETA: 0s - loss: 0.3102 - accuracy: 0.4434 5/11 [============>.................] - ETA: 0s - loss: 0.3082 - accuracy: 0.4428 6/11 [===============>..............] - ETA: 0s - loss: 0.3058 - accuracy: 0.4458 7/11 [==================>...........] - ETA: 0s - loss: 0.3038 - accuracy: 0.4474 8/11 [====================>.........] - ETA: 0s - loss: 0.3026 - accuracy: 0.4477 9/11 [=======================>......] - ETA: 0s - loss: 0.3017 - accuracy: 0.448810/11 [==========================>...] - ETA: 0s - loss: 0.3009 - accuracy: 0.449711/11 [==============================] - ETA: 0s - loss: 0.3002 - accuracy: 0.451111/11 [==============================] - 1s 103ms/step - loss: 0.2997 - accuracy: 0.4522
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2850 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.2828 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 0s - loss: 0.2812 - accuracy: 0.4805 4/11 [=========>....................] - ETA: 0s - loss: 0.2798 - accuracy: 0.4761 5/11 [============>.................] - ETA: 0s - loss: 0.2794 - accuracy: 0.4746 6/11 [===============>..............] - ETA: 0s - loss: 0.2795 - accuracy: 0.4725 7/11 [==================>...........] - ETA: 0s - loss: 0.2796 - accuracy: 0.4712 8/11 [====================>.........] - ETA: 0s - loss: 0.2800 - accuracy: 0.4702 9/11 [=======================>......] - ETA: 0s - loss: 0.2802 - accuracy: 0.469610/11 [==========================>...] - ETA: 0s - loss: 0.2801 - accuracy: 0.469511/11 [==============================] - ETA: 0s - loss: 0.2801 - accuracy: 0.469311/11 [==============================] - 1s 101ms/step - loss: 0.2800 - accuracy: 0.4691
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2870 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.2854 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.2833 - accuracy: 0.4601 4/11 [=========>....................] - ETA: 0s - loss: 0.2810 - accuracy: 0.4598 5/11 [============>.................] - ETA: 0s - loss: 0.2785 - accuracy: 0.4622 6/11 [===============>..............] - ETA: 0s - loss: 0.2766 - accuracy: 0.4637 7/11 [==================>...........] - ETA: 0s - loss: 0.2755 - accuracy: 0.4651 8/11 [====================>.........] - ETA: 0s - loss: 0.2746 - accuracy: 0.4664 9/11 [=======================>......] - ETA: 0s - loss: 0.2738 - accuracy: 0.467210/11 [==========================>...] - ETA: 0s - loss: 0.2730 - accuracy: 0.467511/11 [==============================] - ETA: 0s - loss: 0.2723 - accuracy: 0.467811/11 [==============================] - 1s 109ms/step - loss: 0.2717 - accuracy: 0.4680
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2349 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.2386 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 0s - loss: 0.2438 - accuracy: 0.4852 4/11 [=========>....................] - ETA: 0s - loss: 0.2463 - accuracy: 0.4806 5/11 [============>.................] - ETA: 0s - loss: 0.2475 - accuracy: 0.4779 6/11 [===============>..............] - ETA: 0s - loss: 0.2486 - accuracy: 0.4760 7/11 [==================>...........] - ETA: 0s - loss: 0.2493 - accuracy: 0.4748 8/11 [====================>.........] - ETA: 0s - loss: 0.2500 - accuracy: 0.4739 9/11 [=======================>......] - ETA: 0s - loss: 0.2503 - accuracy: 0.473710/11 [==========================>...] - ETA: 0s - loss: 0.2503 - accuracy: 0.474011/11 [==============================] - ETA: 0s - loss: 0.2504 - accuracy: 0.474111/11 [==============================] - 1s 113ms/step - loss: 0.2504 - accuracy: 0.4742
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2130 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.2263 - accuracy: 0.5273 3/11 [=======>......................] - ETA: 0s - loss: 0.2298 - accuracy: 0.5182 4/11 [=========>....................] - ETA: 0s - loss: 0.2312 - accuracy: 0.5103 5/11 [============>.................] - ETA: 0s - loss: 0.2322 - accuracy: 0.5063 6/11 [===============>..............] - ETA: 0s - loss: 0.2334 - accuracy: 0.5035 7/11 [==================>...........] - ETA: 0s - loss: 0.2344 - accuracy: 0.5006 8/11 [====================>.........] - ETA: 0s - loss: 0.2354 - accuracy: 0.4981 9/11 [=======================>......] - ETA: 0s - loss: 0.2360 - accuracy: 0.496010/11 [==========================>...] - ETA: 0s - loss: 0.2364 - accuracy: 0.494111/11 [==============================] - ETA: 0s - loss: 0.2363 - accuracy: 0.493111/11 [==============================] - 1s 109ms/step - loss: 0.2362 - accuracy: 0.4923
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2178 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.2126 - accuracy: 0.5020 3/11 [=======>......................] - ETA: 0s - loss: 0.2159 - accuracy: 0.4952 4/11 [=========>....................] - ETA: 0s - loss: 0.2177 - accuracy: 0.4925 5/11 [============>.................] - ETA: 0s - loss: 0.2181 - accuracy: 0.4934 6/11 [===============>..............] - ETA: 0s - loss: 0.2190 - accuracy: 0.4954 7/11 [==================>...........] - ETA: 0s - loss: 0.2198 - accuracy: 0.4959 8/11 [====================>.........] - ETA: 0s - loss: 0.2203 - accuracy: 0.4963 9/11 [=======================>......] - ETA: 0s - loss: 0.2205 - accuracy: 0.496110/11 [==========================>...] - ETA: 0s - loss: 0.2205 - accuracy: 0.496211/11 [==============================] - ETA: 0s - loss: 0.2205 - accuracy: 0.495811/11 [==============================] - 1s 103ms/step - loss: 0.2206 - accuracy: 0.4955
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2060 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.2067 - accuracy: 0.5488 3/11 [=======>......................] - ETA: 0s - loss: 0.2076 - accuracy: 0.5412 4/11 [=========>....................] - ETA: 0s - loss: 0.2091 - accuracy: 0.5339 5/11 [============>.................] - ETA: 0s - loss: 0.2087 - accuracy: 0.5302 6/11 [===============>..............] - ETA: 0s - loss: 0.2079 - accuracy: 0.5273 7/11 [==================>...........] - ETA: 0s - loss: 0.2077 - accuracy: 0.5254 8/11 [====================>.........] - ETA: 0s - loss: 0.2077 - accuracy: 0.5233 9/11 [=======================>......] - ETA: 0s - loss: 0.2076 - accuracy: 0.521310/11 [==========================>...] - ETA: 0s - loss: 0.2076 - accuracy: 0.519411/11 [==============================] - ETA: 0s - loss: 0.2076 - accuracy: 0.517611/11 [==============================] - 1s 109ms/step - loss: 0.2076 - accuracy: 0.5160
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1937 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.1918 - accuracy: 0.4805 3/11 [=======>......................] - ETA: 0s - loss: 0.1906 - accuracy: 0.4931 4/11 [=========>....................] - ETA: 0s - loss: 0.1903 - accuracy: 0.4958 5/11 [============>.................] - ETA: 0s - loss: 0.1902 - accuracy: 0.4979 6/11 [===============>..............] - ETA: 0s - loss: 0.1907 - accuracy: 0.4997 7/11 [==================>...........] - ETA: 0s - loss: 0.1914 - accuracy: 0.5012 8/11 [====================>.........] - ETA: 0s - loss: 0.1920 - accuracy: 0.5020 9/11 [=======================>......] - ETA: 0s - loss: 0.1924 - accuracy: 0.502810/11 [==========================>...] - ETA: 0s - loss: 0.1926 - accuracy: 0.503911/11 [==============================] - ETA: 0s - loss: 0.1929 - accuracy: 0.504711/11 [==============================] - 1s 108ms/step - loss: 0.1931 - accuracy: 0.5053
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1825 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.1837 - accuracy: 0.5254 3/11 [=======>......................] - ETA: 0s - loss: 0.1849 - accuracy: 0.5230 4/11 [=========>....................] - ETA: 0s - loss: 0.1854 - accuracy: 0.5221 5/11 [============>.................] - ETA: 0s - loss: 0.1853 - accuracy: 0.5205 6/11 [===============>..............] - ETA: 0s - loss: 0.1851 - accuracy: 0.5188 7/11 [==================>...........] - ETA: 0s - loss: 0.1848 - accuracy: 0.5185 8/11 [====================>.........] - ETA: 0s - loss: 0.1843 - accuracy: 0.5187 9/11 [=======================>......] - ETA: 0s - loss: 0.1841 - accuracy: 0.518810/11 [==========================>...] - ETA: 0s - loss: 0.1843 - accuracy: 0.519011/11 [==============================] - ETA: 0s - loss: 0.1843 - accuracy: 0.518711/11 [==============================] - 1s 110ms/step - loss: 0.1843 - accuracy: 0.5185
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1694 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.1741 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.1763 - accuracy: 0.5599 4/11 [=========>....................] - ETA: 0s - loss: 0.1763 - accuracy: 0.5547 5/11 [============>.................] - ETA: 0s - loss: 0.1767 - accuracy: 0.5500 6/11 [===============>..............] - ETA: 0s - loss: 0.1771 - accuracy: 0.5460 7/11 [==================>...........] - ETA: 0s - loss: 0.1770 - accuracy: 0.5437 8/11 [====================>.........] - ETA: 0s - loss: 0.1769 - accuracy: 0.5430 9/11 [=======================>......] - ETA: 0s - loss: 0.1770 - accuracy: 0.541810/11 [==========================>...] - ETA: 0s - loss: 0.1767 - accuracy: 0.541411/11 [==============================] - ETA: 0s - loss: 0.1765 - accuracy: 0.540511/11 [==============================] - 1s 105ms/step - loss: 0.1764 - accuracy: 0.5399
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1390 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.1599 - accuracy: 0.5176 3/11 [=======>......................] - ETA: 0s - loss: 0.1622 - accuracy: 0.5091 4/11 [=========>....................] - ETA: 0s - loss: 0.1640 - accuracy: 0.5098 5/11 [============>.................] - ETA: 0s - loss: 0.1655 - accuracy: 0.5097 6/11 [===============>..............] - ETA: 0s - loss: 0.1664 - accuracy: 0.5098 7/11 [==================>...........] - ETA: 0s - loss: 0.1666 - accuracy: 0.5126 8/11 [====================>.........] - ETA: 0s - loss: 0.1664 - accuracy: 0.5162 9/11 [=======================>......] - ETA: 0s - loss: 0.1660 - accuracy: 0.519810/11 [==========================>...] - ETA: 0s - loss: 0.1660 - accuracy: 0.522411/11 [==============================] - ETA: 0s - loss: 0.1660 - accuracy: 0.524311/11 [==============================] - 1s 108ms/step - loss: 0.1660 - accuracy: 0.5260
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1418 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 0s - loss: 0.1408 - accuracy: 0.5762 3/11 [=======>......................] - ETA: 0s - loss: 0.1435 - accuracy: 0.5760 4/11 [=========>....................] - ETA: 0s - loss: 0.1452 - accuracy: 0.5765 5/11 [============>.................] - ETA: 0s - loss: 0.1469 - accuracy: 0.5803 6/11 [===============>..............] - ETA: 0s - loss: 0.1479 - accuracy: 0.5834 7/11 [==================>...........] - ETA: 0s - loss: 0.1490 - accuracy: 0.5844 8/11 [====================>.........] - ETA: 0s - loss: 0.1497 - accuracy: 0.5857 9/11 [=======================>......] - ETA: 0s - loss: 0.1506 - accuracy: 0.586910/11 [==========================>...] - ETA: 0s - loss: 0.1513 - accuracy: 0.587911/11 [==============================] - ETA: 0s - loss: 0.1519 - accuracy: 0.588811/11 [==============================] - 1s 108ms/step - loss: 0.1525 - accuracy: 0.5897
Evaluate on test data
1/6 [====>.........................] - ETA: 17s - loss: 0.1433 - accuracy: 0.67193/6 [==============>...............] - ETA: 0s - loss: 0.1609 - accuracy: 0.6068 5/6 [========================>.....] - ETA: 0s - loss: 0.1563 - accuracy: 0.62036/6 [==============================] - 4s 32ms/step - loss: 0.1584 - accuracy: 0.6190
2021-12-13 23:48:45.902287: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:48:45.903103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:48:45.903153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:48:45.903195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:48:45.903221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:48:45.903262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:48:45.903288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:48:45.903323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:48:45.903349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:48:45.903375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:48:45.904520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:48:45.904548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:48:45.904557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:48:45.904565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 1 3 4] pred: [-0.13759823 -0.35769176  0.98188686 -0.41224492 -0.7418872 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [-0.1558292  -0.13684876  0.97619975 -0.44170174 -0.7518882 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [-0.00237822  0.53004724  0.5284982  -0.01340732 -0.23327555]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [-0.05883633  0.76392514  0.8898182  -0.38074043 -0.5893646 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [-0.06106533  0.60879177  0.9644159  -0.5198422  -0.72800815]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 0 3 1 4] pred: [-0.13712643 -0.26948357  0.96356887 -0.24770543 -0.6007994 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [-0.07504467  0.9392386   0.92866385 -0.5156104  -0.8032526 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [-0.10996778 -0.0279264   0.9880085  -0.64526814 -0.7913732 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 0 1 3 4] pred: [-0.3024248  -0.6085229   0.9984909  -0.81290954 -0.91456735]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [-0.12849307  0.2748257   0.9130079  -0.14787804 -0.5410331 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 0 4 1] pred: [-0.10217448 -0.3578031   0.81573826  0.13945821 -0.25098562]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [ 0.03121077  0.84401214  0.8738187  -0.44212934 -0.64984435]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [-0.05333812  0.64548653  0.74444324 -0.22713907 -0.3829267 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 0 3 1 4] pred: [-0.15885477 -0.5569848   0.981983   -0.3397096  -0.7223633 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [ 0.05108286  0.3435727   0.42422953 -0.13136922 -0.04072993]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:57 - loss: 2.4563 - accuracy: 0.2266 2/11 [====>.........................] - ETA: 0s - loss: 2.3271 - accuracy: 0.2754   3/11 [=======>......................] - ETA: 0s - loss: 2.2373 - accuracy: 0.3034 4/11 [=========>....................] - ETA: 0s - loss: 2.1394 - accuracy: 0.3198 5/11 [============>.................] - ETA: 0s - loss: 2.0441 - accuracy: 0.3324 6/11 [===============>..............] - ETA: 0s - loss: 1.9573 - accuracy: 0.3421 7/11 [==================>...........] - ETA: 0s - loss: 1.8824 - accuracy: 0.3522 8/11 [====================>.........] - ETA: 0s - loss: 1.8157 - accuracy: 0.3600 9/11 [=======================>......] - ETA: 0s - loss: 1.7565 - accuracy: 0.367610/11 [==========================>...] - ETA: 0s - loss: 1.7032 - accuracy: 0.374211/11 [==============================] - ETA: 0s - loss: 1.6564 - accuracy: 0.379911/11 [==============================] - 13s 105ms/step - loss: 1.6174 - accuracy: 0.3846
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5875 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.5820 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.5799 - accuracy: 0.5538 4/11 [=========>....................] - ETA: 0s - loss: 0.5775 - accuracy: 0.5565 5/11 [============>.................] - ETA: 0s - loss: 0.5748 - accuracy: 0.5596 6/11 [===============>..............] - ETA: 0s - loss: 0.5718 - accuracy: 0.5631 7/11 [==================>...........] - ETA: 0s - loss: 0.5693 - accuracy: 0.5668 8/11 [====================>.........] - ETA: 0s - loss: 0.5667 - accuracy: 0.5706 9/11 [=======================>......] - ETA: 0s - loss: 0.5643 - accuracy: 0.573110/11 [==========================>...] - ETA: 0s - loss: 0.5623 - accuracy: 0.576011/11 [==============================] - ETA: 0s - loss: 0.5603 - accuracy: 0.578511/11 [==============================] - 1s 103ms/step - loss: 0.5586 - accuracy: 0.5806
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4899 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.4876 - accuracy: 0.6074 3/11 [=======>......................] - ETA: 0s - loss: 0.4862 - accuracy: 0.6072 4/11 [=========>....................] - ETA: 0s - loss: 0.4846 - accuracy: 0.6014 5/11 [============>.................] - ETA: 0s - loss: 0.4833 - accuracy: 0.5961 6/11 [===============>..............] - ETA: 0s - loss: 0.4822 - accuracy: 0.5896 7/11 [==================>...........] - ETA: 0s - loss: 0.4810 - accuracy: 0.5843 8/11 [====================>.........] - ETA: 0s - loss: 0.4797 - accuracy: 0.5795 9/11 [=======================>......] - ETA: 0s - loss: 0.4785 - accuracy: 0.574110/11 [==========================>...] - ETA: 0s - loss: 0.4771 - accuracy: 0.569211/11 [==============================] - ETA: 0s - loss: 0.4757 - accuracy: 0.564911/11 [==============================] - 1s 104ms/step - loss: 0.4745 - accuracy: 0.5614
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4274 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.4282 - accuracy: 0.4434 3/11 [=======>......................] - ETA: 0s - loss: 0.4260 - accuracy: 0.4484 4/11 [=========>....................] - ETA: 0s - loss: 0.4245 - accuracy: 0.4544 5/11 [============>.................] - ETA: 0s - loss: 0.4235 - accuracy: 0.4582 6/11 [===============>..............] - ETA: 0s - loss: 0.4227 - accuracy: 0.4589 7/11 [==================>...........] - ETA: 0s - loss: 0.4214 - accuracy: 0.4614 8/11 [====================>.........] - ETA: 0s - loss: 0.4205 - accuracy: 0.4617 9/11 [=======================>......] - ETA: 0s - loss: 0.4197 - accuracy: 0.461610/11 [==========================>...] - ETA: 0s - loss: 0.4185 - accuracy: 0.461611/11 [==============================] - ETA: 0s - loss: 0.4176 - accuracy: 0.461311/11 [==============================] - 1s 104ms/step - loss: 0.4167 - accuracy: 0.4611
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3730 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.3774 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.3774 - accuracy: 0.4332 4/11 [=========>....................] - ETA: 0s - loss: 0.3767 - accuracy: 0.4367 5/11 [============>.................] - ETA: 0s - loss: 0.3754 - accuracy: 0.4390 6/11 [===============>..............] - ETA: 0s - loss: 0.3741 - accuracy: 0.4412 7/11 [==================>...........] - ETA: 0s - loss: 0.3731 - accuracy: 0.4419 8/11 [====================>.........] - ETA: 0s - loss: 0.3722 - accuracy: 0.4427 9/11 [=======================>......] - ETA: 0s - loss: 0.3715 - accuracy: 0.443410/11 [==========================>...] - ETA: 0s - loss: 0.3709 - accuracy: 0.444011/11 [==============================] - ETA: 0s - loss: 0.3701 - accuracy: 0.445111/11 [==============================] - 1s 108ms/step - loss: 0.3694 - accuracy: 0.4460
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3168 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.3215 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.3242 - accuracy: 0.4931 4/11 [=========>....................] - ETA: 0s - loss: 0.3247 - accuracy: 0.4909 5/11 [============>.................] - ETA: 0s - loss: 0.3261 - accuracy: 0.4861 6/11 [===============>..............] - ETA: 0s - loss: 0.3267 - accuracy: 0.4811 7/11 [==================>...........] - ETA: 0s - loss: 0.3272 - accuracy: 0.4772 8/11 [====================>.........] - ETA: 0s - loss: 0.3272 - accuracy: 0.4741 9/11 [=======================>......] - ETA: 0s - loss: 0.3271 - accuracy: 0.471910/11 [==========================>...] - ETA: 0s - loss: 0.3267 - accuracy: 0.470811/11 [==============================] - ETA: 0s - loss: 0.3265 - accuracy: 0.469411/11 [==============================] - 1s 110ms/step - loss: 0.3264 - accuracy: 0.4683
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2877 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.2997 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.3016 - accuracy: 0.4583 4/11 [=========>....................] - ETA: 0s - loss: 0.3013 - accuracy: 0.4585 5/11 [============>.................] - ETA: 0s - loss: 0.3007 - accuracy: 0.4577 6/11 [===============>..............] - ETA: 0s - loss: 0.3011 - accuracy: 0.4578 7/11 [==================>...........] - ETA: 0s - loss: 0.3017 - accuracy: 0.4570 8/11 [====================>.........] - ETA: 0s - loss: 0.3025 - accuracy: 0.4560 9/11 [=======================>......] - ETA: 0s - loss: 0.3028 - accuracy: 0.454910/11 [==========================>...] - ETA: 0s - loss: 0.3029 - accuracy: 0.454411/11 [==============================] - ETA: 0s - loss: 0.3027 - accuracy: 0.454611/11 [==============================] - 1s 114ms/step - loss: 0.3025 - accuracy: 0.4547
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2546 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.2670 - accuracy: 0.4395 3/11 [=======>......................] - ETA: 0s - loss: 0.2680 - accuracy: 0.4388 4/11 [=========>....................] - ETA: 0s - loss: 0.2681 - accuracy: 0.4424 5/11 [============>.................] - ETA: 0s - loss: 0.2700 - accuracy: 0.4455 6/11 [===============>..............] - ETA: 0s - loss: 0.2712 - accuracy: 0.4465 7/11 [==================>...........] - ETA: 0s - loss: 0.2725 - accuracy: 0.4476 8/11 [====================>.........] - ETA: 0s - loss: 0.2728 - accuracy: 0.4489 9/11 [=======================>......] - ETA: 0s - loss: 0.2733 - accuracy: 0.449610/11 [==========================>...] - ETA: 0s - loss: 0.2735 - accuracy: 0.450311/11 [==============================] - ETA: 0s - loss: 0.2737 - accuracy: 0.450911/11 [==============================] - 1s 107ms/step - loss: 0.2739 - accuracy: 0.4513
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2575 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.2629 - accuracy: 0.4883 3/11 [=======>......................] - ETA: 0s - loss: 0.2669 - accuracy: 0.4792 4/11 [=========>....................] - ETA: 0s - loss: 0.2663 - accuracy: 0.4785 5/11 [============>.................] - ETA: 0s - loss: 0.2667 - accuracy: 0.4759 6/11 [===============>..............] - ETA: 0s - loss: 0.2666 - accuracy: 0.4726 7/11 [==================>...........] - ETA: 0s - loss: 0.2661 - accuracy: 0.4703 8/11 [====================>.........] - ETA: 0s - loss: 0.2658 - accuracy: 0.4681 9/11 [=======================>......] - ETA: 0s - loss: 0.2659 - accuracy: 0.466810/11 [==========================>...] - ETA: 0s - loss: 0.2654 - accuracy: 0.466111/11 [==============================] - ETA: 0s - loss: 0.2648 - accuracy: 0.465511/11 [==============================] - 1s 107ms/step - loss: 0.2643 - accuracy: 0.4649
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2686 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.2607 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.2581 - accuracy: 0.4583 4/11 [=========>....................] - ETA: 0s - loss: 0.2543 - accuracy: 0.4604 5/11 [============>.................] - ETA: 0s - loss: 0.2521 - accuracy: 0.4621 6/11 [===============>..............] - ETA: 0s - loss: 0.2502 - accuracy: 0.4628 7/11 [==================>...........] - ETA: 0s - loss: 0.2494 - accuracy: 0.4635 8/11 [====================>.........] - ETA: 0s - loss: 0.2489 - accuracy: 0.4634 9/11 [=======================>......] - ETA: 0s - loss: 0.2488 - accuracy: 0.462510/11 [==========================>...] - ETA: 0s - loss: 0.2485 - accuracy: 0.462411/11 [==============================] - ETA: 0s - loss: 0.2480 - accuracy: 0.462611/11 [==============================] - 1s 105ms/step - loss: 0.2477 - accuracy: 0.4628
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2355 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.2335 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 0s - loss: 0.2345 - accuracy: 0.4774 4/11 [=========>....................] - ETA: 0s - loss: 0.2330 - accuracy: 0.4782 5/11 [============>.................] - ETA: 0s - loss: 0.2337 - accuracy: 0.4738 6/11 [===============>..............] - ETA: 0s - loss: 0.2337 - accuracy: 0.4708 7/11 [==================>...........] - ETA: 0s - loss: 0.2340 - accuracy: 0.4684 8/11 [====================>.........] - ETA: 0s - loss: 0.2340 - accuracy: 0.4679 9/11 [=======================>......] - ETA: 0s - loss: 0.2339 - accuracy: 0.467710/11 [==========================>...] - ETA: 0s - loss: 0.2334 - accuracy: 0.467511/11 [==============================] - ETA: 0s - loss: 0.2331 - accuracy: 0.467411/11 [==============================] - 1s 105ms/step - loss: 0.2328 - accuracy: 0.4673
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2468 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.2433 - accuracy: 0.4863 3/11 [=======>......................] - ETA: 0s - loss: 0.2409 - accuracy: 0.4831 4/11 [=========>....................] - ETA: 0s - loss: 0.2383 - accuracy: 0.4761 5/11 [============>.................] - ETA: 0s - loss: 0.2358 - accuracy: 0.4718 6/11 [===============>..............] - ETA: 0s - loss: 0.2340 - accuracy: 0.4687 7/11 [==================>...........] - ETA: 0s - loss: 0.2323 - accuracy: 0.4668 8/11 [====================>.........] - ETA: 0s - loss: 0.2310 - accuracy: 0.4658 9/11 [=======================>......] - ETA: 0s - loss: 0.2297 - accuracy: 0.466210/11 [==========================>...] - ETA: 0s - loss: 0.2286 - accuracy: 0.466711/11 [==============================] - ETA: 0s - loss: 0.2275 - accuracy: 0.467011/11 [==============================] - 1s 108ms/step - loss: 0.2267 - accuracy: 0.4673
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1726 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.1838 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 0s - loss: 0.1901 - accuracy: 0.4891 4/11 [=========>....................] - ETA: 0s - loss: 0.1936 - accuracy: 0.4875 5/11 [============>.................] - ETA: 0s - loss: 0.1961 - accuracy: 0.4828 6/11 [===============>..............] - ETA: 0s - loss: 0.1992 - accuracy: 0.4783 7/11 [==================>...........] - ETA: 0s - loss: 0.2009 - accuracy: 0.4761 8/11 [====================>.........] - ETA: 0s - loss: 0.2020 - accuracy: 0.4757 9/11 [=======================>......] - ETA: 0s - loss: 0.2028 - accuracy: 0.475510/11 [==========================>...] - ETA: 0s - loss: 0.2032 - accuracy: 0.476411/11 [==============================] - ETA: 0s - loss: 0.2035 - accuracy: 0.476711/11 [==============================] - 1s 111ms/step - loss: 0.2038 - accuracy: 0.4770
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2177 - accuracy: 0.3828 2/11 [====>.........................] - ETA: 0s - loss: 0.2212 - accuracy: 0.4043 3/11 [=======>......................] - ETA: 0s - loss: 0.2198 - accuracy: 0.4214 4/11 [=========>....................] - ETA: 0s - loss: 0.2182 - accuracy: 0.4338 5/11 [============>.................] - ETA: 0s - loss: 0.2160 - accuracy: 0.4420 6/11 [===============>..............] - ETA: 0s - loss: 0.2146 - accuracy: 0.4475 7/11 [==================>...........] - ETA: 0s - loss: 0.2137 - accuracy: 0.4511 8/11 [====================>.........] - ETA: 0s - loss: 0.2126 - accuracy: 0.4541 9/11 [=======================>......] - ETA: 0s - loss: 0.2115 - accuracy: 0.457210/11 [==========================>...] - ETA: 0s - loss: 0.2104 - accuracy: 0.460111/11 [==============================] - ETA: 0s - loss: 0.2093 - accuracy: 0.462811/11 [==============================] - 1s 108ms/step - loss: 0.2084 - accuracy: 0.4650
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1869 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.1903 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.1879 - accuracy: 0.4826 4/11 [=========>....................] - ETA: 0s - loss: 0.1884 - accuracy: 0.4909 5/11 [============>.................] - ETA: 0s - loss: 0.1887 - accuracy: 0.4955 6/11 [===============>..............] - ETA: 0s - loss: 0.1889 - accuracy: 0.4978 7/11 [==================>...........] - ETA: 0s - loss: 0.1892 - accuracy: 0.4994 8/11 [====================>.........] - ETA: 0s - loss: 0.1898 - accuracy: 0.4999 9/11 [=======================>......] - ETA: 0s - loss: 0.1901 - accuracy: 0.500510/11 [==========================>...] - ETA: 0s - loss: 0.1900 - accuracy: 0.502211/11 [==============================] - ETA: 0s - loss: 0.1898 - accuracy: 0.503911/11 [==============================] - 1s 106ms/step - loss: 0.1897 - accuracy: 0.5054
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1508 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 0s - loss: 0.1595 - accuracy: 0.5762 3/11 [=======>......................] - ETA: 0s - loss: 0.1621 - accuracy: 0.5690 4/11 [=========>....................] - ETA: 0s - loss: 0.1645 - accuracy: 0.5674 5/11 [============>.................] - ETA: 0s - loss: 0.1663 - accuracy: 0.5636 6/11 [===============>..............] - ETA: 0s - loss: 0.1679 - accuracy: 0.5602 7/11 [==================>...........] - ETA: 0s - loss: 0.1693 - accuracy: 0.5579 8/11 [====================>.........] - ETA: 0s - loss: 0.1703 - accuracy: 0.5563 9/11 [=======================>......] - ETA: 0s - loss: 0.1713 - accuracy: 0.555110/11 [==========================>...] - ETA: 0s - loss: 0.1722 - accuracy: 0.553611/11 [==============================] - ETA: 0s - loss: 0.1730 - accuracy: 0.552311/11 [==============================] - 1s 109ms/step - loss: 0.1736 - accuracy: 0.5511
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2122 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.2055 - accuracy: 0.5098 3/11 [=======>......................] - ETA: 0s - loss: 0.1983 - accuracy: 0.5204 4/11 [=========>....................] - ETA: 0s - loss: 0.1929 - accuracy: 0.5260 5/11 [============>.................] - ETA: 0s - loss: 0.1887 - accuracy: 0.5318 6/11 [===============>..............] - ETA: 0s - loss: 0.1855 - accuracy: 0.5362 7/11 [==================>...........] - ETA: 0s - loss: 0.1833 - accuracy: 0.5402 8/11 [====================>.........] - ETA: 0s - loss: 0.1823 - accuracy: 0.5421 9/11 [=======================>......] - ETA: 0s - loss: 0.1816 - accuracy: 0.543010/11 [==========================>...] - ETA: 0s - loss: 0.1808 - accuracy: 0.544011/11 [==============================] - ETA: 0s - loss: 0.1802 - accuracy: 0.545411/11 [==============================] - 1s 103ms/step - loss: 0.1797 - accuracy: 0.5466
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1794 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.1727 - accuracy: 0.5488 3/11 [=======>......................] - ETA: 0s - loss: 0.1731 - accuracy: 0.5621 4/11 [=========>....................] - ETA: 0s - loss: 0.1717 - accuracy: 0.5675 5/11 [============>.................] - ETA: 0s - loss: 0.1706 - accuracy: 0.5731 6/11 [===============>..............] - ETA: 0s - loss: 0.1692 - accuracy: 0.5770 7/11 [==================>...........] - ETA: 0s - loss: 0.1681 - accuracy: 0.5798 8/11 [====================>.........] - ETA: 0s - loss: 0.1676 - accuracy: 0.5835 9/11 [=======================>......] - ETA: 0s - loss: 0.1675 - accuracy: 0.586310/11 [==========================>...] - ETA: 0s - loss: 0.1673 - accuracy: 0.588011/11 [==============================] - ETA: 0s - loss: 0.1673 - accuracy: 0.589511/11 [==============================] - 1s 106ms/step - loss: 0.1673 - accuracy: 0.5908
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1726 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 1s - loss: 0.1651 - accuracy: 0.6660 3/11 [=======>......................] - ETA: 0s - loss: 0.1617 - accuracy: 0.6567 4/11 [=========>....................] - ETA: 0s - loss: 0.1618 - accuracy: 0.6473 5/11 [============>.................] - ETA: 0s - loss: 0.1620 - accuracy: 0.6407 6/11 [===============>..............] - ETA: 0s - loss: 0.1616 - accuracy: 0.6376 7/11 [==================>...........] - ETA: 0s - loss: 0.1621 - accuracy: 0.6366 8/11 [====================>.........] - ETA: 0s - loss: 0.1622 - accuracy: 0.6374 9/11 [=======================>......] - ETA: 0s - loss: 0.1619 - accuracy: 0.639310/11 [==========================>...] - ETA: 0s - loss: 0.1618 - accuracy: 0.641111/11 [==============================] - ETA: 0s - loss: 0.1618 - accuracy: 0.642411/11 [==============================] - 1s 109ms/step - loss: 0.1618 - accuracy: 0.6434
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1733 - accuracy: 0.7422 2/11 [====>.........................] - ETA: 0s - loss: 0.1674 - accuracy: 0.7266 3/11 [=======>......................] - ETA: 0s - loss: 0.1653 - accuracy: 0.7196 4/11 [=========>....................] - ETA: 0s - loss: 0.1645 - accuracy: 0.7106 5/11 [============>.................] - ETA: 0s - loss: 0.1641 - accuracy: 0.7032 6/11 [===============>..............] - ETA: 0s - loss: 0.1641 - accuracy: 0.6947 7/11 [==================>...........] - ETA: 0s - loss: 0.1638 - accuracy: 0.6884 8/11 [====================>.........] - ETA: 0s - loss: 0.1632 - accuracy: 0.6832 9/11 [=======================>......] - ETA: 0s - loss: 0.1626 - accuracy: 0.679410/11 [==========================>...] - ETA: 0s - loss: 0.1621 - accuracy: 0.675811/11 [==============================] - ETA: 0s - loss: 0.1615 - accuracy: 0.673211/11 [==============================] - 1s 108ms/step - loss: 0.1610 - accuracy: 0.6710
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.1595 - accuracy: 0.67193/6 [==============>...............] - ETA: 0s - loss: 0.1633 - accuracy: 0.6693 5/6 [========================>.....] - ETA: 0s - loss: 0.1586 - accuracy: 0.67666/6 [==============================] - 4s 33ms/step - loss: 0.1636 - accuracy: 0.6771
2021-12-13 23:49:34.262900: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:49:34.263989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:49:34.264041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:49:34.264093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:49:34.264120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:49:34.264147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:49:34.264173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:49:34.264199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:49:34.264233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:49:34.264262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:49:34.265438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:49:34.265466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:49:34.265475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:49:34.265483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [-0.02075774  0.76989543  0.7566768  -0.27607834 -0.36196852]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [-0.1400625   0.7749263   0.843314   -0.29335225 -0.45420069]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 0 2 1] pred: [-0.14117898 -0.66261894 -0.30764335  0.65143794  0.35458475]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [-0.03953971  0.59733176  0.67474335 -0.10366132 -0.28127798]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [4 3 0 2 1] pred: [ 0.00748174 -0.3511551  -0.08562966  0.307742    0.38304454]
 Top predictions indices: [4 3] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 4 3] pred: [-0.00473497  0.9479663   0.8063497  -0.6358184  -0.425135  ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 2 4 0 1] pred: [-0.2531355  -0.46693382  0.52760553  0.53935593 -0.0812359 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 3 0 1] pred: [-0.38130403 -0.8920214   0.9845994  -0.2815835  -0.2781565 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 3 4] pred: [-0.2369349   0.31817073  0.9402239  -0.30186465 -0.45065612]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 4 3] pred: [-0.0028414   0.84920925  0.7456138  -0.41790277 -0.34358513]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 4 0 3 1] pred: [-0.3344854  -0.9419499   0.9916569  -0.39222518 -0.24517873]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 4 3] pred: [ 0.00254102  0.8720062   0.75812495 -0.45580745 -0.34662318]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 0 4 1] pred: [-0.35991982 -0.8508525   0.99180853 -0.3257745  -0.44744346]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 4 0 3 1] pred: [-0.34767538 -0.9324218   0.99196035 -0.39658448 -0.27011663]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [-0.5486887   0.94710755  0.97526085 -0.8456065  -0.66800326]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:57 - loss: 1.5664 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 1.4511 - accuracy: 0.4082   3/11 [=======>......................] - ETA: 0s - loss: 1.3681 - accuracy: 0.4301 4/11 [=========>....................] - ETA: 0s - loss: 1.3102 - accuracy: 0.4373 5/11 [============>.................] - ETA: 0s - loss: 1.2614 - accuracy: 0.4405 6/11 [===============>..............] - ETA: 0s - loss: 1.2179 - accuracy: 0.4446 7/11 [==================>...........] - ETA: 0s - loss: 1.1799 - accuracy: 0.4458 8/11 [====================>.........] - ETA: 0s - loss: 1.1461 - accuracy: 0.4473 9/11 [=======================>......] - ETA: 0s - loss: 1.1162 - accuracy: 0.448410/11 [==========================>...] - ETA: 0s - loss: 1.0892 - accuracy: 0.449411/11 [==============================] - ETA: 0s - loss: 1.0653 - accuracy: 0.450511/11 [==============================] - 13s 104ms/step - loss: 1.0454 - accuracy: 0.4515
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5631 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.5535 - accuracy: 0.4590 3/11 [=======>......................] - ETA: 0s - loss: 0.5501 - accuracy: 0.4544 4/11 [=========>....................] - ETA: 0s - loss: 0.5450 - accuracy: 0.4536 5/11 [============>.................] - ETA: 0s - loss: 0.5397 - accuracy: 0.4548 6/11 [===============>..............] - ETA: 0s - loss: 0.5354 - accuracy: 0.4532 7/11 [==================>...........] - ETA: 0s - loss: 0.5310 - accuracy: 0.4537 8/11 [====================>.........] - ETA: 0s - loss: 0.5266 - accuracy: 0.4547 9/11 [=======================>......] - ETA: 0s - loss: 0.5225 - accuracy: 0.455610/11 [==========================>...] - ETA: 0s - loss: 0.5185 - accuracy: 0.456311/11 [==============================] - ETA: 0s - loss: 0.5148 - accuracy: 0.457311/11 [==============================] - 1s 107ms/step - loss: 0.5117 - accuracy: 0.4580
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4110 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.4074 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 0s - loss: 0.4053 - accuracy: 0.4761 4/11 [=========>....................] - ETA: 0s - loss: 0.4045 - accuracy: 0.4738 5/11 [============>.................] - ETA: 0s - loss: 0.4031 - accuracy: 0.4722 6/11 [===============>..............] - ETA: 0s - loss: 0.4017 - accuracy: 0.4701 7/11 [==================>...........] - ETA: 0s - loss: 0.3999 - accuracy: 0.4688 8/11 [====================>.........] - ETA: 0s - loss: 0.3983 - accuracy: 0.4679 9/11 [=======================>......] - ETA: 0s - loss: 0.3963 - accuracy: 0.467110/11 [==========================>...] - ETA: 0s - loss: 0.3945 - accuracy: 0.467111/11 [==============================] - ETA: 0s - loss: 0.3926 - accuracy: 0.467111/11 [==============================] - 1s 106ms/step - loss: 0.3910 - accuracy: 0.4670
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3479 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.3444 - accuracy: 0.4473 3/11 [=======>......................] - ETA: 0s - loss: 0.3439 - accuracy: 0.4405 4/11 [=========>....................] - ETA: 0s - loss: 0.3418 - accuracy: 0.4422 5/11 [============>.................] - ETA: 0s - loss: 0.3390 - accuracy: 0.4466 6/11 [===============>..............] - ETA: 0s - loss: 0.3369 - accuracy: 0.4477 7/11 [==================>...........] - ETA: 0s - loss: 0.3351 - accuracy: 0.4488 8/11 [====================>.........] - ETA: 0s - loss: 0.3337 - accuracy: 0.4505 9/11 [=======================>......] - ETA: 0s - loss: 0.3325 - accuracy: 0.452410/11 [==========================>...] - ETA: 0s - loss: 0.3314 - accuracy: 0.453911/11 [==============================] - ETA: 0s - loss: 0.3305 - accuracy: 0.454911/11 [==============================] - 1s 107ms/step - loss: 0.3298 - accuracy: 0.4558
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3156 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.3153 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3123 - accuracy: 0.4592 4/11 [=========>....................] - ETA: 0s - loss: 0.3098 - accuracy: 0.4631 5/11 [============>.................] - ETA: 0s - loss: 0.3076 - accuracy: 0.4661 6/11 [===============>..............] - ETA: 0s - loss: 0.3058 - accuracy: 0.4678 7/11 [==================>...........] - ETA: 0s - loss: 0.3045 - accuracy: 0.4684 8/11 [====================>.........] - ETA: 0s - loss: 0.3036 - accuracy: 0.4676 9/11 [=======================>......] - ETA: 0s - loss: 0.3029 - accuracy: 0.466710/11 [==========================>...] - ETA: 0s - loss: 0.3021 - accuracy: 0.466411/11 [==============================] - ETA: 0s - loss: 0.3014 - accuracy: 0.466511/11 [==============================] - 1s 108ms/step - loss: 0.3008 - accuracy: 0.4665
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2826 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.2788 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.2773 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.2772 - accuracy: 0.4604 5/11 [============>.................] - ETA: 0s - loss: 0.2762 - accuracy: 0.4605 6/11 [===============>..............] - ETA: 0s - loss: 0.2753 - accuracy: 0.4617 7/11 [==================>...........] - ETA: 0s - loss: 0.2745 - accuracy: 0.4629 8/11 [====================>.........] - ETA: 0s - loss: 0.2741 - accuracy: 0.4638 9/11 [=======================>......] - ETA: 0s - loss: 0.2738 - accuracy: 0.464110/11 [==========================>...] - ETA: 0s - loss: 0.2737 - accuracy: 0.464411/11 [==============================] - ETA: 0s - loss: 0.2733 - accuracy: 0.465111/11 [==============================] - 1s 115ms/step - loss: 0.2730 - accuracy: 0.4657
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2740 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 1s - loss: 0.2742 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.2710 - accuracy: 0.4340 4/11 [=========>....................] - ETA: 0s - loss: 0.2678 - accuracy: 0.4442 5/11 [============>.................] - ETA: 0s - loss: 0.2668 - accuracy: 0.4472 6/11 [===============>..............] - ETA: 0s - loss: 0.2644 - accuracy: 0.4512 7/11 [==================>...........] - ETA: 0s - loss: 0.2622 - accuracy: 0.4550 8/11 [====================>.........] - ETA: 0s - loss: 0.2604 - accuracy: 0.4583 9/11 [=======================>......] - ETA: 0s - loss: 0.2593 - accuracy: 0.460210/11 [==========================>...] - ETA: 0s - loss: 0.2580 - accuracy: 0.462111/11 [==============================] - ETA: 0s - loss: 0.2569 - accuracy: 0.463611/11 [==============================] - 1s 115ms/step - loss: 0.2560 - accuracy: 0.4648
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2251 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.2242 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.2229 - accuracy: 0.5139 4/11 [=========>....................] - ETA: 0s - loss: 0.2229 - accuracy: 0.5143 5/11 [============>.................] - ETA: 0s - loss: 0.2222 - accuracy: 0.5143 6/11 [===============>..............] - ETA: 0s - loss: 0.2220 - accuracy: 0.5132 7/11 [==================>...........] - ETA: 0s - loss: 0.2218 - accuracy: 0.5127 8/11 [====================>.........] - ETA: 0s - loss: 0.2219 - accuracy: 0.5121 9/11 [=======================>......] - ETA: 0s - loss: 0.2221 - accuracy: 0.511610/11 [==========================>...] - ETA: 0s - loss: 0.2224 - accuracy: 0.510211/11 [==============================] - ETA: 0s - loss: 0.2226 - accuracy: 0.508611/11 [==============================] - 1s 111ms/step - loss: 0.2228 - accuracy: 0.5073
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2120 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.2187 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 0s - loss: 0.2176 - accuracy: 0.4991 4/11 [=========>....................] - ETA: 0s - loss: 0.2171 - accuracy: 0.4974 5/11 [============>.................] - ETA: 0s - loss: 0.2162 - accuracy: 0.4973 6/11 [===============>..............] - ETA: 0s - loss: 0.2152 - accuracy: 0.4975 7/11 [==================>...........] - ETA: 0s - loss: 0.2140 - accuracy: 0.4982 8/11 [====================>.........] - ETA: 0s - loss: 0.2133 - accuracy: 0.4989 9/11 [=======================>......] - ETA: 0s - loss: 0.2127 - accuracy: 0.499210/11 [==========================>...] - ETA: 0s - loss: 0.2122 - accuracy: 0.499211/11 [==============================] - ETA: 0s - loss: 0.2117 - accuracy: 0.499411/11 [==============================] - 1s 120ms/step - loss: 0.2112 - accuracy: 0.4996
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1901 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.1946 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 0s - loss: 0.1992 - accuracy: 0.4965 4/11 [=========>....................] - ETA: 0s - loss: 0.1978 - accuracy: 0.4989 5/11 [============>.................] - ETA: 0s - loss: 0.1958 - accuracy: 0.5007 6/11 [===============>..............] - ETA: 0s - loss: 0.1943 - accuracy: 0.5014 7/11 [==================>...........] - ETA: 0s - loss: 0.1936 - accuracy: 0.5031 8/11 [====================>.........] - ETA: 0s - loss: 0.1933 - accuracy: 0.5037 9/11 [=======================>......] - ETA: 0s - loss: 0.1931 - accuracy: 0.504510/11 [==========================>...] - ETA: 0s - loss: 0.1930 - accuracy: 0.505311/11 [==============================] - ETA: 0s - loss: 0.1928 - accuracy: 0.506211/11 [==============================] - 1s 111ms/step - loss: 0.1926 - accuracy: 0.5069
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1703 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.1701 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.1736 - accuracy: 0.5417 4/11 [=========>....................] - ETA: 0s - loss: 0.1753 - accuracy: 0.5435 5/11 [============>.................] - ETA: 0s - loss: 0.1765 - accuracy: 0.5413 6/11 [===============>..............] - ETA: 0s - loss: 0.1775 - accuracy: 0.5405 7/11 [==================>...........] - ETA: 0s - loss: 0.1780 - accuracy: 0.5400 8/11 [====================>.........] - ETA: 0s - loss: 0.1781 - accuracy: 0.5395 9/11 [=======================>......] - ETA: 0s - loss: 0.1783 - accuracy: 0.539310/11 [==========================>...] - ETA: 0s - loss: 0.1783 - accuracy: 0.538911/11 [==============================] - ETA: 0s - loss: 0.1783 - accuracy: 0.538811/11 [==============================] - 1s 112ms/step - loss: 0.1782 - accuracy: 0.5388
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1760 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.1751 - accuracy: 0.5293 3/11 [=======>......................] - ETA: 0s - loss: 0.1732 - accuracy: 0.5326 4/11 [=========>....................] - ETA: 0s - loss: 0.1711 - accuracy: 0.5352 5/11 [============>.................] - ETA: 0s - loss: 0.1698 - accuracy: 0.5378 6/11 [===============>..............] - ETA: 0s - loss: 0.1686 - accuracy: 0.5430 7/11 [==================>...........] - ETA: 0s - loss: 0.1679 - accuracy: 0.5472 8/11 [====================>.........] - ETA: 0s - loss: 0.1676 - accuracy: 0.5500 9/11 [=======================>......] - ETA: 0s - loss: 0.1672 - accuracy: 0.552410/11 [==========================>...] - ETA: 0s - loss: 0.1671 - accuracy: 0.554211/11 [==============================] - ETA: 0s - loss: 0.1671 - accuracy: 0.555811/11 [==============================] - 1s 108ms/step - loss: 0.1670 - accuracy: 0.5572
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1497 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 0s - loss: 0.1522 - accuracy: 0.6387 3/11 [=======>......................] - ETA: 0s - loss: 0.1546 - accuracy: 0.6280 4/11 [=========>....................] - ETA: 0s - loss: 0.1559 - accuracy: 0.6214 5/11 [============>.................] - ETA: 0s - loss: 0.1565 - accuracy: 0.6184 6/11 [===============>..............] - ETA: 0s - loss: 0.1567 - accuracy: 0.6149 7/11 [==================>...........] - ETA: 0s - loss: 0.1568 - accuracy: 0.6133 8/11 [====================>.........] - ETA: 0s - loss: 0.1568 - accuracy: 0.6139 9/11 [=======================>......] - ETA: 0s - loss: 0.1568 - accuracy: 0.615010/11 [==========================>...] - ETA: 0s - loss: 0.1568 - accuracy: 0.616411/11 [==============================] - ETA: 0s - loss: 0.1568 - accuracy: 0.617711/11 [==============================] - 1s 108ms/step - loss: 0.1569 - accuracy: 0.6188
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1465 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.1483 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.1491 - accuracy: 0.6372 4/11 [=========>....................] - ETA: 0s - loss: 0.1491 - accuracy: 0.6390 5/11 [============>.................] - ETA: 0s - loss: 0.1488 - accuracy: 0.6428 6/11 [===============>..............] - ETA: 0s - loss: 0.1491 - accuracy: 0.6441 7/11 [==================>...........] - ETA: 0s - loss: 0.1491 - accuracy: 0.6451 8/11 [====================>.........] - ETA: 0s - loss: 0.1492 - accuracy: 0.6450 9/11 [=======================>......] - ETA: 0s - loss: 0.1491 - accuracy: 0.644510/11 [==========================>...] - ETA: 0s - loss: 0.1489 - accuracy: 0.644111/11 [==============================] - ETA: 0s - loss: 0.1488 - accuracy: 0.644211/11 [==============================] - 1s 109ms/step - loss: 0.1487 - accuracy: 0.6442
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1578 - accuracy: 0.6797 2/11 [====>.........................] - ETA: 0s - loss: 0.1576 - accuracy: 0.6836 3/11 [=======>......................] - ETA: 0s - loss: 0.1561 - accuracy: 0.6832 4/11 [=========>....................] - ETA: 0s - loss: 0.1551 - accuracy: 0.6842 5/11 [============>.................] - ETA: 0s - loss: 0.1535 - accuracy: 0.6868 6/11 [===============>..............] - ETA: 0s - loss: 0.1521 - accuracy: 0.6888 7/11 [==================>...........] - ETA: 0s - loss: 0.1510 - accuracy: 0.6920 8/11 [====================>.........] - ETA: 0s - loss: 0.1503 - accuracy: 0.6956 9/11 [=======================>......] - ETA: 0s - loss: 0.1496 - accuracy: 0.699410/11 [==========================>...] - ETA: 0s - loss: 0.1488 - accuracy: 0.703211/11 [==============================] - ETA: 0s - loss: 0.1479 - accuracy: 0.706611/11 [==============================] - 1s 108ms/step - loss: 0.1473 - accuracy: 0.7094
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1332 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 0s - loss: 0.1332 - accuracy: 0.7676 3/11 [=======>......................] - ETA: 0s - loss: 0.1307 - accuracy: 0.7687 4/11 [=========>....................] - ETA: 0s - loss: 0.1298 - accuracy: 0.7689 5/11 [============>.................] - ETA: 0s - loss: 0.1304 - accuracy: 0.7657 6/11 [===============>..............] - ETA: 0s - loss: 0.1311 - accuracy: 0.7638 7/11 [==================>...........] - ETA: 0s - loss: 0.1315 - accuracy: 0.7624 8/11 [====================>.........] - ETA: 0s - loss: 0.1319 - accuracy: 0.7600 9/11 [=======================>......] - ETA: 0s - loss: 0.1320 - accuracy: 0.757810/11 [==========================>...] - ETA: 0s - loss: 0.1319 - accuracy: 0.755611/11 [==============================] - ETA: 0s - loss: 0.1318 - accuracy: 0.754111/11 [==============================] - 1s 106ms/step - loss: 0.1318 - accuracy: 0.7529
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1446 - accuracy: 0.7422 2/11 [====>.........................] - ETA: 0s - loss: 0.1342 - accuracy: 0.7695 3/11 [=======>......................] - ETA: 0s - loss: 0.1321 - accuracy: 0.7830 4/11 [=========>....................] - ETA: 0s - loss: 0.1313 - accuracy: 0.7904 5/11 [============>.................] - ETA: 0s - loss: 0.1302 - accuracy: 0.7954 6/11 [===============>..............] - ETA: 0s - loss: 0.1289 - accuracy: 0.8004 7/11 [==================>...........] - ETA: 0s - loss: 0.1286 - accuracy: 0.8042 8/11 [====================>.........] - ETA: 0s - loss: 0.1282 - accuracy: 0.8061 9/11 [=======================>......] - ETA: 0s - loss: 0.1279 - accuracy: 0.807610/11 [==========================>...] - ETA: 0s - loss: 0.1276 - accuracy: 0.808611/11 [==============================] - ETA: 0s - loss: 0.1272 - accuracy: 0.809511/11 [==============================] - 1s 102ms/step - loss: 0.1269 - accuracy: 0.8104
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1511 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 0s - loss: 0.1469 - accuracy: 0.7852 3/11 [=======>......................] - ETA: 0s - loss: 0.1413 - accuracy: 0.7917 4/11 [=========>....................] - ETA: 0s - loss: 0.1380 - accuracy: 0.7949 5/11 [============>.................] - ETA: 0s - loss: 0.1361 - accuracy: 0.7919 6/11 [===============>..............] - ETA: 0s - loss: 0.1348 - accuracy: 0.7873 7/11 [==================>...........] - ETA: 0s - loss: 0.1332 - accuracy: 0.7856 8/11 [====================>.........] - ETA: 0s - loss: 0.1318 - accuracy: 0.7848 9/11 [=======================>......] - ETA: 0s - loss: 0.1307 - accuracy: 0.784910/11 [==========================>...] - ETA: 0s - loss: 0.1297 - accuracy: 0.785311/11 [==============================] - ETA: 0s - loss: 0.1287 - accuracy: 0.786411/11 [==============================] - 1s 104ms/step - loss: 0.1279 - accuracy: 0.7872
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1082 - accuracy: 0.8828 2/11 [====>.........................] - ETA: 0s - loss: 0.1103 - accuracy: 0.8809 3/11 [=======>......................] - ETA: 0s - loss: 0.1110 - accuracy: 0.8780 4/11 [=========>....................] - ETA: 0s - loss: 0.1126 - accuracy: 0.8768 5/11 [============>.................] - ETA: 0s - loss: 0.1129 - accuracy: 0.8755 6/11 [===============>..............] - ETA: 0s - loss: 0.1133 - accuracy: 0.8743 7/11 [==================>...........] - ETA: 0s - loss: 0.1134 - accuracy: 0.8717 8/11 [====================>.........] - ETA: 0s - loss: 0.1135 - accuracy: 0.8685 9/11 [=======================>......] - ETA: 0s - loss: 0.1136 - accuracy: 0.866010/11 [==========================>...] - ETA: 0s - loss: 0.1137 - accuracy: 0.864011/11 [==============================] - ETA: 0s - loss: 0.1137 - accuracy: 0.862411/11 [==============================] - 1s 107ms/step - loss: 0.1137 - accuracy: 0.8611
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1080 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 0s - loss: 0.1094 - accuracy: 0.8496 3/11 [=======>......................] - ETA: 0s - loss: 0.1099 - accuracy: 0.8468 4/11 [=========>....................] - ETA: 0s - loss: 0.1107 - accuracy: 0.8407 5/11 [============>.................] - ETA: 0s - loss: 0.1110 - accuracy: 0.8347 6/11 [===============>..............] - ETA: 0s - loss: 0.1110 - accuracy: 0.8323 7/11 [==================>...........] - ETA: 0s - loss: 0.1110 - accuracy: 0.8312 8/11 [====================>.........] - ETA: 0s - loss: 0.1107 - accuracy: 0.8306 9/11 [=======================>......] - ETA: 0s - loss: 0.1103 - accuracy: 0.830710/11 [==========================>...] - ETA: 0s - loss: 0.1099 - accuracy: 0.830511/11 [==============================] - ETA: 0s - loss: 0.1097 - accuracy: 0.830511/11 [==============================] - 1s 107ms/step - loss: 0.1095 - accuracy: 0.8305
Evaluate on test data
1/6 [====>.........................] - ETA: 18s - loss: 0.1325 - accuracy: 0.78123/6 [==============>...............] - ETA: 0s - loss: 0.1159 - accuracy: 0.8073 5/6 [========================>.....] - ETA: 0s - loss: 0.1168 - accuracy: 0.79066/6 [==============================] - 4s 31ms/step - loss: 0.1178 - accuracy: 0.7904
2021-12-13 23:50:23.286914: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:50:23.287976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:50:23.288038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:50:23.288091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:50:23.288189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:50:23.288237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:50:23.288338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:50:23.288384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:50:23.288422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:50:23.288531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:50:23.290044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:50:23.290082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:50:23.290096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:50:23.290106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 4 3] pred: [ 0.42305386  0.63029623  0.46503097 -0.49261656 -0.27501526]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 4 3] pred: [-0.55178285  0.9641604   0.8188713  -0.68760115 -0.6522065 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [-0.00678418  0.7222458   0.67736757 -0.38427383 -0.46584752]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [ 0.2683622   0.43205792  0.59145    -0.74160445 -0.48519343]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 3 0 4] pred: [-0.5542419   0.9371925   0.80059546 -0.4098521  -0.67489576]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 4 1 3 0] pred: [-0.9469385  -0.926963    0.99699724 -0.9423375  -0.777193  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [-0.91112155  0.8428634   0.95046693 -0.57688725 -0.81224257]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 3 0 1] pred: [-0.9409582  -0.94120634  0.99408656 -0.890064   -0.7721174 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [4 3 0 2 1] pred: [-0.08803771 -0.35110173 -0.18572232  0.35075438  0.40786695]
 Top predictions indices: [4 3] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 3 0 4] pred: [-0.6044675   0.9298633   0.77924836 -0.28040245 -0.71263087]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 4 1 0] pred: [-0.92840123 -0.87611276  0.93349934  0.343342   -0.8698191 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 0 2 1] pred: [-0.2322889  -0.92499185 -0.44141042  0.9374923   0.03121994]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 4 1 0] pred: [-0.9430738  -0.86646795  0.9602492  -0.34048754 -0.8380694 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [-0.20324439  0.77277637  0.8635939  -0.7154867  -0.66147614]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 4 3 1 0] pred: [-0.90789753 -0.90114105  0.9875341  -0.85749936 -0.7584038 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:06 - loss: 2.9871 - accuracy: 0.2422 2/11 [====>.........................] - ETA: 1s - loss: 2.7650 - accuracy: 0.2910   3/11 [=======>......................] - ETA: 0s - loss: 2.5466 - accuracy: 0.3225 4/11 [=========>....................] - ETA: 0s - loss: 2.3789 - accuracy: 0.3449 5/11 [============>.................] - ETA: 0s - loss: 2.2469 - accuracy: 0.3612 6/11 [===============>..............] - ETA: 0s - loss: 2.1405 - accuracy: 0.3752 7/11 [==================>...........] - ETA: 0s - loss: 2.0518 - accuracy: 0.3873 8/11 [====================>.........] - ETA: 0s - loss: 1.9758 - accuracy: 0.3969 9/11 [=======================>......] - ETA: 0s - loss: 1.9104 - accuracy: 0.403910/11 [==========================>...] - ETA: 0s - loss: 1.8545 - accuracy: 0.408411/11 [==============================] - ETA: 0s - loss: 1.8061 - accuracy: 0.412311/11 [==============================] - 14s 108ms/step - loss: 1.7658 - accuracy: 0.4155
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8348 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.8649 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 0s - loss: 0.8690 - accuracy: 0.4913 4/11 [=========>....................] - ETA: 0s - loss: 0.8684 - accuracy: 0.4862 5/11 [============>.................] - ETA: 0s - loss: 0.8699 - accuracy: 0.4802 6/11 [===============>..............] - ETA: 0s - loss: 0.8684 - accuracy: 0.4768 7/11 [==================>...........] - ETA: 0s - loss: 0.8681 - accuracy: 0.4737 8/11 [====================>.........] - ETA: 0s - loss: 0.8680 - accuracy: 0.4713 9/11 [=======================>......] - ETA: 0s - loss: 0.8678 - accuracy: 0.469910/11 [==========================>...] - ETA: 0s - loss: 0.8664 - accuracy: 0.469611/11 [==============================] - ETA: 0s - loss: 0.8654 - accuracy: 0.468811/11 [==============================] - 1s 109ms/step - loss: 0.8645 - accuracy: 0.4682
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8647 - accuracy: 0.3672 2/11 [====>.........................] - ETA: 0s - loss: 0.8597 - accuracy: 0.3867 3/11 [=======>......................] - ETA: 0s - loss: 0.8496 - accuracy: 0.4080 4/11 [=========>....................] - ETA: 0s - loss: 0.8400 - accuracy: 0.4242 5/11 [============>.................] - ETA: 0s - loss: 0.8357 - accuracy: 0.4318 6/11 [===============>..............] - ETA: 0s - loss: 0.8301 - accuracy: 0.4382 7/11 [==================>...........] - ETA: 0s - loss: 0.8250 - accuracy: 0.4426 8/11 [====================>.........] - ETA: 0s - loss: 0.8209 - accuracy: 0.4460 9/11 [=======================>......] - ETA: 0s - loss: 0.8170 - accuracy: 0.448510/11 [==========================>...] - ETA: 0s - loss: 0.8136 - accuracy: 0.449911/11 [==============================] - ETA: 0s - loss: 0.8110 - accuracy: 0.450911/11 [==============================] - 1s 111ms/step - loss: 0.8088 - accuracy: 0.4518
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7932 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.8036 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.7876 - accuracy: 0.4709 4/11 [=========>....................] - ETA: 0s - loss: 0.7766 - accuracy: 0.4655 5/11 [============>.................] - ETA: 0s - loss: 0.7693 - accuracy: 0.4608 6/11 [===============>..............] - ETA: 0s - loss: 0.7654 - accuracy: 0.4574 7/11 [==================>...........] - ETA: 0s - loss: 0.7609 - accuracy: 0.4565 8/11 [====================>.........] - ETA: 0s - loss: 0.7568 - accuracy: 0.4554 9/11 [=======================>......] - ETA: 0s - loss: 0.7523 - accuracy: 0.454910/11 [==========================>...] - ETA: 0s - loss: 0.7476 - accuracy: 0.455611/11 [==============================] - ETA: 0s - loss: 0.7431 - accuracy: 0.456411/11 [==============================] - 1s 112ms/step - loss: 0.7393 - accuracy: 0.4569
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7368 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.7005 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.6929 - accuracy: 0.4401 4/11 [=========>....................] - ETA: 0s - loss: 0.6883 - accuracy: 0.4419 5/11 [============>.................] - ETA: 0s - loss: 0.6849 - accuracy: 0.4404 6/11 [===============>..............] - ETA: 0s - loss: 0.6809 - accuracy: 0.4414 7/11 [==================>...........] - ETA: 0s - loss: 0.6771 - accuracy: 0.4437 8/11 [====================>.........] - ETA: 0s - loss: 0.6752 - accuracy: 0.4456 9/11 [=======================>......] - ETA: 0s - loss: 0.6733 - accuracy: 0.447810/11 [==========================>...] - ETA: 0s - loss: 0.6711 - accuracy: 0.449711/11 [==============================] - ETA: 0s - loss: 0.6687 - accuracy: 0.451411/11 [==============================] - 1s 106ms/step - loss: 0.6666 - accuracy: 0.4528
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5923 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.6195 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.6281 - accuracy: 0.4965 4/11 [=========>....................] - ETA: 0s - loss: 0.6332 - accuracy: 0.4930 5/11 [============>.................] - ETA: 0s - loss: 0.6325 - accuracy: 0.4903 6/11 [===============>..............] - ETA: 0s - loss: 0.6301 - accuracy: 0.4867 7/11 [==================>...........] - ETA: 0s - loss: 0.6288 - accuracy: 0.4837 8/11 [====================>.........] - ETA: 0s - loss: 0.6281 - accuracy: 0.4813 9/11 [=======================>......] - ETA: 0s - loss: 0.6270 - accuracy: 0.479310/11 [==========================>...] - ETA: 0s - loss: 0.6256 - accuracy: 0.478111/11 [==============================] - ETA: 0s - loss: 0.6239 - accuracy: 0.477311/11 [==============================] - 1s 113ms/step - loss: 0.6225 - accuracy: 0.4766
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5356 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.5310 - accuracy: 0.5371 3/11 [=======>......................] - ETA: 0s - loss: 0.5401 - accuracy: 0.5265 4/11 [=========>....................] - ETA: 0s - loss: 0.5471 - accuracy: 0.5189 5/11 [============>.................] - ETA: 0s - loss: 0.5517 - accuracy: 0.5104 6/11 [===============>..............] - ETA: 0s - loss: 0.5542 - accuracy: 0.5046 7/11 [==================>...........] - ETA: 0s - loss: 0.5575 - accuracy: 0.5002 8/11 [====================>.........] - ETA: 0s - loss: 0.5586 - accuracy: 0.4973 9/11 [=======================>......] - ETA: 0s - loss: 0.5602 - accuracy: 0.494210/11 [==========================>...] - ETA: 0s - loss: 0.5613 - accuracy: 0.491711/11 [==============================] - ETA: 0s - loss: 0.5620 - accuracy: 0.489611/11 [==============================] - 1s 108ms/step - loss: 0.5626 - accuracy: 0.4879
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5771 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.5564 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 0s - loss: 0.5490 - accuracy: 0.4692 4/11 [=========>....................] - ETA: 0s - loss: 0.5496 - accuracy: 0.4696 5/11 [============>.................] - ETA: 0s - loss: 0.5507 - accuracy: 0.4682 6/11 [===============>..............] - ETA: 0s - loss: 0.5506 - accuracy: 0.4663 7/11 [==================>...........] - ETA: 0s - loss: 0.5496 - accuracy: 0.4657 8/11 [====================>.........] - ETA: 0s - loss: 0.5484 - accuracy: 0.4662 9/11 [=======================>......] - ETA: 0s - loss: 0.5467 - accuracy: 0.466610/11 [==========================>...] - ETA: 0s - loss: 0.5453 - accuracy: 0.466511/11 [==============================] - ETA: 0s - loss: 0.5437 - accuracy: 0.466711/11 [==============================] - 1s 114ms/step - loss: 0.5425 - accuracy: 0.4670
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4985 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.5054 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 0s - loss: 0.5089 - accuracy: 0.4805 4/11 [=========>....................] - ETA: 0s - loss: 0.5092 - accuracy: 0.4766 5/11 [============>.................] - ETA: 0s - loss: 0.5084 - accuracy: 0.4756 6/11 [===============>..............] - ETA: 0s - loss: 0.5070 - accuracy: 0.4743 7/11 [==================>...........] - ETA: 0s - loss: 0.5044 - accuracy: 0.4738 8/11 [====================>.........] - ETA: 0s - loss: 0.5020 - accuracy: 0.4733 9/11 [=======================>......] - ETA: 0s - loss: 0.5012 - accuracy: 0.472610/11 [==========================>...] - ETA: 0s - loss: 0.5002 - accuracy: 0.472011/11 [==============================] - ETA: 0s - loss: 0.4990 - accuracy: 0.471911/11 [==============================] - 1s 106ms/step - loss: 0.4980 - accuracy: 0.4717
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5017 - accuracy: 0.3672 2/11 [====>.........................] - ETA: 0s - loss: 0.4977 - accuracy: 0.3770 3/11 [=======>......................] - ETA: 0s - loss: 0.4916 - accuracy: 0.3963 4/11 [=========>....................] - ETA: 0s - loss: 0.4842 - accuracy: 0.4139 5/11 [============>.................] - ETA: 0s - loss: 0.4787 - accuracy: 0.4227 6/11 [===============>..............] - ETA: 0s - loss: 0.4763 - accuracy: 0.4286 7/11 [==================>...........] - ETA: 0s - loss: 0.4742 - accuracy: 0.4324 8/11 [====================>.........] - ETA: 0s - loss: 0.4732 - accuracy: 0.4361 9/11 [=======================>......] - ETA: 0s - loss: 0.4718 - accuracy: 0.438710/11 [==========================>...] - ETA: 0s - loss: 0.4712 - accuracy: 0.441511/11 [==============================] - ETA: 0s - loss: 0.4706 - accuracy: 0.444111/11 [==============================] - 1s 108ms/step - loss: 0.4701 - accuracy: 0.4463
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3628 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 0s - loss: 0.3873 - accuracy: 0.5195 3/11 [=======>......................] - ETA: 0s - loss: 0.3975 - accuracy: 0.5139 4/11 [=========>....................] - ETA: 0s - loss: 0.4086 - accuracy: 0.5075 5/11 [============>.................] - ETA: 0s - loss: 0.4154 - accuracy: 0.4991 6/11 [===============>..............] - ETA: 0s - loss: 0.4205 - accuracy: 0.4928 7/11 [==================>...........] - ETA: 0s - loss: 0.4231 - accuracy: 0.4882 8/11 [====================>.........] - ETA: 0s - loss: 0.4255 - accuracy: 0.4857 9/11 [=======================>......] - ETA: 0s - loss: 0.4280 - accuracy: 0.484110/11 [==========================>...] - ETA: 0s - loss: 0.4301 - accuracy: 0.482911/11 [==============================] - ETA: 0s - loss: 0.4315 - accuracy: 0.481611/11 [==============================] - 1s 107ms/step - loss: 0.4326 - accuracy: 0.4805
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5633 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.5210 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 0s - loss: 0.4957 - accuracy: 0.4484 4/11 [=========>....................] - ETA: 0s - loss: 0.4883 - accuracy: 0.4530 5/11 [============>.................] - ETA: 0s - loss: 0.4799 - accuracy: 0.4574 6/11 [===============>..............] - ETA: 0s - loss: 0.4759 - accuracy: 0.4619 7/11 [==================>...........] - ETA: 0s - loss: 0.4700 - accuracy: 0.4644 8/11 [====================>.........] - ETA: 0s - loss: 0.4647 - accuracy: 0.4669 9/11 [=======================>......] - ETA: 0s - loss: 0.4604 - accuracy: 0.468210/11 [==========================>...] - ETA: 0s - loss: 0.4567 - accuracy: 0.468711/11 [==============================] - ETA: 0s - loss: 0.4541 - accuracy: 0.468711/11 [==============================] - 1s 110ms/step - loss: 0.4520 - accuracy: 0.4687
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4190 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.4289 - accuracy: 0.4043 3/11 [=======>......................] - ETA: 0s - loss: 0.4265 - accuracy: 0.4162 4/11 [=========>....................] - ETA: 0s - loss: 0.4281 - accuracy: 0.4186 5/11 [============>.................] - ETA: 0s - loss: 0.4292 - accuracy: 0.4230 6/11 [===============>..............] - ETA: 0s - loss: 0.4280 - accuracy: 0.4278 7/11 [==================>...........] - ETA: 0s - loss: 0.4259 - accuracy: 0.4306 8/11 [====================>.........] - ETA: 0s - loss: 0.4241 - accuracy: 0.4330 9/11 [=======================>......] - ETA: 0s - loss: 0.4215 - accuracy: 0.436010/11 [==========================>...] - ETA: 0s - loss: 0.4195 - accuracy: 0.439011/11 [==============================] - ETA: 0s - loss: 0.4187 - accuracy: 0.441611/11 [==============================] - 1s 106ms/step - loss: 0.4180 - accuracy: 0.4438
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3569 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.3636 - accuracy: 0.4316 3/11 [=======>......................] - ETA: 0s - loss: 0.3693 - accuracy: 0.4310 4/11 [=========>....................] - ETA: 0s - loss: 0.3767 - accuracy: 0.4302 5/11 [============>.................] - ETA: 0s - loss: 0.3796 - accuracy: 0.4323 6/11 [===============>..............] - ETA: 0s - loss: 0.3809 - accuracy: 0.4329 7/11 [==================>...........] - ETA: 0s - loss: 0.3818 - accuracy: 0.4344 8/11 [====================>.........] - ETA: 0s - loss: 0.3834 - accuracy: 0.4373 9/11 [=======================>......] - ETA: 0s - loss: 0.3843 - accuracy: 0.440110/11 [==========================>...] - ETA: 0s - loss: 0.3849 - accuracy: 0.442911/11 [==============================] - ETA: 0s - loss: 0.3855 - accuracy: 0.445311/11 [==============================] - 1s 111ms/step - loss: 0.3859 - accuracy: 0.4473
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3908 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.4029 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.3988 - accuracy: 0.4540 4/11 [=========>....................] - ETA: 0s - loss: 0.3992 - accuracy: 0.4543 5/11 [============>.................] - ETA: 0s - loss: 0.4001 - accuracy: 0.4537 6/11 [===============>..............] - ETA: 0s - loss: 0.3997 - accuracy: 0.4525 7/11 [==================>...........] - ETA: 0s - loss: 0.3979 - accuracy: 0.4531 8/11 [====================>.........] - ETA: 0s - loss: 0.3963 - accuracy: 0.4543 9/11 [=======================>......] - ETA: 0s - loss: 0.3953 - accuracy: 0.455810/11 [==========================>...] - ETA: 0s - loss: 0.3943 - accuracy: 0.457411/11 [==============================] - ETA: 0s - loss: 0.3924 - accuracy: 0.458611/11 [==============================] - 1s 109ms/step - loss: 0.3909 - accuracy: 0.4597
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4641 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.4301 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.4118 - accuracy: 0.4462 4/11 [=========>....................] - ETA: 0s - loss: 0.4007 - accuracy: 0.4533 5/11 [============>.................] - ETA: 0s - loss: 0.3919 - accuracy: 0.4573 6/11 [===============>..............] - ETA: 0s - loss: 0.3853 - accuracy: 0.4588 7/11 [==================>...........] - ETA: 0s - loss: 0.3819 - accuracy: 0.4599 8/11 [====================>.........] - ETA: 0s - loss: 0.3811 - accuracy: 0.4598 9/11 [=======================>......] - ETA: 0s - loss: 0.3804 - accuracy: 0.460310/11 [==========================>...] - ETA: 0s - loss: 0.3789 - accuracy: 0.461211/11 [==============================] - ETA: 0s - loss: 0.3774 - accuracy: 0.462011/11 [==============================] - 1s 108ms/step - loss: 0.3761 - accuracy: 0.4626
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3275 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.3605 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.3653 - accuracy: 0.4054 4/11 [=========>....................] - ETA: 0s - loss: 0.3686 - accuracy: 0.4115 5/11 [============>.................] - ETA: 0s - loss: 0.3681 - accuracy: 0.4170 6/11 [===============>..............] - ETA: 0s - loss: 0.3668 - accuracy: 0.4230 7/11 [==================>...........] - ETA: 0s - loss: 0.3656 - accuracy: 0.4273 8/11 [====================>.........] - ETA: 0s - loss: 0.3641 - accuracy: 0.4321 9/11 [=======================>......] - ETA: 0s - loss: 0.3629 - accuracy: 0.436010/11 [==========================>...] - ETA: 0s - loss: 0.3615 - accuracy: 0.439911/11 [==============================] - ETA: 0s - loss: 0.3606 - accuracy: 0.443311/11 [==============================] - 1s 105ms/step - loss: 0.3598 - accuracy: 0.4461
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2648 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.2788 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.2946 - accuracy: 0.4870 4/11 [=========>....................] - ETA: 0s - loss: 0.3107 - accuracy: 0.4858 5/11 [============>.................] - ETA: 0s - loss: 0.3191 - accuracy: 0.4865 6/11 [===============>..............] - ETA: 0s - loss: 0.3260 - accuracy: 0.4870 7/11 [==================>...........] - ETA: 0s - loss: 0.3318 - accuracy: 0.4871 8/11 [====================>.........] - ETA: 0s - loss: 0.3345 - accuracy: 0.4868 9/11 [=======================>......] - ETA: 0s - loss: 0.3363 - accuracy: 0.486710/11 [==========================>...] - ETA: 0s - loss: 0.3374 - accuracy: 0.486311/11 [==============================] - ETA: 0s - loss: 0.3378 - accuracy: 0.486111/11 [==============================] - 1s 107ms/step - loss: 0.3381 - accuracy: 0.4859
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2413 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.2644 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.2890 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.3017 - accuracy: 0.4844 5/11 [============>.................] - ETA: 0s - loss: 0.3039 - accuracy: 0.4859 6/11 [===============>..............] - ETA: 0s - loss: 0.3050 - accuracy: 0.4870 7/11 [==================>...........] - ETA: 0s - loss: 0.3066 - accuracy: 0.4858 8/11 [====================>.........] - ETA: 0s - loss: 0.3077 - accuracy: 0.4861 9/11 [=======================>......] - ETA: 0s - loss: 0.3104 - accuracy: 0.486010/11 [==========================>...] - ETA: 0s - loss: 0.3127 - accuracy: 0.486711/11 [==============================] - ETA: 0s - loss: 0.3147 - accuracy: 0.487211/11 [==============================] - 1s 106ms/step - loss: 0.3164 - accuracy: 0.4876
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3192 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.3228 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 1s - loss: 0.3184 - accuracy: 0.4805 4/11 [=========>....................] - ETA: 0s - loss: 0.3171 - accuracy: 0.4819 5/11 [============>.................] - ETA: 0s - loss: 0.3199 - accuracy: 0.4834 6/11 [===============>..............] - ETA: 0s - loss: 0.3233 - accuracy: 0.4853 7/11 [==================>...........] - ETA: 0s - loss: 0.3264 - accuracy: 0.4867 8/11 [====================>.........] - ETA: 0s - loss: 0.3273 - accuracy: 0.4892 9/11 [=======================>......] - ETA: 0s - loss: 0.3275 - accuracy: 0.490810/11 [==========================>...] - ETA: 0s - loss: 0.3270 - accuracy: 0.492011/11 [==============================] - ETA: 0s - loss: 0.3269 - accuracy: 0.492911/11 [==============================] - 1s 115ms/step - loss: 0.3268 - accuracy: 0.4937
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.3143 - accuracy: 0.52343/6 [==============>...............] - ETA: 0s - loss: 0.3541 - accuracy: 0.4974 5/6 [========================>.....] - ETA: 0s - loss: 0.3394 - accuracy: 0.49846/6 [==============================] - 4s 29ms/step - loss: 0.3421 - accuracy: 0.4958
2021-12-13 23:51:12.221768: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:51:12.222742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:51:12.222799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:51:12.222858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:51:12.222888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:51:12.222918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:51:12.222947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:51:12.222979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:51:12.223008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:51:12.223038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:51:12.224239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:51:12.224274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:51:12.224284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:51:12.224293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 4 0] pred: [-0.2147599   0.02086895  0.45656192  0.31862384 -0.00769637]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [-0.46949267  0.6869593   0.8781315  -0.14900868 -0.4680398 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [-0.4246997   0.742546    0.9748767  -0.56053525 -0.67760634]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 4 1 0] pred: [-0.2153822  -0.17637701  0.603535    0.21010283  0.05572787]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [-0.17084956  0.38475072  0.45184085 -0.03018974 -0.14120968]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 4 0] pred: [-0.32205254  0.43815923  0.6481101   0.03392884 -0.20553233]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [-0.27277896  0.446046    0.56959456  0.05257517 -0.19333203]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [-0.04684419  0.1430576   0.18440318 -0.00205507 -0.00873841]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 0 3] pred: [-0.53777313 -0.23486924  0.98510945 -0.6053922  -0.48802772]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [-0.4651785   0.64534545  0.92043483 -0.27902487 -0.5060414 ]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [-0.23737185  0.15622759  0.5827803   0.12076253 -0.06322743]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [-0.3311203   0.10348362  0.7639176   0.05334732 -0.12381688]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 4 0 1] pred: [-0.13200189 -0.250921    0.36019778  0.34931517  0.15755239]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [-0.36805174  0.69175786  0.88218963 -0.30192238 -0.48881507]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [-0.39370865  0.7190377   0.8873956  -0.31226045 -0.49364823]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:06 - loss: 2.1282 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 1.9710 - accuracy: 0.4258   3/11 [=======>......................] - ETA: 0s - loss: 1.8317 - accuracy: 0.4384 4/11 [=========>....................] - ETA: 0s - loss: 1.7296 - accuracy: 0.4479 5/11 [============>.................] - ETA: 0s - loss: 1.6460 - accuracy: 0.4552 6/11 [===============>..............] - ETA: 0s - loss: 1.5800 - accuracy: 0.4583 7/11 [==================>...........] - ETA: 0s - loss: 1.5225 - accuracy: 0.4605 8/11 [====================>.........] - ETA: 0s - loss: 1.4727 - accuracy: 0.4609 9/11 [=======================>......] - ETA: 0s - loss: 1.4287 - accuracy: 0.461010/11 [==========================>...] - ETA: 0s - loss: 1.3891 - accuracy: 0.461511/11 [==============================] - ETA: 0s - loss: 1.3543 - accuracy: 0.462011/11 [==============================] - 14s 107ms/step - loss: 1.3253 - accuracy: 0.4623
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6574 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.6477 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 0s - loss: 0.6414 - accuracy: 0.4462 4/11 [=========>....................] - ETA: 0s - loss: 0.6340 - accuracy: 0.4533 5/11 [============>.................] - ETA: 0s - loss: 0.6284 - accuracy: 0.4567 6/11 [===============>..............] - ETA: 0s - loss: 0.6235 - accuracy: 0.4581 7/11 [==================>...........] - ETA: 0s - loss: 0.6189 - accuracy: 0.4601 8/11 [====================>.........] - ETA: 0s - loss: 0.6149 - accuracy: 0.4605 9/11 [=======================>......] - ETA: 0s - loss: 0.6112 - accuracy: 0.460610/11 [==========================>...] - ETA: 0s - loss: 0.6078 - accuracy: 0.460211/11 [==============================] - ETA: 0s - loss: 0.6044 - accuracy: 0.460311/11 [==============================] - 1s 112ms/step - loss: 0.6016 - accuracy: 0.4604
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4972 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.4948 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 0s - loss: 0.4943 - accuracy: 0.4870 4/11 [=========>....................] - ETA: 0s - loss: 0.4936 - accuracy: 0.4878 5/11 [============>.................] - ETA: 0s - loss: 0.4925 - accuracy: 0.4896 6/11 [===============>..............] - ETA: 0s - loss: 0.4916 - accuracy: 0.4883 7/11 [==================>...........] - ETA: 0s - loss: 0.4907 - accuracy: 0.4868 8/11 [====================>.........] - ETA: 0s - loss: 0.4900 - accuracy: 0.4842 9/11 [=======================>......] - ETA: 0s - loss: 0.4889 - accuracy: 0.482510/11 [==========================>...] - ETA: 0s - loss: 0.4876 - accuracy: 0.480611/11 [==============================] - ETA: 0s - loss: 0.4864 - accuracy: 0.478711/11 [==============================] - 1s 107ms/step - loss: 0.4855 - accuracy: 0.4770
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4445 - accuracy: 0.3828 2/11 [====>.........................] - ETA: 0s - loss: 0.4371 - accuracy: 0.4043 3/11 [=======>......................] - ETA: 0s - loss: 0.4326 - accuracy: 0.4180 4/11 [=========>....................] - ETA: 0s - loss: 0.4300 - accuracy: 0.4219 5/11 [============>.................] - ETA: 0s - loss: 0.4271 - accuracy: 0.4278 6/11 [===============>..............] - ETA: 0s - loss: 0.4253 - accuracy: 0.4301 7/11 [==================>...........] - ETA: 0s - loss: 0.4237 - accuracy: 0.4311 8/11 [====================>.........] - ETA: 0s - loss: 0.4220 - accuracy: 0.4330 9/11 [=======================>......] - ETA: 0s - loss: 0.4202 - accuracy: 0.435510/11 [==========================>...] - ETA: 0s - loss: 0.4185 - accuracy: 0.437511/11 [==============================] - ETA: 0s - loss: 0.4168 - accuracy: 0.439311/11 [==============================] - 1s 107ms/step - loss: 0.4153 - accuracy: 0.4408
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3447 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.3532 - accuracy: 0.4805 3/11 [=======>......................] - ETA: 0s - loss: 0.3545 - accuracy: 0.4661 4/11 [=========>....................] - ETA: 0s - loss: 0.3537 - accuracy: 0.4619 5/11 [============>.................] - ETA: 0s - loss: 0.3520 - accuracy: 0.4614 6/11 [===============>..............] - ETA: 0s - loss: 0.3509 - accuracy: 0.4609 7/11 [==================>...........] - ETA: 0s - loss: 0.3501 - accuracy: 0.4599 8/11 [====================>.........] - ETA: 0s - loss: 0.3494 - accuracy: 0.4585 9/11 [=======================>......] - ETA: 0s - loss: 0.3485 - accuracy: 0.457910/11 [==========================>...] - ETA: 0s - loss: 0.3474 - accuracy: 0.457311/11 [==============================] - ETA: 0s - loss: 0.3465 - accuracy: 0.457211/11 [==============================] - 1s 107ms/step - loss: 0.3457 - accuracy: 0.4571
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3197 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.3162 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.3135 - accuracy: 0.4787 4/11 [=========>....................] - ETA: 0s - loss: 0.3117 - accuracy: 0.4792 5/11 [============>.................] - ETA: 0s - loss: 0.3105 - accuracy: 0.4786 6/11 [===============>..............] - ETA: 0s - loss: 0.3091 - accuracy: 0.4783 7/11 [==================>...........] - ETA: 0s - loss: 0.3087 - accuracy: 0.4765 8/11 [====================>.........] - ETA: 0s - loss: 0.3082 - accuracy: 0.4739 9/11 [=======================>......] - ETA: 0s - loss: 0.3079 - accuracy: 0.471310/11 [==========================>...] - ETA: 0s - loss: 0.3075 - accuracy: 0.469311/11 [==============================] - ETA: 0s - loss: 0.3071 - accuracy: 0.468111/11 [==============================] - 1s 110ms/step - loss: 0.3068 - accuracy: 0.4670
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2793 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.2882 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 0s - loss: 0.2904 - accuracy: 0.4475 4/11 [=========>....................] - ETA: 0s - loss: 0.2912 - accuracy: 0.4440 5/11 [============>.................] - ETA: 0s - loss: 0.2906 - accuracy: 0.4427 6/11 [===============>..............] - ETA: 0s - loss: 0.2900 - accuracy: 0.4423 7/11 [==================>...........] - ETA: 0s - loss: 0.2897 - accuracy: 0.4430 8/11 [====================>.........] - ETA: 0s - loss: 0.2890 - accuracy: 0.4442 9/11 [=======================>......] - ETA: 0s - loss: 0.2885 - accuracy: 0.444510/11 [==========================>...] - ETA: 0s - loss: 0.2877 - accuracy: 0.445511/11 [==============================] - ETA: 0s - loss: 0.2870 - accuracy: 0.446511/11 [==============================] - 1s 105ms/step - loss: 0.2864 - accuracy: 0.4473
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2559 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.2575 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 0s - loss: 0.2568 - accuracy: 0.4605 4/11 [=========>....................] - ETA: 0s - loss: 0.2575 - accuracy: 0.4596 5/11 [============>.................] - ETA: 0s - loss: 0.2569 - accuracy: 0.4599 6/11 [===============>..............] - ETA: 0s - loss: 0.2561 - accuracy: 0.4588 7/11 [==================>...........] - ETA: 0s - loss: 0.2555 - accuracy: 0.4589 8/11 [====================>.........] - ETA: 0s - loss: 0.2551 - accuracy: 0.4589 9/11 [=======================>......] - ETA: 0s - loss: 0.2556 - accuracy: 0.458810/11 [==========================>...] - ETA: 0s - loss: 0.2561 - accuracy: 0.458411/11 [==============================] - ETA: 0s - loss: 0.2564 - accuracy: 0.458211/11 [==============================] - 1s 107ms/step - loss: 0.2567 - accuracy: 0.4581
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2039 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 1s - loss: 0.2161 - accuracy: 0.5273 3/11 [=======>......................] - ETA: 0s - loss: 0.2236 - accuracy: 0.5095 4/11 [=========>....................] - ETA: 0s - loss: 0.2280 - accuracy: 0.4989 5/11 [============>.................] - ETA: 0s - loss: 0.2319 - accuracy: 0.4916 6/11 [===============>..............] - ETA: 0s - loss: 0.2350 - accuracy: 0.4860 7/11 [==================>...........] - ETA: 0s - loss: 0.2364 - accuracy: 0.4834 8/11 [====================>.........] - ETA: 0s - loss: 0.2374 - accuracy: 0.4819 9/11 [=======================>......] - ETA: 0s - loss: 0.2379 - accuracy: 0.480510/11 [==========================>...] - ETA: 0s - loss: 0.2384 - accuracy: 0.478511/11 [==============================] - ETA: 0s - loss: 0.2386 - accuracy: 0.476611/11 [==============================] - 1s 106ms/step - loss: 0.2388 - accuracy: 0.4750
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2224 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.2264 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.2283 - accuracy: 0.4870 4/11 [=========>....................] - ETA: 0s - loss: 0.2289 - accuracy: 0.4814 5/11 [============>.................] - ETA: 0s - loss: 0.2295 - accuracy: 0.4758 6/11 [===============>..............] - ETA: 0s - loss: 0.2293 - accuracy: 0.4740 7/11 [==================>...........] - ETA: 0s - loss: 0.2288 - accuracy: 0.4739 8/11 [====================>.........] - ETA: 0s - loss: 0.2284 - accuracy: 0.4737 9/11 [=======================>......] - ETA: 0s - loss: 0.2279 - accuracy: 0.473310/11 [==========================>...] - ETA: 0s - loss: 0.2274 - accuracy: 0.473411/11 [==============================] - ETA: 0s - loss: 0.2271 - accuracy: 0.473111/11 [==============================] - 1s 111ms/step - loss: 0.2268 - accuracy: 0.4729
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2058 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.2092 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 0s - loss: 0.2104 - accuracy: 0.4622 4/11 [=========>....................] - ETA: 0s - loss: 0.2097 - accuracy: 0.4609 5/11 [============>.................] - ETA: 0s - loss: 0.2098 - accuracy: 0.4613 6/11 [===============>..............] - ETA: 0s - loss: 0.2087 - accuracy: 0.4647 7/11 [==================>...........] - ETA: 0s - loss: 0.2080 - accuracy: 0.4672 8/11 [====================>.........] - ETA: 0s - loss: 0.2075 - accuracy: 0.4700 9/11 [=======================>......] - ETA: 0s - loss: 0.2071 - accuracy: 0.472210/11 [==========================>...] - ETA: 0s - loss: 0.2070 - accuracy: 0.473511/11 [==============================] - ETA: 0s - loss: 0.2073 - accuracy: 0.474311/11 [==============================] - 1s 104ms/step - loss: 0.2075 - accuracy: 0.4750
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2129 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.2042 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.2048 - accuracy: 0.4931 4/11 [=========>....................] - ETA: 0s - loss: 0.2059 - accuracy: 0.4938 5/11 [============>.................] - ETA: 0s - loss: 0.2068 - accuracy: 0.4929 6/11 [===============>..............] - ETA: 0s - loss: 0.2070 - accuracy: 0.4897 7/11 [==================>...........] - ETA: 0s - loss: 0.2070 - accuracy: 0.4880 8/11 [====================>.........] - ETA: 0s - loss: 0.2069 - accuracy: 0.4874 9/11 [=======================>......] - ETA: 0s - loss: 0.2063 - accuracy: 0.487910/11 [==========================>...] - ETA: 0s - loss: 0.2059 - accuracy: 0.488811/11 [==============================] - ETA: 0s - loss: 0.2054 - accuracy: 0.489911/11 [==============================] - 1s 107ms/step - loss: 0.2050 - accuracy: 0.4909
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1635 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.1776 - accuracy: 0.5059 3/11 [=======>......................] - ETA: 0s - loss: 0.1825 - accuracy: 0.5056 4/11 [=========>....................] - ETA: 0s - loss: 0.1847 - accuracy: 0.5057 5/11 [============>.................] - ETA: 0s - loss: 0.1861 - accuracy: 0.5061 6/11 [===============>..............] - ETA: 0s - loss: 0.1868 - accuracy: 0.5086 7/11 [==================>...........] - ETA: 0s - loss: 0.1879 - accuracy: 0.5107 8/11 [====================>.........] - ETA: 0s - loss: 0.1886 - accuracy: 0.5128 9/11 [=======================>......] - ETA: 0s - loss: 0.1885 - accuracy: 0.515210/11 [==========================>...] - ETA: 0s - loss: 0.1885 - accuracy: 0.516911/11 [==============================] - ETA: 0s - loss: 0.1886 - accuracy: 0.518411/11 [==============================] - 1s 106ms/step - loss: 0.1886 - accuracy: 0.5197
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1594 - accuracy: 0.6094 2/11 [====>.........................] - ETA: 0s - loss: 0.1733 - accuracy: 0.5898 3/11 [=======>......................] - ETA: 0s - loss: 0.1773 - accuracy: 0.5781 4/11 [=========>....................] - ETA: 0s - loss: 0.1781 - accuracy: 0.5737 5/11 [============>.................] - ETA: 0s - loss: 0.1788 - accuracy: 0.5705 6/11 [===============>..............] - ETA: 0s - loss: 0.1794 - accuracy: 0.5694 7/11 [==================>...........] - ETA: 0s - loss: 0.1798 - accuracy: 0.5697 8/11 [====================>.........] - ETA: 0s - loss: 0.1800 - accuracy: 0.5702 9/11 [=======================>......] - ETA: 0s - loss: 0.1798 - accuracy: 0.570410/11 [==========================>...] - ETA: 0s - loss: 0.1797 - accuracy: 0.570911/11 [==============================] - ETA: 0s - loss: 0.1797 - accuracy: 0.571411/11 [==============================] - 1s 104ms/step - loss: 0.1797 - accuracy: 0.5718
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1838 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.1827 - accuracy: 0.6074 3/11 [=======>......................] - ETA: 0s - loss: 0.1830 - accuracy: 0.6098 4/11 [=========>....................] - ETA: 0s - loss: 0.1809 - accuracy: 0.6136 5/11 [============>.................] - ETA: 0s - loss: 0.1806 - accuracy: 0.6153 6/11 [===============>..............] - ETA: 0s - loss: 0.1800 - accuracy: 0.6154 7/11 [==================>...........] - ETA: 0s - loss: 0.1789 - accuracy: 0.6155 8/11 [====================>.........] - ETA: 0s - loss: 0.1784 - accuracy: 0.6147 9/11 [=======================>......] - ETA: 0s - loss: 0.1780 - accuracy: 0.614410/11 [==========================>...] - ETA: 0s - loss: 0.1774 - accuracy: 0.615111/11 [==============================] - ETA: 0s - loss: 0.1771 - accuracy: 0.615011/11 [==============================] - 1s 106ms/step - loss: 0.1768 - accuracy: 0.6149
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1554 - accuracy: 0.7188 2/11 [====>.........................] - ETA: 0s - loss: 0.1606 - accuracy: 0.7148 3/11 [=======>......................] - ETA: 0s - loss: 0.1656 - accuracy: 0.7188 4/11 [=========>....................] - ETA: 0s - loss: 0.1671 - accuracy: 0.7197 5/11 [============>.................] - ETA: 0s - loss: 0.1678 - accuracy: 0.7180 6/11 [===============>..............] - ETA: 0s - loss: 0.1677 - accuracy: 0.7153 7/11 [==================>...........] - ETA: 0s - loss: 0.1674 - accuracy: 0.7148 8/11 [====================>.........] - ETA: 0s - loss: 0.1674 - accuracy: 0.7147 9/11 [=======================>......] - ETA: 0s - loss: 0.1672 - accuracy: 0.714710/11 [==========================>...] - ETA: 0s - loss: 0.1669 - accuracy: 0.713811/11 [==============================] - ETA: 0s - loss: 0.1665 - accuracy: 0.713011/11 [==============================] - 1s 106ms/step - loss: 0.1662 - accuracy: 0.7123
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1407 - accuracy: 0.7031 2/11 [====>.........................] - ETA: 1s - loss: 0.1485 - accuracy: 0.6855 3/11 [=======>......................] - ETA: 0s - loss: 0.1477 - accuracy: 0.6905 4/11 [=========>....................] - ETA: 0s - loss: 0.1480 - accuracy: 0.6947 5/11 [============>.................] - ETA: 0s - loss: 0.1488 - accuracy: 0.6954 6/11 [===============>..............] - ETA: 0s - loss: 0.1493 - accuracy: 0.6971 7/11 [==================>...........] - ETA: 0s - loss: 0.1504 - accuracy: 0.6978 8/11 [====================>.........] - ETA: 0s - loss: 0.1514 - accuracy: 0.6991 9/11 [=======================>......] - ETA: 0s - loss: 0.1520 - accuracy: 0.700110/11 [==========================>...] - ETA: 0s - loss: 0.1528 - accuracy: 0.701511/11 [==============================] - ETA: 0s - loss: 0.1533 - accuracy: 0.702611/11 [==============================] - 1s 112ms/step - loss: 0.1538 - accuracy: 0.7035
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1495 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 0s - loss: 0.1471 - accuracy: 0.7637 3/11 [=======>......................] - ETA: 0s - loss: 0.1468 - accuracy: 0.7582 4/11 [=========>....................] - ETA: 0s - loss: 0.1487 - accuracy: 0.7562 5/11 [============>.................] - ETA: 0s - loss: 0.1504 - accuracy: 0.7549 6/11 [===============>..............] - ETA: 0s - loss: 0.1514 - accuracy: 0.7543 7/11 [==================>...........] - ETA: 0s - loss: 0.1518 - accuracy: 0.7534 8/11 [====================>.........] - ETA: 0s - loss: 0.1523 - accuracy: 0.7531 9/11 [=======================>......] - ETA: 0s - loss: 0.1528 - accuracy: 0.752610/11 [==========================>...] - ETA: 0s - loss: 0.1529 - accuracy: 0.752011/11 [==============================] - ETA: 0s - loss: 0.1530 - accuracy: 0.751411/11 [==============================] - 1s 105ms/step - loss: 0.1530 - accuracy: 0.7509
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1262 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.1267 - accuracy: 0.7852 3/11 [=======>......................] - ETA: 0s - loss: 0.1310 - accuracy: 0.7856 4/11 [=========>....................] - ETA: 0s - loss: 0.1343 - accuracy: 0.7865 5/11 [============>.................] - ETA: 0s - loss: 0.1368 - accuracy: 0.7854 6/11 [===============>..............] - ETA: 0s - loss: 0.1381 - accuracy: 0.7852 7/11 [==================>...........] - ETA: 0s - loss: 0.1393 - accuracy: 0.7838 8/11 [====================>.........] - ETA: 0s - loss: 0.1400 - accuracy: 0.7827 9/11 [=======================>......] - ETA: 0s - loss: 0.1405 - accuracy: 0.781810/11 [==========================>...] - ETA: 0s - loss: 0.1409 - accuracy: 0.781111/11 [==============================] - ETA: 0s - loss: 0.1415 - accuracy: 0.780011/11 [==============================] - 1s 115ms/step - loss: 0.1421 - accuracy: 0.7790
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1397 - accuracy: 0.7422 2/11 [====>.........................] - ETA: 1s - loss: 0.1417 - accuracy: 0.7734 3/11 [=======>......................] - ETA: 0s - loss: 0.1484 - accuracy: 0.7934 4/11 [=========>....................] - ETA: 0s - loss: 0.1566 - accuracy: 0.8001 5/11 [============>.................] - ETA: 0s - loss: 0.1635 - accuracy: 0.8060 6/11 [===============>..............] - ETA: 0s - loss: 0.1686 - accuracy: 0.8102 7/11 [==================>...........] - ETA: 0s - loss: 0.1728 - accuracy: 0.8127 8/11 [====================>.........] - ETA: 0s - loss: 0.1766 - accuracy: 0.8142 9/11 [=======================>......] - ETA: 0s - loss: 0.1802 - accuracy: 0.814710/11 [==========================>...] - ETA: 0s - loss: 0.1830 - accuracy: 0.815011/11 [==============================] - ETA: 0s - loss: 0.1852 - accuracy: 0.815611/11 [==============================] - 1s 108ms/step - loss: 0.1870 - accuracy: 0.8161
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.1886 - accuracy: 0.83593/6 [==============>...............] - ETA: 0s - loss: 0.1982 - accuracy: 0.8281 5/6 [========================>.....] - ETA: 0s - loss: 0.1965 - accuracy: 0.82666/6 [==============================] - 4s 29ms/step - loss: 0.1958 - accuracy: 0.8286
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [-0.66259146  0.6459391   0.8759905  -0.32037455 -0.5621574 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [-0.22166367  0.7575834   0.64679915 -0.28830805 -0.44308916]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 2 0 1] pred: [-0.13386667 -0.3252697  -0.02902753  0.407956    0.31091177]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [-0.4349986  0.926946   0.8403625 -0.6740454 -0.6860126]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 4 3] pred: [ 0.12037966  0.8692785   0.5053303  -0.43266016 -0.43011618]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 4 3] pred: [ 0.16300827  0.90148145  0.5100302  -0.52703416 -0.46765217]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [-0.87533617 -0.1223357   0.95253175 -0.47552606 -0.5627816 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 3 0] pred: [-0.9312766   0.4440907   0.9726108  -0.82112044 -0.8047387 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 3 0] pred: [-0.91200197  0.7582411   0.97922003 -0.9054668  -0.8510113 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [-0.32773343  0.87946856  0.7450209  -0.4417112  -0.55570555]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [-0.7530422  0.4108746  0.899917  -0.4673871 -0.5619378]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [-0.53362006  0.39746585  0.7779958  -0.20580605 -0.36236456]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [ 0.01493805  0.74346566  0.40980518 -0.2703997  -0.35982564]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [3 2 4 1 0] pred: [-0.27303183 -0.13546436  0.22794193  0.47252786  0.08515928]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [-0.28336158  0.8529544   0.6553476  -0.40711355 -0.52735806]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
Job end at lun déc 13 23:52:02 CET 2021
