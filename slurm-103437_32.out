
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at lun déc 13 23:45:07 CET 2021
2021-12-13 23:45:08.362971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-13 23:45:13.644722: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:45:13.646283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-13 23:45:13.658619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:45:13.658657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:45:13.662035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:45:13.662081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:45:13.664691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:45:13.665615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:45:13.669063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:45:13.670762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:45:13.676748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:45:13.678132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:45:13.713500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:45:13.713539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:45:13.713549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-13 23:45:15.298385: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:45:15.299727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:45:15.299775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:45:15.299862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:45:15.299903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:45:15.299975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:45:15.300022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:45:15.300093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:45:15.300161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:45:15.300256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:45:15.301403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:45:15.302216: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:45:15.302237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:45:15.302246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2021-12-13 23:45:15.302350: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-13 23:45:18.353761: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-13 23:45:18.354402: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2593595000 Hz
Number of possible configurations: 40
Begining exécution of the 32 th configuration: BPIC20.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and bin_ce-logits as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 58)          3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                21360     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:58 - loss: 0.6894 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.6886 - accuracy: 0.4609   3/11 [=======>......................] - ETA: 0s - loss: 0.6876 - accuracy: 0.4583 4/11 [=========>....................] - ETA: 0s - loss: 0.6866 - accuracy: 0.4521 5/11 [============>.................] - ETA: 0s - loss: 0.6855 - accuracy: 0.4477 6/11 [===============>..............] - ETA: 0s - loss: 0.6844 - accuracy: 0.4466 7/11 [==================>...........] - ETA: 0s - loss: 0.6832 - accuracy: 0.4471 8/11 [====================>.........] - ETA: 0s - loss: 0.6820 - accuracy: 0.4477 9/11 [=======================>......] - ETA: 0s - loss: 0.6808 - accuracy: 0.448110/11 [==========================>...] - ETA: 0s - loss: 0.6795 - accuracy: 0.449311/11 [==============================] - ETA: 0s - loss: 0.6783 - accuracy: 0.449911/11 [==============================] - 13s 103ms/step - loss: 0.6773 - accuracy: 0.4503
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6274 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.6264 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.6248 - accuracy: 0.4939 4/11 [=========>....................] - ETA: 0s - loss: 0.6226 - accuracy: 0.4935 5/11 [============>.................] - ETA: 0s - loss: 0.6203 - accuracy: 0.4932 6/11 [===============>..............] - ETA: 0s - loss: 0.6182 - accuracy: 0.4918 7/11 [==================>...........] - ETA: 0s - loss: 0.6160 - accuracy: 0.4896 8/11 [====================>.........] - ETA: 0s - loss: 0.6137 - accuracy: 0.4869 9/11 [=======================>......] - ETA: 0s - loss: 0.6114 - accuracy: 0.483910/11 [==========================>...] - ETA: 0s - loss: 0.6092 - accuracy: 0.480811/11 [==============================] - ETA: 0s - loss: 0.6071 - accuracy: 0.478211/11 [==============================] - 1s 100ms/step - loss: 0.6053 - accuracy: 0.4761
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5207 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.5184 - accuracy: 0.4316 3/11 [=======>......................] - ETA: 0s - loss: 0.5162 - accuracy: 0.4319 4/11 [=========>....................] - ETA: 0s - loss: 0.5130 - accuracy: 0.4352 5/11 [============>.................] - ETA: 0s - loss: 0.5108 - accuracy: 0.4372 6/11 [===============>..............] - ETA: 0s - loss: 0.5088 - accuracy: 0.4392 7/11 [==================>...........] - ETA: 0s - loss: 0.5072 - accuracy: 0.4414 8/11 [====================>.........] - ETA: 0s - loss: 0.5060 - accuracy: 0.4424 9/11 [=======================>......] - ETA: 0s - loss: 0.5045 - accuracy: 0.444310/11 [==========================>...] - ETA: 0s - loss: 0.5034 - accuracy: 0.445411/11 [==============================] - ETA: 0s - loss: 0.5024 - accuracy: 0.446011/11 [==============================] - 1s 100ms/step - loss: 0.5015 - accuracy: 0.4466
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4759 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.4714 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 0s - loss: 0.4727 - accuracy: 0.4701 4/11 [=========>....................] - ETA: 0s - loss: 0.4739 - accuracy: 0.4673 5/11 [============>.................] - ETA: 0s - loss: 0.4748 - accuracy: 0.4641 6/11 [===============>..............] - ETA: 0s - loss: 0.4750 - accuracy: 0.4634 7/11 [==================>...........] - ETA: 0s - loss: 0.4748 - accuracy: 0.4637 8/11 [====================>.........] - ETA: 0s - loss: 0.4741 - accuracy: 0.4637 9/11 [=======================>......] - ETA: 0s - loss: 0.4739 - accuracy: 0.463410/11 [==========================>...] - ETA: 0s - loss: 0.4739 - accuracy: 0.463111/11 [==============================] - ETA: 0s - loss: 0.4742 - accuracy: 0.462211/11 [==============================] - 1s 106ms/step - loss: 0.4744 - accuracy: 0.4614
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4750 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.4692 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.4695 - accuracy: 0.4735 4/11 [=========>....................] - ETA: 0s - loss: 0.4722 - accuracy: 0.4635 5/11 [============>.................] - ETA: 0s - loss: 0.4727 - accuracy: 0.4618 6/11 [===============>..............] - ETA: 0s - loss: 0.4722 - accuracy: 0.4629 7/11 [==================>...........] - ETA: 0s - loss: 0.4719 - accuracy: 0.4633 8/11 [====================>.........] - ETA: 0s - loss: 0.4717 - accuracy: 0.4637 9/11 [=======================>......] - ETA: 0s - loss: 0.4715 - accuracy: 0.463410/11 [==========================>...] - ETA: 0s - loss: 0.4713 - accuracy: 0.462911/11 [==============================] - ETA: 0s - loss: 0.4715 - accuracy: 0.461911/11 [==============================] - 1s 101ms/step - loss: 0.4716 - accuracy: 0.4611
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4731 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.4747 - accuracy: 0.4238 3/11 [=======>......................] - ETA: 0s - loss: 0.4740 - accuracy: 0.4249 4/11 [=========>....................] - ETA: 0s - loss: 0.4720 - accuracy: 0.4344 5/11 [============>.................] - ETA: 0s - loss: 0.4715 - accuracy: 0.4382 6/11 [===============>..............] - ETA: 0s - loss: 0.4707 - accuracy: 0.4422 7/11 [==================>...........] - ETA: 0s - loss: 0.4697 - accuracy: 0.4460 8/11 [====================>.........] - ETA: 0s - loss: 0.4692 - accuracy: 0.4482 9/11 [=======================>......] - ETA: 0s - loss: 0.4688 - accuracy: 0.449810/11 [==========================>...] - ETA: 0s - loss: 0.4687 - accuracy: 0.450111/11 [==============================] - ETA: 0s - loss: 0.4686 - accuracy: 0.450311/11 [==============================] - 1s 99ms/step - loss: 0.4686 - accuracy: 0.4505
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4512 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.4555 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 0s - loss: 0.4555 - accuracy: 0.4718 4/11 [=========>....................] - ETA: 0s - loss: 0.4562 - accuracy: 0.4744 5/11 [============>.................] - ETA: 0s - loss: 0.4560 - accuracy: 0.4752 6/11 [===============>..............] - ETA: 0s - loss: 0.4566 - accuracy: 0.4737 7/11 [==================>...........] - ETA: 0s - loss: 0.4567 - accuracy: 0.4727 8/11 [====================>.........] - ETA: 0s - loss: 0.4570 - accuracy: 0.4714 9/11 [=======================>......] - ETA: 0s - loss: 0.4573 - accuracy: 0.469310/11 [==========================>...] - ETA: 0s - loss: 0.4575 - accuracy: 0.467711/11 [==============================] - ETA: 0s - loss: 0.4576 - accuracy: 0.466311/11 [==============================] - 1s 102ms/step - loss: 0.4576 - accuracy: 0.4652
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4432 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.4457 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.4477 - accuracy: 0.4418 4/11 [=========>....................] - ETA: 0s - loss: 0.4480 - accuracy: 0.4481 5/11 [============>.................] - ETA: 0s - loss: 0.4478 - accuracy: 0.4522 6/11 [===============>..............] - ETA: 0s - loss: 0.4478 - accuracy: 0.4543 7/11 [==================>...........] - ETA: 0s - loss: 0.4477 - accuracy: 0.4562 8/11 [====================>.........] - ETA: 0s - loss: 0.4475 - accuracy: 0.4584 9/11 [=======================>......] - ETA: 0s - loss: 0.4472 - accuracy: 0.460010/11 [==========================>...] - ETA: 0s - loss: 0.4469 - accuracy: 0.460711/11 [==============================] - ETA: 0s - loss: 0.4466 - accuracy: 0.461911/11 [==============================] - 1s 104ms/step - loss: 0.4463 - accuracy: 0.4629
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4364 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.4355 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.4356 - accuracy: 0.5052 4/11 [=========>....................] - ETA: 0s - loss: 0.4360 - accuracy: 0.5073 5/11 [============>.................] - ETA: 0s - loss: 0.4358 - accuracy: 0.5115 6/11 [===============>..............] - ETA: 0s - loss: 0.4354 - accuracy: 0.5163 7/11 [==================>...........] - ETA: 0s - loss: 0.4347 - accuracy: 0.5199 8/11 [====================>.........] - ETA: 0s - loss: 0.4340 - accuracy: 0.5219 9/11 [=======================>......] - ETA: 0s - loss: 0.4334 - accuracy: 0.523710/11 [==========================>...] - ETA: 0s - loss: 0.4329 - accuracy: 0.525211/11 [==============================] - ETA: 0s - loss: 0.4323 - accuracy: 0.527411/11 [==============================] - 1s 97ms/step - loss: 0.4318 - accuracy: 0.5292
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4268 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 1s - loss: 0.4237 - accuracy: 0.5527 3/11 [=======>......................] - ETA: 0s - loss: 0.4219 - accuracy: 0.5664 4/11 [=========>....................] - ETA: 0s - loss: 0.4200 - accuracy: 0.5767 5/11 [============>.................] - ETA: 0s - loss: 0.4195 - accuracy: 0.5832 6/11 [===============>..............] - ETA: 0s - loss: 0.4193 - accuracy: 0.5889 7/11 [==================>...........] - ETA: 0s - loss: 0.4188 - accuracy: 0.5956 8/11 [====================>.........] - ETA: 0s - loss: 0.4180 - accuracy: 0.6001 9/11 [=======================>......] - ETA: 0s - loss: 0.4174 - accuracy: 0.603310/11 [==========================>...] - ETA: 0s - loss: 0.4169 - accuracy: 0.604811/11 [==============================] - ETA: 0s - loss: 0.4166 - accuracy: 0.605411/11 [==============================] - 1s 102ms/step - loss: 0.4163 - accuracy: 0.6059
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4015 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.4065 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.4080 - accuracy: 0.6137 4/11 [=========>....................] - ETA: 0s - loss: 0.4081 - accuracy: 0.6136 5/11 [============>.................] - ETA: 0s - loss: 0.4079 - accuracy: 0.6118 6/11 [===============>..............] - ETA: 0s - loss: 0.4073 - accuracy: 0.6097 7/11 [==================>...........] - ETA: 0s - loss: 0.4069 - accuracy: 0.6087 8/11 [====================>.........] - ETA: 0s - loss: 0.4066 - accuracy: 0.6099 9/11 [=======================>......] - ETA: 0s - loss: 0.4064 - accuracy: 0.611610/11 [==========================>...] - ETA: 0s - loss: 0.4061 - accuracy: 0.614511/11 [==============================] - ETA: 0s - loss: 0.4059 - accuracy: 0.617011/11 [==============================] - 1s 100ms/step - loss: 0.4057 - accuracy: 0.6190
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3961 - accuracy: 0.6797 2/11 [====>.........................] - ETA: 0s - loss: 0.4001 - accuracy: 0.6621 3/11 [=======>......................] - ETA: 0s - loss: 0.4000 - accuracy: 0.6532 4/11 [=========>....................] - ETA: 0s - loss: 0.3998 - accuracy: 0.6491 5/11 [============>.................] - ETA: 0s - loss: 0.3991 - accuracy: 0.6455 6/11 [===============>..............] - ETA: 0s - loss: 0.3987 - accuracy: 0.6401 7/11 [==================>...........] - ETA: 0s - loss: 0.3986 - accuracy: 0.6359 8/11 [====================>.........] - ETA: 0s - loss: 0.3987 - accuracy: 0.6321 9/11 [=======================>......] - ETA: 0s - loss: 0.3986 - accuracy: 0.628710/11 [==========================>...] - ETA: 0s - loss: 0.3984 - accuracy: 0.626211/11 [==============================] - ETA: 0s - loss: 0.3982 - accuracy: 0.624611/11 [==============================] - 1s 99ms/step - loss: 0.3980 - accuracy: 0.6233
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3982 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 1s - loss: 0.3961 - accuracy: 0.7012 3/11 [=======>......................] - ETA: 1s - loss: 0.3955 - accuracy: 0.7140 4/11 [=========>....................] - ETA: 0s - loss: 0.3949 - accuracy: 0.7215 5/11 [============>.................] - ETA: 0s - loss: 0.3938 - accuracy: 0.7275 6/11 [===============>..............] - ETA: 0s - loss: 0.3934 - accuracy: 0.7302 7/11 [==================>...........] - ETA: 0s - loss: 0.3930 - accuracy: 0.7317 8/11 [====================>.........] - ETA: 0s - loss: 0.3928 - accuracy: 0.7326 9/11 [=======================>......] - ETA: 0s - loss: 0.3926 - accuracy: 0.733410/11 [==========================>...] - ETA: 0s - loss: 0.3924 - accuracy: 0.734211/11 [==============================] - ETA: 0s - loss: 0.3922 - accuracy: 0.734911/11 [==============================] - 1s 103ms/step - loss: 0.3920 - accuracy: 0.7355
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3912 - accuracy: 0.7500 2/11 [====>.........................] - ETA: 0s - loss: 0.3901 - accuracy: 0.7559 3/11 [=======>......................] - ETA: 0s - loss: 0.3902 - accuracy: 0.7461 4/11 [=========>....................] - ETA: 0s - loss: 0.3902 - accuracy: 0.7334 5/11 [============>.................] - ETA: 0s - loss: 0.3896 - accuracy: 0.7248 6/11 [===============>..............] - ETA: 0s - loss: 0.3895 - accuracy: 0.7195 7/11 [==================>...........] - ETA: 0s - loss: 0.3891 - accuracy: 0.7151 8/11 [====================>.........] - ETA: 0s - loss: 0.3887 - accuracy: 0.7116 9/11 [=======================>......] - ETA: 0s - loss: 0.3883 - accuracy: 0.709410/11 [==========================>...] - ETA: 0s - loss: 0.3879 - accuracy: 0.709311/11 [==============================] - ETA: 0s - loss: 0.3876 - accuracy: 0.709711/11 [==============================] - 1s 97ms/step - loss: 0.3874 - accuracy: 0.7101
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3818 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 0s - loss: 0.3806 - accuracy: 0.8359 3/11 [=======>......................] - ETA: 0s - loss: 0.3802 - accuracy: 0.8403 4/11 [=========>....................] - ETA: 0s - loss: 0.3800 - accuracy: 0.8416 5/11 [============>.................] - ETA: 0s - loss: 0.3799 - accuracy: 0.8377 6/11 [===============>..............] - ETA: 0s - loss: 0.3800 - accuracy: 0.8298 7/11 [==================>...........] - ETA: 0s - loss: 0.3804 - accuracy: 0.8211 8/11 [====================>.........] - ETA: 0s - loss: 0.3805 - accuracy: 0.8143 9/11 [=======================>......] - ETA: 0s - loss: 0.3806 - accuracy: 0.809710/11 [==========================>...] - ETA: 0s - loss: 0.3804 - accuracy: 0.806011/11 [==============================] - ETA: 0s - loss: 0.3802 - accuracy: 0.803111/11 [==============================] - 1s 100ms/step - loss: 0.3800 - accuracy: 0.8007
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3599 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.3635 - accuracy: 0.7559 3/11 [=======>......................] - ETA: 0s - loss: 0.3646 - accuracy: 0.7452 4/11 [=========>....................] - ETA: 0s - loss: 0.3657 - accuracy: 0.7362 5/11 [============>.................] - ETA: 0s - loss: 0.3663 - accuracy: 0.7280 6/11 [===============>..............] - ETA: 0s - loss: 0.3671 - accuracy: 0.7212 7/11 [==================>...........] - ETA: 0s - loss: 0.3677 - accuracy: 0.7177 8/11 [====================>.........] - ETA: 0s - loss: 0.3680 - accuracy: 0.7158 9/11 [=======================>......] - ETA: 0s - loss: 0.3684 - accuracy: 0.713510/11 [==========================>...] - ETA: 0s - loss: 0.3687 - accuracy: 0.712311/11 [==============================] - ETA: 0s - loss: 0.3689 - accuracy: 0.711411/11 [==============================] - 1s 103ms/step - loss: 0.3691 - accuracy: 0.7107
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3690 - accuracy: 0.7109 2/11 [====>.........................] - ETA: 0s - loss: 0.3705 - accuracy: 0.7129 3/11 [=======>......................] - ETA: 0s - loss: 0.3693 - accuracy: 0.7131 4/11 [=========>....................] - ETA: 0s - loss: 0.3689 - accuracy: 0.7170 5/11 [============>.................] - ETA: 0s - loss: 0.3686 - accuracy: 0.7198 6/11 [===============>..............] - ETA: 0s - loss: 0.3682 - accuracy: 0.7253 7/11 [==================>...........] - ETA: 0s - loss: 0.3681 - accuracy: 0.7306 8/11 [====================>.........] - ETA: 0s - loss: 0.3679 - accuracy: 0.7358 9/11 [=======================>......] - ETA: 0s - loss: 0.3676 - accuracy: 0.740810/11 [==========================>...] - ETA: 0s - loss: 0.3674 - accuracy: 0.744611/11 [==============================] - ETA: 0s - loss: 0.3673 - accuracy: 0.747711/11 [==============================] - 1s 99ms/step - loss: 0.3671 - accuracy: 0.7502
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3653 - accuracy: 0.7500 2/11 [====>.........................] - ETA: 0s - loss: 0.3643 - accuracy: 0.7383 3/11 [=======>......................] - ETA: 0s - loss: 0.3638 - accuracy: 0.7361 4/11 [=========>....................] - ETA: 0s - loss: 0.3642 - accuracy: 0.7347 5/11 [============>.................] - ETA: 0s - loss: 0.3640 - accuracy: 0.7365 6/11 [===============>..............] - ETA: 0s - loss: 0.3637 - accuracy: 0.7394 7/11 [==================>...........] - ETA: 0s - loss: 0.3635 - accuracy: 0.7433 8/11 [====================>.........] - ETA: 0s - loss: 0.3633 - accuracy: 0.7466 9/11 [=======================>......] - ETA: 0s - loss: 0.3630 - accuracy: 0.750210/11 [==========================>...] - ETA: 0s - loss: 0.3628 - accuracy: 0.754011/11 [==============================] - ETA: 0s - loss: 0.3626 - accuracy: 0.757011/11 [==============================] - 1s 98ms/step - loss: 0.3625 - accuracy: 0.7595
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3497 - accuracy: 0.6797 2/11 [====>.........................] - ETA: 1s - loss: 0.3532 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 0s - loss: 0.3556 - accuracy: 0.6884 4/11 [=========>....................] - ETA: 0s - loss: 0.3561 - accuracy: 0.6911 5/11 [============>.................] - ETA: 0s - loss: 0.3560 - accuracy: 0.6919 6/11 [===============>..............] - ETA: 0s - loss: 0.3560 - accuracy: 0.6923 7/11 [==================>...........] - ETA: 0s - loss: 0.3560 - accuracy: 0.6941 8/11 [====================>.........] - ETA: 0s - loss: 0.3559 - accuracy: 0.6976 9/11 [=======================>......] - ETA: 0s - loss: 0.3559 - accuracy: 0.701510/11 [==========================>...] - ETA: 0s - loss: 0.3559 - accuracy: 0.706311/11 [==============================] - ETA: 0s - loss: 0.3559 - accuracy: 0.711011/11 [==============================] - 1s 100ms/step - loss: 0.3559 - accuracy: 0.7149
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3574 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 0s - loss: 0.3563 - accuracy: 0.8770 3/11 [=======>......................] - ETA: 0s - loss: 0.3556 - accuracy: 0.8702 4/11 [=========>....................] - ETA: 0s - loss: 0.3548 - accuracy: 0.8641 5/11 [============>.................] - ETA: 0s - loss: 0.3543 - accuracy: 0.8538 6/11 [===============>..............] - ETA: 0s - loss: 0.3540 - accuracy: 0.8445 7/11 [==================>...........] - ETA: 0s - loss: 0.3538 - accuracy: 0.8353 8/11 [====================>.........] - ETA: 0s - loss: 0.3537 - accuracy: 0.8257 9/11 [=======================>......] - ETA: 0s - loss: 0.3535 - accuracy: 0.818510/11 [==========================>...] - ETA: 0s - loss: 0.3533 - accuracy: 0.813411/11 [==============================] - ETA: 0s - loss: 0.3532 - accuracy: 0.809911/11 [==============================] - 1s 97ms/step - loss: 0.3531 - accuracy: 0.8070
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.3500 - accuracy: 0.85943/6 [==============>...............] - ETA: 0s - loss: 0.3589 - accuracy: 0.8490 5/6 [========================>.....] - ETA: 0s - loss: 0.3557 - accuracy: 0.87036/6 [==============================] - 4s 29ms/step - loss: 0.3556 - accuracy: 0.8754
2021-12-13 23:46:00.536149: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:46:00.537175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:46:00.537245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:46:00.537351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:46:00.537394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:46:00.537431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:46:00.537523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:46:00.537567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:46:00.537603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:46:00.537696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:46:00.539093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:46:00.539143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:46:00.539157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:46:00.539168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 4 3 0] pred: [-0.99989593 -0.99536127  0.9934459  -0.99962944 -0.9996167 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 3 0 4] pred: [-0.997938    0.9861712   0.7349638  -0.9978577  -0.99992406]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [-0.99465275  0.9276901   0.90495884 -0.9977545  -0.99997705]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 0 2 1] pred: [-0.9290481  -0.99195653 -0.98933375  0.7181325  -0.82430446]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [-0.99907905  0.95919585  0.9875883  -0.99907446 -0.99998343]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 3 0] pred: [-0.9998781  -0.99502623  0.9966413  -0.9997018  -0.9996437 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [-0.99828917  0.96348757  0.95571405 -0.998648   -0.999972  ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [-0.9998792 -0.9849867  0.9937027 -0.9996795 -0.9997405]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 3 0] pred: [-0.99987423 -0.99350905  0.9911879  -0.9996217  -0.99959034]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [-0.9998895  -0.994629    0.99194527 -0.999555   -0.9996159 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 4 3 0] pred: [-0.999854   -0.99213564  0.9768029  -0.99944854 -0.9994269 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 3 0 4] pred: [-0.9807368   0.6520483   0.60973763 -0.9793597  -0.99987745]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 3 0] pred: [-0.99982333 -0.98989576  0.96684504 -0.9994199  -0.9993661 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [-0.9961439   0.97557366  0.8594888  -0.99850863 -0.99996716]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 0 2 1] pred: [-0.9845935 -0.9976497 -0.9925885  0.7664669 -0.7986967]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:04 - loss: 0.6927 - accuracy: 0.2422 2/11 [====>.........................] - ETA: 0s - loss: 0.6917 - accuracy: 0.2871   3/11 [=======>......................] - ETA: 0s - loss: 0.6906 - accuracy: 0.3190 4/11 [=========>....................] - ETA: 0s - loss: 0.6896 - accuracy: 0.3423 5/11 [============>.................] - ETA: 0s - loss: 0.6885 - accuracy: 0.3591 6/11 [===============>..............] - ETA: 0s - loss: 0.6875 - accuracy: 0.3720 7/11 [==================>...........] - ETA: 0s - loss: 0.6864 - accuracy: 0.3820 8/11 [====================>.........] - ETA: 0s - loss: 0.6853 - accuracy: 0.3905 9/11 [=======================>......] - ETA: 0s - loss: 0.6842 - accuracy: 0.397910/11 [==========================>...] - ETA: 0s - loss: 0.6830 - accuracy: 0.403211/11 [==============================] - ETA: 0s - loss: 0.6820 - accuracy: 0.407211/11 [==============================] - 14s 103ms/step - loss: 0.6811 - accuracy: 0.4106
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6342 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.6331 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 0s - loss: 0.6319 - accuracy: 0.5035 4/11 [=========>....................] - ETA: 0s - loss: 0.6302 - accuracy: 0.5002 5/11 [============>.................] - ETA: 0s - loss: 0.6283 - accuracy: 0.4979 6/11 [===============>..............] - ETA: 0s - loss: 0.6263 - accuracy: 0.4959 7/11 [==================>...........] - ETA: 0s - loss: 0.6243 - accuracy: 0.4933 8/11 [====================>.........] - ETA: 0s - loss: 0.6222 - accuracy: 0.4908 9/11 [=======================>......] - ETA: 0s - loss: 0.6200 - accuracy: 0.489410/11 [==========================>...] - ETA: 0s - loss: 0.6176 - accuracy: 0.488111/11 [==============================] - ETA: 0s - loss: 0.6154 - accuracy: 0.486511/11 [==============================] - 1s 104ms/step - loss: 0.6135 - accuracy: 0.4852
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5271 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.5252 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.5217 - accuracy: 0.4444 4/11 [=========>....................] - ETA: 0s - loss: 0.5182 - accuracy: 0.4520 5/11 [============>.................] - ETA: 0s - loss: 0.5154 - accuracy: 0.4550 6/11 [===============>..............] - ETA: 0s - loss: 0.5129 - accuracy: 0.4582 7/11 [==================>...........] - ETA: 0s - loss: 0.5108 - accuracy: 0.4602 8/11 [====================>.........] - ETA: 0s - loss: 0.5090 - accuracy: 0.4611 9/11 [=======================>......] - ETA: 0s - loss: 0.5075 - accuracy: 0.461910/11 [==========================>...] - ETA: 0s - loss: 0.5060 - accuracy: 0.462411/11 [==============================] - ETA: 0s - loss: 0.5046 - accuracy: 0.463211/11 [==============================] - 1s 99ms/step - loss: 0.5035 - accuracy: 0.4638
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4813 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.4787 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 0s - loss: 0.4785 - accuracy: 0.4666 4/11 [=========>....................] - ETA: 0s - loss: 0.4763 - accuracy: 0.4705 5/11 [============>.................] - ETA: 0s - loss: 0.4748 - accuracy: 0.4727 6/11 [===============>..............] - ETA: 0s - loss: 0.4747 - accuracy: 0.4714 7/11 [==================>...........] - ETA: 0s - loss: 0.4743 - accuracy: 0.4715 8/11 [====================>.........] - ETA: 0s - loss: 0.4738 - accuracy: 0.4724 9/11 [=======================>......] - ETA: 0s - loss: 0.4736 - accuracy: 0.472610/11 [==========================>...] - ETA: 0s - loss: 0.4736 - accuracy: 0.472511/11 [==============================] - ETA: 0s - loss: 0.4735 - accuracy: 0.472311/11 [==============================] - 1s 98ms/step - loss: 0.4735 - accuracy: 0.4722
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4914 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.4884 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.4837 - accuracy: 0.4184 4/11 [=========>....................] - ETA: 0s - loss: 0.4819 - accuracy: 0.4251 5/11 [============>.................] - ETA: 0s - loss: 0.4802 - accuracy: 0.4301 6/11 [===============>..............] - ETA: 0s - loss: 0.4787 - accuracy: 0.4348 7/11 [==================>...........] - ETA: 0s - loss: 0.4782 - accuracy: 0.4373 8/11 [====================>.........] - ETA: 0s - loss: 0.4776 - accuracy: 0.4394 9/11 [=======================>......] - ETA: 0s - loss: 0.4769 - accuracy: 0.442010/11 [==========================>...] - ETA: 0s - loss: 0.4763 - accuracy: 0.444411/11 [==============================] - ETA: 0s - loss: 0.4757 - accuracy: 0.446811/11 [==============================] - 1s 99ms/step - loss: 0.4753 - accuracy: 0.4488
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4819 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.4767 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 0s - loss: 0.4758 - accuracy: 0.4479 4/11 [=========>....................] - ETA: 0s - loss: 0.4748 - accuracy: 0.4497 5/11 [============>.................] - ETA: 0s - loss: 0.4736 - accuracy: 0.4516 6/11 [===============>..............] - ETA: 0s - loss: 0.4725 - accuracy: 0.4543 7/11 [==================>...........] - ETA: 0s - loss: 0.4716 - accuracy: 0.4571 8/11 [====================>.........] - ETA: 0s - loss: 0.4708 - accuracy: 0.4587 9/11 [=======================>......] - ETA: 0s - loss: 0.4702 - accuracy: 0.459810/11 [==========================>...] - ETA: 0s - loss: 0.4695 - accuracy: 0.461111/11 [==============================] - ETA: 0s - loss: 0.4690 - accuracy: 0.462011/11 [==============================] - 1s 101ms/step - loss: 0.4686 - accuracy: 0.4627
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4693 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.4673 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.4644 - accuracy: 0.4436 4/11 [=========>....................] - ETA: 0s - loss: 0.4628 - accuracy: 0.4523 5/11 [============>.................] - ETA: 0s - loss: 0.4620 - accuracy: 0.4559 6/11 [===============>..............] - ETA: 0s - loss: 0.4616 - accuracy: 0.4594 7/11 [==================>...........] - ETA: 0s - loss: 0.4613 - accuracy: 0.4613 8/11 [====================>.........] - ETA: 0s - loss: 0.4607 - accuracy: 0.4637 9/11 [=======================>......] - ETA: 0s - loss: 0.4602 - accuracy: 0.465110/11 [==========================>...] - ETA: 0s - loss: 0.4598 - accuracy: 0.465811/11 [==============================] - ETA: 0s - loss: 0.4595 - accuracy: 0.466511/11 [==============================] - 1s 106ms/step - loss: 0.4592 - accuracy: 0.4671
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4428 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.4438 - accuracy: 0.5215 3/11 [=======>......................] - ETA: 0s - loss: 0.4440 - accuracy: 0.5135 4/11 [=========>....................] - ETA: 0s - loss: 0.4445 - accuracy: 0.5057 5/11 [============>.................] - ETA: 0s - loss: 0.4446 - accuracy: 0.5008 6/11 [===============>..............] - ETA: 0s - loss: 0.4450 - accuracy: 0.4944 7/11 [==================>...........] - ETA: 0s - loss: 0.4450 - accuracy: 0.4906 8/11 [====================>.........] - ETA: 0s - loss: 0.4450 - accuracy: 0.4875 9/11 [=======================>......] - ETA: 0s - loss: 0.4449 - accuracy: 0.486110/11 [==========================>...] - ETA: 0s - loss: 0.4449 - accuracy: 0.484911/11 [==============================] - ETA: 0s - loss: 0.4448 - accuracy: 0.484111/11 [==============================] - 1s 100ms/step - loss: 0.4447 - accuracy: 0.4834
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4379 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.4362 - accuracy: 0.5430 3/11 [=======>......................] - ETA: 0s - loss: 0.4351 - accuracy: 0.5365 4/11 [=========>....................] - ETA: 0s - loss: 0.4355 - accuracy: 0.5269 5/11 [============>.................] - ETA: 0s - loss: 0.4349 - accuracy: 0.5240 6/11 [===============>..............] - ETA: 0s - loss: 0.4345 - accuracy: 0.5202 7/11 [==================>...........] - ETA: 0s - loss: 0.4341 - accuracy: 0.5167 8/11 [====================>.........] - ETA: 0s - loss: 0.4335 - accuracy: 0.5136 9/11 [=======================>......] - ETA: 0s - loss: 0.4330 - accuracy: 0.511510/11 [==========================>...] - ETA: 0s - loss: 0.4325 - accuracy: 0.509211/11 [==============================] - ETA: 0s - loss: 0.4319 - accuracy: 0.508411/11 [==============================] - 1s 98ms/step - loss: 0.4314 - accuracy: 0.5077
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4288 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.4296 - accuracy: 0.5273 3/11 [=======>......................] - ETA: 0s - loss: 0.4269 - accuracy: 0.5356 4/11 [=========>....................] - ETA: 0s - loss: 0.4241 - accuracy: 0.5404 5/11 [============>.................] - ETA: 0s - loss: 0.4224 - accuracy: 0.5429 6/11 [===============>..............] - ETA: 0s - loss: 0.4208 - accuracy: 0.5453 7/11 [==================>...........] - ETA: 0s - loss: 0.4194 - accuracy: 0.5463 8/11 [====================>.........] - ETA: 0s - loss: 0.4183 - accuracy: 0.5474 9/11 [=======================>......] - ETA: 0s - loss: 0.4172 - accuracy: 0.547810/11 [==========================>...] - ETA: 0s - loss: 0.4164 - accuracy: 0.548311/11 [==============================] - ETA: 0s - loss: 0.4158 - accuracy: 0.548611/11 [==============================] - 1s 102ms/step - loss: 0.4152 - accuracy: 0.5489
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3982 - accuracy: 0.6094 2/11 [====>.........................] - ETA: 0s - loss: 0.3997 - accuracy: 0.5938 3/11 [=======>......................] - ETA: 0s - loss: 0.4016 - accuracy: 0.5877 4/11 [=========>....................] - ETA: 0s - loss: 0.4023 - accuracy: 0.5863 5/11 [============>.................] - ETA: 0s - loss: 0.4021 - accuracy: 0.5884 6/11 [===============>..............] - ETA: 0s - loss: 0.4017 - accuracy: 0.5908 7/11 [==================>...........] - ETA: 0s - loss: 0.4013 - accuracy: 0.5939 8/11 [====================>.........] - ETA: 0s - loss: 0.4008 - accuracy: 0.5972 9/11 [=======================>......] - ETA: 0s - loss: 0.4005 - accuracy: 0.599910/11 [==========================>...] - ETA: 0s - loss: 0.4001 - accuracy: 0.602511/11 [==============================] - ETA: 0s - loss: 0.3999 - accuracy: 0.604711/11 [==============================] - 1s 98ms/step - loss: 0.3998 - accuracy: 0.6066
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3858 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 0s - loss: 0.3881 - accuracy: 0.6816 3/11 [=======>......................] - ETA: 0s - loss: 0.3890 - accuracy: 0.6671 4/11 [=========>....................] - ETA: 0s - loss: 0.3886 - accuracy: 0.6595 5/11 [============>.................] - ETA: 0s - loss: 0.3883 - accuracy: 0.6535 6/11 [===============>..............] - ETA: 0s - loss: 0.3882 - accuracy: 0.6470 7/11 [==================>...........] - ETA: 0s - loss: 0.3882 - accuracy: 0.6425 8/11 [====================>.........] - ETA: 0s - loss: 0.3882 - accuracy: 0.6392 9/11 [=======================>......] - ETA: 0s - loss: 0.3883 - accuracy: 0.636410/11 [==========================>...] - ETA: 0s - loss: 0.3885 - accuracy: 0.634111/11 [==============================] - ETA: 0s - loss: 0.3886 - accuracy: 0.631811/11 [==============================] - 1s 101ms/step - loss: 0.3887 - accuracy: 0.6300
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3859 - accuracy: 0.6094 2/11 [====>.........................] - ETA: 0s - loss: 0.3839 - accuracy: 0.6270 3/11 [=======>......................] - ETA: 0s - loss: 0.3836 - accuracy: 0.6341 4/11 [=========>....................] - ETA: 0s - loss: 0.3840 - accuracy: 0.6318 5/11 [============>.................] - ETA: 0s - loss: 0.3839 - accuracy: 0.6283 6/11 [===============>..............] - ETA: 0s - loss: 0.3834 - accuracy: 0.6269 7/11 [==================>...........] - ETA: 0s - loss: 0.3832 - accuracy: 0.6250 8/11 [====================>.........] - ETA: 0s - loss: 0.3831 - accuracy: 0.6240 9/11 [=======================>......] - ETA: 0s - loss: 0.3830 - accuracy: 0.622710/11 [==========================>...] - ETA: 0s - loss: 0.3831 - accuracy: 0.620711/11 [==============================] - ETA: 0s - loss: 0.3831 - accuracy: 0.619311/11 [==============================] - 1s 98ms/step - loss: 0.3832 - accuracy: 0.6182
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3917 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 0s - loss: 0.3850 - accuracy: 0.5996 3/11 [=======>......................] - ETA: 0s - loss: 0.3824 - accuracy: 0.6133 4/11 [=========>....................] - ETA: 0s - loss: 0.3816 - accuracy: 0.6270 5/11 [============>.................] - ETA: 0s - loss: 0.3812 - accuracy: 0.6350 6/11 [===============>..............] - ETA: 0s - loss: 0.3807 - accuracy: 0.6416 7/11 [==================>...........] - ETA: 0s - loss: 0.3805 - accuracy: 0.6457 8/11 [====================>.........] - ETA: 0s - loss: 0.3803 - accuracy: 0.6502 9/11 [=======================>......] - ETA: 0s - loss: 0.3801 - accuracy: 0.653510/11 [==========================>...] - ETA: 0s - loss: 0.3801 - accuracy: 0.655811/11 [==============================] - ETA: 0s - loss: 0.3800 - accuracy: 0.658211/11 [==============================] - 1s 103ms/step - loss: 0.3798 - accuracy: 0.6602
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3679 - accuracy: 0.6094 2/11 [====>.........................] - ETA: 1s - loss: 0.3712 - accuracy: 0.6152 3/11 [=======>......................] - ETA: 0s - loss: 0.3714 - accuracy: 0.6315 4/11 [=========>....................] - ETA: 0s - loss: 0.3720 - accuracy: 0.6377 5/11 [============>.................] - ETA: 0s - loss: 0.3727 - accuracy: 0.6411 6/11 [===============>..............] - ETA: 0s - loss: 0.3732 - accuracy: 0.6456 7/11 [==================>...........] - ETA: 0s - loss: 0.3735 - accuracy: 0.6500 8/11 [====================>.........] - ETA: 0s - loss: 0.3735 - accuracy: 0.6542 9/11 [=======================>......] - ETA: 0s - loss: 0.3733 - accuracy: 0.658510/11 [==========================>...] - ETA: 0s - loss: 0.3732 - accuracy: 0.661711/11 [==============================] - ETA: 0s - loss: 0.3733 - accuracy: 0.663711/11 [==============================] - 1s 102ms/step - loss: 0.3734 - accuracy: 0.6653
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3746 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 0s - loss: 0.3732 - accuracy: 0.6660 3/11 [=======>......................] - ETA: 0s - loss: 0.3720 - accuracy: 0.6905 4/11 [=========>....................] - ETA: 0s - loss: 0.3719 - accuracy: 0.7035 5/11 [============>.................] - ETA: 0s - loss: 0.3718 - accuracy: 0.7121 6/11 [===============>..............] - ETA: 0s - loss: 0.3717 - accuracy: 0.7174 7/11 [==================>...........] - ETA: 0s - loss: 0.3716 - accuracy: 0.7212 8/11 [====================>.........] - ETA: 0s - loss: 0.3714 - accuracy: 0.7232 9/11 [=======================>......] - ETA: 0s - loss: 0.3712 - accuracy: 0.725110/11 [==========================>...] - ETA: 0s - loss: 0.3711 - accuracy: 0.726111/11 [==============================] - ETA: 0s - loss: 0.3709 - accuracy: 0.727411/11 [==============================] - 1s 100ms/step - loss: 0.3708 - accuracy: 0.7285
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3632 - accuracy: 0.7422 2/11 [====>.........................] - ETA: 0s - loss: 0.3670 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.3667 - accuracy: 0.7274 4/11 [=========>....................] - ETA: 0s - loss: 0.3665 - accuracy: 0.7277 5/11 [============>.................] - ETA: 0s - loss: 0.3669 - accuracy: 0.7278 6/11 [===============>..............] - ETA: 0s - loss: 0.3672 - accuracy: 0.7276 7/11 [==================>...........] - ETA: 0s - loss: 0.3675 - accuracy: 0.7270 8/11 [====================>.........] - ETA: 0s - loss: 0.3676 - accuracy: 0.7273 9/11 [=======================>......] - ETA: 0s - loss: 0.3677 - accuracy: 0.727810/11 [==========================>...] - ETA: 0s - loss: 0.3676 - accuracy: 0.728811/11 [==============================] - ETA: 0s - loss: 0.3675 - accuracy: 0.730411/11 [==============================] - 1s 100ms/step - loss: 0.3674 - accuracy: 0.7316
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3674 - accuracy: 0.8203 2/11 [====>.........................] - ETA: 0s - loss: 0.3696 - accuracy: 0.8223 3/11 [=======>......................] - ETA: 0s - loss: 0.3695 - accuracy: 0.8260 4/11 [=========>....................] - ETA: 0s - loss: 0.3691 - accuracy: 0.8304 5/11 [============>.................] - ETA: 0s - loss: 0.3688 - accuracy: 0.8315 6/11 [===============>..............] - ETA: 0s - loss: 0.3685 - accuracy: 0.8296 7/11 [==================>...........] - ETA: 0s - loss: 0.3682 - accuracy: 0.8262 8/11 [====================>.........] - ETA: 0s - loss: 0.3680 - accuracy: 0.8222 9/11 [=======================>......] - ETA: 0s - loss: 0.3677 - accuracy: 0.818210/11 [==========================>...] - ETA: 0s - loss: 0.3674 - accuracy: 0.814411/11 [==============================] - ETA: 0s - loss: 0.3671 - accuracy: 0.810611/11 [==============================] - 1s 99ms/step - loss: 0.3668 - accuracy: 0.8074
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3571 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.3604 - accuracy: 0.7559 3/11 [=======>......................] - ETA: 0s - loss: 0.3616 - accuracy: 0.7635 4/11 [=========>....................] - ETA: 0s - loss: 0.3623 - accuracy: 0.7674 5/11 [============>.................] - ETA: 0s - loss: 0.3625 - accuracy: 0.7714 6/11 [===============>..............] - ETA: 0s - loss: 0.3628 - accuracy: 0.7713 7/11 [==================>...........] - ETA: 0s - loss: 0.3630 - accuracy: 0.7713 8/11 [====================>.........] - ETA: 0s - loss: 0.3629 - accuracy: 0.7713 9/11 [=======================>......] - ETA: 0s - loss: 0.3628 - accuracy: 0.771710/11 [==========================>...] - ETA: 0s - loss: 0.3627 - accuracy: 0.772211/11 [==============================] - ETA: 0s - loss: 0.3626 - accuracy: 0.773011/11 [==============================] - 1s 99ms/step - loss: 0.3625 - accuracy: 0.7736
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3734 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.3693 - accuracy: 0.8223 3/11 [=======>......................] - ETA: 0s - loss: 0.3690 - accuracy: 0.8277 4/11 [=========>....................] - ETA: 0s - loss: 0.3691 - accuracy: 0.8283 5/11 [============>.................] - ETA: 0s - loss: 0.3685 - accuracy: 0.8295 6/11 [===============>..............] - ETA: 0s - loss: 0.3681 - accuracy: 0.8269 7/11 [==================>...........] - ETA: 0s - loss: 0.3673 - accuracy: 0.8248 8/11 [====================>.........] - ETA: 0s - loss: 0.3666 - accuracy: 0.8222 9/11 [=======================>......] - ETA: 0s - loss: 0.3661 - accuracy: 0.820110/11 [==========================>...] - ETA: 0s - loss: 0.3656 - accuracy: 0.819011/11 [==============================] - ETA: 0s - loss: 0.3652 - accuracy: 0.818611/11 [==============================] - 1s 97ms/step - loss: 0.3649 - accuracy: 0.8182
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.3685 - accuracy: 0.83593/6 [==============>...............] - ETA: 0s - loss: 0.3651 - accuracy: 0.8672 5/6 [========================>.....] - ETA: 0s - loss: 0.3653 - accuracy: 0.85006/6 [==============================] - 4s 32ms/step - loss: 0.3648 - accuracy: 0.8484
2021-12-13 23:46:47.236726: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:46:47.237852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:46:47.237898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:46:47.237941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:46:47.237974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:46:47.238001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:46:47.238029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:46:47.238055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:46:47.238082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:46:47.238109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:46:47.239238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:46:47.239267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:46:47.239277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:46:47.239284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [-0.99797195  0.98686     0.8193492  -0.99917865 -0.9999563 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 2 1 0] pred: [-0.9997188  -0.99884665 -0.9772915   0.8966269  -0.96239483]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [-0.99993706 -0.77027786  0.9987834  -0.9999556  -0.99999005]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 1 4 0] pred: [-0.9999989  -0.9997474   0.99721783 -0.99919796 -0.9999899 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 3 0 4 2] pred: [-0.44188052 -0.10321181 -0.83899856 -0.34296122 -0.48914528]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [-0.99874693  0.9530064   0.6883712  -0.998832   -0.99992657]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [-0.99824226  0.9644467   0.75888216 -0.9989448  -0.9999201 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 4 0] pred: [-0.9999987  -0.99975795  0.9960574  -0.9986816  -0.99998546]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 3 0 4] pred: [-0.99370354  0.8019109  -0.8575041  -0.99187416 -0.9989813 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 3 2 4 0] pred: [-0.9976875  -0.74675256 -0.99131125 -0.90140086 -0.9960669 ]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [-0.9980465   0.93407387  0.9925741  -0.9998522  -0.9999364 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [4 3 2 0 1] pred: [-0.9905607  -0.9990272  -0.98101026  0.89496475  0.9334885 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 3 0 4] pred: [-0.9998691   0.8099015   0.6188687  -0.99742955 -0.99995935]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 4 0] pred: [-0.999999   -0.9998092   0.9981285  -0.99952716 -0.9999913 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 4 0] pred: [-0.9999988 -0.9997541  0.9960504 -0.998721  -0.9999862]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:56 - loss: 0.6909 - accuracy: 0.2344 2/11 [====>.........................] - ETA: 0s - loss: 0.6901 - accuracy: 0.2793   3/11 [=======>......................] - ETA: 0s - loss: 0.6892 - accuracy: 0.3095 4/11 [=========>....................] - ETA: 0s - loss: 0.6883 - accuracy: 0.3278 5/11 [============>.................] - ETA: 0s - loss: 0.6873 - accuracy: 0.3438 6/11 [===============>..............] - ETA: 0s - loss: 0.6863 - accuracy: 0.3568 7/11 [==================>...........] - ETA: 0s - loss: 0.6854 - accuracy: 0.3675 8/11 [====================>.........] - ETA: 0s - loss: 0.6844 - accuracy: 0.3759 9/11 [=======================>......] - ETA: 0s - loss: 0.6834 - accuracy: 0.382410/11 [==========================>...] - ETA: 0s - loss: 0.6823 - accuracy: 0.388211/11 [==============================] - ETA: 0s - loss: 0.6814 - accuracy: 0.393011/11 [==============================] - 13s 103ms/step - loss: 0.6805 - accuracy: 0.3970
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6416 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.6407 - accuracy: 0.4590 3/11 [=======>......................] - ETA: 0s - loss: 0.6397 - accuracy: 0.4466 4/11 [=========>....................] - ETA: 0s - loss: 0.6377 - accuracy: 0.4443 5/11 [============>.................] - ETA: 0s - loss: 0.6358 - accuracy: 0.4458 6/11 [===============>..............] - ETA: 0s - loss: 0.6339 - accuracy: 0.4466 7/11 [==================>...........] - ETA: 0s - loss: 0.6319 - accuracy: 0.4480 8/11 [====================>.........] - ETA: 0s - loss: 0.6299 - accuracy: 0.4483 9/11 [=======================>......] - ETA: 0s - loss: 0.6279 - accuracy: 0.447510/11 [==========================>...] - ETA: 0s - loss: 0.6258 - accuracy: 0.448011/11 [==============================] - ETA: 0s - loss: 0.6237 - accuracy: 0.449011/11 [==============================] - 1s 98ms/step - loss: 0.6219 - accuracy: 0.4497
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5333 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.5325 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.5314 - accuracy: 0.4748 4/11 [=========>....................] - ETA: 0s - loss: 0.5292 - accuracy: 0.4709 5/11 [============>.................] - ETA: 0s - loss: 0.5267 - accuracy: 0.4683 6/11 [===============>..............] - ETA: 0s - loss: 0.5243 - accuracy: 0.4664 7/11 [==================>...........] - ETA: 0s - loss: 0.5220 - accuracy: 0.4659 8/11 [====================>.........] - ETA: 0s - loss: 0.5199 - accuracy: 0.4653 9/11 [=======================>......] - ETA: 0s - loss: 0.5178 - accuracy: 0.465210/11 [==========================>...] - ETA: 0s - loss: 0.5162 - accuracy: 0.464411/11 [==============================] - ETA: 0s - loss: 0.5147 - accuracy: 0.463811/11 [==============================] - 1s 99ms/step - loss: 0.5134 - accuracy: 0.4634
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4745 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.4771 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.4778 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.4776 - accuracy: 0.4541 5/11 [============>.................] - ETA: 0s - loss: 0.4765 - accuracy: 0.4580 6/11 [===============>..............] - ETA: 0s - loss: 0.4762 - accuracy: 0.4578 7/11 [==================>...........] - ETA: 0s - loss: 0.4762 - accuracy: 0.4571 8/11 [====================>.........] - ETA: 0s - loss: 0.4756 - accuracy: 0.4585 9/11 [=======================>......] - ETA: 0s - loss: 0.4753 - accuracy: 0.458710/11 [==========================>...] - ETA: 0s - loss: 0.4751 - accuracy: 0.459011/11 [==============================] - ETA: 0s - loss: 0.4749 - accuracy: 0.458911/11 [==============================] - 1s 99ms/step - loss: 0.4747 - accuracy: 0.4589
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4636 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.4691 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.4683 - accuracy: 0.4505 4/11 [=========>....................] - ETA: 0s - loss: 0.4691 - accuracy: 0.4473 5/11 [============>.................] - ETA: 0s - loss: 0.4688 - accuracy: 0.4478 6/11 [===============>..............] - ETA: 0s - loss: 0.4681 - accuracy: 0.4504 7/11 [==================>...........] - ETA: 0s - loss: 0.4675 - accuracy: 0.4526 8/11 [====================>.........] - ETA: 0s - loss: 0.4672 - accuracy: 0.4539 9/11 [=======================>......] - ETA: 0s - loss: 0.4672 - accuracy: 0.454410/11 [==========================>...] - ETA: 0s - loss: 0.4670 - accuracy: 0.454911/11 [==============================] - ETA: 0s - loss: 0.4668 - accuracy: 0.455211/11 [==============================] - 1s 103ms/step - loss: 0.4667 - accuracy: 0.4554
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4576 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.4551 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 0s - loss: 0.4550 - accuracy: 0.4735 4/11 [=========>....................] - ETA: 0s - loss: 0.4541 - accuracy: 0.4743 5/11 [============>.................] - ETA: 0s - loss: 0.4532 - accuracy: 0.4760 6/11 [===============>..............] - ETA: 0s - loss: 0.4525 - accuracy: 0.4770 7/11 [==================>...........] - ETA: 0s - loss: 0.4522 - accuracy: 0.4779 8/11 [====================>.........] - ETA: 0s - loss: 0.4520 - accuracy: 0.4767 9/11 [=======================>......] - ETA: 0s - loss: 0.4521 - accuracy: 0.475310/11 [==========================>...] - ETA: 0s - loss: 0.4521 - accuracy: 0.473711/11 [==============================] - ETA: 0s - loss: 0.4520 - accuracy: 0.472311/11 [==============================] - 1s 101ms/step - loss: 0.4519 - accuracy: 0.4712
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4326 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.4342 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 0s - loss: 0.4338 - accuracy: 0.4727 4/11 [=========>....................] - ETA: 0s - loss: 0.4341 - accuracy: 0.4722 5/11 [============>.................] - ETA: 0s - loss: 0.4347 - accuracy: 0.4702 6/11 [===============>..............] - ETA: 0s - loss: 0.4353 - accuracy: 0.4693 7/11 [==================>...........] - ETA: 0s - loss: 0.4355 - accuracy: 0.4696 8/11 [====================>.........] - ETA: 0s - loss: 0.4356 - accuracy: 0.4703 9/11 [=======================>......] - ETA: 0s - loss: 0.4357 - accuracy: 0.470910/11 [==========================>...] - ETA: 0s - loss: 0.4358 - accuracy: 0.471911/11 [==============================] - ETA: 0s - loss: 0.4357 - accuracy: 0.473111/11 [==============================] - 1s 99ms/step - loss: 0.4356 - accuracy: 0.4741
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4216 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 0s - loss: 0.4235 - accuracy: 0.5430 3/11 [=======>......................] - ETA: 0s - loss: 0.4223 - accuracy: 0.5512 4/11 [=========>....................] - ETA: 0s - loss: 0.4222 - accuracy: 0.5540 5/11 [============>.................] - ETA: 0s - loss: 0.4223 - accuracy: 0.5567 6/11 [===============>..............] - ETA: 0s - loss: 0.4225 - accuracy: 0.5568 7/11 [==================>...........] - ETA: 0s - loss: 0.4224 - accuracy: 0.5571 8/11 [====================>.........] - ETA: 0s - loss: 0.4226 - accuracy: 0.5566 9/11 [=======================>......] - ETA: 0s - loss: 0.4226 - accuracy: 0.556210/11 [==========================>...] - ETA: 0s - loss: 0.4225 - accuracy: 0.556111/11 [==============================] - ETA: 0s - loss: 0.4224 - accuracy: 0.556311/11 [==============================] - 1s 101ms/step - loss: 0.4223 - accuracy: 0.5565
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4252 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.4247 - accuracy: 0.5410 3/11 [=======>......................] - ETA: 0s - loss: 0.4232 - accuracy: 0.5456 4/11 [=========>....................] - ETA: 0s - loss: 0.4211 - accuracy: 0.5483 5/11 [============>.................] - ETA: 0s - loss: 0.4198 - accuracy: 0.5493 6/11 [===============>..............] - ETA: 0s - loss: 0.4187 - accuracy: 0.5502 7/11 [==================>...........] - ETA: 0s - loss: 0.4177 - accuracy: 0.5524 8/11 [====================>.........] - ETA: 0s - loss: 0.4170 - accuracy: 0.5549 9/11 [=======================>......] - ETA: 0s - loss: 0.4164 - accuracy: 0.557210/11 [==========================>...] - ETA: 0s - loss: 0.4160 - accuracy: 0.558611/11 [==============================] - ETA: 0s - loss: 0.4157 - accuracy: 0.559911/11 [==============================] - 1s 99ms/step - loss: 0.4154 - accuracy: 0.5610
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4061 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.4058 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.4053 - accuracy: 0.5026 4/11 [=========>....................] - ETA: 0s - loss: 0.4042 - accuracy: 0.5103 5/11 [============>.................] - ETA: 0s - loss: 0.4038 - accuracy: 0.5160 6/11 [===============>..............] - ETA: 0s - loss: 0.4037 - accuracy: 0.5207 7/11 [==================>...........] - ETA: 0s - loss: 0.4036 - accuracy: 0.5257 8/11 [====================>.........] - ETA: 0s - loss: 0.4036 - accuracy: 0.5314 9/11 [=======================>......] - ETA: 0s - loss: 0.4036 - accuracy: 0.537510/11 [==========================>...] - ETA: 0s - loss: 0.4037 - accuracy: 0.543711/11 [==============================] - ETA: 0s - loss: 0.4037 - accuracy: 0.549111/11 [==============================] - 1s 104ms/step - loss: 0.4037 - accuracy: 0.5537
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4026 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 0s - loss: 0.4036 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.4012 - accuracy: 0.6302 4/11 [=========>....................] - ETA: 0s - loss: 0.4006 - accuracy: 0.6299 5/11 [============>.................] - ETA: 0s - loss: 0.3998 - accuracy: 0.6345 6/11 [===============>..............] - ETA: 0s - loss: 0.3995 - accuracy: 0.6379 7/11 [==================>...........] - ETA: 0s - loss: 0.3992 - accuracy: 0.6413 8/11 [====================>.........] - ETA: 0s - loss: 0.3988 - accuracy: 0.6454 9/11 [=======================>......] - ETA: 0s - loss: 0.3985 - accuracy: 0.649210/11 [==========================>...] - ETA: 0s - loss: 0.3983 - accuracy: 0.652411/11 [==============================] - ETA: 0s - loss: 0.3980 - accuracy: 0.655011/11 [==============================] - 1s 104ms/step - loss: 0.3979 - accuracy: 0.6571
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3898 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.3915 - accuracy: 0.7227 3/11 [=======>......................] - ETA: 0s - loss: 0.3907 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 0s - loss: 0.3904 - accuracy: 0.7285 5/11 [============>.................] - ETA: 0s - loss: 0.3900 - accuracy: 0.7316 6/11 [===============>..............] - ETA: 0s - loss: 0.3893 - accuracy: 0.7325 7/11 [==================>...........] - ETA: 0s - loss: 0.3890 - accuracy: 0.7313 8/11 [====================>.........] - ETA: 0s - loss: 0.3889 - accuracy: 0.7295 9/11 [=======================>......] - ETA: 0s - loss: 0.3888 - accuracy: 0.728210/11 [==========================>...] - ETA: 0s - loss: 0.3887 - accuracy: 0.726611/11 [==============================] - ETA: 0s - loss: 0.3887 - accuracy: 0.725111/11 [==============================] - 1s 105ms/step - loss: 0.3886 - accuracy: 0.7238
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3787 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.3795 - accuracy: 0.7109 3/11 [=======>......................] - ETA: 0s - loss: 0.3807 - accuracy: 0.6970 4/11 [=========>....................] - ETA: 0s - loss: 0.3815 - accuracy: 0.6893 5/11 [============>.................] - ETA: 0s - loss: 0.3818 - accuracy: 0.6836 6/11 [===============>..............] - ETA: 0s - loss: 0.3819 - accuracy: 0.6806 7/11 [==================>...........] - ETA: 0s - loss: 0.3820 - accuracy: 0.6787 8/11 [====================>.........] - ETA: 0s - loss: 0.3823 - accuracy: 0.6769 9/11 [=======================>......] - ETA: 0s - loss: 0.3823 - accuracy: 0.676510/11 [==========================>...] - ETA: 0s - loss: 0.3822 - accuracy: 0.676211/11 [==============================] - ETA: 0s - loss: 0.3822 - accuracy: 0.675511/11 [==============================] - 1s 105ms/step - loss: 0.3821 - accuracy: 0.6750
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3721 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 0s - loss: 0.3734 - accuracy: 0.6543 3/11 [=======>......................] - ETA: 0s - loss: 0.3743 - accuracy: 0.6593 4/11 [=========>....................] - ETA: 0s - loss: 0.3756 - accuracy: 0.6654 5/11 [============>.................] - ETA: 0s - loss: 0.3759 - accuracy: 0.6742 6/11 [===============>..............] - ETA: 0s - loss: 0.3760 - accuracy: 0.6812 7/11 [==================>...........] - ETA: 0s - loss: 0.3764 - accuracy: 0.6851 8/11 [====================>.........] - ETA: 0s - loss: 0.3766 - accuracy: 0.6894 9/11 [=======================>......] - ETA: 0s - loss: 0.3768 - accuracy: 0.691510/11 [==========================>...] - ETA: 0s - loss: 0.3769 - accuracy: 0.693011/11 [==============================] - ETA: 0s - loss: 0.3770 - accuracy: 0.693711/11 [==============================] - 1s 102ms/step - loss: 0.3771 - accuracy: 0.6942
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3852 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.3808 - accuracy: 0.6699 3/11 [=======>......................] - ETA: 0s - loss: 0.3787 - accuracy: 0.6957 4/11 [=========>....................] - ETA: 0s - loss: 0.3777 - accuracy: 0.7171 5/11 [============>.................] - ETA: 0s - loss: 0.3775 - accuracy: 0.7331 6/11 [===============>..............] - ETA: 0s - loss: 0.3773 - accuracy: 0.7457 7/11 [==================>...........] - ETA: 0s - loss: 0.3770 - accuracy: 0.7570 8/11 [====================>.........] - ETA: 0s - loss: 0.3766 - accuracy: 0.7660 9/11 [=======================>......] - ETA: 0s - loss: 0.3765 - accuracy: 0.773010/11 [==========================>...] - ETA: 0s - loss: 0.3764 - accuracy: 0.777911/11 [==============================] - ETA: 0s - loss: 0.3763 - accuracy: 0.781311/11 [==============================] - 1s 107ms/step - loss: 0.3762 - accuracy: 0.7841
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3632 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 0s - loss: 0.3655 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 0s - loss: 0.3667 - accuracy: 0.6710 4/11 [=========>....................] - ETA: 0s - loss: 0.3681 - accuracy: 0.6668 5/11 [============>.................] - ETA: 0s - loss: 0.3691 - accuracy: 0.6650 6/11 [===============>..............] - ETA: 0s - loss: 0.3692 - accuracy: 0.6649 7/11 [==================>...........] - ETA: 0s - loss: 0.3694 - accuracy: 0.6654 8/11 [====================>.........] - ETA: 0s - loss: 0.3694 - accuracy: 0.6672 9/11 [=======================>......] - ETA: 0s - loss: 0.3695 - accuracy: 0.669610/11 [==========================>...] - ETA: 0s - loss: 0.3696 - accuracy: 0.672611/11 [==============================] - ETA: 0s - loss: 0.3697 - accuracy: 0.676011/11 [==============================] - 1s 110ms/step - loss: 0.3697 - accuracy: 0.6788
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3792 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 0s - loss: 0.3759 - accuracy: 0.8398 3/11 [=======>......................] - ETA: 0s - loss: 0.3731 - accuracy: 0.8411 4/11 [=========>....................] - ETA: 0s - loss: 0.3720 - accuracy: 0.8364 5/11 [============>.................] - ETA: 0s - loss: 0.3707 - accuracy: 0.8332 6/11 [===============>..............] - ETA: 0s - loss: 0.3698 - accuracy: 0.8300 7/11 [==================>...........] - ETA: 0s - loss: 0.3691 - accuracy: 0.8262 8/11 [====================>.........] - ETA: 0s - loss: 0.3688 - accuracy: 0.8214 9/11 [=======================>......] - ETA: 0s - loss: 0.3684 - accuracy: 0.817310/11 [==========================>...] - ETA: 0s - loss: 0.3681 - accuracy: 0.813611/11 [==============================] - ETA: 0s - loss: 0.3679 - accuracy: 0.811111/11 [==============================] - 1s 104ms/step - loss: 0.3677 - accuracy: 0.8090
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3732 - accuracy: 0.8828 2/11 [====>.........................] - ETA: 0s - loss: 0.3675 - accuracy: 0.8828 3/11 [=======>......................] - ETA: 0s - loss: 0.3640 - accuracy: 0.8837 4/11 [=========>....................] - ETA: 0s - loss: 0.3633 - accuracy: 0.8805 5/11 [============>.................] - ETA: 0s - loss: 0.3629 - accuracy: 0.8785 6/11 [===============>..............] - ETA: 0s - loss: 0.3627 - accuracy: 0.8762 7/11 [==================>...........] - ETA: 0s - loss: 0.3626 - accuracy: 0.8733 8/11 [====================>.........] - ETA: 0s - loss: 0.3625 - accuracy: 0.8701 9/11 [=======================>......] - ETA: 0s - loss: 0.3624 - accuracy: 0.865610/11 [==========================>...] - ETA: 0s - loss: 0.3623 - accuracy: 0.861711/11 [==============================] - ETA: 0s - loss: 0.3622 - accuracy: 0.857711/11 [==============================] - 1s 101ms/step - loss: 0.3621 - accuracy: 0.8543
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3661 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 0s - loss: 0.3634 - accuracy: 0.6660 3/11 [=======>......................] - ETA: 0s - loss: 0.3618 - accuracy: 0.6836 4/11 [=========>....................] - ETA: 0s - loss: 0.3612 - accuracy: 0.6948 5/11 [============>.................] - ETA: 0s - loss: 0.3606 - accuracy: 0.7021 6/11 [===============>..............] - ETA: 0s - loss: 0.3602 - accuracy: 0.7103 7/11 [==================>...........] - ETA: 0s - loss: 0.3598 - accuracy: 0.7174 8/11 [====================>.........] - ETA: 0s - loss: 0.3594 - accuracy: 0.7242 9/11 [=======================>......] - ETA: 0s - loss: 0.3593 - accuracy: 0.730810/11 [==========================>...] - ETA: 0s - loss: 0.3592 - accuracy: 0.736811/11 [==============================] - ETA: 0s - loss: 0.3591 - accuracy: 0.742011/11 [==============================] - 1s 101ms/step - loss: 0.3590 - accuracy: 0.7463
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3508 - accuracy: 0.8828 2/11 [====>.........................] - ETA: 0s - loss: 0.3524 - accuracy: 0.8789 3/11 [=======>......................] - ETA: 0s - loss: 0.3530 - accuracy: 0.8785 4/11 [=========>....................] - ETA: 0s - loss: 0.3536 - accuracy: 0.8752 5/11 [============>.................] - ETA: 0s - loss: 0.3538 - accuracy: 0.8733 6/11 [===============>..............] - ETA: 0s - loss: 0.3538 - accuracy: 0.8729 7/11 [==================>...........] - ETA: 0s - loss: 0.3539 - accuracy: 0.8710 8/11 [====================>.........] - ETA: 0s - loss: 0.3540 - accuracy: 0.8687 9/11 [=======================>......] - ETA: 0s - loss: 0.3542 - accuracy: 0.866310/11 [==========================>...] - ETA: 0s - loss: 0.3543 - accuracy: 0.863911/11 [==============================] - ETA: 0s - loss: 0.3543 - accuracy: 0.862111/11 [==============================] - 1s 100ms/step - loss: 0.3544 - accuracy: 0.8606
Evaluate on test data
1/6 [====>.........................] - ETA: 17s - loss: 0.3629 - accuracy: 0.81253/6 [==============>...............] - ETA: 0s - loss: 0.3562 - accuracy: 0.8359 5/6 [========================>.....] - ETA: 0s - loss: 0.3525 - accuracy: 0.84696/6 [==============================] - 4s 30ms/step - loss: 0.3537 - accuracy: 0.8399
2021-12-13 23:47:34.433833: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:47:34.435002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:47:34.435051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:47:34.435093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:47:34.435128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:47:34.435155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:47:34.435189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:47:34.435216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:47:34.435245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:47:34.435273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:47:34.436388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:47:34.436415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:47:34.436424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:47:34.436432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 0 2 1] pred: [-0.73500067 -0.9675763  -0.85307854  0.72929996  0.6767402 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [-0.9977998   0.9612243   0.97267073 -0.9997805  -0.9999902 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [-0.9997573 -0.972032   0.9995016 -0.9998835 -0.9999786]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [-0.9981722   0.9776505   0.97621745 -0.99986523 -0.99999285]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [3 2 4 1 0] pred: [-0.9999291  -0.9999282  -0.79960155  0.8541411  -0.9994554 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [-0.98121864  0.996921    0.656473   -0.9993235  -0.99996245]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [0 1 4 3 2] pred: [ 0.42611182 -0.7569326  -0.94457793 -0.9014032  -0.8433539 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [-0.9907      0.95531315  0.92967486 -0.9997911  -0.9999507 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [-0.996715    0.97917354  0.96198905 -0.9998413  -0.99998426]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 0 4] pred: [-0.9999306  -0.9997854   0.9995499  -0.9985804  -0.99997085]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [-0.98652035  0.9378921   0.9302144  -0.9997717  -0.99994403]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [-0.9793318   0.8315606  -0.74844563 -0.9938534  -0.9999775 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [0 1 2 3 4] pred: [ 0.27491072 -0.5592628  -0.93021065 -0.93374836 -0.94063973]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 4 0 1] pred: [-0.9999433  -0.9999702   0.8690215  -0.91396284 -0.9999052 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 0 2 1] pred: [-0.93016016 -0.9971304  -0.96199596  0.92634124  0.88797957]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:57 - loss: 0.6933 - accuracy: 0.3906 2/11 [====>.........................] - ETA: 0s - loss: 0.6924 - accuracy: 0.4004   3/11 [=======>......................] - ETA: 0s - loss: 0.6914 - accuracy: 0.4206 4/11 [=========>....................] - ETA: 0s - loss: 0.6905 - accuracy: 0.4312 5/11 [============>.................] - ETA: 0s - loss: 0.6895 - accuracy: 0.4387 6/11 [===============>..............] - ETA: 0s - loss: 0.6886 - accuracy: 0.4433 7/11 [==================>...........] - ETA: 0s - loss: 0.6876 - accuracy: 0.4474 8/11 [====================>.........] - ETA: 0s - loss: 0.6867 - accuracy: 0.4486 9/11 [=======================>......] - ETA: 0s - loss: 0.6857 - accuracy: 0.450410/11 [==========================>...] - ETA: 0s - loss: 0.6846 - accuracy: 0.451611/11 [==============================] - ETA: 0s - loss: 0.6836 - accuracy: 0.452511/11 [==============================] - 13s 105ms/step - loss: 0.6828 - accuracy: 0.4532
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6443 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.6426 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 0s - loss: 0.6409 - accuracy: 0.4605 4/11 [=========>....................] - ETA: 0s - loss: 0.6389 - accuracy: 0.4635 5/11 [============>.................] - ETA: 0s - loss: 0.6368 - accuracy: 0.4661 6/11 [===============>..............] - ETA: 0s - loss: 0.6349 - accuracy: 0.4653 7/11 [==================>...........] - ETA: 0s - loss: 0.6328 - accuracy: 0.4655 8/11 [====================>.........] - ETA: 0s - loss: 0.6308 - accuracy: 0.4651 9/11 [=======================>......] - ETA: 0s - loss: 0.6286 - accuracy: 0.464410/11 [==========================>...] - ETA: 0s - loss: 0.6264 - accuracy: 0.464211/11 [==============================] - ETA: 0s - loss: 0.6242 - accuracy: 0.464011/11 [==============================] - 1s 104ms/step - loss: 0.6224 - accuracy: 0.4638
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5408 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.5388 - accuracy: 0.4316 3/11 [=======>......................] - ETA: 0s - loss: 0.5352 - accuracy: 0.4362 4/11 [=========>....................] - ETA: 0s - loss: 0.5310 - accuracy: 0.4419 5/11 [============>.................] - ETA: 0s - loss: 0.5273 - accuracy: 0.4466 6/11 [===============>..............] - ETA: 0s - loss: 0.5239 - accuracy: 0.4505 7/11 [==================>...........] - ETA: 0s - loss: 0.5214 - accuracy: 0.4517 8/11 [====================>.........] - ETA: 0s - loss: 0.5187 - accuracy: 0.4535 9/11 [=======================>......] - ETA: 0s - loss: 0.5166 - accuracy: 0.453910/11 [==========================>...] - ETA: 0s - loss: 0.5147 - accuracy: 0.455011/11 [==============================] - ETA: 0s - loss: 0.5130 - accuracy: 0.455611/11 [==============================] - 1s 105ms/step - loss: 0.5116 - accuracy: 0.4562
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4683 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.4692 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.4682 - accuracy: 0.4779 4/11 [=========>....................] - ETA: 0s - loss: 0.4704 - accuracy: 0.4697 5/11 [============>.................] - ETA: 0s - loss: 0.4707 - accuracy: 0.4667 6/11 [===============>..............] - ETA: 0s - loss: 0.4708 - accuracy: 0.4653 7/11 [==================>...........] - ETA: 0s - loss: 0.4704 - accuracy: 0.4657 8/11 [====================>.........] - ETA: 0s - loss: 0.4703 - accuracy: 0.4659 9/11 [=======================>......] - ETA: 0s - loss: 0.4702 - accuracy: 0.466210/11 [==========================>...] - ETA: 0s - loss: 0.4702 - accuracy: 0.466211/11 [==============================] - ETA: 0s - loss: 0.4704 - accuracy: 0.465811/11 [==============================] - 1s 106ms/step - loss: 0.4706 - accuracy: 0.4655
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4560 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.4521 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.4521 - accuracy: 0.5286 4/11 [=========>....................] - ETA: 0s - loss: 0.4534 - accuracy: 0.5225 5/11 [============>.................] - ETA: 0s - loss: 0.4552 - accuracy: 0.5152 6/11 [===============>..............] - ETA: 0s - loss: 0.4562 - accuracy: 0.5102 7/11 [==================>...........] - ETA: 0s - loss: 0.4570 - accuracy: 0.5059 8/11 [====================>.........] - ETA: 0s - loss: 0.4579 - accuracy: 0.5018 9/11 [=======================>......] - ETA: 0s - loss: 0.4588 - accuracy: 0.497610/11 [==========================>...] - ETA: 0s - loss: 0.4596 - accuracy: 0.494311/11 [==============================] - ETA: 0s - loss: 0.4604 - accuracy: 0.491411/11 [==============================] - 1s 102ms/step - loss: 0.4610 - accuracy: 0.4889
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4659 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.4668 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.4678 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.4677 - accuracy: 0.4590 5/11 [============>.................] - ETA: 0s - loss: 0.4684 - accuracy: 0.4562 6/11 [===============>..............] - ETA: 0s - loss: 0.4683 - accuracy: 0.4555 7/11 [==================>...........] - ETA: 0s - loss: 0.4679 - accuracy: 0.4555 8/11 [====================>.........] - ETA: 0s - loss: 0.4674 - accuracy: 0.4559 9/11 [=======================>......] - ETA: 0s - loss: 0.4670 - accuracy: 0.456810/11 [==========================>...] - ETA: 0s - loss: 0.4667 - accuracy: 0.457711/11 [==============================] - ETA: 0s - loss: 0.4664 - accuracy: 0.458111/11 [==============================] - 1s 117ms/step - loss: 0.4662 - accuracy: 0.4584
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4613 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.4559 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.4567 - accuracy: 0.4653 4/11 [=========>....................] - ETA: 0s - loss: 0.4560 - accuracy: 0.4661 5/11 [============>.................] - ETA: 0s - loss: 0.4562 - accuracy: 0.4629 6/11 [===============>..............] - ETA: 0s - loss: 0.4564 - accuracy: 0.4626 7/11 [==================>...........] - ETA: 0s - loss: 0.4565 - accuracy: 0.4624 8/11 [====================>.........] - ETA: 0s - loss: 0.4563 - accuracy: 0.4630 9/11 [=======================>......] - ETA: 0s - loss: 0.4561 - accuracy: 0.463210/11 [==========================>...] - ETA: 0s - loss: 0.4561 - accuracy: 0.463011/11 [==============================] - ETA: 0s - loss: 0.4560 - accuracy: 0.463011/11 [==============================] - 1s 107ms/step - loss: 0.4560 - accuracy: 0.4630
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4522 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.4544 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 0s - loss: 0.4551 - accuracy: 0.4657 4/11 [=========>....................] - ETA: 0s - loss: 0.4541 - accuracy: 0.4621 5/11 [============>.................] - ETA: 0s - loss: 0.4530 - accuracy: 0.4643 6/11 [===============>..............] - ETA: 0s - loss: 0.4523 - accuracy: 0.4646 7/11 [==================>...........] - ETA: 0s - loss: 0.4516 - accuracy: 0.4648 8/11 [====================>.........] - ETA: 0s - loss: 0.4509 - accuracy: 0.4651 9/11 [=======================>......] - ETA: 0s - loss: 0.4505 - accuracy: 0.465110/11 [==========================>...] - ETA: 0s - loss: 0.4499 - accuracy: 0.466811/11 [==============================] - ETA: 0s - loss: 0.4493 - accuracy: 0.468511/11 [==============================] - 1s 104ms/step - loss: 0.4488 - accuracy: 0.4699
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4423 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.4415 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 0s - loss: 0.4403 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.4393 - accuracy: 0.4868 5/11 [============>.................] - ETA: 0s - loss: 0.4380 - accuracy: 0.4888 6/11 [===============>..............] - ETA: 0s - loss: 0.4368 - accuracy: 0.4926 7/11 [==================>...........] - ETA: 0s - loss: 0.4358 - accuracy: 0.4959 8/11 [====================>.........] - ETA: 0s - loss: 0.4351 - accuracy: 0.4988 9/11 [=======================>......] - ETA: 0s - loss: 0.4343 - accuracy: 0.501010/11 [==========================>...] - ETA: 0s - loss: 0.4336 - accuracy: 0.502911/11 [==============================] - ETA: 0s - loss: 0.4329 - accuracy: 0.505011/11 [==============================] - 1s 107ms/step - loss: 0.4322 - accuracy: 0.5067
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4311 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 0s - loss: 0.4252 - accuracy: 0.5762 3/11 [=======>......................] - ETA: 0s - loss: 0.4208 - accuracy: 0.5734 4/11 [=========>....................] - ETA: 0s - loss: 0.4181 - accuracy: 0.5750 5/11 [============>.................] - ETA: 0s - loss: 0.4174 - accuracy: 0.5778 6/11 [===============>..............] - ETA: 0s - loss: 0.4172 - accuracy: 0.5801 7/11 [==================>...........] - ETA: 0s - loss: 0.4166 - accuracy: 0.5827 8/11 [====================>.........] - ETA: 0s - loss: 0.4162 - accuracy: 0.5835 9/11 [=======================>......] - ETA: 0s - loss: 0.4158 - accuracy: 0.584310/11 [==========================>...] - ETA: 0s - loss: 0.4154 - accuracy: 0.585111/11 [==============================] - ETA: 0s - loss: 0.4150 - accuracy: 0.585911/11 [==============================] - 1s 104ms/step - loss: 0.4147 - accuracy: 0.5866
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4168 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.4160 - accuracy: 0.5098 3/11 [=======>......................] - ETA: 0s - loss: 0.4123 - accuracy: 0.5386 4/11 [=========>....................] - ETA: 0s - loss: 0.4099 - accuracy: 0.5539 5/11 [============>.................] - ETA: 0s - loss: 0.4084 - accuracy: 0.5634 6/11 [===============>..............] - ETA: 0s - loss: 0.4076 - accuracy: 0.5704 7/11 [==================>...........] - ETA: 0s - loss: 0.4073 - accuracy: 0.5739 8/11 [====================>.........] - ETA: 0s - loss: 0.4068 - accuracy: 0.5772 9/11 [=======================>......] - ETA: 0s - loss: 0.4063 - accuracy: 0.581110/11 [==========================>...] - ETA: 0s - loss: 0.4058 - accuracy: 0.584411/11 [==============================] - ETA: 0s - loss: 0.4055 - accuracy: 0.587011/11 [==============================] - 1s 103ms/step - loss: 0.4051 - accuracy: 0.5892
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3896 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.3920 - accuracy: 0.6152 3/11 [=======>......................] - ETA: 0s - loss: 0.3929 - accuracy: 0.6237 4/11 [=========>....................] - ETA: 0s - loss: 0.3937 - accuracy: 0.6289 5/11 [============>.................] - ETA: 0s - loss: 0.3942 - accuracy: 0.6316 6/11 [===============>..............] - ETA: 0s - loss: 0.3943 - accuracy: 0.6337 7/11 [==================>...........] - ETA: 0s - loss: 0.3944 - accuracy: 0.6350 8/11 [====================>.........] - ETA: 0s - loss: 0.3944 - accuracy: 0.6369 9/11 [=======================>......] - ETA: 0s - loss: 0.3944 - accuracy: 0.638510/11 [==========================>...] - ETA: 0s - loss: 0.3942 - accuracy: 0.640311/11 [==============================] - ETA: 0s - loss: 0.3941 - accuracy: 0.641811/11 [==============================] - 1s 103ms/step - loss: 0.3940 - accuracy: 0.6430
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3898 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.3906 - accuracy: 0.7324 3/11 [=======>......................] - ETA: 0s - loss: 0.3912 - accuracy: 0.7305 4/11 [=========>....................] - ETA: 0s - loss: 0.3902 - accuracy: 0.7310 5/11 [============>.................] - ETA: 0s - loss: 0.3893 - accuracy: 0.7291 6/11 [===============>..............] - ETA: 0s - loss: 0.3889 - accuracy: 0.7257 7/11 [==================>...........] - ETA: 0s - loss: 0.3886 - accuracy: 0.7234 8/11 [====================>.........] - ETA: 0s - loss: 0.3882 - accuracy: 0.7209 9/11 [=======================>......] - ETA: 0s - loss: 0.3878 - accuracy: 0.718210/11 [==========================>...] - ETA: 0s - loss: 0.3875 - accuracy: 0.715211/11 [==============================] - ETA: 0s - loss: 0.3873 - accuracy: 0.712511/11 [==============================] - 1s 102ms/step - loss: 0.3871 - accuracy: 0.7103
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3780 - accuracy: 0.7109 2/11 [====>.........................] - ETA: 1s - loss: 0.3764 - accuracy: 0.7090 3/11 [=======>......................] - ETA: 0s - loss: 0.3764 - accuracy: 0.7140 4/11 [=========>....................] - ETA: 0s - loss: 0.3767 - accuracy: 0.7201 5/11 [============>.................] - ETA: 0s - loss: 0.3770 - accuracy: 0.7245 6/11 [===============>..............] - ETA: 0s - loss: 0.3770 - accuracy: 0.7261 7/11 [==================>...........] - ETA: 0s - loss: 0.3773 - accuracy: 0.7248 8/11 [====================>.........] - ETA: 0s - loss: 0.3775 - accuracy: 0.7234 9/11 [=======================>......] - ETA: 0s - loss: 0.3777 - accuracy: 0.721610/11 [==========================>...] - ETA: 0s - loss: 0.3779 - accuracy: 0.719811/11 [==============================] - ETA: 0s - loss: 0.3780 - accuracy: 0.717811/11 [==============================] - 1s 106ms/step - loss: 0.3782 - accuracy: 0.7162
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3631 - accuracy: 0.8203 2/11 [====>.........................] - ETA: 0s - loss: 0.3684 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 0s - loss: 0.3706 - accuracy: 0.8082 4/11 [=========>....................] - ETA: 0s - loss: 0.3717 - accuracy: 0.8053 5/11 [============>.................] - ETA: 0s - loss: 0.3728 - accuracy: 0.8040 6/11 [===============>..............] - ETA: 0s - loss: 0.3738 - accuracy: 0.8023 7/11 [==================>...........] - ETA: 0s - loss: 0.3745 - accuracy: 0.8006 8/11 [====================>.........] - ETA: 0s - loss: 0.3750 - accuracy: 0.7992 9/11 [=======================>......] - ETA: 0s - loss: 0.3753 - accuracy: 0.797010/11 [==========================>...] - ETA: 0s - loss: 0.3756 - accuracy: 0.794711/11 [==============================] - ETA: 0s - loss: 0.3757 - accuracy: 0.792411/11 [==============================] - 1s 103ms/step - loss: 0.3758 - accuracy: 0.7905
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3650 - accuracy: 0.6484 2/11 [====>.........................] - ETA: 0s - loss: 0.3662 - accuracy: 0.6582 3/11 [=======>......................] - ETA: 0s - loss: 0.3671 - accuracy: 0.6680 4/11 [=========>....................] - ETA: 0s - loss: 0.3677 - accuracy: 0.6777 5/11 [============>.................] - ETA: 0s - loss: 0.3680 - accuracy: 0.6881 6/11 [===============>..............] - ETA: 0s - loss: 0.3680 - accuracy: 0.6982 7/11 [==================>...........] - ETA: 0s - loss: 0.3683 - accuracy: 0.7058 8/11 [====================>.........] - ETA: 0s - loss: 0.3687 - accuracy: 0.7117 9/11 [=======================>......] - ETA: 0s - loss: 0.3691 - accuracy: 0.715810/11 [==========================>...] - ETA: 0s - loss: 0.3694 - accuracy: 0.718811/11 [==============================] - ETA: 0s - loss: 0.3697 - accuracy: 0.721411/11 [==============================] - 1s 104ms/step - loss: 0.3699 - accuracy: 0.7235
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3724 - accuracy: 0.6484 2/11 [====>.........................] - ETA: 0s - loss: 0.3724 - accuracy: 0.6641 3/11 [=======>......................] - ETA: 0s - loss: 0.3707 - accuracy: 0.6684 4/11 [=========>....................] - ETA: 0s - loss: 0.3703 - accuracy: 0.6717 5/11 [============>.................] - ETA: 0s - loss: 0.3701 - accuracy: 0.6783 6/11 [===============>..............] - ETA: 0s - loss: 0.3701 - accuracy: 0.6842 7/11 [==================>...........] - ETA: 0s - loss: 0.3701 - accuracy: 0.6904 8/11 [====================>.........] - ETA: 0s - loss: 0.3700 - accuracy: 0.6975 9/11 [=======================>......] - ETA: 0s - loss: 0.3699 - accuracy: 0.703810/11 [==========================>...] - ETA: 0s - loss: 0.3699 - accuracy: 0.709311/11 [==============================] - ETA: 0s - loss: 0.3699 - accuracy: 0.713711/11 [==============================] - 1s 106ms/step - loss: 0.3698 - accuracy: 0.7174
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3566 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 0s - loss: 0.3583 - accuracy: 0.7832 3/11 [=======>......................] - ETA: 0s - loss: 0.3602 - accuracy: 0.7799 4/11 [=========>....................] - ETA: 0s - loss: 0.3612 - accuracy: 0.7808 5/11 [============>.................] - ETA: 0s - loss: 0.3618 - accuracy: 0.7799 6/11 [===============>..............] - ETA: 0s - loss: 0.3621 - accuracy: 0.7791 7/11 [==================>...........] - ETA: 0s - loss: 0.3624 - accuracy: 0.7778 8/11 [====================>.........] - ETA: 0s - loss: 0.3627 - accuracy: 0.7761 9/11 [=======================>......] - ETA: 0s - loss: 0.3628 - accuracy: 0.774910/11 [==========================>...] - ETA: 0s - loss: 0.3629 - accuracy: 0.774511/11 [==============================] - ETA: 0s - loss: 0.3630 - accuracy: 0.774811/11 [==============================] - 1s 102ms/step - loss: 0.3631 - accuracy: 0.7750
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3525 - accuracy: 0.9375 2/11 [====>.........................] - ETA: 0s - loss: 0.3552 - accuracy: 0.9258 3/11 [=======>......................] - ETA: 0s - loss: 0.3573 - accuracy: 0.9210 4/11 [=========>....................] - ETA: 0s - loss: 0.3590 - accuracy: 0.9163 5/11 [============>.................] - ETA: 0s - loss: 0.3601 - accuracy: 0.9137 6/11 [===============>..............] - ETA: 0s - loss: 0.3605 - accuracy: 0.9118 7/11 [==================>...........] - ETA: 0s - loss: 0.3610 - accuracy: 0.9072 8/11 [====================>.........] - ETA: 0s - loss: 0.3613 - accuracy: 0.9015 9/11 [=======================>......] - ETA: 0s - loss: 0.3614 - accuracy: 0.896310/11 [==========================>...] - ETA: 0s - loss: 0.3614 - accuracy: 0.891011/11 [==============================] - ETA: 0s - loss: 0.3614 - accuracy: 0.885711/11 [==============================] - 1s 104ms/step - loss: 0.3614 - accuracy: 0.8814
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3498 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 0s - loss: 0.3511 - accuracy: 0.7520 3/11 [=======>......................] - ETA: 0s - loss: 0.3523 - accuracy: 0.7600 4/11 [=========>....................] - ETA: 0s - loss: 0.3532 - accuracy: 0.7638 5/11 [============>.................] - ETA: 0s - loss: 0.3534 - accuracy: 0.7636 6/11 [===============>..............] - ETA: 0s - loss: 0.3539 - accuracy: 0.7635 7/11 [==================>...........] - ETA: 0s - loss: 0.3543 - accuracy: 0.7647 8/11 [====================>.........] - ETA: 0s - loss: 0.3546 - accuracy: 0.7666 9/11 [=======================>......] - ETA: 0s - loss: 0.3548 - accuracy: 0.768410/11 [==========================>...] - ETA: 0s - loss: 0.3550 - accuracy: 0.771411/11 [==============================] - ETA: 0s - loss: 0.3550 - accuracy: 0.774211/11 [==============================] - 1s 101ms/step - loss: 0.3550 - accuracy: 0.7765
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.3536 - accuracy: 0.78123/6 [==============>...............] - ETA: 0s - loss: 0.3558 - accuracy: 0.7839 5/6 [========================>.....] - ETA: 0s - loss: 0.3552 - accuracy: 0.79536/6 [==============================] - 4s 31ms/step - loss: 0.3549 - accuracy: 0.7932
2021-12-13 23:48:22.388310: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:48:22.389138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:48:22.389185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:48:22.389230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:48:22.389258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:48:22.389284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:48:22.389310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:48:22.389339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:48:22.389365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:48:22.389395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:48:22.390510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:48:22.390538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:48:22.390548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:48:22.390555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 2 0 1] pred: [-0.99510556 -0.9992514  -0.9868345   0.9660974  -0.9235639 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [-0.99998456 -0.9817311   0.9972238  -0.99998426 -0.9999951 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [-0.9999816  -0.98250735  0.9967871  -0.999983   -0.9999941 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [-0.99992424 -0.8580092   0.9712339  -0.9999937  -0.99999535]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [0 1 3 4 2] pred: [ 0.4830856  -0.5267139  -0.9909061  -0.91299725 -0.9792742 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 4 3] pred: [-0.9959713   0.9426087  -0.09567694 -0.9998377  -0.99970156]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 0 2 3 4] pred: [-0.91341114  0.36712003 -0.96231323 -0.9991676  -0.999434  ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [-0.9994597   0.64540786  0.9189231  -0.9999486  -0.9999541 ]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [1 0 2 3 4] pred: [-0.74970436  0.8278848  -0.912      -0.99785495 -0.99836713]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [-0.9999905  -0.9990393   0.9995209  -0.99997866 -0.99999106]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [0 1 3 4 2] pred: [ 0.5089155  -0.6440744  -0.9962383  -0.9319585  -0.98758286]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [0 1 3 4 2] pred: [ 0.406901   -0.81820047 -0.99767363 -0.9119315  -0.9869856 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [-0.9869414   0.89729524  0.4459407  -0.9994996  -0.9995521 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [-0.9999791 -0.9725348  0.9958658 -0.9999878 -0.9999952]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 4 3] pred: [-0.9932776  0.9862477  0.964062  -0.9999717 -0.9998516]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:03 - loss: 0.6929 - accuracy: 0.1328 2/11 [====>.........................] - ETA: 0s - loss: 0.6919 - accuracy: 0.1914   3/11 [=======>......................] - ETA: 0s - loss: 0.6910 - accuracy: 0.2214 4/11 [=========>....................] - ETA: 0s - loss: 0.6900 - accuracy: 0.2490 5/11 [============>.................] - ETA: 0s - loss: 0.6890 - accuracy: 0.2686 6/11 [===============>..............] - ETA: 0s - loss: 0.6881 - accuracy: 0.2837 7/11 [==================>...........] - ETA: 0s - loss: 0.6871 - accuracy: 0.2958 8/11 [====================>.........] - ETA: 0s - loss: 0.6861 - accuracy: 0.3077 9/11 [=======================>......] - ETA: 0s - loss: 0.6851 - accuracy: 0.318810/11 [==========================>...] - ETA: 0s - loss: 0.6840 - accuracy: 0.328711/11 [==============================] - ETA: 0s - loss: 0.6829 - accuracy: 0.337111/11 [==============================] - 13s 107ms/step - loss: 0.6821 - accuracy: 0.3441
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6443 - accuracy: 0.3438 2/11 [====>.........................] - ETA: 0s - loss: 0.6422 - accuracy: 0.3809 3/11 [=======>......................] - ETA: 0s - loss: 0.6399 - accuracy: 0.3980 4/11 [=========>....................] - ETA: 0s - loss: 0.6379 - accuracy: 0.4025 5/11 [============>.................] - ETA: 0s - loss: 0.6359 - accuracy: 0.4076 6/11 [===============>..............] - ETA: 0s - loss: 0.6338 - accuracy: 0.4130 7/11 [==================>...........] - ETA: 0s - loss: 0.6318 - accuracy: 0.4165 8/11 [====================>.........] - ETA: 0s - loss: 0.6298 - accuracy: 0.4194 9/11 [=======================>......] - ETA: 0s - loss: 0.6277 - accuracy: 0.422210/11 [==========================>...] - ETA: 0s - loss: 0.6254 - accuracy: 0.425511/11 [==============================] - ETA: 0s - loss: 0.6232 - accuracy: 0.428811/11 [==============================] - 1s 107ms/step - loss: 0.6213 - accuracy: 0.4316
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5446 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.5416 - accuracy: 0.4199 3/11 [=======>......................] - ETA: 0s - loss: 0.5379 - accuracy: 0.4232 4/11 [=========>....................] - ETA: 0s - loss: 0.5340 - accuracy: 0.4297 5/11 [============>.................] - ETA: 0s - loss: 0.5307 - accuracy: 0.4337 6/11 [===============>..............] - ETA: 0s - loss: 0.5277 - accuracy: 0.4357 7/11 [==================>...........] - ETA: 0s - loss: 0.5245 - accuracy: 0.4391 8/11 [====================>.........] - ETA: 0s - loss: 0.5219 - accuracy: 0.4420 9/11 [=======================>......] - ETA: 0s - loss: 0.5194 - accuracy: 0.444410/11 [==========================>...] - ETA: 0s - loss: 0.5173 - accuracy: 0.445911/11 [==============================] - ETA: 0s - loss: 0.5154 - accuracy: 0.447311/11 [==============================] - 1s 104ms/step - loss: 0.5138 - accuracy: 0.4486
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4738 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.4703 - accuracy: 0.4512 3/11 [=======>......................] - ETA: 0s - loss: 0.4688 - accuracy: 0.4605 4/11 [=========>....................] - ETA: 0s - loss: 0.4690 - accuracy: 0.4611 5/11 [============>.................] - ETA: 0s - loss: 0.4696 - accuracy: 0.4598 6/11 [===============>..............] - ETA: 0s - loss: 0.4694 - accuracy: 0.4613 7/11 [==================>...........] - ETA: 0s - loss: 0.4698 - accuracy: 0.4609 8/11 [====================>.........] - ETA: 0s - loss: 0.4697 - accuracy: 0.4619 9/11 [=======================>......] - ETA: 0s - loss: 0.4696 - accuracy: 0.462710/11 [==========================>...] - ETA: 0s - loss: 0.4696 - accuracy: 0.462611/11 [==============================] - ETA: 0s - loss: 0.4696 - accuracy: 0.462511/11 [==============================] - 1s 106ms/step - loss: 0.4696 - accuracy: 0.4625
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4683 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.4669 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 0s - loss: 0.4673 - accuracy: 0.4427 4/11 [=========>....................] - ETA: 0s - loss: 0.4680 - accuracy: 0.4458 5/11 [============>.................] - ETA: 0s - loss: 0.4681 - accuracy: 0.4491 6/11 [===============>..............] - ETA: 0s - loss: 0.4682 - accuracy: 0.4513 7/11 [==================>...........] - ETA: 0s - loss: 0.4682 - accuracy: 0.4535 8/11 [====================>.........] - ETA: 0s - loss: 0.4682 - accuracy: 0.4547 9/11 [=======================>......] - ETA: 0s - loss: 0.4683 - accuracy: 0.455610/11 [==========================>...] - ETA: 0s - loss: 0.4682 - accuracy: 0.455811/11 [==============================] - ETA: 0s - loss: 0.4680 - accuracy: 0.456311/11 [==============================] - 1s 104ms/step - loss: 0.4679 - accuracy: 0.4568
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4745 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.4692 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.4683 - accuracy: 0.4253 4/11 [=========>....................] - ETA: 0s - loss: 0.4683 - accuracy: 0.4269 5/11 [============>.................] - ETA: 0s - loss: 0.4689 - accuracy: 0.4278 6/11 [===============>..............] - ETA: 0s - loss: 0.4677 - accuracy: 0.4344 7/11 [==================>...........] - ETA: 0s - loss: 0.4668 - accuracy: 0.4385 8/11 [====================>.........] - ETA: 0s - loss: 0.4661 - accuracy: 0.4419 9/11 [=======================>......] - ETA: 0s - loss: 0.4657 - accuracy: 0.444210/11 [==========================>...] - ETA: 0s - loss: 0.4652 - accuracy: 0.446111/11 [==============================] - ETA: 0s - loss: 0.4647 - accuracy: 0.447611/11 [==============================] - 1s 103ms/step - loss: 0.4644 - accuracy: 0.4488
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4646 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.4626 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 0s - loss: 0.4603 - accuracy: 0.4761 4/11 [=========>....................] - ETA: 0s - loss: 0.4596 - accuracy: 0.4704 5/11 [============>.................] - ETA: 0s - loss: 0.4586 - accuracy: 0.4672 6/11 [===============>..............] - ETA: 0s - loss: 0.4576 - accuracy: 0.4640 7/11 [==================>...........] - ETA: 0s - loss: 0.4565 - accuracy: 0.4631 8/11 [====================>.........] - ETA: 0s - loss: 0.4557 - accuracy: 0.4623 9/11 [=======================>......] - ETA: 0s - loss: 0.4549 - accuracy: 0.462110/11 [==========================>...] - ETA: 0s - loss: 0.4543 - accuracy: 0.461711/11 [==============================] - ETA: 0s - loss: 0.4538 - accuracy: 0.461811/11 [==============================] - 1s 103ms/step - loss: 0.4533 - accuracy: 0.4618
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4116 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.4170 - accuracy: 0.4980 3/11 [=======>......................] - ETA: 0s - loss: 0.4223 - accuracy: 0.4883 4/11 [=========>....................] - ETA: 0s - loss: 0.4251 - accuracy: 0.4824 5/11 [============>.................] - ETA: 0s - loss: 0.4269 - accuracy: 0.4797 6/11 [===============>..............] - ETA: 0s - loss: 0.4279 - accuracy: 0.4770 7/11 [==================>...........] - ETA: 0s - loss: 0.4287 - accuracy: 0.4744 8/11 [====================>.........] - ETA: 0s - loss: 0.4293 - accuracy: 0.4733 9/11 [=======================>......] - ETA: 0s - loss: 0.4296 - accuracy: 0.472610/11 [==========================>...] - ETA: 0s - loss: 0.4297 - accuracy: 0.471911/11 [==============================] - ETA: 0s - loss: 0.4299 - accuracy: 0.471711/11 [==============================] - 1s 105ms/step - loss: 0.4300 - accuracy: 0.4715
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4299 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.4317 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 0s - loss: 0.4320 - accuracy: 0.4579 4/11 [=========>....................] - ETA: 0s - loss: 0.4312 - accuracy: 0.4582 5/11 [============>.................] - ETA: 0s - loss: 0.4308 - accuracy: 0.4593 6/11 [===============>..............] - ETA: 0s - loss: 0.4296 - accuracy: 0.4627 7/11 [==================>...........] - ETA: 0s - loss: 0.4286 - accuracy: 0.4669 8/11 [====================>.........] - ETA: 0s - loss: 0.4277 - accuracy: 0.4700 9/11 [=======================>......] - ETA: 0s - loss: 0.4268 - accuracy: 0.473110/11 [==========================>...] - ETA: 0s - loss: 0.4259 - accuracy: 0.474811/11 [==============================] - ETA: 0s - loss: 0.4251 - accuracy: 0.476511/11 [==============================] - 1s 106ms/step - loss: 0.4244 - accuracy: 0.4780
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4141 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.4118 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.4110 - accuracy: 0.5130 4/11 [=========>....................] - ETA: 0s - loss: 0.4102 - accuracy: 0.5161 5/11 [============>.................] - ETA: 0s - loss: 0.4095 - accuracy: 0.5173 6/11 [===============>..............] - ETA: 0s - loss: 0.4092 - accuracy: 0.5183 7/11 [==================>...........] - ETA: 0s - loss: 0.4089 - accuracy: 0.5195 8/11 [====================>.........] - ETA: 0s - loss: 0.4089 - accuracy: 0.5196 9/11 [=======================>......] - ETA: 0s - loss: 0.4090 - accuracy: 0.519110/11 [==========================>...] - ETA: 0s - loss: 0.4089 - accuracy: 0.518311/11 [==============================] - ETA: 0s - loss: 0.4088 - accuracy: 0.517411/11 [==============================] - 1s 105ms/step - loss: 0.4087 - accuracy: 0.5167
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4208 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.4181 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.4154 - accuracy: 0.4787 4/11 [=========>....................] - ETA: 0s - loss: 0.4125 - accuracy: 0.4845 5/11 [============>.................] - ETA: 0s - loss: 0.4109 - accuracy: 0.4876 6/11 [===============>..............] - ETA: 0s - loss: 0.4098 - accuracy: 0.4899 7/11 [==================>...........] - ETA: 0s - loss: 0.4090 - accuracy: 0.4921 8/11 [====================>.........] - ETA: 0s - loss: 0.4083 - accuracy: 0.4943 9/11 [=======================>......] - ETA: 0s - loss: 0.4077 - accuracy: 0.497210/11 [==========================>...] - ETA: 0s - loss: 0.4071 - accuracy: 0.500411/11 [==============================] - ETA: 0s - loss: 0.4066 - accuracy: 0.503011/11 [==============================] - 1s 104ms/step - loss: 0.4062 - accuracy: 0.5051
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4086 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.4022 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 0s - loss: 0.4028 - accuracy: 0.4957 4/11 [=========>....................] - ETA: 0s - loss: 0.4014 - accuracy: 0.5016 5/11 [============>.................] - ETA: 0s - loss: 0.4001 - accuracy: 0.5066 6/11 [===============>..............] - ETA: 0s - loss: 0.3995 - accuracy: 0.5109 7/11 [==================>...........] - ETA: 0s - loss: 0.3991 - accuracy: 0.5146 8/11 [====================>.........] - ETA: 0s - loss: 0.3985 - accuracy: 0.5189 9/11 [=======================>......] - ETA: 0s - loss: 0.3981 - accuracy: 0.522210/11 [==========================>...] - ETA: 0s - loss: 0.3977 - accuracy: 0.525111/11 [==============================] - ETA: 0s - loss: 0.3974 - accuracy: 0.527511/11 [==============================] - 1s 107ms/step - loss: 0.3972 - accuracy: 0.5295
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3958 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.3919 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.3912 - accuracy: 0.5339 4/11 [=========>....................] - ETA: 0s - loss: 0.3911 - accuracy: 0.5366 5/11 [============>.................] - ETA: 0s - loss: 0.3914 - accuracy: 0.5393 6/11 [===============>..............] - ETA: 0s - loss: 0.3914 - accuracy: 0.5419 7/11 [==================>...........] - ETA: 0s - loss: 0.3912 - accuracy: 0.5443 8/11 [====================>.........] - ETA: 0s - loss: 0.3911 - accuracy: 0.5475 9/11 [=======================>......] - ETA: 0s - loss: 0.3909 - accuracy: 0.549810/11 [==========================>...] - ETA: 0s - loss: 0.3908 - accuracy: 0.551411/11 [==============================] - ETA: 0s - loss: 0.3907 - accuracy: 0.553011/11 [==============================] - 1s 108ms/step - loss: 0.3906 - accuracy: 0.5544
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3913 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.3926 - accuracy: 0.6660 3/11 [=======>......................] - ETA: 0s - loss: 0.3917 - accuracy: 0.6766 4/11 [=========>....................] - ETA: 0s - loss: 0.3918 - accuracy: 0.6852 5/11 [============>.................] - ETA: 0s - loss: 0.3919 - accuracy: 0.6922 6/11 [===============>..............] - ETA: 0s - loss: 0.3916 - accuracy: 0.6982 7/11 [==================>...........] - ETA: 0s - loss: 0.3911 - accuracy: 0.7038 8/11 [====================>.........] - ETA: 0s - loss: 0.3907 - accuracy: 0.7069 9/11 [=======================>......] - ETA: 0s - loss: 0.3904 - accuracy: 0.708510/11 [==========================>...] - ETA: 0s - loss: 0.3899 - accuracy: 0.708411/11 [==============================] - ETA: 0s - loss: 0.3895 - accuracy: 0.707811/11 [==============================] - 1s 104ms/step - loss: 0.3891 - accuracy: 0.7073
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3745 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.3746 - accuracy: 0.6680 3/11 [=======>......................] - ETA: 0s - loss: 0.3775 - accuracy: 0.6866 4/11 [=========>....................] - ETA: 0s - loss: 0.3791 - accuracy: 0.6942 5/11 [============>.................] - ETA: 0s - loss: 0.3797 - accuracy: 0.6963 6/11 [===============>..............] - ETA: 0s - loss: 0.3804 - accuracy: 0.6972 7/11 [==================>...........] - ETA: 0s - loss: 0.3803 - accuracy: 0.6963 8/11 [====================>.........] - ETA: 0s - loss: 0.3802 - accuracy: 0.6943 9/11 [=======================>......] - ETA: 0s - loss: 0.3801 - accuracy: 0.692610/11 [==========================>...] - ETA: 0s - loss: 0.3800 - accuracy: 0.690711/11 [==============================] - ETA: 0s - loss: 0.3799 - accuracy: 0.690011/11 [==============================] - 1s 103ms/step - loss: 0.3798 - accuracy: 0.6894
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3594 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.3639 - accuracy: 0.7578 3/11 [=======>......................] - ETA: 0s - loss: 0.3669 - accuracy: 0.7639 4/11 [=========>....................] - ETA: 0s - loss: 0.3680 - accuracy: 0.7736 5/11 [============>.................] - ETA: 0s - loss: 0.3688 - accuracy: 0.7773 6/11 [===============>..............] - ETA: 0s - loss: 0.3698 - accuracy: 0.7758 7/11 [==================>...........] - ETA: 0s - loss: 0.3706 - accuracy: 0.7729 8/11 [====================>.........] - ETA: 0s - loss: 0.3710 - accuracy: 0.7700 9/11 [=======================>......] - ETA: 0s - loss: 0.3714 - accuracy: 0.767410/11 [==========================>...] - ETA: 0s - loss: 0.3717 - accuracy: 0.765011/11 [==============================] - ETA: 0s - loss: 0.3719 - accuracy: 0.763011/11 [==============================] - 1s 101ms/step - loss: 0.3721 - accuracy: 0.7614
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3661 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 0s - loss: 0.3657 - accuracy: 0.7637 3/11 [=======>......................] - ETA: 0s - loss: 0.3657 - accuracy: 0.7713 4/11 [=========>....................] - ETA: 0s - loss: 0.3664 - accuracy: 0.7733 5/11 [============>.................] - ETA: 0s - loss: 0.3670 - accuracy: 0.7730 6/11 [===============>..............] - ETA: 0s - loss: 0.3675 - accuracy: 0.7729 7/11 [==================>...........] - ETA: 0s - loss: 0.3678 - accuracy: 0.7729 8/11 [====================>.........] - ETA: 0s - loss: 0.3681 - accuracy: 0.7735 9/11 [=======================>......] - ETA: 0s - loss: 0.3683 - accuracy: 0.773710/11 [==========================>...] - ETA: 0s - loss: 0.3685 - accuracy: 0.772611/11 [==============================] - ETA: 0s - loss: 0.3686 - accuracy: 0.771911/11 [==============================] - 1s 102ms/step - loss: 0.3687 - accuracy: 0.7714
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3695 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.3689 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.3691 - accuracy: 0.7465 4/11 [=========>....................] - ETA: 0s - loss: 0.3687 - accuracy: 0.7542 5/11 [============>.................] - ETA: 0s - loss: 0.3687 - accuracy: 0.7603 6/11 [===============>..............] - ETA: 0s - loss: 0.3685 - accuracy: 0.7659 7/11 [==================>...........] - ETA: 0s - loss: 0.3683 - accuracy: 0.7699 8/11 [====================>.........] - ETA: 0s - loss: 0.3683 - accuracy: 0.7724 9/11 [=======================>......] - ETA: 0s - loss: 0.3682 - accuracy: 0.774110/11 [==========================>...] - ETA: 0s - loss: 0.3680 - accuracy: 0.775011/11 [==============================] - ETA: 0s - loss: 0.3678 - accuracy: 0.775511/11 [==============================] - 1s 101ms/step - loss: 0.3677 - accuracy: 0.7760
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3661 - accuracy: 0.7422 2/11 [====>.........................] - ETA: 0s - loss: 0.3676 - accuracy: 0.7129 3/11 [=======>......................] - ETA: 0s - loss: 0.3674 - accuracy: 0.7114 4/11 [=========>....................] - ETA: 0s - loss: 0.3676 - accuracy: 0.7113 5/11 [============>.................] - ETA: 0s - loss: 0.3668 - accuracy: 0.7140 6/11 [===============>..............] - ETA: 0s - loss: 0.3663 - accuracy: 0.7170 7/11 [==================>...........] - ETA: 0s - loss: 0.3659 - accuracy: 0.7198 8/11 [====================>.........] - ETA: 0s - loss: 0.3656 - accuracy: 0.7234 9/11 [=======================>......] - ETA: 0s - loss: 0.3654 - accuracy: 0.726410/11 [==========================>...] - ETA: 0s - loss: 0.3652 - accuracy: 0.729611/11 [==============================] - ETA: 0s - loss: 0.3651 - accuracy: 0.732511/11 [==============================] - 1s 105ms/step - loss: 0.3650 - accuracy: 0.7348
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3535 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 0s - loss: 0.3589 - accuracy: 0.8242 3/11 [=======>......................] - ETA: 0s - loss: 0.3592 - accuracy: 0.8186 4/11 [=========>....................] - ETA: 0s - loss: 0.3599 - accuracy: 0.8112 5/11 [============>.................] - ETA: 0s - loss: 0.3606 - accuracy: 0.8068 6/11 [===============>..............] - ETA: 0s - loss: 0.3613 - accuracy: 0.8027 7/11 [==================>...........] - ETA: 0s - loss: 0.3614 - accuracy: 0.8001 8/11 [====================>.........] - ETA: 0s - loss: 0.3615 - accuracy: 0.7985 9/11 [=======================>......] - ETA: 0s - loss: 0.3615 - accuracy: 0.797710/11 [==========================>...] - ETA: 0s - loss: 0.3615 - accuracy: 0.797011/11 [==============================] - ETA: 0s - loss: 0.3614 - accuracy: 0.796311/11 [==============================] - 1s 101ms/step - loss: 0.3613 - accuracy: 0.7957
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.3515 - accuracy: 0.81253/6 [==============>...............] - ETA: 0s - loss: 0.3538 - accuracy: 0.8021 5/6 [========================>.....] - ETA: 0s - loss: 0.3568 - accuracy: 0.80006/6 [==============================] - 4s 29ms/step - loss: 0.3567 - accuracy: 0.8003
2021-12-13 23:49:10.019658: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:49:10.020493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:49:10.020540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:49:10.020581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:49:10.020612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:49:10.020638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:49:10.020664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:49:10.020695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:49:10.020721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:49:10.020752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:49:10.021860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:49:10.021888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:49:10.021897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:49:10.021905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 3 0 4] pred: [-0.9993299   0.9924422   0.99029833 -0.99905705 -0.9999887 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [4 3 0 2 1] pred: [-0.8505101  -0.98917186 -0.95475054  0.15101397  0.4039001 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [-0.9918991  0.9906805  0.8851777 -0.9991183 -0.9999444]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 1 4 0] pred: [-0.9999925  -0.9981497   0.994662   -0.9970102  -0.99998343]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [0 1 4 3 2] pred: [ 0.80393124  0.14865202 -0.99177235 -0.9618338  -0.89763874]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [-0.9468491   0.9687327  -0.26132295 -0.9959821  -0.99832374]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 2 4 0 1] pred: [-0.9817951  -0.998999   -0.91555643  0.89131737 -0.97472113]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 4 0] pred: [-0.99999344 -0.99726933  0.99480563 -0.99722207 -0.99998695]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 4 3] pred: [-0.87518096  0.85175174 -0.83915114 -0.9961576  -0.9950473 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 4 0] pred: [-0.9999932  -0.998018    0.9957999  -0.99749964 -0.999987  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 4 0] pred: [-0.99999326 -0.9982207   0.99536526 -0.9973591  -0.99998575]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [-0.99965674  0.98194164  0.99373025 -0.9991817  -0.9999923 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [-0.99999243 -0.9967601   0.99606234 -0.99698234 -0.9999893 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 3 0 4] pred: [-0.9993621   0.9747739   0.9721569  -0.99912363 -0.999985  ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [-0.9999945  -0.99763817  0.99571    -0.9977329  -0.99998903]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:05 - loss: 0.6922 - accuracy: 0.2812 2/11 [====>.........................] - ETA: 1s - loss: 0.6913 - accuracy: 0.3027   3/11 [=======>......................] - ETA: 0s - loss: 0.6903 - accuracy: 0.3121 4/11 [=========>....................] - ETA: 0s - loss: 0.6894 - accuracy: 0.3180 5/11 [============>.................] - ETA: 0s - loss: 0.6884 - accuracy: 0.3226 6/11 [===============>..............] - ETA: 0s - loss: 0.6874 - accuracy: 0.3283 7/11 [==================>...........] - ETA: 0s - loss: 0.6864 - accuracy: 0.3372 8/11 [====================>.........] - ETA: 0s - loss: 0.6854 - accuracy: 0.3453 9/11 [=======================>......] - ETA: 0s - loss: 0.6843 - accuracy: 0.353710/11 [==========================>...] - ETA: 0s - loss: 0.6833 - accuracy: 0.363011/11 [==============================] - ETA: 0s - loss: 0.6823 - accuracy: 0.372011/11 [==============================] - 14s 104ms/step - loss: 0.6814 - accuracy: 0.3795
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6381 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 0s - loss: 0.6378 - accuracy: 0.7051 3/11 [=======>......................] - ETA: 0s - loss: 0.6366 - accuracy: 0.6827 4/11 [=========>....................] - ETA: 0s - loss: 0.6352 - accuracy: 0.6678 5/11 [============>.................] - ETA: 0s - loss: 0.6335 - accuracy: 0.6555 6/11 [===============>..............] - ETA: 0s - loss: 0.6316 - accuracy: 0.6443 7/11 [==================>...........] - ETA: 0s - loss: 0.6296 - accuracy: 0.6336 8/11 [====================>.........] - ETA: 0s - loss: 0.6276 - accuracy: 0.6232 9/11 [=======================>......] - ETA: 0s - loss: 0.6255 - accuracy: 0.614510/11 [==========================>...] - ETA: 0s - loss: 0.6233 - accuracy: 0.607611/11 [==============================] - ETA: 0s - loss: 0.6212 - accuracy: 0.601611/11 [==============================] - 1s 106ms/step - loss: 0.6195 - accuracy: 0.5966
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5400 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.5367 - accuracy: 0.4590 3/11 [=======>......................] - ETA: 0s - loss: 0.5342 - accuracy: 0.4570 4/11 [=========>....................] - ETA: 0s - loss: 0.5321 - accuracy: 0.4541 5/11 [============>.................] - ETA: 0s - loss: 0.5298 - accuracy: 0.4517 6/11 [===============>..............] - ETA: 0s - loss: 0.5278 - accuracy: 0.4511 7/11 [==================>...........] - ETA: 0s - loss: 0.5255 - accuracy: 0.4509 8/11 [====================>.........] - ETA: 0s - loss: 0.5231 - accuracy: 0.4518 9/11 [=======================>......] - ETA: 0s - loss: 0.5208 - accuracy: 0.452910/11 [==========================>...] - ETA: 0s - loss: 0.5187 - accuracy: 0.454211/11 [==============================] - ETA: 0s - loss: 0.5167 - accuracy: 0.455111/11 [==============================] - 1s 102ms/step - loss: 0.5150 - accuracy: 0.4560
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4629 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.4628 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.4634 - accuracy: 0.4718 4/11 [=========>....................] - ETA: 0s - loss: 0.4641 - accuracy: 0.4686 5/11 [============>.................] - ETA: 0s - loss: 0.4648 - accuracy: 0.4664 6/11 [===============>..............] - ETA: 0s - loss: 0.4649 - accuracy: 0.4660 7/11 [==================>...........] - ETA: 0s - loss: 0.4654 - accuracy: 0.4649 8/11 [====================>.........] - ETA: 0s - loss: 0.4656 - accuracy: 0.4645 9/11 [=======================>......] - ETA: 0s - loss: 0.4657 - accuracy: 0.464010/11 [==========================>...] - ETA: 0s - loss: 0.4656 - accuracy: 0.463711/11 [==============================] - ETA: 0s - loss: 0.4654 - accuracy: 0.463811/11 [==============================] - 1s 102ms/step - loss: 0.4652 - accuracy: 0.4639
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4487 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.4537 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 0s - loss: 0.4548 - accuracy: 0.4562 4/11 [=========>....................] - ETA: 0s - loss: 0.4561 - accuracy: 0.4491 5/11 [============>.................] - ETA: 0s - loss: 0.4568 - accuracy: 0.4480 6/11 [===============>..............] - ETA: 0s - loss: 0.4574 - accuracy: 0.4486 7/11 [==================>...........] - ETA: 0s - loss: 0.4575 - accuracy: 0.4499 8/11 [====================>.........] - ETA: 0s - loss: 0.4573 - accuracy: 0.4512 9/11 [=======================>......] - ETA: 0s - loss: 0.4573 - accuracy: 0.451410/11 [==========================>...] - ETA: 0s - loss: 0.4571 - accuracy: 0.452211/11 [==============================] - ETA: 0s - loss: 0.4567 - accuracy: 0.453311/11 [==============================] - 1s 105ms/step - loss: 0.4564 - accuracy: 0.4543
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4307 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.4288 - accuracy: 0.5332 3/11 [=======>......................] - ETA: 0s - loss: 0.4301 - accuracy: 0.5256 4/11 [=========>....................] - ETA: 0s - loss: 0.4326 - accuracy: 0.5153 5/11 [============>.................] - ETA: 0s - loss: 0.4346 - accuracy: 0.5060 6/11 [===============>..............] - ETA: 0s - loss: 0.4356 - accuracy: 0.4998 7/11 [==================>...........] - ETA: 0s - loss: 0.4357 - accuracy: 0.4960 8/11 [====================>.........] - ETA: 0s - loss: 0.4363 - accuracy: 0.4911 9/11 [=======================>......] - ETA: 0s - loss: 0.4368 - accuracy: 0.487010/11 [==========================>...] - ETA: 0s - loss: 0.4371 - accuracy: 0.484211/11 [==============================] - ETA: 0s - loss: 0.4373 - accuracy: 0.482511/11 [==============================] - 1s 103ms/step - loss: 0.4374 - accuracy: 0.4810
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4529 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.4468 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.4434 - accuracy: 0.4644 4/11 [=========>....................] - ETA: 0s - loss: 0.4410 - accuracy: 0.4611 5/11 [============>.................] - ETA: 0s - loss: 0.4394 - accuracy: 0.4614 6/11 [===============>..............] - ETA: 0s - loss: 0.4380 - accuracy: 0.4620 7/11 [==================>...........] - ETA: 0s - loss: 0.4367 - accuracy: 0.4628 8/11 [====================>.........] - ETA: 0s - loss: 0.4354 - accuracy: 0.4647 9/11 [=======================>......] - ETA: 0s - loss: 0.4343 - accuracy: 0.466910/11 [==========================>...] - ETA: 0s - loss: 0.4335 - accuracy: 0.467911/11 [==============================] - ETA: 0s - loss: 0.4328 - accuracy: 0.468311/11 [==============================] - 1s 103ms/step - loss: 0.4322 - accuracy: 0.4687
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4024 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 0s - loss: 0.4096 - accuracy: 0.5293 3/11 [=======>......................] - ETA: 0s - loss: 0.4098 - accuracy: 0.5265 4/11 [=========>....................] - ETA: 0s - loss: 0.4110 - accuracy: 0.5252 5/11 [============>.................] - ETA: 0s - loss: 0.4115 - accuracy: 0.5255 6/11 [===============>..............] - ETA: 0s - loss: 0.4120 - accuracy: 0.5260 7/11 [==================>...........] - ETA: 0s - loss: 0.4127 - accuracy: 0.5252 8/11 [====================>.........] - ETA: 0s - loss: 0.4134 - accuracy: 0.5246 9/11 [=======================>......] - ETA: 0s - loss: 0.4138 - accuracy: 0.524610/11 [==========================>...] - ETA: 0s - loss: 0.4139 - accuracy: 0.524111/11 [==============================] - ETA: 0s - loss: 0.4140 - accuracy: 0.523711/11 [==============================] - 1s 101ms/step - loss: 0.4141 - accuracy: 0.5233
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4095 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 0s - loss: 0.4122 - accuracy: 0.6543 3/11 [=======>......................] - ETA: 0s - loss: 0.4138 - accuracy: 0.6402 4/11 [=========>....................] - ETA: 0s - loss: 0.4139 - accuracy: 0.6335 5/11 [============>.................] - ETA: 0s - loss: 0.4131 - accuracy: 0.6296 6/11 [===============>..............] - ETA: 0s - loss: 0.4123 - accuracy: 0.6238 7/11 [==================>...........] - ETA: 0s - loss: 0.4113 - accuracy: 0.6183 8/11 [====================>.........] - ETA: 0s - loss: 0.4107 - accuracy: 0.6131 9/11 [=======================>......] - ETA: 0s - loss: 0.4103 - accuracy: 0.608810/11 [==========================>...] - ETA: 0s - loss: 0.4101 - accuracy: 0.605211/11 [==============================] - ETA: 0s - loss: 0.4099 - accuracy: 0.602311/11 [==============================] - 1s 102ms/step - loss: 0.4097 - accuracy: 0.5999
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4246 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.4200 - accuracy: 0.5215 3/11 [=======>......................] - ETA: 0s - loss: 0.4172 - accuracy: 0.5308 4/11 [=========>....................] - ETA: 0s - loss: 0.4151 - accuracy: 0.5334 5/11 [============>.................] - ETA: 0s - loss: 0.4133 - accuracy: 0.5354 6/11 [===============>..............] - ETA: 0s - loss: 0.4121 - accuracy: 0.5330 7/11 [==================>...........] - ETA: 0s - loss: 0.4111 - accuracy: 0.5315 8/11 [====================>.........] - ETA: 0s - loss: 0.4102 - accuracy: 0.5306 9/11 [=======================>......] - ETA: 0s - loss: 0.4094 - accuracy: 0.530410/11 [==========================>...] - ETA: 0s - loss: 0.4089 - accuracy: 0.530211/11 [==============================] - ETA: 0s - loss: 0.4083 - accuracy: 0.530311/11 [==============================] - 1s 100ms/step - loss: 0.4077 - accuracy: 0.5304
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4147 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.4129 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.4106 - accuracy: 0.5208 4/11 [=========>....................] - ETA: 0s - loss: 0.4089 - accuracy: 0.5249 5/11 [============>.................] - ETA: 0s - loss: 0.4075 - accuracy: 0.5255 6/11 [===============>..............] - ETA: 0s - loss: 0.4066 - accuracy: 0.5243 7/11 [==================>...........] - ETA: 0s - loss: 0.4060 - accuracy: 0.5234 8/11 [====================>.........] - ETA: 0s - loss: 0.4053 - accuracy: 0.5237 9/11 [=======================>......] - ETA: 0s - loss: 0.4044 - accuracy: 0.524310/11 [==========================>...] - ETA: 0s - loss: 0.4038 - accuracy: 0.525211/11 [==============================] - ETA: 0s - loss: 0.4033 - accuracy: 0.526111/11 [==============================] - 1s 105ms/step - loss: 0.4029 - accuracy: 0.5268
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4050 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.4078 - accuracy: 0.5215 3/11 [=======>......................] - ETA: 0s - loss: 0.4083 - accuracy: 0.5326 4/11 [=========>....................] - ETA: 0s - loss: 0.4067 - accuracy: 0.5356 5/11 [============>.................] - ETA: 0s - loss: 0.4061 - accuracy: 0.5357 6/11 [===============>..............] - ETA: 0s - loss: 0.4054 - accuracy: 0.5347 7/11 [==================>...........] - ETA: 0s - loss: 0.4045 - accuracy: 0.5344 8/11 [====================>.........] - ETA: 0s - loss: 0.4038 - accuracy: 0.5334 9/11 [=======================>......] - ETA: 0s - loss: 0.4030 - accuracy: 0.533110/11 [==========================>...] - ETA: 0s - loss: 0.4021 - accuracy: 0.532511/11 [==============================] - ETA: 0s - loss: 0.4015 - accuracy: 0.532611/11 [==============================] - 1s 111ms/step - loss: 0.4009 - accuracy: 0.5327
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3988 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 1s - loss: 0.4025 - accuracy: 0.5645 3/11 [=======>......................] - ETA: 0s - loss: 0.4007 - accuracy: 0.5586 4/11 [=========>....................] - ETA: 0s - loss: 0.3987 - accuracy: 0.5586 5/11 [============>.................] - ETA: 0s - loss: 0.3979 - accuracy: 0.5538 6/11 [===============>..............] - ETA: 0s - loss: 0.3970 - accuracy: 0.5520 7/11 [==================>...........] - ETA: 0s - loss: 0.3963 - accuracy: 0.5496 8/11 [====================>.........] - ETA: 0s - loss: 0.3955 - accuracy: 0.5486 9/11 [=======================>......] - ETA: 0s - loss: 0.3951 - accuracy: 0.548410/11 [==========================>...] - ETA: 0s - loss: 0.3947 - accuracy: 0.548611/11 [==============================] - ETA: 0s - loss: 0.3945 - accuracy: 0.549211/11 [==============================] - 1s 109ms/step - loss: 0.3944 - accuracy: 0.5498
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3880 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.3845 - accuracy: 0.6348 3/11 [=======>......................] - ETA: 0s - loss: 0.3846 - accuracy: 0.6341 4/11 [=========>....................] - ETA: 0s - loss: 0.3843 - accuracy: 0.6309 5/11 [============>.................] - ETA: 0s - loss: 0.3845 - accuracy: 0.6284 6/11 [===============>..............] - ETA: 0s - loss: 0.3846 - accuracy: 0.6253 7/11 [==================>...........] - ETA: 0s - loss: 0.3845 - accuracy: 0.6216 8/11 [====================>.........] - ETA: 0s - loss: 0.3846 - accuracy: 0.6187 9/11 [=======================>......] - ETA: 0s - loss: 0.3847 - accuracy: 0.616810/11 [==========================>...] - ETA: 0s - loss: 0.3849 - accuracy: 0.615711/11 [==============================] - ETA: 0s - loss: 0.3851 - accuracy: 0.614611/11 [==============================] - 1s 107ms/step - loss: 0.3853 - accuracy: 0.6138
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3915 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.3894 - accuracy: 0.6523 3/11 [=======>......................] - ETA: 0s - loss: 0.3883 - accuracy: 0.6424 4/11 [=========>....................] - ETA: 0s - loss: 0.3878 - accuracy: 0.6366 5/11 [============>.................] - ETA: 0s - loss: 0.3872 - accuracy: 0.6308 6/11 [===============>..............] - ETA: 0s - loss: 0.3871 - accuracy: 0.6272 7/11 [==================>...........] - ETA: 0s - loss: 0.3868 - accuracy: 0.6250 8/11 [====================>.........] - ETA: 0s - loss: 0.3863 - accuracy: 0.6233 9/11 [=======================>......] - ETA: 0s - loss: 0.3860 - accuracy: 0.622210/11 [==========================>...] - ETA: 0s - loss: 0.3857 - accuracy: 0.622111/11 [==============================] - ETA: 0s - loss: 0.3853 - accuracy: 0.622411/11 [==============================] - 1s 102ms/step - loss: 0.3849 - accuracy: 0.6226
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3707 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 0s - loss: 0.3696 - accuracy: 0.6973 3/11 [=======>......................] - ETA: 0s - loss: 0.3686 - accuracy: 0.7166 4/11 [=========>....................] - ETA: 0s - loss: 0.3685 - accuracy: 0.7235 5/11 [============>.................] - ETA: 0s - loss: 0.3689 - accuracy: 0.7247 6/11 [===============>..............] - ETA: 0s - loss: 0.3695 - accuracy: 0.7229 7/11 [==================>...........] - ETA: 0s - loss: 0.3700 - accuracy: 0.7213 8/11 [====================>.........] - ETA: 0s - loss: 0.3707 - accuracy: 0.7199 9/11 [=======================>......] - ETA: 0s - loss: 0.3713 - accuracy: 0.718110/11 [==========================>...] - ETA: 0s - loss: 0.3717 - accuracy: 0.716311/11 [==============================] - ETA: 0s - loss: 0.3722 - accuracy: 0.715011/11 [==============================] - 1s 103ms/step - loss: 0.3725 - accuracy: 0.7139
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3689 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 1s - loss: 0.3701 - accuracy: 0.7109 3/11 [=======>......................] - ETA: 0s - loss: 0.3706 - accuracy: 0.7109 4/11 [=========>....................] - ETA: 0s - loss: 0.3707 - accuracy: 0.7090 5/11 [============>.................] - ETA: 0s - loss: 0.3708 - accuracy: 0.7091 6/11 [===============>..............] - ETA: 0s - loss: 0.3710 - accuracy: 0.7105 7/11 [==================>...........] - ETA: 0s - loss: 0.3712 - accuracy: 0.7124 8/11 [====================>.........] - ETA: 0s - loss: 0.3713 - accuracy: 0.7145 9/11 [=======================>......] - ETA: 0s - loss: 0.3714 - accuracy: 0.716810/11 [==========================>...] - ETA: 0s - loss: 0.3715 - accuracy: 0.719411/11 [==============================] - ETA: 0s - loss: 0.3717 - accuracy: 0.721711/11 [==============================] - 1s 103ms/step - loss: 0.3717 - accuracy: 0.7236
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3636 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.3699 - accuracy: 0.7246 3/11 [=======>......................] - ETA: 0s - loss: 0.3709 - accuracy: 0.7305 4/11 [=========>....................] - ETA: 0s - loss: 0.3708 - accuracy: 0.7310 5/11 [============>.................] - ETA: 0s - loss: 0.3711 - accuracy: 0.7320 6/11 [===============>..............] - ETA: 0s - loss: 0.3712 - accuracy: 0.7345 7/11 [==================>...........] - ETA: 0s - loss: 0.3712 - accuracy: 0.7369 8/11 [====================>.........] - ETA: 0s - loss: 0.3711 - accuracy: 0.7407 9/11 [=======================>......] - ETA: 0s - loss: 0.3709 - accuracy: 0.744810/11 [==========================>...] - ETA: 0s - loss: 0.3707 - accuracy: 0.748911/11 [==============================] - ETA: 0s - loss: 0.3706 - accuracy: 0.752911/11 [==============================] - 1s 99ms/step - loss: 0.3704 - accuracy: 0.7562
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3734 - accuracy: 0.8203 2/11 [====>.........................] - ETA: 0s - loss: 0.3702 - accuracy: 0.8281 3/11 [=======>......................] - ETA: 0s - loss: 0.3690 - accuracy: 0.8342 4/11 [=========>....................] - ETA: 0s - loss: 0.3684 - accuracy: 0.8366 5/11 [============>.................] - ETA: 0s - loss: 0.3683 - accuracy: 0.8386 6/11 [===============>..............] - ETA: 0s - loss: 0.3681 - accuracy: 0.8397 7/11 [==================>...........] - ETA: 0s - loss: 0.3677 - accuracy: 0.8398 8/11 [====================>.........] - ETA: 0s - loss: 0.3675 - accuracy: 0.8386 9/11 [=======================>......] - ETA: 0s - loss: 0.3673 - accuracy: 0.836910/11 [==========================>...] - ETA: 0s - loss: 0.3671 - accuracy: 0.834411/11 [==============================] - ETA: 0s - loss: 0.3669 - accuracy: 0.832011/11 [==============================] - 1s 105ms/step - loss: 0.3667 - accuracy: 0.8300
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3701 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.3699 - accuracy: 0.7266 3/11 [=======>......................] - ETA: 0s - loss: 0.3679 - accuracy: 0.7292 4/11 [=========>....................] - ETA: 0s - loss: 0.3661 - accuracy: 0.7324 5/11 [============>.................] - ETA: 0s - loss: 0.3653 - accuracy: 0.7341 6/11 [===============>..............] - ETA: 0s - loss: 0.3649 - accuracy: 0.7372 7/11 [==================>...........] - ETA: 0s - loss: 0.3646 - accuracy: 0.7412 8/11 [====================>.........] - ETA: 0s - loss: 0.3643 - accuracy: 0.7461 9/11 [=======================>......] - ETA: 0s - loss: 0.3641 - accuracy: 0.751310/11 [==========================>...] - ETA: 0s - loss: 0.3639 - accuracy: 0.756011/11 [==============================] - ETA: 0s - loss: 0.3637 - accuracy: 0.760411/11 [==============================] - 1s 103ms/step - loss: 0.3636 - accuracy: 0.7640
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.3770 - accuracy: 0.75783/6 [==============>...............] - ETA: 0s - loss: 0.3713 - accuracy: 0.7917 5/6 [========================>.....] - ETA: 0s - loss: 0.3669 - accuracy: 0.77506/6 [==============================] - 4s 31ms/step - loss: 0.3672 - accuracy: 0.7762
2021-12-13 23:49:57.712968: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:49:57.714026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:49:57.714087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:49:57.714145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:49:57.714192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:49:57.714237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:49:57.714267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:49:57.714296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:49:57.714337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:49:57.714366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:49:57.715637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:49:57.715670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:49:57.715681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:49:57.715690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [-0.9993935   0.90243906  0.977944   -0.9992661  -0.9999962 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [-0.9959176   0.950232    0.87135154 -0.99595016 -0.9999534 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [-0.9992137   0.98004943  0.9793648  -0.9996144  -0.99999624]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 2 0 1] pred: [-0.9913269  -0.9984674  -0.9842208   0.89056146 -0.9507126 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 0 4] pred: [-0.99985844 -0.99237925  0.971829   -0.9439169  -0.99997085]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 2 0 1] pred: [-0.99694645 -0.99948305 -0.9794376   0.83275235 -0.9723914 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [-0.9999548  -0.9940158   0.99796265 -0.9980932  -0.9999808 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [-0.99910486  0.9756404   0.98024434 -0.999566   -0.99999565]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [0 4 3 1 2] pred: [-0.08494832 -0.2551736  -0.4724124  -0.13771737 -0.1238468 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [-0.9986094   0.92696196  0.94544405 -0.99841607 -0.9999888 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [-0.99908465  0.9744077   0.9741207  -0.9994901  -0.99999505]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [-0.9998757   0.4937547   0.9864854  -0.99915695 -0.99999535]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 0 2 3 4] pred: [-0.6961355  -0.10844033 -0.9035694  -0.9045368  -0.9206587 ]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [4 3 2 0 1] pred: [-0.9242242  -0.97611046 -0.869604   -0.40840572  0.36585656]
 Top predictions indices: [4 3] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [-0.9994231   0.9767708   0.9810889  -0.99966836 -0.999997  ]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:06 - loss: 0.6949 - accuracy: 0.0234 2/11 [====>.........................] - ETA: 0s - loss: 0.6937 - accuracy: 0.0664   3/11 [=======>......................] - ETA: 0s - loss: 0.6925 - accuracy: 0.1189 4/11 [=========>....................] - ETA: 0s - loss: 0.6914 - accuracy: 0.1580 5/11 [============>.................] - ETA: 0s - loss: 0.6903 - accuracy: 0.1902 6/11 [===============>..............] - ETA: 0s - loss: 0.6892 - accuracy: 0.2143 7/11 [==================>...........] - ETA: 0s - loss: 0.6881 - accuracy: 0.2344 8/11 [====================>.........] - ETA: 0s - loss: 0.6869 - accuracy: 0.2507 9/11 [=======================>......] - ETA: 0s - loss: 0.6858 - accuracy: 0.264410/11 [==========================>...] - ETA: 0s - loss: 0.6846 - accuracy: 0.275911/11 [==============================] - ETA: 0s - loss: 0.6835 - accuracy: 0.286111/11 [==============================] - 14s 107ms/step - loss: 0.6825 - accuracy: 0.2946
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6364 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.6348 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.6336 - accuracy: 0.4583 4/11 [=========>....................] - ETA: 0s - loss: 0.6318 - accuracy: 0.4595 5/11 [============>.................] - ETA: 0s - loss: 0.6298 - accuracy: 0.4607 6/11 [===============>..............] - ETA: 0s - loss: 0.6278 - accuracy: 0.4616 7/11 [==================>...........] - ETA: 0s - loss: 0.6259 - accuracy: 0.4609 8/11 [====================>.........] - ETA: 0s - loss: 0.6237 - accuracy: 0.4600 9/11 [=======================>......] - ETA: 0s - loss: 0.6215 - accuracy: 0.459710/11 [==========================>...] - ETA: 0s - loss: 0.6192 - accuracy: 0.459911/11 [==============================] - ETA: 0s - loss: 0.6170 - accuracy: 0.459611/11 [==============================] - 1s 104ms/step - loss: 0.6152 - accuracy: 0.4594
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5398 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.5338 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.5288 - accuracy: 0.4670 4/11 [=========>....................] - ETA: 0s - loss: 0.5259 - accuracy: 0.4660 5/11 [============>.................] - ETA: 0s - loss: 0.5229 - accuracy: 0.4659 6/11 [===============>..............] - ETA: 0s - loss: 0.5204 - accuracy: 0.4651 7/11 [==================>...........] - ETA: 0s - loss: 0.5182 - accuracy: 0.4640 8/11 [====================>.........] - ETA: 0s - loss: 0.5164 - accuracy: 0.4630 9/11 [=======================>......] - ETA: 0s - loss: 0.5147 - accuracy: 0.462310/11 [==========================>...] - ETA: 0s - loss: 0.5132 - accuracy: 0.461511/11 [==============================] - ETA: 0s - loss: 0.5118 - accuracy: 0.461111/11 [==============================] - 1s 104ms/step - loss: 0.5106 - accuracy: 0.4608
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4690 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.4705 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 0s - loss: 0.4708 - accuracy: 0.4913 4/11 [=========>....................] - ETA: 0s - loss: 0.4702 - accuracy: 0.4920 5/11 [============>.................] - ETA: 0s - loss: 0.4711 - accuracy: 0.4889 6/11 [===============>..............] - ETA: 0s - loss: 0.4717 - accuracy: 0.4847 7/11 [==================>...........] - ETA: 0s - loss: 0.4723 - accuracy: 0.4808 8/11 [====================>.........] - ETA: 0s - loss: 0.4727 - accuracy: 0.4781 9/11 [=======================>......] - ETA: 0s - loss: 0.4730 - accuracy: 0.476210/11 [==========================>...] - ETA: 0s - loss: 0.4732 - accuracy: 0.474411/11 [==============================] - ETA: 0s - loss: 0.4735 - accuracy: 0.472811/11 [==============================] - 1s 109ms/step - loss: 0.4737 - accuracy: 0.4714
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4876 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.4855 - accuracy: 0.4160 3/11 [=======>......................] - ETA: 0s - loss: 0.4824 - accuracy: 0.4214 4/11 [=========>....................] - ETA: 0s - loss: 0.4812 - accuracy: 0.4259 5/11 [============>.................] - ETA: 0s - loss: 0.4807 - accuracy: 0.4286 6/11 [===============>..............] - ETA: 0s - loss: 0.4802 - accuracy: 0.4290 7/11 [==================>...........] - ETA: 0s - loss: 0.4794 - accuracy: 0.4310 8/11 [====================>.........] - ETA: 0s - loss: 0.4787 - accuracy: 0.4325 9/11 [=======================>......] - ETA: 0s - loss: 0.4778 - accuracy: 0.434510/11 [==========================>...] - ETA: 0s - loss: 0.4770 - accuracy: 0.436511/11 [==============================] - ETA: 0s - loss: 0.4763 - accuracy: 0.438311/11 [==============================] - 1s 108ms/step - loss: 0.4758 - accuracy: 0.4399
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4720 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.4739 - accuracy: 0.4023 3/11 [=======>......................] - ETA: 0s - loss: 0.4723 - accuracy: 0.4062 4/11 [=========>....................] - ETA: 0s - loss: 0.4718 - accuracy: 0.4116 5/11 [============>.................] - ETA: 0s - loss: 0.4709 - accuracy: 0.4174 6/11 [===============>..............] - ETA: 0s - loss: 0.4706 - accuracy: 0.4214 7/11 [==================>...........] - ETA: 0s - loss: 0.4702 - accuracy: 0.4239 8/11 [====================>.........] - ETA: 0s - loss: 0.4697 - accuracy: 0.4266 9/11 [=======================>......] - ETA: 0s - loss: 0.4690 - accuracy: 0.429610/11 [==========================>...] - ETA: 0s - loss: 0.4683 - accuracy: 0.432211/11 [==============================] - ETA: 0s - loss: 0.4676 - accuracy: 0.434411/11 [==============================] - 1s 108ms/step - loss: 0.4670 - accuracy: 0.4363
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4772 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.4720 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.4692 - accuracy: 0.4106 4/11 [=========>....................] - ETA: 0s - loss: 0.4657 - accuracy: 0.4163 5/11 [============>.................] - ETA: 0s - loss: 0.4633 - accuracy: 0.4212 6/11 [===============>..............] - ETA: 0s - loss: 0.4609 - accuracy: 0.4261 7/11 [==================>...........] - ETA: 0s - loss: 0.4592 - accuracy: 0.4306 8/11 [====================>.........] - ETA: 0s - loss: 0.4579 - accuracy: 0.4338 9/11 [=======================>......] - ETA: 0s - loss: 0.4570 - accuracy: 0.436910/11 [==========================>...] - ETA: 0s - loss: 0.4562 - accuracy: 0.438711/11 [==============================] - ETA: 0s - loss: 0.4555 - accuracy: 0.440411/11 [==============================] - 1s 111ms/step - loss: 0.4549 - accuracy: 0.4418
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4277 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.4290 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.4309 - accuracy: 0.4800 4/11 [=========>....................] - ETA: 0s - loss: 0.4335 - accuracy: 0.4743 5/11 [============>.................] - ETA: 0s - loss: 0.4350 - accuracy: 0.4710 6/11 [===============>..............] - ETA: 0s - loss: 0.4358 - accuracy: 0.4684 7/11 [==================>...........] - ETA: 0s - loss: 0.4361 - accuracy: 0.4672 8/11 [====================>.........] - ETA: 0s - loss: 0.4364 - accuracy: 0.4657 9/11 [=======================>......] - ETA: 0s - loss: 0.4364 - accuracy: 0.465810/11 [==========================>...] - ETA: 0s - loss: 0.4363 - accuracy: 0.465711/11 [==============================] - ETA: 0s - loss: 0.4362 - accuracy: 0.465711/11 [==============================] - 1s 107ms/step - loss: 0.4360 - accuracy: 0.4656
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4500 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.4372 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 0s - loss: 0.4343 - accuracy: 0.4813 4/11 [=========>....................] - ETA: 0s - loss: 0.4316 - accuracy: 0.4880 5/11 [============>.................] - ETA: 0s - loss: 0.4301 - accuracy: 0.4941 6/11 [===============>..............] - ETA: 0s - loss: 0.4294 - accuracy: 0.4973 7/11 [==================>...........] - ETA: 0s - loss: 0.4291 - accuracy: 0.4983 8/11 [====================>.........] - ETA: 0s - loss: 0.4288 - accuracy: 0.4990 9/11 [=======================>......] - ETA: 0s - loss: 0.4285 - accuracy: 0.500010/11 [==========================>...] - ETA: 0s - loss: 0.4280 - accuracy: 0.501911/11 [==============================] - ETA: 0s - loss: 0.4275 - accuracy: 0.504011/11 [==============================] - 1s 108ms/step - loss: 0.4271 - accuracy: 0.5058
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4152 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 0s - loss: 0.4120 - accuracy: 0.5664 3/11 [=======>......................] - ETA: 0s - loss: 0.4112 - accuracy: 0.5677 4/11 [=========>....................] - ETA: 0s - loss: 0.4109 - accuracy: 0.5703 5/11 [============>.................] - ETA: 0s - loss: 0.4112 - accuracy: 0.5678 6/11 [===============>..............] - ETA: 0s - loss: 0.4114 - accuracy: 0.5661 7/11 [==================>...........] - ETA: 0s - loss: 0.4116 - accuracy: 0.5648 8/11 [====================>.........] - ETA: 0s - loss: 0.4116 - accuracy: 0.5641 9/11 [=======================>......] - ETA: 0s - loss: 0.4117 - accuracy: 0.562910/11 [==========================>...] - ETA: 0s - loss: 0.4115 - accuracy: 0.561711/11 [==============================] - ETA: 0s - loss: 0.4113 - accuracy: 0.561011/11 [==============================] - 1s 108ms/step - loss: 0.4111 - accuracy: 0.5603
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4216 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 0s - loss: 0.4156 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 0s - loss: 0.4119 - accuracy: 0.5174 4/11 [=========>....................] - ETA: 0s - loss: 0.4094 - accuracy: 0.5179 5/11 [============>.................] - ETA: 0s - loss: 0.4070 - accuracy: 0.5212 6/11 [===============>..............] - ETA: 0s - loss: 0.4053 - accuracy: 0.5233 7/11 [==================>...........] - ETA: 0s - loss: 0.4043 - accuracy: 0.5241 8/11 [====================>.........] - ETA: 0s - loss: 0.4036 - accuracy: 0.5256 9/11 [=======================>......] - ETA: 0s - loss: 0.4031 - accuracy: 0.527010/11 [==========================>...] - ETA: 0s - loss: 0.4027 - accuracy: 0.528711/11 [==============================] - ETA: 0s - loss: 0.4024 - accuracy: 0.530311/11 [==============================] - 1s 104ms/step - loss: 0.4021 - accuracy: 0.5316
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3978 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.3919 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 0s - loss: 0.3904 - accuracy: 0.5113 4/11 [=========>....................] - ETA: 0s - loss: 0.3902 - accuracy: 0.5158 5/11 [============>.................] - ETA: 0s - loss: 0.3904 - accuracy: 0.5211 6/11 [===============>..............] - ETA: 0s - loss: 0.3907 - accuracy: 0.5234 7/11 [==================>...........] - ETA: 0s - loss: 0.3909 - accuracy: 0.5253 8/11 [====================>.........] - ETA: 0s - loss: 0.3911 - accuracy: 0.5269 9/11 [=======================>......] - ETA: 0s - loss: 0.3913 - accuracy: 0.527310/11 [==========================>...] - ETA: 0s - loss: 0.3914 - accuracy: 0.528211/11 [==============================] - ETA: 0s - loss: 0.3915 - accuracy: 0.529511/11 [==============================] - 1s 104ms/step - loss: 0.3915 - accuracy: 0.5305
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3766 - accuracy: 0.5859 2/11 [====>.........................] - ETA: 0s - loss: 0.3844 - accuracy: 0.5723 3/11 [=======>......................] - ETA: 0s - loss: 0.3865 - accuracy: 0.5681 4/11 [=========>....................] - ETA: 0s - loss: 0.3874 - accuracy: 0.5658 5/11 [============>.................] - ETA: 0s - loss: 0.3879 - accuracy: 0.5601 6/11 [===============>..............] - ETA: 0s - loss: 0.3883 - accuracy: 0.5562 7/11 [==================>...........] - ETA: 0s - loss: 0.3885 - accuracy: 0.5518 8/11 [====================>.........] - ETA: 0s - loss: 0.3884 - accuracy: 0.5500 9/11 [=======================>......] - ETA: 0s - loss: 0.3882 - accuracy: 0.548710/11 [==========================>...] - ETA: 0s - loss: 0.3880 - accuracy: 0.548511/11 [==============================] - ETA: 0s - loss: 0.3878 - accuracy: 0.548311/11 [==============================] - 1s 107ms/step - loss: 0.3876 - accuracy: 0.5481
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3696 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 0s - loss: 0.3692 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.3711 - accuracy: 0.5564 4/11 [=========>....................] - ETA: 0s - loss: 0.3724 - accuracy: 0.5570 5/11 [============>.................] - ETA: 0s - loss: 0.3735 - accuracy: 0.5568 6/11 [===============>..............] - ETA: 0s - loss: 0.3746 - accuracy: 0.5565 7/11 [==================>...........] - ETA: 0s - loss: 0.3752 - accuracy: 0.5564 8/11 [====================>.........] - ETA: 0s - loss: 0.3757 - accuracy: 0.5558 9/11 [=======================>......] - ETA: 0s - loss: 0.3762 - accuracy: 0.554510/11 [==========================>...] - ETA: 0s - loss: 0.3766 - accuracy: 0.553511/11 [==============================] - ETA: 0s - loss: 0.3769 - accuracy: 0.553011/11 [==============================] - 1s 105ms/step - loss: 0.3771 - accuracy: 0.5525
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3677 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 1s - loss: 0.3687 - accuracy: 0.5840 3/11 [=======>......................] - ETA: 0s - loss: 0.3702 - accuracy: 0.5855 4/11 [=========>....................] - ETA: 0s - loss: 0.3717 - accuracy: 0.5773 5/11 [============>.................] - ETA: 0s - loss: 0.3725 - accuracy: 0.5743 6/11 [===============>..............] - ETA: 0s - loss: 0.3730 - accuracy: 0.5735 7/11 [==================>...........] - ETA: 0s - loss: 0.3732 - accuracy: 0.5722 8/11 [====================>.........] - ETA: 0s - loss: 0.3736 - accuracy: 0.5719 9/11 [=======================>......] - ETA: 0s - loss: 0.3741 - accuracy: 0.571710/11 [==========================>...] - ETA: 0s - loss: 0.3744 - accuracy: 0.571611/11 [==============================] - ETA: 0s - loss: 0.3746 - accuracy: 0.571811/11 [==============================] - 1s 109ms/step - loss: 0.3748 - accuracy: 0.5719
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3712 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 0s - loss: 0.3707 - accuracy: 0.5879 3/11 [=======>......................] - ETA: 0s - loss: 0.3715 - accuracy: 0.5838 4/11 [=========>....................] - ETA: 0s - loss: 0.3732 - accuracy: 0.5799 5/11 [============>.................] - ETA: 0s - loss: 0.3740 - accuracy: 0.5774 6/11 [===============>..............] - ETA: 0s - loss: 0.3745 - accuracy: 0.5753 7/11 [==================>...........] - ETA: 0s - loss: 0.3748 - accuracy: 0.5756 8/11 [====================>.........] - ETA: 0s - loss: 0.3748 - accuracy: 0.5763 9/11 [=======================>......] - ETA: 0s - loss: 0.3747 - accuracy: 0.578110/11 [==========================>...] - ETA: 0s - loss: 0.3746 - accuracy: 0.579911/11 [==============================] - ETA: 0s - loss: 0.3744 - accuracy: 0.581711/11 [==============================] - 1s 107ms/step - loss: 0.3742 - accuracy: 0.5832
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3600 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.3637 - accuracy: 0.5762 3/11 [=======>......................] - ETA: 0s - loss: 0.3663 - accuracy: 0.5794 4/11 [=========>....................] - ETA: 0s - loss: 0.3673 - accuracy: 0.5845 5/11 [============>.................] - ETA: 0s - loss: 0.3678 - accuracy: 0.5898 6/11 [===============>..............] - ETA: 0s - loss: 0.3684 - accuracy: 0.5961 7/11 [==================>...........] - ETA: 0s - loss: 0.3689 - accuracy: 0.6010 8/11 [====================>.........] - ETA: 0s - loss: 0.3691 - accuracy: 0.6052 9/11 [=======================>......] - ETA: 0s - loss: 0.3692 - accuracy: 0.608610/11 [==========================>...] - ETA: 0s - loss: 0.3694 - accuracy: 0.611711/11 [==============================] - ETA: 0s - loss: 0.3695 - accuracy: 0.613911/11 [==============================] - 1s 112ms/step - loss: 0.3695 - accuracy: 0.6157
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3631 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 0s - loss: 0.3650 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.3660 - accuracy: 0.6398 4/11 [=========>....................] - ETA: 0s - loss: 0.3660 - accuracy: 0.6424 5/11 [============>.................] - ETA: 0s - loss: 0.3661 - accuracy: 0.6464 6/11 [===============>..............] - ETA: 0s - loss: 0.3662 - accuracy: 0.6496 7/11 [==================>...........] - ETA: 0s - loss: 0.3661 - accuracy: 0.6512 8/11 [====================>.........] - ETA: 0s - loss: 0.3660 - accuracy: 0.6513 9/11 [=======================>......] - ETA: 0s - loss: 0.3658 - accuracy: 0.650310/11 [==========================>...] - ETA: 0s - loss: 0.3657 - accuracy: 0.649111/11 [==============================] - ETA: 0s - loss: 0.3656 - accuracy: 0.647611/11 [==============================] - 1s 108ms/step - loss: 0.3655 - accuracy: 0.6463
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3654 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 0s - loss: 0.3632 - accuracy: 0.6074 3/11 [=======>......................] - ETA: 0s - loss: 0.3619 - accuracy: 0.6211 4/11 [=========>....................] - ETA: 0s - loss: 0.3615 - accuracy: 0.6294 5/11 [============>.................] - ETA: 0s - loss: 0.3611 - accuracy: 0.6341 6/11 [===============>..............] - ETA: 0s - loss: 0.3609 - accuracy: 0.6372 7/11 [==================>...........] - ETA: 0s - loss: 0.3608 - accuracy: 0.6402 8/11 [====================>.........] - ETA: 0s - loss: 0.3605 - accuracy: 0.6434 9/11 [=======================>......] - ETA: 0s - loss: 0.3601 - accuracy: 0.645210/11 [==========================>...] - ETA: 0s - loss: 0.3598 - accuracy: 0.646211/11 [==============================] - ETA: 0s - loss: 0.3596 - accuracy: 0.646711/11 [==============================] - 1s 109ms/step - loss: 0.3594 - accuracy: 0.6472
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3560 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 0s - loss: 0.3577 - accuracy: 0.6582 3/11 [=======>......................] - ETA: 0s - loss: 0.3572 - accuracy: 0.6610 4/11 [=========>....................] - ETA: 0s - loss: 0.3573 - accuracy: 0.6603 5/11 [============>.................] - ETA: 0s - loss: 0.3568 - accuracy: 0.6620 6/11 [===============>..............] - ETA: 0s - loss: 0.3565 - accuracy: 0.6630 7/11 [==================>...........] - ETA: 0s - loss: 0.3563 - accuracy: 0.6639 8/11 [====================>.........] - ETA: 0s - loss: 0.3561 - accuracy: 0.6653 9/11 [=======================>......] - ETA: 0s - loss: 0.3558 - accuracy: 0.667010/11 [==========================>...] - ETA: 0s - loss: 0.3556 - accuracy: 0.668411/11 [==============================] - ETA: 0s - loss: 0.3553 - accuracy: 0.669911/11 [==============================] - 1s 104ms/step - loss: 0.3551 - accuracy: 0.6711
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.3600 - accuracy: 0.71093/6 [==============>...............] - ETA: 0s - loss: 0.3559 - accuracy: 0.6979 5/6 [========================>.....] - ETA: 0s - loss: 0.3567 - accuracy: 0.71726/6 [==============================] - 4s 29ms/step - loss: 0.3567 - accuracy: 0.7054
2021-12-13 23:50:45.933144: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:50:45.933979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:50:45.934024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:50:45.934070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:50:45.934105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:50:45.934145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:50:45.934182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:50:45.934211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:50:45.934237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:50:45.934267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:50:45.935378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:50:45.935405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:50:45.935415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:50:45.935423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [-0.9998821   0.95347345  0.99196243 -0.99735266 -0.9997746 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [-0.99999607 -0.9737598   0.9975786  -0.99786437 -0.99838424]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [-0.9978064   0.8146399   0.46262988 -0.99935436 -0.9997061 ]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [-0.99997973 -0.7192051   0.9930721  -0.966203   -0.99987143]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [-0.9948787  0.9270276  0.4509965 -0.999052  -0.9993601]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 4 0] pred: [-0.999991   -0.99287117  0.99238855 -0.9981665  -0.99973714]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [-0.99999624  0.90289855  0.9992187  -0.9985523  -0.99980044]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 3 0] pred: [-0.9999894 -0.9473718  0.9414166 -0.9988695 -0.991857 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [-0.9997673  -0.7754303   0.9622774  -0.798523   -0.99954677]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 4 0 1] pred: [-0.99977016 -0.9999915  -0.7683771   0.76613116 -0.99659944]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 4 0] pred: [-0.9999838  -0.9989204   0.99117464 -0.9983199  -0.99987847]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [-0.9999794  -0.90422404  0.95178366 -0.99114615 -0.9998939 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 4 0] pred: [-0.9999841 -0.9989645  0.9916688 -0.9983413 -0.9998894]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [-0.9999896  -0.8313316   0.97847444 -0.9939711  -0.9977668 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [-0.99999845  0.8364879   0.9996203  -0.9990247  -0.9998806 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:59 - loss: 0.6960 - accuracy: 0.0156 2/11 [====>.........................] - ETA: 0s - loss: 0.6949 - accuracy: 0.0488   3/11 [=======>......................] - ETA: 0s - loss: 0.6937 - accuracy: 0.0994 4/11 [=========>....................] - ETA: 0s - loss: 0.6926 - accuracy: 0.1390 5/11 [============>.................] - ETA: 0s - loss: 0.6915 - accuracy: 0.1709 6/11 [===============>..............] - ETA: 0s - loss: 0.6904 - accuracy: 0.1964 7/11 [==================>...........] - ETA: 0s - loss: 0.6892 - accuracy: 0.2178 8/11 [====================>.........] - ETA: 0s - loss: 0.6881 - accuracy: 0.2354 9/11 [=======================>......] - ETA: 0s - loss: 0.6869 - accuracy: 0.250310/11 [==========================>...] - ETA: 0s - loss: 0.6857 - accuracy: 0.263211/11 [==============================] - ETA: 0s - loss: 0.6846 - accuracy: 0.274711/11 [==============================] - 13s 103ms/step - loss: 0.6836 - accuracy: 0.2844
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6407 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.6388 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.6370 - accuracy: 0.4314 4/11 [=========>....................] - ETA: 0s - loss: 0.6347 - accuracy: 0.4354 5/11 [============>.................] - ETA: 0s - loss: 0.6324 - accuracy: 0.4396 6/11 [===============>..............] - ETA: 0s - loss: 0.6303 - accuracy: 0.4425 7/11 [==================>...........] - ETA: 0s - loss: 0.6281 - accuracy: 0.4442 8/11 [====================>.........] - ETA: 0s - loss: 0.6257 - accuracy: 0.4456 9/11 [=======================>......] - ETA: 0s - loss: 0.6233 - accuracy: 0.447110/11 [==========================>...] - ETA: 0s - loss: 0.6208 - accuracy: 0.448611/11 [==============================] - ETA: 0s - loss: 0.6183 - accuracy: 0.449811/11 [==============================] - 1s 105ms/step - loss: 0.6163 - accuracy: 0.4508
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5354 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.5281 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.5248 - accuracy: 0.4392 4/11 [=========>....................] - ETA: 0s - loss: 0.5225 - accuracy: 0.4393 5/11 [============>.................] - ETA: 0s - loss: 0.5198 - accuracy: 0.4414 6/11 [===============>..............] - ETA: 0s - loss: 0.5171 - accuracy: 0.4429 7/11 [==================>...........] - ETA: 0s - loss: 0.5146 - accuracy: 0.4444 8/11 [====================>.........] - ETA: 0s - loss: 0.5123 - accuracy: 0.4460 9/11 [=======================>......] - ETA: 0s - loss: 0.5103 - accuracy: 0.447510/11 [==========================>...] - ETA: 0s - loss: 0.5083 - accuracy: 0.449411/11 [==============================] - ETA: 0s - loss: 0.5068 - accuracy: 0.450611/11 [==============================] - 1s 102ms/step - loss: 0.5054 - accuracy: 0.4515
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4600 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.4598 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 0s - loss: 0.4605 - accuracy: 0.5009 4/11 [=========>....................] - ETA: 0s - loss: 0.4620 - accuracy: 0.4987 5/11 [============>.................] - ETA: 0s - loss: 0.4641 - accuracy: 0.4936 6/11 [===============>..............] - ETA: 0s - loss: 0.4660 - accuracy: 0.4886 7/11 [==================>...........] - ETA: 0s - loss: 0.4673 - accuracy: 0.4850 8/11 [====================>.........] - ETA: 0s - loss: 0.4685 - accuracy: 0.4810 9/11 [=======================>......] - ETA: 0s - loss: 0.4693 - accuracy: 0.478410/11 [==========================>...] - ETA: 0s - loss: 0.4697 - accuracy: 0.476311/11 [==============================] - ETA: 0s - loss: 0.4699 - accuracy: 0.475011/11 [==============================] - 1s 107ms/step - loss: 0.4701 - accuracy: 0.4739
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4812 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.4758 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 0s - loss: 0.4739 - accuracy: 0.4405 4/11 [=========>....................] - ETA: 0s - loss: 0.4713 - accuracy: 0.4461 5/11 [============>.................] - ETA: 0s - loss: 0.4698 - accuracy: 0.4525 6/11 [===============>..............] - ETA: 0s - loss: 0.4688 - accuracy: 0.4557 7/11 [==================>...........] - ETA: 0s - loss: 0.4681 - accuracy: 0.4583 8/11 [====================>.........] - ETA: 0s - loss: 0.4677 - accuracy: 0.4600 9/11 [=======================>......] - ETA: 0s - loss: 0.4674 - accuracy: 0.461210/11 [==========================>...] - ETA: 0s - loss: 0.4673 - accuracy: 0.461111/11 [==============================] - ETA: 0s - loss: 0.4672 - accuracy: 0.461211/11 [==============================] - 1s 109ms/step - loss: 0.4670 - accuracy: 0.4613
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4573 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.4579 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.4591 - accuracy: 0.4575 4/11 [=========>....................] - ETA: 0s - loss: 0.4586 - accuracy: 0.4578 5/11 [============>.................] - ETA: 0s - loss: 0.4579 - accuracy: 0.4597 6/11 [===============>..............] - ETA: 0s - loss: 0.4578 - accuracy: 0.4597 7/11 [==================>...........] - ETA: 0s - loss: 0.4577 - accuracy: 0.4586 8/11 [====================>.........] - ETA: 0s - loss: 0.4577 - accuracy: 0.4577 9/11 [=======================>......] - ETA: 0s - loss: 0.4579 - accuracy: 0.457310/11 [==========================>...] - ETA: 0s - loss: 0.4579 - accuracy: 0.457611/11 [==============================] - ETA: 0s - loss: 0.4578 - accuracy: 0.458011/11 [==============================] - 1s 108ms/step - loss: 0.4577 - accuracy: 0.4583
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4347 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.4382 - accuracy: 0.4863 3/11 [=======>......................] - ETA: 0s - loss: 0.4395 - accuracy: 0.4787 4/11 [=========>....................] - ETA: 0s - loss: 0.4398 - accuracy: 0.4787 5/11 [============>.................] - ETA: 0s - loss: 0.4403 - accuracy: 0.4776 6/11 [===============>..............] - ETA: 0s - loss: 0.4402 - accuracy: 0.4792 7/11 [==================>...........] - ETA: 0s - loss: 0.4404 - accuracy: 0.4785 8/11 [====================>.........] - ETA: 0s - loss: 0.4404 - accuracy: 0.4780 9/11 [=======================>......] - ETA: 0s - loss: 0.4405 - accuracy: 0.477110/11 [==========================>...] - ETA: 0s - loss: 0.4407 - accuracy: 0.476111/11 [==============================] - ETA: 0s - loss: 0.4407 - accuracy: 0.475411/11 [==============================] - 1s 110ms/step - loss: 0.4407 - accuracy: 0.4748
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4256 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.4237 - accuracy: 0.5645 3/11 [=======>......................] - ETA: 0s - loss: 0.4240 - accuracy: 0.5716 4/11 [=========>....................] - ETA: 0s - loss: 0.4244 - accuracy: 0.5762 5/11 [============>.................] - ETA: 0s - loss: 0.4243 - accuracy: 0.5759 6/11 [===============>..............] - ETA: 0s - loss: 0.4241 - accuracy: 0.5757 7/11 [==================>...........] - ETA: 0s - loss: 0.4241 - accuracy: 0.5739 8/11 [====================>.........] - ETA: 0s - loss: 0.4242 - accuracy: 0.5709 9/11 [=======================>......] - ETA: 0s - loss: 0.4244 - accuracy: 0.568110/11 [==========================>...] - ETA: 0s - loss: 0.4246 - accuracy: 0.566011/11 [==============================] - ETA: 0s - loss: 0.4248 - accuracy: 0.564511/11 [==============================] - 1s 105ms/step - loss: 0.4249 - accuracy: 0.5633
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4420 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.4370 - accuracy: 0.5605 3/11 [=======>......................] - ETA: 0s - loss: 0.4362 - accuracy: 0.5612 4/11 [=========>....................] - ETA: 0s - loss: 0.4346 - accuracy: 0.5640 5/11 [============>.................] - ETA: 0s - loss: 0.4329 - accuracy: 0.5652 6/11 [===============>..............] - ETA: 0s - loss: 0.4312 - accuracy: 0.5643 7/11 [==================>...........] - ETA: 0s - loss: 0.4296 - accuracy: 0.5633 8/11 [====================>.........] - ETA: 0s - loss: 0.4282 - accuracy: 0.5627 9/11 [=======================>......] - ETA: 0s - loss: 0.4271 - accuracy: 0.562110/11 [==========================>...] - ETA: 0s - loss: 0.4262 - accuracy: 0.562211/11 [==============================] - ETA: 0s - loss: 0.4253 - accuracy: 0.562411/11 [==============================] - 1s 106ms/step - loss: 0.4246 - accuracy: 0.5626
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4053 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.4086 - accuracy: 0.6348 3/11 [=======>......................] - ETA: 0s - loss: 0.4076 - accuracy: 0.6341 4/11 [=========>....................] - ETA: 0s - loss: 0.4074 - accuracy: 0.6318 5/11 [============>.................] - ETA: 0s - loss: 0.4074 - accuracy: 0.6277 6/11 [===============>..............] - ETA: 0s - loss: 0.4075 - accuracy: 0.6237 7/11 [==================>...........] - ETA: 0s - loss: 0.4077 - accuracy: 0.6199 8/11 [====================>.........] - ETA: 0s - loss: 0.4079 - accuracy: 0.6148 9/11 [=======================>......] - ETA: 0s - loss: 0.4081 - accuracy: 0.610410/11 [==========================>...] - ETA: 0s - loss: 0.4083 - accuracy: 0.605311/11 [==============================] - ETA: 0s - loss: 0.4084 - accuracy: 0.600911/11 [==============================] - 1s 106ms/step - loss: 0.4085 - accuracy: 0.5973
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3994 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 0s - loss: 0.4010 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.4031 - accuracy: 0.5321 4/11 [=========>....................] - ETA: 0s - loss: 0.4033 - accuracy: 0.5348 5/11 [============>.................] - ETA: 0s - loss: 0.4032 - accuracy: 0.5376 6/11 [===============>..............] - ETA: 0s - loss: 0.4035 - accuracy: 0.5374 7/11 [==================>...........] - ETA: 0s - loss: 0.4035 - accuracy: 0.5379 8/11 [====================>.........] - ETA: 0s - loss: 0.4037 - accuracy: 0.5378 9/11 [=======================>......] - ETA: 0s - loss: 0.4038 - accuracy: 0.537510/11 [==========================>...] - ETA: 0s - loss: 0.4038 - accuracy: 0.537611/11 [==============================] - ETA: 0s - loss: 0.4037 - accuracy: 0.537911/11 [==============================] - 1s 106ms/step - loss: 0.4036 - accuracy: 0.5381
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3960 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 0s - loss: 0.3967 - accuracy: 0.5723 3/11 [=======>......................] - ETA: 0s - loss: 0.3966 - accuracy: 0.5820 4/11 [=========>....................] - ETA: 0s - loss: 0.3963 - accuracy: 0.5811 5/11 [============>.................] - ETA: 0s - loss: 0.3964 - accuracy: 0.5773 6/11 [===============>..............] - ETA: 0s - loss: 0.3964 - accuracy: 0.5757 7/11 [==================>...........] - ETA: 0s - loss: 0.3968 - accuracy: 0.5719 8/11 [====================>.........] - ETA: 0s - loss: 0.3969 - accuracy: 0.5694 9/11 [=======================>......] - ETA: 0s - loss: 0.3969 - accuracy: 0.567910/11 [==========================>...] - ETA: 0s - loss: 0.3969 - accuracy: 0.567311/11 [==============================] - ETA: 0s - loss: 0.3969 - accuracy: 0.567211/11 [==============================] - 1s 106ms/step - loss: 0.3970 - accuracy: 0.5671
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4033 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.4031 - accuracy: 0.6426 3/11 [=======>......................] - ETA: 0s - loss: 0.4016 - accuracy: 0.6367 4/11 [=========>....................] - ETA: 0s - loss: 0.3998 - accuracy: 0.6289 5/11 [============>.................] - ETA: 0s - loss: 0.3986 - accuracy: 0.6244 6/11 [===============>..............] - ETA: 0s - loss: 0.3979 - accuracy: 0.6193 7/11 [==================>...........] - ETA: 0s - loss: 0.3974 - accuracy: 0.6151 8/11 [====================>.........] - ETA: 0s - loss: 0.3969 - accuracy: 0.6119 9/11 [=======================>......] - ETA: 0s - loss: 0.3966 - accuracy: 0.610210/11 [==========================>...] - ETA: 0s - loss: 0.3964 - accuracy: 0.610111/11 [==============================] - ETA: 0s - loss: 0.3962 - accuracy: 0.610611/11 [==============================] - 1s 106ms/step - loss: 0.3960 - accuracy: 0.6110
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3931 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 0s - loss: 0.3894 - accuracy: 0.6934 3/11 [=======>......................] - ETA: 0s - loss: 0.3888 - accuracy: 0.6810 4/11 [=========>....................] - ETA: 0s - loss: 0.3884 - accuracy: 0.6743 5/11 [============>.................] - ETA: 0s - loss: 0.3889 - accuracy: 0.6657 6/11 [===============>..............] - ETA: 0s - loss: 0.3893 - accuracy: 0.6594 7/11 [==================>...........] - ETA: 0s - loss: 0.3896 - accuracy: 0.6554 8/11 [====================>.........] - ETA: 0s - loss: 0.3897 - accuracy: 0.6522 9/11 [=======================>......] - ETA: 0s - loss: 0.3897 - accuracy: 0.648910/11 [==========================>...] - ETA: 0s - loss: 0.3896 - accuracy: 0.646611/11 [==============================] - ETA: 0s - loss: 0.3896 - accuracy: 0.644211/11 [==============================] - 1s 105ms/step - loss: 0.3895 - accuracy: 0.6421
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3833 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.3826 - accuracy: 0.6387 3/11 [=======>......................] - ETA: 0s - loss: 0.3826 - accuracy: 0.6437 4/11 [=========>....................] - ETA: 0s - loss: 0.3830 - accuracy: 0.6502 5/11 [============>.................] - ETA: 0s - loss: 0.3830 - accuracy: 0.6555 6/11 [===============>..............] - ETA: 0s - loss: 0.3828 - accuracy: 0.6597 7/11 [==================>...........] - ETA: 0s - loss: 0.3828 - accuracy: 0.6628 8/11 [====================>.........] - ETA: 0s - loss: 0.3829 - accuracy: 0.6644 9/11 [=======================>......] - ETA: 0s - loss: 0.3830 - accuracy: 0.665010/11 [==========================>...] - ETA: 0s - loss: 0.3831 - accuracy: 0.664711/11 [==============================] - ETA: 0s - loss: 0.3832 - accuracy: 0.664411/11 [==============================] - 1s 105ms/step - loss: 0.3833 - accuracy: 0.6642
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3815 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 0s - loss: 0.3815 - accuracy: 0.6289 3/11 [=======>......................] - ETA: 0s - loss: 0.3808 - accuracy: 0.6467 4/11 [=========>....................] - ETA: 0s - loss: 0.3816 - accuracy: 0.6564 5/11 [============>.................] - ETA: 0s - loss: 0.3820 - accuracy: 0.6645 6/11 [===============>..............] - ETA: 0s - loss: 0.3820 - accuracy: 0.6720 7/11 [==================>...........] - ETA: 0s - loss: 0.3818 - accuracy: 0.6776 8/11 [====================>.........] - ETA: 0s - loss: 0.3816 - accuracy: 0.6816 9/11 [=======================>......] - ETA: 0s - loss: 0.3816 - accuracy: 0.683510/11 [==========================>...] - ETA: 0s - loss: 0.3815 - accuracy: 0.684611/11 [==============================] - ETA: 0s - loss: 0.3813 - accuracy: 0.685911/11 [==============================] - 1s 107ms/step - loss: 0.3812 - accuracy: 0.6869
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3802 - accuracy: 0.7109 2/11 [====>.........................] - ETA: 0s - loss: 0.3796 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.3795 - accuracy: 0.7361 4/11 [=========>....................] - ETA: 0s - loss: 0.3792 - accuracy: 0.7386 5/11 [============>.................] - ETA: 0s - loss: 0.3788 - accuracy: 0.7406 6/11 [===============>..............] - ETA: 0s - loss: 0.3784 - accuracy: 0.7424 7/11 [==================>...........] - ETA: 0s - loss: 0.3780 - accuracy: 0.7430 8/11 [====================>.........] - ETA: 0s - loss: 0.3778 - accuracy: 0.7430 9/11 [=======================>......] - ETA: 0s - loss: 0.3775 - accuracy: 0.742410/11 [==========================>...] - ETA: 0s - loss: 0.3772 - accuracy: 0.742111/11 [==============================] - ETA: 0s - loss: 0.3769 - accuracy: 0.742311/11 [==============================] - 1s 104ms/step - loss: 0.3766 - accuracy: 0.7424
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3669 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 0s - loss: 0.3706 - accuracy: 0.6992 3/11 [=======>......................] - ETA: 0s - loss: 0.3713 - accuracy: 0.7101 4/11 [=========>....................] - ETA: 0s - loss: 0.3710 - accuracy: 0.7142 5/11 [============>.................] - ETA: 0s - loss: 0.3710 - accuracy: 0.7176 6/11 [===============>..............] - ETA: 0s - loss: 0.3710 - accuracy: 0.7195 7/11 [==================>...........] - ETA: 0s - loss: 0.3709 - accuracy: 0.7213 8/11 [====================>.........] - ETA: 0s - loss: 0.3709 - accuracy: 0.7230 9/11 [=======================>......] - ETA: 0s - loss: 0.3707 - accuracy: 0.725010/11 [==========================>...] - ETA: 0s - loss: 0.3705 - accuracy: 0.727011/11 [==============================] - ETA: 0s - loss: 0.3703 - accuracy: 0.728511/11 [==============================] - 1s 105ms/step - loss: 0.3701 - accuracy: 0.7298
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3705 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 0s - loss: 0.3690 - accuracy: 0.6816 3/11 [=======>......................] - ETA: 0s - loss: 0.3683 - accuracy: 0.6966 4/11 [=========>....................] - ETA: 0s - loss: 0.3677 - accuracy: 0.7046 5/11 [============>.................] - ETA: 0s - loss: 0.3668 - accuracy: 0.7134 6/11 [===============>..............] - ETA: 0s - loss: 0.3662 - accuracy: 0.7199 7/11 [==================>...........] - ETA: 0s - loss: 0.3658 - accuracy: 0.7247 8/11 [====================>.........] - ETA: 0s - loss: 0.3655 - accuracy: 0.7277 9/11 [=======================>......] - ETA: 0s - loss: 0.3653 - accuracy: 0.729710/11 [==========================>...] - ETA: 0s - loss: 0.3652 - accuracy: 0.731011/11 [==============================] - ETA: 0s - loss: 0.3651 - accuracy: 0.731711/11 [==============================] - 1s 108ms/step - loss: 0.3650 - accuracy: 0.7323
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3567 - accuracy: 0.7422 2/11 [====>.........................] - ETA: 0s - loss: 0.3566 - accuracy: 0.7461 3/11 [=======>......................] - ETA: 0s - loss: 0.3569 - accuracy: 0.7552 4/11 [=========>....................] - ETA: 0s - loss: 0.3574 - accuracy: 0.7646 5/11 [============>.................] - ETA: 0s - loss: 0.3575 - accuracy: 0.7730 6/11 [===============>..............] - ETA: 0s - loss: 0.3579 - accuracy: 0.7798 7/11 [==================>...........] - ETA: 0s - loss: 0.3581 - accuracy: 0.7854 8/11 [====================>.........] - ETA: 0s - loss: 0.3583 - accuracy: 0.7899 9/11 [=======================>......] - ETA: 0s - loss: 0.3584 - accuracy: 0.792610/11 [==========================>...] - ETA: 0s - loss: 0.3587 - accuracy: 0.793411/11 [==============================] - ETA: 0s - loss: 0.3589 - accuracy: 0.793511/11 [==============================] - 1s 104ms/step - loss: 0.3590 - accuracy: 0.7936
Evaluate on test data
1/6 [====>.........................] - ETA: 17s - loss: 0.3623 - accuracy: 0.76563/6 [==============>...............] - ETA: 0s - loss: 0.3610 - accuracy: 0.7943 5/6 [========================>.....] - ETA: 0s - loss: 0.3631 - accuracy: 0.81096/6 [==============================] - 4s 29ms/step - loss: 0.3637 - accuracy: 0.8116
2021-12-13 23:51:34.239460: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:51:34.240429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:51:34.240485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:51:34.240534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:51:34.240580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:51:34.240614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:51:34.240648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:51:34.240682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:51:34.240721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:51:34.240757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:51:34.242138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:51:34.242173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:51:34.242190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:51:34.242200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [-0.999972   -0.93820953  0.9884795  -0.997333   -0.99999696]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 1 0 4] pred: [-0.9984815 -0.9827547  0.527676  -0.9661768 -0.9999878]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 0 4] pred: [-0.9999629 -0.9968652  0.9987267 -0.9967113 -0.9999992]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [4 3 0 2 1] pred: [-0.40587342 -0.88980454 -0.8367123   0.11830971  0.41900602]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [-0.99949247  0.9428368   0.99654573 -0.995166   -0.9999933 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 3 0 4] pred: [-0.99764955  0.9447887   0.70781773 -0.9903855  -0.99989367]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 0 2 3 4] pred: [-0.8761524   0.6580185  -0.87644446 -0.9917681  -0.99935466]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 0 4] pred: [-0.999857   -0.99888855  0.9943863  -0.9911206  -0.99999917]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [-0.9988391   0.9946466   0.99683845 -0.99830157 -0.99998707]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [0 1 4 3 2] pred: [-0.11681303 -0.36322784 -0.94990784 -0.61592984 -0.42176956]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 0 4] pred: [-0.9999661  -0.9976322   0.9988467  -0.9965299  -0.99999934]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 3 0 4] pred: [-0.9976768   0.93381596  0.6525381  -0.98638093 -0.99984396]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [-0.9996629   0.89788955  0.99965954 -0.9955602  -0.9999966 ]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 3 0 4] pred: [-0.9937684   0.937178    0.43930465 -0.9914972  -0.9994505 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 3 0 4] pred: [-0.9979561   0.9984095   0.9475499  -0.99694955 -0.9999502 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:58 - loss: 0.6919 - accuracy: 0.3203 2/11 [====>.........................] - ETA: 1s - loss: 0.6907 - accuracy: 0.3906   3/11 [=======>......................] - ETA: 1s - loss: 0.6896 - accuracy: 0.4201 4/11 [=========>....................] - ETA: 0s - loss: 0.6886 - accuracy: 0.4313 5/11 [============>.................] - ETA: 0s - loss: 0.6876 - accuracy: 0.4376 6/11 [===============>..............] - ETA: 0s - loss: 0.6866 - accuracy: 0.4412 7/11 [==================>...........] - ETA: 0s - loss: 0.6856 - accuracy: 0.4437 8/11 [====================>.........] - ETA: 0s - loss: 0.6845 - accuracy: 0.4464 9/11 [=======================>......] - ETA: 0s - loss: 0.6834 - accuracy: 0.447910/11 [==========================>...] - ETA: 0s - loss: 0.6823 - accuracy: 0.449011/11 [==============================] - ETA: 0s - loss: 0.6812 - accuracy: 0.450111/11 [==============================] - 13s 110ms/step - loss: 0.6803 - accuracy: 0.4511
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6366 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.6350 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.6333 - accuracy: 0.4896 4/11 [=========>....................] - ETA: 0s - loss: 0.6317 - accuracy: 0.4873 5/11 [============>.................] - ETA: 0s - loss: 0.6300 - accuracy: 0.4842 6/11 [===============>..............] - ETA: 0s - loss: 0.6281 - accuracy: 0.4827 7/11 [==================>...........] - ETA: 0s - loss: 0.6262 - accuracy: 0.4803 8/11 [====================>.........] - ETA: 0s - loss: 0.6240 - accuracy: 0.4795 9/11 [=======================>......] - ETA: 0s - loss: 0.6218 - accuracy: 0.478710/11 [==========================>...] - ETA: 0s - loss: 0.6196 - accuracy: 0.478211/11 [==============================] - ETA: 0s - loss: 0.6175 - accuracy: 0.477311/11 [==============================] - 1s 107ms/step - loss: 0.6157 - accuracy: 0.4765
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5341 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.5300 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 0s - loss: 0.5275 - accuracy: 0.4475 4/11 [=========>....................] - ETA: 0s - loss: 0.5247 - accuracy: 0.4538 5/11 [============>.................] - ETA: 0s - loss: 0.5221 - accuracy: 0.4574 6/11 [===============>..............] - ETA: 0s - loss: 0.5195 - accuracy: 0.4591 7/11 [==================>...........] - ETA: 0s - loss: 0.5171 - accuracy: 0.4613 8/11 [====================>.........] - ETA: 0s - loss: 0.5147 - accuracy: 0.4633 9/11 [=======================>......] - ETA: 0s - loss: 0.5128 - accuracy: 0.464010/11 [==========================>...] - ETA: 0s - loss: 0.5110 - accuracy: 0.464611/11 [==============================] - ETA: 0s - loss: 0.5094 - accuracy: 0.464911/11 [==============================] - 1s 109ms/step - loss: 0.5081 - accuracy: 0.4652
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4588 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.4662 - accuracy: 0.5020 3/11 [=======>......................] - ETA: 0s - loss: 0.4692 - accuracy: 0.4935 4/11 [=========>....................] - ETA: 0s - loss: 0.4694 - accuracy: 0.4902 5/11 [============>.................] - ETA: 0s - loss: 0.4695 - accuracy: 0.4884 6/11 [===============>..............] - ETA: 0s - loss: 0.4694 - accuracy: 0.4871 7/11 [==================>...........] - ETA: 0s - loss: 0.4696 - accuracy: 0.4859 8/11 [====================>.........] - ETA: 0s - loss: 0.4702 - accuracy: 0.4834 9/11 [=======================>......] - ETA: 0s - loss: 0.4707 - accuracy: 0.481110/11 [==========================>...] - ETA: 0s - loss: 0.4709 - accuracy: 0.479911/11 [==============================] - ETA: 0s - loss: 0.4710 - accuracy: 0.478811/11 [==============================] - 1s 107ms/step - loss: 0.4711 - accuracy: 0.4779
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4887 - accuracy: 0.3906 2/11 [====>.........................] - ETA: 0s - loss: 0.4805 - accuracy: 0.4199 3/11 [=======>......................] - ETA: 0s - loss: 0.4775 - accuracy: 0.4301 4/11 [=========>....................] - ETA: 0s - loss: 0.4757 - accuracy: 0.4364 5/11 [============>.................] - ETA: 0s - loss: 0.4740 - accuracy: 0.4441 6/11 [===============>..............] - ETA: 0s - loss: 0.4724 - accuracy: 0.4502 7/11 [==================>...........] - ETA: 0s - loss: 0.4712 - accuracy: 0.4538 8/11 [====================>.........] - ETA: 0s - loss: 0.4707 - accuracy: 0.4554 9/11 [=======================>......] - ETA: 0s - loss: 0.4702 - accuracy: 0.456710/11 [==========================>...] - ETA: 0s - loss: 0.4698 - accuracy: 0.457811/11 [==============================] - ETA: 0s - loss: 0.4694 - accuracy: 0.458711/11 [==============================] - 1s 105ms/step - loss: 0.4691 - accuracy: 0.4595
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4644 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.4606 - accuracy: 0.4277 3/11 [=======>......................] - ETA: 0s - loss: 0.4604 - accuracy: 0.4353 4/11 [=========>....................] - ETA: 0s - loss: 0.4611 - accuracy: 0.4373 5/11 [============>.................] - ETA: 0s - loss: 0.4611 - accuracy: 0.4414 6/11 [===============>..............] - ETA: 0s - loss: 0.4605 - accuracy: 0.4477 7/11 [==================>...........] - ETA: 0s - loss: 0.4602 - accuracy: 0.4523 8/11 [====================>.........] - ETA: 0s - loss: 0.4600 - accuracy: 0.4540 9/11 [=======================>......] - ETA: 0s - loss: 0.4598 - accuracy: 0.455410/11 [==========================>...] - ETA: 0s - loss: 0.4596 - accuracy: 0.456611/11 [==============================] - ETA: 0s - loss: 0.4595 - accuracy: 0.457611/11 [==============================] - 1s 112ms/step - loss: 0.4594 - accuracy: 0.4585
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4470 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.4482 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 0s - loss: 0.4478 - accuracy: 0.4805 4/11 [=========>....................] - ETA: 0s - loss: 0.4477 - accuracy: 0.4800 5/11 [============>.................] - ETA: 0s - loss: 0.4472 - accuracy: 0.4812 6/11 [===============>..............] - ETA: 0s - loss: 0.4467 - accuracy: 0.4811 7/11 [==================>...........] - ETA: 0s - loss: 0.4461 - accuracy: 0.4801 8/11 [====================>.........] - ETA: 0s - loss: 0.4459 - accuracy: 0.4798 9/11 [=======================>......] - ETA: 0s - loss: 0.4456 - accuracy: 0.479210/11 [==========================>...] - ETA: 0s - loss: 0.4456 - accuracy: 0.478411/11 [==============================] - ETA: 0s - loss: 0.4456 - accuracy: 0.478011/11 [==============================] - 1s 110ms/step - loss: 0.4456 - accuracy: 0.4777
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4416 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.4425 - accuracy: 0.4980 3/11 [=======>......................] - ETA: 0s - loss: 0.4416 - accuracy: 0.4944 4/11 [=========>....................] - ETA: 0s - loss: 0.4399 - accuracy: 0.4919 5/11 [============>.................] - ETA: 0s - loss: 0.4381 - accuracy: 0.4922 6/11 [===============>..............] - ETA: 0s - loss: 0.4366 - accuracy: 0.4944 7/11 [==================>...........] - ETA: 0s - loss: 0.4357 - accuracy: 0.4958 8/11 [====================>.........] - ETA: 0s - loss: 0.4349 - accuracy: 0.4992 9/11 [=======================>......] - ETA: 0s - loss: 0.4341 - accuracy: 0.502710/11 [==========================>...] - ETA: 0s - loss: 0.4335 - accuracy: 0.506911/11 [==============================] - ETA: 0s - loss: 0.4331 - accuracy: 0.510411/11 [==============================] - 1s 106ms/step - loss: 0.4327 - accuracy: 0.5133
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4089 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 0s - loss: 0.4109 - accuracy: 0.6719 3/11 [=======>......................] - ETA: 0s - loss: 0.4125 - accuracy: 0.6589 4/11 [=========>....................] - ETA: 0s - loss: 0.4143 - accuracy: 0.6470 5/11 [============>.................] - ETA: 0s - loss: 0.4149 - accuracy: 0.6385 6/11 [===============>..............] - ETA: 0s - loss: 0.4153 - accuracy: 0.6311 7/11 [==================>...........] - ETA: 0s - loss: 0.4157 - accuracy: 0.6244 8/11 [====================>.........] - ETA: 0s - loss: 0.4158 - accuracy: 0.6198 9/11 [=======================>......] - ETA: 0s - loss: 0.4157 - accuracy: 0.617410/11 [==========================>...] - ETA: 0s - loss: 0.4157 - accuracy: 0.616311/11 [==============================] - ETA: 0s - loss: 0.4157 - accuracy: 0.615811/11 [==============================] - 1s 106ms/step - loss: 0.4156 - accuracy: 0.6155
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4266 - accuracy: 0.6250 2/11 [====>.........................] - ETA: 1s - loss: 0.4179 - accuracy: 0.6602 3/11 [=======>......................] - ETA: 0s - loss: 0.4129 - accuracy: 0.6771 4/11 [=========>....................] - ETA: 0s - loss: 0.4116 - accuracy: 0.6777 5/11 [============>.................] - ETA: 0s - loss: 0.4103 - accuracy: 0.6741 6/11 [===============>..............] - ETA: 0s - loss: 0.4095 - accuracy: 0.6691 7/11 [==================>...........] - ETA: 0s - loss: 0.4090 - accuracy: 0.6652 8/11 [====================>.........] - ETA: 0s - loss: 0.4086 - accuracy: 0.6617 9/11 [=======================>......] - ETA: 0s - loss: 0.4083 - accuracy: 0.659010/11 [==========================>...] - ETA: 0s - loss: 0.4078 - accuracy: 0.657711/11 [==============================] - ETA: 0s - loss: 0.4077 - accuracy: 0.656011/11 [==============================] - 1s 111ms/step - loss: 0.4075 - accuracy: 0.6547
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4001 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 0s - loss: 0.3987 - accuracy: 0.7051 3/11 [=======>......................] - ETA: 0s - loss: 0.3992 - accuracy: 0.7079 4/11 [=========>....................] - ETA: 0s - loss: 0.3996 - accuracy: 0.7057 5/11 [============>.................] - ETA: 0s - loss: 0.3999 - accuracy: 0.7011 6/11 [===============>..............] - ETA: 0s - loss: 0.4000 - accuracy: 0.6963 7/11 [==================>...........] - ETA: 0s - loss: 0.3999 - accuracy: 0.6929 8/11 [====================>.........] - ETA: 0s - loss: 0.3997 - accuracy: 0.6902 9/11 [=======================>......] - ETA: 0s - loss: 0.3996 - accuracy: 0.687310/11 [==========================>...] - ETA: 0s - loss: 0.3994 - accuracy: 0.685711/11 [==============================] - ETA: 0s - loss: 0.3994 - accuracy: 0.684711/11 [==============================] - 1s 104ms/step - loss: 0.3993 - accuracy: 0.6838
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4134 - accuracy: 0.7422 2/11 [====>.........................] - ETA: 0s - loss: 0.4070 - accuracy: 0.7363 3/11 [=======>......................] - ETA: 0s - loss: 0.4047 - accuracy: 0.7313 4/11 [=========>....................] - ETA: 0s - loss: 0.4036 - accuracy: 0.7257 5/11 [============>.................] - ETA: 0s - loss: 0.4015 - accuracy: 0.7190 6/11 [===============>..............] - ETA: 0s - loss: 0.4003 - accuracy: 0.7118 7/11 [==================>...........] - ETA: 0s - loss: 0.3993 - accuracy: 0.7047 8/11 [====================>.........] - ETA: 0s - loss: 0.3984 - accuracy: 0.6990 9/11 [=======================>......] - ETA: 0s - loss: 0.3978 - accuracy: 0.694710/11 [==========================>...] - ETA: 0s - loss: 0.3972 - accuracy: 0.690811/11 [==============================] - ETA: 0s - loss: 0.3968 - accuracy: 0.687311/11 [==============================] - 1s 108ms/step - loss: 0.3965 - accuracy: 0.6845
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3829 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 1s - loss: 0.3864 - accuracy: 0.6758 3/11 [=======>......................] - ETA: 0s - loss: 0.3882 - accuracy: 0.6806 4/11 [=========>....................] - ETA: 0s - loss: 0.3879 - accuracy: 0.6886 5/11 [============>.................] - ETA: 0s - loss: 0.3876 - accuracy: 0.6912 6/11 [===============>..............] - ETA: 0s - loss: 0.3874 - accuracy: 0.6897 7/11 [==================>...........] - ETA: 0s - loss: 0.3874 - accuracy: 0.6872 8/11 [====================>.........] - ETA: 0s - loss: 0.3874 - accuracy: 0.6844 9/11 [=======================>......] - ETA: 0s - loss: 0.3873 - accuracy: 0.682110/11 [==========================>...] - ETA: 0s - loss: 0.3873 - accuracy: 0.679611/11 [==============================] - ETA: 0s - loss: 0.3874 - accuracy: 0.677711/11 [==============================] - 1s 111ms/step - loss: 0.3874 - accuracy: 0.6761
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3903 - accuracy: 0.7031 2/11 [====>.........................] - ETA: 0s - loss: 0.3910 - accuracy: 0.6934 3/11 [=======>......................] - ETA: 0s - loss: 0.3901 - accuracy: 0.6931 4/11 [=========>....................] - ETA: 0s - loss: 0.3890 - accuracy: 0.6966 5/11 [============>.................] - ETA: 0s - loss: 0.3882 - accuracy: 0.6932 6/11 [===============>..............] - ETA: 0s - loss: 0.3873 - accuracy: 0.6916 7/11 [==================>...........] - ETA: 0s - loss: 0.3867 - accuracy: 0.6902 8/11 [====================>.........] - ETA: 0s - loss: 0.3862 - accuracy: 0.6895 9/11 [=======================>......] - ETA: 0s - loss: 0.3857 - accuracy: 0.689510/11 [==========================>...] - ETA: 0s - loss: 0.3854 - accuracy: 0.690511/11 [==============================] - ETA: 0s - loss: 0.3852 - accuracy: 0.691811/11 [==============================] - 1s 108ms/step - loss: 0.3851 - accuracy: 0.6928
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3658 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 0s - loss: 0.3690 - accuracy: 0.7695 3/11 [=======>......................] - ETA: 0s - loss: 0.3710 - accuracy: 0.7665 4/11 [=========>....................] - ETA: 0s - loss: 0.3725 - accuracy: 0.7580 5/11 [============>.................] - ETA: 0s - loss: 0.3733 - accuracy: 0.7504 6/11 [===============>..............] - ETA: 0s - loss: 0.3735 - accuracy: 0.7452 7/11 [==================>...........] - ETA: 0s - loss: 0.3735 - accuracy: 0.7407 8/11 [====================>.........] - ETA: 0s - loss: 0.3736 - accuracy: 0.7356 9/11 [=======================>......] - ETA: 0s - loss: 0.3735 - accuracy: 0.731310/11 [==========================>...] - ETA: 0s - loss: 0.3737 - accuracy: 0.727011/11 [==============================] - ETA: 0s - loss: 0.3738 - accuracy: 0.723211/11 [==============================] - 1s 107ms/step - loss: 0.3739 - accuracy: 0.7200
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3739 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 1s - loss: 0.3715 - accuracy: 0.7441 3/11 [=======>......................] - ETA: 0s - loss: 0.3711 - accuracy: 0.7470 4/11 [=========>....................] - ETA: 0s - loss: 0.3704 - accuracy: 0.7521 5/11 [============>.................] - ETA: 0s - loss: 0.3702 - accuracy: 0.7520 6/11 [===============>..............] - ETA: 0s - loss: 0.3701 - accuracy: 0.7502 7/11 [==================>...........] - ETA: 0s - loss: 0.3701 - accuracy: 0.7485 8/11 [====================>.........] - ETA: 0s - loss: 0.3702 - accuracy: 0.7464 9/11 [=======================>......] - ETA: 0s - loss: 0.3702 - accuracy: 0.743910/11 [==========================>...] - ETA: 0s - loss: 0.3702 - accuracy: 0.741211/11 [==============================] - ETA: 0s - loss: 0.3702 - accuracy: 0.738811/11 [==============================] - 1s 109ms/step - loss: 0.3703 - accuracy: 0.7369
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3712 - accuracy: 0.7188 2/11 [====>.........................] - ETA: 0s - loss: 0.3687 - accuracy: 0.7227 3/11 [=======>......................] - ETA: 0s - loss: 0.3684 - accuracy: 0.7135 4/11 [=========>....................] - ETA: 0s - loss: 0.3682 - accuracy: 0.7021 5/11 [============>.................] - ETA: 0s - loss: 0.3677 - accuracy: 0.6986 6/11 [===============>..............] - ETA: 0s - loss: 0.3674 - accuracy: 0.6957 7/11 [==================>...........] - ETA: 0s - loss: 0.3672 - accuracy: 0.6942 8/11 [====================>.........] - ETA: 0s - loss: 0.3669 - accuracy: 0.6947 9/11 [=======================>......] - ETA: 0s - loss: 0.3666 - accuracy: 0.695110/11 [==========================>...] - ETA: 0s - loss: 0.3665 - accuracy: 0.696311/11 [==============================] - ETA: 0s - loss: 0.3664 - accuracy: 0.697511/11 [==============================] - 1s 107ms/step - loss: 0.3664 - accuracy: 0.6985
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3720 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.3693 - accuracy: 0.7324 3/11 [=======>......................] - ETA: 0s - loss: 0.3673 - accuracy: 0.7365 4/11 [=========>....................] - ETA: 0s - loss: 0.3666 - accuracy: 0.7345 5/11 [============>.................] - ETA: 0s - loss: 0.3656 - accuracy: 0.7323 6/11 [===============>..............] - ETA: 0s - loss: 0.3647 - accuracy: 0.7292 7/11 [==================>...........] - ETA: 0s - loss: 0.3643 - accuracy: 0.7274 8/11 [====================>.........] - ETA: 0s - loss: 0.3639 - accuracy: 0.7263 9/11 [=======================>......] - ETA: 0s - loss: 0.3636 - accuracy: 0.726210/11 [==========================>...] - ETA: 0s - loss: 0.3635 - accuracy: 0.726311/11 [==============================] - ETA: 0s - loss: 0.3635 - accuracy: 0.726811/11 [==============================] - 1s 106ms/step - loss: 0.3635 - accuracy: 0.7271
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3630 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 0s - loss: 0.3617 - accuracy: 0.8086 3/11 [=======>......................] - ETA: 0s - loss: 0.3624 - accuracy: 0.8099 4/11 [=========>....................] - ETA: 0s - loss: 0.3627 - accuracy: 0.8101 5/11 [============>.................] - ETA: 0s - loss: 0.3629 - accuracy: 0.8090 6/11 [===============>..............] - ETA: 0s - loss: 0.3630 - accuracy: 0.8109 7/11 [==================>...........] - ETA: 0s - loss: 0.3628 - accuracy: 0.8127 8/11 [====================>.........] - ETA: 0s - loss: 0.3628 - accuracy: 0.8129 9/11 [=======================>......] - ETA: 0s - loss: 0.3627 - accuracy: 0.812710/11 [==========================>...] - ETA: 0s - loss: 0.3625 - accuracy: 0.811311/11 [==============================] - ETA: 0s - loss: 0.3624 - accuracy: 0.809911/11 [==============================] - 1s 108ms/step - loss: 0.3623 - accuracy: 0.8088
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3546 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.3564 - accuracy: 0.7383 3/11 [=======>......................] - ETA: 0s - loss: 0.3567 - accuracy: 0.7465 4/11 [=========>....................] - ETA: 0s - loss: 0.3564 - accuracy: 0.7557 5/11 [============>.................] - ETA: 0s - loss: 0.3562 - accuracy: 0.7621 6/11 [===============>..............] - ETA: 0s - loss: 0.3558 - accuracy: 0.7666 7/11 [==================>...........] - ETA: 0s - loss: 0.3558 - accuracy: 0.7691 8/11 [====================>.........] - ETA: 0s - loss: 0.3559 - accuracy: 0.7705 9/11 [=======================>......] - ETA: 0s - loss: 0.3560 - accuracy: 0.771510/11 [==========================>...] - ETA: 0s - loss: 0.3561 - accuracy: 0.771711/11 [==============================] - ETA: 0s - loss: 0.3562 - accuracy: 0.771711/11 [==============================] - 1s 108ms/step - loss: 0.3562 - accuracy: 0.7718
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.3678 - accuracy: 0.75003/6 [==============>...............] - ETA: 0s - loss: 0.3690 - accuracy: 0.7266 5/6 [========================>.....] - ETA: 0s - loss: 0.3684 - accuracy: 0.74066/6 [==============================] - 4s 35ms/step - loss: 0.3667 - accuracy: 0.7436
2021-12-13 23:52:23.103223: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-13 23:52:23.104634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:24:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-13 23:52:23.104692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-13 23:52:23.104743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-13 23:52:23.104839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-13 23:52:23.104874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-13 23:52:23.104968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-13 23:52:23.105010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-13 23:52:23.105045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-13 23:52:23.105139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-13 23:52:23.106538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:24:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-13 23:52:23.106575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-13 23:52:23.106587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-13 23:52:23.106597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 0 4] pred: [-0.9999868 -0.9990966  0.9986079 -0.998719  -0.9999971]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 1 0 4] pred: [-0.999987   -0.9991606   0.99860466 -0.99867886 -0.999997  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [-0.998319    0.9596816   0.9940545  -0.99983215 -0.9999924 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [0 1 3 4 2] pred: [ 0.16285956 -0.22392772 -0.9141911  -0.7232686  -0.8181154 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [-0.998363    0.97747844  0.9102158  -0.99988633 -0.9999958 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [-0.99506336  0.98784846 -0.20789431 -0.99961394 -0.9999892 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 0 4] pred: [-0.9999861  -0.99902266  0.99838275 -0.99860156 -0.999997  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [-0.9967088   0.96526766  0.9246155  -0.9998102  -0.9999923 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 1 0 4] pred: [-0.9999861  -0.99896926  0.9978621  -0.99834806 -0.9999968 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [-0.9987106   0.01437998  0.8417872  -0.9981933  -0.9999656 ]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [-0.9985128  -0.66091484  0.9745087  -0.9946305  -0.99990654]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [-0.9979105   0.9056934   0.9514781  -0.999806   -0.99999267]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 0 4] pred: [-0.999987   -0.99916154  0.9985727  -0.99864846 -0.999997  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [-0.9911325   0.8531375   0.6624335  -0.99873614 -0.9999639 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 2 4 0 1] pred: [-0.998068   -0.99901164 -0.76845825  0.7683638  -0.97848153]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:03 - loss: 0.6900 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.6891 - accuracy: 0.3770   3/11 [=======>......................] - ETA: 0s - loss: 0.6882 - accuracy: 0.3911 4/11 [=========>....................] - ETA: 0s - loss: 0.6872 - accuracy: 0.4066 5/11 [============>.................] - ETA: 0s - loss: 0.6861 - accuracy: 0.4181 6/11 [===============>..............] - ETA: 0s - loss: 0.6850 - accuracy: 0.4276 7/11 [==================>...........] - ETA: 0s - loss: 0.6839 - accuracy: 0.4333 8/11 [====================>.........] - ETA: 0s - loss: 0.6829 - accuracy: 0.4373 9/11 [=======================>......] - ETA: 0s - loss: 0.6818 - accuracy: 0.440110/11 [==========================>...] - ETA: 0s - loss: 0.6806 - accuracy: 0.442211/11 [==============================] - ETA: 0s - loss: 0.6795 - accuracy: 0.443811/11 [==============================] - 13s 105ms/step - loss: 0.6786 - accuracy: 0.4451
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6323 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.6307 - accuracy: 0.4980 3/11 [=======>......................] - ETA: 0s - loss: 0.6283 - accuracy: 0.5004 4/11 [=========>....................] - ETA: 0s - loss: 0.6267 - accuracy: 0.4940 5/11 [============>.................] - ETA: 0s - loss: 0.6251 - accuracy: 0.4886 6/11 [===============>..............] - ETA: 0s - loss: 0.6230 - accuracy: 0.4851 7/11 [==================>...........] - ETA: 0s - loss: 0.6207 - accuracy: 0.4839 8/11 [====================>.........] - ETA: 0s - loss: 0.6182 - accuracy: 0.4832 9/11 [=======================>......] - ETA: 0s - loss: 0.6156 - accuracy: 0.482710/11 [==========================>...] - ETA: 0s - loss: 0.6131 - accuracy: 0.482011/11 [==============================] - ETA: 0s - loss: 0.6107 - accuracy: 0.481411/11 [==============================] - 1s 105ms/step - loss: 0.6087 - accuracy: 0.4808
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5227 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.5149 - accuracy: 0.4805 3/11 [=======>......................] - ETA: 0s - loss: 0.5123 - accuracy: 0.4800 4/11 [=========>....................] - ETA: 0s - loss: 0.5099 - accuracy: 0.4801 5/11 [============>.................] - ETA: 0s - loss: 0.5078 - accuracy: 0.4807 6/11 [===============>..............] - ETA: 0s - loss: 0.5057 - accuracy: 0.4806 7/11 [==================>...........] - ETA: 0s - loss: 0.5038 - accuracy: 0.4810 8/11 [====================>.........] - ETA: 0s - loss: 0.5024 - accuracy: 0.4803 9/11 [=======================>......] - ETA: 0s - loss: 0.5013 - accuracy: 0.479210/11 [==========================>...] - ETA: 0s - loss: 0.5003 - accuracy: 0.478111/11 [==============================] - ETA: 0s - loss: 0.4992 - accuracy: 0.477811/11 [==============================] - 1s 107ms/step - loss: 0.4983 - accuracy: 0.4775
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4875 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.4825 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 0s - loss: 0.4801 - accuracy: 0.4648 4/11 [=========>....................] - ETA: 0s - loss: 0.4793 - accuracy: 0.4644 5/11 [============>.................] - ETA: 0s - loss: 0.4786 - accuracy: 0.4634 6/11 [===============>..............] - ETA: 0s - loss: 0.4784 - accuracy: 0.4614 7/11 [==================>...........] - ETA: 0s - loss: 0.4781 - accuracy: 0.4604 8/11 [====================>.........] - ETA: 0s - loss: 0.4778 - accuracy: 0.4597 9/11 [=======================>......] - ETA: 0s - loss: 0.4773 - accuracy: 0.460110/11 [==========================>...] - ETA: 0s - loss: 0.4770 - accuracy: 0.460911/11 [==============================] - ETA: 0s - loss: 0.4765 - accuracy: 0.462111/11 [==============================] - 1s 112ms/step - loss: 0.4761 - accuracy: 0.4631
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4987 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 1s - loss: 0.4868 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 0s - loss: 0.4802 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.4770 - accuracy: 0.4668 5/11 [============>.................] - ETA: 0s - loss: 0.4760 - accuracy: 0.4681 6/11 [===============>..............] - ETA: 0s - loss: 0.4748 - accuracy: 0.4702 7/11 [==================>...........] - ETA: 0s - loss: 0.4737 - accuracy: 0.4722 8/11 [====================>.........] - ETA: 0s - loss: 0.4729 - accuracy: 0.4739 9/11 [=======================>......] - ETA: 0s - loss: 0.4722 - accuracy: 0.475010/11 [==========================>...] - ETA: 0s - loss: 0.4718 - accuracy: 0.475211/11 [==============================] - ETA: 0s - loss: 0.4714 - accuracy: 0.475111/11 [==============================] - 1s 109ms/step - loss: 0.4710 - accuracy: 0.4750
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4594 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.4609 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 0s - loss: 0.4601 - accuracy: 0.4701 4/11 [=========>....................] - ETA: 0s - loss: 0.4611 - accuracy: 0.4668 5/11 [============>.................] - ETA: 0s - loss: 0.4613 - accuracy: 0.4678 6/11 [===============>..............] - ETA: 0s - loss: 0.4616 - accuracy: 0.4678 7/11 [==================>...........] - ETA: 0s - loss: 0.4618 - accuracy: 0.4677 8/11 [====================>.........] - ETA: 0s - loss: 0.4620 - accuracy: 0.4669 9/11 [=======================>......] - ETA: 0s - loss: 0.4620 - accuracy: 0.467010/11 [==========================>...] - ETA: 0s - loss: 0.4618 - accuracy: 0.467211/11 [==============================] - ETA: 0s - loss: 0.4617 - accuracy: 0.468011/11 [==============================] - 1s 114ms/step - loss: 0.4615 - accuracy: 0.4686
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4466 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.4473 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.4488 - accuracy: 0.4653 4/11 [=========>....................] - ETA: 0s - loss: 0.4496 - accuracy: 0.4715 5/11 [============>.................] - ETA: 0s - loss: 0.4496 - accuracy: 0.4760 6/11 [===============>..............] - ETA: 0s - loss: 0.4498 - accuracy: 0.4771 7/11 [==================>...........] - ETA: 0s - loss: 0.4499 - accuracy: 0.4788 8/11 [====================>.........] - ETA: 0s - loss: 0.4498 - accuracy: 0.4805 9/11 [=======================>......] - ETA: 0s - loss: 0.4498 - accuracy: 0.481710/11 [==========================>...] - ETA: 0s - loss: 0.4499 - accuracy: 0.482411/11 [==============================] - ETA: 0s - loss: 0.4498 - accuracy: 0.483011/11 [==============================] - 1s 111ms/step - loss: 0.4498 - accuracy: 0.4836
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4378 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.4416 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 0s - loss: 0.4427 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.4425 - accuracy: 0.5161 5/11 [============>.................] - ETA: 0s - loss: 0.4417 - accuracy: 0.5198 6/11 [===============>..............] - ETA: 0s - loss: 0.4412 - accuracy: 0.5223 7/11 [==================>...........] - ETA: 0s - loss: 0.4405 - accuracy: 0.5255 8/11 [====================>.........] - ETA: 0s - loss: 0.4402 - accuracy: 0.5275 9/11 [=======================>......] - ETA: 0s - loss: 0.4399 - accuracy: 0.528610/11 [==========================>...] - ETA: 0s - loss: 0.4396 - accuracy: 0.529311/11 [==============================] - ETA: 0s - loss: 0.4393 - accuracy: 0.530211/11 [==============================] - 1s 113ms/step - loss: 0.4390 - accuracy: 0.5310
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4355 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.4344 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.4322 - accuracy: 0.5521 4/11 [=========>....................] - ETA: 0s - loss: 0.4305 - accuracy: 0.5581 5/11 [============>.................] - ETA: 0s - loss: 0.4290 - accuracy: 0.5634 6/11 [===============>..............] - ETA: 0s - loss: 0.4277 - accuracy: 0.5671 7/11 [==================>...........] - ETA: 0s - loss: 0.4268 - accuracy: 0.5697 8/11 [====================>.........] - ETA: 0s - loss: 0.4261 - accuracy: 0.5712 9/11 [=======================>......] - ETA: 0s - loss: 0.4255 - accuracy: 0.571610/11 [==========================>...] - ETA: 0s - loss: 0.4251 - accuracy: 0.571811/11 [==============================] - ETA: 0s - loss: 0.4246 - accuracy: 0.571911/11 [==============================] - 1s 107ms/step - loss: 0.4243 - accuracy: 0.5720
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4198 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 0s - loss: 0.4183 - accuracy: 0.5723 3/11 [=======>......................] - ETA: 0s - loss: 0.4165 - accuracy: 0.5898 4/11 [=========>....................] - ETA: 0s - loss: 0.4151 - accuracy: 0.6035 5/11 [============>.................] - ETA: 0s - loss: 0.4147 - accuracy: 0.6100 6/11 [===============>..............] - ETA: 0s - loss: 0.4140 - accuracy: 0.6160 7/11 [==================>...........] - ETA: 0s - loss: 0.4137 - accuracy: 0.6198 8/11 [====================>.........] - ETA: 0s - loss: 0.4131 - accuracy: 0.6224 9/11 [=======================>......] - ETA: 0s - loss: 0.4128 - accuracy: 0.623610/11 [==========================>...] - ETA: 0s - loss: 0.4124 - accuracy: 0.623511/11 [==============================] - ETA: 0s - loss: 0.4121 - accuracy: 0.623211/11 [==============================] - 1s 111ms/step - loss: 0.4118 - accuracy: 0.6229
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3991 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 0s - loss: 0.4010 - accuracy: 0.5586 3/11 [=======>......................] - ETA: 0s - loss: 0.4042 - accuracy: 0.5590 4/11 [=========>....................] - ETA: 0s - loss: 0.4051 - accuracy: 0.5604 5/11 [============>.................] - ETA: 0s - loss: 0.4046 - accuracy: 0.5667 6/11 [===============>..............] - ETA: 0s - loss: 0.4047 - accuracy: 0.5697 7/11 [==================>...........] - ETA: 0s - loss: 0.4045 - accuracy: 0.5735 8/11 [====================>.........] - ETA: 0s - loss: 0.4042 - accuracy: 0.5769 9/11 [=======================>......] - ETA: 0s - loss: 0.4039 - accuracy: 0.580410/11 [==========================>...] - ETA: 0s - loss: 0.4035 - accuracy: 0.583411/11 [==============================] - ETA: 0s - loss: 0.4030 - accuracy: 0.586311/11 [==============================] - 1s 105ms/step - loss: 0.4027 - accuracy: 0.5887
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3892 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 0s - loss: 0.3894 - accuracy: 0.6055 3/11 [=======>......................] - ETA: 0s - loss: 0.3884 - accuracy: 0.6050 4/11 [=========>....................] - ETA: 0s - loss: 0.3875 - accuracy: 0.6081 5/11 [============>.................] - ETA: 0s - loss: 0.3874 - accuracy: 0.6105 6/11 [===============>..............] - ETA: 0s - loss: 0.3876 - accuracy: 0.6105 7/11 [==================>...........] - ETA: 0s - loss: 0.3880 - accuracy: 0.6107 8/11 [====================>.........] - ETA: 0s - loss: 0.3885 - accuracy: 0.6108 9/11 [=======================>......] - ETA: 0s - loss: 0.3889 - accuracy: 0.610410/11 [==========================>...] - ETA: 0s - loss: 0.3892 - accuracy: 0.610611/11 [==============================] - ETA: 0s - loss: 0.3894 - accuracy: 0.610811/11 [==============================] - 1s 104ms/step - loss: 0.3896 - accuracy: 0.6110
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3852 - accuracy: 0.6094 2/11 [====>.........................] - ETA: 1s - loss: 0.3837 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 0s - loss: 0.3826 - accuracy: 0.6441 4/11 [=========>....................] - ETA: 0s - loss: 0.3826 - accuracy: 0.6442 5/11 [============>.................] - ETA: 0s - loss: 0.3828 - accuracy: 0.6422 6/11 [===============>..............] - ETA: 0s - loss: 0.3832 - accuracy: 0.6398 7/11 [==================>...........] - ETA: 0s - loss: 0.3833 - accuracy: 0.6390 8/11 [====================>.........] - ETA: 0s - loss: 0.3835 - accuracy: 0.6381 9/11 [=======================>......] - ETA: 0s - loss: 0.3837 - accuracy: 0.638310/11 [==========================>...] - ETA: 0s - loss: 0.3839 - accuracy: 0.638711/11 [==============================] - ETA: 0s - loss: 0.3841 - accuracy: 0.639611/11 [==============================] - 1s 108ms/step - loss: 0.3842 - accuracy: 0.6403
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3827 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 1s - loss: 0.3819 - accuracy: 0.6504 3/11 [=======>......................] - ETA: 0s - loss: 0.3798 - accuracy: 0.6567 4/11 [=========>....................] - ETA: 0s - loss: 0.3798 - accuracy: 0.6546 5/11 [============>.................] - ETA: 0s - loss: 0.3800 - accuracy: 0.6515 6/11 [===============>..............] - ETA: 0s - loss: 0.3801 - accuracy: 0.6480 7/11 [==================>...........] - ETA: 0s - loss: 0.3801 - accuracy: 0.6460 8/11 [====================>.........] - ETA: 0s - loss: 0.3800 - accuracy: 0.6464 9/11 [=======================>......] - ETA: 0s - loss: 0.3799 - accuracy: 0.647910/11 [==========================>...] - ETA: 0s - loss: 0.3799 - accuracy: 0.650311/11 [==============================] - ETA: 0s - loss: 0.3800 - accuracy: 0.652611/11 [==============================] - 1s 110ms/step - loss: 0.3801 - accuracy: 0.6545
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3854 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 0s - loss: 0.3844 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 0s - loss: 0.3830 - accuracy: 0.6918 4/11 [=========>....................] - ETA: 0s - loss: 0.3814 - accuracy: 0.6864 5/11 [============>.................] - ETA: 0s - loss: 0.3807 - accuracy: 0.6797 6/11 [===============>..............] - ETA: 0s - loss: 0.3802 - accuracy: 0.6754 7/11 [==================>...........] - ETA: 0s - loss: 0.3800 - accuracy: 0.6718 8/11 [====================>.........] - ETA: 0s - loss: 0.3795 - accuracy: 0.6700 9/11 [=======================>......] - ETA: 0s - loss: 0.3792 - accuracy: 0.669410/11 [==========================>...] - ETA: 0s - loss: 0.3788 - accuracy: 0.669811/11 [==============================] - ETA: 0s - loss: 0.3785 - accuracy: 0.670111/11 [==============================] - 1s 107ms/step - loss: 0.3783 - accuracy: 0.6703
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3791 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.3779 - accuracy: 0.6602 3/11 [=======>......................] - ETA: 0s - loss: 0.3765 - accuracy: 0.6719 4/11 [=========>....................] - ETA: 0s - loss: 0.3755 - accuracy: 0.6787 5/11 [============>.................] - ETA: 0s - loss: 0.3749 - accuracy: 0.6836 6/11 [===============>..............] - ETA: 0s - loss: 0.3742 - accuracy: 0.6873 7/11 [==================>...........] - ETA: 0s - loss: 0.3739 - accuracy: 0.6891 8/11 [====================>.........] - ETA: 0s - loss: 0.3737 - accuracy: 0.6890 9/11 [=======================>......] - ETA: 0s - loss: 0.3736 - accuracy: 0.688910/11 [==========================>...] - ETA: 0s - loss: 0.3735 - accuracy: 0.689611/11 [==============================] - ETA: 0s - loss: 0.3734 - accuracy: 0.690711/11 [==============================] - 1s 108ms/step - loss: 0.3733 - accuracy: 0.6917
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3616 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 0s - loss: 0.3610 - accuracy: 0.8105 3/11 [=======>......................] - ETA: 0s - loss: 0.3635 - accuracy: 0.8060 4/11 [=========>....................] - ETA: 0s - loss: 0.3649 - accuracy: 0.8022 5/11 [============>.................] - ETA: 0s - loss: 0.3659 - accuracy: 0.7927 6/11 [===============>..............] - ETA: 0s - loss: 0.3668 - accuracy: 0.7841 7/11 [==================>...........] - ETA: 0s - loss: 0.3674 - accuracy: 0.7762 8/11 [====================>.........] - ETA: 0s - loss: 0.3678 - accuracy: 0.7699 9/11 [=======================>......] - ETA: 0s - loss: 0.3681 - accuracy: 0.765310/11 [==========================>...] - ETA: 0s - loss: 0.3683 - accuracy: 0.762411/11 [==============================] - ETA: 0s - loss: 0.3684 - accuracy: 0.759911/11 [==============================] - 1s 105ms/step - loss: 0.3686 - accuracy: 0.7579
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3644 - accuracy: 0.7109 2/11 [====>.........................] - ETA: 0s - loss: 0.3659 - accuracy: 0.7012 3/11 [=======>......................] - ETA: 0s - loss: 0.3658 - accuracy: 0.6897 4/11 [=========>....................] - ETA: 0s - loss: 0.3662 - accuracy: 0.6842 5/11 [============>.................] - ETA: 0s - loss: 0.3665 - accuracy: 0.6811 6/11 [===============>..............] - ETA: 0s - loss: 0.3669 - accuracy: 0.6813 7/11 [==================>...........] - ETA: 0s - loss: 0.3669 - accuracy: 0.6827 8/11 [====================>.........] - ETA: 0s - loss: 0.3671 - accuracy: 0.6845 9/11 [=======================>......] - ETA: 0s - loss: 0.3670 - accuracy: 0.686110/11 [==========================>...] - ETA: 0s - loss: 0.3669 - accuracy: 0.687411/11 [==============================] - ETA: 0s - loss: 0.3670 - accuracy: 0.688111/11 [==============================] - 1s 110ms/step - loss: 0.3670 - accuracy: 0.6886
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3717 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 0s - loss: 0.3688 - accuracy: 0.6973 3/11 [=======>......................] - ETA: 0s - loss: 0.3682 - accuracy: 0.7053 4/11 [=========>....................] - ETA: 0s - loss: 0.3666 - accuracy: 0.7179 5/11 [============>.................] - ETA: 0s - loss: 0.3663 - accuracy: 0.7243 6/11 [===============>..............] - ETA: 0s - loss: 0.3660 - accuracy: 0.7308 7/11 [==================>...........] - ETA: 0s - loss: 0.3659 - accuracy: 0.7355 8/11 [====================>.........] - ETA: 0s - loss: 0.3658 - accuracy: 0.7385 9/11 [=======================>......] - ETA: 0s - loss: 0.3658 - accuracy: 0.740610/11 [==========================>...] - ETA: 0s - loss: 0.3657 - accuracy: 0.741711/11 [==============================] - ETA: 0s - loss: 0.3657 - accuracy: 0.742811/11 [==============================] - 1s 106ms/step - loss: 0.3656 - accuracy: 0.7438
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3755 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.3706 - accuracy: 0.6543 3/11 [=======>......................] - ETA: 0s - loss: 0.3680 - accuracy: 0.6706 4/11 [=========>....................] - ETA: 0s - loss: 0.3665 - accuracy: 0.6812 5/11 [============>.................] - ETA: 0s - loss: 0.3660 - accuracy: 0.6902 6/11 [===============>..............] - ETA: 0s - loss: 0.3658 - accuracy: 0.6963 7/11 [==================>...........] - ETA: 0s - loss: 0.3657 - accuracy: 0.7001 8/11 [====================>.........] - ETA: 0s - loss: 0.3655 - accuracy: 0.7036 9/11 [=======================>......] - ETA: 0s - loss: 0.3652 - accuracy: 0.706710/11 [==========================>...] - ETA: 0s - loss: 0.3650 - accuracy: 0.709411/11 [==============================] - ETA: 0s - loss: 0.3649 - accuracy: 0.712111/11 [==============================] - 1s 114ms/step - loss: 0.3647 - accuracy: 0.7144
Evaluate on test data
1/6 [====>.........................] - ETA: 17s - loss: 0.3769 - accuracy: 0.62503/6 [==============>...............] - ETA: 0s - loss: 0.3726 - accuracy: 0.6354 5/6 [========================>.....] - ETA: 0s - loss: 0.3692 - accuracy: 0.65316/6 [==============================] - 4s 30ms/step - loss: 0.3708 - accuracy: 0.6473
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [-0.9995666   0.953471    0.9810803  -0.99993247 -0.99997884]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [-0.99933136  0.42201516  0.9242048  -0.99998665 -0.99998426]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 4 3] pred: [-0.9998068   0.27724603  0.9879338  -0.99999076 -0.99998486]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 4 3 0] pred: [-0.9999966 -0.9990198  0.9951905 -0.9999936 -0.9999404]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 4 1 3 0] pred: [-0.9999928  -0.99980867 -0.03034467 -0.9998434  -0.99550414]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 3 4] pred: [-0.9993516   0.9255057   0.9507802  -0.9999176  -0.99996835]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 3 0] pred: [-0.99999726 -0.9996196   0.99245465 -0.99998915 -0.9996587 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [-0.98967946  0.97828037  0.16467412 -0.99955183 -0.99986094]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 3 0] pred: [-0.99998105 -0.9862096   0.99130994 -0.99990076 -0.99931276]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [-0.9998343   0.93633115  0.9969975  -0.9999674  -0.9999842 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 4 3 0] pred: [-0.9999962  -0.9970096   0.99662167 -0.9999914  -0.9999769 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 3 0] pred: [-0.99999726 -0.9993014   0.9957898  -0.9999935  -0.9999144 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 3 0] pred: [-0.99999577 -0.99804926  0.99523395 -0.99999285 -0.99996716]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [-0.99911743  0.98017544  0.9713054  -0.99990433 -0.9999831 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [-0.99955153  0.9069395   0.9386545  -0.9998791  -0.99996626]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Job end at lun déc 13 23:53:13 CET 2021
