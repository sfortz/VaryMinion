
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at mar déc 14 00:00:15 CET 2021
2021-12-14 00:00:16.301701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-14 00:00:21.501693: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:00:21.503302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-14 00:00:21.515117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:00:21.515156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:00:21.519479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:00:21.519524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:00:21.522404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:00:21.524032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:00:21.527490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:00:21.529392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:00:21.535509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:00:21.536864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:00:21.571615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:00:21.571655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:00:21.571667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:00:23.132034: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:00:23.133336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:00:23.133382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:00:23.133464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:00:23.133507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:00:23.133546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:00:23.133635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:00:23.133680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:00:23.133719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:00:23.133799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:00:23.134988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:00:23.135754: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:00:23.135776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:00:23.135785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2021-12-14 00:00:23.135884: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-14 00:00:26.176610: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-14 00:00:26.177239: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2593570000 Hz
Number of possible configurations: 40
Begining exécution of the 37 th configuration: BPIC20.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, sigmoid as activation function and bin_ce-logits as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 58)          3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                21360     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:56 - loss: 0.6884 - accuracy: 0.0703 2/11 [====>.........................] - ETA: 0s - loss: 0.6869 - accuracy: 0.1758   3/11 [=======>......................] - ETA: 0s - loss: 0.6854 - accuracy: 0.2326 4/11 [=========>....................] - ETA: 0s - loss: 0.6840 - accuracy: 0.2653 5/11 [============>.................] - ETA: 0s - loss: 0.6825 - accuracy: 0.2894 6/11 [===============>..............] - ETA: 0s - loss: 0.6810 - accuracy: 0.3063 7/11 [==================>...........] - ETA: 0s - loss: 0.6795 - accuracy: 0.3198 8/11 [====================>.........] - ETA: 0s - loss: 0.6779 - accuracy: 0.3301 9/11 [=======================>......] - ETA: 0s - loss: 0.6764 - accuracy: 0.338510/11 [==========================>...] - ETA: 0s - loss: 0.6748 - accuracy: 0.345611/11 [==============================] - ETA: 0s - loss: 0.6732 - accuracy: 0.352211/11 [==============================] - 13s 99ms/step - loss: 0.6718 - accuracy: 0.3576
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6006 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.6020 - accuracy: 0.4434 3/11 [=======>......................] - ETA: 0s - loss: 0.5996 - accuracy: 0.4397 4/11 [=========>....................] - ETA: 0s - loss: 0.5962 - accuracy: 0.4425 5/11 [============>.................] - ETA: 0s - loss: 0.5933 - accuracy: 0.4415 6/11 [===============>..............] - ETA: 0s - loss: 0.5902 - accuracy: 0.4402 7/11 [==================>...........] - ETA: 0s - loss: 0.5870 - accuracy: 0.4389 8/11 [====================>.........] - ETA: 0s - loss: 0.5833 - accuracy: 0.4398 9/11 [=======================>......] - ETA: 0s - loss: 0.5793 - accuracy: 0.440510/11 [==========================>...] - ETA: 0s - loss: 0.5749 - accuracy: 0.442211/11 [==============================] - ETA: 0s - loss: 0.5706 - accuracy: 0.443811/11 [==============================] - 1s 102ms/step - loss: 0.5671 - accuracy: 0.4452
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4309 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.4372 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 0s - loss: 0.4408 - accuracy: 0.4366 4/11 [=========>....................] - ETA: 0s - loss: 0.4397 - accuracy: 0.4344 5/11 [============>.................] - ETA: 0s - loss: 0.4367 - accuracy: 0.4357 6/11 [===============>..............] - ETA: 0s - loss: 0.4324 - accuracy: 0.4412 7/11 [==================>...........] - ETA: 0s - loss: 0.4293 - accuracy: 0.4443 8/11 [====================>.........] - ETA: 0s - loss: 0.4267 - accuracy: 0.4475 9/11 [=======================>......] - ETA: 0s - loss: 0.4248 - accuracy: 0.449210/11 [==========================>...] - ETA: 0s - loss: 0.4231 - accuracy: 0.450511/11 [==============================] - ETA: 0s - loss: 0.4217 - accuracy: 0.451411/11 [==============================] - 1s 103ms/step - loss: 0.4205 - accuracy: 0.4522
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3997 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.3898 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 0s - loss: 0.3876 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.3889 - accuracy: 0.4580 5/11 [============>.................] - ETA: 0s - loss: 0.3897 - accuracy: 0.4586 6/11 [===============>..............] - ETA: 0s - loss: 0.3897 - accuracy: 0.4605 7/11 [==================>...........] - ETA: 0s - loss: 0.3894 - accuracy: 0.4610 8/11 [====================>.........] - ETA: 0s - loss: 0.3896 - accuracy: 0.4598 9/11 [=======================>......] - ETA: 0s - loss: 0.3893 - accuracy: 0.459910/11 [==========================>...] - ETA: 0s - loss: 0.3890 - accuracy: 0.460611/11 [==============================] - ETA: 0s - loss: 0.3890 - accuracy: 0.460611/11 [==============================] - 1s 101ms/step - loss: 0.3890 - accuracy: 0.4606
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4335 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.4152 - accuracy: 0.4395 3/11 [=======>......................] - ETA: 0s - loss: 0.4053 - accuracy: 0.4440 4/11 [=========>....................] - ETA: 0s - loss: 0.3994 - accuracy: 0.4478 5/11 [============>.................] - ETA: 0s - loss: 0.3957 - accuracy: 0.4504 6/11 [===============>..............] - ETA: 0s - loss: 0.3940 - accuracy: 0.4537 7/11 [==================>...........] - ETA: 0s - loss: 0.3924 - accuracy: 0.4561 8/11 [====================>.........] - ETA: 0s - loss: 0.3915 - accuracy: 0.4577 9/11 [=======================>......] - ETA: 0s - loss: 0.3912 - accuracy: 0.458510/11 [==========================>...] - ETA: 0s - loss: 0.3909 - accuracy: 0.459211/11 [==============================] - ETA: 0s - loss: 0.3906 - accuracy: 0.459311/11 [==============================] - 1s 101ms/step - loss: 0.3903 - accuracy: 0.4594
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3788 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.3825 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3821 - accuracy: 0.4592 4/11 [=========>....................] - ETA: 0s - loss: 0.3793 - accuracy: 0.4631 5/11 [============>.................] - ETA: 0s - loss: 0.3779 - accuracy: 0.4626 6/11 [===============>..............] - ETA: 0s - loss: 0.3778 - accuracy: 0.4606 7/11 [==================>...........] - ETA: 0s - loss: 0.3784 - accuracy: 0.4600 8/11 [====================>.........] - ETA: 0s - loss: 0.3787 - accuracy: 0.4603 9/11 [=======================>......] - ETA: 0s - loss: 0.3792 - accuracy: 0.459910/11 [==========================>...] - ETA: 0s - loss: 0.3795 - accuracy: 0.459811/11 [==============================] - ETA: 0s - loss: 0.3797 - accuracy: 0.459911/11 [==============================] - 1s 98ms/step - loss: 0.3798 - accuracy: 0.4599
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3690 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.3637 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 0s - loss: 0.3653 - accuracy: 0.5009 4/11 [=========>....................] - ETA: 0s - loss: 0.3690 - accuracy: 0.4914 5/11 [============>.................] - ETA: 0s - loss: 0.3712 - accuracy: 0.4862 6/11 [===============>..............] - ETA: 0s - loss: 0.3730 - accuracy: 0.4822 7/11 [==================>...........] - ETA: 0s - loss: 0.3738 - accuracy: 0.4800 8/11 [====================>.........] - ETA: 0s - loss: 0.3742 - accuracy: 0.4787 9/11 [=======================>......] - ETA: 0s - loss: 0.3742 - accuracy: 0.477410/11 [==========================>...] - ETA: 0s - loss: 0.3742 - accuracy: 0.476011/11 [==============================] - ETA: 0s - loss: 0.3740 - accuracy: 0.474611/11 [==============================] - 1s 103ms/step - loss: 0.3738 - accuracy: 0.4734
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3485 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.3524 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 0s - loss: 0.3600 - accuracy: 0.4618 4/11 [=========>....................] - ETA: 0s - loss: 0.3641 - accuracy: 0.4606 5/11 [============>.................] - ETA: 0s - loss: 0.3675 - accuracy: 0.4569 6/11 [===============>..............] - ETA: 0s - loss: 0.3691 - accuracy: 0.4541 7/11 [==================>...........] - ETA: 0s - loss: 0.3697 - accuracy: 0.4519 8/11 [====================>.........] - ETA: 0s - loss: 0.3695 - accuracy: 0.4512 9/11 [=======================>......] - ETA: 0s - loss: 0.3689 - accuracy: 0.451010/11 [==========================>...] - ETA: 0s - loss: 0.3679 - accuracy: 0.452011/11 [==============================] - ETA: 0s - loss: 0.3669 - accuracy: 0.452811/11 [==============================] - 1s 100ms/step - loss: 0.3661 - accuracy: 0.4534
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3429 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.3394 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.3425 - accuracy: 0.4774 4/11 [=========>....................] - ETA: 0s - loss: 0.3428 - accuracy: 0.4723 5/11 [============>.................] - ETA: 0s - loss: 0.3427 - accuracy: 0.4701 6/11 [===============>..............] - ETA: 0s - loss: 0.3424 - accuracy: 0.4696 7/11 [==================>...........] - ETA: 0s - loss: 0.3415 - accuracy: 0.4693 8/11 [====================>.........] - ETA: 0s - loss: 0.3406 - accuracy: 0.4689 9/11 [=======================>......] - ETA: 0s - loss: 0.3405 - accuracy: 0.467310/11 [==========================>...] - ETA: 0s - loss: 0.3405 - accuracy: 0.466311/11 [==============================] - ETA: 0s - loss: 0.3402 - accuracy: 0.465811/11 [==============================] - 1s 104ms/step - loss: 0.3399 - accuracy: 0.4653
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3249 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.3233 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.3263 - accuracy: 0.4314 4/11 [=========>....................] - ETA: 0s - loss: 0.3268 - accuracy: 0.4373 5/11 [============>.................] - ETA: 0s - loss: 0.3254 - accuracy: 0.4442 6/11 [===============>..............] - ETA: 0s - loss: 0.3244 - accuracy: 0.4475 7/11 [==================>...........] - ETA: 0s - loss: 0.3236 - accuracy: 0.4495 8/11 [====================>.........] - ETA: 0s - loss: 0.3227 - accuracy: 0.4512 9/11 [=======================>......] - ETA: 0s - loss: 0.3222 - accuracy: 0.453010/11 [==========================>...] - ETA: 0s - loss: 0.3216 - accuracy: 0.454811/11 [==============================] - ETA: 0s - loss: 0.3209 - accuracy: 0.456011/11 [==============================] - 1s 103ms/step - loss: 0.3204 - accuracy: 0.4571
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2935 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.2938 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.2919 - accuracy: 0.5026 4/11 [=========>....................] - ETA: 0s - loss: 0.2916 - accuracy: 0.5029 5/11 [============>.................] - ETA: 0s - loss: 0.2914 - accuracy: 0.5005 6/11 [===============>..............] - ETA: 0s - loss: 0.2917 - accuracy: 0.4965 7/11 [==================>...........] - ETA: 0s - loss: 0.2915 - accuracy: 0.4936 8/11 [====================>.........] - ETA: 0s - loss: 0.2914 - accuracy: 0.4904 9/11 [=======================>......] - ETA: 0s - loss: 0.2914 - accuracy: 0.487710/11 [==========================>...] - ETA: 0s - loss: 0.2911 - accuracy: 0.486511/11 [==============================] - ETA: 0s - loss: 0.2909 - accuracy: 0.486111/11 [==============================] - 1s 100ms/step - loss: 0.2907 - accuracy: 0.4858
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2421 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 0s - loss: 0.2493 - accuracy: 0.5996 3/11 [=======>......................] - ETA: 0s - loss: 0.2507 - accuracy: 0.5777 4/11 [=========>....................] - ETA: 0s - loss: 0.2520 - accuracy: 0.5646 5/11 [============>.................] - ETA: 0s - loss: 0.2538 - accuracy: 0.5526 6/11 [===============>..............] - ETA: 0s - loss: 0.2554 - accuracy: 0.5432 7/11 [==================>...........] - ETA: 0s - loss: 0.2565 - accuracy: 0.5362 8/11 [====================>.........] - ETA: 0s - loss: 0.2572 - accuracy: 0.5305 9/11 [=======================>......] - ETA: 0s - loss: 0.2578 - accuracy: 0.525210/11 [==========================>...] - ETA: 0s - loss: 0.2580 - accuracy: 0.521411/11 [==============================] - ETA: 0s - loss: 0.2581 - accuracy: 0.518311/11 [==============================] - 1s 112ms/step - loss: 0.2582 - accuracy: 0.5156
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2378 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.2356 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.2346 - accuracy: 0.5243 4/11 [=========>....................] - ETA: 0s - loss: 0.2353 - accuracy: 0.5202 5/11 [============>.................] - ETA: 0s - loss: 0.2355 - accuracy: 0.5165 6/11 [===============>..............] - ETA: 0s - loss: 0.2356 - accuracy: 0.5120 7/11 [==================>...........] - ETA: 0s - loss: 0.2356 - accuracy: 0.5079 8/11 [====================>.........] - ETA: 0s - loss: 0.2353 - accuracy: 0.5053 9/11 [=======================>......] - ETA: 0s - loss: 0.2350 - accuracy: 0.503010/11 [==========================>...] - ETA: 0s - loss: 0.2346 - accuracy: 0.501611/11 [==============================] - ETA: 0s - loss: 0.2342 - accuracy: 0.501011/11 [==============================] - 1s 102ms/step - loss: 0.2338 - accuracy: 0.5005
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2079 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 0s - loss: 0.2023 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.1996 - accuracy: 0.5425 4/11 [=========>....................] - ETA: 0s - loss: 0.1980 - accuracy: 0.5378 5/11 [============>.................] - ETA: 0s - loss: 0.1969 - accuracy: 0.5371 6/11 [===============>..............] - ETA: 0s - loss: 0.1965 - accuracy: 0.5348 7/11 [==================>...........] - ETA: 0s - loss: 0.1965 - accuracy: 0.5317 8/11 [====================>.........] - ETA: 0s - loss: 0.1967 - accuracy: 0.5300 9/11 [=======================>......] - ETA: 0s - loss: 0.1972 - accuracy: 0.530110/11 [==========================>...] - ETA: 0s - loss: 0.1977 - accuracy: 0.532011/11 [==============================] - ETA: 0s - loss: 0.1982 - accuracy: 0.534311/11 [==============================] - 1s 102ms/step - loss: 0.1985 - accuracy: 0.5363
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1930 - accuracy: 0.7734 2/11 [====>.........................] - ETA: 1s - loss: 0.2010 - accuracy: 0.7539 3/11 [=======>......................] - ETA: 0s - loss: 0.2010 - accuracy: 0.7439 4/11 [=========>....................] - ETA: 0s - loss: 0.2001 - accuracy: 0.7318 5/11 [============>.................] - ETA: 0s - loss: 0.1986 - accuracy: 0.7235 6/11 [===============>..............] - ETA: 0s - loss: 0.1969 - accuracy: 0.7204 7/11 [==================>...........] - ETA: 0s - loss: 0.1951 - accuracy: 0.7206 8/11 [====================>.........] - ETA: 0s - loss: 0.1940 - accuracy: 0.7220 9/11 [=======================>......] - ETA: 0s - loss: 0.1930 - accuracy: 0.724510/11 [==========================>...] - ETA: 0s - loss: 0.1922 - accuracy: 0.726711/11 [==============================] - ETA: 0s - loss: 0.1914 - accuracy: 0.728511/11 [==============================] - 1s 102ms/step - loss: 0.1907 - accuracy: 0.7301
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2007 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.1994 - accuracy: 0.7344 3/11 [=======>......................] - ETA: 0s - loss: 0.1940 - accuracy: 0.7448 4/11 [=========>....................] - ETA: 0s - loss: 0.1895 - accuracy: 0.7505 5/11 [============>.................] - ETA: 0s - loss: 0.1865 - accuracy: 0.7545 6/11 [===============>..............] - ETA: 0s - loss: 0.1845 - accuracy: 0.7578 7/11 [==================>...........] - ETA: 0s - loss: 0.1832 - accuracy: 0.7618 8/11 [====================>.........] - ETA: 0s - loss: 0.1820 - accuracy: 0.7652 9/11 [=======================>......] - ETA: 0s - loss: 0.1808 - accuracy: 0.767610/11 [==========================>...] - ETA: 0s - loss: 0.1797 - accuracy: 0.768511/11 [==============================] - ETA: 0s - loss: 0.1787 - accuracy: 0.769111/11 [==============================] - 1s 108ms/step - loss: 0.1778 - accuracy: 0.7697
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1592 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 0s - loss: 0.1619 - accuracy: 0.7539 3/11 [=======>......................] - ETA: 0s - loss: 0.1598 - accuracy: 0.7682 4/11 [=========>....................] - ETA: 0s - loss: 0.1586 - accuracy: 0.7778 5/11 [============>.................] - ETA: 0s - loss: 0.1584 - accuracy: 0.7841 6/11 [===============>..............] - ETA: 0s - loss: 0.1584 - accuracy: 0.7878 7/11 [==================>...........] - ETA: 0s - loss: 0.1583 - accuracy: 0.7916 8/11 [====================>.........] - ETA: 0s - loss: 0.1582 - accuracy: 0.7953 9/11 [=======================>......] - ETA: 0s - loss: 0.1581 - accuracy: 0.799010/11 [==========================>...] - ETA: 0s - loss: 0.1580 - accuracy: 0.802111/11 [==============================] - ETA: 0s - loss: 0.1577 - accuracy: 0.804911/11 [==============================] - 1s 102ms/step - loss: 0.1575 - accuracy: 0.8072
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1325 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 1s - loss: 0.1355 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 0s - loss: 0.1386 - accuracy: 0.8229 4/11 [=========>....................] - ETA: 0s - loss: 0.1404 - accuracy: 0.8159 5/11 [============>.................] - ETA: 0s - loss: 0.1417 - accuracy: 0.8115 6/11 [===============>..............] - ETA: 0s - loss: 0.1428 - accuracy: 0.8080 7/11 [==================>...........] - ETA: 0s - loss: 0.1436 - accuracy: 0.8056 8/11 [====================>.........] - ETA: 0s - loss: 0.1442 - accuracy: 0.8062 9/11 [=======================>......] - ETA: 0s - loss: 0.1445 - accuracy: 0.807710/11 [==========================>...] - ETA: 0s - loss: 0.1446 - accuracy: 0.809611/11 [==============================] - ETA: 0s - loss: 0.1446 - accuracy: 0.811611/11 [==============================] - 1s 101ms/step - loss: 0.1446 - accuracy: 0.8133
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1447 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 0s - loss: 0.1438 - accuracy: 0.8652 3/11 [=======>......................] - ETA: 0s - loss: 0.1443 - accuracy: 0.8607 4/11 [=========>....................] - ETA: 0s - loss: 0.1431 - accuracy: 0.8628 5/11 [============>.................] - ETA: 0s - loss: 0.1424 - accuracy: 0.8634 6/11 [===============>..............] - ETA: 0s - loss: 0.1418 - accuracy: 0.8636 7/11 [==================>...........] - ETA: 0s - loss: 0.1411 - accuracy: 0.8626 8/11 [====================>.........] - ETA: 0s - loss: 0.1407 - accuracy: 0.8624 9/11 [=======================>......] - ETA: 0s - loss: 0.1402 - accuracy: 0.862410/11 [==========================>...] - ETA: 0s - loss: 0.1397 - accuracy: 0.862711/11 [==============================] - ETA: 0s - loss: 0.1393 - accuracy: 0.863411/11 [==============================] - 1s 100ms/step - loss: 0.1390 - accuracy: 0.8641
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1299 - accuracy: 0.8906 2/11 [====>.........................] - ETA: 0s - loss: 0.1324 - accuracy: 0.8887 3/11 [=======>......................] - ETA: 0s - loss: 0.1330 - accuracy: 0.8954 4/11 [=========>....................] - ETA: 0s - loss: 0.1339 - accuracy: 0.8971 5/11 [============>.................] - ETA: 0s - loss: 0.1501 - accuracy: 0.8790 6/11 [===============>..............] - ETA: 0s - loss: 0.1679 - accuracy: 0.8579 7/11 [==================>...........] - ETA: 0s - loss: 0.1855 - accuracy: 0.8375 8/11 [====================>.........] - ETA: 0s - loss: 0.2014 - accuracy: 0.8184 9/11 [=======================>......] - ETA: 0s - loss: 0.2149 - accuracy: 0.801510/11 [==========================>...] - ETA: 0s - loss: 0.2269 - accuracy: 0.786011/11 [==============================] - ETA: 0s - loss: 0.2370 - accuracy: 0.772611/11 [==============================] - 1s 103ms/step - loss: 0.2454 - accuracy: 0.7615
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.3826 - accuracy: 0.49223/6 [==============>...............] - ETA: 0s - loss: 0.3984 - accuracy: 0.4948 5/6 [========================>.....] - ETA: 0s - loss: 0.4127 - accuracy: 0.45946/6 [==============================] - 4s 29ms/step - loss: 0.4180 - accuracy: 0.4533
2021-12-14 00:01:08.459409: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:01:08.460412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:01:08.460471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:01:08.460531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:01:08.460566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:01:08.460601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:01:08.460636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:01:08.460674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:01:08.460708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:01:08.460755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:01:08.462157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:01:08.462199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:01:08.462218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:01:08.462235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [0.00295734 0.05402493 0.9204241  0.03319231 0.01513538]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [0.00777435 0.12722147 0.8108491  0.03516293 0.01124969]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 4 0] pred: [0.00312641 0.05683941 0.9154068  0.03358668 0.01499811]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [0.00816143 0.14060256 0.8082161  0.03299126 0.01087487]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [0.00511849 0.08374739 0.8738156  0.03841478 0.01392722]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 4 0] pred: [0.00780407 0.12690768 0.80808425 0.03531221 0.01128483]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [0.00376323 0.06533518 0.9016784  0.03579673 0.01483923]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [0.00804296 0.1358273  0.8024636  0.03317568 0.01071522]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [0.00789887 0.12611398 0.8171195  0.03639442 0.01165071]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [0.00760251 0.11875737 0.8217095  0.03833646 0.01215488]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [0.00950718 0.1390371  0.7947128  0.03270423 0.01238284]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [0.00300664 0.05571067 0.91678107 0.03257388 0.01466811]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [0.00446182 0.07373109 0.8864573  0.03807345 0.01502022]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [0.00806218 0.13507006 0.80166537 0.03328684 0.01072916]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [0.00811633 0.13831559 0.80499613 0.03302076 0.01077515]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:02 - loss: 0.6936 - accuracy: 0.1094 2/11 [====>.........................] - ETA: 0s - loss: 0.6920 - accuracy: 0.1289   3/11 [=======>......................] - ETA: 0s - loss: 0.6904 - accuracy: 0.1710 4/11 [=========>....................] - ETA: 0s - loss: 0.6887 - accuracy: 0.2103 5/11 [============>.................] - ETA: 0s - loss: 0.6871 - accuracy: 0.2448 6/11 [===============>..............] - ETA: 0s - loss: 0.6854 - accuracy: 0.2700 7/11 [==================>...........] - ETA: 0s - loss: 0.6837 - accuracy: 0.2880 8/11 [====================>.........] - ETA: 0s - loss: 0.6820 - accuracy: 0.3020 9/11 [=======================>......] - ETA: 0s - loss: 0.6803 - accuracy: 0.313410/11 [==========================>...] - ETA: 0s - loss: 0.6786 - accuracy: 0.323111/11 [==============================] - ETA: 0s - loss: 0.6768 - accuracy: 0.331311/11 [==============================] - 13s 99ms/step - loss: 0.6754 - accuracy: 0.3382
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6039 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.6018 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 0s - loss: 0.5985 - accuracy: 0.4657 4/11 [=========>....................] - ETA: 0s - loss: 0.5948 - accuracy: 0.4621 5/11 [============>.................] - ETA: 0s - loss: 0.5911 - accuracy: 0.4609 6/11 [===============>..............] - ETA: 0s - loss: 0.5872 - accuracy: 0.4598 7/11 [==================>...........] - ETA: 0s - loss: 0.5833 - accuracy: 0.4597 8/11 [====================>.........] - ETA: 0s - loss: 0.5790 - accuracy: 0.4604 9/11 [=======================>......] - ETA: 0s - loss: 0.5749 - accuracy: 0.459410/11 [==========================>...] - ETA: 0s - loss: 0.5706 - accuracy: 0.458411/11 [==============================] - ETA: 0s - loss: 0.5663 - accuracy: 0.457511/11 [==============================] - 1s 102ms/step - loss: 0.5628 - accuracy: 0.4568
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4343 - accuracy: 0.3750 2/11 [====>.........................] - ETA: 0s - loss: 0.4231 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.4159 - accuracy: 0.4054 4/11 [=========>....................] - ETA: 0s - loss: 0.4129 - accuracy: 0.4085 5/11 [============>.................] - ETA: 0s - loss: 0.4106 - accuracy: 0.4099 6/11 [===============>..............] - ETA: 0s - loss: 0.4088 - accuracy: 0.4132 7/11 [==================>...........] - ETA: 0s - loss: 0.4074 - accuracy: 0.4154 8/11 [====================>.........] - ETA: 0s - loss: 0.4062 - accuracy: 0.4173 9/11 [=======================>......] - ETA: 0s - loss: 0.4056 - accuracy: 0.419110/11 [==========================>...] - ETA: 0s - loss: 0.4050 - accuracy: 0.421411/11 [==============================] - ETA: 0s - loss: 0.4043 - accuracy: 0.423911/11 [==============================] - 1s 100ms/step - loss: 0.4036 - accuracy: 0.4260
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4173 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.4122 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.4179 - accuracy: 0.4288 4/11 [=========>....................] - ETA: 0s - loss: 0.4188 - accuracy: 0.4251 5/11 [============>.................] - ETA: 0s - loss: 0.4171 - accuracy: 0.4251 6/11 [===============>..............] - ETA: 0s - loss: 0.4151 - accuracy: 0.4263 7/11 [==================>...........] - ETA: 0s - loss: 0.4130 - accuracy: 0.4279 8/11 [====================>.........] - ETA: 0s - loss: 0.4109 - accuracy: 0.4300 9/11 [=======================>......] - ETA: 0s - loss: 0.4090 - accuracy: 0.431810/11 [==========================>...] - ETA: 0s - loss: 0.4075 - accuracy: 0.433111/11 [==============================] - ETA: 0s - loss: 0.4062 - accuracy: 0.434511/11 [==============================] - 1s 103ms/step - loss: 0.4052 - accuracy: 0.4357
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3774 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.3781 - accuracy: 0.4805 3/11 [=======>......................] - ETA: 0s - loss: 0.3772 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 0s - loss: 0.3775 - accuracy: 0.4727 5/11 [============>.................] - ETA: 0s - loss: 0.3763 - accuracy: 0.4719 6/11 [===============>..............] - ETA: 0s - loss: 0.3762 - accuracy: 0.4692 7/11 [==================>...........] - ETA: 0s - loss: 0.3768 - accuracy: 0.4669 8/11 [====================>.........] - ETA: 0s - loss: 0.3781 - accuracy: 0.4637 9/11 [=======================>......] - ETA: 0s - loss: 0.3791 - accuracy: 0.461810/11 [==========================>...] - ETA: 0s - loss: 0.3803 - accuracy: 0.460011/11 [==============================] - ETA: 0s - loss: 0.3810 - accuracy: 0.459011/11 [==============================] - 1s 105ms/step - loss: 0.3817 - accuracy: 0.4582
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3853 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.3947 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 0s - loss: 0.3948 - accuracy: 0.4336 4/11 [=========>....................] - ETA: 0s - loss: 0.3943 - accuracy: 0.4302 5/11 [============>.................] - ETA: 0s - loss: 0.3938 - accuracy: 0.4276 6/11 [===============>..............] - ETA: 0s - loss: 0.3931 - accuracy: 0.4271 7/11 [==================>...........] - ETA: 0s - loss: 0.3922 - accuracy: 0.4284 8/11 [====================>.........] - ETA: 0s - loss: 0.3914 - accuracy: 0.4293 9/11 [=======================>......] - ETA: 0s - loss: 0.3905 - accuracy: 0.431610/11 [==========================>...] - ETA: 0s - loss: 0.3899 - accuracy: 0.433311/11 [==============================] - ETA: 0s - loss: 0.3896 - accuracy: 0.434711/11 [==============================] - 1s 100ms/step - loss: 0.3893 - accuracy: 0.4359
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3898 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.3874 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3873 - accuracy: 0.4462 4/11 [=========>....................] - ETA: 0s - loss: 0.3877 - accuracy: 0.4425 5/11 [============>.................] - ETA: 0s - loss: 0.3881 - accuracy: 0.4409 6/11 [===============>..............] - ETA: 0s - loss: 0.3883 - accuracy: 0.4397 7/11 [==================>...........] - ETA: 0s - loss: 0.3880 - accuracy: 0.4397 8/11 [====================>.........] - ETA: 0s - loss: 0.3878 - accuracy: 0.4395 9/11 [=======================>......] - ETA: 0s - loss: 0.3876 - accuracy: 0.440010/11 [==========================>...] - ETA: 0s - loss: 0.3872 - accuracy: 0.440611/11 [==============================] - ETA: 0s - loss: 0.3869 - accuracy: 0.441411/11 [==============================] - 1s 101ms/step - loss: 0.3865 - accuracy: 0.4420
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3721 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.3678 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.3680 - accuracy: 0.4470 4/11 [=========>....................] - ETA: 0s - loss: 0.3690 - accuracy: 0.4510 5/11 [============>.................] - ETA: 0s - loss: 0.3682 - accuracy: 0.4539 6/11 [===============>..............] - ETA: 0s - loss: 0.3693 - accuracy: 0.4551 7/11 [==================>...........] - ETA: 0s - loss: 0.3703 - accuracy: 0.4540 8/11 [====================>.........] - ETA: 0s - loss: 0.3714 - accuracy: 0.4535 9/11 [=======================>......] - ETA: 0s - loss: 0.3722 - accuracy: 0.453110/11 [==========================>...] - ETA: 0s - loss: 0.3729 - accuracy: 0.452411/11 [==============================] - ETA: 0s - loss: 0.3733 - accuracy: 0.452111/11 [==============================] - 1s 101ms/step - loss: 0.3736 - accuracy: 0.4518
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3690 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.3652 - accuracy: 0.4238 3/11 [=======>......................] - ETA: 0s - loss: 0.3615 - accuracy: 0.4397 4/11 [=========>....................] - ETA: 0s - loss: 0.3615 - accuracy: 0.4440 5/11 [============>.................] - ETA: 0s - loss: 0.3617 - accuracy: 0.4496 6/11 [===============>..............] - ETA: 0s - loss: 0.3620 - accuracy: 0.4528 7/11 [==================>...........] - ETA: 0s - loss: 0.3625 - accuracy: 0.4539 8/11 [====================>.........] - ETA: 0s - loss: 0.3628 - accuracy: 0.4545 9/11 [=======================>......] - ETA: 0s - loss: 0.3632 - accuracy: 0.454710/11 [==========================>...] - ETA: 0s - loss: 0.3637 - accuracy: 0.454311/11 [==============================] - ETA: 0s - loss: 0.3639 - accuracy: 0.453811/11 [==============================] - 1s 100ms/step - loss: 0.3641 - accuracy: 0.4534
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3442 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.3359 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 0s - loss: 0.3331 - accuracy: 0.4588 4/11 [=========>....................] - ETA: 0s - loss: 0.3333 - accuracy: 0.4652 5/11 [============>.................] - ETA: 0s - loss: 0.3342 - accuracy: 0.4681 6/11 [===============>..............] - ETA: 0s - loss: 0.3361 - accuracy: 0.4675 7/11 [==================>...........] - ETA: 0s - loss: 0.3377 - accuracy: 0.4658 8/11 [====================>.........] - ETA: 0s - loss: 0.3388 - accuracy: 0.4638 9/11 [=======================>......] - ETA: 0s - loss: 0.3398 - accuracy: 0.462310/11 [==========================>...] - ETA: 0s - loss: 0.3402 - accuracy: 0.461011/11 [==============================] - ETA: 0s - loss: 0.3406 - accuracy: 0.459911/11 [==============================] - 1s 99ms/step - loss: 0.3409 - accuracy: 0.4590
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3698 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.3541 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.3433 - accuracy: 0.4470 4/11 [=========>....................] - ETA: 0s - loss: 0.3360 - accuracy: 0.4549 5/11 [============>.................] - ETA: 0s - loss: 0.3307 - accuracy: 0.4617 6/11 [===============>..............] - ETA: 0s - loss: 0.3268 - accuracy: 0.4655 7/11 [==================>...........] - ETA: 0s - loss: 0.3238 - accuracy: 0.4676 8/11 [====================>.........] - ETA: 0s - loss: 0.3214 - accuracy: 0.4676 9/11 [=======================>......] - ETA: 0s - loss: 0.3202 - accuracy: 0.466510/11 [==========================>...] - ETA: 0s - loss: 0.3191 - accuracy: 0.464911/11 [==============================] - ETA: 0s - loss: 0.3181 - accuracy: 0.463411/11 [==============================] - 1s 103ms/step - loss: 0.3173 - accuracy: 0.4622
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3009 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.2985 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.2946 - accuracy: 0.4366 4/11 [=========>....................] - ETA: 0s - loss: 0.2910 - accuracy: 0.4471 5/11 [============>.................] - ETA: 0s - loss: 0.2889 - accuracy: 0.4514 6/11 [===============>..............] - ETA: 0s - loss: 0.2865 - accuracy: 0.4548 7/11 [==================>...........] - ETA: 0s - loss: 0.2852 - accuracy: 0.4563 8/11 [====================>.........] - ETA: 0s - loss: 0.2840 - accuracy: 0.4572 9/11 [=======================>......] - ETA: 0s - loss: 0.2828 - accuracy: 0.457710/11 [==========================>...] - ETA: 0s - loss: 0.2816 - accuracy: 0.458811/11 [==============================] - ETA: 0s - loss: 0.2804 - accuracy: 0.459811/11 [==============================] - 1s 105ms/step - loss: 0.2795 - accuracy: 0.4606
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2424 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.2463 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 0s - loss: 0.2441 - accuracy: 0.4770 4/11 [=========>....................] - ETA: 0s - loss: 0.2424 - accuracy: 0.4798 5/11 [============>.................] - ETA: 0s - loss: 0.2417 - accuracy: 0.4785 6/11 [===============>..............] - ETA: 0s - loss: 0.2413 - accuracy: 0.4776 7/11 [==================>...........] - ETA: 0s - loss: 0.2403 - accuracy: 0.4789 8/11 [====================>.........] - ETA: 0s - loss: 0.2394 - accuracy: 0.4797 9/11 [=======================>......] - ETA: 0s - loss: 0.2387 - accuracy: 0.481010/11 [==========================>...] - ETA: 0s - loss: 0.2383 - accuracy: 0.482011/11 [==============================] - ETA: 0s - loss: 0.2378 - accuracy: 0.483111/11 [==============================] - 1s 101ms/step - loss: 0.2374 - accuracy: 0.4840
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2222 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.2169 - accuracy: 0.4980 3/11 [=======>......................] - ETA: 0s - loss: 0.2137 - accuracy: 0.5195 4/11 [=========>....................] - ETA: 0s - loss: 0.2121 - accuracy: 0.5298 5/11 [============>.................] - ETA: 0s - loss: 0.2107 - accuracy: 0.5366 6/11 [===============>..............] - ETA: 0s - loss: 0.2099 - accuracy: 0.5401 7/11 [==================>...........] - ETA: 0s - loss: 0.2094 - accuracy: 0.5430 8/11 [====================>.........] - ETA: 0s - loss: 0.2091 - accuracy: 0.5452 9/11 [=======================>......] - ETA: 0s - loss: 0.2088 - accuracy: 0.546310/11 [==========================>...] - ETA: 0s - loss: 0.2086 - accuracy: 0.547411/11 [==============================] - ETA: 0s - loss: 0.2083 - accuracy: 0.548711/11 [==============================] - 1s 106ms/step - loss: 0.2080 - accuracy: 0.5497
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2072 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 0s - loss: 0.2069 - accuracy: 0.6133 3/11 [=======>......................] - ETA: 0s - loss: 0.2033 - accuracy: 0.6181 4/11 [=========>....................] - ETA: 0s - loss: 0.1999 - accuracy: 0.6193 5/11 [============>.................] - ETA: 0s - loss: 0.1975 - accuracy: 0.6154 6/11 [===============>..............] - ETA: 0s - loss: 0.1964 - accuracy: 0.6138 7/11 [==================>...........] - ETA: 0s - loss: 0.1952 - accuracy: 0.6127 8/11 [====================>.........] - ETA: 0s - loss: 0.1939 - accuracy: 0.6123 9/11 [=======================>......] - ETA: 0s - loss: 0.1927 - accuracy: 0.612610/11 [==========================>...] - ETA: 0s - loss: 0.1917 - accuracy: 0.612711/11 [==============================] - ETA: 0s - loss: 0.1910 - accuracy: 0.612811/11 [==============================] - 1s 103ms/step - loss: 0.1904 - accuracy: 0.6129
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1848 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 0s - loss: 0.1814 - accuracy: 0.6016 3/11 [=======>......................] - ETA: 0s - loss: 0.1806 - accuracy: 0.6059 4/11 [=========>....................] - ETA: 0s - loss: 0.1802 - accuracy: 0.6043 5/11 [============>.................] - ETA: 0s - loss: 0.1790 - accuracy: 0.6088 6/11 [===============>..............] - ETA: 0s - loss: 0.1780 - accuracy: 0.6132 7/11 [==================>...........] - ETA: 0s - loss: 0.1772 - accuracy: 0.6160 8/11 [====================>.........] - ETA: 0s - loss: 0.1761 - accuracy: 0.6202 9/11 [=======================>......] - ETA: 0s - loss: 0.1754 - accuracy: 0.623010/11 [==========================>...] - ETA: 0s - loss: 0.1748 - accuracy: 0.626011/11 [==============================] - ETA: 0s - loss: 0.1743 - accuracy: 0.628311/11 [==============================] - 1s 98ms/step - loss: 0.1739 - accuracy: 0.6301
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1805 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 0s - loss: 0.1765 - accuracy: 0.6738 3/11 [=======>......................] - ETA: 0s - loss: 0.1734 - accuracy: 0.6680 4/11 [=========>....................] - ETA: 0s - loss: 0.1706 - accuracy: 0.6685 5/11 [============>.................] - ETA: 0s - loss: 0.1693 - accuracy: 0.6698 6/11 [===============>..............] - ETA: 0s - loss: 0.1680 - accuracy: 0.6721 7/11 [==================>...........] - ETA: 0s - loss: 0.1669 - accuracy: 0.6751 8/11 [====================>.........] - ETA: 0s - loss: 0.1660 - accuracy: 0.6780 9/11 [=======================>......] - ETA: 0s - loss: 0.1654 - accuracy: 0.680710/11 [==========================>...] - ETA: 0s - loss: 0.1648 - accuracy: 0.683111/11 [==============================] - ETA: 0s - loss: 0.1643 - accuracy: 0.684811/11 [==============================] - 1s 102ms/step - loss: 0.1639 - accuracy: 0.6863
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1490 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.1510 - accuracy: 0.6445 3/11 [=======>......................] - ETA: 0s - loss: 0.1504 - accuracy: 0.6493 4/11 [=========>....................] - ETA: 0s - loss: 0.1502 - accuracy: 0.6506 5/11 [============>.................] - ETA: 0s - loss: 0.1495 - accuracy: 0.6526 6/11 [===============>..............] - ETA: 0s - loss: 0.1486 - accuracy: 0.6548 7/11 [==================>...........] - ETA: 0s - loss: 0.1485 - accuracy: 0.6535 8/11 [====================>.........] - ETA: 0s - loss: 0.1486 - accuracy: 0.6539 9/11 [=======================>......] - ETA: 0s - loss: 0.1489 - accuracy: 0.654010/11 [==========================>...] - ETA: 0s - loss: 0.1490 - accuracy: 0.655711/11 [==============================] - ETA: 0s - loss: 0.1490 - accuracy: 0.657911/11 [==============================] - 1s 100ms/step - loss: 0.1491 - accuracy: 0.6596
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1402 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 0s - loss: 0.1454 - accuracy: 0.7676 3/11 [=======>......................] - ETA: 0s - loss: 0.1452 - accuracy: 0.7765 4/11 [=========>....................] - ETA: 0s - loss: 0.1439 - accuracy: 0.7835 5/11 [============>.................] - ETA: 0s - loss: 0.1428 - accuracy: 0.7878 6/11 [===============>..............] - ETA: 0s - loss: 0.1420 - accuracy: 0.7882 7/11 [==================>...........] - ETA: 0s - loss: 0.1414 - accuracy: 0.7862 8/11 [====================>.........] - ETA: 0s - loss: 0.1412 - accuracy: 0.7849 9/11 [=======================>......] - ETA: 0s - loss: 0.1409 - accuracy: 0.782510/11 [==========================>...] - ETA: 0s - loss: 0.1409 - accuracy: 0.779011/11 [==============================] - ETA: 0s - loss: 0.1409 - accuracy: 0.776111/11 [==============================] - 1s 105ms/step - loss: 0.1409 - accuracy: 0.7738
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1290 - accuracy: 0.7109 2/11 [====>.........................] - ETA: 0s - loss: 0.1269 - accuracy: 0.7070 3/11 [=======>......................] - ETA: 0s - loss: 0.1267 - accuracy: 0.7075 4/11 [=========>....................] - ETA: 0s - loss: 0.1276 - accuracy: 0.7152 5/11 [============>.................] - ETA: 0s - loss: 0.1292 - accuracy: 0.7196 6/11 [===============>..............] - ETA: 0s - loss: 0.1303 - accuracy: 0.7234 7/11 [==================>...........] - ETA: 0s - loss: 0.1308 - accuracy: 0.7270 8/11 [====================>.........] - ETA: 0s - loss: 0.1312 - accuracy: 0.7297 9/11 [=======================>......] - ETA: 0s - loss: 0.1314 - accuracy: 0.731310/11 [==========================>...] - ETA: 0s - loss: 0.1316 - accuracy: 0.732411/11 [==============================] - ETA: 0s - loss: 0.1318 - accuracy: 0.733411/11 [==============================] - 1s 102ms/step - loss: 0.1318 - accuracy: 0.7341
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.1379 - accuracy: 0.76563/6 [==============>...............] - ETA: 0s - loss: 0.1334 - accuracy: 0.7734 5/6 [========================>.....] - ETA: 0s - loss: 0.1264 - accuracy: 0.79376/6 [==============================] - 4s 31ms/step - loss: 0.1261 - accuracy: 0.7946
2021-12-14 00:01:55.220591: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:01:55.221665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:01:55.221715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:01:55.221766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:01:55.221793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:01:55.221823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:01:55.221849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:01:55.221878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:01:55.221913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:01:55.221941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:01:55.223101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:01:55.223128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:01:55.223138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:01:55.223145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 2 0 1] pred: [0.03073439 0.02000195 0.09001717 0.7865593  0.18232217]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [0.00548038 0.73924375 0.874019   0.00558358 0.00383621]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 2 0 1] pred: [0.02480718 0.01582891 0.1194604  0.7342077  0.1583972 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [0 1 2 3 4] pred: [0.6002643  0.23620015 0.06686634 0.05789381 0.05608726]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [0.0071511  0.7611703  0.8622241  0.00511774 0.0037663 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 3 0] pred: [0.00251883 0.02611986 0.9569334  0.00994146 0.01251394]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [0 1 3 4 2] pred: [0.58984506 0.22859564 0.05982602 0.074875   0.06642511]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 3 0] pred: [0.00263798 0.02329439 0.95549405 0.01031727 0.01279256]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [0.00281322 0.09110838 0.9416485  0.00860447 0.00800407]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 4 3 0] pred: [0.00299454 0.03630793 0.94957733 0.00926605 0.01048079]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [0.00858399 0.80973494 0.8644868  0.00406516 0.00369999]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [0.00936881 0.8418856  0.86328965 0.00453812 0.00449479]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 3 0] pred: [0.00232041 0.03675735 0.9571855  0.00935376 0.01093394]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [0.09813789 0.6371633  0.3601823  0.01516345 0.01465005]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [0.01223809 0.7190659  0.82137036 0.00395152 0.00413397]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:56 - loss: 0.6901 - accuracy: 0.0469 2/11 [====>.........................] - ETA: 0s - loss: 0.6885 - accuracy: 0.1309   3/11 [=======>......................] - ETA: 0s - loss: 0.6871 - accuracy: 0.1836 4/11 [=========>....................] - ETA: 0s - loss: 0.6856 - accuracy: 0.2222 5/11 [============>.................] - ETA: 0s - loss: 0.6842 - accuracy: 0.2509 6/11 [===============>..............] - ETA: 0s - loss: 0.6827 - accuracy: 0.2744 7/11 [==================>...........] - ETA: 0s - loss: 0.6812 - accuracy: 0.2926 8/11 [====================>.........] - ETA: 0s - loss: 0.6798 - accuracy: 0.3076 9/11 [=======================>......] - ETA: 0s - loss: 0.6784 - accuracy: 0.319510/11 [==========================>...] - ETA: 0s - loss: 0.6769 - accuracy: 0.329211/11 [==============================] - ETA: 0s - loss: 0.6755 - accuracy: 0.337111/11 [==============================] - 13s 106ms/step - loss: 0.6744 - accuracy: 0.3437
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6231 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.6208 - accuracy: 0.4199 3/11 [=======>......................] - ETA: 0s - loss: 0.6179 - accuracy: 0.4266 4/11 [=========>....................] - ETA: 0s - loss: 0.6151 - accuracy: 0.4299 5/11 [============>.................] - ETA: 0s - loss: 0.6118 - accuracy: 0.4358 6/11 [===============>..............] - ETA: 0s - loss: 0.6083 - accuracy: 0.4413 7/11 [==================>...........] - ETA: 0s - loss: 0.6051 - accuracy: 0.4441 8/11 [====================>.........] - ETA: 0s - loss: 0.6018 - accuracy: 0.4464 9/11 [=======================>......] - ETA: 0s - loss: 0.5986 - accuracy: 0.447310/11 [==========================>...] - ETA: 0s - loss: 0.5954 - accuracy: 0.447611/11 [==============================] - ETA: 0s - loss: 0.5923 - accuracy: 0.447911/11 [==============================] - 1s 99ms/step - loss: 0.5897 - accuracy: 0.4482
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4632 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.4617 - accuracy: 0.4121 3/11 [=======>......................] - ETA: 0s - loss: 0.4589 - accuracy: 0.4180 4/11 [=========>....................] - ETA: 0s - loss: 0.4555 - accuracy: 0.4253 5/11 [============>.................] - ETA: 0s - loss: 0.4521 - accuracy: 0.4309 6/11 [===============>..............] - ETA: 0s - loss: 0.4487 - accuracy: 0.4361 7/11 [==================>...........] - ETA: 0s - loss: 0.4457 - accuracy: 0.4388 8/11 [====================>.........] - ETA: 0s - loss: 0.4433 - accuracy: 0.4406 9/11 [=======================>......] - ETA: 0s - loss: 0.4410 - accuracy: 0.442110/11 [==========================>...] - ETA: 0s - loss: 0.4392 - accuracy: 0.443011/11 [==============================] - ETA: 0s - loss: 0.4374 - accuracy: 0.443711/11 [==============================] - 1s 106ms/step - loss: 0.4359 - accuracy: 0.4443
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4011 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.3969 - accuracy: 0.4180 3/11 [=======>......................] - ETA: 0s - loss: 0.3934 - accuracy: 0.4210 4/11 [=========>....................] - ETA: 0s - loss: 0.3900 - accuracy: 0.4285 5/11 [============>.................] - ETA: 0s - loss: 0.3891 - accuracy: 0.4322 6/11 [===============>..............] - ETA: 0s - loss: 0.3884 - accuracy: 0.4346 7/11 [==================>...........] - ETA: 0s - loss: 0.3872 - accuracy: 0.4373 8/11 [====================>.........] - ETA: 0s - loss: 0.3860 - accuracy: 0.4395 9/11 [=======================>......] - ETA: 0s - loss: 0.3849 - accuracy: 0.440810/11 [==========================>...] - ETA: 0s - loss: 0.3837 - accuracy: 0.442011/11 [==============================] - ETA: 0s - loss: 0.3828 - accuracy: 0.442911/11 [==============================] - 1s 103ms/step - loss: 0.3820 - accuracy: 0.4435
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3616 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.3662 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 0s - loss: 0.3633 - accuracy: 0.4796 4/11 [=========>....................] - ETA: 0s - loss: 0.3597 - accuracy: 0.4803 5/11 [============>.................] - ETA: 0s - loss: 0.3575 - accuracy: 0.4789 6/11 [===============>..............] - ETA: 0s - loss: 0.3557 - accuracy: 0.4772 7/11 [==================>...........] - ETA: 0s - loss: 0.3550 - accuracy: 0.4747 8/11 [====================>.........] - ETA: 0s - loss: 0.3544 - accuracy: 0.4730 9/11 [=======================>......] - ETA: 0s - loss: 0.3537 - accuracy: 0.471510/11 [==========================>...] - ETA: 0s - loss: 0.3534 - accuracy: 0.469311/11 [==============================] - ETA: 0s - loss: 0.3532 - accuracy: 0.467611/11 [==============================] - 1s 110ms/step - loss: 0.3530 - accuracy: 0.4662
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3494 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.3504 - accuracy: 0.4160 3/11 [=======>......................] - ETA: 0s - loss: 0.3491 - accuracy: 0.4171 4/11 [=========>....................] - ETA: 0s - loss: 0.3483 - accuracy: 0.4173 5/11 [============>.................] - ETA: 0s - loss: 0.3477 - accuracy: 0.4192 6/11 [===============>..............] - ETA: 0s - loss: 0.3456 - accuracy: 0.4240 7/11 [==================>...........] - ETA: 0s - loss: 0.3438 - accuracy: 0.4281 8/11 [====================>.........] - ETA: 0s - loss: 0.3422 - accuracy: 0.4312 9/11 [=======================>......] - ETA: 0s - loss: 0.3408 - accuracy: 0.432710/11 [==========================>...] - ETA: 0s - loss: 0.3396 - accuracy: 0.434411/11 [==============================] - ETA: 0s - loss: 0.3385 - accuracy: 0.435911/11 [==============================] - 1s 103ms/step - loss: 0.3376 - accuracy: 0.4371
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3040 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.3062 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.3102 - accuracy: 0.4870 4/11 [=========>....................] - ETA: 0s - loss: 0.3119 - accuracy: 0.4785 5/11 [============>.................] - ETA: 0s - loss: 0.3116 - accuracy: 0.4747 6/11 [===============>..............] - ETA: 0s - loss: 0.3105 - accuracy: 0.4735 7/11 [==================>...........] - ETA: 0s - loss: 0.3100 - accuracy: 0.4715 8/11 [====================>.........] - ETA: 0s - loss: 0.3098 - accuracy: 0.4696 9/11 [=======================>......] - ETA: 0s - loss: 0.3093 - accuracy: 0.468310/11 [==========================>...] - ETA: 0s - loss: 0.3089 - accuracy: 0.467111/11 [==============================] - ETA: 0s - loss: 0.3084 - accuracy: 0.465811/11 [==============================] - 1s 104ms/step - loss: 0.3081 - accuracy: 0.4647
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2831 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.2873 - accuracy: 0.4512 3/11 [=======>......................] - ETA: 0s - loss: 0.2879 - accuracy: 0.4484 4/11 [=========>....................] - ETA: 0s - loss: 0.2893 - accuracy: 0.4437 5/11 [============>.................] - ETA: 0s - loss: 0.2896 - accuracy: 0.4418 6/11 [===============>..............] - ETA: 0s - loss: 0.2894 - accuracy: 0.4411 7/11 [==================>...........] - ETA: 0s - loss: 0.2889 - accuracy: 0.4409 8/11 [====================>.........] - ETA: 0s - loss: 0.2885 - accuracy: 0.4411 9/11 [=======================>......] - ETA: 0s - loss: 0.2880 - accuracy: 0.441810/11 [==========================>...] - ETA: 0s - loss: 0.2874 - accuracy: 0.442711/11 [==============================] - ETA: 0s - loss: 0.2867 - accuracy: 0.443511/11 [==============================] - 1s 104ms/step - loss: 0.2861 - accuracy: 0.4441
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2731 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.2685 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.2688 - accuracy: 0.4323 4/11 [=========>....................] - ETA: 0s - loss: 0.2667 - accuracy: 0.4404 5/11 [============>.................] - ETA: 0s - loss: 0.2657 - accuracy: 0.4461 6/11 [===============>..............] - ETA: 0s - loss: 0.2642 - accuracy: 0.4507 7/11 [==================>...........] - ETA: 0s - loss: 0.2628 - accuracy: 0.4541 8/11 [====================>.........] - ETA: 0s - loss: 0.2621 - accuracy: 0.4565 9/11 [=======================>......] - ETA: 0s - loss: 0.2615 - accuracy: 0.458110/11 [==========================>...] - ETA: 0s - loss: 0.2612 - accuracy: 0.459511/11 [==============================] - ETA: 0s - loss: 0.2609 - accuracy: 0.460011/11 [==============================] - 1s 103ms/step - loss: 0.2606 - accuracy: 0.4604
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2800 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.2643 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 0s - loss: 0.2581 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.2543 - accuracy: 0.4663 5/11 [============>.................] - ETA: 0s - loss: 0.2520 - accuracy: 0.4762 6/11 [===============>..............] - ETA: 0s - loss: 0.2503 - accuracy: 0.4825 7/11 [==================>...........] - ETA: 0s - loss: 0.2491 - accuracy: 0.4877 8/11 [====================>.........] - ETA: 0s - loss: 0.2481 - accuracy: 0.4917 9/11 [=======================>......] - ETA: 0s - loss: 0.2471 - accuracy: 0.495010/11 [==========================>...] - ETA: 0s - loss: 0.2461 - accuracy: 0.498711/11 [==============================] - ETA: 0s - loss: 0.2453 - accuracy: 0.501811/11 [==============================] - 1s 103ms/step - loss: 0.2446 - accuracy: 0.5045
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2104 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 0s - loss: 0.2145 - accuracy: 0.5449 3/11 [=======>......................] - ETA: 0s - loss: 0.2152 - accuracy: 0.5482 4/11 [=========>....................] - ETA: 0s - loss: 0.2161 - accuracy: 0.5498 5/11 [============>.................] - ETA: 0s - loss: 0.2170 - accuracy: 0.5492 6/11 [===============>..............] - ETA: 0s - loss: 0.2170 - accuracy: 0.5514 7/11 [==================>...........] - ETA: 0s - loss: 0.2170 - accuracy: 0.5524 8/11 [====================>.........] - ETA: 0s - loss: 0.2171 - accuracy: 0.5538 9/11 [=======================>......] - ETA: 0s - loss: 0.2169 - accuracy: 0.554310/11 [==========================>...] - ETA: 0s - loss: 0.2166 - accuracy: 0.555011/11 [==============================] - ETA: 0s - loss: 0.2164 - accuracy: 0.555311/11 [==============================] - 1s 105ms/step - loss: 0.2162 - accuracy: 0.5556
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1815 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 0s - loss: 0.1865 - accuracy: 0.5762 3/11 [=======>......................] - ETA: 0s - loss: 0.1875 - accuracy: 0.5734 4/11 [=========>....................] - ETA: 0s - loss: 0.1902 - accuracy: 0.5701 5/11 [============>.................] - ETA: 0s - loss: 0.1912 - accuracy: 0.5717 6/11 [===============>..............] - ETA: 0s - loss: 0.1916 - accuracy: 0.5735 7/11 [==================>...........] - ETA: 0s - loss: 0.1918 - accuracy: 0.5749 8/11 [====================>.........] - ETA: 0s - loss: 0.1918 - accuracy: 0.5767 9/11 [=======================>......] - ETA: 0s - loss: 0.1921 - accuracy: 0.576810/11 [==========================>...] - ETA: 0s - loss: 0.1921 - accuracy: 0.578011/11 [==============================] - ETA: 0s - loss: 0.1922 - accuracy: 0.578311/11 [==============================] - 1s 104ms/step - loss: 0.1922 - accuracy: 0.5785
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1920 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.1918 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.1892 - accuracy: 0.5165 4/11 [=========>....................] - ETA: 0s - loss: 0.1872 - accuracy: 0.5368 5/11 [============>.................] - ETA: 0s - loss: 0.1864 - accuracy: 0.5501 6/11 [===============>..............] - ETA: 0s - loss: 0.1860 - accuracy: 0.5586 7/11 [==================>...........] - ETA: 0s - loss: 0.1852 - accuracy: 0.5654 8/11 [====================>.........] - ETA: 0s - loss: 0.1844 - accuracy: 0.5716 9/11 [=======================>......] - ETA: 0s - loss: 0.1836 - accuracy: 0.578410/11 [==========================>...] - ETA: 0s - loss: 0.1829 - accuracy: 0.584411/11 [==============================] - ETA: 0s - loss: 0.1823 - accuracy: 0.590011/11 [==============================] - 1s 110ms/step - loss: 0.1819 - accuracy: 0.5946
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1557 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 0s - loss: 0.1598 - accuracy: 0.7637 3/11 [=======>......................] - ETA: 0s - loss: 0.1641 - accuracy: 0.7452 4/11 [=========>....................] - ETA: 0s - loss: 0.1647 - accuracy: 0.7386 5/11 [============>.................] - ETA: 0s - loss: 0.1648 - accuracy: 0.7343 6/11 [===============>..............] - ETA: 0s - loss: 0.1651 - accuracy: 0.7317 7/11 [==================>...........] - ETA: 0s - loss: 0.1648 - accuracy: 0.7296 8/11 [====================>.........] - ETA: 0s - loss: 0.1648 - accuracy: 0.7267 9/11 [=======================>......] - ETA: 0s - loss: 0.1646 - accuracy: 0.723910/11 [==========================>...] - ETA: 0s - loss: 0.1645 - accuracy: 0.721911/11 [==============================] - ETA: 0s - loss: 0.1643 - accuracy: 0.720411/11 [==============================] - 1s 103ms/step - loss: 0.1641 - accuracy: 0.7192
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1650 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 0s - loss: 0.1614 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 0s - loss: 0.1596 - accuracy: 0.7934 4/11 [=========>....................] - ETA: 0s - loss: 0.1582 - accuracy: 0.7918 5/11 [============>.................] - ETA: 0s - loss: 0.1573 - accuracy: 0.7903 6/11 [===============>..............] - ETA: 0s - loss: 0.1564 - accuracy: 0.7884 7/11 [==================>...........] - ETA: 0s - loss: 0.1557 - accuracy: 0.7853 8/11 [====================>.........] - ETA: 0s - loss: 0.1551 - accuracy: 0.7814 9/11 [=======================>......] - ETA: 0s - loss: 0.1547 - accuracy: 0.778510/11 [==========================>...] - ETA: 0s - loss: 0.1543 - accuracy: 0.776211/11 [==============================] - ETA: 0s - loss: 0.1541 - accuracy: 0.774611/11 [==============================] - 1s 101ms/step - loss: 0.1540 - accuracy: 0.7733
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1401 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 0s - loss: 0.1396 - accuracy: 0.8691 3/11 [=======>......................] - ETA: 0s - loss: 0.1404 - accuracy: 0.8685 4/11 [=========>....................] - ETA: 0s - loss: 0.1403 - accuracy: 0.8633 5/11 [============>.................] - ETA: 0s - loss: 0.1396 - accuracy: 0.8594 6/11 [===============>..............] - ETA: 0s - loss: 0.1391 - accuracy: 0.8542 7/11 [==================>...........] - ETA: 0s - loss: 0.1386 - accuracy: 0.8500 8/11 [====================>.........] - ETA: 0s - loss: 0.1383 - accuracy: 0.8450 9/11 [=======================>......] - ETA: 0s - loss: 0.1384 - accuracy: 0.840610/11 [==========================>...] - ETA: 0s - loss: 0.1386 - accuracy: 0.836611/11 [==============================] - ETA: 0s - loss: 0.1388 - accuracy: 0.833611/11 [==============================] - 1s 104ms/step - loss: 0.1390 - accuracy: 0.8310
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1352 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 1s - loss: 0.1391 - accuracy: 0.8184 3/11 [=======>......................] - ETA: 0s - loss: 0.1391 - accuracy: 0.8173 4/11 [=========>....................] - ETA: 0s - loss: 0.1396 - accuracy: 0.8112 5/11 [============>.................] - ETA: 0s - loss: 0.1397 - accuracy: 0.8086 6/11 [===============>..............] - ETA: 0s - loss: 0.1394 - accuracy: 0.8084 7/11 [==================>...........] - ETA: 0s - loss: 0.1389 - accuracy: 0.8092 8/11 [====================>.........] - ETA: 0s - loss: 0.1386 - accuracy: 0.8112 9/11 [=======================>......] - ETA: 0s - loss: 0.1383 - accuracy: 0.813010/11 [==========================>...] - ETA: 0s - loss: 0.1379 - accuracy: 0.815111/11 [==============================] - ETA: 0s - loss: 0.1375 - accuracy: 0.817011/11 [==============================] - 1s 104ms/step - loss: 0.1372 - accuracy: 0.8185
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1217 - accuracy: 0.7891 2/11 [====>.........................] - ETA: 0s - loss: 0.1217 - accuracy: 0.7988 3/11 [=======>......................] - ETA: 0s - loss: 0.1239 - accuracy: 0.8051 4/11 [=========>....................] - ETA: 0s - loss: 0.1247 - accuracy: 0.8104 5/11 [============>.................] - ETA: 0s - loss: 0.1256 - accuracy: 0.8149 6/11 [===============>..............] - ETA: 0s - loss: 0.1260 - accuracy: 0.8197 7/11 [==================>...........] - ETA: 0s - loss: 0.1260 - accuracy: 0.8244 8/11 [====================>.........] - ETA: 0s - loss: 0.1258 - accuracy: 0.8285 9/11 [=======================>......] - ETA: 0s - loss: 0.1255 - accuracy: 0.832410/11 [==========================>...] - ETA: 0s - loss: 0.1256 - accuracy: 0.834211/11 [==============================] - ETA: 0s - loss: 0.1257 - accuracy: 0.835711/11 [==============================] - 1s 103ms/step - loss: 0.1258 - accuracy: 0.8370
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1169 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 0s - loss: 0.1176 - accuracy: 0.8691 3/11 [=======>......................] - ETA: 0s - loss: 0.1184 - accuracy: 0.8676 4/11 [=========>....................] - ETA: 0s - loss: 0.1188 - accuracy: 0.8695 5/11 [============>.................] - ETA: 0s - loss: 0.1184 - accuracy: 0.8699 6/11 [===============>..............] - ETA: 0s - loss: 0.1182 - accuracy: 0.8695 7/11 [==================>...........] - ETA: 0s - loss: 0.1182 - accuracy: 0.8682 8/11 [====================>.........] - ETA: 0s - loss: 0.1182 - accuracy: 0.8672 9/11 [=======================>......] - ETA: 0s - loss: 0.1182 - accuracy: 0.866410/11 [==========================>...] - ETA: 0s - loss: 0.1184 - accuracy: 0.866011/11 [==============================] - ETA: 0s - loss: 0.1186 - accuracy: 0.865911/11 [==============================] - 1s 104ms/step - loss: 0.1187 - accuracy: 0.8658
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1174 - accuracy: 0.8828 2/11 [====>.........................] - ETA: 1s - loss: 0.1187 - accuracy: 0.8867 3/11 [=======>......................] - ETA: 0s - loss: 0.1185 - accuracy: 0.8863 4/11 [=========>....................] - ETA: 0s - loss: 0.1186 - accuracy: 0.8883 5/11 [============>.................] - ETA: 0s - loss: 0.1186 - accuracy: 0.8885 6/11 [===============>..............] - ETA: 0s - loss: 0.1182 - accuracy: 0.8886 7/11 [==================>...........] - ETA: 0s - loss: 0.1179 - accuracy: 0.8889 8/11 [====================>.........] - ETA: 0s - loss: 0.1178 - accuracy: 0.8882 9/11 [=======================>......] - ETA: 0s - loss: 0.1177 - accuracy: 0.886910/11 [==========================>...] - ETA: 0s - loss: 0.1173 - accuracy: 0.886011/11 [==============================] - ETA: 0s - loss: 0.1172 - accuracy: 0.885211/11 [==============================] - 1s 104ms/step - loss: 0.1170 - accuracy: 0.8845
Evaluate on test data
1/6 [====>.........................] - ETA: 17s - loss: 0.1279 - accuracy: 0.84383/6 [==============>...............] - ETA: 0s - loss: 0.1184 - accuracy: 0.8906 5/6 [========================>.....] - ETA: 0s - loss: 0.1243 - accuracy: 0.87816/6 [==============================] - 4s 29ms/step - loss: 0.1231 - accuracy: 0.8782
2021-12-14 00:02:42.768898: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:02:42.769873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:02:42.769931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:02:42.769983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:02:42.770019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:02:42.770053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:02:42.770086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:02:42.770119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:02:42.770153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:02:42.770192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:02:42.771594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:02:42.771628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:02:42.771640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:02:42.771650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 4 3] pred: [0.09417054 0.7447695  0.24472356 0.0039871  0.01579678]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [9.4863772e-04 3.1253427e-02 9.8548663e-01 2.0926893e-03 1.3378263e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 4 0] pred: [9.5832348e-04 3.1250805e-02 9.8495698e-01 2.1360219e-03 1.3337731e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [5.8817863e-04 3.2376081e-02 9.8550344e-01 4.5977235e-03 2.4719238e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [0.01432765 0.7185564  0.68333757 0.01079008 0.0023118 ]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.015185   0.8585677  0.7846426  0.00460467 0.00187227]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 0 2 1] pred: [0.16814673 0.0108265  0.05007887 0.4913827  0.46158725]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [0.02146745 0.86229765 0.70892924 0.00492859 0.00204962]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [0.00288168 0.28508216 0.9459449  0.00451678 0.00095254]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [0.0010688  0.03854245 0.98363924 0.00207192 0.0013099 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [0.00130221 0.05793506 0.97964394 0.00216186 0.00161701]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [5.7083368e-04 3.1938940e-02 9.8470002e-01 5.3116679e-03 2.7939677e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 4 3] pred: [0.02449405 0.924842   0.68336964 0.00466716 0.00516182]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [0.00199455 0.12544414 0.9512137  0.0017553  0.00116667]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 4 3] pred: [0.01487306 0.81371856 0.6343711  0.00241581 0.00376612]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:56 - loss: 0.6870 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.6854 - accuracy: 0.5234   3/11 [=======>......................] - ETA: 0s - loss: 0.6837 - accuracy: 0.5095 4/11 [=========>....................] - ETA: 0s - loss: 0.6819 - accuracy: 0.4979 5/11 [============>.................] - ETA: 0s - loss: 0.6802 - accuracy: 0.4936 6/11 [===============>..............] - ETA: 0s - loss: 0.6784 - accuracy: 0.4901 7/11 [==================>...........] - ETA: 0s - loss: 0.6766 - accuracy: 0.4877 8/11 [====================>.........] - ETA: 0s - loss: 0.6747 - accuracy: 0.4862 9/11 [=======================>......] - ETA: 0s - loss: 0.6727 - accuracy: 0.484010/11 [==========================>...] - ETA: 0s - loss: 0.6708 - accuracy: 0.482111/11 [==============================] - ETA: 0s - loss: 0.6689 - accuracy: 0.480211/11 [==============================] - 13s 109ms/step - loss: 0.6674 - accuracy: 0.4787
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5894 - accuracy: 0.3828 2/11 [====>.........................] - ETA: 0s - loss: 0.5832 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.5790 - accuracy: 0.4097 4/11 [=========>....................] - ETA: 0s - loss: 0.5742 - accuracy: 0.4162 5/11 [============>.................] - ETA: 0s - loss: 0.5694 - accuracy: 0.4214 6/11 [===============>..............] - ETA: 0s - loss: 0.5646 - accuracy: 0.4245 7/11 [==================>...........] - ETA: 0s - loss: 0.5594 - accuracy: 0.4284 8/11 [====================>.........] - ETA: 0s - loss: 0.5542 - accuracy: 0.4309 9/11 [=======================>......] - ETA: 0s - loss: 0.5491 - accuracy: 0.434110/11 [==========================>...] - ETA: 0s - loss: 0.5439 - accuracy: 0.436111/11 [==============================] - ETA: 0s - loss: 0.5393 - accuracy: 0.437711/11 [==============================] - 1s 102ms/step - loss: 0.5355 - accuracy: 0.4391
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3770 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.3838 - accuracy: 0.4883 3/11 [=======>......................] - ETA: 0s - loss: 0.3860 - accuracy: 0.4826 4/11 [=========>....................] - ETA: 0s - loss: 0.3860 - accuracy: 0.4801 5/11 [============>.................] - ETA: 0s - loss: 0.3881 - accuracy: 0.4757 6/11 [===============>..............] - ETA: 0s - loss: 0.3873 - accuracy: 0.4750 7/11 [==================>...........] - ETA: 0s - loss: 0.3873 - accuracy: 0.4728 8/11 [====================>.........] - ETA: 0s - loss: 0.3871 - accuracy: 0.4703 9/11 [=======================>......] - ETA: 0s - loss: 0.3868 - accuracy: 0.468610/11 [==========================>...] - ETA: 0s - loss: 0.3869 - accuracy: 0.466911/11 [==============================] - ETA: 0s - loss: 0.3869 - accuracy: 0.465711/11 [==============================] - 1s 111ms/step - loss: 0.3869 - accuracy: 0.4648
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3906 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.3845 - accuracy: 0.4395 3/11 [=======>......................] - ETA: 0s - loss: 0.3804 - accuracy: 0.4484 4/11 [=========>....................] - ETA: 0s - loss: 0.3791 - accuracy: 0.4525 5/11 [============>.................] - ETA: 0s - loss: 0.3795 - accuracy: 0.4539 6/11 [===============>..............] - ETA: 0s - loss: 0.3793 - accuracy: 0.4557 7/11 [==================>...........] - ETA: 0s - loss: 0.3795 - accuracy: 0.4553 8/11 [====================>.........] - ETA: 0s - loss: 0.3790 - accuracy: 0.4564 9/11 [=======================>......] - ETA: 0s - loss: 0.3789 - accuracy: 0.456710/11 [==========================>...] - ETA: 0s - loss: 0.3790 - accuracy: 0.456611/11 [==============================] - ETA: 0s - loss: 0.3790 - accuracy: 0.456311/11 [==============================] - 1s 107ms/step - loss: 0.3790 - accuracy: 0.4561
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3891 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 1s - loss: 0.3871 - accuracy: 0.4238 3/11 [=======>......................] - ETA: 0s - loss: 0.3854 - accuracy: 0.4319 4/11 [=========>....................] - ETA: 0s - loss: 0.3828 - accuracy: 0.4362 5/11 [============>.................] - ETA: 0s - loss: 0.3795 - accuracy: 0.4408 6/11 [===============>..............] - ETA: 0s - loss: 0.3775 - accuracy: 0.4440 7/11 [==================>...........] - ETA: 0s - loss: 0.3763 - accuracy: 0.4454 8/11 [====================>.........] - ETA: 0s - loss: 0.3755 - accuracy: 0.4464 9/11 [=======================>......] - ETA: 0s - loss: 0.3748 - accuracy: 0.447010/11 [==========================>...] - ETA: 0s - loss: 0.3743 - accuracy: 0.447711/11 [==============================] - ETA: 0s - loss: 0.3740 - accuracy: 0.448311/11 [==============================] - 1s 108ms/step - loss: 0.3737 - accuracy: 0.4488
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3670 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.3619 - accuracy: 0.4395 3/11 [=======>......................] - ETA: 0s - loss: 0.3602 - accuracy: 0.4475 4/11 [=========>....................] - ETA: 0s - loss: 0.3605 - accuracy: 0.4479 5/11 [============>.................] - ETA: 0s - loss: 0.3609 - accuracy: 0.4496 6/11 [===============>..............] - ETA: 0s - loss: 0.3608 - accuracy: 0.4497 7/11 [==================>...........] - ETA: 0s - loss: 0.3605 - accuracy: 0.4502 8/11 [====================>.........] - ETA: 0s - loss: 0.3596 - accuracy: 0.4523 9/11 [=======================>......] - ETA: 0s - loss: 0.3592 - accuracy: 0.452910/11 [==========================>...] - ETA: 0s - loss: 0.3591 - accuracy: 0.453011/11 [==============================] - ETA: 0s - loss: 0.3589 - accuracy: 0.453111/11 [==============================] - 1s 107ms/step - loss: 0.3588 - accuracy: 0.4531
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3497 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.3414 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 0s - loss: 0.3451 - accuracy: 0.4744 4/11 [=========>....................] - ETA: 0s - loss: 0.3454 - accuracy: 0.4730 5/11 [============>.................] - ETA: 0s - loss: 0.3451 - accuracy: 0.4703 6/11 [===============>..............] - ETA: 0s - loss: 0.3458 - accuracy: 0.4665 7/11 [==================>...........] - ETA: 0s - loss: 0.3460 - accuracy: 0.4641 8/11 [====================>.........] - ETA: 0s - loss: 0.3464 - accuracy: 0.4619 9/11 [=======================>......] - ETA: 0s - loss: 0.3461 - accuracy: 0.460910/11 [==========================>...] - ETA: 0s - loss: 0.3453 - accuracy: 0.460611/11 [==============================] - ETA: 0s - loss: 0.3448 - accuracy: 0.460011/11 [==============================] - 1s 104ms/step - loss: 0.3443 - accuracy: 0.4595
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3265 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.3293 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.3263 - accuracy: 0.4644 4/11 [=========>....................] - ETA: 0s - loss: 0.3248 - accuracy: 0.4645 5/11 [============>.................] - ETA: 0s - loss: 0.3229 - accuracy: 0.4666 6/11 [===============>..............] - ETA: 0s - loss: 0.3228 - accuracy: 0.4663 7/11 [==================>...........] - ETA: 0s - loss: 0.3225 - accuracy: 0.4668 8/11 [====================>.........] - ETA: 0s - loss: 0.3224 - accuracy: 0.4663 9/11 [=======================>......] - ETA: 0s - loss: 0.3223 - accuracy: 0.465510/11 [==========================>...] - ETA: 0s - loss: 0.3218 - accuracy: 0.465511/11 [==============================] - ETA: 0s - loss: 0.3213 - accuracy: 0.465611/11 [==============================] - 1s 106ms/step - loss: 0.3209 - accuracy: 0.4656
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2853 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.2806 - accuracy: 0.5215 3/11 [=======>......................] - ETA: 0s - loss: 0.2825 - accuracy: 0.5169 4/11 [=========>....................] - ETA: 0s - loss: 0.2827 - accuracy: 0.5142 5/11 [============>.................] - ETA: 0s - loss: 0.2834 - accuracy: 0.5104 6/11 [===============>..............] - ETA: 0s - loss: 0.2847 - accuracy: 0.5067 7/11 [==================>...........] - ETA: 0s - loss: 0.2854 - accuracy: 0.5034 8/11 [====================>.........] - ETA: 0s - loss: 0.2862 - accuracy: 0.5003 9/11 [=======================>......] - ETA: 0s - loss: 0.2868 - accuracy: 0.496910/11 [==========================>...] - ETA: 0s - loss: 0.2868 - accuracy: 0.494811/11 [==============================] - ETA: 0s - loss: 0.2867 - accuracy: 0.493211/11 [==============================] - 1s 105ms/step - loss: 0.2867 - accuracy: 0.4919
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2906 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.2848 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 0s - loss: 0.2837 - accuracy: 0.4674 4/11 [=========>....................] - ETA: 0s - loss: 0.2812 - accuracy: 0.4653 5/11 [============>.................] - ETA: 0s - loss: 0.2777 - accuracy: 0.4660 6/11 [===============>..............] - ETA: 0s - loss: 0.2759 - accuracy: 0.4665 7/11 [==================>...........] - ETA: 0s - loss: 0.2741 - accuracy: 0.4662 8/11 [====================>.........] - ETA: 0s - loss: 0.2721 - accuracy: 0.4672 9/11 [=======================>......] - ETA: 0s - loss: 0.2706 - accuracy: 0.468710/11 [==========================>...] - ETA: 0s - loss: 0.2692 - accuracy: 0.470011/11 [==============================] - ETA: 0s - loss: 0.2679 - accuracy: 0.471111/11 [==============================] - 1s 105ms/step - loss: 0.2668 - accuracy: 0.4719
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2610 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.2571 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.2518 - accuracy: 0.4661 4/11 [=========>....................] - ETA: 0s - loss: 0.2476 - accuracy: 0.4683 5/11 [============>.................] - ETA: 0s - loss: 0.2446 - accuracy: 0.4702 6/11 [===============>..............] - ETA: 0s - loss: 0.2419 - accuracy: 0.4743 7/11 [==================>...........] - ETA: 0s - loss: 0.2404 - accuracy: 0.4754 8/11 [====================>.........] - ETA: 0s - loss: 0.2388 - accuracy: 0.4761 9/11 [=======================>......] - ETA: 0s - loss: 0.2375 - accuracy: 0.476510/11 [==========================>...] - ETA: 0s - loss: 0.2366 - accuracy: 0.477011/11 [==============================] - ETA: 0s - loss: 0.2356 - accuracy: 0.477711/11 [==============================] - 1s 101ms/step - loss: 0.2349 - accuracy: 0.4783
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2116 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.2143 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.2141 - accuracy: 0.4714 4/11 [=========>....................] - ETA: 0s - loss: 0.2154 - accuracy: 0.4771 5/11 [============>.................] - ETA: 0s - loss: 0.2157 - accuracy: 0.4807 6/11 [===============>..............] - ETA: 0s - loss: 0.2155 - accuracy: 0.4833 7/11 [==================>...........] - ETA: 0s - loss: 0.2153 - accuracy: 0.4871 8/11 [====================>.........] - ETA: 0s - loss: 0.2147 - accuracy: 0.4916 9/11 [=======================>......] - ETA: 0s - loss: 0.2139 - accuracy: 0.495710/11 [==========================>...] - ETA: 0s - loss: 0.2130 - accuracy: 0.501011/11 [==============================] - ETA: 0s - loss: 0.2122 - accuracy: 0.505511/11 [==============================] - 1s 100ms/step - loss: 0.2116 - accuracy: 0.5093
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2205 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 1s - loss: 0.2178 - accuracy: 0.6016 3/11 [=======>......................] - ETA: 0s - loss: 0.2121 - accuracy: 0.6024 4/11 [=========>....................] - ETA: 0s - loss: 0.2083 - accuracy: 0.6022 5/11 [============>.................] - ETA: 0s - loss: 0.2050 - accuracy: 0.6015 6/11 [===============>..............] - ETA: 0s - loss: 0.2022 - accuracy: 0.6013 7/11 [==================>...........] - ETA: 0s - loss: 0.2004 - accuracy: 0.6005 8/11 [====================>.........] - ETA: 0s - loss: 0.1990 - accuracy: 0.6005 9/11 [=======================>......] - ETA: 0s - loss: 0.1977 - accuracy: 0.601210/11 [==========================>...] - ETA: 0s - loss: 0.1965 - accuracy: 0.601811/11 [==============================] - ETA: 0s - loss: 0.1957 - accuracy: 0.602311/11 [==============================] - 1s 105ms/step - loss: 0.1950 - accuracy: 0.6027
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1782 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 0s - loss: 0.1769 - accuracy: 0.5977 3/11 [=======>......................] - ETA: 0s - loss: 0.1763 - accuracy: 0.6094 4/11 [=========>....................] - ETA: 0s - loss: 0.1747 - accuracy: 0.6143 5/11 [============>.................] - ETA: 0s - loss: 0.1733 - accuracy: 0.6180 6/11 [===============>..............] - ETA: 0s - loss: 0.1727 - accuracy: 0.6198 7/11 [==================>...........] - ETA: 0s - loss: 0.1724 - accuracy: 0.6213 8/11 [====================>.........] - ETA: 0s - loss: 0.1721 - accuracy: 0.6225 9/11 [=======================>......] - ETA: 0s - loss: 0.1722 - accuracy: 0.623110/11 [==========================>...] - ETA: 0s - loss: 0.1722 - accuracy: 0.623511/11 [==============================] - ETA: 0s - loss: 0.1722 - accuracy: 0.624411/11 [==============================] - 1s 108ms/step - loss: 0.1722 - accuracy: 0.6251
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1718 - accuracy: 0.7031 2/11 [====>.........................] - ETA: 0s - loss: 0.1713 - accuracy: 0.6973 3/11 [=======>......................] - ETA: 0s - loss: 0.1721 - accuracy: 0.7036 4/11 [=========>....................] - ETA: 0s - loss: 0.1713 - accuracy: 0.7069 5/11 [============>.................] - ETA: 0s - loss: 0.1697 - accuracy: 0.7117 6/11 [===============>..............] - ETA: 0s - loss: 0.1691 - accuracy: 0.7151 7/11 [==================>...........] - ETA: 0s - loss: 0.1683 - accuracy: 0.7175 8/11 [====================>.........] - ETA: 0s - loss: 0.1677 - accuracy: 0.7189 9/11 [=======================>......] - ETA: 0s - loss: 0.1669 - accuracy: 0.719010/11 [==========================>...] - ETA: 0s - loss: 0.1664 - accuracy: 0.718011/11 [==============================] - ETA: 0s - loss: 0.1660 - accuracy: 0.717011/11 [==============================] - 1s 104ms/step - loss: 0.1657 - accuracy: 0.7162
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1491 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 0s - loss: 0.1515 - accuracy: 0.6348 3/11 [=======>......................] - ETA: 0s - loss: 0.1529 - accuracy: 0.6402 4/11 [=========>....................] - ETA: 0s - loss: 0.1533 - accuracy: 0.6457 5/11 [============>.................] - ETA: 0s - loss: 0.1532 - accuracy: 0.6525 6/11 [===============>..............] - ETA: 0s - loss: 0.1529 - accuracy: 0.6577 7/11 [==================>...........] - ETA: 0s - loss: 0.1529 - accuracy: 0.6613 8/11 [====================>.........] - ETA: 0s - loss: 0.1531 - accuracy: 0.6649 9/11 [=======================>......] - ETA: 0s - loss: 0.1531 - accuracy: 0.669210/11 [==========================>...] - ETA: 0s - loss: 0.1530 - accuracy: 0.673511/11 [==============================] - ETA: 0s - loss: 0.1529 - accuracy: 0.677211/11 [==============================] - 1s 106ms/step - loss: 0.1529 - accuracy: 0.6803
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1518 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 0s - loss: 0.1525 - accuracy: 0.7852 3/11 [=======>......................] - ETA: 0s - loss: 0.1521 - accuracy: 0.7839 4/11 [=========>....................] - ETA: 0s - loss: 0.1505 - accuracy: 0.7881 5/11 [============>.................] - ETA: 0s - loss: 0.1490 - accuracy: 0.7880 6/11 [===============>..............] - ETA: 0s - loss: 0.1481 - accuracy: 0.7866 7/11 [==================>...........] - ETA: 0s - loss: 0.1475 - accuracy: 0.7854 8/11 [====================>.........] - ETA: 0s - loss: 0.1472 - accuracy: 0.7834 9/11 [=======================>......] - ETA: 0s - loss: 0.1471 - accuracy: 0.780710/11 [==========================>...] - ETA: 0s - loss: 0.1469 - accuracy: 0.778111/11 [==============================] - ETA: 0s - loss: 0.1467 - accuracy: 0.775711/11 [==============================] - 1s 107ms/step - loss: 0.1465 - accuracy: 0.7737
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1365 - accuracy: 0.7188 2/11 [====>.........................] - ETA: 0s - loss: 0.1411 - accuracy: 0.7070 3/11 [=======>......................] - ETA: 0s - loss: 0.1420 - accuracy: 0.7144 4/11 [=========>....................] - ETA: 0s - loss: 0.1424 - accuracy: 0.7179 5/11 [============>.................] - ETA: 0s - loss: 0.1424 - accuracy: 0.7193 6/11 [===============>..............] - ETA: 0s - loss: 0.1421 - accuracy: 0.7208 7/11 [==================>...........] - ETA: 0s - loss: 0.1420 - accuracy: 0.7224 8/11 [====================>.........] - ETA: 0s - loss: 0.1420 - accuracy: 0.7234 9/11 [=======================>......] - ETA: 0s - loss: 0.1419 - accuracy: 0.724410/11 [==========================>...] - ETA: 0s - loss: 0.1416 - accuracy: 0.726011/11 [==============================] - ETA: 0s - loss: 0.1413 - accuracy: 0.727811/11 [==============================] - 1s 103ms/step - loss: 0.1411 - accuracy: 0.7292
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1325 - accuracy: 0.7891 2/11 [====>.........................] - ETA: 0s - loss: 0.1332 - accuracy: 0.7832 3/11 [=======>......................] - ETA: 0s - loss: 0.1332 - accuracy: 0.7799 4/11 [=========>....................] - ETA: 0s - loss: 0.1334 - accuracy: 0.7769 5/11 [============>.................] - ETA: 0s - loss: 0.1337 - accuracy: 0.7702 6/11 [===============>..............] - ETA: 0s - loss: 0.1334 - accuracy: 0.7651 7/11 [==================>...........] - ETA: 0s - loss: 0.1331 - accuracy: 0.7604 8/11 [====================>.........] - ETA: 0s - loss: 0.1327 - accuracy: 0.7579 9/11 [=======================>......] - ETA: 0s - loss: 0.1325 - accuracy: 0.756810/11 [==========================>...] - ETA: 0s - loss: 0.1323 - accuracy: 0.757411/11 [==============================] - ETA: 0s - loss: 0.1322 - accuracy: 0.758411/11 [==============================] - 1s 110ms/step - loss: 0.1322 - accuracy: 0.7592
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1332 - accuracy: 0.8516 2/11 [====>.........................] - ETA: 0s - loss: 0.1344 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 0s - loss: 0.1336 - accuracy: 0.8490 4/11 [=========>....................] - ETA: 0s - loss: 0.1325 - accuracy: 0.8496 5/11 [============>.................] - ETA: 0s - loss: 0.1312 - accuracy: 0.8456 6/11 [===============>..............] - ETA: 0s - loss: 0.1308 - accuracy: 0.8425 7/11 [==================>...........] - ETA: 0s - loss: 0.1306 - accuracy: 0.8400 8/11 [====================>.........] - ETA: 0s - loss: 0.1302 - accuracy: 0.8375 9/11 [=======================>......] - ETA: 0s - loss: 0.1297 - accuracy: 0.835310/11 [==========================>...] - ETA: 0s - loss: 0.1293 - accuracy: 0.833011/11 [==============================] - ETA: 0s - loss: 0.1290 - accuracy: 0.831111/11 [==============================] - 1s 108ms/step - loss: 0.1287 - accuracy: 0.8294
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.1270 - accuracy: 0.85943/6 [==============>...............] - ETA: 0s - loss: 0.1327 - accuracy: 0.8620 5/6 [========================>.....] - ETA: 0s - loss: 0.1361 - accuracy: 0.86256/6 [==============================] - 4s 29ms/step - loss: 0.1367 - accuracy: 0.8640
2021-12-14 00:03:30.784991: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:03:30.786121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:03:30.786170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:03:30.786213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:03:30.786246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:03:30.786273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:03:30.786298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:03:30.786323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:03:30.786348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:03:30.786374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:03:30.787520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:03:30.787547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:03:30.787557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:03:30.787564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [5.647540e-04 3.413862e-02 9.798218e-01 9.121180e-03 6.676525e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [5.1593781e-04 2.9184312e-02 9.7713381e-01 9.7667277e-03 7.0000291e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 4 0] pred: [4.9790740e-04 2.5095016e-02 9.7638297e-01 1.0025442e-02 6.5331161e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.01523495 0.8640864  0.7811346  0.00752693 0.00170425]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [0.0191246  0.87938106 0.7283508  0.00873378 0.00168595]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.01273045 0.85688436 0.7852286  0.00721329 0.00161028]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 2 4 1 0] pred: [0.02717024 0.0292083  0.14706579 0.6812331  0.12106502]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [4.7823787e-04 2.4590135e-02 9.7576791e-01 1.0241777e-02 6.4864159e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [8.8405609e-04 6.6342264e-02 9.8684591e-01 7.8433752e-03 7.0825219e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [6.1887503e-04 4.4684500e-02 9.7978938e-01 8.9829564e-03 6.9203377e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [0.00095499 0.17062211 0.89926505 0.01398331 0.00221026]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 0 2 1] pred: [0.075681   0.04562777 0.06937119 0.67146105 0.16064835]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [9.8326802e-04 9.2795432e-02 9.8330152e-01 8.1461072e-03 6.6137314e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [4.5815110e-04 2.3874402e-02 9.7549355e-01 1.0814965e-02 6.6578984e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [0.01108217 0.8506331  0.82915735 0.00629953 0.00156716]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:02 - loss: 0.6999 - accuracy: 0.0156 2/11 [====>.........................] - ETA: 0s - loss: 0.6980 - accuracy: 0.0273   3/11 [=======>......................] - ETA: 0s - loss: 0.6962 - accuracy: 0.0582 4/11 [=========>....................] - ETA: 0s - loss: 0.6944 - accuracy: 0.0998 5/11 [============>.................] - ETA: 0s - loss: 0.6926 - accuracy: 0.1361 6/11 [===============>..............] - ETA: 0s - loss: 0.6909 - accuracy: 0.1657 7/11 [==================>...........] - ETA: 0s - loss: 0.6891 - accuracy: 0.1902 8/11 [====================>.........] - ETA: 0s - loss: 0.6874 - accuracy: 0.2097 9/11 [=======================>......] - ETA: 0s - loss: 0.6856 - accuracy: 0.226010/11 [==========================>...] - ETA: 0s - loss: 0.6838 - accuracy: 0.240111/11 [==============================] - ETA: 0s - loss: 0.6821 - accuracy: 0.251411/11 [==============================] - 13s 106ms/step - loss: 0.6807 - accuracy: 0.2609
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6111 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.6084 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 0s - loss: 0.6058 - accuracy: 0.4900 4/11 [=========>....................] - ETA: 0s - loss: 0.6030 - accuracy: 0.4896 5/11 [============>.................] - ETA: 0s - loss: 0.6004 - accuracy: 0.4854 6/11 [===============>..............] - ETA: 0s - loss: 0.5978 - accuracy: 0.4807 7/11 [==================>...........] - ETA: 0s - loss: 0.5949 - accuracy: 0.4775 8/11 [====================>.........] - ETA: 0s - loss: 0.5918 - accuracy: 0.4752 9/11 [=======================>......] - ETA: 0s - loss: 0.5885 - accuracy: 0.473710/11 [==========================>...] - ETA: 0s - loss: 0.5849 - accuracy: 0.472811/11 [==============================] - ETA: 0s - loss: 0.5816 - accuracy: 0.471611/11 [==============================] - 1s 113ms/step - loss: 0.5788 - accuracy: 0.4705
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4579 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.4471 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.4426 - accuracy: 0.4653 4/11 [=========>....................] - ETA: 0s - loss: 0.4392 - accuracy: 0.4652 5/11 [============>.................] - ETA: 0s - loss: 0.4359 - accuracy: 0.4671 6/11 [===============>..............] - ETA: 0s - loss: 0.4330 - accuracy: 0.4683 7/11 [==================>...........] - ETA: 0s - loss: 0.4306 - accuracy: 0.4688 8/11 [====================>.........] - ETA: 0s - loss: 0.4286 - accuracy: 0.4689 9/11 [=======================>......] - ETA: 0s - loss: 0.4273 - accuracy: 0.467810/11 [==========================>...] - ETA: 0s - loss: 0.4260 - accuracy: 0.466811/11 [==============================] - ETA: 0s - loss: 0.4252 - accuracy: 0.466111/11 [==============================] - 1s 115ms/step - loss: 0.4246 - accuracy: 0.4655
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4272 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 0s - loss: 0.4175 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.4170 - accuracy: 0.4332 4/11 [=========>....................] - ETA: 0s - loss: 0.4138 - accuracy: 0.4377 5/11 [============>.................] - ETA: 0s - loss: 0.4121 - accuracy: 0.4417 6/11 [===============>..............] - ETA: 0s - loss: 0.4107 - accuracy: 0.4436 7/11 [==================>...........] - ETA: 0s - loss: 0.4089 - accuracy: 0.4442 8/11 [====================>.........] - ETA: 0s - loss: 0.4073 - accuracy: 0.4456 9/11 [=======================>......] - ETA: 0s - loss: 0.4055 - accuracy: 0.447410/11 [==========================>...] - ETA: 0s - loss: 0.4038 - accuracy: 0.448611/11 [==============================] - ETA: 0s - loss: 0.4024 - accuracy: 0.449511/11 [==============================] - 1s 104ms/step - loss: 0.4013 - accuracy: 0.4503
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3982 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.3954 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 0s - loss: 0.3942 - accuracy: 0.4371 4/11 [=========>....................] - ETA: 0s - loss: 0.3935 - accuracy: 0.4416 5/11 [============>.................] - ETA: 0s - loss: 0.3923 - accuracy: 0.4461 6/11 [===============>..............] - ETA: 0s - loss: 0.3912 - accuracy: 0.4501 7/11 [==================>...........] - ETA: 0s - loss: 0.3901 - accuracy: 0.4511 8/11 [====================>.........] - ETA: 0s - loss: 0.3890 - accuracy: 0.4526 9/11 [=======================>......] - ETA: 0s - loss: 0.3886 - accuracy: 0.453610/11 [==========================>...] - ETA: 0s - loss: 0.3883 - accuracy: 0.454211/11 [==============================] - ETA: 0s - loss: 0.3880 - accuracy: 0.454611/11 [==============================] - 1s 106ms/step - loss: 0.3877 - accuracy: 0.4550
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3711 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.3787 - accuracy: 0.4883 3/11 [=======>......................] - ETA: 0s - loss: 0.3800 - accuracy: 0.4896 4/11 [=========>....................] - ETA: 0s - loss: 0.3798 - accuracy: 0.4868 5/11 [============>.................] - ETA: 0s - loss: 0.3789 - accuracy: 0.4851 6/11 [===============>..............] - ETA: 0s - loss: 0.3789 - accuracy: 0.4830 7/11 [==================>...........] - ETA: 0s - loss: 0.3788 - accuracy: 0.4811 8/11 [====================>.........] - ETA: 0s - loss: 0.3788 - accuracy: 0.4799 9/11 [=======================>......] - ETA: 0s - loss: 0.3790 - accuracy: 0.478610/11 [==========================>...] - ETA: 0s - loss: 0.3788 - accuracy: 0.477211/11 [==============================] - ETA: 0s - loss: 0.3786 - accuracy: 0.475511/11 [==============================] - 1s 105ms/step - loss: 0.3784 - accuracy: 0.4741
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3626 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.3674 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.3719 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 0s - loss: 0.3723 - accuracy: 0.4487 5/11 [============>.................] - ETA: 0s - loss: 0.3716 - accuracy: 0.4455 6/11 [===============>..............] - ETA: 0s - loss: 0.3708 - accuracy: 0.4451 7/11 [==================>...........] - ETA: 0s - loss: 0.3705 - accuracy: 0.4461 8/11 [====================>.........] - ETA: 0s - loss: 0.3702 - accuracy: 0.4463 9/11 [=======================>......] - ETA: 0s - loss: 0.3694 - accuracy: 0.447510/11 [==========================>...] - ETA: 0s - loss: 0.3684 - accuracy: 0.448711/11 [==============================] - ETA: 0s - loss: 0.3676 - accuracy: 0.449711/11 [==============================] - 1s 107ms/step - loss: 0.3669 - accuracy: 0.4505
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3480 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.3416 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.3450 - accuracy: 0.4392 4/11 [=========>....................] - ETA: 0s - loss: 0.3459 - accuracy: 0.4383 5/11 [============>.................] - ETA: 0s - loss: 0.3472 - accuracy: 0.4400 6/11 [===============>..............] - ETA: 0s - loss: 0.3485 - accuracy: 0.4424 7/11 [==================>...........] - ETA: 0s - loss: 0.3488 - accuracy: 0.4438 8/11 [====================>.........] - ETA: 0s - loss: 0.3487 - accuracy: 0.4452 9/11 [=======================>......] - ETA: 0s - loss: 0.3483 - accuracy: 0.446410/11 [==========================>...] - ETA: 0s - loss: 0.3475 - accuracy: 0.447711/11 [==============================] - ETA: 0s - loss: 0.3468 - accuracy: 0.448711/11 [==============================] - 1s 104ms/step - loss: 0.3462 - accuracy: 0.4496
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3413 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.3394 - accuracy: 0.4238 3/11 [=======>......................] - ETA: 0s - loss: 0.3341 - accuracy: 0.4319 4/11 [=========>....................] - ETA: 0s - loss: 0.3351 - accuracy: 0.4362 5/11 [============>.................] - ETA: 0s - loss: 0.3337 - accuracy: 0.4440 6/11 [===============>..............] - ETA: 0s - loss: 0.3328 - accuracy: 0.4485 7/11 [==================>...........] - ETA: 0s - loss: 0.3320 - accuracy: 0.4511 8/11 [====================>.........] - ETA: 0s - loss: 0.3310 - accuracy: 0.4533 9/11 [=======================>......] - ETA: 0s - loss: 0.3300 - accuracy: 0.456010/11 [==========================>...] - ETA: 0s - loss: 0.3290 - accuracy: 0.458211/11 [==============================] - ETA: 0s - loss: 0.3279 - accuracy: 0.460411/11 [==============================] - 1s 107ms/step - loss: 0.3271 - accuracy: 0.4622
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3060 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.3059 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.3050 - accuracy: 0.4991 4/11 [=========>....................] - ETA: 0s - loss: 0.3046 - accuracy: 0.4950 5/11 [============>.................] - ETA: 0s - loss: 0.3034 - accuracy: 0.4932 6/11 [===============>..............] - ETA: 0s - loss: 0.3026 - accuracy: 0.4902 7/11 [==================>...........] - ETA: 0s - loss: 0.3021 - accuracy: 0.4887 8/11 [====================>.........] - ETA: 0s - loss: 0.3016 - accuracy: 0.4880 9/11 [=======================>......] - ETA: 0s - loss: 0.3005 - accuracy: 0.488110/11 [==========================>...] - ETA: 0s - loss: 0.2995 - accuracy: 0.488811/11 [==============================] - ETA: 0s - loss: 0.2986 - accuracy: 0.489311/11 [==============================] - 1s 108ms/step - loss: 0.2979 - accuracy: 0.4897
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2802 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.2867 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.2858 - accuracy: 0.4735 4/11 [=========>....................] - ETA: 0s - loss: 0.2837 - accuracy: 0.4801 5/11 [============>.................] - ETA: 0s - loss: 0.2809 - accuracy: 0.4891 6/11 [===============>..............] - ETA: 0s - loss: 0.2780 - accuracy: 0.4987 7/11 [==================>...........] - ETA: 0s - loss: 0.2760 - accuracy: 0.5069 8/11 [====================>.........] - ETA: 0s - loss: 0.2744 - accuracy: 0.5148 9/11 [=======================>......] - ETA: 0s - loss: 0.2731 - accuracy: 0.521410/11 [==========================>...] - ETA: 0s - loss: 0.2721 - accuracy: 0.526711/11 [==============================] - ETA: 0s - loss: 0.2712 - accuracy: 0.530511/11 [==============================] - 1s 106ms/step - loss: 0.2704 - accuracy: 0.5338
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2397 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.2518 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.2538 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.2531 - accuracy: 0.5088 5/11 [============>.................] - ETA: 0s - loss: 0.2510 - accuracy: 0.5170 6/11 [===============>..............] - ETA: 0s - loss: 0.2493 - accuracy: 0.5227 7/11 [==================>...........] - ETA: 0s - loss: 0.2481 - accuracy: 0.5266 8/11 [====================>.........] - ETA: 0s - loss: 0.2469 - accuracy: 0.5307 9/11 [=======================>......] - ETA: 0s - loss: 0.2456 - accuracy: 0.534710/11 [==========================>...] - ETA: 0s - loss: 0.2446 - accuracy: 0.537111/11 [==============================] - ETA: 0s - loss: 0.2439 - accuracy: 0.538911/11 [==============================] - 1s 107ms/step - loss: 0.2432 - accuracy: 0.5404
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2254 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.2222 - accuracy: 0.5527 3/11 [=======>......................] - ETA: 0s - loss: 0.2216 - accuracy: 0.5577 4/11 [=========>....................] - ETA: 0s - loss: 0.2183 - accuracy: 0.5643 5/11 [============>.................] - ETA: 0s - loss: 0.2165 - accuracy: 0.5674 6/11 [===============>..............] - ETA: 0s - loss: 0.2161 - accuracy: 0.5698 7/11 [==================>...........] - ETA: 0s - loss: 0.2166 - accuracy: 0.5720 8/11 [====================>.........] - ETA: 0s - loss: 0.2166 - accuracy: 0.5757 9/11 [=======================>......] - ETA: 0s - loss: 0.2163 - accuracy: 0.580310/11 [==========================>...] - ETA: 0s - loss: 0.2160 - accuracy: 0.584611/11 [==============================] - ETA: 0s - loss: 0.2158 - accuracy: 0.588511/11 [==============================] - 1s 107ms/step - loss: 0.2156 - accuracy: 0.5918
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1909 - accuracy: 0.6250 2/11 [====>.........................] - ETA: 0s - loss: 0.1932 - accuracy: 0.6289 3/11 [=======>......................] - ETA: 0s - loss: 0.1941 - accuracy: 0.6224 4/11 [=========>....................] - ETA: 0s - loss: 0.1970 - accuracy: 0.6157 5/11 [============>.................] - ETA: 0s - loss: 0.1982 - accuracy: 0.6129 6/11 [===============>..............] - ETA: 0s - loss: 0.1982 - accuracy: 0.6132 7/11 [==================>...........] - ETA: 0s - loss: 0.1983 - accuracy: 0.6160 8/11 [====================>.........] - ETA: 0s - loss: 0.1983 - accuracy: 0.6197 9/11 [=======================>......] - ETA: 0s - loss: 0.1981 - accuracy: 0.624910/11 [==========================>...] - ETA: 0s - loss: 0.1978 - accuracy: 0.630211/11 [==============================] - ETA: 0s - loss: 0.1975 - accuracy: 0.634911/11 [==============================] - 1s 106ms/step - loss: 0.1973 - accuracy: 0.6387
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1749 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.1723 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.1746 - accuracy: 0.5929 4/11 [=========>....................] - ETA: 0s - loss: 0.1748 - accuracy: 0.6029 5/11 [============>.................] - ETA: 0s - loss: 0.1748 - accuracy: 0.6123 6/11 [===============>..............] - ETA: 0s - loss: 0.1751 - accuracy: 0.6192 7/11 [==================>...........] - ETA: 0s - loss: 0.1761 - accuracy: 0.6243 8/11 [====================>.........] - ETA: 0s - loss: 0.1767 - accuracy: 0.6309 9/11 [=======================>......] - ETA: 0s - loss: 0.1773 - accuracy: 0.638210/11 [==========================>...] - ETA: 0s - loss: 0.1779 - accuracy: 0.645311/11 [==============================] - ETA: 0s - loss: 0.1783 - accuracy: 0.651911/11 [==============================] - 1s 107ms/step - loss: 0.1786 - accuracy: 0.6573
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1918 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 0s - loss: 0.1880 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.1842 - accuracy: 0.7752 4/11 [=========>....................] - ETA: 0s - loss: 0.1814 - accuracy: 0.7703 5/11 [============>.................] - ETA: 0s - loss: 0.1780 - accuracy: 0.7719 6/11 [===============>..............] - ETA: 0s - loss: 0.1761 - accuracy: 0.7709 7/11 [==================>...........] - ETA: 0s - loss: 0.1746 - accuracy: 0.7699 8/11 [====================>.........] - ETA: 0s - loss: 0.1737 - accuracy: 0.7693 9/11 [=======================>......] - ETA: 0s - loss: 0.1729 - accuracy: 0.769410/11 [==========================>...] - ETA: 0s - loss: 0.1724 - accuracy: 0.769711/11 [==============================] - ETA: 0s - loss: 0.1720 - accuracy: 0.770211/11 [==============================] - 1s 104ms/step - loss: 0.1717 - accuracy: 0.7707
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1444 - accuracy: 0.8594 2/11 [====>.........................] - ETA: 0s - loss: 0.1487 - accuracy: 0.8477 3/11 [=======>......................] - ETA: 0s - loss: 0.1542 - accuracy: 0.8299 4/11 [=========>....................] - ETA: 0s - loss: 0.1551 - accuracy: 0.8245 5/11 [============>.................] - ETA: 0s - loss: 0.1551 - accuracy: 0.8206 6/11 [===============>..............] - ETA: 0s - loss: 0.1550 - accuracy: 0.8175 7/11 [==================>...........] - ETA: 0s - loss: 0.1553 - accuracy: 0.8134 8/11 [====================>.........] - ETA: 0s - loss: 0.1551 - accuracy: 0.8104 9/11 [=======================>......] - ETA: 0s - loss: 0.1550 - accuracy: 0.807410/11 [==========================>...] - ETA: 0s - loss: 0.1550 - accuracy: 0.805411/11 [==============================] - ETA: 0s - loss: 0.1552 - accuracy: 0.804111/11 [==============================] - 1s 104ms/step - loss: 0.1553 - accuracy: 0.8031
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1380 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 0s - loss: 0.1417 - accuracy: 0.8750 3/11 [=======>......................] - ETA: 0s - loss: 0.1442 - accuracy: 0.8715 4/11 [=========>....................] - ETA: 0s - loss: 0.1454 - accuracy: 0.8675 5/11 [============>.................] - ETA: 0s - loss: 0.1462 - accuracy: 0.8628 6/11 [===============>..............] - ETA: 0s - loss: 0.1468 - accuracy: 0.8561 7/11 [==================>...........] - ETA: 0s - loss: 0.1469 - accuracy: 0.8508 8/11 [====================>.........] - ETA: 0s - loss: 0.1469 - accuracy: 0.8475 9/11 [=======================>......] - ETA: 0s - loss: 0.1469 - accuracy: 0.845210/11 [==========================>...] - ETA: 0s - loss: 0.1468 - accuracy: 0.843911/11 [==============================] - ETA: 0s - loss: 0.1468 - accuracy: 0.843111/11 [==============================] - 1s 109ms/step - loss: 0.1468 - accuracy: 0.8424
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1427 - accuracy: 0.8984 2/11 [====>.........................] - ETA: 0s - loss: 0.1407 - accuracy: 0.9102 3/11 [=======>......................] - ETA: 0s - loss: 0.1393 - accuracy: 0.9036 4/11 [=========>....................] - ETA: 0s - loss: 0.1390 - accuracy: 0.8950 5/11 [============>.................] - ETA: 0s - loss: 0.1389 - accuracy: 0.8888 6/11 [===============>..............] - ETA: 0s - loss: 0.1391 - accuracy: 0.8820 7/11 [==================>...........] - ETA: 0s - loss: 0.1394 - accuracy: 0.8762 8/11 [====================>.........] - ETA: 0s - loss: 0.1396 - accuracy: 0.8726 9/11 [=======================>......] - ETA: 0s - loss: 0.1394 - accuracy: 0.870910/11 [==========================>...] - ETA: 0s - loss: 0.1392 - accuracy: 0.870311/11 [==============================] - ETA: 0s - loss: 0.1390 - accuracy: 0.870011/11 [==============================] - 1s 102ms/step - loss: 0.1389 - accuracy: 0.8697
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1255 - accuracy: 0.9766 2/11 [====>.........................] - ETA: 1s - loss: 0.1250 - accuracy: 0.9629 3/11 [=======>......................] - ETA: 0s - loss: 0.1245 - accuracy: 0.9553 4/11 [=========>....................] - ETA: 0s - loss: 0.1242 - accuracy: 0.9484 5/11 [============>.................] - ETA: 0s - loss: 0.1241 - accuracy: 0.9418 6/11 [===============>..............] - ETA: 0s - loss: 0.1241 - accuracy: 0.9361 7/11 [==================>...........] - ETA: 0s - loss: 0.1244 - accuracy: 0.9320 8/11 [====================>.........] - ETA: 0s - loss: 0.1248 - accuracy: 0.9287 9/11 [=======================>......] - ETA: 0s - loss: 0.1251 - accuracy: 0.925710/11 [==========================>...] - ETA: 0s - loss: 0.1254 - accuracy: 0.923511/11 [==============================] - ETA: 0s - loss: 0.1257 - accuracy: 0.922111/11 [==============================] - 1s 108ms/step - loss: 0.1259 - accuracy: 0.9209
Evaluate on test data
1/6 [====>.........................] - ETA: 18s - loss: 0.1112 - accuracy: 0.90623/6 [==============>...............] - ETA: 0s - loss: 0.1167 - accuracy: 0.8958 5/6 [========================>.....] - ETA: 0s - loss: 0.1248 - accuracy: 0.89536/6 [==============================] - 4s 30ms/step - loss: 0.1255 - accuracy: 0.8966
2021-12-14 00:04:18.783664: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:04:18.784803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:04:18.784851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:04:18.784892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:04:18.784926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:04:18.784952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:04:18.784978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:04:18.785012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:04:18.785041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:04:18.785075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:04:18.786235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:04:18.786262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:04:18.786271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:04:18.786279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [0.00184879 0.01856583 0.9729883  0.01852345 0.00410581]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [0.0015524  0.02335224 0.9742101  0.01675153 0.00403023]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [0 1 4 3 2] pred: [0.5588949  0.40012383 0.06935772 0.10984483 0.18488654]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.02355626 0.8373663  0.79778457 0.01439032 0.0032534 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [0.00152883 0.02261594 0.9706527  0.01702568 0.00406006]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 4 0] pred: [0.00193891 0.01621366 0.9715146  0.01921713 0.00411183]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [0.00818688 0.31051165 0.6709063  0.09111258 0.00781575]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [0.02010357 0.82398534 0.79347694 0.01566494 0.00322822]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 1 4 0] pred: [0.00193867 0.01632357 0.9718996  0.01904911 0.00409013]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 4 2 0 1] pred: [0.04078987 0.03231409 0.12999156 0.6307806  0.24588722]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [0.01355845 0.73809004 0.8736403  0.01090977 0.00290689]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [0.00168723 0.02926579 0.9773097  0.01717567 0.00399637]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [0.00204727 0.04547524 0.9745031  0.01522589 0.00394747]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 4 0] pred: [0.00187474 0.0173122  0.97155845 0.01810402 0.00398123]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 2 0 1] pred: [0.0581421  0.03788215 0.11512452 0.65388423 0.24242574]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:04 - loss: 0.6952 - accuracy: 0.0000e+00 2/11 [====>.........................] - ETA: 1s - loss: 0.6939 - accuracy: 0.0195       3/11 [=======>......................] - ETA: 0s - loss: 0.6925 - accuracy: 0.0790 4/11 [=========>....................] - ETA: 0s - loss: 0.6912 - accuracy: 0.1252 5/11 [============>.................] - ETA: 0s - loss: 0.6898 - accuracy: 0.1608 6/11 [===============>..............] - ETA: 0s - loss: 0.6884 - accuracy: 0.1893 7/11 [==================>...........] - ETA: 0s - loss: 0.6871 - accuracy: 0.2117 8/11 [====================>.........] - ETA: 0s - loss: 0.6857 - accuracy: 0.2308 9/11 [=======================>......] - ETA: 0s - loss: 0.6843 - accuracy: 0.246310/11 [==========================>...] - ETA: 0s - loss: 0.6828 - accuracy: 0.259511/11 [==============================] - ETA: 0s - loss: 0.6814 - accuracy: 0.270711/11 [==============================] - 14s 112ms/step - loss: 0.6802 - accuracy: 0.2801
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6229 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.6212 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 0s - loss: 0.6195 - accuracy: 0.4540 4/11 [=========>....................] - ETA: 0s - loss: 0.6168 - accuracy: 0.4572 5/11 [============>.................] - ETA: 0s - loss: 0.6143 - accuracy: 0.4564 6/11 [===============>..............] - ETA: 0s - loss: 0.6112 - accuracy: 0.4584 7/11 [==================>...........] - ETA: 0s - loss: 0.6079 - accuracy: 0.4601 8/11 [====================>.........] - ETA: 0s - loss: 0.6045 - accuracy: 0.4604 9/11 [=======================>......] - ETA: 0s - loss: 0.6008 - accuracy: 0.460610/11 [==========================>...] - ETA: 0s - loss: 0.5968 - accuracy: 0.460811/11 [==============================] - ETA: 0s - loss: 0.5928 - accuracy: 0.461011/11 [==============================] - 1s 105ms/step - loss: 0.5895 - accuracy: 0.4612
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4144 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.4142 - accuracy: 0.5137 3/11 [=======>......................] - ETA: 0s - loss: 0.4161 - accuracy: 0.5013 4/11 [=========>....................] - ETA: 0s - loss: 0.4154 - accuracy: 0.4922 5/11 [============>.................] - ETA: 0s - loss: 0.4134 - accuracy: 0.4863 6/11 [===============>..............] - ETA: 0s - loss: 0.4128 - accuracy: 0.4809 7/11 [==================>...........] - ETA: 0s - loss: 0.4131 - accuracy: 0.4759 8/11 [====================>.........] - ETA: 0s - loss: 0.4129 - accuracy: 0.4737 9/11 [=======================>......] - ETA: 0s - loss: 0.4126 - accuracy: 0.472110/11 [==========================>...] - ETA: 0s - loss: 0.4119 - accuracy: 0.470911/11 [==============================] - ETA: 0s - loss: 0.4112 - accuracy: 0.470211/11 [==============================] - 1s 116ms/step - loss: 0.4107 - accuracy: 0.4696
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4099 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.4192 - accuracy: 0.4395 3/11 [=======>......................] - ETA: 0s - loss: 0.4166 - accuracy: 0.4457 4/11 [=========>....................] - ETA: 0s - loss: 0.4112 - accuracy: 0.4539 5/11 [============>.................] - ETA: 0s - loss: 0.4078 - accuracy: 0.4566 6/11 [===============>..............] - ETA: 0s - loss: 0.4050 - accuracy: 0.4582 7/11 [==================>...........] - ETA: 0s - loss: 0.4037 - accuracy: 0.4571 8/11 [====================>.........] - ETA: 0s - loss: 0.4017 - accuracy: 0.4583 9/11 [=======================>......] - ETA: 0s - loss: 0.4001 - accuracy: 0.459510/11 [==========================>...] - ETA: 0s - loss: 0.3988 - accuracy: 0.460211/11 [==============================] - ETA: 0s - loss: 0.3977 - accuracy: 0.460511/11 [==============================] - 1s 106ms/step - loss: 0.3968 - accuracy: 0.4607
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3919 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.3979 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 0s - loss: 0.3936 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.3891 - accuracy: 0.4556 5/11 [============>.................] - ETA: 0s - loss: 0.3866 - accuracy: 0.4548 6/11 [===============>..............] - ETA: 0s - loss: 0.3860 - accuracy: 0.4543 7/11 [==================>...........] - ETA: 0s - loss: 0.3854 - accuracy: 0.4541 8/11 [====================>.........] - ETA: 0s - loss: 0.3853 - accuracy: 0.4542 9/11 [=======================>......] - ETA: 0s - loss: 0.3852 - accuracy: 0.453810/11 [==========================>...] - ETA: 0s - loss: 0.3849 - accuracy: 0.454511/11 [==============================] - ETA: 0s - loss: 0.3843 - accuracy: 0.455311/11 [==============================] - 1s 109ms/step - loss: 0.3839 - accuracy: 0.4560
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3604 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.3660 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 0s - loss: 0.3676 - accuracy: 0.4462 4/11 [=========>....................] - ETA: 0s - loss: 0.3694 - accuracy: 0.4450 5/11 [============>.................] - ETA: 0s - loss: 0.3709 - accuracy: 0.4447 6/11 [===============>..............] - ETA: 0s - loss: 0.3727 - accuracy: 0.4451 7/11 [==================>...........] - ETA: 0s - loss: 0.3731 - accuracy: 0.4470 8/11 [====================>.........] - ETA: 0s - loss: 0.3729 - accuracy: 0.4485 9/11 [=======================>......] - ETA: 0s - loss: 0.3727 - accuracy: 0.449410/11 [==========================>...] - ETA: 0s - loss: 0.3726 - accuracy: 0.449911/11 [==============================] - ETA: 0s - loss: 0.3722 - accuracy: 0.451111/11 [==============================] - 1s 110ms/step - loss: 0.3719 - accuracy: 0.4521
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3490 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.3506 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 0s - loss: 0.3521 - accuracy: 0.4735 4/11 [=========>....................] - ETA: 0s - loss: 0.3517 - accuracy: 0.4723 5/11 [============>.................] - ETA: 0s - loss: 0.3504 - accuracy: 0.4738 6/11 [===============>..............] - ETA: 0s - loss: 0.3505 - accuracy: 0.4732 7/11 [==================>...........] - ETA: 0s - loss: 0.3502 - accuracy: 0.4724 8/11 [====================>.........] - ETA: 0s - loss: 0.3496 - accuracy: 0.4721 9/11 [=======================>......] - ETA: 0s - loss: 0.3493 - accuracy: 0.471210/11 [==========================>...] - ETA: 0s - loss: 0.3490 - accuracy: 0.470311/11 [==============================] - ETA: 0s - loss: 0.3487 - accuracy: 0.469611/11 [==============================] - 1s 112ms/step - loss: 0.3485 - accuracy: 0.4691
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3437 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.3369 - accuracy: 0.4805 3/11 [=======>......................] - ETA: 0s - loss: 0.3320 - accuracy: 0.4774 4/11 [=========>....................] - ETA: 0s - loss: 0.3279 - accuracy: 0.4821 5/11 [============>.................] - ETA: 0s - loss: 0.3264 - accuracy: 0.4819 6/11 [===============>..............] - ETA: 0s - loss: 0.3253 - accuracy: 0.4819 7/11 [==================>...........] - ETA: 0s - loss: 0.3244 - accuracy: 0.4811 8/11 [====================>.........] - ETA: 0s - loss: 0.3230 - accuracy: 0.4800 9/11 [=======================>......] - ETA: 0s - loss: 0.3219 - accuracy: 0.478710/11 [==========================>...] - ETA: 0s - loss: 0.3209 - accuracy: 0.477211/11 [==============================] - ETA: 0s - loss: 0.3201 - accuracy: 0.475911/11 [==============================] - 1s 103ms/step - loss: 0.3195 - accuracy: 0.4749
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2973 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 1s - loss: 0.2924 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.2883 - accuracy: 0.4557 4/11 [=========>....................] - ETA: 0s - loss: 0.2881 - accuracy: 0.4556 5/11 [============>.................] - ETA: 0s - loss: 0.2879 - accuracy: 0.4548 6/11 [===============>..............] - ETA: 0s - loss: 0.2872 - accuracy: 0.4543 7/11 [==================>...........] - ETA: 0s - loss: 0.2863 - accuracy: 0.4551 8/11 [====================>.........] - ETA: 0s - loss: 0.2852 - accuracy: 0.4571 9/11 [=======================>......] - ETA: 0s - loss: 0.2842 - accuracy: 0.459310/11 [==========================>...] - ETA: 0s - loss: 0.2830 - accuracy: 0.461311/11 [==============================] - ETA: 0s - loss: 0.2823 - accuracy: 0.462111/11 [==============================] - 1s 109ms/step - loss: 0.2817 - accuracy: 0.4628
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2675 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.2632 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.2611 - accuracy: 0.4905 4/11 [=========>....................] - ETA: 0s - loss: 0.2586 - accuracy: 0.4948 5/11 [============>.................] - ETA: 0s - loss: 0.2563 - accuracy: 0.4971 6/11 [===============>..............] - ETA: 0s - loss: 0.2545 - accuracy: 0.4978 7/11 [==================>...........] - ETA: 0s - loss: 0.2531 - accuracy: 0.4973 8/11 [====================>.........] - ETA: 0s - loss: 0.2521 - accuracy: 0.4968 9/11 [=======================>......] - ETA: 0s - loss: 0.2512 - accuracy: 0.496710/11 [==========================>...] - ETA: 0s - loss: 0.2502 - accuracy: 0.497211/11 [==============================] - ETA: 0s - loss: 0.2494 - accuracy: 0.497611/11 [==============================] - 1s 110ms/step - loss: 0.2487 - accuracy: 0.4980
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2313 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.2282 - accuracy: 0.5527 3/11 [=======>......................] - ETA: 0s - loss: 0.2253 - accuracy: 0.5629 4/11 [=========>....................] - ETA: 0s - loss: 0.2241 - accuracy: 0.5662 5/11 [============>.................] - ETA: 0s - loss: 0.2231 - accuracy: 0.5667 6/11 [===============>..............] - ETA: 0s - loss: 0.2221 - accuracy: 0.5671 7/11 [==================>...........] - ETA: 0s - loss: 0.2212 - accuracy: 0.5682 8/11 [====================>.........] - ETA: 0s - loss: 0.2204 - accuracy: 0.5693 9/11 [=======================>......] - ETA: 0s - loss: 0.2200 - accuracy: 0.570610/11 [==========================>...] - ETA: 0s - loss: 0.2198 - accuracy: 0.571211/11 [==============================] - ETA: 0s - loss: 0.2194 - accuracy: 0.572011/11 [==============================] - 1s 109ms/step - loss: 0.2191 - accuracy: 0.5726
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2330 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.2255 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 0s - loss: 0.2179 - accuracy: 0.5868 4/11 [=========>....................] - ETA: 0s - loss: 0.2145 - accuracy: 0.5905 5/11 [============>.................] - ETA: 0s - loss: 0.2130 - accuracy: 0.5915 6/11 [===============>..............] - ETA: 0s - loss: 0.2114 - accuracy: 0.5931 7/11 [==================>...........] - ETA: 0s - loss: 0.2096 - accuracy: 0.5926 8/11 [====================>.........] - ETA: 0s - loss: 0.2085 - accuracy: 0.5914 9/11 [=======================>......] - ETA: 0s - loss: 0.2074 - accuracy: 0.589510/11 [==========================>...] - ETA: 0s - loss: 0.2064 - accuracy: 0.587811/11 [==============================] - ETA: 0s - loss: 0.2054 - accuracy: 0.586811/11 [==============================] - 1s 102ms/step - loss: 0.2046 - accuracy: 0.5860
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2015 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 0s - loss: 0.1907 - accuracy: 0.5820 3/11 [=======>......................] - ETA: 0s - loss: 0.1877 - accuracy: 0.5877 4/11 [=========>....................] - ETA: 0s - loss: 0.1867 - accuracy: 0.5897 5/11 [============>.................] - ETA: 0s - loss: 0.1864 - accuracy: 0.5911 6/11 [===============>..............] - ETA: 0s - loss: 0.1863 - accuracy: 0.5916 7/11 [==================>...........] - ETA: 0s - loss: 0.1860 - accuracy: 0.5922 8/11 [====================>.........] - ETA: 0s - loss: 0.1857 - accuracy: 0.5918 9/11 [=======================>......] - ETA: 0s - loss: 0.1854 - accuracy: 0.591010/11 [==========================>...] - ETA: 0s - loss: 0.1851 - accuracy: 0.591611/11 [==============================] - ETA: 0s - loss: 0.1847 - accuracy: 0.592511/11 [==============================] - 1s 104ms/step - loss: 0.1844 - accuracy: 0.5933
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1703 - accuracy: 0.6094 2/11 [====>.........................] - ETA: 0s - loss: 0.1657 - accuracy: 0.6230 3/11 [=======>......................] - ETA: 0s - loss: 0.1662 - accuracy: 0.6272 4/11 [=========>....................] - ETA: 0s - loss: 0.1670 - accuracy: 0.6266 5/11 [============>.................] - ETA: 0s - loss: 0.1675 - accuracy: 0.6257 6/11 [===============>..............] - ETA: 0s - loss: 0.1680 - accuracy: 0.6266 7/11 [==================>...........] - ETA: 0s - loss: 0.1682 - accuracy: 0.6288 8/11 [====================>.........] - ETA: 0s - loss: 0.1682 - accuracy: 0.6314 9/11 [=======================>......] - ETA: 0s - loss: 0.1682 - accuracy: 0.634010/11 [==========================>...] - ETA: 0s - loss: 0.1682 - accuracy: 0.636311/11 [==============================] - ETA: 0s - loss: 0.1683 - accuracy: 0.638211/11 [==============================] - 1s 107ms/step - loss: 0.1684 - accuracy: 0.6397
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1745 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.1714 - accuracy: 0.6914 3/11 [=======>......................] - ETA: 0s - loss: 0.1705 - accuracy: 0.7023 4/11 [=========>....................] - ETA: 0s - loss: 0.1695 - accuracy: 0.7122 5/11 [============>.................] - ETA: 0s - loss: 0.1693 - accuracy: 0.7173 6/11 [===============>..............] - ETA: 0s - loss: 0.1686 - accuracy: 0.7206 7/11 [==================>...........] - ETA: 0s - loss: 0.1680 - accuracy: 0.7216 8/11 [====================>.........] - ETA: 0s - loss: 0.1675 - accuracy: 0.7201 9/11 [=======================>......] - ETA: 0s - loss: 0.1670 - accuracy: 0.717610/11 [==========================>...] - ETA: 0s - loss: 0.1665 - accuracy: 0.715911/11 [==============================] - ETA: 0s - loss: 0.1660 - accuracy: 0.714811/11 [==============================] - 1s 105ms/step - loss: 0.1657 - accuracy: 0.7139
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1445 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 1s - loss: 0.1475 - accuracy: 0.7930 3/11 [=======>......................] - ETA: 0s - loss: 0.1488 - accuracy: 0.7917 4/11 [=========>....................] - ETA: 0s - loss: 0.1496 - accuracy: 0.7930 5/11 [============>.................] - ETA: 0s - loss: 0.1499 - accuracy: 0.7950 6/11 [===============>..............] - ETA: 0s - loss: 0.1504 - accuracy: 0.7953 7/11 [==================>...........] - ETA: 0s - loss: 0.1506 - accuracy: 0.7943 8/11 [====================>.........] - ETA: 0s - loss: 0.1506 - accuracy: 0.7925 9/11 [=======================>......] - ETA: 0s - loss: 0.1508 - accuracy: 0.789710/11 [==========================>...] - ETA: 0s - loss: 0.1510 - accuracy: 0.787211/11 [==============================] - ETA: 0s - loss: 0.1511 - accuracy: 0.784511/11 [==============================] - 1s 108ms/step - loss: 0.1511 - accuracy: 0.7823
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1443 - accuracy: 0.7891 2/11 [====>.........................] - ETA: 0s - loss: 0.1483 - accuracy: 0.8066 3/11 [=======>......................] - ETA: 0s - loss: 0.1490 - accuracy: 0.8199 4/11 [=========>....................] - ETA: 0s - loss: 0.1496 - accuracy: 0.8293 5/11 [============>.................] - ETA: 0s - loss: 0.1503 - accuracy: 0.8353 6/11 [===============>..............] - ETA: 0s - loss: 0.1503 - accuracy: 0.8380 7/11 [==================>...........] - ETA: 0s - loss: 0.1502 - accuracy: 0.8387 8/11 [====================>.........] - ETA: 0s - loss: 0.1498 - accuracy: 0.8370 9/11 [=======================>......] - ETA: 0s - loss: 0.1493 - accuracy: 0.834510/11 [==========================>...] - ETA: 0s - loss: 0.1489 - accuracy: 0.831011/11 [==============================] - ETA: 0s - loss: 0.1485 - accuracy: 0.827111/11 [==============================] - 1s 108ms/step - loss: 0.1482 - accuracy: 0.8238
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1464 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.1462 - accuracy: 0.6699 3/11 [=======>......................] - ETA: 0s - loss: 0.1445 - accuracy: 0.6931 4/11 [=========>....................] - ETA: 0s - loss: 0.1430 - accuracy: 0.7113 5/11 [============>.................] - ETA: 0s - loss: 0.1411 - accuracy: 0.7271 6/11 [===============>..............] - ETA: 0s - loss: 0.1401 - accuracy: 0.7401 7/11 [==================>...........] - ETA: 0s - loss: 0.1389 - accuracy: 0.7498 8/11 [====================>.........] - ETA: 0s - loss: 0.1384 - accuracy: 0.7569 9/11 [=======================>......] - ETA: 0s - loss: 0.1382 - accuracy: 0.762310/11 [==========================>...] - ETA: 0s - loss: 0.1381 - accuracy: 0.766911/11 [==============================] - ETA: 0s - loss: 0.1380 - accuracy: 0.770811/11 [==============================] - 1s 107ms/step - loss: 0.1379 - accuracy: 0.7740
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1443 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 0s - loss: 0.1357 - accuracy: 0.7930 3/11 [=======>......................] - ETA: 0s - loss: 0.1336 - accuracy: 0.7908 4/11 [=========>....................] - ETA: 0s - loss: 0.1328 - accuracy: 0.7913 5/11 [============>.................] - ETA: 0s - loss: 0.1328 - accuracy: 0.7943 6/11 [===============>..............] - ETA: 0s - loss: 0.1329 - accuracy: 0.7982 7/11 [==================>...........] - ETA: 0s - loss: 0.1326 - accuracy: 0.8022 8/11 [====================>.........] - ETA: 0s - loss: 0.1322 - accuracy: 0.8055 9/11 [=======================>......] - ETA: 0s - loss: 0.1320 - accuracy: 0.808910/11 [==========================>...] - ETA: 0s - loss: 0.1318 - accuracy: 0.812611/11 [==============================] - ETA: 0s - loss: 0.1315 - accuracy: 0.815611/11 [==============================] - 1s 104ms/step - loss: 0.1313 - accuracy: 0.8182
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1540 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 0s - loss: 0.1452 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 0s - loss: 0.1418 - accuracy: 0.7977 4/11 [=========>....................] - ETA: 0s - loss: 0.1401 - accuracy: 0.8083 5/11 [============>.................] - ETA: 0s - loss: 0.1382 - accuracy: 0.8157 6/11 [===============>..............] - ETA: 0s - loss: 0.1373 - accuracy: 0.8201 7/11 [==================>...........] - ETA: 0s - loss: 0.1363 - accuracy: 0.8240 8/11 [====================>.........] - ETA: 0s - loss: 0.1351 - accuracy: 0.8271 9/11 [=======================>......] - ETA: 0s - loss: 0.1341 - accuracy: 0.829310/11 [==========================>...] - ETA: 0s - loss: 0.1331 - accuracy: 0.830811/11 [==============================] - ETA: 0s - loss: 0.1322 - accuracy: 0.831711/11 [==============================] - 1s 109ms/step - loss: 0.1314 - accuracy: 0.8324
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.1380 - accuracy: 0.87503/6 [==============>...............] - ETA: 0s - loss: 0.1336 - accuracy: 0.8464 5/6 [========================>.....] - ETA: 0s - loss: 0.1264 - accuracy: 0.85476/6 [==============================] - 4s 31ms/step - loss: 0.1238 - accuracy: 0.8584
2021-12-14 00:05:07.180402: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:05:07.181220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:05:07.181282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:05:07.181323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:05:07.181350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:05:07.181376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:05:07.181402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:05:07.181432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:05:07.181462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:05:07.181489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:05:07.182639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:05:07.182667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:05:07.182676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:05:07.182684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 0 2 1] pred: [0.07068607 0.01605338 0.0704419  0.55385506 0.31303835]
 Top predictions indices: [3 4] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [0.00742528 0.54643476 0.777412   0.01593763 0.00365412]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 3 0] pred: [0.0012919  0.02910298 0.970289   0.0052599  0.00902215]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.01248863 0.84729564 0.8286685  0.00732613 0.00299576]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 4 3 0] pred: [0.00106546 0.02617475 0.97338855 0.00569859 0.00934049]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.18008736 0.6765766  0.2895142  0.01111278 0.00779667]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [0.01238954 0.86251247 0.77872944 0.00764161 0.00247294]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [0 1 3 4 2] pred: [0.6322392  0.15785897 0.06259206 0.15382504 0.09799597]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [0.02183548 0.83770645 0.7731755  0.00740862 0.00342417]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [0.02223817 0.8326783  0.75591433 0.00817314 0.00333396]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [0.01133978 0.87666607 0.8048742  0.00824368 0.00264814]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 3 0] pred: [0.00152603 0.02190775 0.9710807  0.00686067 0.00964063]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 2 0 1] pred: [0.03825229 0.02644622 0.0623062  0.68498915 0.12472233]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [0 1 3 2 4] pred: [0.48153973 0.19079357 0.06983992 0.14093459 0.05819207]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 2 0 1] pred: [0.04700881 0.01581958 0.05715153 0.76977086 0.21632054]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:03 - loss: 0.6987 - accuracy: 0.2266 2/11 [====>.........................] - ETA: 1s - loss: 0.6974 - accuracy: 0.2383   3/11 [=======>......................] - ETA: 0s - loss: 0.6961 - accuracy: 0.2656 4/11 [=========>....................] - ETA: 0s - loss: 0.6949 - accuracy: 0.2827 5/11 [============>.................] - ETA: 0s - loss: 0.6936 - accuracy: 0.2946 6/11 [===============>..............] - ETA: 0s - loss: 0.6923 - accuracy: 0.3078 7/11 [==================>...........] - ETA: 0s - loss: 0.6910 - accuracy: 0.3188 8/11 [====================>.........] - ETA: 0s - loss: 0.6896 - accuracy: 0.3283 9/11 [=======================>......] - ETA: 0s - loss: 0.6883 - accuracy: 0.335910/11 [==========================>...] - ETA: 0s - loss: 0.6869 - accuracy: 0.342711/11 [==============================] - ETA: 0s - loss: 0.6856 - accuracy: 0.348811/11 [==============================] - 13s 110ms/step - loss: 0.6846 - accuracy: 0.3538
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6391 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 0s - loss: 0.6358 - accuracy: 0.4277 3/11 [=======>......................] - ETA: 0s - loss: 0.6330 - accuracy: 0.4353 4/11 [=========>....................] - ETA: 0s - loss: 0.6305 - accuracy: 0.4398 5/11 [============>.................] - ETA: 0s - loss: 0.6281 - accuracy: 0.4437 6/11 [===============>..............] - ETA: 0s - loss: 0.6258 - accuracy: 0.4448 7/11 [==================>...........] - ETA: 0s - loss: 0.6234 - accuracy: 0.4447 8/11 [====================>.........] - ETA: 0s - loss: 0.6208 - accuracy: 0.4458 9/11 [=======================>......] - ETA: 0s - loss: 0.6182 - accuracy: 0.446610/11 [==========================>...] - ETA: 0s - loss: 0.6154 - accuracy: 0.447311/11 [==============================] - ETA: 0s - loss: 0.6127 - accuracy: 0.447711/11 [==============================] - 1s 112ms/step - loss: 0.6104 - accuracy: 0.4481
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4684 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 1s - loss: 0.4661 - accuracy: 0.5449 3/11 [=======>......................] - ETA: 0s - loss: 0.4666 - accuracy: 0.5282 4/11 [=========>....................] - ETA: 0s - loss: 0.4674 - accuracy: 0.5129 5/11 [============>.................] - ETA: 0s - loss: 0.4673 - accuracy: 0.5012 6/11 [===============>..............] - ETA: 0s - loss: 0.4663 - accuracy: 0.4930 7/11 [==================>...........] - ETA: 0s - loss: 0.4643 - accuracy: 0.4879 8/11 [====================>.........] - ETA: 0s - loss: 0.4622 - accuracy: 0.4841 9/11 [=======================>......] - ETA: 0s - loss: 0.4600 - accuracy: 0.481510/11 [==========================>...] - ETA: 0s - loss: 0.4581 - accuracy: 0.478911/11 [==============================] - ETA: 0s - loss: 0.4567 - accuracy: 0.476411/11 [==============================] - 1s 108ms/step - loss: 0.4555 - accuracy: 0.4744
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4287 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.4307 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.4257 - accuracy: 0.4167 4/11 [=========>....................] - ETA: 0s - loss: 0.4223 - accuracy: 0.4229 5/11 [============>.................] - ETA: 0s - loss: 0.4188 - accuracy: 0.4289 6/11 [===============>..............] - ETA: 0s - loss: 0.4158 - accuracy: 0.4319 7/11 [==================>...........] - ETA: 0s - loss: 0.4131 - accuracy: 0.4341 8/11 [====================>.........] - ETA: 0s - loss: 0.4109 - accuracy: 0.4357 9/11 [=======================>......] - ETA: 0s - loss: 0.4088 - accuracy: 0.438010/11 [==========================>...] - ETA: 0s - loss: 0.4069 - accuracy: 0.439211/11 [==============================] - ETA: 0s - loss: 0.4052 - accuracy: 0.440411/11 [==============================] - 1s 108ms/step - loss: 0.4039 - accuracy: 0.4413
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3591 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.3667 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 0s - loss: 0.3721 - accuracy: 0.4527 4/11 [=========>....................] - ETA: 0s - loss: 0.3761 - accuracy: 0.4499 5/11 [============>.................] - ETA: 0s - loss: 0.3773 - accuracy: 0.4496 6/11 [===============>..............] - ETA: 0s - loss: 0.3777 - accuracy: 0.4495 7/11 [==================>...........] - ETA: 0s - loss: 0.3775 - accuracy: 0.4492 8/11 [====================>.........] - ETA: 0s - loss: 0.3775 - accuracy: 0.4486 9/11 [=======================>......] - ETA: 0s - loss: 0.3769 - accuracy: 0.448810/11 [==========================>...] - ETA: 0s - loss: 0.3765 - accuracy: 0.449011/11 [==============================] - ETA: 0s - loss: 0.3760 - accuracy: 0.449311/11 [==============================] - 1s 103ms/step - loss: 0.3755 - accuracy: 0.4495
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3448 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.3532 - accuracy: 0.4102 3/11 [=======>......................] - ETA: 0s - loss: 0.3591 - accuracy: 0.4071 4/11 [=========>....................] - ETA: 0s - loss: 0.3590 - accuracy: 0.4108 5/11 [============>.................] - ETA: 0s - loss: 0.3596 - accuracy: 0.4118 6/11 [===============>..............] - ETA: 0s - loss: 0.3593 - accuracy: 0.4143 7/11 [==================>...........] - ETA: 0s - loss: 0.3589 - accuracy: 0.4172 8/11 [====================>.........] - ETA: 0s - loss: 0.3584 - accuracy: 0.4199 9/11 [=======================>......] - ETA: 0s - loss: 0.3578 - accuracy: 0.422310/11 [==========================>...] - ETA: 0s - loss: 0.3571 - accuracy: 0.424411/11 [==============================] - ETA: 0s - loss: 0.3563 - accuracy: 0.426911/11 [==============================] - 1s 108ms/step - loss: 0.3557 - accuracy: 0.4290
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3225 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.3275 - accuracy: 0.4180 3/11 [=======>......................] - ETA: 0s - loss: 0.3277 - accuracy: 0.4184 4/11 [=========>....................] - ETA: 0s - loss: 0.3262 - accuracy: 0.4242 5/11 [============>.................] - ETA: 0s - loss: 0.3243 - accuracy: 0.4324 6/11 [===============>..............] - ETA: 0s - loss: 0.3232 - accuracy: 0.4383 7/11 [==================>...........] - ETA: 0s - loss: 0.3230 - accuracy: 0.4415 8/11 [====================>.........] - ETA: 0s - loss: 0.3225 - accuracy: 0.4442 9/11 [=======================>......] - ETA: 0s - loss: 0.3223 - accuracy: 0.445910/11 [==========================>...] - ETA: 0s - loss: 0.3220 - accuracy: 0.446711/11 [==============================] - ETA: 0s - loss: 0.3217 - accuracy: 0.447111/11 [==============================] - 1s 109ms/step - loss: 0.3215 - accuracy: 0.4475
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3078 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 0s - loss: 0.3081 - accuracy: 0.4277 3/11 [=======>......................] - ETA: 0s - loss: 0.3067 - accuracy: 0.4336 4/11 [=========>....................] - ETA: 0s - loss: 0.3041 - accuracy: 0.4360 5/11 [============>.................] - ETA: 0s - loss: 0.3023 - accuracy: 0.4360 6/11 [===============>..............] - ETA: 0s - loss: 0.2998 - accuracy: 0.4391 7/11 [==================>...........] - ETA: 0s - loss: 0.2978 - accuracy: 0.4420 8/11 [====================>.........] - ETA: 0s - loss: 0.2961 - accuracy: 0.4447 9/11 [=======================>......] - ETA: 0s - loss: 0.2949 - accuracy: 0.445710/11 [==========================>...] - ETA: 0s - loss: 0.2938 - accuracy: 0.446411/11 [==============================] - ETA: 0s - loss: 0.2926 - accuracy: 0.446811/11 [==============================] - 1s 106ms/step - loss: 0.2917 - accuracy: 0.4473
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2600 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 0s - loss: 0.2605 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.2589 - accuracy: 0.4870 4/11 [=========>....................] - ETA: 0s - loss: 0.2571 - accuracy: 0.4863 5/11 [============>.................] - ETA: 0s - loss: 0.2556 - accuracy: 0.4863 6/11 [===============>..............] - ETA: 0s - loss: 0.2549 - accuracy: 0.4872 7/11 [==================>...........] - ETA: 0s - loss: 0.2544 - accuracy: 0.4881 8/11 [====================>.........] - ETA: 0s - loss: 0.2537 - accuracy: 0.4896 9/11 [=======================>......] - ETA: 0s - loss: 0.2532 - accuracy: 0.490710/11 [==========================>...] - ETA: 0s - loss: 0.2524 - accuracy: 0.491411/11 [==============================] - ETA: 0s - loss: 0.2517 - accuracy: 0.492211/11 [==============================] - 1s 107ms/step - loss: 0.2511 - accuracy: 0.4929
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1977 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 0s - loss: 0.2064 - accuracy: 0.5566 3/11 [=======>......................] - ETA: 0s - loss: 0.2101 - accuracy: 0.5707 4/11 [=========>....................] - ETA: 0s - loss: 0.2140 - accuracy: 0.5770 5/11 [============>.................] - ETA: 0s - loss: 0.2167 - accuracy: 0.5772 6/11 [===============>..............] - ETA: 0s - loss: 0.2183 - accuracy: 0.5767 7/11 [==================>...........] - ETA: 0s - loss: 0.2193 - accuracy: 0.5753 8/11 [====================>.........] - ETA: 0s - loss: 0.2194 - accuracy: 0.5766 9/11 [=======================>......] - ETA: 0s - loss: 0.2194 - accuracy: 0.577910/11 [==========================>...] - ETA: 0s - loss: 0.2191 - accuracy: 0.579011/11 [==============================] - ETA: 0s - loss: 0.2187 - accuracy: 0.580111/11 [==============================] - 1s 106ms/step - loss: 0.2184 - accuracy: 0.5811
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2284 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.2192 - accuracy: 0.5371 3/11 [=======>......................] - ETA: 0s - loss: 0.2132 - accuracy: 0.5473 4/11 [=========>....................] - ETA: 0s - loss: 0.2086 - accuracy: 0.5511 5/11 [============>.................] - ETA: 0s - loss: 0.2061 - accuracy: 0.5531 6/11 [===============>..............] - ETA: 0s - loss: 0.2049 - accuracy: 0.5562 7/11 [==================>...........] - ETA: 0s - loss: 0.2037 - accuracy: 0.5596 8/11 [====================>.........] - ETA: 0s - loss: 0.2027 - accuracy: 0.5632 9/11 [=======================>......] - ETA: 0s - loss: 0.2017 - accuracy: 0.566410/11 [==========================>...] - ETA: 0s - loss: 0.2010 - accuracy: 0.568811/11 [==============================] - ETA: 0s - loss: 0.2004 - accuracy: 0.571011/11 [==============================] - 1s 108ms/step - loss: 0.1999 - accuracy: 0.5729
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1768 - accuracy: 0.5859 2/11 [====>.........................] - ETA: 0s - loss: 0.1754 - accuracy: 0.5840 3/11 [=======>......................] - ETA: 0s - loss: 0.1773 - accuracy: 0.5924 4/11 [=========>....................] - ETA: 0s - loss: 0.1801 - accuracy: 0.5957 5/11 [============>.................] - ETA: 0s - loss: 0.1819 - accuracy: 0.5994 6/11 [===============>..............] - ETA: 0s - loss: 0.1824 - accuracy: 0.6021 7/11 [==================>...........] - ETA: 0s - loss: 0.1829 - accuracy: 0.6030 8/11 [====================>.........] - ETA: 0s - loss: 0.1830 - accuracy: 0.6048 9/11 [=======================>......] - ETA: 0s - loss: 0.1830 - accuracy: 0.606310/11 [==========================>...] - ETA: 0s - loss: 0.1829 - accuracy: 0.608111/11 [==============================] - ETA: 0s - loss: 0.1826 - accuracy: 0.609911/11 [==============================] - 1s 107ms/step - loss: 0.1823 - accuracy: 0.6113
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1592 - accuracy: 0.6875 2/11 [====>.........................] - ETA: 0s - loss: 0.1599 - accuracy: 0.6680 3/11 [=======>......................] - ETA: 0s - loss: 0.1613 - accuracy: 0.6536 4/11 [=========>....................] - ETA: 0s - loss: 0.1622 - accuracy: 0.6475 5/11 [============>.................] - ETA: 0s - loss: 0.1632 - accuracy: 0.6408 6/11 [===============>..............] - ETA: 0s - loss: 0.1645 - accuracy: 0.6390 7/11 [==================>...........] - ETA: 0s - loss: 0.1655 - accuracy: 0.6383 8/11 [====================>.........] - ETA: 0s - loss: 0.1659 - accuracy: 0.6385 9/11 [=======================>......] - ETA: 0s - loss: 0.1663 - accuracy: 0.638510/11 [==========================>...] - ETA: 0s - loss: 0.1665 - accuracy: 0.639511/11 [==============================] - ETA: 0s - loss: 0.1665 - accuracy: 0.640511/11 [==============================] - 1s 106ms/step - loss: 0.1665 - accuracy: 0.6413
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1677 - accuracy: 0.7188 2/11 [====>.........................] - ETA: 0s - loss: 0.1646 - accuracy: 0.7227 3/11 [=======>......................] - ETA: 0s - loss: 0.1659 - accuracy: 0.7161 4/11 [=========>....................] - ETA: 0s - loss: 0.1665 - accuracy: 0.7144 5/11 [============>.................] - ETA: 0s - loss: 0.1653 - accuracy: 0.7143 6/11 [===============>..............] - ETA: 0s - loss: 0.1642 - accuracy: 0.7142 7/11 [==================>...........] - ETA: 0s - loss: 0.1635 - accuracy: 0.7129 8/11 [====================>.........] - ETA: 0s - loss: 0.1626 - accuracy: 0.7112 9/11 [=======================>......] - ETA: 0s - loss: 0.1622 - accuracy: 0.709610/11 [==========================>...] - ETA: 0s - loss: 0.1617 - accuracy: 0.709011/11 [==============================] - ETA: 0s - loss: 0.1613 - accuracy: 0.708311/11 [==============================] - 1s 106ms/step - loss: 0.1609 - accuracy: 0.7077
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1527 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 0s - loss: 0.1516 - accuracy: 0.7148 3/11 [=======>......................] - ETA: 0s - loss: 0.1522 - accuracy: 0.7179 4/11 [=========>....................] - ETA: 0s - loss: 0.1518 - accuracy: 0.7181 5/11 [============>.................] - ETA: 0s - loss: 0.1509 - accuracy: 0.7198 6/11 [===============>..............] - ETA: 0s - loss: 0.1500 - accuracy: 0.7216 7/11 [==================>...........] - ETA: 0s - loss: 0.1497 - accuracy: 0.7236 8/11 [====================>.........] - ETA: 0s - loss: 0.1493 - accuracy: 0.7261 9/11 [=======================>......] - ETA: 0s - loss: 0.1491 - accuracy: 0.727610/11 [==========================>...] - ETA: 0s - loss: 0.1489 - accuracy: 0.729211/11 [==============================] - ETA: 0s - loss: 0.1489 - accuracy: 0.730311/11 [==============================] - 1s 106ms/step - loss: 0.1489 - accuracy: 0.7312
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1143 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 0s - loss: 0.1203 - accuracy: 0.7559 3/11 [=======>......................] - ETA: 0s - loss: 0.1264 - accuracy: 0.7609 4/11 [=========>....................] - ETA: 0s - loss: 0.1297 - accuracy: 0.7674 5/11 [============>.................] - ETA: 0s - loss: 0.1318 - accuracy: 0.7714 6/11 [===============>..............] - ETA: 0s - loss: 0.1336 - accuracy: 0.7746 7/11 [==================>...........] - ETA: 0s - loss: 0.1346 - accuracy: 0.7763 8/11 [====================>.........] - ETA: 0s - loss: 0.1354 - accuracy: 0.7776 9/11 [=======================>......] - ETA: 0s - loss: 0.1361 - accuracy: 0.778510/11 [==========================>...] - ETA: 0s - loss: 0.1365 - accuracy: 0.778911/11 [==============================] - ETA: 0s - loss: 0.1369 - accuracy: 0.779111/11 [==============================] - 1s 103ms/step - loss: 0.1372 - accuracy: 0.7793
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1315 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.1361 - accuracy: 0.8066 3/11 [=======>......................] - ETA: 0s - loss: 0.1368 - accuracy: 0.8086 4/11 [=========>....................] - ETA: 0s - loss: 0.1359 - accuracy: 0.8101 5/11 [============>.................] - ETA: 0s - loss: 0.1354 - accuracy: 0.8090 6/11 [===============>..............] - ETA: 0s - loss: 0.1347 - accuracy: 0.8065 7/11 [==================>...........] - ETA: 0s - loss: 0.1343 - accuracy: 0.8048 8/11 [====================>.........] - ETA: 0s - loss: 0.1341 - accuracy: 0.8047 9/11 [=======================>......] - ETA: 0s - loss: 0.1340 - accuracy: 0.804410/11 [==========================>...] - ETA: 0s - loss: 0.1340 - accuracy: 0.804311/11 [==============================] - ETA: 0s - loss: 0.1339 - accuracy: 0.804211/11 [==============================] - 1s 109ms/step - loss: 0.1339 - accuracy: 0.8041
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1262 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 0s - loss: 0.1300 - accuracy: 0.8418 3/11 [=======>......................] - ETA: 0s - loss: 0.1303 - accuracy: 0.8234 4/11 [=========>....................] - ETA: 0s - loss: 0.1308 - accuracy: 0.8182 5/11 [============>.................] - ETA: 0s - loss: 0.1307 - accuracy: 0.8171 6/11 [===============>..............] - ETA: 0s - loss: 0.1304 - accuracy: 0.8183 7/11 [==================>...........] - ETA: 0s - loss: 0.1303 - accuracy: 0.8185 8/11 [====================>.........] - ETA: 0s - loss: 0.1304 - accuracy: 0.8189 9/11 [=======================>......] - ETA: 0s - loss: 0.1305 - accuracy: 0.819210/11 [==========================>...] - ETA: 0s - loss: 0.1304 - accuracy: 0.819411/11 [==============================] - ETA: 0s - loss: 0.1301 - accuracy: 0.819811/11 [==============================] - 1s 110ms/step - loss: 0.1299 - accuracy: 0.8200
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1241 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 0s - loss: 0.1277 - accuracy: 0.8457 3/11 [=======>......................] - ETA: 0s - loss: 0.1263 - accuracy: 0.8442 4/11 [=========>....................] - ETA: 0s - loss: 0.1255 - accuracy: 0.8470 5/11 [============>.................] - ETA: 0s - loss: 0.1255 - accuracy: 0.8485 6/11 [===============>..............] - ETA: 0s - loss: 0.1256 - accuracy: 0.8495 7/11 [==================>...........] - ETA: 0s - loss: 0.1255 - accuracy: 0.8498 8/11 [====================>.........] - ETA: 0s - loss: 0.1254 - accuracy: 0.8504 9/11 [=======================>......] - ETA: 0s - loss: 0.1252 - accuracy: 0.850910/11 [==========================>...] - ETA: 0s - loss: 0.1250 - accuracy: 0.851111/11 [==============================] - ETA: 0s - loss: 0.1247 - accuracy: 0.851211/11 [==============================] - 1s 106ms/step - loss: 0.1245 - accuracy: 0.8513
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1218 - accuracy: 0.8359 2/11 [====>.........................] - ETA: 0s - loss: 0.1199 - accuracy: 0.8457 3/11 [=======>......................] - ETA: 0s - loss: 0.1200 - accuracy: 0.8477 4/11 [=========>....................] - ETA: 0s - loss: 0.1207 - accuracy: 0.8462 5/11 [============>.................] - ETA: 0s - loss: 0.1209 - accuracy: 0.8457 6/11 [===============>..............] - ETA: 0s - loss: 0.1210 - accuracy: 0.8458 7/11 [==================>...........] - ETA: 0s - loss: 0.1206 - accuracy: 0.8457 8/11 [====================>.........] - ETA: 0s - loss: 0.1202 - accuracy: 0.8463 9/11 [=======================>......] - ETA: 0s - loss: 0.1198 - accuracy: 0.846210/11 [==========================>...] - ETA: 0s - loss: 0.1193 - accuracy: 0.846711/11 [==============================] - ETA: 0s - loss: 0.1190 - accuracy: 0.847411/11 [==============================] - 1s 108ms/step - loss: 0.1186 - accuracy: 0.8480
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.1086 - accuracy: 0.86723/6 [==============>...............] - ETA: 0s - loss: 0.1120 - accuracy: 0.8802 5/6 [========================>.....] - ETA: 0s - loss: 0.1180 - accuracy: 0.87506/6 [==============================] - 4s 30ms/step - loss: 0.1193 - accuracy: 0.8754
2021-12-14 00:05:55.396821: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:05:55.397798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:05:55.397856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:05:55.397907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:05:55.397943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:05:55.397978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:05:55.398012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:05:55.398050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:05:55.398093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:05:55.398129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:05:55.399533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:05:55.399568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:05:55.399580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:05:55.399590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [1.6820431e-04 2.0413846e-02 9.7441310e-01 9.1008842e-03 6.8071187e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [2.2053719e-04 2.6111662e-02 9.6876323e-01 8.5981786e-03 6.5136254e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 4 3] pred: [0.02713716 0.9090531  0.7235563  0.00359789 0.00713539]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [1.6897917e-04 2.0454973e-02 9.7435093e-01 9.0865493e-03 6.7940950e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [3 4 2 0 1] pred: [0.0435057  0.00362986 0.05008277 0.8528703  0.11914909]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 4 0] pred: [1.6918778e-04 2.0430952e-02 9.7408015e-01 9.1558397e-03 6.7711771e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 2 0 1] pred: [0.03873092 0.00388846 0.04791221 0.85919    0.10870278]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [1.9678473e-04 2.4042547e-02 9.7092623e-01 8.9884698e-03 6.5760016e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [0.00858518 0.42742786 0.6589159  0.01403573 0.005546  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [1.6856194e-04 2.0421326e-02 9.7432101e-01 9.1238320e-03 6.7983866e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 4 3] pred: [0.01206201 0.8823255  0.8545288  0.00251317 0.00574976]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [1.6823411e-04 2.0418137e-02 9.7440696e-01 9.0988874e-03 6.8059266e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 4 3] pred: [0.01491749 0.8927379  0.830408   0.00266445 0.00623402]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [1.8277764e-04 2.1926075e-02 9.7273171e-01 8.9868307e-03 6.6909194e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 4 3] pred: [0.02369988 0.8911733  0.7582564  0.00353298 0.00672358]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:03 - loss: 0.6991 - accuracy: 0.2891 2/11 [====>.........................] - ETA: 0s - loss: 0.6977 - accuracy: 0.3418   3/11 [=======>......................] - ETA: 0s - loss: 0.6964 - accuracy: 0.3676 4/11 [=========>....................] - ETA: 0s - loss: 0.6952 - accuracy: 0.3826 5/11 [============>.................] - ETA: 0s - loss: 0.6938 - accuracy: 0.3936 6/11 [===============>..............] - ETA: 0s - loss: 0.6924 - accuracy: 0.4042 7/11 [==================>...........] - ETA: 0s - loss: 0.6910 - accuracy: 0.4126 8/11 [====================>.........] - ETA: 0s - loss: 0.6896 - accuracy: 0.4177 9/11 [=======================>......] - ETA: 0s - loss: 0.6882 - accuracy: 0.421710/11 [==========================>...] - ETA: 0s - loss: 0.6869 - accuracy: 0.424411/11 [==============================] - ETA: 0s - loss: 0.6856 - accuracy: 0.426611/11 [==============================] - 13s 112ms/step - loss: 0.6846 - accuracy: 0.4285
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6356 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.6345 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 0s - loss: 0.6329 - accuracy: 0.4709 4/11 [=========>....................] - ETA: 0s - loss: 0.6309 - accuracy: 0.4718 5/11 [============>.................] - ETA: 0s - loss: 0.6290 - accuracy: 0.4731 6/11 [===============>..............] - ETA: 0s - loss: 0.6268 - accuracy: 0.4739 7/11 [==================>...........] - ETA: 0s - loss: 0.6247 - accuracy: 0.4738 8/11 [====================>.........] - ETA: 0s - loss: 0.6224 - accuracy: 0.4733 9/11 [=======================>......] - ETA: 0s - loss: 0.6200 - accuracy: 0.472410/11 [==========================>...] - ETA: 0s - loss: 0.6176 - accuracy: 0.471011/11 [==============================] - ETA: 0s - loss: 0.6153 - accuracy: 0.470211/11 [==============================] - 1s 107ms/step - loss: 0.6133 - accuracy: 0.4695
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4961 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 0s - loss: 0.4962 - accuracy: 0.4941 3/11 [=======>......................] - ETA: 0s - loss: 0.4932 - accuracy: 0.4839 4/11 [=========>....................] - ETA: 0s - loss: 0.4897 - accuracy: 0.4801 5/11 [============>.................] - ETA: 0s - loss: 0.4852 - accuracy: 0.4766 6/11 [===============>..............] - ETA: 0s - loss: 0.4814 - accuracy: 0.4725 7/11 [==================>...........] - ETA: 0s - loss: 0.4774 - accuracy: 0.4700 8/11 [====================>.........] - ETA: 0s - loss: 0.4727 - accuracy: 0.4696 9/11 [=======================>......] - ETA: 0s - loss: 0.4681 - accuracy: 0.469810/11 [==========================>...] - ETA: 0s - loss: 0.4640 - accuracy: 0.469911/11 [==============================] - ETA: 0s - loss: 0.4615 - accuracy: 0.469211/11 [==============================] - 1s 110ms/step - loss: 0.4594 - accuracy: 0.4686
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3477 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.3764 - accuracy: 0.5215 3/11 [=======>......................] - ETA: 0s - loss: 0.3855 - accuracy: 0.5039 4/11 [=========>....................] - ETA: 0s - loss: 0.3928 - accuracy: 0.4897 5/11 [============>.................] - ETA: 0s - loss: 0.3939 - accuracy: 0.4830 6/11 [===============>..............] - ETA: 0s - loss: 0.3949 - accuracy: 0.4781 7/11 [==================>...........] - ETA: 0s - loss: 0.3950 - accuracy: 0.4747 8/11 [====================>.........] - ETA: 0s - loss: 0.3950 - accuracy: 0.4722 9/11 [=======================>......] - ETA: 0s - loss: 0.3947 - accuracy: 0.470510/11 [==========================>...] - ETA: 0s - loss: 0.3941 - accuracy: 0.469911/11 [==============================] - ETA: 0s - loss: 0.3937 - accuracy: 0.469211/11 [==============================] - 1s 108ms/step - loss: 0.3933 - accuracy: 0.4686
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3494 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 1s - loss: 0.3569 - accuracy: 0.5215 3/11 [=======>......................] - ETA: 0s - loss: 0.3646 - accuracy: 0.5039 4/11 [=========>....................] - ETA: 0s - loss: 0.3689 - accuracy: 0.4946 5/11 [============>.................] - ETA: 0s - loss: 0.3723 - accuracy: 0.4870 6/11 [===============>..............] - ETA: 0s - loss: 0.3745 - accuracy: 0.4817 7/11 [==================>...........] - ETA: 0s - loss: 0.3758 - accuracy: 0.4788 8/11 [====================>.........] - ETA: 0s - loss: 0.3767 - accuracy: 0.4765 9/11 [=======================>......] - ETA: 0s - loss: 0.3771 - accuracy: 0.475110/11 [==========================>...] - ETA: 0s - loss: 0.3772 - accuracy: 0.474411/11 [==============================] - ETA: 0s - loss: 0.3773 - accuracy: 0.473311/11 [==============================] - 1s 110ms/step - loss: 0.3773 - accuracy: 0.4723
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3818 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 1s - loss: 0.3795 - accuracy: 0.4316 3/11 [=======>......................] - ETA: 0s - loss: 0.3807 - accuracy: 0.4353 4/11 [=========>....................] - ETA: 0s - loss: 0.3808 - accuracy: 0.4412 5/11 [============>.................] - ETA: 0s - loss: 0.3796 - accuracy: 0.4455 6/11 [===============>..............] - ETA: 0s - loss: 0.3785 - accuracy: 0.4485 7/11 [==================>...........] - ETA: 0s - loss: 0.3775 - accuracy: 0.4504 8/11 [====================>.........] - ETA: 0s - loss: 0.3766 - accuracy: 0.4519 9/11 [=======================>......] - ETA: 0s - loss: 0.3760 - accuracy: 0.452510/11 [==========================>...] - ETA: 0s - loss: 0.3750 - accuracy: 0.453311/11 [==============================] - ETA: 0s - loss: 0.3739 - accuracy: 0.454111/11 [==============================] - 1s 109ms/step - loss: 0.3730 - accuracy: 0.4548
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3316 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.3339 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.3363 - accuracy: 0.4861 4/11 [=========>....................] - ETA: 0s - loss: 0.3367 - accuracy: 0.4852 5/11 [============>.................] - ETA: 0s - loss: 0.3384 - accuracy: 0.4822 6/11 [===============>..............] - ETA: 0s - loss: 0.3396 - accuracy: 0.4793 7/11 [==================>...........] - ETA: 0s - loss: 0.3401 - accuracy: 0.4780 8/11 [====================>.........] - ETA: 0s - loss: 0.3407 - accuracy: 0.4773 9/11 [=======================>......] - ETA: 0s - loss: 0.3412 - accuracy: 0.476410/11 [==========================>...] - ETA: 0s - loss: 0.3413 - accuracy: 0.475211/11 [==============================] - ETA: 0s - loss: 0.3415 - accuracy: 0.474011/11 [==============================] - 1s 106ms/step - loss: 0.3416 - accuracy: 0.4730
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3292 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.3266 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.3263 - accuracy: 0.4714 4/11 [=========>....................] - ETA: 0s - loss: 0.3277 - accuracy: 0.4702 5/11 [============>.................] - ETA: 0s - loss: 0.3280 - accuracy: 0.4702 6/11 [===============>..............] - ETA: 0s - loss: 0.3272 - accuracy: 0.4715 7/11 [==================>...........] - ETA: 0s - loss: 0.3271 - accuracy: 0.4714 8/11 [====================>.........] - ETA: 0s - loss: 0.3266 - accuracy: 0.4710 9/11 [=======================>......] - ETA: 0s - loss: 0.3259 - accuracy: 0.470910/11 [==========================>...] - ETA: 0s - loss: 0.3255 - accuracy: 0.470411/11 [==============================] - ETA: 0s - loss: 0.3252 - accuracy: 0.469611/11 [==============================] - 1s 107ms/step - loss: 0.3250 - accuracy: 0.4690
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3136 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 0s - loss: 0.3167 - accuracy: 0.4395 3/11 [=======>......................] - ETA: 0s - loss: 0.3123 - accuracy: 0.4510 4/11 [=========>....................] - ETA: 0s - loss: 0.3109 - accuracy: 0.4510 5/11 [============>.................] - ETA: 0s - loss: 0.3116 - accuracy: 0.4461 6/11 [===============>..............] - ETA: 0s - loss: 0.3113 - accuracy: 0.4456 7/11 [==================>...........] - ETA: 0s - loss: 0.3109 - accuracy: 0.4458 8/11 [====================>.........] - ETA: 0s - loss: 0.3107 - accuracy: 0.4463 9/11 [=======================>......] - ETA: 0s - loss: 0.3099 - accuracy: 0.447910/11 [==========================>...] - ETA: 0s - loss: 0.3090 - accuracy: 0.449411/11 [==============================] - ETA: 0s - loss: 0.3082 - accuracy: 0.450511/11 [==============================] - 1s 111ms/step - loss: 0.3075 - accuracy: 0.4515
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2956 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.2912 - accuracy: 0.4395 3/11 [=======>......................] - ETA: 0s - loss: 0.2930 - accuracy: 0.4371 4/11 [=========>....................] - ETA: 0s - loss: 0.2919 - accuracy: 0.4416 5/11 [============>.................] - ETA: 0s - loss: 0.2907 - accuracy: 0.4445 6/11 [===============>..............] - ETA: 0s - loss: 0.2894 - accuracy: 0.4462 7/11 [==================>...........] - ETA: 0s - loss: 0.2884 - accuracy: 0.4480 8/11 [====================>.........] - ETA: 0s - loss: 0.2872 - accuracy: 0.4503 9/11 [=======================>......] - ETA: 0s - loss: 0.2865 - accuracy: 0.451910/11 [==========================>...] - ETA: 0s - loss: 0.2857 - accuracy: 0.453011/11 [==============================] - ETA: 0s - loss: 0.2849 - accuracy: 0.454411/11 [==============================] - 1s 105ms/step - loss: 0.2842 - accuracy: 0.4556
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2589 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.2619 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 0s - loss: 0.2623 - accuracy: 0.4740 4/11 [=========>....................] - ETA: 0s - loss: 0.2619 - accuracy: 0.4761 5/11 [============>.................] - ETA: 0s - loss: 0.2610 - accuracy: 0.4784 6/11 [===============>..............] - ETA: 0s - loss: 0.2603 - accuracy: 0.4791 7/11 [==================>...........] - ETA: 0s - loss: 0.2597 - accuracy: 0.4807 8/11 [====================>.........] - ETA: 0s - loss: 0.2594 - accuracy: 0.4812 9/11 [=======================>......] - ETA: 0s - loss: 0.2591 - accuracy: 0.481510/11 [==========================>...] - ETA: 0s - loss: 0.2587 - accuracy: 0.482511/11 [==============================] - ETA: 0s - loss: 0.2583 - accuracy: 0.483611/11 [==============================] - 1s 113ms/step - loss: 0.2580 - accuracy: 0.4846
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2343 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.2368 - accuracy: 0.5449 3/11 [=======>......................] - ETA: 1s - loss: 0.2375 - accuracy: 0.5499 4/11 [=========>....................] - ETA: 0s - loss: 0.2375 - accuracy: 0.5535 5/11 [============>.................] - ETA: 0s - loss: 0.2371 - accuracy: 0.5532 6/11 [===============>..............] - ETA: 0s - loss: 0.2369 - accuracy: 0.5515 7/11 [==================>...........] - ETA: 0s - loss: 0.2370 - accuracy: 0.5521 8/11 [====================>.........] - ETA: 0s - loss: 0.2371 - accuracy: 0.5528 9/11 [=======================>......] - ETA: 0s - loss: 0.2371 - accuracy: 0.552210/11 [==========================>...] - ETA: 0s - loss: 0.2367 - accuracy: 0.552011/11 [==============================] - ETA: 0s - loss: 0.2363 - accuracy: 0.552011/11 [==============================] - 1s 113ms/step - loss: 0.2360 - accuracy: 0.5521
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2405 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 0s - loss: 0.2333 - accuracy: 0.5645 3/11 [=======>......................] - ETA: 0s - loss: 0.2264 - accuracy: 0.5681 4/11 [=========>....................] - ETA: 0s - loss: 0.2228 - accuracy: 0.5726 5/11 [============>.................] - ETA: 0s - loss: 0.2203 - accuracy: 0.5753 6/11 [===============>..............] - ETA: 0s - loss: 0.2186 - accuracy: 0.5764 7/11 [==================>...........] - ETA: 0s - loss: 0.2174 - accuracy: 0.5763 8/11 [====================>.........] - ETA: 0s - loss: 0.2165 - accuracy: 0.5759 9/11 [=======================>......] - ETA: 0s - loss: 0.2159 - accuracy: 0.574310/11 [==========================>...] - ETA: 0s - loss: 0.2155 - accuracy: 0.572511/11 [==============================] - ETA: 0s - loss: 0.2151 - accuracy: 0.571211/11 [==============================] - 1s 109ms/step - loss: 0.2148 - accuracy: 0.5701
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1947 - accuracy: 0.5859 2/11 [====>.........................] - ETA: 1s - loss: 0.1934 - accuracy: 0.5801 3/11 [=======>......................] - ETA: 0s - loss: 0.1924 - accuracy: 0.5751 4/11 [=========>....................] - ETA: 0s - loss: 0.1938 - accuracy: 0.5666 5/11 [============>.................] - ETA: 0s - loss: 0.1945 - accuracy: 0.5617 6/11 [===============>..............] - ETA: 0s - loss: 0.1946 - accuracy: 0.5594 7/11 [==================>...........] - ETA: 0s - loss: 0.1946 - accuracy: 0.5591 8/11 [====================>.........] - ETA: 0s - loss: 0.1943 - accuracy: 0.5594 9/11 [=======================>......] - ETA: 0s - loss: 0.1942 - accuracy: 0.559310/11 [==========================>...] - ETA: 0s - loss: 0.1941 - accuracy: 0.559411/11 [==============================] - ETA: 0s - loss: 0.1940 - accuracy: 0.559811/11 [==============================] - 1s 109ms/step - loss: 0.1939 - accuracy: 0.5601
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1736 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 0s - loss: 0.1783 - accuracy: 0.6133 3/11 [=======>......................] - ETA: 0s - loss: 0.1811 - accuracy: 0.6068 4/11 [=========>....................] - ETA: 0s - loss: 0.1826 - accuracy: 0.6030 5/11 [============>.................] - ETA: 0s - loss: 0.1835 - accuracy: 0.6009 6/11 [===============>..............] - ETA: 0s - loss: 0.1831 - accuracy: 0.6012 7/11 [==================>...........] - ETA: 0s - loss: 0.1830 - accuracy: 0.6006 8/11 [====================>.........] - ETA: 0s - loss: 0.1827 - accuracy: 0.6005 9/11 [=======================>......] - ETA: 0s - loss: 0.1822 - accuracy: 0.600210/11 [==========================>...] - ETA: 0s - loss: 0.1816 - accuracy: 0.600711/11 [==============================] - ETA: 0s - loss: 0.1812 - accuracy: 0.601111/11 [==============================] - 1s 107ms/step - loss: 0.1809 - accuracy: 0.6014
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1557 - accuracy: 0.7891 2/11 [====>.........................] - ETA: 0s - loss: 0.1667 - accuracy: 0.7852 3/11 [=======>......................] - ETA: 0s - loss: 0.1686 - accuracy: 0.7908 4/11 [=========>....................] - ETA: 0s - loss: 0.1705 - accuracy: 0.7918 5/11 [============>.................] - ETA: 0s - loss: 0.1713 - accuracy: 0.7919 6/11 [===============>..............] - ETA: 0s - loss: 0.1714 - accuracy: 0.7882 7/11 [==================>...........] - ETA: 0s - loss: 0.1717 - accuracy: 0.7821 8/11 [====================>.........] - ETA: 0s - loss: 0.1717 - accuracy: 0.7748 9/11 [=======================>......] - ETA: 0s - loss: 0.1715 - accuracy: 0.768210/11 [==========================>...] - ETA: 0s - loss: 0.1712 - accuracy: 0.761311/11 [==============================] - ETA: 0s - loss: 0.1709 - accuracy: 0.755611/11 [==============================] - 1s 108ms/step - loss: 0.1706 - accuracy: 0.7508
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1596 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 1s - loss: 0.1593 - accuracy: 0.6406 3/11 [=======>......................] - ETA: 1s - loss: 0.1565 - accuracy: 0.6510 4/11 [=========>....................] - ETA: 0s - loss: 0.1548 - accuracy: 0.6548 5/11 [============>.................] - ETA: 0s - loss: 0.1544 - accuracy: 0.6613 6/11 [===============>..............] - ETA: 0s - loss: 0.1542 - accuracy: 0.6689 7/11 [==================>...........] - ETA: 0s - loss: 0.1537 - accuracy: 0.6757 8/11 [====================>.........] - ETA: 0s - loss: 0.1532 - accuracy: 0.6805 9/11 [=======================>......] - ETA: 0s - loss: 0.1529 - accuracy: 0.683410/11 [==========================>...] - ETA: 0s - loss: 0.1527 - accuracy: 0.685011/11 [==============================] - ETA: 0s - loss: 0.1527 - accuracy: 0.686211/11 [==============================] - 1s 110ms/step - loss: 0.1527 - accuracy: 0.6872
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1094 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 0s - loss: 0.1160 - accuracy: 0.8691 3/11 [=======>......................] - ETA: 0s - loss: 0.1203 - accuracy: 0.8702 4/11 [=========>....................] - ETA: 0s - loss: 0.1232 - accuracy: 0.8665 5/11 [============>.................] - ETA: 0s - loss: 0.1257 - accuracy: 0.8629 6/11 [===============>..............] - ETA: 0s - loss: 0.1281 - accuracy: 0.8593 7/11 [==================>...........] - ETA: 0s - loss: 0.1298 - accuracy: 0.8563 8/11 [====================>.........] - ETA: 0s - loss: 0.1310 - accuracy: 0.8530 9/11 [=======================>......] - ETA: 0s - loss: 0.1321 - accuracy: 0.851410/11 [==========================>...] - ETA: 0s - loss: 0.1329 - accuracy: 0.850211/11 [==============================] - ETA: 0s - loss: 0.1336 - accuracy: 0.849211/11 [==============================] - 1s 104ms/step - loss: 0.1342 - accuracy: 0.8485
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1384 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 0s - loss: 0.1359 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 0s - loss: 0.1351 - accuracy: 0.8637 4/11 [=========>....................] - ETA: 0s - loss: 0.1351 - accuracy: 0.8626 5/11 [============>.................] - ETA: 0s - loss: 0.1350 - accuracy: 0.8614 6/11 [===============>..............] - ETA: 0s - loss: 0.1348 - accuracy: 0.8610 7/11 [==================>...........] - ETA: 0s - loss: 0.1345 - accuracy: 0.8602 8/11 [====================>.........] - ETA: 0s - loss: 0.1340 - accuracy: 0.8599 9/11 [=======================>......] - ETA: 0s - loss: 0.1335 - accuracy: 0.860010/11 [==========================>...] - ETA: 0s - loss: 0.1331 - accuracy: 0.859811/11 [==============================] - ETA: 0s - loss: 0.1328 - accuracy: 0.859611/11 [==============================] - 1s 107ms/step - loss: 0.1325 - accuracy: 0.8594
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1225 - accuracy: 0.8516 2/11 [====>.........................] - ETA: 0s - loss: 0.1194 - accuracy: 0.8652 3/11 [=======>......................] - ETA: 0s - loss: 0.1193 - accuracy: 0.8711 4/11 [=========>....................] - ETA: 0s - loss: 0.1198 - accuracy: 0.8745 5/11 [============>.................] - ETA: 0s - loss: 0.1205 - accuracy: 0.8743 6/11 [===============>..............] - ETA: 0s - loss: 0.1211 - accuracy: 0.8744 7/11 [==================>...........] - ETA: 0s - loss: 0.1211 - accuracy: 0.8737 8/11 [====================>.........] - ETA: 0s - loss: 0.1210 - accuracy: 0.8729 9/11 [=======================>......] - ETA: 0s - loss: 0.1209 - accuracy: 0.871710/11 [==========================>...] - ETA: 0s - loss: 0.1207 - accuracy: 0.871011/11 [==============================] - ETA: 0s - loss: 0.1207 - accuracy: 0.870611/11 [==============================] - 1s 106ms/step - loss: 0.1207 - accuracy: 0.8702
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.1391 - accuracy: 0.91413/6 [==============>...............] - ETA: 0s - loss: 0.1331 - accuracy: 0.8854 5/6 [========================>.....] - ETA: 0s - loss: 0.1297 - accuracy: 0.88286/6 [==============================] - 4s 30ms/step - loss: 0.1272 - accuracy: 0.8867
2021-12-14 00:06:43.896758: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:06:43.897584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:06:43.897631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:06:43.897671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:06:43.897698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:06:43.897724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:06:43.897749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:06:43.897775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:06:43.897800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:06:43.897827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:06:43.898993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:06:43.899020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:06:43.899030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:06:43.899037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [0.00167498 0.04939792 0.9590247  0.00291872 0.00238395]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 2 0 1] pred: [0.04961553 0.04862863 0.05418068 0.7712878  0.14211398]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [0.01166075 0.75618124 0.8483594  0.00514829 0.00487581]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 2 0 1] pred: [0.04120252 0.02658772 0.07495159 0.6868132  0.14107922]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [0.01481411 0.8470211  0.775156   0.00802371 0.00560674]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.02231371 0.9060297  0.69613063 0.01343024 0.00845248]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [0.01515999 0.89637184 0.79050535 0.00988773 0.00602829]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 0 2 1] pred: [0.15616694 0.02712268 0.08550781 0.55384076 0.45230037]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 4 3] pred: [0.06393927 0.795794   0.5255665  0.01352662 0.01616207]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 4 3 0] pred: [0.00182346 0.03060713 0.9689562  0.00214911 0.00224981]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [0.00180721 0.26899546 0.9206652  0.00652298 0.00246227]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 3 0] pred: [0.00183642 0.03075841 0.96872556 0.00216836 0.00228417]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 3 0] pred: [0.00182363 0.03060135 0.96895266 0.00214785 0.00224727]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 3 0] pred: [0.00194326 0.03329048 0.9671669  0.00224623 0.00241885]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [0 1 2 3 4] pred: [0.5423838  0.2696243  0.12739706 0.09599212 0.08323622]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:04 - loss: 0.6888 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.6873 - accuracy: 0.4961   3/11 [=======>......................] - ETA: 0s - loss: 0.6859 - accuracy: 0.4852 4/11 [=========>....................] - ETA: 0s - loss: 0.6844 - accuracy: 0.4772 5/11 [============>.................] - ETA: 0s - loss: 0.6829 - accuracy: 0.4733 6/11 [===============>..............] - ETA: 0s - loss: 0.6813 - accuracy: 0.4713 7/11 [==================>...........] - ETA: 0s - loss: 0.6797 - accuracy: 0.4688 8/11 [====================>.........] - ETA: 0s - loss: 0.6780 - accuracy: 0.4676 9/11 [=======================>......] - ETA: 0s - loss: 0.6762 - accuracy: 0.466910/11 [==========================>...] - ETA: 0s - loss: 0.6745 - accuracy: 0.465411/11 [==============================] - ETA: 0s - loss: 0.6727 - accuracy: 0.464411/11 [==============================] - 14s 110ms/step - loss: 0.6713 - accuracy: 0.4636
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5973 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.5944 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 0s - loss: 0.5906 - accuracy: 0.4648 4/11 [=========>....................] - ETA: 0s - loss: 0.5869 - accuracy: 0.4609 5/11 [============>.................] - ETA: 0s - loss: 0.5836 - accuracy: 0.4547 6/11 [===============>..............] - ETA: 0s - loss: 0.5799 - accuracy: 0.4512 7/11 [==================>...........] - ETA: 0s - loss: 0.5762 - accuracy: 0.4489 8/11 [====================>.........] - ETA: 0s - loss: 0.5719 - accuracy: 0.4491 9/11 [=======================>......] - ETA: 0s - loss: 0.5677 - accuracy: 0.448510/11 [==========================>...] - ETA: 0s - loss: 0.5633 - accuracy: 0.448811/11 [==============================] - ETA: 0s - loss: 0.5591 - accuracy: 0.449211/11 [==============================] - 1s 106ms/step - loss: 0.5556 - accuracy: 0.4496
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4110 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.4159 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 0s - loss: 0.4161 - accuracy: 0.4544 4/11 [=========>....................] - ETA: 0s - loss: 0.4152 - accuracy: 0.4512 5/11 [============>.................] - ETA: 0s - loss: 0.4142 - accuracy: 0.4497 6/11 [===============>..............] - ETA: 0s - loss: 0.4133 - accuracy: 0.4483 7/11 [==================>...........] - ETA: 0s - loss: 0.4123 - accuracy: 0.4474 8/11 [====================>.........] - ETA: 0s - loss: 0.4110 - accuracy: 0.4474 9/11 [=======================>......] - ETA: 0s - loss: 0.4099 - accuracy: 0.447310/11 [==========================>...] - ETA: 0s - loss: 0.4085 - accuracy: 0.447711/11 [==============================] - ETA: 0s - loss: 0.4070 - accuracy: 0.448311/11 [==============================] - 1s 104ms/step - loss: 0.4058 - accuracy: 0.4487
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3542 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.3570 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3597 - accuracy: 0.4540 4/11 [=========>....................] - ETA: 0s - loss: 0.3639 - accuracy: 0.4572 5/11 [============>.................] - ETA: 0s - loss: 0.3669 - accuracy: 0.4567 6/11 [===============>..............] - ETA: 0s - loss: 0.3690 - accuracy: 0.4561 7/11 [==================>...........] - ETA: 0s - loss: 0.3699 - accuracy: 0.4565 8/11 [====================>.........] - ETA: 0s - loss: 0.3707 - accuracy: 0.4569 9/11 [=======================>......] - ETA: 0s - loss: 0.3713 - accuracy: 0.456710/11 [==========================>...] - ETA: 0s - loss: 0.3716 - accuracy: 0.456911/11 [==============================] - ETA: 0s - loss: 0.3721 - accuracy: 0.456711/11 [==============================] - 1s 104ms/step - loss: 0.3726 - accuracy: 0.4564
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3793 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.3766 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 0s - loss: 0.3751 - accuracy: 0.4470 4/11 [=========>....................] - ETA: 0s - loss: 0.3728 - accuracy: 0.4495 5/11 [============>.................] - ETA: 0s - loss: 0.3704 - accuracy: 0.4509 6/11 [===============>..............] - ETA: 0s - loss: 0.3697 - accuracy: 0.4510 7/11 [==================>...........] - ETA: 0s - loss: 0.3693 - accuracy: 0.4513 8/11 [====================>.........] - ETA: 0s - loss: 0.3688 - accuracy: 0.4517 9/11 [=======================>......] - ETA: 0s - loss: 0.3686 - accuracy: 0.452210/11 [==========================>...] - ETA: 0s - loss: 0.3683 - accuracy: 0.452711/11 [==============================] - ETA: 0s - loss: 0.3682 - accuracy: 0.452811/11 [==============================] - 1s 107ms/step - loss: 0.3682 - accuracy: 0.4529
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3484 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.3471 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 0s - loss: 0.3460 - accuracy: 0.4588 4/11 [=========>....................] - ETA: 0s - loss: 0.3461 - accuracy: 0.4588 5/11 [============>.................] - ETA: 0s - loss: 0.3462 - accuracy: 0.4555 6/11 [===============>..............] - ETA: 0s - loss: 0.3457 - accuracy: 0.4562 7/11 [==================>...........] - ETA: 0s - loss: 0.3461 - accuracy: 0.4565 8/11 [====================>.........] - ETA: 0s - loss: 0.3464 - accuracy: 0.4560 9/11 [=======================>......] - ETA: 0s - loss: 0.3468 - accuracy: 0.455410/11 [==========================>...] - ETA: 0s - loss: 0.3471 - accuracy: 0.455211/11 [==============================] - ETA: 0s - loss: 0.3473 - accuracy: 0.455111/11 [==============================] - 1s 108ms/step - loss: 0.3475 - accuracy: 0.4550
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3531 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 0s - loss: 0.3436 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3377 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.3332 - accuracy: 0.4556 5/11 [============>.................] - ETA: 0s - loss: 0.3308 - accuracy: 0.4579 6/11 [===============>..............] - ETA: 0s - loss: 0.3284 - accuracy: 0.4597 7/11 [==================>...........] - ETA: 0s - loss: 0.3264 - accuracy: 0.4615 8/11 [====================>.........] - ETA: 0s - loss: 0.3251 - accuracy: 0.4621 9/11 [=======================>......] - ETA: 0s - loss: 0.3246 - accuracy: 0.461410/11 [==========================>...] - ETA: 0s - loss: 0.3244 - accuracy: 0.460811/11 [==============================] - ETA: 0s - loss: 0.3243 - accuracy: 0.460511/11 [==============================] - 1s 103ms/step - loss: 0.3242 - accuracy: 0.4603
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3065 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 0s - loss: 0.3060 - accuracy: 0.5273 3/11 [=======>......................] - ETA: 0s - loss: 0.3043 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.3034 - accuracy: 0.5088 5/11 [============>.................] - ETA: 0s - loss: 0.3029 - accuracy: 0.5036 6/11 [===============>..............] - ETA: 0s - loss: 0.3021 - accuracy: 0.5000 7/11 [==================>...........] - ETA: 0s - loss: 0.3013 - accuracy: 0.4977 8/11 [====================>.........] - ETA: 0s - loss: 0.3008 - accuracy: 0.4958 9/11 [=======================>......] - ETA: 0s - loss: 0.2999 - accuracy: 0.494410/11 [==========================>...] - ETA: 0s - loss: 0.2992 - accuracy: 0.493111/11 [==============================] - ETA: 0s - loss: 0.2983 - accuracy: 0.492011/11 [==============================] - 1s 108ms/step - loss: 0.2976 - accuracy: 0.4910
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2759 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.2715 - accuracy: 0.4883 3/11 [=======>......................] - ETA: 0s - loss: 0.2647 - accuracy: 0.4913 4/11 [=========>....................] - ETA: 0s - loss: 0.2634 - accuracy: 0.4886 5/11 [============>.................] - ETA: 0s - loss: 0.2618 - accuracy: 0.4893 6/11 [===============>..............] - ETA: 0s - loss: 0.2605 - accuracy: 0.4902 7/11 [==================>...........] - ETA: 0s - loss: 0.2596 - accuracy: 0.4923 8/11 [====================>.........] - ETA: 0s - loss: 0.2589 - accuracy: 0.4938 9/11 [=======================>......] - ETA: 0s - loss: 0.2588 - accuracy: 0.494010/11 [==========================>...] - ETA: 0s - loss: 0.2588 - accuracy: 0.493911/11 [==============================] - ETA: 0s - loss: 0.2587 - accuracy: 0.493711/11 [==============================] - 1s 108ms/step - loss: 0.2586 - accuracy: 0.4935
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2495 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.2470 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 0s - loss: 0.2452 - accuracy: 0.5074 4/11 [=========>....................] - ETA: 0s - loss: 0.2443 - accuracy: 0.5182 5/11 [============>.................] - ETA: 0s - loss: 0.2444 - accuracy: 0.5261 6/11 [===============>..............] - ETA: 0s - loss: 0.2440 - accuracy: 0.5331 7/11 [==================>...........] - ETA: 0s - loss: 0.2432 - accuracy: 0.5374 8/11 [====================>.........] - ETA: 0s - loss: 0.2421 - accuracy: 0.5415 9/11 [=======================>......] - ETA: 0s - loss: 0.2410 - accuracy: 0.545210/11 [==========================>...] - ETA: 0s - loss: 0.2399 - accuracy: 0.547211/11 [==============================] - ETA: 0s - loss: 0.2390 - accuracy: 0.548011/11 [==============================] - 1s 108ms/step - loss: 0.2383 - accuracy: 0.5487
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2209 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.2176 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.2154 - accuracy: 0.5017 4/11 [=========>....................] - ETA: 0s - loss: 0.2146 - accuracy: 0.5062 5/11 [============>.................] - ETA: 0s - loss: 0.2135 - accuracy: 0.5096 6/11 [===============>..............] - ETA: 0s - loss: 0.2126 - accuracy: 0.5145 7/11 [==================>...........] - ETA: 0s - loss: 0.2118 - accuracy: 0.5196 8/11 [====================>.........] - ETA: 0s - loss: 0.2112 - accuracy: 0.5248 9/11 [=======================>......] - ETA: 0s - loss: 0.2107 - accuracy: 0.530310/11 [==========================>...] - ETA: 0s - loss: 0.2101 - accuracy: 0.535011/11 [==============================] - ETA: 0s - loss: 0.2096 - accuracy: 0.538511/11 [==============================] - 1s 106ms/step - loss: 0.2092 - accuracy: 0.5415
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1979 - accuracy: 0.6484 2/11 [====>.........................] - ETA: 0s - loss: 0.1954 - accuracy: 0.6367 3/11 [=======>......................] - ETA: 0s - loss: 0.1956 - accuracy: 0.6345 4/11 [=========>....................] - ETA: 0s - loss: 0.1948 - accuracy: 0.6307 5/11 [============>.................] - ETA: 0s - loss: 0.1936 - accuracy: 0.6277 6/11 [===============>..............] - ETA: 0s - loss: 0.1927 - accuracy: 0.6262 7/11 [==================>...........] - ETA: 0s - loss: 0.1917 - accuracy: 0.6257 8/11 [====================>.........] - ETA: 0s - loss: 0.1908 - accuracy: 0.6272 9/11 [=======================>......] - ETA: 0s - loss: 0.1900 - accuracy: 0.629410/11 [==========================>...] - ETA: 0s - loss: 0.1894 - accuracy: 0.632511/11 [==============================] - ETA: 0s - loss: 0.1890 - accuracy: 0.635711/11 [==============================] - 1s 111ms/step - loss: 0.1886 - accuracy: 0.6384
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1686 - accuracy: 0.8594 2/11 [====>.........................] - ETA: 1s - loss: 0.1735 - accuracy: 0.8359 3/11 [=======>......................] - ETA: 0s - loss: 0.1736 - accuracy: 0.8333 4/11 [=========>....................] - ETA: 0s - loss: 0.1729 - accuracy: 0.8281 5/11 [============>.................] - ETA: 0s - loss: 0.1723 - accuracy: 0.8206 6/11 [===============>..............] - ETA: 0s - loss: 0.1718 - accuracy: 0.8149 7/11 [==================>...........] - ETA: 0s - loss: 0.1716 - accuracy: 0.8103 8/11 [====================>.........] - ETA: 0s - loss: 0.1712 - accuracy: 0.8064 9/11 [=======================>......] - ETA: 0s - loss: 0.1708 - accuracy: 0.803410/11 [==========================>...] - ETA: 0s - loss: 0.1705 - accuracy: 0.800711/11 [==============================] - ETA: 0s - loss: 0.1703 - accuracy: 0.798811/11 [==============================] - 1s 110ms/step - loss: 0.1701 - accuracy: 0.7972
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1623 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 0s - loss: 0.1604 - accuracy: 0.8262 3/11 [=======>......................] - ETA: 0s - loss: 0.1591 - accuracy: 0.8294 4/11 [=========>....................] - ETA: 0s - loss: 0.1589 - accuracy: 0.8315 5/11 [============>.................] - ETA: 0s - loss: 0.1587 - accuracy: 0.8334 6/11 [===============>..............] - ETA: 0s - loss: 0.1586 - accuracy: 0.8342 7/11 [==================>...........] - ETA: 0s - loss: 0.1587 - accuracy: 0.8340 8/11 [====================>.........] - ETA: 0s - loss: 0.1587 - accuracy: 0.8328 9/11 [=======================>......] - ETA: 0s - loss: 0.1587 - accuracy: 0.830410/11 [==========================>...] - ETA: 0s - loss: 0.1585 - accuracy: 0.828211/11 [==============================] - ETA: 0s - loss: 0.1582 - accuracy: 0.826211/11 [==============================] - 1s 109ms/step - loss: 0.1580 - accuracy: 0.8246
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1526 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 1s - loss: 0.1510 - accuracy: 0.8047 3/11 [=======>......................] - ETA: 0s - loss: 0.1493 - accuracy: 0.8082 4/11 [=========>....................] - ETA: 0s - loss: 0.1478 - accuracy: 0.8097 5/11 [============>.................] - ETA: 0s - loss: 0.1463 - accuracy: 0.8118 6/11 [===============>..............] - ETA: 0s - loss: 0.1451 - accuracy: 0.8139 7/11 [==================>...........] - ETA: 0s - loss: 0.1442 - accuracy: 0.8163 8/11 [====================>.........] - ETA: 0s - loss: 0.1433 - accuracy: 0.8193 9/11 [=======================>......] - ETA: 0s - loss: 0.1428 - accuracy: 0.821910/11 [==========================>...] - ETA: 0s - loss: 0.1428 - accuracy: 0.823611/11 [==============================] - ETA: 0s - loss: 0.1429 - accuracy: 0.825011/11 [==============================] - 1s 112ms/step - loss: 0.1429 - accuracy: 0.8262
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1365 - accuracy: 0.8203 2/11 [====>.........................] - ETA: 0s - loss: 0.1423 - accuracy: 0.8145 3/11 [=======>......................] - ETA: 0s - loss: 0.1449 - accuracy: 0.8190 4/11 [=========>....................] - ETA: 0s - loss: 0.1443 - accuracy: 0.8252 5/11 [============>.................] - ETA: 0s - loss: 0.1437 - accuracy: 0.8311 6/11 [===============>..............] - ETA: 0s - loss: 0.1429 - accuracy: 0.8354 7/11 [==================>...........] - ETA: 0s - loss: 0.1420 - accuracy: 0.8383 8/11 [====================>.........] - ETA: 0s - loss: 0.1411 - accuracy: 0.8413 9/11 [=======================>......] - ETA: 0s - loss: 0.1404 - accuracy: 0.842610/11 [==========================>...] - ETA: 0s - loss: 0.1397 - accuracy: 0.843011/11 [==============================] - ETA: 0s - loss: 0.1393 - accuracy: 0.842611/11 [==============================] - 1s 107ms/step - loss: 0.1390 - accuracy: 0.8422
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1477 - accuracy: 0.8047 2/11 [====>.........................] - ETA: 1s - loss: 0.1445 - accuracy: 0.8027 3/11 [=======>......................] - ETA: 0s - loss: 0.1424 - accuracy: 0.8112 4/11 [=========>....................] - ETA: 0s - loss: 0.1406 - accuracy: 0.8203 5/11 [============>.................] - ETA: 0s - loss: 0.1391 - accuracy: 0.8272 6/11 [===============>..............] - ETA: 0s - loss: 0.1376 - accuracy: 0.8349 7/11 [==================>...........] - ETA: 0s - loss: 0.1366 - accuracy: 0.8411 8/11 [====================>.........] - ETA: 0s - loss: 0.1360 - accuracy: 0.8462 9/11 [=======================>......] - ETA: 0s - loss: 0.1353 - accuracy: 0.850710/11 [==========================>...] - ETA: 0s - loss: 0.1347 - accuracy: 0.854311/11 [==============================] - ETA: 0s - loss: 0.1342 - accuracy: 0.857211/11 [==============================] - 1s 110ms/step - loss: 0.1338 - accuracy: 0.8597
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1353 - accuracy: 0.8516 2/11 [====>.........................] - ETA: 0s - loss: 0.1297 - accuracy: 0.8359 3/11 [=======>......................] - ETA: 0s - loss: 0.1264 - accuracy: 0.8238 4/11 [=========>....................] - ETA: 0s - loss: 0.1245 - accuracy: 0.8171 5/11 [============>.................] - ETA: 0s - loss: 0.1233 - accuracy: 0.8149 6/11 [===============>..............] - ETA: 0s - loss: 0.1231 - accuracy: 0.8143 7/11 [==================>...........] - ETA: 0s - loss: 0.1229 - accuracy: 0.8151 8/11 [====================>.........] - ETA: 0s - loss: 0.1226 - accuracy: 0.8170 9/11 [=======================>......] - ETA: 0s - loss: 0.1222 - accuracy: 0.819810/11 [==========================>...] - ETA: 0s - loss: 0.1221 - accuracy: 0.821911/11 [==============================] - ETA: 0s - loss: 0.1218 - accuracy: 0.823611/11 [==============================] - 1s 101ms/step - loss: 0.1216 - accuracy: 0.8251
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1199 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 1s - loss: 0.1212 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 1s - loss: 0.1216 - accuracy: 0.8663 4/11 [=========>....................] - ETA: 0s - loss: 0.1207 - accuracy: 0.8641 5/11 [============>.................] - ETA: 0s - loss: 0.1191 - accuracy: 0.8641 6/11 [===============>..............] - ETA: 0s - loss: 0.1183 - accuracy: 0.8627 7/11 [==================>...........] - ETA: 0s - loss: 0.1178 - accuracy: 0.8614 8/11 [====================>.........] - ETA: 0s - loss: 0.1172 - accuracy: 0.8600 9/11 [=======================>......] - ETA: 0s - loss: 0.1168 - accuracy: 0.859010/11 [==========================>...] - ETA: 0s - loss: 0.1166 - accuracy: 0.858111/11 [==============================] - ETA: 0s - loss: 0.1165 - accuracy: 0.857711/11 [==============================] - 1s 106ms/step - loss: 0.1164 - accuracy: 0.8574
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.1159 - accuracy: 0.8984 2/11 [====>.........................] - ETA: 0s - loss: 0.1142 - accuracy: 0.9102 3/11 [=======>......................] - ETA: 0s - loss: 0.1130 - accuracy: 0.9132 4/11 [=========>....................] - ETA: 0s - loss: 0.1122 - accuracy: 0.9173 5/11 [============>.................] - ETA: 0s - loss: 0.1112 - accuracy: 0.9204 6/11 [===============>..............] - ETA: 0s - loss: 0.1112 - accuracy: 0.9211 7/11 [==================>...........] - ETA: 0s - loss: 0.1109 - accuracy: 0.9209 8/11 [====================>.........] - ETA: 0s - loss: 0.1106 - accuracy: 0.9199 9/11 [=======================>......] - ETA: 0s - loss: 0.1105 - accuracy: 0.918210/11 [==========================>...] - ETA: 0s - loss: 0.1104 - accuracy: 0.916411/11 [==============================] - ETA: 0s - loss: 0.1103 - accuracy: 0.914711/11 [==============================] - 1s 104ms/step - loss: 0.1102 - accuracy: 0.9133
Evaluate on test data
1/6 [====>.........................] - ETA: 18s - loss: 0.1179 - accuracy: 0.88283/6 [==============>...............] - ETA: 0s - loss: 0.1132 - accuracy: 0.9010 5/6 [========================>.....] - ETA: 0s - loss: 0.1056 - accuracy: 0.89846/6 [==============================] - 4s 31ms/step - loss: 0.1053 - accuracy: 0.8994
2021-12-14 00:07:32.167999: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:07:32.168824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla M2075 computeCapability: 2.0
coreClock: 1.147GHz coreCount: 14 deviceMemorySize: 5.18GiB deviceMemoryBandwidth: 140.01GiB/s
2021-12-14 00:07:32.168870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:07:32.168910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:07:32.168937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:07:32.168963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:07:32.168989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:07:32.169014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:07:32.169043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:07:32.169070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:07:32.170216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1816] Ignoring visible gpu device (device: 0, name: Tesla M2075, pci bus id: 0000:08:00.0, compute capability: 2.0) with Cuda compute capability 2.0. The minimum required Cuda capability is 3.5.
2021-12-14 00:07:32.170250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:07:32.170260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:07:32.170267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [0.00550565 0.73473454 0.8716078  0.00407153 0.00395551]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [0.01000634 0.9338419  0.7003807  0.0077877  0.00234854]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [0.00961375 0.80376595 0.7749086  0.00527802 0.00366101]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 2 0 1] pred: [0.0584749  0.02192497 0.05954    0.8687923  0.08271754]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [3 4 0 2 1] pred: [0.08388427 0.02219367 0.06075478 0.78593814 0.12884963]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.00811407 0.9037363  0.74997425 0.00689441 0.00240543]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [0.01426503 0.89936787 0.6233566  0.00802147 0.00281894]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 4 3] pred: [0.01248977 0.6852608  0.82705706 0.00347281 0.00659966]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [0.00103843 0.01313141 0.98603386 0.01181632 0.01094669]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 4 0 2 1] pred: [0.21680775 0.01980788 0.06292975 0.43714845 0.43028536]
 Top predictions indices: [3 4] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 4 1 0] pred: [0.00120303 0.01132643 0.985782   0.01166564 0.01146534]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 0 2 1] pred: [0.07063422 0.01942456 0.05173481 0.87734914 0.09818104]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.0061948  0.8710568  0.80575943 0.0061191  0.00258577]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [0.00923049 0.90995264 0.69570744 0.0077357  0.00211453]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 0 2 1] pred: [0.21690932 0.02247414 0.0622153  0.4435389  0.39213532]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:04 - loss: 0.6903 - accuracy: 0.0938 2/11 [====>.........................] - ETA: 1s - loss: 0.6888 - accuracy: 0.1758   3/11 [=======>......................] - ETA: 0s - loss: 0.6873 - accuracy: 0.2326 4/11 [=========>....................] - ETA: 0s - loss: 0.6859 - accuracy: 0.2648 5/11 [============>.................] - ETA: 0s - loss: 0.6845 - accuracy: 0.2847 6/11 [===============>..............] - ETA: 0s - loss: 0.6830 - accuracy: 0.3019 7/11 [==================>...........] - ETA: 0s - loss: 0.6815 - accuracy: 0.3168 8/11 [====================>.........] - ETA: 0s - loss: 0.6800 - accuracy: 0.3292 9/11 [=======================>......] - ETA: 0s - loss: 0.6784 - accuracy: 0.339110/11 [==========================>...] - ETA: 0s - loss: 0.6768 - accuracy: 0.348111/11 [==============================] - ETA: 0s - loss: 0.6752 - accuracy: 0.355911/11 [==============================] - 14s 106ms/step - loss: 0.6739 - accuracy: 0.3623
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6107 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 0s - loss: 0.6087 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 0s - loss: 0.6065 - accuracy: 0.4701 4/11 [=========>....................] - ETA: 0s - loss: 0.6034 - accuracy: 0.4717 5/11 [============>.................] - ETA: 0s - loss: 0.6002 - accuracy: 0.4714 6/11 [===============>..............] - ETA: 0s - loss: 0.5968 - accuracy: 0.4716 7/11 [==================>...........] - ETA: 0s - loss: 0.5931 - accuracy: 0.4730 8/11 [====================>.........] - ETA: 0s - loss: 0.5895 - accuracy: 0.4735 9/11 [=======================>......] - ETA: 0s - loss: 0.5857 - accuracy: 0.473710/11 [==========================>...] - ETA: 0s - loss: 0.5819 - accuracy: 0.472911/11 [==============================] - ETA: 0s - loss: 0.5780 - accuracy: 0.472511/11 [==============================] - 1s 103ms/step - loss: 0.5749 - accuracy: 0.4721
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4164 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.4105 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.4043 - accuracy: 0.4974 4/11 [=========>....................] - ETA: 0s - loss: 0.4021 - accuracy: 0.4956 5/11 [============>.................] - ETA: 0s - loss: 0.4012 - accuracy: 0.4921 6/11 [===============>..............] - ETA: 0s - loss: 0.4001 - accuracy: 0.4900 7/11 [==================>...........] - ETA: 0s - loss: 0.4000 - accuracy: 0.4882 8/11 [====================>.........] - ETA: 0s - loss: 0.4001 - accuracy: 0.4870 9/11 [=======================>......] - ETA: 0s - loss: 0.4003 - accuracy: 0.484710/11 [==========================>...] - ETA: 0s - loss: 0.4005 - accuracy: 0.482511/11 [==============================] - ETA: 0s - loss: 0.4004 - accuracy: 0.481111/11 [==============================] - 1s 111ms/step - loss: 0.4003 - accuracy: 0.4800
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3469 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 0s - loss: 0.3663 - accuracy: 0.5273 3/11 [=======>......................] - ETA: 0s - loss: 0.3698 - accuracy: 0.5130 4/11 [=========>....................] - ETA: 0s - loss: 0.3721 - accuracy: 0.5059 5/11 [============>.................] - ETA: 0s - loss: 0.3750 - accuracy: 0.4991 6/11 [===============>..............] - ETA: 0s - loss: 0.3772 - accuracy: 0.4962 7/11 [==================>...........] - ETA: 0s - loss: 0.3794 - accuracy: 0.4929 8/11 [====================>.........] - ETA: 0s - loss: 0.3814 - accuracy: 0.4894 9/11 [=======================>......] - ETA: 0s - loss: 0.3826 - accuracy: 0.487210/11 [==========================>...] - ETA: 0s - loss: 0.3831 - accuracy: 0.485411/11 [==============================] - ETA: 0s - loss: 0.3835 - accuracy: 0.483811/11 [==============================] - 1s 105ms/step - loss: 0.3837 - accuracy: 0.4824
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3713 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.3689 - accuracy: 0.4805 3/11 [=======>......................] - ETA: 0s - loss: 0.3700 - accuracy: 0.4800 4/11 [=========>....................] - ETA: 0s - loss: 0.3720 - accuracy: 0.4797 5/11 [============>.................] - ETA: 0s - loss: 0.3736 - accuracy: 0.4797 6/11 [===============>..............] - ETA: 0s - loss: 0.3763 - accuracy: 0.4776 7/11 [==================>...........] - ETA: 0s - loss: 0.3776 - accuracy: 0.4764 8/11 [====================>.........] - ETA: 0s - loss: 0.3783 - accuracy: 0.4758 9/11 [=======================>......] - ETA: 0s - loss: 0.3787 - accuracy: 0.475510/11 [==========================>...] - ETA: 0s - loss: 0.3794 - accuracy: 0.474411/11 [==============================] - ETA: 0s - loss: 0.3798 - accuracy: 0.473811/11 [==============================] - 1s 106ms/step - loss: 0.3801 - accuracy: 0.4733
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3934 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 0s - loss: 0.3874 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 0s - loss: 0.3846 - accuracy: 0.4427 4/11 [=========>....................] - ETA: 0s - loss: 0.3821 - accuracy: 0.4482 5/11 [============>.................] - ETA: 0s - loss: 0.3813 - accuracy: 0.4508 6/11 [===============>..............] - ETA: 0s - loss: 0.3810 - accuracy: 0.4525 7/11 [==================>...........] - ETA: 0s - loss: 0.3812 - accuracy: 0.4532 8/11 [====================>.........] - ETA: 0s - loss: 0.3812 - accuracy: 0.4544 9/11 [=======================>......] - ETA: 0s - loss: 0.3815 - accuracy: 0.455110/11 [==========================>...] - ETA: 0s - loss: 0.3816 - accuracy: 0.456311/11 [==============================] - ETA: 0s - loss: 0.3816 - accuracy: 0.457411/11 [==============================] - 1s 112ms/step - loss: 0.3815 - accuracy: 0.4583
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3992 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.3955 - accuracy: 0.4512 3/11 [=======>......................] - ETA: 0s - loss: 0.3931 - accuracy: 0.4579 4/11 [=========>....................] - ETA: 0s - loss: 0.3904 - accuracy: 0.4606 5/11 [============>.................] - ETA: 0s - loss: 0.3883 - accuracy: 0.4619 6/11 [===============>..............] - ETA: 0s - loss: 0.3859 - accuracy: 0.4646 7/11 [==================>...........] - ETA: 0s - loss: 0.3848 - accuracy: 0.4663 8/11 [====================>.........] - ETA: 0s - loss: 0.3839 - accuracy: 0.4667 9/11 [=======================>......] - ETA: 0s - loss: 0.3829 - accuracy: 0.467110/11 [==========================>...] - ETA: 0s - loss: 0.3822 - accuracy: 0.467111/11 [==============================] - ETA: 0s - loss: 0.3816 - accuracy: 0.467111/11 [==============================] - 1s 111ms/step - loss: 0.3812 - accuracy: 0.4672
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3853 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 0s - loss: 0.3850 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.3836 - accuracy: 0.4253 4/11 [=========>....................] - ETA: 0s - loss: 0.3838 - accuracy: 0.4294 5/11 [============>.................] - ETA: 0s - loss: 0.3827 - accuracy: 0.4332 6/11 [===============>..............] - ETA: 0s - loss: 0.3809 - accuracy: 0.4382 7/11 [==================>...........] - ETA: 0s - loss: 0.3793 - accuracy: 0.4418 8/11 [====================>.........] - ETA: 0s - loss: 0.3780 - accuracy: 0.4450 9/11 [=======================>......] - ETA: 0s - loss: 0.3770 - accuracy: 0.447710/11 [==========================>...] - ETA: 0s - loss: 0.3760 - accuracy: 0.450111/11 [==============================] - ETA: 0s - loss: 0.3752 - accuracy: 0.451711/11 [==============================] - 1s 105ms/step - loss: 0.3745 - accuracy: 0.4531
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3495 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 0s - loss: 0.3479 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 0s - loss: 0.3457 - accuracy: 0.4583 4/11 [=========>....................] - ETA: 0s - loss: 0.3466 - accuracy: 0.4619 5/11 [============>.................] - ETA: 0s - loss: 0.3480 - accuracy: 0.4598 6/11 [===============>..............] - ETA: 0s - loss: 0.3491 - accuracy: 0.4596 7/11 [==================>...........] - ETA: 0s - loss: 0.3502 - accuracy: 0.4583 8/11 [====================>.........] - ETA: 0s - loss: 0.3507 - accuracy: 0.4573 9/11 [=======================>......] - ETA: 0s - loss: 0.3509 - accuracy: 0.457610/11 [==========================>...] - ETA: 0s - loss: 0.3510 - accuracy: 0.458011/11 [==============================] - ETA: 0s - loss: 0.3508 - accuracy: 0.458911/11 [==============================] - 1s 106ms/step - loss: 0.3506 - accuracy: 0.4597
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.3137 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 0s - loss: 0.3251 - accuracy: 0.5059 3/11 [=======>......................] - ETA: 0s - loss: 0.3309 - accuracy: 0.4839 4/11 [=========>....................] - ETA: 0s - loss: 0.3343 - accuracy: 0.4699 5/11 [============>.................] - ETA: 0s - loss: 0.3343 - accuracy: 0.4656 6/11 [===============>..............] - ETA: 0s - loss: 0.3335 - accuracy: 0.4644 7/11 [==================>...........] - ETA: 0s - loss: 0.3325 - accuracy: 0.4633 8/11 [====================>.........] - ETA: 0s - loss: 0.3314 - accuracy: 0.4632 9/11 [=======================>......] - ETA: 0s - loss: 0.3300 - accuracy: 0.463710/11 [==========================>...] - ETA: 0s - loss: 0.3290 - accuracy: 0.464211/11 [==============================] - ETA: 0s - loss: 0.3282 - accuracy: 0.464511/11 [==============================] - 1s 107ms/step - loss: 0.3275 - accuracy: 0.4648
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2930 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 0s - loss: 0.2909 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 0s - loss: 0.2923 - accuracy: 0.4692 4/11 [=========>....................] - ETA: 0s - loss: 0.2916 - accuracy: 0.4676 5/11 [============>.................] - ETA: 0s - loss: 0.2923 - accuracy: 0.4678 6/11 [===============>..............] - ETA: 0s - loss: 0.2918 - accuracy: 0.4680 7/11 [==================>...........] - ETA: 0s - loss: 0.2913 - accuracy: 0.4700 8/11 [====================>.........] - ETA: 0s - loss: 0.2911 - accuracy: 0.4718 9/11 [=======================>......] - ETA: 0s - loss: 0.2905 - accuracy: 0.472910/11 [==========================>...] - ETA: 0s - loss: 0.2902 - accuracy: 0.473011/11 [==============================] - ETA: 0s - loss: 0.2897 - accuracy: 0.472911/11 [==============================] - 1s 111ms/step - loss: 0.2893 - accuracy: 0.4728
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2628 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 0s - loss: 0.2665 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.2641 - accuracy: 0.4644 4/11 [=========>....................] - ETA: 0s - loss: 0.2625 - accuracy: 0.4674 5/11 [============>.................] - ETA: 0s - loss: 0.2608 - accuracy: 0.4705 6/11 [===============>..............] - ETA: 0s - loss: 0.2600 - accuracy: 0.4720 7/11 [==================>...........] - ETA: 0s - loss: 0.2595 - accuracy: 0.4712 8/11 [====================>.........] - ETA: 0s - loss: 0.2588 - accuracy: 0.4716 9/11 [=======================>......] - ETA: 0s - loss: 0.2581 - accuracy: 0.471910/11 [==========================>...] - ETA: 0s - loss: 0.2572 - accuracy: 0.472511/11 [==============================] - ETA: 0s - loss: 0.2564 - accuracy: 0.472911/11 [==============================] - 1s 102ms/step - loss: 0.2557 - accuracy: 0.4733
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2286 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 0s - loss: 0.2331 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.2317 - accuracy: 0.4800 4/11 [=========>....................] - ETA: 0s - loss: 0.2312 - accuracy: 0.4806 5/11 [============>.................] - ETA: 0s - loss: 0.2296 - accuracy: 0.4833 6/11 [===============>..............] - ETA: 0s - loss: 0.2283 - accuracy: 0.4847 7/11 [==================>...........] - ETA: 0s - loss: 0.2271 - accuracy: 0.4863 8/11 [====================>.........] - ETA: 0s - loss: 0.2261 - accuracy: 0.4880 9/11 [=======================>......] - ETA: 0s - loss: 0.2251 - accuracy: 0.490310/11 [==========================>...] - ETA: 0s - loss: 0.2241 - accuracy: 0.492511/11 [==============================] - ETA: 0s - loss: 0.2233 - accuracy: 0.495011/11 [==============================] - 1s 109ms/step - loss: 0.2227 - accuracy: 0.4971
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2002 - accuracy: 0.6797 2/11 [====>.........................] - ETA: 0s - loss: 0.2016 - accuracy: 0.6602 3/11 [=======>......................] - ETA: 0s - loss: 0.1994 - accuracy: 0.6554 4/11 [=========>....................] - ETA: 0s - loss: 0.1983 - accuracy: 0.6502 5/11 [============>.................] - ETA: 0s - loss: 0.1973 - accuracy: 0.6467 6/11 [===============>..............] - ETA: 0s - loss: 0.1967 - accuracy: 0.6459 7/11 [==================>...........] - ETA: 0s - loss: 0.1966 - accuracy: 0.6442 8/11 [====================>.........] - ETA: 0s - loss: 0.1965 - accuracy: 0.6417 9/11 [=======================>......] - ETA: 0s - loss: 0.1962 - accuracy: 0.639810/11 [==========================>...] - ETA: 0s - loss: 0.1959 - accuracy: 0.639111/11 [==============================] - ETA: 0s - loss: 0.1955 - accuracy: 0.638911/11 [==============================] - 1s 106ms/step - loss: 0.1951 - accuracy: 0.6387
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1879 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 0s - loss: 0.1821 - accuracy: 0.6914 3/11 [=======>......................] - ETA: 0s - loss: 0.1811 - accuracy: 0.6970 4/11 [=========>....................] - ETA: 0s - loss: 0.1808 - accuracy: 0.6976 5/11 [============>.................] - ETA: 0s - loss: 0.1801 - accuracy: 0.6953 6/11 [===============>..............] - ETA: 0s - loss: 0.1791 - accuracy: 0.6924 7/11 [==================>...........] - ETA: 0s - loss: 0.1787 - accuracy: 0.6921 8/11 [====================>.........] - ETA: 0s - loss: 0.1785 - accuracy: 0.6928 9/11 [=======================>......] - ETA: 0s - loss: 0.1780 - accuracy: 0.694610/11 [==========================>...] - ETA: 0s - loss: 0.1775 - accuracy: 0.696711/11 [==============================] - ETA: 0s - loss: 0.1772 - accuracy: 0.698711/11 [==============================] - 1s 109ms/step - loss: 0.1769 - accuracy: 0.7004
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1597 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 0s - loss: 0.1596 - accuracy: 0.7246 3/11 [=======>......................] - ETA: 0s - loss: 0.1599 - accuracy: 0.7296 4/11 [=========>....................] - ETA: 0s - loss: 0.1605 - accuracy: 0.7367 5/11 [============>.................] - ETA: 0s - loss: 0.1607 - accuracy: 0.7415 6/11 [===============>..............] - ETA: 0s - loss: 0.1610 - accuracy: 0.7464 7/11 [==================>...........] - ETA: 0s - loss: 0.1612 - accuracy: 0.7498 8/11 [====================>.........] - ETA: 0s - loss: 0.1614 - accuracy: 0.7499 9/11 [=======================>......] - ETA: 0s - loss: 0.1612 - accuracy: 0.750610/11 [==========================>...] - ETA: 0s - loss: 0.1609 - accuracy: 0.751311/11 [==============================] - ETA: 0s - loss: 0.1608 - accuracy: 0.751711/11 [==============================] - 1s 106ms/step - loss: 0.1606 - accuracy: 0.7521
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1689 - accuracy: 0.7031 2/11 [====>.........................] - ETA: 0s - loss: 0.1630 - accuracy: 0.7109 3/11 [=======>......................] - ETA: 0s - loss: 0.1623 - accuracy: 0.7300 4/11 [=========>....................] - ETA: 0s - loss: 0.1610 - accuracy: 0.7399 5/11 [============>.................] - ETA: 0s - loss: 0.1605 - accuracy: 0.7472 6/11 [===============>..............] - ETA: 0s - loss: 0.1598 - accuracy: 0.7536 7/11 [==================>...........] - ETA: 0s - loss: 0.1588 - accuracy: 0.7589 8/11 [====================>.........] - ETA: 0s - loss: 0.1579 - accuracy: 0.7630 9/11 [=======================>......] - ETA: 0s - loss: 0.1570 - accuracy: 0.764110/11 [==========================>...] - ETA: 0s - loss: 0.1562 - accuracy: 0.764211/11 [==============================] - ETA: 0s - loss: 0.1557 - accuracy: 0.763711/11 [==============================] - 1s 114ms/step - loss: 0.1552 - accuracy: 0.7633
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1248 - accuracy: 0.8203 2/11 [====>.........................] - ETA: 1s - loss: 0.1314 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 0s - loss: 0.1350 - accuracy: 0.8307 4/11 [=========>....................] - ETA: 0s - loss: 0.1371 - accuracy: 0.8413 5/11 [============>.................] - ETA: 0s - loss: 0.1391 - accuracy: 0.8474 6/11 [===============>..............] - ETA: 0s - loss: 0.1402 - accuracy: 0.8529 7/11 [==================>...........] - ETA: 0s - loss: 0.1412 - accuracy: 0.8554 8/11 [====================>.........] - ETA: 0s - loss: 0.1419 - accuracy: 0.8564 9/11 [=======================>......] - ETA: 0s - loss: 0.1426 - accuracy: 0.856010/11 [==========================>...] - ETA: 0s - loss: 0.1429 - accuracy: 0.854711/11 [==============================] - ETA: 0s - loss: 0.1431 - accuracy: 0.852111/11 [==============================] - 1s 112ms/step - loss: 0.1432 - accuracy: 0.8500
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1567 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 0s - loss: 0.1508 - accuracy: 0.6641 3/11 [=======>......................] - ETA: 0s - loss: 0.1457 - accuracy: 0.6615 4/11 [=========>....................] - ETA: 0s - loss: 0.1425 - accuracy: 0.6606 5/11 [============>.................] - ETA: 0s - loss: 0.1408 - accuracy: 0.6645 6/11 [===============>..............] - ETA: 0s - loss: 0.1392 - accuracy: 0.6696 7/11 [==================>...........] - ETA: 0s - loss: 0.1384 - accuracy: 0.6753 8/11 [====================>.........] - ETA: 0s - loss: 0.1378 - accuracy: 0.6821 9/11 [=======================>......] - ETA: 0s - loss: 0.1375 - accuracy: 0.688410/11 [==========================>...] - ETA: 0s - loss: 0.1374 - accuracy: 0.695111/11 [==============================] - ETA: 0s - loss: 0.1373 - accuracy: 0.701611/11 [==============================] - 1s 104ms/step - loss: 0.1372 - accuracy: 0.7069
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1276 - accuracy: 0.8984 2/11 [====>.........................] - ETA: 0s - loss: 0.1247 - accuracy: 0.8984 3/11 [=======>......................] - ETA: 0s - loss: 0.1257 - accuracy: 0.8872 4/11 [=========>....................] - ETA: 0s - loss: 0.1249 - accuracy: 0.8714 5/11 [============>.................] - ETA: 0s - loss: 0.1254 - accuracy: 0.8587 6/11 [===============>..............] - ETA: 0s - loss: 0.1254 - accuracy: 0.8514 7/11 [==================>...........] - ETA: 0s - loss: 0.1259 - accuracy: 0.8476 8/11 [====================>.........] - ETA: 0s - loss: 0.1263 - accuracy: 0.8454 9/11 [=======================>......] - ETA: 0s - loss: 0.1267 - accuracy: 0.844210/11 [==========================>...] - ETA: 0s - loss: 0.1270 - accuracy: 0.843611/11 [==============================] - ETA: 0s - loss: 0.1271 - accuracy: 0.843411/11 [==============================] - 1s 107ms/step - loss: 0.1272 - accuracy: 0.8432
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.1173 - accuracy: 0.86723/6 [==============>...............] - ETA: 0s - loss: 0.1348 - accuracy: 0.8542 5/6 [========================>.....] - ETA: 0s - loss: 0.1365 - accuracy: 0.85316/6 [==============================] - 4s 30ms/step - loss: 0.1387 - accuracy: 0.8470
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [0.00393447 0.02464208 0.97857547 0.00660509 0.00425094]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [0.00377184 0.0219039  0.980309   0.00692043 0.00451601]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [0.01360875 0.86150265 0.76554483 0.00919464 0.00139838]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [0.00533605 0.07228652 0.96694326 0.00382215 0.00203481]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [0.00393742 0.02286077 0.97913826 0.00739452 0.00470123]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.02652717 0.8694093  0.6547882  0.01130378 0.00206873]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [0.01304433 0.8577409  0.8053585  0.00812304 0.00119877]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [0.00852472 0.7857187  0.849319   0.00812039 0.00131762]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [0.02189809 0.8460887  0.7252594  0.00999042 0.00170875]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [0.00526899 0.1827493  0.9563002  0.00308874 0.00191474]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [0.03142494 0.8399448  0.654855   0.01125687 0.00231069]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [0.00385904 0.02245107 0.98000705 0.00699395 0.00453204]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.02117208 0.86633337 0.6900246  0.01167992 0.00165826]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [0 1 2 3 4] pred: [0.50454324 0.17449406 0.09722489 0.09024537 0.06172344]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [0.01879194 0.8607199  0.7079058  0.01206255 0.00163573]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Job end at mar déc 14 00:08:21 CET 2021
