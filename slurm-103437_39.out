
Les modules suivants ont été rechargés avec un changement de version :
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompic-2019b
  2) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/3.1.4-gcccuda-2019b
  3) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.0.2-gompic-2019b

Job start at mar déc 14 00:02:40 CET 2021
2021-12-14 00:02:40.958110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
WARNING:tensorflow:From /CECI/home/users/s/f/sfortz/VaryMinion/scripts/training_NN/training_Model.py:24: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2021-12-14 00:02:46.275389: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:02:46.276889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-12-14 00:02:46.312036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:02:46.312104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:02:46.316195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:02:46.316258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:02:46.319227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:02:46.320150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:02:46.323485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:02:46.325514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:02:46.332536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:02:46.333847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:02:46.333905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:02:47.039924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:02:47.040003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:02:47.040019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:02:47.042498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:02:47.043757: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:02:47.044613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:02:47.044679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:02:47.044736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:02:47.044774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:02:47.044820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:02:47.044851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:02:47.044882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:02:47.044925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:02:47.044970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:02:47.046097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:02:47.046151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:02:47.046163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:02:47.046172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:02:47.047336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:02:48.995353: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:02:48.996643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:02:48.996693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:02:48.996735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:02:48.996780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:02:48.996821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:02:48.996859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:02:48.996914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:02:48.996975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:02:48.997021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:02:48.998115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:02:48.998974: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:02:48.999558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:02:48.999587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:02:48.999616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:02:48.999645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:02:48.999674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:02:48.999706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:02:48.999735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:02:48.999766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:02:48.999795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:02:49.000859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:02:49.000921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:02:49.000949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:02:49.000958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:02:49.002181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:02:49.002308: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.
2021-12-14 00:02:52.784455: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-12-14 00:02:52.785217: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 1994990000 Hz
2021-12-14 00:03:04.967044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:03:06.079530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
Number of possible configurations: 40
Begining exécution of the 39 th configuration: BPIC20.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, sigmoid as activation function and jaccard as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 58)          3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                21360     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:40 - loss: 0.8098 - accuracy: 0.2578 3/11 [=======>......................] - ETA: 0s - loss: 0.8043 - accuracy: 0.3655   5/11 [============>.................] - ETA: 0s - loss: 0.8028 - accuracy: 0.3901 7/11 [==================>...........] - ETA: 0s - loss: 0.8014 - accuracy: 0.404610/11 [==========================>...] - ETA: 0s - loss: 0.7997 - accuracy: 0.415611/11 [==============================] - 16s 27ms/step - loss: 0.7986 - accuracy: 0.4194
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7799 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.7775 - accuracy: 0.4727 6/11 [===============>..............] - ETA: 0s - loss: 0.7749 - accuracy: 0.4694 9/11 [=======================>......] - ETA: 0s - loss: 0.7715 - accuracy: 0.461911/11 [==============================] - 0s 26ms/step - loss: 0.7680 - accuracy: 0.4597
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7284 - accuracy: 0.5156 4/11 [=========>....................] - ETA: 0s - loss: 0.7150 - accuracy: 0.4779 6/11 [===============>..............] - ETA: 0s - loss: 0.7069 - accuracy: 0.4677 8/11 [====================>.........] - ETA: 0s - loss: 0.7001 - accuracy: 0.466810/11 [==========================>...] - ETA: 0s - loss: 0.6935 - accuracy: 0.464811/11 [==============================] - 0s 27ms/step - loss: 0.6881 - accuracy: 0.4630
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5868 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.5788 - accuracy: 0.4627 5/11 [============>.................] - ETA: 0s - loss: 0.5735 - accuracy: 0.4554 7/11 [==================>...........] - ETA: 0s - loss: 0.5672 - accuracy: 0.451510/11 [==========================>...] - ETA: 0s - loss: 0.5596 - accuracy: 0.451311/11 [==============================] - 0s 27ms/step - loss: 0.5562 - accuracy: 0.4517
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4610 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.4768 - accuracy: 0.4787 5/11 [============>.................] - ETA: 0s - loss: 0.4765 - accuracy: 0.4761 7/11 [==================>...........] - ETA: 0s - loss: 0.4787 - accuracy: 0.4723 9/11 [=======================>......] - ETA: 0s - loss: 0.4801 - accuracy: 0.469811/11 [==============================] - 0s 26ms/step - loss: 0.4812 - accuracy: 0.4659
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5204 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.5076 - accuracy: 0.4362 6/11 [===============>..............] - ETA: 0s - loss: 0.4993 - accuracy: 0.4482 8/11 [====================>.........] - ETA: 0s - loss: 0.4954 - accuracy: 0.450310/11 [==========================>...] - ETA: 0s - loss: 0.4909 - accuracy: 0.451911/11 [==============================] - 0s 26ms/step - loss: 0.4877 - accuracy: 0.4526
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4775 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.4657 - accuracy: 0.4375 5/11 [============>.................] - ETA: 0s - loss: 0.4645 - accuracy: 0.4394 7/11 [==================>...........] - ETA: 0s - loss: 0.4642 - accuracy: 0.4418 9/11 [=======================>......] - ETA: 0s - loss: 0.4643 - accuracy: 0.443611/11 [==============================] - ETA: 0s - loss: 0.4651 - accuracy: 0.446011/11 [==============================] - 0s 28ms/step - loss: 0.4653 - accuracy: 0.4471
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5027 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.4797 - accuracy: 0.4440 5/11 [============>.................] - ETA: 0s - loss: 0.4774 - accuracy: 0.4496 7/11 [==================>...........] - ETA: 0s - loss: 0.4764 - accuracy: 0.4502 9/11 [=======================>......] - ETA: 0s - loss: 0.4739 - accuracy: 0.449711/11 [==============================] - ETA: 0s - loss: 0.4720 - accuracy: 0.451111/11 [==============================] - 0s 28ms/step - loss: 0.4715 - accuracy: 0.4519
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4727 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.4650 - accuracy: 0.4727 5/11 [============>.................] - ETA: 0s - loss: 0.4648 - accuracy: 0.4745 7/11 [==================>...........] - ETA: 0s - loss: 0.4633 - accuracy: 0.4737 9/11 [=======================>......] - ETA: 0s - loss: 0.4632 - accuracy: 0.471811/11 [==============================] - ETA: 0s - loss: 0.4630 - accuracy: 0.470111/11 [==============================] - 0s 28ms/step - loss: 0.4630 - accuracy: 0.4697
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4805 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.4845 - accuracy: 0.4688 5/11 [============>.................] - ETA: 0s - loss: 0.4797 - accuracy: 0.4633 7/11 [==================>...........] - ETA: 0s - loss: 0.4762 - accuracy: 0.4649 9/11 [=======================>......] - ETA: 0s - loss: 0.4728 - accuracy: 0.467511/11 [==============================] - ETA: 0s - loss: 0.4700 - accuracy: 0.468311/11 [==============================] - 0s 28ms/step - loss: 0.4690 - accuracy: 0.4689
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4372 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.4461 - accuracy: 0.4939 5/11 [============>.................] - ETA: 0s - loss: 0.4464 - accuracy: 0.4924 7/11 [==================>...........] - ETA: 0s - loss: 0.4477 - accuracy: 0.4911 9/11 [=======================>......] - ETA: 0s - loss: 0.4500 - accuracy: 0.491911/11 [==============================] - 0s 28ms/step - loss: 0.4510 - accuracy: 0.4915
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4832 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.4558 - accuracy: 0.4813 5/11 [============>.................] - ETA: 0s - loss: 0.4560 - accuracy: 0.4801 8/11 [====================>.........] - ETA: 0s - loss: 0.4561 - accuracy: 0.482510/11 [==========================>...] - ETA: 0s - loss: 0.4557 - accuracy: 0.482711/11 [==============================] - 0s 29ms/step - loss: 0.4548 - accuracy: 0.4839
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4278 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.4235 - accuracy: 0.4444 5/11 [============>.................] - ETA: 0s - loss: 0.4256 - accuracy: 0.4588 7/11 [==================>...........] - ETA: 0s - loss: 0.4277 - accuracy: 0.4648 9/11 [=======================>......] - ETA: 0s - loss: 0.4307 - accuracy: 0.469711/11 [==============================] - ETA: 0s - loss: 0.4334 - accuracy: 0.473411/11 [==============================] - 0s 27ms/step - loss: 0.4344 - accuracy: 0.4747
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4125 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.4320 - accuracy: 0.4987 5/11 [============>.................] - ETA: 0s - loss: 0.4348 - accuracy: 0.5002 7/11 [==================>...........] - ETA: 0s - loss: 0.4360 - accuracy: 0.4984 9/11 [=======================>......] - ETA: 0s - loss: 0.4369 - accuracy: 0.496711/11 [==============================] - ETA: 0s - loss: 0.4373 - accuracy: 0.495311/11 [==============================] - 0s 29ms/step - loss: 0.4374 - accuracy: 0.4947
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4704 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4660 - accuracy: 0.4683 5/11 [============>.................] - ETA: 0s - loss: 0.4572 - accuracy: 0.4815 7/11 [==================>...........] - ETA: 0s - loss: 0.4541 - accuracy: 0.4909 9/11 [=======================>......] - ETA: 0s - loss: 0.4508 - accuracy: 0.494111/11 [==============================] - 0s 28ms/step - loss: 0.4466 - accuracy: 0.4940
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4222 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.4271 - accuracy: 0.4653 5/11 [============>.................] - ETA: 0s - loss: 0.4281 - accuracy: 0.4839 7/11 [==================>...........] - ETA: 0s - loss: 0.4273 - accuracy: 0.4937 9/11 [=======================>......] - ETA: 0s - loss: 0.4271 - accuracy: 0.501211/11 [==============================] - 0s 28ms/step - loss: 0.4274 - accuracy: 0.5095
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4319 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.4214 - accuracy: 0.5204 5/11 [============>.................] - ETA: 0s - loss: 0.4223 - accuracy: 0.5321 7/11 [==================>...........] - ETA: 0s - loss: 0.4227 - accuracy: 0.5413 9/11 [=======================>......] - ETA: 0s - loss: 0.4221 - accuracy: 0.546311/11 [==============================] - ETA: 0s - loss: 0.4222 - accuracy: 0.550611/11 [==============================] - 0s 29ms/step - loss: 0.4223 - accuracy: 0.5523
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4422 - accuracy: 0.6094 3/11 [=======>......................] - ETA: 0s - loss: 0.4303 - accuracy: 0.6120 5/11 [============>.................] - ETA: 0s - loss: 0.4251 - accuracy: 0.6018 7/11 [==================>...........] - ETA: 0s - loss: 0.4240 - accuracy: 0.5939 9/11 [=======================>......] - ETA: 0s - loss: 0.4234 - accuracy: 0.589311/11 [==============================] - ETA: 0s - loss: 0.4228 - accuracy: 0.586611/11 [==============================] - 0s 28ms/step - loss: 0.4226 - accuracy: 0.5857
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3958 - accuracy: 0.5469 4/11 [=========>....................] - ETA: 0s - loss: 0.4088 - accuracy: 0.5638 6/11 [===============>..............] - ETA: 0s - loss: 0.4077 - accuracy: 0.5607 8/11 [====================>.........] - ETA: 0s - loss: 0.4071 - accuracy: 0.560610/11 [==========================>...] - ETA: 0s - loss: 0.4084 - accuracy: 0.563511/11 [==============================] - 0s 27ms/step - loss: 0.4097 - accuracy: 0.5657
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4020 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.4176 - accuracy: 0.5386 5/11 [============>.................] - ETA: 0s - loss: 0.4177 - accuracy: 0.5479 7/11 [==================>...........] - ETA: 0s - loss: 0.4178 - accuracy: 0.5557 9/11 [=======================>......] - ETA: 0s - loss: 0.4179 - accuracy: 0.556911/11 [==============================] - ETA: 0s - loss: 0.4171 - accuracy: 0.557011/11 [==============================] - 0s 29ms/step - loss: 0.4166 - accuracy: 0.5572
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.3922 - accuracy: 0.53126/6 [==============================] - ETA: 0s - loss: 0.4026 - accuracy: 0.5538 6/6 [==============================] - 5s 10ms/step - loss: 0.4026 - accuracy: 0.5538
2021-12-14 00:03:25.275521: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:03:25.277055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:03:25.277144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:03:25.277221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:03:25.277270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:03:25.277315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:03:25.277359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:03:25.277402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:03:25.277453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:03:25.277504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:03:25.278495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:03:25.278549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:03:25.278565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:03:25.278577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:03:25.279622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:03:25.280183: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:03:25.280704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:03:25.280745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:03:25.280784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:03:25.280823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:03:25.280861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:03:25.280905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:03:25.280957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:03:25.281003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:03:25.281046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:03:25.281945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:03:25.281985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:03:25.282000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:03:25.282012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:03:25.282969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [1.2217928e-03 9.9909210e-01 9.9994040e-01 5.5477518e-04 6.8643637e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [0.01117748 0.98707515 0.9978005  0.01503494 0.01098468]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 4 3] pred: [1.5480673e-03 9.9918026e-01 9.9994028e-01 5.2475662e-04 5.9600803e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [0.00395829 0.997903   0.9998386  0.00113496 0.00118939]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [3 4 0 1 2] pred: [0.39358133 0.05328521 0.05182555 0.92187786 0.9166361 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [1.4261960e-03 9.9909163e-01 9.9993050e-01 6.0924224e-04 7.2002411e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [1.3992805e-03 9.9927968e-01 9.9994779e-01 4.7279993e-04 5.5426807e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 4 3] pred: [1.6078409e-03 9.9917644e-01 9.9993920e-01 5.3460343e-04 6.1516400e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 4 3] pred: [1.4170449e-03 9.9928194e-01 9.9994719e-01 4.7194256e-04 5.5391231e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 4 3] pred: [1.3685074e-03 9.9930847e-01 9.9994934e-01 4.5586395e-04 5.3821260e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 4 3] pred: [0.0161338  0.9887683  0.9990258  0.00435247 0.00449469]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [2.0936602e-03 9.9876714e-01 9.9991488e-01 7.2075246e-04 8.1878551e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 4 3] pred: [1.3947695e-03 9.9927956e-01 9.9994695e-01 4.7575956e-04 5.5892055e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [1.3383789e-03 9.9916053e-01 9.9993742e-01 5.5840513e-04 6.6123251e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [2.1747798e-03 9.9885046e-01 9.9990594e-01 7.4148399e-04 8.6921547e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Exécution 1 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:45 - loss: 0.8067 - accuracy: 0.0391 3/11 [=======>......................] - ETA: 0s - loss: 0.8053 - accuracy: 0.1628   5/11 [============>.................] - ETA: 0s - loss: 0.8028 - accuracy: 0.2238 7/11 [==================>...........] - ETA: 0s - loss: 0.8009 - accuracy: 0.2605 9/11 [=======================>......] - ETA: 0s - loss: 0.7993 - accuracy: 0.283711/11 [==============================] - ETA: 0s - loss: 0.7981 - accuracy: 0.302111/11 [==============================] - 17s 29ms/step - loss: 0.7975 - accuracy: 0.3092
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7824 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.7794 - accuracy: 0.4436 5/11 [============>.................] - ETA: 0s - loss: 0.7773 - accuracy: 0.4387 7/11 [==================>...........] - ETA: 0s - loss: 0.7749 - accuracy: 0.440410/11 [==========================>...] - ETA: 0s - loss: 0.7708 - accuracy: 0.441411/11 [==============================] - 0s 28ms/step - loss: 0.7681 - accuracy: 0.4414
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7270 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.7177 - accuracy: 0.4475 5/11 [============>.................] - ETA: 0s - loss: 0.7115 - accuracy: 0.4567 7/11 [==================>...........] - ETA: 0s - loss: 0.7050 - accuracy: 0.4538 9/11 [=======================>......] - ETA: 0s - loss: 0.6986 - accuracy: 0.450311/11 [==============================] - ETA: 0s - loss: 0.6930 - accuracy: 0.449011/11 [==============================] - 0s 28ms/step - loss: 0.6907 - accuracy: 0.4484
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6169 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.6109 - accuracy: 0.3880 5/11 [============>.................] - ETA: 0s - loss: 0.6042 - accuracy: 0.3981 7/11 [==================>...........] - ETA: 0s - loss: 0.6006 - accuracy: 0.4054 9/11 [=======================>......] - ETA: 0s - loss: 0.5962 - accuracy: 0.411211/11 [==============================] - ETA: 0s - loss: 0.5913 - accuracy: 0.416611/11 [==============================] - 0s 29ms/step - loss: 0.5892 - accuracy: 0.4187
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5296 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.5286 - accuracy: 0.4245 5/11 [============>.................] - ETA: 0s - loss: 0.5229 - accuracy: 0.4188 7/11 [==================>...........] - ETA: 0s - loss: 0.5187 - accuracy: 0.4203 9/11 [=======================>......] - ETA: 0s - loss: 0.5162 - accuracy: 0.425011/11 [==============================] - ETA: 0s - loss: 0.5139 - accuracy: 0.428611/11 [==============================] - 0s 27ms/step - loss: 0.5128 - accuracy: 0.4296
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4621 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.4753 - accuracy: 0.4670 5/11 [============>.................] - ETA: 0s - loss: 0.4725 - accuracy: 0.4616 7/11 [==================>...........] - ETA: 0s - loss: 0.4729 - accuracy: 0.4584 9/11 [=======================>......] - ETA: 0s - loss: 0.4741 - accuracy: 0.455311/11 [==============================] - ETA: 0s - loss: 0.4746 - accuracy: 0.452611/11 [==============================] - 0s 28ms/step - loss: 0.4746 - accuracy: 0.4517
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4372 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.4529 - accuracy: 0.4505 5/11 [============>.................] - ETA: 0s - loss: 0.4586 - accuracy: 0.4569 7/11 [==================>...........] - ETA: 0s - loss: 0.4584 - accuracy: 0.4585 9/11 [=======================>......] - ETA: 0s - loss: 0.4576 - accuracy: 0.456211/11 [==============================] - ETA: 0s - loss: 0.4586 - accuracy: 0.453211/11 [==============================] - 0s 28ms/step - loss: 0.4592 - accuracy: 0.4522
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4728 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.4707 - accuracy: 0.4583 5/11 [============>.................] - ETA: 0s - loss: 0.4710 - accuracy: 0.4552 7/11 [==================>...........] - ETA: 0s - loss: 0.4684 - accuracy: 0.4503 9/11 [=======================>......] - ETA: 0s - loss: 0.4664 - accuracy: 0.447611/11 [==============================] - ETA: 0s - loss: 0.4653 - accuracy: 0.446211/11 [==============================] - 0s 29ms/step - loss: 0.4649 - accuracy: 0.4458
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4721 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.4616 - accuracy: 0.4835 5/11 [============>.................] - ETA: 0s - loss: 0.4609 - accuracy: 0.4718 7/11 [==================>...........] - ETA: 0s - loss: 0.4620 - accuracy: 0.4648 9/11 [=======================>......] - ETA: 0s - loss: 0.4627 - accuracy: 0.460511/11 [==============================] - 0s 29ms/step - loss: 0.4619 - accuracy: 0.4571
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4656 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4678 - accuracy: 0.4527 5/11 [============>.................] - ETA: 0s - loss: 0.4634 - accuracy: 0.4548 7/11 [==================>...........] - ETA: 0s - loss: 0.4614 - accuracy: 0.4576 9/11 [=======================>......] - ETA: 0s - loss: 0.4596 - accuracy: 0.455811/11 [==============================] - ETA: 0s - loss: 0.4587 - accuracy: 0.455111/11 [==============================] - 0s 28ms/step - loss: 0.4585 - accuracy: 0.4548
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5021 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4799 - accuracy: 0.4701 5/11 [============>.................] - ETA: 0s - loss: 0.4750 - accuracy: 0.4741 7/11 [==================>...........] - ETA: 0s - loss: 0.4701 - accuracy: 0.4696 9/11 [=======================>......] - ETA: 0s - loss: 0.4661 - accuracy: 0.465311/11 [==============================] - ETA: 0s - loss: 0.4639 - accuracy: 0.462411/11 [==============================] - 0s 28ms/step - loss: 0.4630 - accuracy: 0.4612
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4283 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.4281 - accuracy: 0.4740 5/11 [============>.................] - ETA: 0s - loss: 0.4384 - accuracy: 0.4703 7/11 [==================>...........] - ETA: 0s - loss: 0.4428 - accuracy: 0.4681 9/11 [=======================>......] - ETA: 0s - loss: 0.4441 - accuracy: 0.463811/11 [==============================] - ETA: 0s - loss: 0.4450 - accuracy: 0.461611/11 [==============================] - 0s 29ms/step - loss: 0.4454 - accuracy: 0.4607
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4355 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.4479 - accuracy: 0.4531 5/11 [============>.................] - ETA: 0s - loss: 0.4440 - accuracy: 0.4487 7/11 [==================>...........] - ETA: 0s - loss: 0.4445 - accuracy: 0.4457 9/11 [=======================>......] - ETA: 0s - loss: 0.4451 - accuracy: 0.447311/11 [==============================] - ETA: 0s - loss: 0.4458 - accuracy: 0.449211/11 [==============================] - 0s 30ms/step - loss: 0.4459 - accuracy: 0.4498
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4808 - accuracy: 0.4297 4/11 [=========>....................] - ETA: 0s - loss: 0.4527 - accuracy: 0.4518 6/11 [===============>..............] - ETA: 0s - loss: 0.4469 - accuracy: 0.4495 8/11 [====================>.........] - ETA: 0s - loss: 0.4462 - accuracy: 0.450210/11 [==========================>...] - ETA: 0s - loss: 0.4456 - accuracy: 0.452611/11 [==============================] - 0s 27ms/step - loss: 0.4452 - accuracy: 0.4542
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4187 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.4308 - accuracy: 0.4436 5/11 [============>.................] - ETA: 0s - loss: 0.4341 - accuracy: 0.4437 7/11 [==================>...........] - ETA: 0s - loss: 0.4345 - accuracy: 0.4468 9/11 [=======================>......] - ETA: 0s - loss: 0.4351 - accuracy: 0.451911/11 [==============================] - 0s 28ms/step - loss: 0.4354 - accuracy: 0.4562
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4085 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.4159 - accuracy: 0.4870 5/11 [============>.................] - ETA: 0s - loss: 0.4183 - accuracy: 0.4816 7/11 [==================>...........] - ETA: 0s - loss: 0.4205 - accuracy: 0.4813 9/11 [=======================>......] - ETA: 0s - loss: 0.4228 - accuracy: 0.481811/11 [==============================] - 0s 28ms/step - loss: 0.4248 - accuracy: 0.4832
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4394 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.4296 - accuracy: 0.5239 5/11 [============>.................] - ETA: 0s - loss: 0.4280 - accuracy: 0.5228 7/11 [==================>...........] - ETA: 0s - loss: 0.4273 - accuracy: 0.5240 9/11 [=======================>......] - ETA: 0s - loss: 0.4276 - accuracy: 0.527611/11 [==============================] - 0s 28ms/step - loss: 0.4275 - accuracy: 0.5307
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4133 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.4176 - accuracy: 0.5347 5/11 [============>.................] - ETA: 0s - loss: 0.4199 - accuracy: 0.5415 8/11 [====================>.........] - ETA: 0s - loss: 0.4194 - accuracy: 0.541210/11 [==========================>...] - ETA: 0s - loss: 0.4191 - accuracy: 0.542111/11 [==============================] - 0s 28ms/step - loss: 0.4195 - accuracy: 0.5432
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4185 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.4193 - accuracy: 0.4957 5/11 [============>.................] - ETA: 0s - loss: 0.4178 - accuracy: 0.5072 7/11 [==================>...........] - ETA: 0s - loss: 0.4164 - accuracy: 0.5143 9/11 [=======================>......] - ETA: 0s - loss: 0.4155 - accuracy: 0.520011/11 [==============================] - ETA: 0s - loss: 0.4155 - accuracy: 0.524811/11 [==============================] - 0s 28ms/step - loss: 0.4156 - accuracy: 0.5266
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3942 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.3990 - accuracy: 0.5265 5/11 [============>.................] - ETA: 0s - loss: 0.4047 - accuracy: 0.5403 7/11 [==================>...........] - ETA: 0s - loss: 0.4074 - accuracy: 0.5433 9/11 [=======================>......] - ETA: 0s - loss: 0.4097 - accuracy: 0.545111/11 [==============================] - ETA: 0s - loss: 0.4106 - accuracy: 0.544911/11 [==============================] - 0s 27ms/step - loss: 0.4108 - accuracy: 0.5447
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.4318 - accuracy: 0.57036/6 [==============================] - ETA: 0s - loss: 0.4298 - accuracy: 0.5779 6/6 [==============================] - 5s 11ms/step - loss: 0.4298 - accuracy: 0.5779
2021-12-14 00:04:03.155814: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:04:03.156446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:04:03.156503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:04:03.156545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:04:03.156574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:04:03.156609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:04:03.156644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:04:03.156688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:04:03.156723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:04:03.156757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:04:03.157460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:04:03.157503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:04:03.157514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:04:03.157523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:04:03.158276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:04:03.158574: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:04:03.158950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:04:03.158979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:04:03.159005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:04:03.159033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:04:03.159059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:04:03.159086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:04:03.159112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:04:03.159142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:04:03.159173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:04:03.159894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:04:03.159921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:04:03.159940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:04:03.159949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:04:03.160722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [0.00217063 0.99855953 0.99990475 0.00153812 0.0020668 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [0.00171547 0.99891675 0.9999341  0.00102184 0.00164486]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 4 0] pred: [0.00386993 0.996714   0.9997247  0.00571366 0.00466598]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [1.7965023e-03 9.9898928e-01 9.9993479e-01 8.4122393e-04 1.5925226e-03]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [3 4 0 1 2] pred: [0.549489   0.12808022 0.12249488 0.90641737 0.8585088 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [1.6738541e-03 9.9909675e-01 9.9994135e-01 7.7431632e-04 1.4411797e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 0 2 1] pred: [0.49573994 0.16272801 0.16411453 0.8902542  0.80534637]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 4 3] pred: [1.6772595e-03 9.9909461e-01 9.9994123e-01 7.7577570e-04 1.4445019e-03]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 4 3] pred: [0.00432975 0.9973459  0.9997837  0.00254393 0.00347202]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 4 3] pred: [0.00258798 0.9979956  0.9998704  0.00174278 0.002294  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [0.00484642 0.99595875 0.9996082  0.00745761 0.00510293]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [1.5919481e-03 9.9907172e-01 9.9994290e-01 8.1082917e-04 1.4713879e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 0 2 1] pred: [0.50173724 0.14095394 0.14935866 0.91317487 0.8165942 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 0 1 2] pred: [0.66304696 0.15125684 0.11161254 0.8423197  0.82838494]
 Top predictions indices: [3 4] vs. real classes indices: [3 4]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [1.6751749e-03 9.9905187e-01 9.9994051e-01 8.1403728e-04 1.4797490e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 2 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:34 - loss: 0.8073 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.8024 - accuracy: 0.3976   5/11 [============>.................] - ETA: 0s - loss: 0.8012 - accuracy: 0.4057 7/11 [==================>...........] - ETA: 0s - loss: 0.8000 - accuracy: 0.4126 9/11 [=======================>......] - ETA: 0s - loss: 0.7989 - accuracy: 0.418211/11 [==============================] - 16s 27ms/step - loss: 0.7974 - accuracy: 0.4234
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7805 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.7783 - accuracy: 0.4852 6/11 [===============>..............] - ETA: 0s - loss: 0.7768 - accuracy: 0.4811 8/11 [====================>.........] - ETA: 0s - loss: 0.7745 - accuracy: 0.476110/11 [==========================>...] - ETA: 0s - loss: 0.7715 - accuracy: 0.473211/11 [==============================] - 0s 26ms/step - loss: 0.7686 - accuracy: 0.4711
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7130 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.7115 - accuracy: 0.4783 5/11 [============>.................] - ETA: 0s - loss: 0.7069 - accuracy: 0.4775 7/11 [==================>...........] - ETA: 0s - loss: 0.7014 - accuracy: 0.474810/11 [==========================>...] - ETA: 0s - loss: 0.6930 - accuracy: 0.470811/11 [==============================] - 0s 26ms/step - loss: 0.6880 - accuracy: 0.4691
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6001 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.6036 - accuracy: 0.4627 5/11 [============>.................] - ETA: 0s - loss: 0.6027 - accuracy: 0.4592 7/11 [==================>...........] - ETA: 0s - loss: 0.6003 - accuracy: 0.4580 9/11 [=======================>......] - ETA: 0s - loss: 0.5953 - accuracy: 0.457211/11 [==============================] - 0s 26ms/step - loss: 0.5884 - accuracy: 0.4580
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5140 - accuracy: 0.4062 4/11 [=========>....................] - ETA: 0s - loss: 0.5143 - accuracy: 0.4261 6/11 [===============>..............] - ETA: 0s - loss: 0.5113 - accuracy: 0.4346 8/11 [====================>.........] - ETA: 0s - loss: 0.5105 - accuracy: 0.439110/11 [==========================>...] - ETA: 0s - loss: 0.5104 - accuracy: 0.443111/11 [==============================] - 0s 26ms/step - loss: 0.5097 - accuracy: 0.4460
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4586 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 0s - loss: 0.4795 - accuracy: 0.4777 6/11 [===============>..............] - ETA: 0s - loss: 0.4813 - accuracy: 0.4731 8/11 [====================>.........] - ETA: 0s - loss: 0.4795 - accuracy: 0.469811/11 [==============================] - ETA: 0s - loss: 0.4791 - accuracy: 0.466511/11 [==============================] - 0s 25ms/step - loss: 0.4791 - accuracy: 0.4660
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5116 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.5023 - accuracy: 0.4592 5/11 [============>.................] - ETA: 0s - loss: 0.4952 - accuracy: 0.4670 8/11 [====================>.........] - ETA: 0s - loss: 0.4891 - accuracy: 0.475310/11 [==========================>...] - ETA: 0s - loss: 0.4853 - accuracy: 0.475411/11 [==============================] - 0s 27ms/step - loss: 0.4824 - accuracy: 0.4742
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4698 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.4675 - accuracy: 0.4857 7/11 [==================>...........] - ETA: 0s - loss: 0.4721 - accuracy: 0.4782 9/11 [=======================>......] - ETA: 0s - loss: 0.4705 - accuracy: 0.474711/11 [==============================] - 0s 26ms/step - loss: 0.4690 - accuracy: 0.4737
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4859 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.4804 - accuracy: 0.5039 5/11 [============>.................] - ETA: 0s - loss: 0.4743 - accuracy: 0.5003 7/11 [==================>...........] - ETA: 0s - loss: 0.4699 - accuracy: 0.4963 9/11 [=======================>......] - ETA: 0s - loss: 0.4673 - accuracy: 0.493711/11 [==============================] - ETA: 0s - loss: 0.4657 - accuracy: 0.491011/11 [==============================] - 0s 28ms/step - loss: 0.4650 - accuracy: 0.4899
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4713 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.4655 - accuracy: 0.5438 5/11 [============>.................] - ETA: 0s - loss: 0.4645 - accuracy: 0.5344 8/11 [====================>.........] - ETA: 0s - loss: 0.4598 - accuracy: 0.521210/11 [==========================>...] - ETA: 0s - loss: 0.4584 - accuracy: 0.516611/11 [==============================] - 0s 26ms/step - loss: 0.4571 - accuracy: 0.5133
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4183 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.4320 - accuracy: 0.4983 5/11 [============>.................] - ETA: 0s - loss: 0.4334 - accuracy: 0.5010 7/11 [==================>...........] - ETA: 0s - loss: 0.4334 - accuracy: 0.4985 9/11 [=======================>......] - ETA: 0s - loss: 0.4353 - accuracy: 0.496311/11 [==============================] - 0s 27ms/step - loss: 0.4375 - accuracy: 0.4937
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4519 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 0s - loss: 0.4507 - accuracy: 0.5065 5/11 [============>.................] - ETA: 0s - loss: 0.4504 - accuracy: 0.4919 7/11 [==================>...........] - ETA: 0s - loss: 0.4489 - accuracy: 0.4856 9/11 [=======================>......] - ETA: 0s - loss: 0.4472 - accuracy: 0.481211/11 [==============================] - ETA: 0s - loss: 0.4458 - accuracy: 0.478511/11 [==============================] - 0s 28ms/step - loss: 0.4452 - accuracy: 0.4774
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4237 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.4373 - accuracy: 0.5043 5/11 [============>.................] - ETA: 0s - loss: 0.4353 - accuracy: 0.4853 8/11 [====================>.........] - ETA: 0s - loss: 0.4339 - accuracy: 0.477010/11 [==========================>...] - ETA: 0s - loss: 0.4336 - accuracy: 0.474911/11 [==============================] - 0s 27ms/step - loss: 0.4337 - accuracy: 0.4735
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4455 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.4400 - accuracy: 0.5109 5/11 [============>.................] - ETA: 0s - loss: 0.4365 - accuracy: 0.5012 8/11 [====================>.........] - ETA: 0s - loss: 0.4329 - accuracy: 0.490210/11 [==========================>...] - ETA: 0s - loss: 0.4323 - accuracy: 0.487011/11 [==============================] - 0s 27ms/step - loss: 0.4317 - accuracy: 0.4851
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4576 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.4401 - accuracy: 0.5321 5/11 [============>.................] - ETA: 0s - loss: 0.4340 - accuracy: 0.5207 7/11 [==================>...........] - ETA: 0s - loss: 0.4313 - accuracy: 0.5118 9/11 [=======================>......] - ETA: 0s - loss: 0.4297 - accuracy: 0.504411/11 [==============================] - ETA: 0s - loss: 0.4288 - accuracy: 0.499411/11 [==============================] - 0s 28ms/step - loss: 0.4284 - accuracy: 0.4974
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3675 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.3966 - accuracy: 0.4518 5/11 [============>.................] - ETA: 0s - loss: 0.4067 - accuracy: 0.4591 7/11 [==================>...........] - ETA: 0s - loss: 0.4118 - accuracy: 0.4618 9/11 [=======================>......] - ETA: 0s - loss: 0.4145 - accuracy: 0.465211/11 [==============================] - ETA: 0s - loss: 0.4159 - accuracy: 0.467411/11 [==============================] - 0s 27ms/step - loss: 0.4162 - accuracy: 0.4680
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4180 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.4117 - accuracy: 0.4714 6/11 [===============>..............] - ETA: 0s - loss: 0.4133 - accuracy: 0.4791 8/11 [====================>.........] - ETA: 0s - loss: 0.4131 - accuracy: 0.479610/11 [==========================>...] - ETA: 0s - loss: 0.4132 - accuracy: 0.478911/11 [==============================] - 0s 27ms/step - loss: 0.4137 - accuracy: 0.4789
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3928 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4024 - accuracy: 0.4648 6/11 [===============>..............] - ETA: 0s - loss: 0.4074 - accuracy: 0.4766 8/11 [====================>.........] - ETA: 0s - loss: 0.4086 - accuracy: 0.478011/11 [==============================] - ETA: 0s - loss: 0.4094 - accuracy: 0.479011/11 [==============================] - 0s 25ms/step - loss: 0.4097 - accuracy: 0.4791
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4148 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.4161 - accuracy: 0.4592 6/11 [===============>..............] - ETA: 0s - loss: 0.4135 - accuracy: 0.4618 8/11 [====================>.........] - ETA: 0s - loss: 0.4123 - accuracy: 0.463310/11 [==========================>...] - ETA: 0s - loss: 0.4121 - accuracy: 0.467411/11 [==============================] - 0s 26ms/step - loss: 0.4118 - accuracy: 0.4709
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3966 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4013 - accuracy: 0.4609 5/11 [============>.................] - ETA: 0s - loss: 0.4035 - accuracy: 0.4728 7/11 [==================>...........] - ETA: 0s - loss: 0.4051 - accuracy: 0.4817 9/11 [=======================>......] - ETA: 0s - loss: 0.4051 - accuracy: 0.486711/11 [==============================] - ETA: 0s - loss: 0.4054 - accuracy: 0.490611/11 [==============================] - 0s 27ms/step - loss: 0.4055 - accuracy: 0.4921
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.4359 - accuracy: 0.55476/6 [==============================] - ETA: 0s - loss: 0.4061 - accuracy: 0.5028 6/6 [==============================] - 5s 10ms/step - loss: 0.4061 - accuracy: 0.5028
2021-12-14 00:04:40.261133: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:04:40.262016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:04:40.262106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:04:40.262182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:04:40.262231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:04:40.262279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:04:40.262321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:04:40.262375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:04:40.262436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:04:40.262520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:04:40.263536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:04:40.263604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:04:40.263623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:04:40.263636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:04:40.264713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:04:40.265133: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:04:40.265662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:04:40.265704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:04:40.265744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:04:40.265784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:04:40.265823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:04:40.265862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:04:40.265902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:04:40.265958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:04:40.266000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:04:40.266962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:04:40.267004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:04:40.267021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:04:40.267033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:04:40.268018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [3.2358863e-03 9.9926323e-01 9.9987566e-01 3.8020138e-04 6.4986170e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [3.5046672e-03 9.9922383e-01 9.9985504e-01 4.8911781e-04 7.2125543e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [4 3 0 1 2] pred: [0.26546055 0.0608542  0.03993951 0.9168158  0.93763494]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [3.2333098e-03 9.9926549e-01 9.9987602e-01 3.7859514e-04 6.4839050e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [3.3573743e-03 9.9925870e-01 9.9987221e-01 4.1058054e-04 6.6711352e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [2.9001599e-03 9.9921238e-01 9.9986935e-01 4.0013093e-04 7.1450206e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [2.9512739e-03 9.9918789e-01 9.9986446e-01 4.2364257e-04 7.4093690e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 0 1 2] pred: [0.28558436 0.03395543 0.02270645 0.9588309  0.9558752 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [4 3 0 1 2] pred: [0.2779904  0.0306555  0.0191523  0.96218556 0.9622724 ]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 4 3] pred: [5.5548511e-03 9.9902010e-01 9.9978346e-01 8.5169461e-04 1.1326278e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 4 3] pred: [3.4643663e-03 9.9920744e-01 9.9986434e-01 4.3720871e-04 7.0959906e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [3.2683499e-03 9.9926132e-01 9.9987447e-01 3.8650457e-04 6.5365201e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 4 3] pred: [3.2021196e-03 9.9895501e-01 9.9983025e-01 5.6094170e-04 9.4139809e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [3.2329638e-03 9.9926943e-01 9.9987686e-01 3.7332662e-04 6.4393325e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [3.2543777e-03 9.9926335e-01 9.9987543e-01 3.8392100e-04 6.5204088e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 3 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:35 - loss: 0.8014 - accuracy: 0.3672 3/11 [=======>......................] - ETA: 0s - loss: 0.8004 - accuracy: 0.3863   5/11 [============>.................] - ETA: 0s - loss: 0.7990 - accuracy: 0.3976 7/11 [==================>...........] - ETA: 0s - loss: 0.7984 - accuracy: 0.4075 9/11 [=======================>......] - ETA: 0s - loss: 0.7979 - accuracy: 0.414711/11 [==============================] - 16s 28ms/step - loss: 0.7970 - accuracy: 0.4215
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7801 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.7822 - accuracy: 0.5000 5/11 [============>.................] - ETA: 0s - loss: 0.7799 - accuracy: 0.4831 7/11 [==================>...........] - ETA: 0s - loss: 0.7775 - accuracy: 0.4722 9/11 [=======================>......] - ETA: 0s - loss: 0.7753 - accuracy: 0.466111/11 [==============================] - ETA: 0s - loss: 0.7732 - accuracy: 0.463311/11 [==============================] - 0s 30ms/step - loss: 0.7723 - accuracy: 0.4625
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7102 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.7094 - accuracy: 0.4293 5/11 [============>.................] - ETA: 0s - loss: 0.7066 - accuracy: 0.4383 7/11 [==================>...........] - ETA: 0s - loss: 0.7029 - accuracy: 0.4410 9/11 [=======================>......] - ETA: 0s - loss: 0.6982 - accuracy: 0.442911/11 [==============================] - ETA: 0s - loss: 0.6933 - accuracy: 0.444911/11 [==============================] - 0s 29ms/step - loss: 0.6913 - accuracy: 0.4456
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6039 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.5894 - accuracy: 0.4362 5/11 [============>.................] - ETA: 0s - loss: 0.5818 - accuracy: 0.4375 7/11 [==================>...........] - ETA: 0s - loss: 0.5752 - accuracy: 0.4380 9/11 [=======================>......] - ETA: 0s - loss: 0.5702 - accuracy: 0.439011/11 [==============================] - ETA: 0s - loss: 0.5664 - accuracy: 0.441111/11 [==============================] - 0s 29ms/step - loss: 0.5650 - accuracy: 0.4421
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4901 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.4969 - accuracy: 0.4484 5/11 [============>.................] - ETA: 0s - loss: 0.4943 - accuracy: 0.4520 7/11 [==================>...........] - ETA: 0s - loss: 0.4933 - accuracy: 0.4511 9/11 [=======================>......] - ETA: 0s - loss: 0.4927 - accuracy: 0.452111/11 [==============================] - ETA: 0s - loss: 0.4925 - accuracy: 0.451811/11 [==============================] - 0s 29ms/step - loss: 0.4925 - accuracy: 0.4520
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5042 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.4791 - accuracy: 0.4674 5/11 [============>.................] - ETA: 0s - loss: 0.4743 - accuracy: 0.4723 7/11 [==================>...........] - ETA: 0s - loss: 0.4740 - accuracy: 0.4713 9/11 [=======================>......] - ETA: 0s - loss: 0.4737 - accuracy: 0.468011/11 [==============================] - ETA: 0s - loss: 0.4738 - accuracy: 0.465211/11 [==============================] - 0s 28ms/step - loss: 0.4738 - accuracy: 0.4642
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4325 - accuracy: 0.3984 3/11 [=======>......................] - ETA: 0s - loss: 0.4489 - accuracy: 0.4266 5/11 [============>.................] - ETA: 0s - loss: 0.4566 - accuracy: 0.4306 7/11 [==================>...........] - ETA: 0s - loss: 0.4602 - accuracy: 0.4375 9/11 [=======================>......] - ETA: 0s - loss: 0.4619 - accuracy: 0.441311/11 [==============================] - ETA: 0s - loss: 0.4626 - accuracy: 0.443711/11 [==============================] - 0s 29ms/step - loss: 0.4630 - accuracy: 0.4445
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4791 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.4806 - accuracy: 0.4818 5/11 [============>.................] - ETA: 0s - loss: 0.4779 - accuracy: 0.4738 7/11 [==================>...........] - ETA: 0s - loss: 0.4753 - accuracy: 0.470110/11 [==========================>...] - ETA: 0s - loss: 0.4731 - accuracy: 0.465611/11 [==============================] - 0s 28ms/step - loss: 0.4715 - accuracy: 0.4637
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4647 - accuracy: 0.3906 3/11 [=======>......................] - ETA: 0s - loss: 0.4668 - accuracy: 0.4227 5/11 [============>.................] - ETA: 0s - loss: 0.4674 - accuracy: 0.4354 8/11 [====================>.........] - ETA: 0s - loss: 0.4670 - accuracy: 0.442410/11 [==========================>...] - ETA: 0s - loss: 0.4658 - accuracy: 0.445111/11 [==============================] - 0s 28ms/step - loss: 0.4650 - accuracy: 0.4472
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4508 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4654 - accuracy: 0.4527 5/11 [============>.................] - ETA: 0s - loss: 0.4637 - accuracy: 0.4576 7/11 [==================>...........] - ETA: 0s - loss: 0.4602 - accuracy: 0.4601 9/11 [=======================>......] - ETA: 0s - loss: 0.4591 - accuracy: 0.459811/11 [==============================] - 0s 28ms/step - loss: 0.4592 - accuracy: 0.4601
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5097 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.4936 - accuracy: 0.4449 6/11 [===============>..............] - ETA: 0s - loss: 0.4847 - accuracy: 0.4473 8/11 [====================>.........] - ETA: 0s - loss: 0.4804 - accuracy: 0.450710/11 [==========================>...] - ETA: 0s - loss: 0.4772 - accuracy: 0.454311/11 [==============================] - 0s 28ms/step - loss: 0.4737 - accuracy: 0.4560
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4750 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.4701 - accuracy: 0.4766 5/11 [============>.................] - ETA: 0s - loss: 0.4629 - accuracy: 0.4712 7/11 [==================>...........] - ETA: 0s - loss: 0.4605 - accuracy: 0.4678 9/11 [=======================>......] - ETA: 0s - loss: 0.4583 - accuracy: 0.467911/11 [==============================] - 0s 28ms/step - loss: 0.4570 - accuracy: 0.4683
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4680 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.4577 - accuracy: 0.4262 5/11 [============>.................] - ETA: 0s - loss: 0.4578 - accuracy: 0.4407 7/11 [==================>...........] - ETA: 0s - loss: 0.4572 - accuracy: 0.4494 9/11 [=======================>......] - ETA: 0s - loss: 0.4555 - accuracy: 0.453911/11 [==============================] - ETA: 0s - loss: 0.4541 - accuracy: 0.458411/11 [==============================] - 0s 29ms/step - loss: 0.4536 - accuracy: 0.4602
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3990 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.4217 - accuracy: 0.4718 6/11 [===============>..............] - ETA: 0s - loss: 0.4230 - accuracy: 0.4751 9/11 [=======================>......] - ETA: 0s - loss: 0.4264 - accuracy: 0.480111/11 [==============================] - ETA: 0s - loss: 0.4286 - accuracy: 0.481611/11 [==============================] - 0s 27ms/step - loss: 0.4295 - accuracy: 0.4821
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4533 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.4482 - accuracy: 0.5295 5/11 [============>.................] - ETA: 0s - loss: 0.4457 - accuracy: 0.5168 7/11 [==================>...........] - ETA: 0s - loss: 0.4434 - accuracy: 0.5143 9/11 [=======================>......] - ETA: 0s - loss: 0.4421 - accuracy: 0.514011/11 [==============================] - ETA: 0s - loss: 0.4406 - accuracy: 0.513811/11 [==============================] - 0s 29ms/step - loss: 0.4399 - accuracy: 0.5138
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4361 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 0s - loss: 0.4413 - accuracy: 0.5490 5/11 [============>.................] - ETA: 0s - loss: 0.4394 - accuracy: 0.5462 7/11 [==================>...........] - ETA: 0s - loss: 0.4356 - accuracy: 0.5439 9/11 [=======================>......] - ETA: 0s - loss: 0.4342 - accuracy: 0.543911/11 [==============================] - ETA: 0s - loss: 0.4329 - accuracy: 0.543811/11 [==============================] - 0s 30ms/step - loss: 0.4325 - accuracy: 0.5439
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4260 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.4277 - accuracy: 0.5560 6/11 [===============>..............] - ETA: 0s - loss: 0.4300 - accuracy: 0.5501 8/11 [====================>.........] - ETA: 0s - loss: 0.4283 - accuracy: 0.550410/11 [==========================>...] - ETA: 0s - loss: 0.4269 - accuracy: 0.550111/11 [==============================] - 0s 30ms/step - loss: 0.4259 - accuracy: 0.5505
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3990 - accuracy: 0.5938 3/11 [=======>......................] - ETA: 0s - loss: 0.4097 - accuracy: 0.5898 5/11 [============>.................] - ETA: 0s - loss: 0.4146 - accuracy: 0.5862 7/11 [==================>...........] - ETA: 0s - loss: 0.4146 - accuracy: 0.5791 9/11 [=======================>......] - ETA: 0s - loss: 0.4146 - accuracy: 0.574411/11 [==============================] - ETA: 0s - loss: 0.4146 - accuracy: 0.571211/11 [==============================] - 0s 29ms/step - loss: 0.4146 - accuracy: 0.5699
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4177 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.4193 - accuracy: 0.5573 5/11 [============>.................] - ETA: 0s - loss: 0.4157 - accuracy: 0.5569 7/11 [==================>...........] - ETA: 0s - loss: 0.4135 - accuracy: 0.5585 9/11 [=======================>......] - ETA: 0s - loss: 0.4119 - accuracy: 0.558611/11 [==============================] - ETA: 0s - loss: 0.4111 - accuracy: 0.557811/11 [==============================] - 0s 30ms/step - loss: 0.4108 - accuracy: 0.5575
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4146 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.3973 - accuracy: 0.5326 5/11 [============>.................] - ETA: 0s - loss: 0.3929 - accuracy: 0.5290 7/11 [==================>...........] - ETA: 0s - loss: 0.3926 - accuracy: 0.5301 9/11 [=======================>......] - ETA: 0s - loss: 0.3935 - accuracy: 0.532811/11 [==============================] - 0s 28ms/step - loss: 0.3943 - accuracy: 0.5382
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.3554 - accuracy: 0.55476/6 [==============================] - ETA: 0s - loss: 0.3769 - accuracy: 0.5538 6/6 [==============================] - 5s 11ms/step - loss: 0.3769 - accuracy: 0.5538
2021-12-14 00:05:17.830085: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:05:17.830948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:05:17.831022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:05:17.831079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:05:17.831121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:05:17.831168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:05:17.831230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:05:17.831284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:05:17.831331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:05:17.831373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:05:17.832414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:05:17.832473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:05:17.832491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:05:17.832504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:05:17.833605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:05:17.834020: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:05:17.834577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:05:17.834620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:05:17.834659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:05:17.834698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:05:17.834738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:05:17.834782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:05:17.834826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:05:17.834867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:05:17.834912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:05:17.835883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:05:17.835925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:05:17.835951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:05:17.835963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:05:17.836952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 4 0 3] pred: [1.1755017e-03 9.8285747e-01 9.9982113e-01 9.2805503e-04 1.5765663e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [1.3636603e-03 9.9048424e-01 9.9987018e-01 5.8093551e-04 1.2578112e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 0 3] pred: [0.00114403 0.9794897  0.9997998  0.00107201 0.00171597]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [1.8560358e-03 9.9448276e-01 9.9989092e-01 4.2142501e-04 1.2265390e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 4 0 3] pred: [1.1332635e-03 9.8565698e-01 9.9984396e-01 7.8467239e-04 1.3748280e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [3.3639639e-03 9.9578887e-01 9.9983180e-01 4.4645683e-04 1.3041105e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 3 0] pred: [0.0021425  0.60790074 0.9941288  0.02586997 0.03006019]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 3 0] pred: [9.4064669e-04 9.5120960e-01 9.9964619e-01 2.0294345e-03 2.8018993e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 3 0] pred: [0.00262873 0.55439097 0.9911048  0.03853215 0.05143055]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 4 0 3] pred: [0.00365015 0.98175675 0.9996408  0.00158063 0.00382474]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 4 3 0] pred: [0.00373026 0.5614483  0.9890459  0.04637678 0.07073415]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 0 3] pred: [0.0052152  0.9488752  0.9989791  0.00480072 0.00950817]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 3 0] pred: [0.00222526 0.5684441  0.99216366 0.03157897 0.04096435]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [1.6794571e-03 9.9382645e-01 9.9989164e-01 4.4099160e-04 1.2421613e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 4 0 3] pred: [1.1411031e-03 9.8616040e-01 9.9984646e-01 7.6357531e-04 1.3252553e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 4 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:33 - loss: 0.8019 - accuracy: 0.3203 3/11 [=======>......................] - ETA: 0s - loss: 0.8001 - accuracy: 0.3381   5/11 [============>.................] - ETA: 0s - loss: 0.8003 - accuracy: 0.3593 7/11 [==================>...........] - ETA: 0s - loss: 0.7998 - accuracy: 0.3738 9/11 [=======================>......] - ETA: 0s - loss: 0.7989 - accuracy: 0.382211/11 [==============================] - 16s 28ms/step - loss: 0.7977 - accuracy: 0.3910
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7808 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.7814 - accuracy: 0.4488 5/11 [============>.................] - ETA: 0s - loss: 0.7795 - accuracy: 0.4465 7/11 [==================>...........] - ETA: 0s - loss: 0.7774 - accuracy: 0.4459 9/11 [=======================>......] - ETA: 0s - loss: 0.7752 - accuracy: 0.445911/11 [==============================] - ETA: 0s - loss: 0.7731 - accuracy: 0.446411/11 [==============================] - 0s 27ms/step - loss: 0.7722 - accuracy: 0.4466
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7233 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.7207 - accuracy: 0.4210 5/11 [============>.................] - ETA: 0s - loss: 0.7156 - accuracy: 0.4246 7/11 [==================>...........] - ETA: 0s - loss: 0.7110 - accuracy: 0.4291 9/11 [=======================>......] - ETA: 0s - loss: 0.7054 - accuracy: 0.433011/11 [==============================] - 0s 28ms/step - loss: 0.6974 - accuracy: 0.4366
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5869 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.5875 - accuracy: 0.4557 5/11 [============>.................] - ETA: 0s - loss: 0.5822 - accuracy: 0.4492 7/11 [==================>...........] - ETA: 0s - loss: 0.5769 - accuracy: 0.4515 9/11 [=======================>......] - ETA: 0s - loss: 0.5727 - accuracy: 0.453111/11 [==============================] - 0s 29ms/step - loss: 0.5667 - accuracy: 0.4524
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5426 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.5371 - accuracy: 0.4444 5/11 [============>.................] - ETA: 0s - loss: 0.5253 - accuracy: 0.4453 7/11 [==================>...........] - ETA: 0s - loss: 0.5160 - accuracy: 0.4459 9/11 [=======================>......] - ETA: 0s - loss: 0.5098 - accuracy: 0.446611/11 [==============================] - ETA: 0s - loss: 0.5057 - accuracy: 0.447111/11 [==============================] - 0s 27ms/step - loss: 0.5041 - accuracy: 0.4473
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4981 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.4835 - accuracy: 0.4549 5/11 [============>.................] - ETA: 0s - loss: 0.4831 - accuracy: 0.4519 7/11 [==================>...........] - ETA: 0s - loss: 0.4801 - accuracy: 0.4558 9/11 [=======================>......] - ETA: 0s - loss: 0.4784 - accuracy: 0.455211/11 [==============================] - 0s 28ms/step - loss: 0.4762 - accuracy: 0.4547
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4627 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.4689 - accuracy: 0.4557 5/11 [============>.................] - ETA: 0s - loss: 0.4673 - accuracy: 0.4530 7/11 [==================>...........] - ETA: 0s - loss: 0.4659 - accuracy: 0.4545 9/11 [=======================>......] - ETA: 0s - loss: 0.4648 - accuracy: 0.456111/11 [==============================] - ETA: 0s - loss: 0.4643 - accuracy: 0.456911/11 [==============================] - 0s 27ms/step - loss: 0.4642 - accuracy: 0.4571
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4631 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.4606 - accuracy: 0.4466 5/11 [============>.................] - ETA: 0s - loss: 0.4555 - accuracy: 0.4457 8/11 [====================>.........] - ETA: 0s - loss: 0.4543 - accuracy: 0.450210/11 [==========================>...] - ETA: 0s - loss: 0.4546 - accuracy: 0.453511/11 [==============================] - 0s 28ms/step - loss: 0.4549 - accuracy: 0.4560
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4494 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.4318 - accuracy: 0.4601 5/11 [============>.................] - ETA: 0s - loss: 0.4313 - accuracy: 0.4692 7/11 [==================>...........] - ETA: 0s - loss: 0.4337 - accuracy: 0.4731 9/11 [=======================>......] - ETA: 0s - loss: 0.4363 - accuracy: 0.476611/11 [==============================] - ETA: 0s - loss: 0.4383 - accuracy: 0.479711/11 [==============================] - 0s 27ms/step - loss: 0.4390 - accuracy: 0.4808
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4792 - accuracy: 0.5391 4/11 [=========>....................] - ETA: 0s - loss: 0.4616 - accuracy: 0.5311 6/11 [===============>..............] - ETA: 0s - loss: 0.4576 - accuracy: 0.5201 8/11 [====================>.........] - ETA: 0s - loss: 0.4543 - accuracy: 0.514810/11 [==========================>...] - ETA: 0s - loss: 0.4524 - accuracy: 0.512411/11 [==============================] - 0s 29ms/step - loss: 0.4504 - accuracy: 0.5095
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4025 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.4128 - accuracy: 0.4857 5/11 [============>.................] - ETA: 0s - loss: 0.4163 - accuracy: 0.4802 7/11 [==================>...........] - ETA: 0s - loss: 0.4202 - accuracy: 0.4792 9/11 [=======================>......] - ETA: 0s - loss: 0.4227 - accuracy: 0.482111/11 [==============================] - 0s 28ms/step - loss: 0.4257 - accuracy: 0.4865
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4215 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.4281 - accuracy: 0.5022 5/11 [============>.................] - ETA: 0s - loss: 0.4325 - accuracy: 0.5023 7/11 [==================>...........] - ETA: 0s - loss: 0.4321 - accuracy: 0.5012 9/11 [=======================>......] - ETA: 0s - loss: 0.4325 - accuracy: 0.502911/11 [==============================] - ETA: 0s - loss: 0.4319 - accuracy: 0.503511/11 [==============================] - 0s 30ms/step - loss: 0.4318 - accuracy: 0.5034
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4554 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 0s - loss: 0.4394 - accuracy: 0.4878 5/11 [============>.................] - ETA: 0s - loss: 0.4318 - accuracy: 0.4831 7/11 [==================>...........] - ETA: 0s - loss: 0.4277 - accuracy: 0.4835 9/11 [=======================>......] - ETA: 0s - loss: 0.4261 - accuracy: 0.486711/11 [==============================] - 0s 28ms/step - loss: 0.4260 - accuracy: 0.4915
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4440 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.4372 - accuracy: 0.5204 5/11 [============>.................] - ETA: 0s - loss: 0.4319 - accuracy: 0.5254 7/11 [==================>...........] - ETA: 0s - loss: 0.4285 - accuracy: 0.5280 9/11 [=======================>......] - ETA: 0s - loss: 0.4272 - accuracy: 0.530611/11 [==============================] - 0s 28ms/step - loss: 0.4256 - accuracy: 0.5319
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4157 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.4283 - accuracy: 0.5747 5/11 [============>.................] - ETA: 0s - loss: 0.4295 - accuracy: 0.5783 7/11 [==================>...........] - ETA: 0s - loss: 0.4257 - accuracy: 0.5726 9/11 [=======================>......] - ETA: 0s - loss: 0.4229 - accuracy: 0.569511/11 [==============================] - 0s 28ms/step - loss: 0.4185 - accuracy: 0.5671
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4086 - accuracy: 0.5859 3/11 [=======>......................] - ETA: 0s - loss: 0.3851 - accuracy: 0.5868 5/11 [============>.................] - ETA: 0s - loss: 0.3815 - accuracy: 0.5858 8/11 [====================>.........] - ETA: 0s - loss: 0.3761 - accuracy: 0.577410/11 [==========================>...] - ETA: 0s - loss: 0.3713 - accuracy: 0.575011/11 [==============================] - 0s 29ms/step - loss: 0.3674 - accuracy: 0.5737
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3187 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.3071 - accuracy: 0.5634 5/11 [============>.................] - ETA: 0s - loss: 0.3052 - accuracy: 0.5621 7/11 [==================>...........] - ETA: 0s - loss: 0.3025 - accuracy: 0.5634 9/11 [=======================>......] - ETA: 0s - loss: 0.2998 - accuracy: 0.564911/11 [==============================] - ETA: 0s - loss: 0.2987 - accuracy: 0.565811/11 [==============================] - 0s 28ms/step - loss: 0.2983 - accuracy: 0.5664
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2953 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.2752 - accuracy: 0.6172 5/11 [============>.................] - ETA: 0s - loss: 0.2755 - accuracy: 0.6067 7/11 [==================>...........] - ETA: 0s - loss: 0.2769 - accuracy: 0.5978 9/11 [=======================>......] - ETA: 0s - loss: 0.2773 - accuracy: 0.592111/11 [==============================] - ETA: 0s - loss: 0.2761 - accuracy: 0.588611/11 [==============================] - 0s 29ms/step - loss: 0.2755 - accuracy: 0.5873
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2532 - accuracy: 0.6250 3/11 [=======>......................] - ETA: 0s - loss: 0.2674 - accuracy: 0.6016 5/11 [============>.................] - ETA: 0s - loss: 0.2706 - accuracy: 0.5873 7/11 [==================>...........] - ETA: 0s - loss: 0.2708 - accuracy: 0.5794 9/11 [=======================>......] - ETA: 0s - loss: 0.2686 - accuracy: 0.573811/11 [==============================] - ETA: 0s - loss: 0.2660 - accuracy: 0.570111/11 [==============================] - 0s 28ms/step - loss: 0.2650 - accuracy: 0.5687
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2450 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.2570 - accuracy: 0.5438 5/11 [============>.................] - ETA: 0s - loss: 0.2553 - accuracy: 0.5454 7/11 [==================>...........] - ETA: 0s - loss: 0.2523 - accuracy: 0.5470 9/11 [=======================>......] - ETA: 0s - loss: 0.2512 - accuracy: 0.547111/11 [==============================] - ETA: 0s - loss: 0.2500 - accuracy: 0.546311/11 [==============================] - 0s 30ms/step - loss: 0.2496 - accuracy: 0.5458
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.2047 - accuracy: 0.57036/6 [==============================] - ETA: 0s - loss: 0.2299 - accuracy: 0.5623 6/6 [==============================] - 5s 11ms/step - loss: 0.2299 - accuracy: 0.5623
2021-12-14 00:05:55.597058: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:05:55.597852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:05:55.597924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:05:55.597993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:05:55.598034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:05:55.598082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:05:55.598127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:05:55.598171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:05:55.598215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:05:55.598261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:05:55.599180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:05:55.599233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:05:55.599250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:05:55.599262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:05:55.600236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:05:55.600722: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:05:55.601510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:05:55.601551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:05:55.601589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:05:55.601627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:05:55.601667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:05:55.601705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:05:55.601744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:05:55.601782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:05:55.601819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:05:55.602714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:05:55.602753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:05:55.602768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:05:55.602780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:05:55.603785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [1.9206776e-03 9.8330152e-01 9.9997211e-01 3.7564160e-04 9.8554519e-05]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [0.00302531 0.01044509 0.9965004  0.0076265  0.00180791]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 0 4] pred: [0.00290875 0.00478055 0.9973642  0.00695916 0.00168428]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 1 0 4] pred: [0.0032907  0.00579425 0.997849   0.00613563 0.00163272]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [0.0033379  0.00579435 0.9979243  0.00577006 0.00163624]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 0 4] pred: [0.00301164 0.00527567 0.9981584  0.00536856 0.00148337]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 0 4] pred: [0.00298398 0.00489767 0.99804246 0.00563214 0.0015266 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 0 4] pred: [0.00297104 0.00498123 0.9980134  0.00570761 0.00152709]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 3 4] pred: [5.2022585e-03 9.9528909e-01 9.9997044e-01 2.9057558e-04 1.6880446e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [0.00304265 0.00561831 0.9983158  0.00506013 0.00142279]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [4.8561497e-03 9.7948670e-01 9.9994552e-01 6.8550080e-04 1.8262101e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [0.00337236 0.00606859 0.9980458  0.00560037 0.00161246]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [4.3362365e-03 9.9470156e-01 9.9997294e-01 2.8412949e-04 1.5302916e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 0 4] pred: [0.00295412 0.00501032 0.9979954  0.00573904 0.00152832]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [3.1513658e-03 9.9212986e-01 9.9997437e-01 3.0865188e-04 1.2520111e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
Exécution 5 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:41 - loss: 0.8008 - accuracy: 0.3125 3/11 [=======>......................] - ETA: 0s - loss: 0.8011 - accuracy: 0.3472   5/11 [============>.................] - ETA: 0s - loss: 0.8000 - accuracy: 0.3782 7/11 [==================>...........] - ETA: 0s - loss: 0.7995 - accuracy: 0.3960 9/11 [=======================>......] - ETA: 0s - loss: 0.7987 - accuracy: 0.408211/11 [==============================] - ETA: 0s - loss: 0.7977 - accuracy: 0.415611/11 [==============================] - 16s 28ms/step - loss: 0.7972 - accuracy: 0.4183
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7740 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.7768 - accuracy: 0.4349 6/11 [===============>..............] - ETA: 0s - loss: 0.7740 - accuracy: 0.4461 8/11 [====================>.........] - ETA: 0s - loss: 0.7717 - accuracy: 0.449810/11 [==========================>...] - ETA: 0s - loss: 0.7695 - accuracy: 0.453011/11 [==============================] - 0s 27ms/step - loss: 0.7675 - accuracy: 0.4546
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7262 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.7198 - accuracy: 0.4696 5/11 [============>.................] - ETA: 0s - loss: 0.7138 - accuracy: 0.4618 7/11 [==================>...........] - ETA: 0s - loss: 0.7074 - accuracy: 0.4601 9/11 [=======================>......] - ETA: 0s - loss: 0.7017 - accuracy: 0.461811/11 [==============================] - ETA: 0s - loss: 0.6964 - accuracy: 0.462111/11 [==============================] - 0s 27ms/step - loss: 0.6942 - accuracy: 0.4622
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6039 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 0s - loss: 0.6017 - accuracy: 0.4665 6/11 [===============>..............] - ETA: 0s - loss: 0.5972 - accuracy: 0.4612 8/11 [====================>.........] - ETA: 0s - loss: 0.5929 - accuracy: 0.459610/11 [==========================>...] - ETA: 0s - loss: 0.5888 - accuracy: 0.459811/11 [==============================] - 0s 28ms/step - loss: 0.5857 - accuracy: 0.4603
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5349 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.5309 - accuracy: 0.4770 5/11 [============>.................] - ETA: 0s - loss: 0.5293 - accuracy: 0.4782 7/11 [==================>...........] - ETA: 0s - loss: 0.5273 - accuracy: 0.4768 9/11 [=======================>......] - ETA: 0s - loss: 0.5247 - accuracy: 0.475211/11 [==============================] - 0s 29ms/step - loss: 0.5196 - accuracy: 0.4721
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5199 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.5000 - accuracy: 0.4609 5/11 [============>.................] - ETA: 0s - loss: 0.4943 - accuracy: 0.4553 7/11 [==================>...........] - ETA: 0s - loss: 0.4893 - accuracy: 0.4552 9/11 [=======================>......] - ETA: 0s - loss: 0.4866 - accuracy: 0.456911/11 [==============================] - ETA: 0s - loss: 0.4843 - accuracy: 0.458411/11 [==============================] - 0s 28ms/step - loss: 0.4835 - accuracy: 0.4588
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4704 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.4630 - accuracy: 0.4909 5/11 [============>.................] - ETA: 0s - loss: 0.4622 - accuracy: 0.4827 7/11 [==================>...........] - ETA: 0s - loss: 0.4628 - accuracy: 0.4791 9/11 [=======================>......] - ETA: 0s - loss: 0.4622 - accuracy: 0.477311/11 [==============================] - ETA: 0s - loss: 0.4624 - accuracy: 0.475511/11 [==============================] - 0s 29ms/step - loss: 0.4626 - accuracy: 0.4747
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4895 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.4891 - accuracy: 0.4861 5/11 [============>.................] - ETA: 0s - loss: 0.4846 - accuracy: 0.4851 7/11 [==================>...........] - ETA: 0s - loss: 0.4778 - accuracy: 0.4805 9/11 [=======================>......] - ETA: 0s - loss: 0.4732 - accuracy: 0.476911/11 [==============================] - ETA: 0s - loss: 0.4708 - accuracy: 0.475111/11 [==============================] - 0s 28ms/step - loss: 0.4699 - accuracy: 0.4744
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4361 - accuracy: 0.4141 3/11 [=======>......................] - ETA: 0s - loss: 0.4481 - accuracy: 0.4136 5/11 [============>.................] - ETA: 0s - loss: 0.4506 - accuracy: 0.4311 8/11 [====================>.........] - ETA: 0s - loss: 0.4516 - accuracy: 0.441810/11 [==========================>...] - ETA: 0s - loss: 0.4520 - accuracy: 0.446611/11 [==============================] - 0s 27ms/step - loss: 0.4527 - accuracy: 0.4498
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4385 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.4441 - accuracy: 0.4874 5/11 [============>.................] - ETA: 0s - loss: 0.4474 - accuracy: 0.4889 7/11 [==================>...........] - ETA: 0s - loss: 0.4483 - accuracy: 0.4866 9/11 [=======================>......] - ETA: 0s - loss: 0.4495 - accuracy: 0.484311/11 [==============================] - ETA: 0s - loss: 0.4498 - accuracy: 0.483111/11 [==============================] - 0s 28ms/step - loss: 0.4498 - accuracy: 0.4825
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4470 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.4450 - accuracy: 0.4961 5/11 [============>.................] - ETA: 0s - loss: 0.4441 - accuracy: 0.5008 7/11 [==================>...........] - ETA: 0s - loss: 0.4440 - accuracy: 0.4998 9/11 [=======================>......] - ETA: 0s - loss: 0.4451 - accuracy: 0.500011/11 [==============================] - ETA: 0s - loss: 0.4452 - accuracy: 0.499711/11 [==============================] - 0s 27ms/step - loss: 0.4452 - accuracy: 0.4996
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4560 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.4563 - accuracy: 0.5573 5/11 [============>.................] - ETA: 0s - loss: 0.4533 - accuracy: 0.5588 7/11 [==================>...........] - ETA: 0s - loss: 0.4509 - accuracy: 0.5572 9/11 [=======================>......] - ETA: 0s - loss: 0.4487 - accuracy: 0.551411/11 [==============================] - ETA: 0s - loss: 0.4469 - accuracy: 0.545611/11 [==============================] - 0s 30ms/step - loss: 0.4462 - accuracy: 0.5432
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4354 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.4445 - accuracy: 0.5530 5/11 [============>.................] - ETA: 0s - loss: 0.4456 - accuracy: 0.5436 7/11 [==================>...........] - ETA: 0s - loss: 0.4414 - accuracy: 0.5362 9/11 [=======================>......] - ETA: 0s - loss: 0.4401 - accuracy: 0.536211/11 [==============================] - ETA: 0s - loss: 0.4388 - accuracy: 0.535611/11 [==============================] - 0s 28ms/step - loss: 0.4383 - accuracy: 0.5353
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4128 - accuracy: 0.4844 4/11 [=========>....................] - ETA: 0s - loss: 0.4277 - accuracy: 0.5151 6/11 [===============>..............] - ETA: 0s - loss: 0.4272 - accuracy: 0.5201 8/11 [====================>.........] - ETA: 0s - loss: 0.4269 - accuracy: 0.526410/11 [==========================>...] - ETA: 0s - loss: 0.4266 - accuracy: 0.530411/11 [==============================] - 0s 28ms/step - loss: 0.4265 - accuracy: 0.5333
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3928 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.4096 - accuracy: 0.5148 6/11 [===============>..............] - ETA: 0s - loss: 0.4136 - accuracy: 0.5296 8/11 [====================>.........] - ETA: 0s - loss: 0.4159 - accuracy: 0.536210/11 [==========================>...] - ETA: 0s - loss: 0.4171 - accuracy: 0.538811/11 [==============================] - 0s 29ms/step - loss: 0.4177 - accuracy: 0.5408
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4647 - accuracy: 0.6094 3/11 [=======>......................] - ETA: 0s - loss: 0.4385 - accuracy: 0.5747 5/11 [============>.................] - ETA: 0s - loss: 0.4292 - accuracy: 0.5674 7/11 [==================>...........] - ETA: 0s - loss: 0.4264 - accuracy: 0.5640 9/11 [=======================>......] - ETA: 0s - loss: 0.4253 - accuracy: 0.563211/11 [==============================] - ETA: 0s - loss: 0.4240 - accuracy: 0.561011/11 [==============================] - 0s 30ms/step - loss: 0.4233 - accuracy: 0.5602
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4437 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.4308 - accuracy: 0.5365 5/11 [============>.................] - ETA: 0s - loss: 0.4247 - accuracy: 0.5314 7/11 [==================>...........] - ETA: 0s - loss: 0.4201 - accuracy: 0.5334 9/11 [=======================>......] - ETA: 0s - loss: 0.4184 - accuracy: 0.537411/11 [==============================] - 0s 29ms/step - loss: 0.4154 - accuracy: 0.5411
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3624 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.3567 - accuracy: 0.4961 5/11 [============>.................] - ETA: 0s - loss: 0.3580 - accuracy: 0.5113 7/11 [==================>...........] - ETA: 0s - loss: 0.3585 - accuracy: 0.5210 9/11 [=======================>......] - ETA: 0s - loss: 0.3577 - accuracy: 0.529111/11 [==============================] - ETA: 0s - loss: 0.3557 - accuracy: 0.533111/11 [==============================] - 0s 29ms/step - loss: 0.3548 - accuracy: 0.5347
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3121 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.3028 - accuracy: 0.5738 5/11 [============>.................] - ETA: 0s - loss: 0.2997 - accuracy: 0.5664 7/11 [==================>...........] - ETA: 0s - loss: 0.2980 - accuracy: 0.5628 9/11 [=======================>......] - ETA: 0s - loss: 0.2967 - accuracy: 0.558911/11 [==============================] - 0s 27ms/step - loss: 0.2941 - accuracy: 0.5562
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2364 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.2606 - accuracy: 0.5100 5/11 [============>.................] - ETA: 0s - loss: 0.2622 - accuracy: 0.5236 7/11 [==================>...........] - ETA: 0s - loss: 0.2598 - accuracy: 0.531010/11 [==========================>...] - ETA: 0s - loss: 0.2575 - accuracy: 0.537911/11 [==============================] - 0s 29ms/step - loss: 0.2572 - accuracy: 0.5401
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.2817 - accuracy: 0.46886/6 [==============================] - ETA: 0s - loss: 0.2523 - accuracy: 0.5567 6/6 [==============================] - 5s 11ms/step - loss: 0.2523 - accuracy: 0.5567
2021-12-14 00:06:33.274006: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:06:33.274979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:06:33.275064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:06:33.275139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:06:33.275189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:06:33.275242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:06:33.275296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:06:33.275353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:06:33.275406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:06:33.275465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:06:33.276400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:06:33.276463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:06:33.276481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:06:33.276493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:06:33.277489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:06:33.277963: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:06:33.278482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:06:33.278522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:06:33.278559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:06:33.278598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:06:33.278638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:06:33.278676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:06:33.278714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:06:33.278752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:06:33.278790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:06:33.279740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:06:33.279779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:06:33.279795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:06:33.279807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:06:33.280800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [5.0102677e-03 9.6103352e-01 9.9987245e-01 3.5412106e-04 1.1384593e-03]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [2.0024537e-03 9.8322612e-01 9.9994981e-01 9.9997902e-05 3.7684423e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 0 2 1] pred: [0.1951884  0.00661275 0.0275222  0.9612595  0.8013142 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [2.0455196e-03 9.8259854e-01 9.9994528e-01 1.1064199e-04 3.7817110e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [2.5981476e-03 9.8412389e-01 9.9994290e-01 1.1006332e-04 5.1990116e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 0 2 1] pred: [0.20513986 0.0060116  0.01755241 0.9689112  0.84509   ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [3.1121641e-03 9.6937591e-01 9.9990690e-01 2.3720745e-04 6.7663653e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 4 3] pred: [2.6917537e-03 9.6940112e-01 9.9993777e-01 1.4934159e-04 5.1134609e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 3 4] pred: [0.00769736 0.008812   0.99533725 0.00645955 0.0038637 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 4 3] pred: [3.5836909e-03 9.8409665e-01 9.9993420e-01 1.4260160e-04 6.8968249e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 10 ============
pred sorted: [3 4 0 2 1] pred: [0.21752445 0.00673604 0.01341864 0.9667819  0.8721833 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [0.00759654 0.00938122 0.99563193 0.00610743 0.00379408]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 4 3] pred: [0.03500745 0.9482279  0.9988128  0.00256576 0.00846619]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [2.1391017e-03 9.8272091e-01 9.9994838e-01 1.0502740e-04 4.0136013e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [0.00774328 0.00960751 0.995621   0.00618672 0.00383975]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 6 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:41 - loss: 0.8018 - accuracy: 0.1797 3/11 [=======>......................] - ETA: 0s - loss: 0.8013 - accuracy: 0.2799   5/11 [============>.................] - ETA: 0s - loss: 0.8000 - accuracy: 0.3223 7/11 [==================>...........] - ETA: 0s - loss: 0.7988 - accuracy: 0.3439 9/11 [=======================>......] - ETA: 0s - loss: 0.7979 - accuracy: 0.359811/11 [==============================] - ETA: 0s - loss: 0.7972 - accuracy: 0.373411/11 [==============================] - 16s 27ms/step - loss: 0.7969 - accuracy: 0.3787
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7811 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.7794 - accuracy: 0.5087 6/11 [===============>..............] - ETA: 0s - loss: 0.7765 - accuracy: 0.4944 8/11 [====================>.........] - ETA: 0s - loss: 0.7744 - accuracy: 0.489210/11 [==========================>...] - ETA: 0s - loss: 0.7720 - accuracy: 0.485511/11 [==============================] - 0s 28ms/step - loss: 0.7699 - accuracy: 0.4830
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7312 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.7264 - accuracy: 0.4497 5/11 [============>.................] - ETA: 0s - loss: 0.7190 - accuracy: 0.4521 7/11 [==================>...........] - ETA: 0s - loss: 0.7118 - accuracy: 0.4585 9/11 [=======================>......] - ETA: 0s - loss: 0.7047 - accuracy: 0.460811/11 [==============================] - ETA: 0s - loss: 0.6984 - accuracy: 0.462811/11 [==============================] - 0s 27ms/step - loss: 0.6958 - accuracy: 0.4635
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.6163 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.6028 - accuracy: 0.5026 6/11 [===============>..............] - ETA: 0s - loss: 0.5949 - accuracy: 0.4946 9/11 [=======================>......] - ETA: 0s - loss: 0.5876 - accuracy: 0.487511/11 [==============================] - ETA: 0s - loss: 0.5832 - accuracy: 0.483711/11 [==============================] - 0s 27ms/step - loss: 0.5814 - accuracy: 0.4826
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4974 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.5099 - accuracy: 0.4796 5/11 [============>.................] - ETA: 0s - loss: 0.5143 - accuracy: 0.4845 7/11 [==================>...........] - ETA: 0s - loss: 0.5139 - accuracy: 0.4835 9/11 [=======================>......] - ETA: 0s - loss: 0.5109 - accuracy: 0.479611/11 [==============================] - 0s 27ms/step - loss: 0.5080 - accuracy: 0.4773
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4954 - accuracy: 0.5312 4/11 [=========>....................] - ETA: 0s - loss: 0.4864 - accuracy: 0.5021 7/11 [==================>...........] - ETA: 0s - loss: 0.4821 - accuracy: 0.4893 9/11 [=======================>......] - ETA: 0s - loss: 0.4811 - accuracy: 0.484711/11 [==============================] - 0s 27ms/step - loss: 0.4796 - accuracy: 0.4815
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4950 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.4740 - accuracy: 0.4939 5/11 [============>.................] - ETA: 0s - loss: 0.4659 - accuracy: 0.4896 7/11 [==================>...........] - ETA: 0s - loss: 0.4636 - accuracy: 0.4856 9/11 [=======================>......] - ETA: 0s - loss: 0.4640 - accuracy: 0.483411/11 [==============================] - ETA: 0s - loss: 0.4645 - accuracy: 0.481511/11 [==============================] - 0s 28ms/step - loss: 0.4647 - accuracy: 0.4806
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4539 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.4429 - accuracy: 0.5130 5/11 [============>.................] - ETA: 0s - loss: 0.4400 - accuracy: 0.4987 7/11 [==================>...........] - ETA: 0s - loss: 0.4432 - accuracy: 0.4901 9/11 [=======================>......] - ETA: 0s - loss: 0.4462 - accuracy: 0.485411/11 [==============================] - ETA: 0s - loss: 0.4488 - accuracy: 0.482811/11 [==============================] - 0s 28ms/step - loss: 0.4500 - accuracy: 0.4820
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4973 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.4842 - accuracy: 0.5082 5/11 [============>.................] - ETA: 0s - loss: 0.4746 - accuracy: 0.5028 7/11 [==================>...........] - ETA: 0s - loss: 0.4720 - accuracy: 0.4979 9/11 [=======================>......] - ETA: 0s - loss: 0.4688 - accuracy: 0.493811/11 [==============================] - ETA: 0s - loss: 0.4673 - accuracy: 0.490611/11 [==============================] - 0s 29ms/step - loss: 0.4668 - accuracy: 0.4895
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4513 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.4525 - accuracy: 0.4722 5/11 [============>.................] - ETA: 0s - loss: 0.4506 - accuracy: 0.4798 7/11 [==================>...........] - ETA: 0s - loss: 0.4502 - accuracy: 0.4824 9/11 [=======================>......] - ETA: 0s - loss: 0.4511 - accuracy: 0.482211/11 [==============================] - ETA: 0s - loss: 0.4524 - accuracy: 0.481811/11 [==============================] - 0s 29ms/step - loss: 0.4529 - accuracy: 0.4816
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4948 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4856 - accuracy: 0.4727 5/11 [============>.................] - ETA: 0s - loss: 0.4779 - accuracy: 0.4741 7/11 [==================>...........] - ETA: 0s - loss: 0.4709 - accuracy: 0.4800 9/11 [=======================>......] - ETA: 0s - loss: 0.4662 - accuracy: 0.483011/11 [==============================] - ETA: 0s - loss: 0.4639 - accuracy: 0.484611/11 [==============================] - 0s 28ms/step - loss: 0.4631 - accuracy: 0.4853
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4539 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.4502 - accuracy: 0.4891 5/11 [============>.................] - ETA: 0s - loss: 0.4504 - accuracy: 0.4823 7/11 [==================>...........] - ETA: 0s - loss: 0.4507 - accuracy: 0.4849 9/11 [=======================>......] - ETA: 0s - loss: 0.4503 - accuracy: 0.488511/11 [==============================] - ETA: 0s - loss: 0.4502 - accuracy: 0.490711/11 [==============================] - 0s 28ms/step - loss: 0.4502 - accuracy: 0.4915
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4481 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.4572 - accuracy: 0.5039 5/11 [============>.................] - ETA: 0s - loss: 0.4551 - accuracy: 0.5118 7/11 [==================>...........] - ETA: 0s - loss: 0.4549 - accuracy: 0.5125 9/11 [=======================>......] - ETA: 0s - loss: 0.4537 - accuracy: 0.511111/11 [==============================] - ETA: 0s - loss: 0.4524 - accuracy: 0.510111/11 [==============================] - 0s 30ms/step - loss: 0.4518 - accuracy: 0.5096
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4711 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.4617 - accuracy: 0.5009 5/11 [============>.................] - ETA: 0s - loss: 0.4587 - accuracy: 0.5021 7/11 [==================>...........] - ETA: 0s - loss: 0.4553 - accuracy: 0.5037 9/11 [=======================>......] - ETA: 0s - loss: 0.4521 - accuracy: 0.503511/11 [==============================] - ETA: 0s - loss: 0.4497 - accuracy: 0.503711/11 [==============================] - 0s 28ms/step - loss: 0.4489 - accuracy: 0.5039
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3826 - accuracy: 0.4219 4/11 [=========>....................] - ETA: 0s - loss: 0.4103 - accuracy: 0.4741 6/11 [===============>..............] - ETA: 0s - loss: 0.4159 - accuracy: 0.4873 8/11 [====================>.........] - ETA: 0s - loss: 0.4187 - accuracy: 0.491610/11 [==========================>...] - ETA: 0s - loss: 0.4212 - accuracy: 0.494311/11 [==============================] - 0s 27ms/step - loss: 0.4235 - accuracy: 0.4962
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4344 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.4389 - accuracy: 0.5048 5/11 [============>.................] - ETA: 0s - loss: 0.4381 - accuracy: 0.5119 7/11 [==================>...........] - ETA: 0s - loss: 0.4377 - accuracy: 0.5131 9/11 [=======================>......] - ETA: 0s - loss: 0.4378 - accuracy: 0.512311/11 [==============================] - ETA: 0s - loss: 0.4367 - accuracy: 0.512211/11 [==============================] - 0s 29ms/step - loss: 0.4362 - accuracy: 0.5123
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4007 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.4190 - accuracy: 0.5082 5/11 [============>.................] - ETA: 0s - loss: 0.4233 - accuracy: 0.5171 7/11 [==================>...........] - ETA: 0s - loss: 0.4237 - accuracy: 0.5194 9/11 [=======================>......] - ETA: 0s - loss: 0.4227 - accuracy: 0.519011/11 [==============================] - ETA: 0s - loss: 0.4230 - accuracy: 0.520511/11 [==============================] - 0s 29ms/step - loss: 0.4232 - accuracy: 0.5213
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3996 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.4128 - accuracy: 0.5547 5/11 [============>.................] - ETA: 0s - loss: 0.4129 - accuracy: 0.5551 7/11 [==================>...........] - ETA: 0s - loss: 0.4128 - accuracy: 0.5553 9/11 [=======================>......] - ETA: 0s - loss: 0.4144 - accuracy: 0.557511/11 [==============================] - ETA: 0s - loss: 0.4157 - accuracy: 0.559211/11 [==============================] - 0s 29ms/step - loss: 0.4162 - accuracy: 0.5600
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3850 - accuracy: 0.5469 3/11 [=======>......................] - ETA: 0s - loss: 0.4057 - accuracy: 0.5629 5/11 [============>.................] - ETA: 0s - loss: 0.4129 - accuracy: 0.5699 7/11 [==================>...........] - ETA: 0s - loss: 0.4154 - accuracy: 0.5736 9/11 [=======================>......] - ETA: 0s - loss: 0.4158 - accuracy: 0.577211/11 [==============================] - ETA: 0s - loss: 0.4164 - accuracy: 0.579311/11 [==============================] - 0s 28ms/step - loss: 0.4165 - accuracy: 0.5798
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4259 - accuracy: 0.5859 3/11 [=======>......................] - ETA: 0s - loss: 0.4271 - accuracy: 0.5968 6/11 [===============>..............] - ETA: 0s - loss: 0.4165 - accuracy: 0.5892 8/11 [====================>.........] - ETA: 0s - loss: 0.4136 - accuracy: 0.586910/11 [==========================>...] - ETA: 0s - loss: 0.4127 - accuracy: 0.585911/11 [==============================] - 0s 28ms/step - loss: 0.4130 - accuracy: 0.5862
Evaluate on test data
1/6 [====>.........................] - ETA: 25s - loss: 0.4271 - accuracy: 0.53126/6 [==============================] - ETA: 0s - loss: 0.4102 - accuracy: 0.5567 6/6 [==============================] - 5s 11ms/step - loss: 0.4102 - accuracy: 0.5567
2021-12-14 00:07:10.946181: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:07:10.947591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:07:10.947677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:07:10.947739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:07:10.947784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:07:10.947845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:07:10.947899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:07:10.947964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:07:10.948017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:07:10.948069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:07:10.949631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:07:10.949690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:07:10.949707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:07:10.949720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:07:10.950746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:07:10.951212: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:07:10.951726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:07:10.951769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:07:10.951809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:07:10.951849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:07:10.951889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:07:10.951939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:07:10.951982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:07:10.952029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:07:10.952070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:07:10.953003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:07:10.953044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:07:10.953061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:07:10.953074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:07:10.954060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [2.2281224e-03 9.9875450e-01 9.9994028e-01 1.5120750e-03 7.6501601e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [0.00614402 0.99635303 0.9997168  0.0028325  0.00227084]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 0 2 1] pred: [0.34607422 0.08791737 0.10357917 0.9178749  0.84186   ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 0 1 2] pred: [0.38800588 0.06665009 0.0656     0.932343   0.8887772 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [2.5470331e-03 9.9866176e-01 9.9993455e-01 1.8921628e-03 9.4511471e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 3 4] pred: [2.4176603e-03 9.9869198e-01 9.9993730e-01 1.7943137e-03 8.6996978e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [0.0039365  0.99730766 0.99982685 0.00190701 0.00144669]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [1.5053228e-03 9.9890852e-01 9.9995041e-01 8.9324638e-04 4.7076473e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 3 4] pred: [1.5106889e-03 9.9890637e-01 9.9995017e-01 8.9749286e-04 4.7352311e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 3 4] pred: [1.5877322e-03 9.9887484e-01 9.9994862e-01 9.3587476e-04 5.0374190e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [1.5939494e-03 9.9887496e-01 9.9994874e-01 9.3683694e-04 5.0491991e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [4 3 0 1 2] pred: [0.470351   0.09727001 0.06634186 0.8816237  0.89624476]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [0.01397148 0.9902406  0.99922323 0.02779485 0.01385676]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [1.9194431e-03 9.9880600e-01 9.9994373e-01 1.1399265e-03 6.0924195e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [1.9221287e-03 9.9865252e-01 9.9993706e-01 1.1296166e-03 6.7123049e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
Exécution 7 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:43 - loss: 0.8004 - accuracy: 0.1172 3/11 [=======>......................] - ETA: 0s - loss: 0.7980 - accuracy: 0.2287   6/11 [===============>..............] - ETA: 0s - loss: 0.7966 - accuracy: 0.2992 8/11 [====================>.........] - ETA: 0s - loss: 0.7958 - accuracy: 0.326810/11 [==========================>...] - ETA: 0s - loss: 0.7953 - accuracy: 0.344911/11 [==============================] - 17s 27ms/step - loss: 0.7949 - accuracy: 0.3571
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7847 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 0s - loss: 0.7810 - accuracy: 0.4538 6/11 [===============>..............] - ETA: 0s - loss: 0.7794 - accuracy: 0.4518 8/11 [====================>.........] - ETA: 0s - loss: 0.7775 - accuracy: 0.451210/11 [==========================>...] - ETA: 0s - loss: 0.7750 - accuracy: 0.448911/11 [==============================] - 0s 27ms/step - loss: 0.7729 - accuracy: 0.4482
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7386 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.7258 - accuracy: 0.4557 6/11 [===============>..............] - ETA: 0s - loss: 0.7145 - accuracy: 0.4505 8/11 [====================>.........] - ETA: 0s - loss: 0.7077 - accuracy: 0.449610/11 [==========================>...] - ETA: 0s - loss: 0.7010 - accuracy: 0.448111/11 [==============================] - 0s 28ms/step - loss: 0.6955 - accuracy: 0.4475
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5739 - accuracy: 0.3828 3/11 [=======>......................] - ETA: 0s - loss: 0.5676 - accuracy: 0.4097 5/11 [============>.................] - ETA: 0s - loss: 0.5630 - accuracy: 0.4203 7/11 [==================>...........] - ETA: 0s - loss: 0.5571 - accuracy: 0.4251 9/11 [=======================>......] - ETA: 0s - loss: 0.5532 - accuracy: 0.430111/11 [==============================] - 0s 28ms/step - loss: 0.5488 - accuracy: 0.4334
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5156 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.5018 - accuracy: 0.4570 5/11 [============>.................] - ETA: 0s - loss: 0.4970 - accuracy: 0.4580 7/11 [==================>...........] - ETA: 0s - loss: 0.4947 - accuracy: 0.4592 9/11 [=======================>......] - ETA: 0s - loss: 0.4918 - accuracy: 0.457511/11 [==============================] - 0s 29ms/step - loss: 0.4877 - accuracy: 0.4538
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4660 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.4632 - accuracy: 0.4280 5/11 [============>.................] - ETA: 0s - loss: 0.4633 - accuracy: 0.4283 7/11 [==================>...........] - ETA: 0s - loss: 0.4633 - accuracy: 0.4286 9/11 [=======================>......] - ETA: 0s - loss: 0.4628 - accuracy: 0.432611/11 [==============================] - ETA: 0s - loss: 0.4627 - accuracy: 0.435211/11 [==============================] - 0s 28ms/step - loss: 0.4626 - accuracy: 0.4359
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4341 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4425 - accuracy: 0.4423 5/11 [============>.................] - ETA: 0s - loss: 0.4464 - accuracy: 0.4479 7/11 [==================>...........] - ETA: 0s - loss: 0.4484 - accuracy: 0.4476 9/11 [=======================>......] - ETA: 0s - loss: 0.4504 - accuracy: 0.447811/11 [==============================] - ETA: 0s - loss: 0.4516 - accuracy: 0.447511/11 [==============================] - 0s 28ms/step - loss: 0.4521 - accuracy: 0.4475
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4437 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 0s - loss: 0.4389 - accuracy: 0.4410 5/11 [============>.................] - ETA: 0s - loss: 0.4390 - accuracy: 0.4459 7/11 [==================>...........] - ETA: 0s - loss: 0.4447 - accuracy: 0.4491 9/11 [=======================>......] - ETA: 0s - loss: 0.4470 - accuracy: 0.449711/11 [==============================] - ETA: 0s - loss: 0.4484 - accuracy: 0.450411/11 [==============================] - 0s 27ms/step - loss: 0.4489 - accuracy: 0.4505
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4645 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.4683 - accuracy: 0.4952 5/11 [============>.................] - ETA: 0s - loss: 0.4675 - accuracy: 0.4845 7/11 [==================>...........] - ETA: 0s - loss: 0.4638 - accuracy: 0.4788 9/11 [=======================>......] - ETA: 0s - loss: 0.4614 - accuracy: 0.473411/11 [==============================] - 0s 27ms/step - loss: 0.4596 - accuracy: 0.4682
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4261 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4409 - accuracy: 0.4618 5/11 [============>.................] - ETA: 0s - loss: 0.4371 - accuracy: 0.4677 7/11 [==================>...........] - ETA: 0s - loss: 0.4405 - accuracy: 0.4717 9/11 [=======================>......] - ETA: 0s - loss: 0.4438 - accuracy: 0.470811/11 [==============================] - 0s 28ms/step - loss: 0.4458 - accuracy: 0.4669
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4253 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.4315 - accuracy: 0.4614 5/11 [============>.................] - ETA: 0s - loss: 0.4375 - accuracy: 0.4624 8/11 [====================>.........] - ETA: 0s - loss: 0.4412 - accuracy: 0.464410/11 [==========================>...] - ETA: 0s - loss: 0.4430 - accuracy: 0.464411/11 [==============================] - 0s 27ms/step - loss: 0.4439 - accuracy: 0.4643
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4543 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4604 - accuracy: 0.4549 5/11 [============>.................] - ETA: 0s - loss: 0.4586 - accuracy: 0.4592 7/11 [==================>...........] - ETA: 0s - loss: 0.4553 - accuracy: 0.4620 9/11 [=======================>......] - ETA: 0s - loss: 0.4530 - accuracy: 0.462911/11 [==============================] - ETA: 0s - loss: 0.4511 - accuracy: 0.464711/11 [==============================] - 0s 28ms/step - loss: 0.4505 - accuracy: 0.4655
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4615 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4509 - accuracy: 0.4549 5/11 [============>.................] - ETA: 0s - loss: 0.4481 - accuracy: 0.4584 7/11 [==================>...........] - ETA: 0s - loss: 0.4447 - accuracy: 0.4600 9/11 [=======================>......] - ETA: 0s - loss: 0.4444 - accuracy: 0.463611/11 [==============================] - ETA: 0s - loss: 0.4436 - accuracy: 0.466411/11 [==============================] - 0s 28ms/step - loss: 0.4432 - accuracy: 0.4672
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4389 - accuracy: 0.4062 3/11 [=======>......................] - ETA: 0s - loss: 0.4369 - accuracy: 0.4362 5/11 [============>.................] - ETA: 0s - loss: 0.4371 - accuracy: 0.4489 8/11 [====================>.........] - ETA: 0s - loss: 0.4394 - accuracy: 0.459210/11 [==========================>...] - ETA: 0s - loss: 0.4378 - accuracy: 0.462411/11 [==============================] - 0s 28ms/step - loss: 0.4369 - accuracy: 0.4647
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4062 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.4125 - accuracy: 0.4444 5/11 [============>.................] - ETA: 0s - loss: 0.4179 - accuracy: 0.4547 7/11 [==================>...........] - ETA: 0s - loss: 0.4195 - accuracy: 0.4568 9/11 [=======================>......] - ETA: 0s - loss: 0.4201 - accuracy: 0.460311/11 [==============================] - ETA: 0s - loss: 0.4212 - accuracy: 0.464511/11 [==============================] - 0s 28ms/step - loss: 0.4217 - accuracy: 0.4664
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4403 - accuracy: 0.5859 3/11 [=======>......................] - ETA: 0s - loss: 0.4362 - accuracy: 0.5538 5/11 [============>.................] - ETA: 0s - loss: 0.4302 - accuracy: 0.5440 7/11 [==================>...........] - ETA: 0s - loss: 0.4266 - accuracy: 0.5371 9/11 [=======================>......] - ETA: 0s - loss: 0.4251 - accuracy: 0.535811/11 [==============================] - 0s 28ms/step - loss: 0.4239 - accuracy: 0.5373
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4478 - accuracy: 0.5547 4/11 [=========>....................] - ETA: 0s - loss: 0.4281 - accuracy: 0.5386 6/11 [===============>..............] - ETA: 0s - loss: 0.4248 - accuracy: 0.5414 8/11 [====================>.........] - ETA: 0s - loss: 0.4226 - accuracy: 0.543310/11 [==========================>...] - ETA: 0s - loss: 0.4209 - accuracy: 0.544511/11 [==============================] - 0s 27ms/step - loss: 0.4204 - accuracy: 0.5461
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3903 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.3935 - accuracy: 0.5378 6/11 [===============>..............] - ETA: 0s - loss: 0.4009 - accuracy: 0.5400 8/11 [====================>.........] - ETA: 0s - loss: 0.4036 - accuracy: 0.540410/11 [==========================>...] - ETA: 0s - loss: 0.4057 - accuracy: 0.540111/11 [==============================] - 0s 28ms/step - loss: 0.4070 - accuracy: 0.5405
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4027 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 0s - loss: 0.4065 - accuracy: 0.5291 6/11 [===============>..............] - ETA: 0s - loss: 0.4075 - accuracy: 0.5271 8/11 [====================>.........] - ETA: 0s - loss: 0.4075 - accuracy: 0.528610/11 [==========================>...] - ETA: 0s - loss: 0.4079 - accuracy: 0.530611/11 [==============================] - 0s 29ms/step - loss: 0.4082 - accuracy: 0.5323
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4092 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.4141 - accuracy: 0.5486 5/11 [============>.................] - ETA: 0s - loss: 0.4145 - accuracy: 0.5471 7/11 [==================>...........] - ETA: 0s - loss: 0.4142 - accuracy: 0.5475 9/11 [=======================>......] - ETA: 0s - loss: 0.4119 - accuracy: 0.546011/11 [==============================] - 0s 28ms/step - loss: 0.4106 - accuracy: 0.5450
Evaluate on test data
1/6 [====>.........................] - ETA: 23s - loss: 0.4144 - accuracy: 0.56256/6 [==============================] - ETA: 0s - loss: 0.4227 - accuracy: 0.5765 6/6 [==============================] - 5s 10ms/step - loss: 0.4227 - accuracy: 0.5765
2021-12-14 00:07:48.274761: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:07:48.275497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:07:48.275563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:07:48.275617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:07:48.275650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:07:48.275688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:07:48.275726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:07:48.275771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:07:48.275818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:07:48.275862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:07:48.276568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:07:48.276618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:07:48.276631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:07:48.276640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:07:48.277440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:07:48.277753: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:07:48.278152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:07:48.278181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:07:48.278209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:07:48.278236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:07:48.278263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:07:48.278294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:07:48.278324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:07:48.278356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:07:48.278386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:07:48.279097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:07:48.279126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:07:48.279137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:07:48.279145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:07:48.279887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [1.5571127e-03 9.9791759e-01 9.9994195e-01 2.3680227e-04 8.2616671e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [1.4250007e-03 9.9792957e-01 9.9994254e-01 2.1861549e-04 8.5644436e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 4 3] pred: [1.5137086e-03 9.9798179e-01 9.9994397e-01 2.2691807e-04 8.0276490e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 0 1 2] pred: [0.44988036 0.08216019 0.04023861 0.9431531  0.91523534]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [1.5093344e-03 9.9796331e-01 9.9994397e-01 2.2844590e-04 8.0740970e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [1.5183701e-03 9.9785197e-01 9.9993622e-01 2.3731263e-04 8.9578074e-04]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [0.00958137 0.98779047 0.9990363  0.00235808 0.00637648]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 4 3] pred: [1.4233988e-03 9.9792850e-01 9.9994242e-01 2.1861424e-04 8.5691496e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 4 3] pred: [0.00419513 0.9898645  0.9996835  0.00193745 0.0037139 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 0 4 3] pred: [1.8214564e-03 9.9731261e-01 9.9992418e-01 3.2712429e-04 1.0478597e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 4 3] pred: [1.4972470e-03 9.9799228e-01 9.9994469e-01 2.2421684e-04 7.9733873e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [1.4810649e-03 9.9802184e-01 9.9994588e-01 2.2000603e-04 7.8455202e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 4 3] pred: [1.6602133e-03 9.9783570e-01 9.9993646e-01 2.5129100e-04 8.7123580e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 4 3] pred: [1.5563167e-03 9.9793029e-01 9.9994218e-01 2.3536193e-04 8.2288019e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [1.4825134e-03 9.9802065e-01 9.9994564e-01 2.2034800e-04 7.8577187e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 8 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:33 - loss: 0.8049 - accuracy: 0.0547 4/11 [=========>....................] - ETA: 0s - loss: 0.8015 - accuracy: 0.2157   7/11 [==================>...........] - ETA: 0s - loss: 0.8000 - accuracy: 0.2792 9/11 [=======================>......] - ETA: 0s - loss: 0.7991 - accuracy: 0.307811/11 [==============================] - ETA: 0s - loss: 0.7984 - accuracy: 0.327711/11 [==============================] - 16s 27ms/step - loss: 0.7980 - accuracy: 0.3352
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7740 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.7753 - accuracy: 0.4392 5/11 [============>.................] - ETA: 0s - loss: 0.7750 - accuracy: 0.4425 7/11 [==================>...........] - ETA: 0s - loss: 0.7743 - accuracy: 0.4476 9/11 [=======================>......] - ETA: 0s - loss: 0.7729 - accuracy: 0.449411/11 [==============================] - 0s 28ms/step - loss: 0.7705 - accuracy: 0.4529
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7231 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.7178 - accuracy: 0.4783 5/11 [============>.................] - ETA: 0s - loss: 0.7115 - accuracy: 0.4675 7/11 [==================>...........] - ETA: 0s - loss: 0.7065 - accuracy: 0.4660 9/11 [=======================>......] - ETA: 0s - loss: 0.7016 - accuracy: 0.466511/11 [==============================] - ETA: 0s - loss: 0.6966 - accuracy: 0.466011/11 [==============================] - 0s 27ms/step - loss: 0.6946 - accuracy: 0.4659
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5774 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.5727 - accuracy: 0.4661 5/11 [============>.................] - ETA: 0s - loss: 0.5677 - accuracy: 0.4655 8/11 [====================>.........] - ETA: 0s - loss: 0.5616 - accuracy: 0.464810/11 [==========================>...] - ETA: 0s - loss: 0.5577 - accuracy: 0.464511/11 [==============================] - 0s 28ms/step - loss: 0.5546 - accuracy: 0.4646
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4993 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.5002 - accuracy: 0.4757 5/11 [============>.................] - ETA: 0s - loss: 0.4939 - accuracy: 0.4830 7/11 [==================>...........] - ETA: 0s - loss: 0.4925 - accuracy: 0.4855 9/11 [=======================>......] - ETA: 0s - loss: 0.4900 - accuracy: 0.483411/11 [==============================] - ETA: 0s - loss: 0.4876 - accuracy: 0.480411/11 [==============================] - 0s 29ms/step - loss: 0.4868 - accuracy: 0.4791
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4467 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 0s - loss: 0.4586 - accuracy: 0.5148 5/11 [============>.................] - ETA: 0s - loss: 0.4614 - accuracy: 0.5001 7/11 [==================>...........] - ETA: 0s - loss: 0.4633 - accuracy: 0.4914 9/11 [=======================>......] - ETA: 0s - loss: 0.4631 - accuracy: 0.484711/11 [==============================] - ETA: 0s - loss: 0.4631 - accuracy: 0.480611/11 [==============================] - 0s 27ms/step - loss: 0.4632 - accuracy: 0.4793
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4549 - accuracy: 0.3438 3/11 [=======>......................] - ETA: 0s - loss: 0.4556 - accuracy: 0.4062 5/11 [============>.................] - ETA: 0s - loss: 0.4570 - accuracy: 0.4233 7/11 [==================>...........] - ETA: 0s - loss: 0.4591 - accuracy: 0.4331 9/11 [=======================>......] - ETA: 0s - loss: 0.4592 - accuracy: 0.439611/11 [==============================] - ETA: 0s - loss: 0.4592 - accuracy: 0.444511/11 [==============================] - 0s 29ms/step - loss: 0.4592 - accuracy: 0.4462
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4571 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 0s - loss: 0.4586 - accuracy: 0.4622 5/11 [============>.................] - ETA: 0s - loss: 0.4610 - accuracy: 0.4640 7/11 [==================>...........] - ETA: 0s - loss: 0.4606 - accuracy: 0.4671 9/11 [=======================>......] - ETA: 0s - loss: 0.4605 - accuracy: 0.468611/11 [==============================] - 0s 27ms/step - loss: 0.4598 - accuracy: 0.4683
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4917 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.4795 - accuracy: 0.4865 6/11 [===============>..............] - ETA: 0s - loss: 0.4722 - accuracy: 0.4763 8/11 [====================>.........] - ETA: 0s - loss: 0.4689 - accuracy: 0.473810/11 [==========================>...] - ETA: 0s - loss: 0.4662 - accuracy: 0.472311/11 [==============================] - 0s 28ms/step - loss: 0.4645 - accuracy: 0.4719
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4739 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.4693 - accuracy: 0.4479 5/11 [============>.................] - ETA: 0s - loss: 0.4640 - accuracy: 0.4470 7/11 [==================>...........] - ETA: 0s - loss: 0.4590 - accuracy: 0.4480 9/11 [=======================>......] - ETA: 0s - loss: 0.4562 - accuracy: 0.452311/11 [==============================] - 0s 27ms/step - loss: 0.4557 - accuracy: 0.4563
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4398 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.4542 - accuracy: 0.4816 6/11 [===============>..............] - ETA: 0s - loss: 0.4560 - accuracy: 0.4820 8/11 [====================>.........] - ETA: 0s - loss: 0.4565 - accuracy: 0.480610/11 [==========================>...] - ETA: 0s - loss: 0.4560 - accuracy: 0.478911/11 [==============================] - 0s 28ms/step - loss: 0.4556 - accuracy: 0.4773
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4558 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.4519 - accuracy: 0.4779 5/11 [============>.................] - ETA: 0s - loss: 0.4480 - accuracy: 0.4736 7/11 [==================>...........] - ETA: 0s - loss: 0.4492 - accuracy: 0.4753 9/11 [=======================>......] - ETA: 0s - loss: 0.4497 - accuracy: 0.476011/11 [==============================] - ETA: 0s - loss: 0.4500 - accuracy: 0.475611/11 [==============================] - 0s 28ms/step - loss: 0.4501 - accuracy: 0.4751
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4741 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 0s - loss: 0.4651 - accuracy: 0.4431 5/11 [============>.................] - ETA: 0s - loss: 0.4644 - accuracy: 0.4564 7/11 [==================>...........] - ETA: 0s - loss: 0.4632 - accuracy: 0.4623 9/11 [=======================>......] - ETA: 0s - loss: 0.4619 - accuracy: 0.465311/11 [==============================] - ETA: 0s - loss: 0.4596 - accuracy: 0.468311/11 [==============================] - 0s 28ms/step - loss: 0.4585 - accuracy: 0.4695
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4656 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 0s - loss: 0.4596 - accuracy: 0.4831 5/11 [============>.................] - ETA: 0s - loss: 0.4484 - accuracy: 0.4772 8/11 [====================>.........] - ETA: 0s - loss: 0.4442 - accuracy: 0.475110/11 [==========================>...] - ETA: 0s - loss: 0.4447 - accuracy: 0.477211/11 [==============================] - 0s 27ms/step - loss: 0.4443 - accuracy: 0.4787
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4566 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 0s - loss: 0.4490 - accuracy: 0.4835 5/11 [============>.................] - ETA: 0s - loss: 0.4439 - accuracy: 0.4928 7/11 [==================>...........] - ETA: 0s - loss: 0.4428 - accuracy: 0.5013 9/11 [=======================>......] - ETA: 0s - loss: 0.4421 - accuracy: 0.504511/11 [==============================] - 0s 28ms/step - loss: 0.4407 - accuracy: 0.5061
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4340 - accuracy: 0.6172 4/11 [=========>....................] - ETA: 0s - loss: 0.4311 - accuracy: 0.5716 6/11 [===============>..............] - ETA: 0s - loss: 0.4301 - accuracy: 0.5570 8/11 [====================>.........] - ETA: 0s - loss: 0.4288 - accuracy: 0.550610/11 [==========================>...] - ETA: 0s - loss: 0.4285 - accuracy: 0.548511/11 [==============================] - 0s 27ms/step - loss: 0.4290 - accuracy: 0.5479
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4175 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 0s - loss: 0.4228 - accuracy: 0.5352 5/11 [============>.................] - ETA: 0s - loss: 0.4247 - accuracy: 0.5356 7/11 [==================>...........] - ETA: 0s - loss: 0.4239 - accuracy: 0.536610/11 [==========================>...] - ETA: 0s - loss: 0.4246 - accuracy: 0.540211/11 [==============================] - 0s 27ms/step - loss: 0.4250 - accuracy: 0.5413
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4300 - accuracy: 0.5703 4/11 [=========>....................] - ETA: 0s - loss: 0.4297 - accuracy: 0.5597 6/11 [===============>..............] - ETA: 0s - loss: 0.4269 - accuracy: 0.5558 8/11 [====================>.........] - ETA: 0s - loss: 0.4247 - accuracy: 0.554310/11 [==========================>...] - ETA: 0s - loss: 0.4237 - accuracy: 0.554011/11 [==============================] - 0s 27ms/step - loss: 0.4235 - accuracy: 0.5540
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4277 - accuracy: 0.6328 3/11 [=======>......................] - ETA: 0s - loss: 0.4170 - accuracy: 0.5712 5/11 [============>.................] - ETA: 0s - loss: 0.4138 - accuracy: 0.5572 7/11 [==================>...........] - ETA: 0s - loss: 0.4113 - accuracy: 0.5518 9/11 [=======================>......] - ETA: 0s - loss: 0.4117 - accuracy: 0.550911/11 [==============================] - 0s 28ms/step - loss: 0.4136 - accuracy: 0.5519
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4110 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.4057 - accuracy: 0.5647 5/11 [============>.................] - ETA: 0s - loss: 0.4083 - accuracy: 0.5639 7/11 [==================>...........] - ETA: 0s - loss: 0.4114 - accuracy: 0.5604 9/11 [=======================>......] - ETA: 0s - loss: 0.4125 - accuracy: 0.558011/11 [==============================] - ETA: 0s - loss: 0.4132 - accuracy: 0.557711/11 [==============================] - 0s 27ms/step - loss: 0.4134 - accuracy: 0.5576
Evaluate on test data
1/6 [====>.........................] - ETA: 24s - loss: 0.4105 - accuracy: 0.54696/6 [==============================] - 5s 10ms/step - loss: 0.4190 - accuracy: 0.5524
2021-12-14 00:08:25.598572: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:08:25.599424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:08:25.599501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:08:25.599559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:08:25.599602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:08:25.599655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:08:25.599709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:08:25.599758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:08:25.599806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:08:25.599857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:08:25.600865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:08:25.600941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:08:25.600961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:08:25.600975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:08:25.602042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
2021-12-14 00:08:25.602742: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-12-14 00:08:25.603292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: Tesla K20m computeCapability: 3.5
coreClock: 0.7055GHz coreCount: 13 deviceMemorySize: 4.63GiB deviceMemoryBandwidth: 193.71GiB/s
2021-12-14 00:08:25.603337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-12-14 00:08:25.603379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-12-14 00:08:25.603421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-12-14 00:08:25.603462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-12-14 00:08:25.603503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-12-14 00:08:25.603549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-12-14 00:08:25.603591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-12-14 00:08:25.603637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-12-14 00:08:25.604619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-12-14 00:08:25.604663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-14 00:08:25.604681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-12-14 00:08:25.604694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-12-14 00:08:25.605727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 4318 MB memory) -> physical GPU (device: 0, name: Tesla K20m, pci bus id: 0000:08:00.0, compute capability: 3.5)
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 4 0 3] pred: [7.5233803e-04 9.9889487e-01 9.9993706e-01 5.5110938e-04 8.3353091e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 4 0 3] pred: [7.4749853e-04 9.9890959e-01 9.9993873e-01 5.4001028e-04 8.2367758e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 4 3] pred: [1.2910062e-03 9.9841690e-01 9.9990690e-01 7.9868996e-04 1.1716796e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 0 1 2] pred: [0.62372994 0.0968517  0.08375543 0.92831826 0.87555516]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 4 0 3] pred: [9.8452985e-04 9.9865073e-01 9.9992383e-01 6.6563283e-04 9.8506233e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [0.00253735 0.99783176 0.99976987 0.00147872 0.00222242]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score: 0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 0 3] pred: [8.9758087e-04 9.9880064e-01 9.9992836e-01 6.1280682e-04 9.1905094e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 0 2 1] pred: [0.56445426 0.10917789 0.1170892  0.92778754 0.8258011 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [3 4 0 1 2] pred: [0.59419394 0.09227235 0.08604794 0.9425543  0.84934604]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [3 4 0 1 2] pred: [0.5941839  0.08930315 0.08470762 0.94228625 0.85820395]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 4 0 3] pred: [7.1331178e-04 9.9886453e-01 9.9993575e-01 5.5906363e-04 8.4853137e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 0 3] pred: [0.00130446 0.99827623 0.99986804 0.00100041 0.0013828 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 0 2 1] pred: [0.5801901  0.09929984 0.10097966 0.93539757 0.841577  ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 0 3] pred: [6.696408e-04 9.988650e-01 9.999392e-01 5.425130e-04 8.213095e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [0.01770174 0.9892782  0.99890196 0.00684564 0.00825544]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Exécution 9 : 
BPIC20.csv
Running Tensforflow with GPU, yay !
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 2:41 - loss: 0.7985 - accuracy: 0.2266 4/11 [=========>....................] - ETA: 0s - loss: 0.8016 - accuracy: 0.3286   7/11 [==================>...........] - ETA: 0s - loss: 0.8015 - accuracy: 0.3659 9/11 [=======================>......] - ETA: 0s - loss: 0.8011 - accuracy: 0.380011/11 [==============================] - 16s 25ms/step - loss: 0.8002 - accuracy: 0.3934
Epoch 2/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7881 - accuracy: 0.3906 4/11 [=========>....................] - ETA: 0s - loss: 0.7846 - accuracy: 0.4253 6/11 [===============>..............] - ETA: 0s - loss: 0.7829 - accuracy: 0.4297 8/11 [====================>.........] - ETA: 0s - loss: 0.7816 - accuracy: 0.434410/11 [==========================>...] - ETA: 0s - loss: 0.7806 - accuracy: 0.438711/11 [==============================] - 0s 26ms/step - loss: 0.7795 - accuracy: 0.4421
Epoch 3/20
 1/11 [=>............................] - ETA: 0s - loss: 0.7494 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.7420 - accuracy: 0.4837 6/11 [===============>..............] - ETA: 0s - loss: 0.7373 - accuracy: 0.4773 8/11 [====================>.........] - ETA: 0s - loss: 0.7316 - accuracy: 0.473810/11 [==========================>...] - ETA: 0s - loss: 0.7252 - accuracy: 0.470911/11 [==============================] - 0s 28ms/step - loss: 0.7196 - accuracy: 0.4690
Epoch 4/20
 1/11 [=>............................] - ETA: 0s - loss: 0.5898 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.5861 - accuracy: 0.4674 5/11 [============>.................] - ETA: 0s - loss: 0.5778 - accuracy: 0.4675 7/11 [==================>...........] - ETA: 0s - loss: 0.5701 - accuracy: 0.4638 9/11 [=======================>......] - ETA: 0s - loss: 0.5646 - accuracy: 0.462211/11 [==============================] - ETA: 0s - loss: 0.5600 - accuracy: 0.461511/11 [==============================] - 0s 28ms/step - loss: 0.5582 - accuracy: 0.4613
Epoch 5/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4860 - accuracy: 0.3984 4/11 [=========>....................] - ETA: 0s - loss: 0.4914 - accuracy: 0.4453 6/11 [===============>..............] - ETA: 0s - loss: 0.4882 - accuracy: 0.4470 8/11 [====================>.........] - ETA: 0s - loss: 0.4862 - accuracy: 0.449111/11 [==============================] - ETA: 0s - loss: 0.4850 - accuracy: 0.451811/11 [==============================] - 0s 27ms/step - loss: 0.4846 - accuracy: 0.4524
Epoch 6/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4818 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.4699 - accuracy: 0.4839 5/11 [============>.................] - ETA: 0s - loss: 0.4693 - accuracy: 0.4740 7/11 [==================>...........] - ETA: 0s - loss: 0.4698 - accuracy: 0.468610/11 [==========================>...] - ETA: 0s - loss: 0.4691 - accuracy: 0.465411/11 [==============================] - 0s 26ms/step - loss: 0.4691 - accuracy: 0.4644
Epoch 7/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4292 - accuracy: 0.4453 4/11 [=========>....................] - ETA: 0s - loss: 0.4362 - accuracy: 0.4595 6/11 [===============>..............] - ETA: 0s - loss: 0.4425 - accuracy: 0.4600 9/11 [=======================>......] - ETA: 0s - loss: 0.4496 - accuracy: 0.460211/11 [==============================] - ETA: 0s - loss: 0.4524 - accuracy: 0.460011/11 [==============================] - 0s 27ms/step - loss: 0.4534 - accuracy: 0.4599
Epoch 8/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4679 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.4551 - accuracy: 0.4692 6/11 [===============>..............] - ETA: 0s - loss: 0.4641 - accuracy: 0.4732 9/11 [=======================>......] - ETA: 0s - loss: 0.4633 - accuracy: 0.469311/11 [==============================] - ETA: 0s - loss: 0.4629 - accuracy: 0.467511/11 [==============================] - 0s 28ms/step - loss: 0.4629 - accuracy: 0.4668
Epoch 9/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4533 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 0s - loss: 0.4521 - accuracy: 0.4683 5/11 [============>.................] - ETA: 0s - loss: 0.4512 - accuracy: 0.4667 7/11 [==================>...........] - ETA: 0s - loss: 0.4534 - accuracy: 0.4645 9/11 [=======================>......] - ETA: 0s - loss: 0.4553 - accuracy: 0.464111/11 [==============================] - 0s 28ms/step - loss: 0.4568 - accuracy: 0.4635
Epoch 10/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4496 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 0s - loss: 0.4613 - accuracy: 0.4401 5/11 [============>.................] - ETA: 0s - loss: 0.4679 - accuracy: 0.4485 7/11 [==================>...........] - ETA: 0s - loss: 0.4672 - accuracy: 0.4535 9/11 [=======================>......] - ETA: 0s - loss: 0.4668 - accuracy: 0.455011/11 [==============================] - 0s 28ms/step - loss: 0.4655 - accuracy: 0.4565
Epoch 11/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4339 - accuracy: 0.4062 4/11 [=========>....................] - ETA: 0s - loss: 0.4445 - accuracy: 0.4329 6/11 [===============>..............] - ETA: 0s - loss: 0.4461 - accuracy: 0.4386 9/11 [=======================>......] - ETA: 0s - loss: 0.4489 - accuracy: 0.444711/11 [==============================] - ETA: 0s - loss: 0.4506 - accuracy: 0.447711/11 [==============================] - 0s 27ms/step - loss: 0.4513 - accuracy: 0.4488
Epoch 12/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4650 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 0s - loss: 0.4643 - accuracy: 0.4792 6/11 [===============>..............] - ETA: 0s - loss: 0.4626 - accuracy: 0.4580 8/11 [====================>.........] - ETA: 0s - loss: 0.4603 - accuracy: 0.455010/11 [==========================>...] - ETA: 0s - loss: 0.4593 - accuracy: 0.456211/11 [==============================] - 0s 27ms/step - loss: 0.4585 - accuracy: 0.4575
Epoch 13/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4529 - accuracy: 0.4688 4/11 [=========>....................] - ETA: 0s - loss: 0.4533 - accuracy: 0.4668 7/11 [==================>...........] - ETA: 0s - loss: 0.4533 - accuracy: 0.4631 9/11 [=======================>......] - ETA: 0s - loss: 0.4527 - accuracy: 0.465011/11 [==============================] - ETA: 0s - loss: 0.4523 - accuracy: 0.467711/11 [==============================] - 0s 27ms/step - loss: 0.4521 - accuracy: 0.4688
Epoch 14/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4580 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.4561 - accuracy: 0.5135 5/11 [============>.................] - ETA: 0s - loss: 0.4499 - accuracy: 0.5070 7/11 [==================>...........] - ETA: 0s - loss: 0.4483 - accuracy: 0.5053 9/11 [=======================>......] - ETA: 0s - loss: 0.4478 - accuracy: 0.506911/11 [==============================] - ETA: 0s - loss: 0.4467 - accuracy: 0.508511/11 [==============================] - 0s 28ms/step - loss: 0.4463 - accuracy: 0.5090
Epoch 15/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4278 - accuracy: 0.5781 4/11 [=========>....................] - ETA: 0s - loss: 0.4340 - accuracy: 0.5557 6/11 [===============>..............] - ETA: 0s - loss: 0.4365 - accuracy: 0.5556 8/11 [====================>.........] - ETA: 0s - loss: 0.4377 - accuracy: 0.554411/11 [==============================] - ETA: 0s - loss: 0.4374 - accuracy: 0.553511/11 [==============================] - 0s 27ms/step - loss: 0.4371 - accuracy: 0.5533
Epoch 16/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3904 - accuracy: 0.4922 4/11 [=========>....................] - ETA: 0s - loss: 0.4242 - accuracy: 0.5430 7/11 [==================>...........] - ETA: 0s - loss: 0.4267 - accuracy: 0.548410/11 [==========================>...] - ETA: 0s - loss: 0.4274 - accuracy: 0.548911/11 [==============================] - 0s 26ms/step - loss: 0.4276 - accuracy: 0.5488
Epoch 17/20
 1/11 [=>............................] - ETA: 0s - loss: 0.4137 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 0s - loss: 0.4180 - accuracy: 0.5017 5/11 [============>.................] - ETA: 0s - loss: 0.4218 - accuracy: 0.5118 7/11 [==================>...........] - ETA: 0s - loss: 0.4221 - accuracy: 0.5150 9/11 [=======================>......] - ETA: 0s - loss: 0.4224 - accuracy: 0.520911/11 [==============================] - ETA: 0s - loss: 0.4223 - accuracy: 0.526111/11 [==============================] - 0s 28ms/step - loss: 0.4222 - accuracy: 0.5280
Epoch 18/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3839 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 0s - loss: 0.3957 - accuracy: 0.5534 5/11 [============>.................] - ETA: 0s - loss: 0.3984 - accuracy: 0.5538 7/11 [==================>...........] - ETA: 0s - loss: 0.3996 - accuracy: 0.5545 9/11 [=======================>......] - ETA: 0s - loss: 0.3999 - accuracy: 0.555611/11 [==============================] - ETA: 0s - loss: 0.3986 - accuracy: 0.555311/11 [==============================] - 0s 28ms/step - loss: 0.3979 - accuracy: 0.5551
Epoch 19/20
 1/11 [=>............................] - ETA: 0s - loss: 0.3887 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 0s - loss: 0.3776 - accuracy: 0.5191 5/11 [============>.................] - ETA: 0s - loss: 0.3614 - accuracy: 0.5329 7/11 [==================>...........] - ETA: 0s - loss: 0.3515 - accuracy: 0.5400 9/11 [=======================>......] - ETA: 0s - loss: 0.3445 - accuracy: 0.545011/11 [==============================] - ETA: 0s - loss: 0.3401 - accuracy: 0.546711/11 [==============================] - 0s 28ms/step - loss: 0.3383 - accuracy: 0.5472
Epoch 20/20
 1/11 [=>............................] - ETA: 0s - loss: 0.2971 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 0s - loss: 0.2993 - accuracy: 0.5616 5/11 [============>.................] - ETA: 0s - loss: 0.2978 - accuracy: 0.5580 7/11 [==================>...........] - ETA: 0s - loss: 0.2949 - accuracy: 0.5575 9/11 [=======================>......] - ETA: 0s - loss: 0.2920 - accuracy: 0.557411/11 [==============================] - ETA: 0s - loss: 0.2894 - accuracy: 0.556611/11 [==============================] - 0s 28ms/step - loss: 0.2885 - accuracy: 0.5564
Evaluate on test data
1/6 [====>.........................] - ETA: 22s - loss: 0.2367 - accuracy: 0.60166/6 [==============================] - ETA: 0s - loss: 0.2634 - accuracy: 0.5538 6/6 [==============================] - 5s 11ms/step - loss: 0.2634 - accuracy: 0.5538
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [1.1348893e-03 9.1618937e-01 9.9983513e-01 2.9468615e-04 8.9326769e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [5.6494819e-04 9.7931916e-01 9.9995494e-01 9.1141679e-05 3.9675785e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 0 2 1] pred: [0.36059183 0.02360342 0.19282362 0.92676187 0.72648126]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score: 1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [7.0622889e-04 9.6505618e-01 9.9992967e-01 1.4284506e-04 5.2646780e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score: 0.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [5.5170408e-04 9.8036343e-01 9.9995720e-01 8.6335494e-05 3.8524540e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [5.4219947e-04 9.7678274e-01 9.9995244e-01 9.9942328e-05 4.3020322e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [0.00438976 0.01259118 0.992152   0.01151486 0.00849556]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [0.004382   0.01268267 0.9922827  0.01118672 0.0084119 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [0.00437583 0.01205818 0.99198663 0.01178293 0.00863983]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [0.00440705 0.01240408 0.9919729  0.01180951 0.00858101]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 4 3] pred: [5.6716002e-04 9.7912818e-01 9.9995399e-01 9.3607254e-05 4.0214256e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score: 1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [1.5773419e-03 7.1177226e-01 9.9966776e-01 6.0867373e-04 1.4319869e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [0.00436523 0.01208561 0.99210936 0.01155834 0.00856126]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [0.00479619 0.01643137 0.9927579  0.01057352 0.00735577]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [0.00443538 0.01330745 0.9919801  0.01193056 0.00859121]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score: 1.0
 
Job end at mar déc 14 00:09:03 CET 2021
