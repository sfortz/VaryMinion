
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompi-2020b => FFTW/3.3.8-gompic-2020b
  2) OpenMPI/4.0.5-GCC-10.2.0 => OpenMPI/4.0.5-gcccuda-2020b
  3) ScaLAPACK/2.1.0-gompi-2020b => ScaLAPACK/2.1.0-gompic-2020b
  4) UCX/1.9.0-GCCcore-10.2.0 => UCX/1.9.0-GCCcore-10.2.0-CUDA-11.1.1


The following have been reloaded with a version change:
  1) SciPy-bundle/2020.11-fosscuda-2020b => SciPy-bundle/2020.11-foss-2020b


The following have been reloaded with a version change:
  1) SciPy-bundle/2020.11-foss-2020b => SciPy-bundle/2020.11-fosscuda-2020b

Job start at Fri Nov  4 22:29:50 CET 2022
2022-11-04 22:30:04.030639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:From /scratch/2545956/2545956/VaryMinions/scripts/training_NN/training_Model.py:22: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2022-11-04 22:30:30.383524: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-04 22:30:30.385071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2022-11-04 22:30:30.415886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:c5:00.0 name: NVIDIA RTX A6000 computeCapability: 8.6
coreClock: 1.8GHz coreCount: 84 deviceMemorySize: 44.56GiB deviceMemoryBandwidth: 715.34GiB/s
2022-11-04 22:30:30.415932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-11-04 22:30:32.153161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-11-04 22:30:32.153240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2022-11-04 22:30:32.685167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-11-04 22:30:33.564130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-11-04 22:30:35.563496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-11-04 22:30:36.024919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-11-04 22:30:36.065481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-11-04 22:30:36.066571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2022-11-04 22:30:36.066615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-11-04 22:36:30.866750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-11-04 22:36:30.867035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2022-11-04 22:36:30.867041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2022-11-04 22:36:30.868088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 42532 MB memory) -> physical GPU (device: 0, name: NVIDIA RTX A6000, pci bus id: 0000:c5:00.0, compute capability: 8.6)
2022-11-04 22:36:30.868615: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-04 22:36:30.868947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:c5:00.0 name: NVIDIA RTX A6000 computeCapability: 8.6
coreClock: 1.8GHz coreCount: 84 deviceMemorySize: 44.56GiB deviceMemoryBandwidth: 715.34GiB/s
2022-11-04 22:36:30.868979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-11-04 22:36:30.869003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-11-04 22:36:30.869014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2022-11-04 22:36:30.869024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-11-04 22:36:30.869033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-11-04 22:36:30.869042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-11-04 22:36:30.869051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-11-04 22:36:30.869061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-11-04 22:36:30.869593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2022-11-04 22:36:30.869608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-11-04 22:36:30.869612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2022-11-04 22:36:30.869616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2022-11-04 22:36:30.870168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 42532 MB memory) -> physical GPU (device: 0, name: NVIDIA RTX A6000, pci bus id: 0000:c5:00.0, compute capability: 8.6)
2022-11-04 22:41:43.262812: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-04 22:41:43.263637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:c5:00.0 name: NVIDIA RTX A6000 computeCapability: 8.6
coreClock: 1.8GHz coreCount: 84 deviceMemorySize: 44.56GiB deviceMemoryBandwidth: 715.34GiB/s
2022-11-04 22:41:43.263670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-11-04 22:41:43.263692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-11-04 22:41:43.263701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2022-11-04 22:41:43.263711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-11-04 22:41:43.263720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-11-04 22:41:43.263729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-11-04 22:41:43.263738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-11-04 22:41:43.263747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-11-04 22:41:43.264295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2022-11-04 22:41:43.264725: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-04 22:41:43.265031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:c5:00.0 name: NVIDIA RTX A6000 computeCapability: 8.6
coreClock: 1.8GHz coreCount: 84 deviceMemorySize: 44.56GiB deviceMemoryBandwidth: 715.34GiB/s
2022-11-04 22:41:43.265045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-11-04 22:41:43.265056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-11-04 22:41:43.265068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2022-11-04 22:41:43.265077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-11-04 22:41:43.265086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-11-04 22:41:43.265095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-11-04 22:41:43.265104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-11-04 22:41:43.265113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-11-04 22:41:43.265637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2022-11-04 22:41:43.265664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-11-04 22:41:43.265668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2022-11-04 22:41:43.265673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2022-11-04 22:41:43.266233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 42532 MB memory) -> physical GPU (device: 0, name: NVIDIA RTX A6000, pci bus id: 0000:c5:00.0, compute capability: 8.6)
2022-11-04 22:41:43.266290: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
2022-11-04 22:41:46.038312: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-11-04 22:41:46.038697: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500195000 Hz
2022-11-04 22:41:49.995750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-11-04 22:41:57.374794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2022-11-04 22:41:58.086454: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2022-11-04 22:41:58.092079: W tensorflow/core/framework/op_kernel.cc:1763] OP_REQUIRES failed at cwise_op_gpu_base.cc:88 : Internal: Failed to load in-memory CUBIN: CUDA_ERROR_NO_BINARY_FOR_GPU: no kernel image is available for execution on the device
2022-11-04 22:41:58.092348: W tensorflow/core/framework/op_kernel.cc:1763] OP_REQUIRES failed at cwise_op_gpu_base.cc:88 : Internal: Failed to load in-memory CUBIN: CUDA_ERROR_NO_BINARY_FOR_GPU: no kernel image is available for execution on the device
claroline-rand_50.csv with GRU model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and bin_ce-logits as loss function.
Exécution 0 : 
claroline-rand_50.csv
Running Tensforflow with GPU, yay !
GRU
Trying to load: ../../datasets/multi-label/claroline-rand_50.csv
Categories:
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47
 48 49]
output y_tr
(165000, 300)
(165000, 50)
(85000, 300)
(85000, 50)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
48
Training a GRU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 300, 48)           2304      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                14400     
_________________________________________________________________
dense (Dense)                (None, 50)                3050      
=================================================================
Total params: 19,754
Trainable params: 19,754
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
Traceback (most recent call last):
  File "job-array-claroline-50-rand.py", line 80, in <module>
    minion.main(ds, m, True, e, u, bs, 0.66, act, l)
  File "/scratch/2545956/2545956/VaryMinions/scripts/training_NN/training_Model.py", line 134, in main
    results = model.evaluate(tf_test, tf_class, batch_size=batch_size)
  File "/opt/cecisw/arch/easybuild/2020b/software/TensorFlow/2.4.1-fosscuda-2020b/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1389, in evaluate
    tmp_logs = self.test_function(iterator)
  File "/opt/cecisw/arch/easybuild/2020b/software/TensorFlow/2.4.1-fosscuda-2020b/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 828, in __call__
    result = self._call(*args, **kwds)
  File "/opt/cecisw/arch/easybuild/2020b/software/TensorFlow/2.4.1-fosscuda-2020b/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 888, in _call
    return self._stateless_fn(*args, **kwds)
  File "/opt/cecisw/arch/easybuild/2020b/software/TensorFlow/2.4.1-fosscuda-2020b/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2942, in __call__
    return graph_function._call_flat(
  File "/opt/cecisw/arch/easybuild/2020b/software/TensorFlow/2.4.1-fosscuda-2020b/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1918, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/opt/cecisw/arch/easybuild/2020b/software/TensorFlow/2.4.1-fosscuda-2020b/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 555, in call
    outputs = execute.execute(
  File "/opt/cecisw/arch/easybuild/2020b/software/TensorFlow/2.4.1-fosscuda-2020b/lib/python3.8/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.InternalError:    Failed to load in-memory CUBIN: CUDA_ERROR_NO_BINARY_FOR_GPU: no kernel image is available for execution on the device
	 [[{{node cond/else/_1/cond/Tanh}}]]
	 [[sequential/bidirectional/forward_gru/PartitionedCall]] [Op:__inference_test_function_10028]

Function call stack:
test_function -> test_function -> test_function

Job end at Fri Nov  4 22:41:59 CET 2022
