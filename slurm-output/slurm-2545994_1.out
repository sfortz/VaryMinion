
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompi-2020b
  2) GCC/8.3.0 => GCC/10.2.0
  3) GCCcore/8.3.0 => GCCcore/10.2.0
  4) OpenBLAS/0.3.7-GCC-8.3.0 => OpenBLAS/0.3.12-GCC-10.2.0
  5) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/4.0.5-GCC-10.2.0
  6) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.1.0-gompi-2020b
  7) XZ/5.2.4-GCCcore-8.3.0 => XZ/5.2.5-GCCcore-10.2.0
  8) binutils/2.32-GCCcore-8.3.0 => binutils/2.35-GCCcore-10.2.0
  9) foss/2019b => foss/2020b
 10) gompi/2019b => gompi/2020b
 11) hwloc/1.11.12-GCCcore-8.3.0 => hwloc/2.2.0-GCCcore-10.2.0
 12) libpciaccess/0.14-GCCcore-8.3.0 => libpciaccess/0.16-GCCcore-10.2.0
 13) libxml2/2.9.9-GCCcore-8.3.0 => libxml2/2.9.10-GCCcore-10.2.0
 14) numactl/2.0.12-GCCcore-8.3.0 => numactl/2.0.13-GCCcore-10.2.0
 15) releases/2019b => releases/2020b
 16) zlib/1.2.11-GCCcore-8.3.0 => zlib/1.2.11-GCCcore-10.2.0

Job start at Sat Nov  5 09:06:42 CET 2022
WARNING:tensorflow:From /scratch/2545995/2545995/VaryMinions/scripts/training_NN/training_Model.py:22: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2022-11-05 09:06:50.085741: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-05 09:06:50.086276: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
2022-11-05 09:06:51.915165: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-11-05 09:06:51.915519: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500195000 Hz
Number of possible configurations: 40
Begining exécution of the 1 th configuration: BPIC15.csv with GRU model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and bin_ce as loss function.
Exécution 0 : 
BPIC15.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a GRU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 154, 357)          127449    
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                70020     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 197,774
Trainable params: 197,774
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:02 - loss: 1.8361 - accuracy: 0.1250 2/15 [===>..........................] - ETA: 0s - loss: 1.8518 - accuracy: 0.1133   3/15 [=====>........................] - ETA: 0s - loss: 1.8420 - accuracy: 0.1155 4/15 [=======>......................] - ETA: 0s - loss: 1.8398 - accuracy: 0.1183 5/15 [=========>....................] - ETA: 0s - loss: 1.8430 - accuracy: 0.1193 6/15 [===========>..................] - ETA: 0s - loss: 1.8457 - accuracy: 0.1190 7/15 [=============>................] - ETA: 0s - loss: 1.8483 - accuracy: 0.1181 8/15 [===============>..............] - ETA: 0s - loss: 1.8501 - accuracy: 0.1175 9/15 [=================>............] - ETA: 0s - loss: 1.8506 - accuracy: 0.116810/15 [===================>..........] - ETA: 0s - loss: 1.8511 - accuracy: 0.116611/15 [=====================>........] - ETA: 0s - loss: 1.8524 - accuracy: 0.116112/15 [=======================>......] - ETA: 0s - loss: 1.8531 - accuracy: 0.115413/15 [=========================>....] - ETA: 0s - loss: 1.8541 - accuracy: 0.114914/15 [===========================>..] - ETA: 0s - loss: 1.8547 - accuracy: 0.114815/15 [==============================] - 5s 61ms/step - loss: 1.8545 - accuracy: 0.1148
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 0 2 3 4] pred: [0.01749094 0.02127794 0.00815332 0.0034192  0.00090479]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [1 0 3 2 4] pred: [ 0.01910298  0.02137816 -0.00434413  0.01020302 -0.01866237]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [0 1 3 2 4] pred: [ 0.02141158  0.01985807 -0.00269341  0.00939441 -0.02063033]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [1 0 3 2 4] pred: [ 0.02483407  0.03032538  0.00153071  0.01825904 -0.00548736]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [1 0 3 2 4] pred: [ 0.01394171  0.02200836 -0.01332826  0.01217421 -0.02216316]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [1 0 3 2 4] pred: [ 0.01885801  0.02096648 -0.00437453  0.01058062 -0.01955623]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [0 2 3 1 4] pred: [ 0.04136211 -0.02045515 -0.00560466 -0.00723352 -0.02067322]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [1 3 0 4 2] pred: [ 0.00451338  0.02697944 -0.02271353  0.01522681 -0.01931614]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 3 2 1 4] pred: [0.06417461 0.00771096 0.0139468  0.01757218 0.00248529]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [1 0 3 2 4] pred: [ 0.01625426  0.01796166 -0.006244    0.0096078  -0.01061954]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [0 4 2 3 1] pred: [ 0.041233   -0.01838555 -0.01430165 -0.01504405 -0.00950756]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [1 0 3 2 4] pred: [ 0.01342585  0.02275692 -0.01389765  0.01240833 -0.02106659]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [1 0 3 2 4] pred: [ 0.01478276  0.02191474 -0.00632785  0.00780276 -0.01641423]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [1 0 3 2 4] pred: [ 0.01749432  0.01878625 -0.00442647  0.00921456 -0.01990611]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [1 0 3 2 4] pred: [ 0.02386521  0.03383267  0.0006148   0.01708538 -0.01130196]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 1 : 
BPIC15.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a GRU
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 154, 357)          127449    
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                70020     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 197,774
Trainable params: 197,774
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:00 - loss: 1.9608 - accuracy: 0.2344 2/15 [===>..........................] - ETA: 0s - loss: 1.9320 - accuracy: 0.2344   3/15 [=====>........................] - ETA: 0s - loss: 1.9223 - accuracy: 0.2326 4/15 [=======>......................] - ETA: 0s - loss: 1.9245 - accuracy: 0.2272 5/15 [=========>....................] - ETA: 0s - loss: 1.9294 - accuracy: 0.2221 6/15 [===========>..................] - ETA: 0s - loss: 1.9324 - accuracy: 0.2176 7/15 [=============>................] - ETA: 0s - loss: 1.9389 - accuracy: 0.2149 8/15 [===============>..............] - ETA: 0s - loss: 1.9433 - accuracy: 0.2126 9/15 [=================>............] - ETA: 0s - loss: 1.9479 - accuracy: 0.210810/15 [===================>..........] - ETA: 0s - loss: 1.9507 - accuracy: 0.209211/15 [=====================>........] - ETA: 0s - loss: 1.9532 - accuracy: 0.207812/15 [=======================>......] - ETA: 0s - loss: 1.9555 - accuracy: 0.206713/15 [=========================>....] - ETA: 0s - loss: 1.9572 - accuracy: 0.206014/15 [===========================>..] - ETA: 0s - loss: 1.9593 - accuracy: 0.205215/15 [==============================] - ETA: 0s - loss: 1.9611 - accuracy: 0.204615/15 [==============================] - 5s 63ms/step - loss: 1.9627 - accuracy: 0.2041
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 2 1 3 4] pred: [ 0.06716511 -0.04906581  0.03097232 -0.06096743 -0.08342736]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [0 2 1 3 4] pred: [ 0.05785094 -0.0372137   0.04782849 -0.06020869 -0.06373493]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [0 2 3 4 1] pred: [ 0.06501499 -0.05836776  0.03470076 -0.04777949 -0.05269865]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [0 2 1 3 4] pred: [ 0.05893161 -0.03008791  0.04943576 -0.05580793 -0.06592514]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 2 1 3 4] pred: [ 0.06339268 -0.03296825  0.04559638 -0.05043454 -0.06376456]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [0 2 1 3 4] pred: [ 0.04892122 -0.04299203  0.04799974 -0.06472345 -0.06994481]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [0 2 1 3 4] pred: [ 0.0632759  -0.02930625  0.04277599 -0.05101836 -0.06657715]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 2 1 3 4] pred: [ 0.07219327 -0.03707711  0.01694118 -0.05042081 -0.09070618]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 2 1 3 4] pred: [ 0.05814464 -0.03776424  0.0479927  -0.06046776 -0.06495983]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [0 2 1 3 4] pred: [ 0.05821529 -0.03787485  0.04786625 -0.06034724 -0.06490684]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [0 2 1 3 4] pred: [ 0.06394096 -0.01931557  0.00954769 -0.05669811 -0.08924316]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [0 2 1 3 4] pred: [ 0.06329335 -0.02948001  0.04270406 -0.05088895 -0.06662203]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [0 2 1 3 4] pred: [ 0.06315067 -0.0317783   0.04673295 -0.05339755 -0.06277598]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [0 2 1 3 4] pred: [ 0.07842994 -0.04370596  0.0121676  -0.05793661 -0.09281015]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 2 1 3 4] pred: [ 0.06261039 -0.03365282  0.04534579 -0.05153978 -0.0643402 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 2 : 
BPIC15.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a GRU
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 154, 357)          127449    
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                70020     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 197,774
Trainable params: 197,774
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:04 - loss: 2.4190 - accuracy: 0.1250 2/15 [===>..........................] - ETA: 1s - loss: 2.2926 - accuracy: 0.1504   3/15 [=====>........................] - ETA: 1s - loss: 2.2518 - accuracy: 0.1619 4/15 [=======>......................] - ETA: 0s - loss: 2.2331 - accuracy: 0.1693 5/15 [=========>....................] - ETA: 0s - loss: 2.2082 - accuracy: 0.1767 6/15 [===========>..................] - ETA: 0s - loss: 2.1958 - accuracy: 0.1819 7/15 [=============>................] - ETA: 0s - loss: 2.1868 - accuracy: 0.1851 8/15 [===============>..............] - ETA: 0s - loss: 2.1808 - accuracy: 0.1876 9/15 [=================>............] - ETA: 0s - loss: 2.1766 - accuracy: 0.189210/15 [===================>..........] - ETA: 0s - loss: 2.1721 - accuracy: 0.190011/15 [=====================>........] - ETA: 0s - loss: 2.1693 - accuracy: 0.190112/15 [=======================>......] - ETA: 0s - loss: 2.1675 - accuracy: 0.189913/15 [=========================>....] - ETA: 0s - loss: 2.1658 - accuracy: 0.190114/15 [===========================>..] - ETA: 0s - loss: 2.1643 - accuracy: 0.190315/15 [==============================] - ETA: 0s - loss: 2.1627 - accuracy: 0.190715/15 [==============================] - 6s 83ms/step - loss: 2.1612 - accuracy: 0.1909
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 0 1 2] pred: [-0.03273674 -0.04283706 -0.04495458  0.06341881  0.03009115]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 1 0 2] pred: [-0.04582345 -0.02954603 -0.06367479  0.05023247  0.03073972]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 1 0 2] pred: [-0.04572834 -0.02813236 -0.06316292  0.0512452   0.03127957]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 1 0 2] pred: [-0.04748567 -0.02744342 -0.06305854  0.04986778  0.02226096]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [3 4 1 0 2] pred: [-0.04476241 -0.02752829 -0.06228548  0.05140451  0.03105523]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 0 1 2] pred: [-0.0314477  -0.04010787 -0.04281989  0.06171411  0.02814189]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 0 1 2] pred: [-0.03329886 -0.04279912 -0.04361846  0.0536005   0.03284049]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 1 0 2] pred: [-0.03999855 -0.03610276 -0.04132927  0.0735717   0.04543298]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 4 0 1 2] pred: [-0.03492616 -0.03709755 -0.04693615  0.06048726  0.02541599]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [3 4 0 1 2] pred: [-0.03778251 -0.04150441 -0.04845552  0.05939738  0.02795077]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 4 1 0 2] pred: [-0.04955126 -0.02164493 -0.06629962  0.04144603  0.01979751]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 0 1 2] pred: [-0.03481949 -0.04032297 -0.04870858  0.06349202  0.02333071]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 1 0 2] pred: [-0.04356796 -0.02795431 -0.06094358  0.05140305  0.0307826 ]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 0 1 2] pred: [-0.03116913 -0.04024448 -0.04663613  0.05763161  0.02979507]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 0 1 2] pred: [-0.03178272 -0.03910357 -0.04554102  0.0572871   0.02967795]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 3 : 
BPIC15.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a GRU
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, 154, 357)          127449    
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                70020     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 197,774
Trainable params: 197,774
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:00 - loss: 1.4346 - accuracy: 0.1797 2/15 [===>..........................] - ETA: 1s - loss: 1.4370 - accuracy: 0.1855   3/15 [=====>........................] - ETA: 1s - loss: 1.4297 - accuracy: 0.1949 4/15 [=======>......................] - ETA: 0s - loss: 1.4427 - accuracy: 0.1994 5/15 [=========>....................] - ETA: 0s - loss: 1.4427 - accuracy: 0.2058 6/15 [===========>..................] - ETA: 0s - loss: 1.4424 - accuracy: 0.2094 7/15 [=============>................] - ETA: 0s - loss: 1.4457 - accuracy: 0.2127 8/15 [===============>..............] - ETA: 0s - loss: 1.4497 - accuracy: 0.2144 9/15 [=================>............] - ETA: 0s - loss: 1.4529 - accuracy: 0.216010/15 [===================>..........] - ETA: 0s - loss: 1.4559 - accuracy: 0.217511/15 [=====================>........] - ETA: 0s - loss: 1.4581 - accuracy: 0.218612/15 [=======================>......] - ETA: 0s - loss: 1.4602 - accuracy: 0.219613/15 [=========================>....] - ETA: 0s - loss: 1.4610 - accuracy: 0.220214/15 [===========================>..] - ETA: 0s - loss: 1.4617 - accuracy: 0.220815/15 [==============================] - ETA: 0s - loss: 1.4623 - accuracy: 0.221515/15 [==============================] - 5s 81ms/step - loss: 1.4629 - accuracy: 0.2222
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 2 0 1 3] pred: [ 0.02698323 -0.01990151  0.03322881 -0.02590114  0.06358493]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [2 4 0 1 3] pred: [ 0.02297551  0.00064943  0.07238352 -0.06076936  0.06561223]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 2 0 1 3] pred: [ 0.02698261 -0.0198173   0.03334315 -0.0259244   0.06354325]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 2 0 1 3] pred: [ 0.02763095 -0.01686211  0.0341608  -0.02551625  0.05874505]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [2 4 0 1 3] pred: [ 0.03358643 -0.01555507  0.07466806 -0.02994339  0.05708532]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [4 0 2 1 3] pred: [ 0.01200645 -0.01274144  0.00825105 -0.04449555  0.07061222]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [4 2 0 1 3] pred: [ 0.02676055 -0.01383564  0.05859455 -0.03193777  0.06327267]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [4 2 0 1 3] pred: [ 0.02588028 -0.0173251   0.03609851 -0.02668218  0.05920399]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [2 0 4 1 3] pred: [ 0.04436643 -0.01026375  0.04947838 -0.02267606  0.04402085]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [2 4 0 1 3] pred: [ 0.03045743 -0.00987202  0.05999329 -0.02600442  0.05736358]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [4 2 0 1 3] pred: [ 0.02312886 -0.02191872  0.03486297 -0.02976737  0.06187602]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 2 0 1 3] pred: [ 0.02741009 -0.01694809  0.03474291 -0.02586828  0.06253552]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [4 2 0 1 3] pred: [ 0.02176161 -0.01435978  0.03806357 -0.02483562  0.05737757]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [4 2 0 1 3] pred: [ 0.03341759 -0.00925634  0.04376889 -0.04992293  0.04945083]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [4 2 0 1 3] pred: [ 0.02744447 -0.01692061  0.03472707 -0.02582354  0.06251148]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 4 : 
BPIC15.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a GRU
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, 154, 357)          127449    
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                70020     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 197,774
Trainable params: 197,774
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 58s - loss: 1.8718 - accuracy: 0.1719 2/15 [===>..........................] - ETA: 0s - loss: 1.8716 - accuracy: 0.1621  3/15 [=====>........................] - ETA: 0s - loss: 1.8713 - accuracy: 0.1645 4/15 [=======>......................] - ETA: 0s - loss: 1.8626 - accuracy: 0.1659 5/15 [=========>....................] - ETA: 0s - loss: 1.8593 - accuracy: 0.1696 6/15 [===========>..................] - ETA: 0s - loss: 1.8595 - accuracy: 0.1723 7/15 [=============>................] - ETA: 0s - loss: 1.8605 - accuracy: 0.1742 8/15 [===============>..............] - ETA: 0s - loss: 1.8607 - accuracy: 0.1755 9/15 [=================>............] - ETA: 0s - loss: 1.8622 - accuracy: 0.176610/15 [===================>..........] - ETA: 0s - loss: 1.8646 - accuracy: 0.177611/15 [=====================>........] - ETA: 0s - loss: 1.8667 - accuracy: 0.178912/15 [=======================>......] - ETA: 0s - loss: 1.8680 - accuracy: 0.179813/15 [=========================>....] - ETA: 0s - loss: 1.8689 - accuracy: 0.180414/15 [===========================>..] - ETA: 0s - loss: 1.8695 - accuracy: 0.181015/15 [==============================] - ETA: 0s - loss: 1.8702 - accuracy: 0.181415/15 [==============================] - 5s 66ms/step - loss: 1.8708 - accuracy: 0.1818
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 2 0 4 1] pred: [-0.00881565 -0.04749779  0.03560279  0.05762812 -0.02255784]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [3 2 0 4 1] pred: [ 0.00411953 -0.05275126  0.02885365  0.07717811 -0.02383583]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [3 2 0 4 1] pred: [ 0.01229526 -0.04812291  0.03172584  0.06691734 -0.01903894]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [3 2 0 4 1] pred: [-0.00596536 -0.05177446  0.03819053  0.05892878 -0.01860923]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [3 2 0 4 1] pred: [ 0.00913599 -0.05161605  0.03633618  0.06830679 -0.02293323]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [3 2 0 4 1] pred: [-0.00652594 -0.04704794  0.03846065  0.05667955 -0.02132222]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [3 2 0 4 1] pred: [-0.00868338 -0.04840809  0.0361667   0.05723195 -0.02219143]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [3 2 0 4 1] pred: [-0.00950274 -0.04894295  0.03474943  0.05777496 -0.02246732]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 0 4 1] pred: [ 0.00835877 -0.05496785  0.03730177  0.06313763 -0.02453572]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 0 4 1] pred: [-0.00914881 -0.0460887   0.03535603  0.05856432 -0.02161458]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 2 0 4 1] pred: [-0.00917439 -0.04853158  0.03635132  0.05761282 -0.02241714]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [3 2 0 4 1] pred: [-0.01072144 -0.04295284  0.0336674   0.05761899 -0.02434777]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [3 2 0 4 1] pred: [ 0.00466597 -0.0543825   0.02218048  0.06696882 -0.02627287]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [3 2 0 4 1] pred: [-0.0083126  -0.04964047  0.03333405  0.05631981 -0.02095667]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 2 0 4 1] pred: [-0.01116423 -0.04073668  0.03761102  0.05890692 -0.02552513]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 5 : 
BPIC15.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a GRU
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 154, 357)          127449    
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                70020     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 197,774
Trainable params: 197,774
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 59s - loss: 1.2504 - accuracy: 0.1875 2/15 [===>..........................] - ETA: 1s - loss: 1.2922 - accuracy: 0.1992  3/15 [=====>........................] - ETA: 0s - loss: 1.2970 - accuracy: 0.2101 4/15 [=======>......................] - ETA: 0s - loss: 1.2912 - accuracy: 0.2137 5/15 [=========>....................] - ETA: 0s - loss: 1.2837 - accuracy: 0.2169 6/15 [===========>..................] - ETA: 0s - loss: 1.2765 - accuracy: 0.2207 7/15 [=============>................] - ETA: 0s - loss: 1.2720 - accuracy: 0.2223 8/15 [===============>..............] - ETA: 0s - loss: 1.2694 - accuracy: 0.2233 9/15 [=================>............] - ETA: 0s - loss: 1.2678 - accuracy: 0.223510/15 [===================>..........] - ETA: 0s - loss: 1.2677 - accuracy: 0.223011/15 [=====================>........] - ETA: 0s - loss: 1.2676 - accuracy: 0.222612/15 [=======================>......] - ETA: 0s - loss: 1.2680 - accuracy: 0.222213/15 [=========================>....] - ETA: 0s - loss: 1.2685 - accuracy: 0.221414/15 [===========================>..] - ETA: 0s - loss: 1.2688 - accuracy: 0.220915/15 [==============================] - ETA: 0s - loss: 1.2690 - accuracy: 0.220315/15 [==============================] - 5s 70ms/step - loss: 1.2692 - accuracy: 0.2198
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 0 3 2 1] pred: [ 0.03241726 -0.02842186  0.00377649  0.02259597  0.07369729]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [4 0 2 3 1] pred: [ 0.02116647 -0.02177322  0.00601689 -0.00573999  0.08715713]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [4 2 3 0 1] pred: [ 0.01501975 -0.01988853  0.02135372  0.02033192  0.07759301]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 0 3 2 1] pred: [ 0.03005436 -0.02628176  0.00350848  0.00924997  0.07694943]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [4 0 2 3 1] pred: [ 0.01795167 -0.01893157  0.01446426  0.01069162  0.06354365]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [4 0 3 2 1] pred: [ 0.03225831 -0.02768874  0.00244445  0.00807517  0.08084014]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [4 0 3 2 1] pred: [ 0.02755059 -0.03084734  0.0069825   0.01601163  0.0796001 ]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [4 0 3 2 1] pred: [ 0.02936629 -0.02637712  0.00693682  0.02425037  0.07081549]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 0 2 3 1] pred: [ 0.02365373 -0.02654323  0.00318352  0.00051975  0.08905251]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [4 0 3 2 1] pred: [ 0.02816834 -0.02641644  0.00775357  0.02440383  0.07218456]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [4 0 2 3 1] pred: [ 0.02926998 -0.0138473   0.01420434  0.00810723  0.07061952]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 0 3 2 1] pred: [ 0.0221562  -0.02895984  0.00914814  0.01089475  0.08961354]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 0 3 2 1] pred: [ 0.02662628 -0.03057468  0.01436745  0.01596216  0.07983249]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [4 0 3 2 1] pred: [ 0.03007494 -0.02613133  0.00338921  0.00901659  0.0769571 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [4 2 3 0 1] pred: [ 0.00341649 -0.0232944   0.0274666   0.02527272  0.07094014]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 6 : 
BPIC15.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a GRU
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, 154, 357)          127449    
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                70020     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 197,774
Trainable params: 197,774
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 59s - loss: 2.3056 - accuracy: 0.2656 2/15 [===>..........................] - ETA: 1s - loss: 2.2679 - accuracy: 0.2910  3/15 [=====>........................] - ETA: 1s - loss: 2.2665 - accuracy: 0.2956 4/15 [=======>......................] - ETA: 0s - loss: 2.2574 - accuracy: 0.2983 5/15 [=========>....................] - ETA: 0s - loss: 2.2552 - accuracy: 0.2993 6/15 [===========>..................] - ETA: 0s - loss: 2.2513 - accuracy: 0.3002 7/15 [=============>................] - ETA: 0s - loss: 2.2491 - accuracy: 0.3008 8/15 [===============>..............] - ETA: 0s - loss: 2.2479 - accuracy: 0.3006 9/15 [=================>............] - ETA: 0s - loss: 2.2456 - accuracy: 0.300310/15 [===================>..........] - ETA: 0s - loss: 2.2433 - accuracy: 0.300211/15 [=====================>........] - ETA: 0s - loss: 2.2425 - accuracy: 0.300012/15 [=======================>......] - ETA: 0s - loss: 2.2423 - accuracy: 0.300013/15 [=========================>....] - ETA: 0s - loss: 2.2429 - accuracy: 0.300014/15 [===========================>..] - ETA: 0s - loss: 2.2434 - accuracy: 0.300115/15 [==============================] - ETA: 0s - loss: 2.2434 - accuracy: 0.300315/15 [==============================] - 5s 82ms/step - loss: 2.2434 - accuracy: 0.3004
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 4 3 1] pred: [ 0.01548853 -0.04402842  0.02362522 -0.02974325 -0.02549933]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 0 4 3 1] pred: [ 0.01546154 -0.04402435  0.02353575 -0.0297493  -0.02547551]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 0 4 3 1] pred: [ 0.00933498 -0.04201121  0.01367268 -0.02930149 -0.02429877]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [2 0 1 3 4] pred: [-0.00285003 -0.01836307  0.01343586 -0.04288411 -0.04333385]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 2 4 3 1] pred: [ 0.01150103 -0.03725009  0.00741246 -0.03418639 -0.02402721]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [2 0 1 3 4] pred: [-0.02086501 -0.02318193  0.01118155 -0.0404017  -0.04146835]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [2 0 1 3 4] pred: [-0.01636334 -0.03350573  0.02732161 -0.03591649 -0.0416532 ]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 2 4 3 1] pred: [ 0.01340268 -0.03968334  0.01030378 -0.0323806  -0.02491283]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [2 0 4 3 1] pred: [ 0.00485891 -0.03981157  0.00571155 -0.03247411 -0.02288084]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [2 0 1 4 3] pred: [-0.00123526 -0.02415652  0.00563327 -0.04067201 -0.02818519]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [0 2 4 3 1] pred: [ 0.01247392 -0.03792234  0.00680292 -0.03443853 -0.02344441]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [2 0 4 3 1] pred: [ 0.00686948 -0.03814229  0.0070058  -0.03218405 -0.02204478]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [0 2 4 3 1] pred: [ 0.01340649 -0.04113333  0.01176834 -0.03080479 -0.02461764]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 0 4 3 1] pred: [ 0.00899207 -0.04178178  0.01331774 -0.02901365 -0.02425129]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [2 0 3 1 4] pred: [ 0.00014024 -0.0211316   0.02780454 -0.01108431 -0.03448739]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 7 : 
BPIC15.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a GRU
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, 154, 357)          127449    
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                70020     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 197,774
Trainable params: 197,774
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 59s - loss: 2.4186 - accuracy: 0.2500 2/15 [===>..........................] - ETA: 0s - loss: 2.4206 - accuracy: 0.2559  3/15 [=====>........................] - ETA: 0s - loss: 2.4121 - accuracy: 0.2617 4/15 [=======>......................] - ETA: 0s - loss: 2.4143 - accuracy: 0.2622 5/15 [=========>....................] - ETA: 0s - loss: 2.4177 - accuracy: 0.2623 6/15 [===========>..................] - ETA: 0s - loss: 2.4207 - accuracy: 0.2617 7/15 [=============>................] - ETA: 0s - loss: 2.4264 - accuracy: 0.2602 8/15 [===============>..............] - ETA: 0s - loss: 2.4313 - accuracy: 0.2589 9/15 [=================>............] - ETA: 0s - loss: 2.4325 - accuracy: 0.258810/15 [===================>..........] - ETA: 0s - loss: 2.4333 - accuracy: 0.258711/15 [=====================>........] - ETA: 0s - loss: 2.4340 - accuracy: 0.258612/15 [=======================>......] - ETA: 0s - loss: 2.4341 - accuracy: 0.258613/15 [=========================>....] - ETA: 0s - loss: 2.4345 - accuracy: 0.258414/15 [===========================>..] - ETA: 0s - loss: 2.4351 - accuracy: 0.258215/15 [==============================] - ETA: 0s - loss: 2.4361 - accuracy: 0.257915/15 [==============================] - 5s 69ms/step - loss: 2.4369 - accuracy: 0.2576
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 4 0 1] pred: [-0.05355382 -0.06325719  0.05583072 -0.01161313 -0.03341677]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 4 3 1 0] pred: [-0.05692014 -0.0497345   0.03614509 -0.02225411 -0.01912055]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 4 0 1] pred: [-0.04639145 -0.06132727  0.05051222 -0.0170471  -0.03066517]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 4 1 0] pred: [-0.05773897 -0.05656453  0.0543172  -0.00894652 -0.03533806]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 4 0 1] pred: [-0.05014693 -0.06469645  0.05508159 -0.01417137 -0.03255724]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [2 4 3 1 0] pred: [-0.06597344 -0.0404644   0.03817653 -0.01899218 -0.01606713]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 4 0 1] pred: [-0.05026078 -0.06492177  0.05439949 -0.0155353  -0.03334711]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 3 1 0] pred: [-0.06554331 -0.04235448  0.0323666  -0.0212485  -0.01726667]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [2 4 3 0 1] pred: [-0.05405908 -0.06167779  0.03528207 -0.03612843 -0.01692366]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 4 0 1] pred: [-0.04970137 -0.06509317  0.05506408 -0.01600275 -0.03367468]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 4 0 1] pred: [-0.05387501 -0.06071679  0.05074216 -0.01366747 -0.03004267]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 4 3 0 1] pred: [-0.05009854 -0.06617393  0.03463561 -0.02614271 -0.01887485]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 4 0 1] pred: [-0.04775829 -0.06029199  0.05616951 -0.01872339 -0.0272179 ]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 4 0 1] pred: [-0.04725947 -0.06031528  0.05067499 -0.0161275  -0.03106145]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 0 1 4] pred: [-0.02967302 -0.03147924  0.03278605  0.02263121 -0.05367597]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 8 : 
BPIC15.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a GRU
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, 154, 357)          127449    
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                70020     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 197,774
Trainable params: 197,774
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 59s - loss: 1.7455 - accuracy: 0.2656 2/15 [===>..........................] - ETA: 0s - loss: 1.7494 - accuracy: 0.2539  3/15 [=====>........................] - ETA: 0s - loss: 1.7505 - accuracy: 0.2491 4/15 [=======>......................] - ETA: 0s - loss: 1.7479 - accuracy: 0.2469 5/15 [=========>....................] - ETA: 0s - loss: 1.7547 - accuracy: 0.2438 6/15 [===========>..................] - ETA: 0s - loss: 1.7564 - accuracy: 0.2409 7/15 [=============>................] - ETA: 0s - loss: 1.7566 - accuracy: 0.2390 8/15 [===============>..............] - ETA: 0s - loss: 1.7598 - accuracy: 0.2369 9/15 [=================>............] - ETA: 0s - loss: 1.7602 - accuracy: 0.235510/15 [===================>..........] - ETA: 0s - loss: 1.7591 - accuracy: 0.234711/15 [=====================>........] - ETA: 0s - loss: 1.7596 - accuracy: 0.233512/15 [=======================>......] - ETA: 0s - loss: 1.7607 - accuracy: 0.232013/15 [=========================>....] - ETA: 0s - loss: 1.7622 - accuracy: 0.230814/15 [===========================>..] - ETA: 0s - loss: 1.7626 - accuracy: 0.230015/15 [==============================] - ETA: 0s - loss: 1.7634 - accuracy: 0.229315/15 [==============================] - 5s 75ms/step - loss: 1.7641 - accuracy: 0.2287
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 2 1 0 3] pred: [-0.01064106 -0.00435644  0.02785915 -0.03526071  0.06300327]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [4 2 1 3 0] pred: [-0.02833506  0.00037963  0.03708749 -0.02218808  0.05088118]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 2 1 0 3] pred: [-0.02881889 -0.00260808  0.04241012 -0.03845271  0.05874556]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 2 1 3 0] pred: [-0.03567759  0.003348    0.04373657 -0.0350409   0.06122344]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [4 2 1 0 3] pred: [-0.03656653 -0.00831152  0.05155452 -0.05305597  0.08512633]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [4 2 1 3 0] pred: [-0.03056097  0.00057427  0.04429474 -0.01637451  0.05403436]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [4 2 1 0 3] pred: [-0.02829378 -0.00374222  0.05139937 -0.04506034  0.08315088]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [4 2 1 0 3] pred: [-0.02215706 -0.00010099  0.03576884 -0.03267397  0.05715476]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 2 1 0 3] pred: [-0.030603   -0.01018617  0.03910346 -0.05393282  0.08483746]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [4 2 1 0 3] pred: [-0.01312103 -0.00206267  0.02660032 -0.03562153  0.06431363]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [4 2 1 3 0] pred: [-0.03552803  0.00320674  0.04388135 -0.03493305  0.06108065]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [4 2 1 0 3] pred: [-0.02116445 -0.01206086  0.02951512 -0.05295132  0.08175569]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 2 1 0 3] pred: [-0.02674869 -0.00144235  0.04310432 -0.02719605  0.05630233]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 4 3 0] pred: [-0.05282494  0.04239575  0.03618085  0.01667698  0.03297413]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [4 2 1 0 3] pred: [-0.02178779 -0.00081814  0.03453287 -0.03245312  0.05800568]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 9 : 
BPIC15.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a GRU
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 154, 357)          127449    
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                70020     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 197,774
Trainable params: 197,774
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:05 - loss: 1.6600 - accuracy: 0.2266 2/15 [===>..........................] - ETA: 1s - loss: 1.6694 - accuracy: 0.2090   3/15 [=====>........................] - ETA: 1s - loss: 1.6795 - accuracy: 0.2070 4/15 [=======>......................] - ETA: 0s - loss: 1.6798 - accuracy: 0.2095 5/15 [=========>....................] - ETA: 0s - loss: 1.6794 - accuracy: 0.2098 6/15 [===========>..................] - ETA: 0s - loss: 1.6766 - accuracy: 0.2089 7/15 [=============>................] - ETA: 0s - loss: 1.6712 - accuracy: 0.2082 8/15 [===============>..............] - ETA: 0s - loss: 1.6672 - accuracy: 0.2083 9/15 [=================>............] - ETA: 0s - loss: 1.6622 - accuracy: 0.208910/15 [===================>..........] - ETA: 0s - loss: 1.6587 - accuracy: 0.209611/15 [=====================>........] - ETA: 0s - loss: 1.6563 - accuracy: 0.210312/15 [=======================>......] - ETA: 0s - loss: 1.6536 - accuracy: 0.211013/15 [=========================>....] - ETA: 0s - loss: 1.6508 - accuracy: 0.211714/15 [===========================>..] - ETA: 0s - loss: 1.6472 - accuracy: 0.212315/15 [==============================] - ETA: 0s - loss: 1.6443 - accuracy: 0.212815/15 [==============================] - 6s 89ms/step - loss: 1.6417 - accuracy: 0.2133
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 3 4 2 1] pred: [ 0.06159332 -0.03826458 -0.01630585  0.05282111  0.0264043 ]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 3 4 2 1] pred: [ 0.05444328 -0.02970023 -0.02097828  0.04385422  0.02806495]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [0 3 4 1 2] pred: [ 0.07010975 -0.02303446 -0.03198209  0.03030726  0.02352417]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [0 3 4 1 2] pred: [ 0.07317049 -0.02975278 -0.03685873  0.02534951  0.02474676]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 3 4 1 2] pred: [ 0.07057077 -0.02450265 -0.03412828  0.03036137  0.0217618 ]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [0 4 3 1 2] pred: [ 0.07064694 -0.02344001 -0.03692795  0.02679619  0.02687516]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [0 3 4 2 1] pred: [ 0.05545322 -0.02925507 -0.01934649  0.04652764  0.02933587]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 3 4 1 2] pred: [ 0.07268453 -0.03001095 -0.03672623  0.02533546  0.02437112]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 3 4 2 1] pred: [ 0.05794205 -0.03961422 -0.02145317  0.0530245   0.02056896]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [0 4 3 1 2] pred: [ 0.0660953  -0.01001357 -0.02162653  0.02730192  0.04640997]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [0 4 3 1 2] pred: [ 0.07108948 -0.02504539 -0.03757562  0.02577487  0.02672074]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [0 3 4 2 1] pred: [ 0.05487758 -0.0280282  -0.02069259  0.0461999   0.02734599]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [0 3 4 1 2] pred: [ 0.07250787 -0.02970725 -0.03685972  0.0252881   0.02427816]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [0 4 3 1 2] pred: [ 0.07207282 -0.01827672 -0.02708679  0.02679553  0.03181376]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 3 4 1 2] pred: [ 0.06966719 -0.022964   -0.03273911  0.03249044  0.02149284]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Job end at Sat Nov  5 09:09:32 CET 2022
