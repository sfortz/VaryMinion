
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompi-2020b
  2) GCC/8.3.0 => GCC/10.2.0
  3) GCCcore/8.3.0 => GCCcore/10.2.0
  4) OpenBLAS/0.3.7-GCC-8.3.0 => OpenBLAS/0.3.12-GCC-10.2.0
  5) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/4.0.5-GCC-10.2.0
  6) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.1.0-gompi-2020b
  7) XZ/5.2.4-GCCcore-8.3.0 => XZ/5.2.5-GCCcore-10.2.0
  8) binutils/2.32-GCCcore-8.3.0 => binutils/2.35-GCCcore-10.2.0
  9) foss/2019b => foss/2020b
 10) gompi/2019b => gompi/2020b
 11) hwloc/1.11.12-GCCcore-8.3.0 => hwloc/2.2.0-GCCcore-10.2.0
 12) libpciaccess/0.14-GCCcore-8.3.0 => libpciaccess/0.16-GCCcore-10.2.0
 13) libxml2/2.9.9-GCCcore-8.3.0 => libxml2/2.9.10-GCCcore-10.2.0
 14) numactl/2.0.12-GCCcore-8.3.0 => numactl/2.0.13-GCCcore-10.2.0
 15) releases/2019b => releases/2020b
 16) zlib/1.2.11-GCCcore-8.3.0 => zlib/1.2.11-GCCcore-10.2.0

Job start at Sat Nov  5 09:51:54 CET 2022
WARNING:tensorflow:From /scratch/2546008/2546008/VaryMinions/scripts/training_NN/training_Model.py:22: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2022-11-05 09:52:01.338070: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-05 09:52:01.338582: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
2022-11-05 09:52:03.220518: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-11-05 09:52:03.220874: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500195000 Hz
Number of possible configurations: 40
Begining exécution of the 14 th configuration: BPIC15.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and jaccard as loss function.
Exécution 0 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 357)         127449    
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                93120     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:04 - loss: 1.0274 - accuracy: 0.2422 2/15 [===>..........................] - ETA: 1s - loss: 1.0272 - accuracy: 0.2500   3/15 [=====>........................] - ETA: 1s - loss: 1.0274 - accuracy: 0.2457 4/15 [=======>......................] - ETA: 0s - loss: 1.0273 - accuracy: 0.2404 5/15 [=========>....................] - ETA: 0s - loss: 1.0274 - accuracy: 0.2383 6/15 [===========>..................] - ETA: 0s - loss: 1.0273 - accuracy: 0.2359 7/15 [=============>................] - ETA: 0s - loss: 1.0273 - accuracy: 0.2336 8/15 [===============>..............] - ETA: 0s - loss: 1.0273 - accuracy: 0.2325 9/15 [=================>............] - ETA: 0s - loss: 1.0273 - accuracy: 0.231510/15 [===================>..........] - ETA: 0s - loss: 1.0273 - accuracy: 0.230611/15 [=====================>........] - ETA: 0s - loss: 1.0273 - accuracy: 0.229712/15 [=======================>......] - ETA: 0s - loss: 1.0273 - accuracy: 0.228913/15 [=========================>....] - ETA: 0s - loss: 1.0273 - accuracy: 0.228014/15 [===========================>..] - ETA: 0s - loss: 1.0273 - accuracy: 0.227115/15 [==============================] - ETA: 0s - loss: 1.0273 - accuracy: 0.226415/15 [==============================] - 6s 84ms/step - loss: 1.0273 - accuracy: 0.2258
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 3 1 0 2] pred: [-0.01615456 -0.00822874 -0.04887125 -0.00304929  0.05075398]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [4 1 3 0 2] pred: [-0.00754869 -0.00014994 -0.05127607 -0.00240573  0.02774984]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [4 1 0 3 2] pred: [ 0.00225291  0.00290523 -0.02182343 -0.00282882  0.02706937]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [4 2 0 3 1] pred: [-0.00217092 -0.00771933  0.0013251  -0.00289661  0.01153229]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [3 4 0 1 2] pred: [-0.00754362 -0.01178429 -0.01975187  0.01468165  0.01241921]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 1 0 2] pred: [-0.01117762  0.00198767 -0.01432016  0.01423136  0.00325789]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [4 3 1 0 2] pred: [ 0.0013598   0.01339433 -0.02881936  0.01414381  0.03459597]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [4 1 3 0 2] pred: [-0.01503431  0.00106977 -0.03721837 -0.008444    0.02852778]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 1 0 4 2] pred: [-8.0768950e-05  6.6601620e-03 -2.0319629e-02  3.0799227e-02
 -3.4542789e-03]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [3 1 4 0 2] pred: [-0.01987661  0.01892773 -0.04071239  0.02546171  0.01259524]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [4 1 3 0 2] pred: [-0.02019765  0.0029298  -0.03556333 -0.00618242  0.04427316]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 1 3 0 2] pred: [-0.00923178  0.01904123 -0.01701176  0.0008459   0.0364508 ]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 1 0 3 2] pred: [ 0.01396952  0.01712267 -0.02875438 -0.00013653  0.02059489]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [4 1 0 3 2] pred: [-0.00788533  0.00396987 -0.04866984 -0.00840141  0.04507797]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [4 0 3 1 2] pred: [ 0.00076027 -0.0039238  -0.0594433  -0.00029827  0.02431841]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 1 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:01 - loss: 1.0277 - accuracy: 0.2109 2/15 [===>..........................] - ETA: 0s - loss: 1.0288 - accuracy: 0.2168   3/15 [=====>........................] - ETA: 0s - loss: 1.0290 - accuracy: 0.2096 4/15 [=======>......................] - ETA: 0s - loss: 1.0289 - accuracy: 0.2095 5/15 [=========>....................] - ETA: 0s - loss: 1.0286 - accuracy: 0.2123 6/15 [===========>..................] - ETA: 0s - loss: 1.0285 - accuracy: 0.2155 7/15 [=============>................] - ETA: 0s - loss: 1.0283 - accuracy: 0.2179 8/15 [===============>..............] - ETA: 0s - loss: 1.0282 - accuracy: 0.2193 9/15 [=================>............] - ETA: 0s - loss: 1.0281 - accuracy: 0.220010/15 [===================>..........] - ETA: 0s - loss: 1.0280 - accuracy: 0.220511/15 [=====================>........] - ETA: 0s - loss: 1.0279 - accuracy: 0.221112/15 [=======================>......] - ETA: 0s - loss: 1.0278 - accuracy: 0.221413/15 [=========================>....] - ETA: 0s - loss: 1.0277 - accuracy: 0.222014/15 [===========================>..] - ETA: 0s - loss: 1.0276 - accuracy: 0.222315/15 [==============================] - ETA: 0s - loss: 1.0275 - accuracy: 0.222715/15 [==============================] - 5s 68ms/step - loss: 1.0275 - accuracy: 0.2230
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 4 0 1 3] pred: [ 0.00040922 -0.00462377  0.00744074 -0.00796676  0.00387496]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [4 2 0 1 3] pred: [ 0.00048499 -0.0065496   0.02178006 -0.03739166  0.02525981]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [4 2 1 3 0] pred: [-0.02780971  0.0043248   0.01948067 -0.02349942  0.02698319]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [1 4 2 0 3] pred: [ 0.00503127  0.03716527  0.02464964 -0.00285685  0.03704558]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [2 4 3 1 0] pred: [-0.0162887   0.00087586  0.03674374  0.00656434  0.01147147]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 4 0 3] pred: [-8.1830826e-03  9.2648836e-03  6.4704567e-05 -1.9610107e-02
 -4.1035116e-03]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 0 3] pred: [-0.01226814  0.00094591  0.00147668 -0.0214475  -0.00387278]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 1 0 3] pred: [0.01020136 0.01285937 0.02906851 0.00828679 0.02647024]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [2 4 1 3 0] pred: [-0.01250052  0.00749809  0.03651318  0.00748789  0.01283731]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [2 4 3 1 0] pred: [-0.00027149  0.00605348  0.03042957  0.00627994  0.02738633]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [4 2 0 1 3] pred: [-0.00677332 -0.0143522   0.01216649 -0.02077396  0.01914806]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [1 0 4 3 2] pred: [0.03047797 0.03570512 0.01230614 0.02051062 0.02517459]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 4 1 0] pred: [-0.02278147 -0.00866679  0.01129033  0.003395   -0.00439786]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 4 1 0 3] pred: [-0.01463647 -0.00321071  0.01148556 -0.01836667  0.00698543]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 4 3] pred: [ 0.00426267  0.00975243  0.0072411  -0.01587026  0.00108958]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 2 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 59s - loss: 1.0428 - accuracy: 0.1797 2/15 [===>..........................] - ETA: 0s - loss: 1.0422 - accuracy: 0.1777  3/15 [=====>........................] - ETA: 0s - loss: 1.0419 - accuracy: 0.1827 4/15 [=======>......................] - ETA: 0s - loss: 1.0419 - accuracy: 0.1839 5/15 [=========>....................] - ETA: 0s - loss: 1.0419 - accuracy: 0.1856 6/15 [===========>..................] - ETA: 0s - loss: 1.0419 - accuracy: 0.1865 7/15 [=============>................] - ETA: 0s - loss: 1.0419 - accuracy: 0.1873 8/15 [===============>..............] - ETA: 0s - loss: 1.0419 - accuracy: 0.1872 9/15 [=================>............] - ETA: 0s - loss: 1.0419 - accuracy: 0.187310/15 [===================>..........] - ETA: 0s - loss: 1.0419 - accuracy: 0.187811/15 [=====================>........] - ETA: 0s - loss: 1.0419 - accuracy: 0.188212/15 [=======================>......] - ETA: 0s - loss: 1.0419 - accuracy: 0.189213/15 [=========================>....] - ETA: 0s - loss: 1.0418 - accuracy: 0.189914/15 [===========================>..] - ETA: 0s - loss: 1.0418 - accuracy: 0.190515/15 [==============================] - 5s 60ms/step - loss: 1.0418 - accuracy: 0.1915
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 3 0 4] pred: [-0.00130198  0.02159444  0.02142397  0.00973502 -0.02459127]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [3 1 2 0 4] pred: [-0.01038802  0.02274997  0.01061955  0.03932799 -0.04270286]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [3 2 1 0 4] pred: [-0.0093976   0.00732881  0.0172276   0.02370569 -0.06639772]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 1 0 4] pred: [-0.03138157  0.00771597  0.02663475  0.01169595 -0.04055001]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 0 4] pred: [-0.02797172  0.00878671  0.01915148  0.01605487 -0.0492568 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 3 2 4] pred: [ 0.00534915  0.00498962 -0.017936    0.00210766 -0.03703368]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 0 1 4] pred: [-0.01588697 -0.01632586  0.0261065   0.01864523 -0.06507082]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [1 3 2 0 4] pred: [-0.01067052  0.03804802  0.01045684  0.01799121 -0.03080537]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 1 0 4] pred: [-0.01652439  0.02203294  0.03362311  0.02533212 -0.03588532]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [3 1 0 2 4] pred: [ 0.00455641  0.01226879 -0.0029562   0.01857545 -0.02581686]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 1 2 0 4] pred: [-0.01098846  0.01097849 -0.00885697  0.02003903 -0.03990038]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [-0.01791613  0.01649213  0.03592663  0.01051241 -0.03532407]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [3 2 1 0 4] pred: [-0.00541498  0.00561185  0.02564843  0.04064613 -0.06324241]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [1 3 0 2 4] pred: [ 0.00211216  0.02515886 -0.00699804  0.01478596 -0.04560526]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [-0.00511306  0.01555903  0.02794765  0.00701988 -0.04443961]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 3 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 59s - loss: 1.0146 - accuracy: 0.1797 2/15 [===>..........................] - ETA: 0s - loss: 1.0155 - accuracy: 0.1660  3/15 [=====>........................] - ETA: 0s - loss: 1.0158 - accuracy: 0.1662 4/15 [=======>......................] - ETA: 0s - loss: 1.0160 - accuracy: 0.1652 5/15 [=========>....................] - ETA: 0s - loss: 1.0161 - accuracy: 0.1659 6/15 [===========>..................] - ETA: 0s - loss: 1.0163 - accuracy: 0.1656 7/15 [=============>................] - ETA: 0s - loss: 1.0164 - accuracy: 0.1651 8/15 [===============>..............] - ETA: 0s - loss: 1.0165 - accuracy: 0.1641 9/15 [=================>............] - ETA: 0s - loss: 1.0165 - accuracy: 0.163610/15 [===================>..........] - ETA: 0s - loss: 1.0166 - accuracy: 0.163111/15 [=====================>........] - ETA: 0s - loss: 1.0166 - accuracy: 0.162712/15 [=======================>......] - ETA: 0s - loss: 1.0167 - accuracy: 0.162413/15 [=========================>....] - ETA: 0s - loss: 1.0167 - accuracy: 0.162014/15 [===========================>..] - ETA: 0s - loss: 1.0168 - accuracy: 0.161915/15 [==============================] - 5s 58ms/step - loss: 1.0168 - accuracy: 0.1620
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 3 0 2 4] pred: [ 0.01370383  0.02712627 -0.00814085  0.02107026 -0.01607976]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [1 3 0 2 4] pred: [-0.0090536   0.03447348 -0.01376508  0.01744738 -0.02177673]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 3 4 0] pred: [-0.00610895  0.01962042  0.01862155  0.00593494  0.00195489]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [1 3 0 4 2] pred: [ 0.00081979  0.01933118 -0.03124576  0.01174771 -0.02365115]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [1 4 3 2 0] pred: [-0.0110837   0.02203134  0.00085026  0.00335542  0.01495085]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [1 3 0 2 4] pred: [ 0.00329196  0.01958609 -0.02428417  0.01526414 -0.02525445]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [1 3 4 2 0] pred: [-0.02412508  0.012985   -0.00649221  0.01007566 -0.00626418]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 1 3 0] pred: [-0.01401612  0.01602386  0.03527243  0.00832536  0.01637519]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 1 0 4 2] pred: [ 0.00336725  0.01630994 -0.01861545  0.02814727 -0.01854387]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 3 4 0] pred: [-0.0148935   0.01978052  0.01371159  0.00062082 -0.00280024]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 2 4 1 0] pred: [-0.01341305  0.00236629  0.01244748  0.01433379  0.00545678]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 3 4 0] pred: [-0.01105114  0.03230603  0.01718261  0.01044118 -0.00431433]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 2 0 1] pred: [0.00452887 0.00233149 0.00813966 0.0099872  0.00987646]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [0.00499831 0.01048832 0.01219846 0.0097186  0.00019477]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [-0.01067345  0.01689974  0.02229417  0.01423267  0.00100937]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 4 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:00 - loss: 1.0300 - accuracy: 0.2188 2/15 [===>..........................] - ETA: 0s - loss: 1.0292 - accuracy: 0.2246   3/15 [=====>........................] - ETA: 0s - loss: 1.0288 - accuracy: 0.2261 4/15 [=======>......................] - ETA: 0s - loss: 1.0285 - accuracy: 0.2287 5/15 [=========>....................] - ETA: 0s - loss: 1.0284 - accuracy: 0.2295 6/15 [===========>..................] - ETA: 0s - loss: 1.0284 - accuracy: 0.2299 7/15 [=============>................] - ETA: 0s - loss: 1.0284 - accuracy: 0.2297 8/15 [===============>..............] - ETA: 0s - loss: 1.0284 - accuracy: 0.2291 9/15 [=================>............] - ETA: 0s - loss: 1.0284 - accuracy: 0.228110/15 [===================>..........] - ETA: 0s - loss: 1.0284 - accuracy: 0.227011/15 [=====================>........] - ETA: 0s - loss: 1.0284 - accuracy: 0.226312/15 [=======================>......] - ETA: 0s - loss: 1.0285 - accuracy: 0.225613/15 [=========================>....] - ETA: 0s - loss: 1.0285 - accuracy: 0.224914/15 [===========================>..] - ETA: 0s - loss: 1.0285 - accuracy: 0.224515/15 [==============================] - ETA: 0s - loss: 1.0286 - accuracy: 0.223715/15 [==============================] - 5s 61ms/step - loss: 1.0286 - accuracy: 0.2231
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 3 2 0 4] pred: [ 0.0053607   0.02472833  0.00744862  0.02303912 -0.01648356]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [3 2 1 0 4] pred: [ 0.00899496  0.02153753  0.02725194  0.0290946  -0.03001514]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [3 0 1 2 4] pred: [ 0.01623747  0.00086983 -0.00504349  0.02911221 -0.0209986 ]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [3 0 2 1 4] pred: [ 1.5070762e-02 -1.0626700e-02  8.8808825e-05  3.4549840e-02
 -2.1582173e-02]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [3 2 0 1 4] pred: [ 0.00683173 -0.00557313  0.01971639  0.05569218 -0.02601963]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [3 0 2 1 4] pred: [ 0.01316337 -0.00078202  0.00994833  0.03637124 -0.01846167]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [3 1 2 0 4] pred: [-0.00167514  0.02295987  0.01504414  0.04138871 -0.02922458]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [3 2 0 1 4] pred: [ 0.00569964 -0.01618691  0.0319457   0.04884764 -0.02723825]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 1 0 4] pred: [ 0.00333592  0.0178201   0.03382836  0.03563079 -0.04233119]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [1 3 2 0 4] pred: [-0.02310587  0.01192453 -0.01082786  0.00269155 -0.02812324]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 1 2 0 4] pred: [-0.02605627  0.02272482 -0.00057447  0.02501995 -0.03851776]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [3 2 0 4 1] pred: [ 0.00232655 -0.0148053   0.04293355  0.05330719 -0.01319039]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [1 3 2 0 4] pred: [-0.02673974  0.02294687  0.01194523  0.01574542 -0.03804343]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 0 4] pred: [-0.00596213  0.0058779   0.02541059  0.018564   -0.04156068]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 1 0 2 4] pred: [ 0.0039633   0.00797504  0.00084035  0.0289744  -0.01437321]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 5 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:00 - loss: 1.0339 - accuracy: 0.2188 2/15 [===>..........................] - ETA: 1s - loss: 1.0338 - accuracy: 0.2109   3/15 [=====>........................] - ETA: 1s - loss: 1.0343 - accuracy: 0.2040 4/15 [=======>......................] - ETA: 0s - loss: 1.0344 - accuracy: 0.2038 5/15 [=========>....................] - ETA: 0s - loss: 1.0344 - accuracy: 0.2018 6/15 [===========>..................] - ETA: 0s - loss: 1.0345 - accuracy: 0.2013 7/15 [=============>................] - ETA: 0s - loss: 1.0345 - accuracy: 0.2019 8/15 [===============>..............] - ETA: 0s - loss: 1.0344 - accuracy: 0.2032 9/15 [=================>............] - ETA: 0s - loss: 1.0344 - accuracy: 0.204110/15 [===================>..........] - ETA: 0s - loss: 1.0344 - accuracy: 0.204311/15 [=====================>........] - ETA: 0s - loss: 1.0344 - accuracy: 0.204312/15 [=======================>......] - ETA: 0s - loss: 1.0344 - accuracy: 0.204113/15 [=========================>....] - ETA: 0s - loss: 1.0343 - accuracy: 0.203814/15 [===========================>..] - ETA: 0s - loss: 1.0344 - accuracy: 0.203915/15 [==============================] - ETA: 0s - loss: 1.0344 - accuracy: 0.203915/15 [==============================] - 5s 82ms/step - loss: 1.0344 - accuracy: 0.2038
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 1 3 4 2] pred: [ 0.01826571  0.0166929  -0.03048401  0.00369247 -0.01073866]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 4 1 3 2] pred: [ 0.01118413 -0.00666877 -0.03164387 -0.00667407 -0.00341516]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [1 3 4 0 2] pred: [-0.00195219  0.02094349 -0.00441685  0.00597873  0.00300469]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 3 1 0 2] pred: [-0.02175747 -0.00750502 -0.02536812 -0.00584888  0.024963  ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [1 3 0 4 2] pred: [ 0.00193223  0.02350133 -0.02811178  0.01107694  0.00012368]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [1 0 4 3 2] pred: [ 0.00720481  0.01787395 -0.02918856 -0.00614079  0.00468252]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [1 0 3 4 2] pred: [ 0.00449043  0.02543887 -0.01908845  0.00186703 -0.01815404]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 1 3 4 2] pred: [ 0.00935459  0.00873314 -0.0164612   0.00268438 -0.00083033]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [4 1 2 3 0] pred: [-0.02024482 -0.00230028 -0.00377496 -0.00725858  0.01219898]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [0 4 1 3 2] pred: [-0.00032105 -0.00906208 -0.01675543 -0.01292382 -0.0086596 ]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [1 4 3 0 2] pred: [-0.01795901  0.01430585 -0.02895289  0.00902323  0.01036615]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 1 3 2 0] pred: [-0.03570164 -0.00191909 -0.0109122  -0.00817206  0.03325475]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 3 1 0 2] pred: [-0.00195662  0.0106759  -0.04362296  0.01386592  0.01552989]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [4 3 1 0 2] pred: [-0.0171108  -0.00963624 -0.02111117 -0.00888087  0.01840939]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [1 0 3 2 4] pred: [ 0.02254277  0.02481788 -0.0091741   0.00311375 -0.02544872]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 6 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:00 - loss: 1.0218 - accuracy: 0.2500 2/15 [===>..........................] - ETA: 0s - loss: 1.0212 - accuracy: 0.2441   3/15 [=====>........................] - ETA: 0s - loss: 1.0209 - accuracy: 0.2444 4/15 [=======>......................] - ETA: 0s - loss: 1.0208 - accuracy: 0.2458 5/15 [=========>....................] - ETA: 0s - loss: 1.0208 - accuracy: 0.2447 6/15 [===========>..................] - ETA: 0s - loss: 1.0208 - accuracy: 0.2434 7/15 [=============>................] - ETA: 0s - loss: 1.0208 - accuracy: 0.2436 8/15 [===============>..............] - ETA: 0s - loss: 1.0208 - accuracy: 0.2433 9/15 [=================>............] - ETA: 0s - loss: 1.0209 - accuracy: 0.243410/15 [===================>..........] - ETA: 0s - loss: 1.0209 - accuracy: 0.243611/15 [=====================>........] - ETA: 0s - loss: 1.0210 - accuracy: 0.243812/15 [=======================>......] - ETA: 0s - loss: 1.0210 - accuracy: 0.243813/15 [=========================>....] - ETA: 0s - loss: 1.0210 - accuracy: 0.243314/15 [===========================>..] - ETA: 0s - loss: 1.0210 - accuracy: 0.242915/15 [==============================] - ETA: 0s - loss: 1.0210 - accuracy: 0.242715/15 [==============================] - 5s 60ms/step - loss: 1.0210 - accuracy: 0.2424
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 3 1 2 4] pred: [ 0.02316238  0.0020106  -0.01217633  0.00494228 -0.02435981]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [0 1 3 4 2] pred: [ 0.00409828 -0.00489827 -0.01257314 -0.00896398 -0.01065383]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 0 1 4] pred: [-0.00724931 -0.01761859  0.00488757  0.00243141 -0.02403857]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [1 4 3 0 2] pred: [-0.01308745  0.02135116 -0.0158342  -0.00453389  0.01590123]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 2 4 1 3] pred: [ 0.01611917 -0.00694926  0.00932034 -0.01330346 -0.00308061]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [1 3 2 0 4] pred: [-0.00288773  0.00877279  0.00452801  0.00596987 -0.00556961]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [4 3 1 0 2] pred: [-0.00038338  0.00699628 -0.00070007  0.01116158  0.02060573]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 2 3 1 4] pred: [-0.00224092 -0.01460422 -0.0028019  -0.00675187 -0.01718751]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [0 1 4 2 3] pred: [ 0.01085468  0.00598423 -0.01914609 -0.02752425 -0.01417229]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [1 4 0 3 2] pred: [ 0.01114891  0.01989119 -0.01263388  0.0056348   0.01214915]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [-0.00901334 -0.00717717  0.00717044 -0.01016349 -0.01457509]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [0 1 4 2 3] pred: [ 0.00658059  0.00108304 -0.00658956 -0.01265058  0.00049087]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 0 1 2 3] pred: [-0.00422739 -0.00740976 -0.01336404 -0.01340895  0.02062175]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [1 3 4 2 0] pred: [-0.02974075  0.02396139 -0.004761    0.00926981  0.00099667]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [4 1 2 3 0] pred: [-0.01023445  0.005879   -0.00179539 -0.00606408  0.03321823]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 7 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 59s - loss: 1.0453 - accuracy: 0.2109 2/15 [===>..........................] - ETA: 1s - loss: 1.0456 - accuracy: 0.2012  3/15 [=====>........................] - ETA: 1s - loss: 1.0460 - accuracy: 0.1879 4/15 [=======>......................] - ETA: 0s - loss: 1.0460 - accuracy: 0.1800 5/15 [=========>....................] - ETA: 0s - loss: 1.0459 - accuracy: 0.1765 6/15 [===========>..................] - ETA: 0s - loss: 1.0458 - accuracy: 0.1742 7/15 [=============>................] - ETA: 0s - loss: 1.0458 - accuracy: 0.1729 8/15 [===============>..............] - ETA: 0s - loss: 1.0458 - accuracy: 0.1715 9/15 [=================>............] - ETA: 0s - loss: 1.0458 - accuracy: 0.170310/15 [===================>..........] - ETA: 0s - loss: 1.0458 - accuracy: 0.168711/15 [=====================>........] - ETA: 0s - loss: 1.0458 - accuracy: 0.166912/15 [=======================>......] - ETA: 0s - loss: 1.0458 - accuracy: 0.165313/15 [=========================>....] - ETA: 0s - loss: 1.0458 - accuracy: 0.164114/15 [===========================>..] - ETA: 0s - loss: 1.0458 - accuracy: 0.163015/15 [==============================] - ETA: 0s - loss: 1.0459 - accuracy: 0.162215/15 [==============================] - 5s 84ms/step - loss: 1.0459 - accuracy: 0.1615
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 0 2 1 3] pred: [-0.00031616 -0.00676797 -0.00397234 -0.01050263  0.0140777 ]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 4 3 1 2] pred: [ 0.00530727 -0.01247565 -0.01476172 -0.00922625  0.00265631]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [0 4 2 3 1] pred: [ 0.01073357 -0.01264339 -0.01121613 -0.01260175 -0.00409535]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [2 4 1 0 3] pred: [-0.01100798 -0.01011485  0.00720155 -0.01519508  0.00572229]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [4 0 3 1 2] pred: [ 0.00530645 -0.00799727 -0.01767904 -0.00544859  0.01060256]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [0 4 3 1 2] pred: [ 0.0162092  -0.02468655 -0.02886354 -0.00744655 -0.00022815]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [1 4 3 2 0] pred: [-2.0362580e-02 -9.7322278e-05 -1.2815220e-02 -4.9677501e-03
 -4.1759126e-03]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 4 2 1 3] pred: [ 0.00384998 -0.01171494 -0.00736882 -0.02314817  0.00331799]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 0 3 2 1] pred: [ 0.00384521 -0.01884742 -0.01422792 -0.00925068  0.01036531]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [0 4 2 1 3] pred: [ 0.0045402  -0.02248626 -0.01279049 -0.02513048  0.00139077]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 4 0] pred: [-0.02803193 -0.0152251   0.00030166 -0.00724042 -0.01656576]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 0 3 2 1] pred: [ 0.01742851 -0.03075137 -0.02620272 -0.0004119   0.03104941]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 0 3 2 1] pred: [ 0.00279833 -0.02211253 -0.01667778 -0.01335528  0.01289154]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [0 4 2 3 1] pred: [ 0.0104975  -0.01491023 -0.01061301 -0.01100934  0.00345685]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 3 2 4 1] pred: [ 0.00383643 -0.03195701 -0.01841821  0.00260364 -0.01953648]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 8 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 59s - loss: 1.0132 - accuracy: 0.2109 2/15 [===>..........................] - ETA: 0s - loss: 1.0120 - accuracy: 0.2148  3/15 [=====>........................] - ETA: 0s - loss: 1.0119 - accuracy: 0.2127 4/15 [=======>......................] - ETA: 0s - loss: 1.0118 - accuracy: 0.2108 5/15 [=========>....................] - ETA: 0s - loss: 1.0118 - accuracy: 0.2121 6/15 [===========>..................] - ETA: 0s - loss: 1.0119 - accuracy: 0.2121 7/15 [=============>................] - ETA: 0s - loss: 1.0120 - accuracy: 0.2113 8/15 [===============>..............] - ETA: 0s - loss: 1.0120 - accuracy: 0.2108 9/15 [=================>............] - ETA: 0s - loss: 1.0121 - accuracy: 0.210610/15 [===================>..........] - ETA: 0s - loss: 1.0122 - accuracy: 0.210211/15 [=====================>........] - ETA: 0s - loss: 1.0122 - accuracy: 0.209412/15 [=======================>......] - ETA: 0s - loss: 1.0123 - accuracy: 0.208213/15 [=========================>....] - ETA: 0s - loss: 1.0123 - accuracy: 0.206814/15 [===========================>..] - ETA: 0s - loss: 1.0124 - accuracy: 0.205915/15 [==============================] - ETA: 0s - loss: 1.0124 - accuracy: 0.205215/15 [==============================] - 5s 68ms/step - loss: 1.0124 - accuracy: 0.2045
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 1 2 3 0] pred: [-0.04103215  0.01674991  0.0118136  -0.00483983  0.02505351]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 3 2 1 4] pred: [ 0.01228753  0.00562082  0.0063302   0.01154833 -0.00790218]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [-0.00939354  0.0183105   0.02172235  0.01344967 -0.01977776]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [3 1 4 2 0] pred: [-0.00927061 -0.00056259 -0.00309571  0.01066184 -0.00061642]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [3 1 2 4 0] pred: [-0.02493335 -0.00280275 -0.00585383  0.00198147 -0.00695408]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [3 2 1 0 4] pred: [-0.01337832  0.0184194   0.02003108  0.02209054 -0.01761231]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [3 1 4 2 0] pred: [-0.03059071  0.0008979  -0.01101287  0.00476096 -0.00805829]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 3 4 0] pred: [-0.02657423  0.00912172  0.00205454 -0.0003161  -0.00419589]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 1 0] pred: [-0.00160403  0.00244553  0.01641092  0.01813092  0.00381377]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 0 1 4] pred: [ 0.00406667 -0.00134042  0.00848713  0.02280245 -0.00407373]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 3 4 0] pred: [-0.03142652  0.03378138  0.02012042 -0.00245567 -0.02088772]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [1 3 0 2 4] pred: [ 0.0144043   0.02547302  0.01426216  0.01961815 -0.01291952]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [1 3 2 0 4] pred: [ 0.00495365  0.02631237  0.01450873  0.01897129 -0.02413281]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [4 2 1 3 0] pred: [-0.03286099  0.00330995  0.00493396 -0.00324359  0.01303409]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [4 0 3 2 1] pred: [ 0.01235014 -0.01908332  0.00267736  0.00393714  0.02288917]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 9 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 58s - loss: 1.0100 - accuracy: 0.2266 2/15 [===>..........................] - ETA: 0s - loss: 1.0105 - accuracy: 0.2168  3/15 [=====>........................] - ETA: 0s - loss: 1.0106 - accuracy: 0.2131 4/15 [=======>......................] - ETA: 0s - loss: 1.0107 - accuracy: 0.2096 5/15 [=========>....................] - ETA: 0s - loss: 1.0107 - accuracy: 0.2077 6/15 [===========>..................] - ETA: 0s - loss: 1.0108 - accuracy: 0.2056 7/15 [=============>................] - ETA: 0s - loss: 1.0108 - accuracy: 0.2040 8/15 [===============>..............] - ETA: 0s - loss: 1.0108 - accuracy: 0.2032 9/15 [=================>............] - ETA: 0s - loss: 1.0109 - accuracy: 0.202210/15 [===================>..........] - ETA: 0s - loss: 1.0110 - accuracy: 0.201111/15 [=====================>........] - ETA: 0s - loss: 1.0110 - accuracy: 0.200212/15 [=======================>......] - ETA: 0s - loss: 1.0111 - accuracy: 0.199713/15 [=========================>....] - ETA: 0s - loss: 1.0111 - accuracy: 0.199414/15 [===========================>..] - ETA: 0s - loss: 1.0112 - accuracy: 0.199015/15 [==============================] - ETA: 0s - loss: 1.0112 - accuracy: 0.199115/15 [==============================] - 5s 74ms/step - loss: 1.0112 - accuracy: 0.1991
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 0 4 2 3] pred: [ 0.02860043  0.02983852  0.00533064 -0.00239876  0.02250387]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 1 4 3 2] pred: [ 0.02395952  0.02391365 -0.01525899  0.01010776  0.01194763]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [1 0 3 4 2] pred: [ 0.011534    0.0224257  -0.00708611  0.00117894 -0.00066765]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [1 0 3 4 2] pred: [ 0.02636673  0.04249404 -0.01030221  0.00856676  0.00718985]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 1 3 4 2] pred: [ 0.03453311  0.03378312 -0.01452139  0.0164794  -0.00905218]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [1 3 0 4 2] pred: [ 0.01703211  0.04627427 -0.01560851  0.01852541 -0.00902797]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 4 3 0] pred: [-3.5796207e-03  1.2874762e-02  1.3231300e-05 -3.7892465e-04
  1.2681470e-05]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 1 3 2 4] pred: [ 0.0322054   0.02122658 -0.01314598  0.00847922 -0.01377792]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [1 3 2 0 4] pred: [-0.02053405  0.02680602 -0.0181034   0.00335074 -0.0210614 ]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [1 0 3 4 2] pred: [ 0.04151145  0.05291247 -0.03483361  0.00096947 -0.01195136]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [1 3 0 2 4] pred: [-0.01732727  0.02712174 -0.01780673  0.00701286 -0.02485344]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [1 0 4 3 2] pred: [ 0.0230278   0.03522095 -0.02247224  0.00477861  0.01708044]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [1 0 4 3 2] pred: [ 0.02123659  0.04503603 -0.0276119  -0.00668543  0.00574852]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [1 3 2 0 4] pred: [-0.0134608   0.0251671  -0.00677649 -0.00641615 -0.01465978]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [1 0 3 4 2] pred: [ 0.02548784  0.03272684 -0.00997201  0.01742372  0.009519  ]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Job end at Sat Nov  5 09:54:41 CET 2022
