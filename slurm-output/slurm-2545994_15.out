
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompi-2020b
  2) GCC/8.3.0 => GCC/10.2.0
  3) GCCcore/8.3.0 => GCCcore/10.2.0
  4) OpenBLAS/0.3.7-GCC-8.3.0 => OpenBLAS/0.3.12-GCC-10.2.0
  5) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/4.0.5-GCC-10.2.0
  6) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.1.0-gompi-2020b
  7) XZ/5.2.4-GCCcore-8.3.0 => XZ/5.2.5-GCCcore-10.2.0
  8) binutils/2.32-GCCcore-8.3.0 => binutils/2.35-GCCcore-10.2.0
  9) foss/2019b => foss/2020b
 10) gompi/2019b => gompi/2020b
 11) hwloc/1.11.12-GCCcore-8.3.0 => hwloc/2.2.0-GCCcore-10.2.0
 12) libpciaccess/0.14-GCCcore-8.3.0 => libpciaccess/0.16-GCCcore-10.2.0
 13) libxml2/2.9.9-GCCcore-8.3.0 => libxml2/2.9.10-GCCcore-10.2.0
 14) numactl/2.0.12-GCCcore-8.3.0 => numactl/2.0.13-GCCcore-10.2.0
 15) releases/2019b => releases/2020b
 16) zlib/1.2.11-GCCcore-8.3.0 => zlib/1.2.11-GCCcore-10.2.0

Job start at Sat Nov  5 09:55:23 CET 2022
WARNING:tensorflow:From /scratch/2546009/2546009/VaryMinions/scripts/training_NN/training_Model.py:22: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2022-11-05 09:55:30.540746: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-05 09:55:30.541267: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
2022-11-05 09:55:32.414039: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-11-05 09:55:32.414398: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500195000 Hz
Number of possible configurations: 40
Begining exécution of the 15 th configuration: BPIC15.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and manhattan as loss function.
Exécution 0 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 357)         127449    
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                93120     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:04 - loss: 1.0566 - accuracy: 0.1484 2/15 [===>..........................] - ETA: 1s - loss: 1.0570 - accuracy: 0.1543   3/15 [=====>........................] - ETA: 1s - loss: 1.0570 - accuracy: 0.1489 4/15 [=======>......................] - ETA: 1s - loss: 1.0572 - accuracy: 0.1458 5/15 [=========>....................] - ETA: 1s - loss: 1.0573 - accuracy: 0.1451 6/15 [===========>..................] - ETA: 0s - loss: 1.0575 - accuracy: 0.1439 7/15 [=============>................] - ETA: 0s - loss: 1.0575 - accuracy: 0.1431 8/15 [===============>..............] - ETA: 0s - loss: 1.0576 - accuracy: 0.1425 9/15 [=================>............] - ETA: 0s - loss: 1.0577 - accuracy: 0.142510/15 [===================>..........] - ETA: 0s - loss: 1.0579 - accuracy: 0.142711/15 [=====================>........] - ETA: 0s - loss: 1.0580 - accuracy: 0.142712/15 [=======================>......] - ETA: 0s - loss: 1.0581 - accuracy: 0.143413/15 [=========================>....] - ETA: 0s - loss: 1.0582 - accuracy: 0.144214/15 [===========================>..] - ETA: 0s - loss: 1.0583 - accuracy: 0.144615/15 [==============================] - ETA: 0s - loss: 1.0584 - accuracy: 0.144915/15 [==============================] - 6s 95ms/step - loss: 1.0584 - accuracy: 0.1451
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 0 2 3 4] pred: [ 0.01170281  0.02914495  0.0029273   0.00271111 -0.04149272]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [3 2 1 0 4] pred: [-0.00958573 -0.0040649  -0.00065085  0.01587206 -0.00974801]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [0 3 2 1 4] pred: [ 0.02839209 -0.00074602  0.00451705  0.00521498 -0.01022484]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [1 3 0 2 4] pred: [-0.00515971  0.03521725 -0.01279933  0.01140697 -0.01951749]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 1 2 3 4] pred: [ 0.01514098  0.01072417 -0.00959684 -0.01391498 -0.0342207 ]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 2 0 1] pred: [-0.00749861 -0.01004108  0.00712805  0.03183618  0.0091622 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [1 0 3 2 4] pred: [ 0.00464541  0.01046694 -0.00408822  0.00275538 -0.02313267]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [1 3 0 4 2] pred: [ 0.00810813  0.01549162 -0.00104311  0.01186746  0.00329256]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 2 3 1 4] pred: [-0.00264573 -0.01665785 -0.00704267 -0.00883123 -0.05836666]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [0 2 1 3 4] pred: [ 0.01926349  0.01393543  0.01520886 -0.01245241 -0.01722461]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [1 3 0 2 4] pred: [-0.00668413  0.03933909 -0.00751887  0.01581685 -0.03226398]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [0 3 2 1 4] pred: [ 0.0169497  -0.02915142 -0.01919487 -0.00524664 -0.04557168]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [0 1 2 3 4] pred: [ 0.03762298  0.00490047 -0.00325902 -0.02444953 -0.02898287]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [1 0 2 3 4] pred: [ 0.01435257  0.02285874  0.00444293  0.00371326 -0.00402844]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 1 2 3 4] pred: [ 0.03070906  0.00269999 -0.00990112 -0.01609982 -0.02928091]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 1 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:01 - loss: 1.0423 - accuracy: 0.1875 2/15 [===>..........................] - ETA: 0s - loss: 1.0422 - accuracy: 0.2031   3/15 [=====>........................] - ETA: 0s - loss: 1.0422 - accuracy: 0.2023 4/15 [=======>......................] - ETA: 0s - loss: 1.0425 - accuracy: 0.1995 5/15 [=========>....................] - ETA: 0s - loss: 1.0428 - accuracy: 0.2012 6/15 [===========>..................] - ETA: 0s - loss: 1.0430 - accuracy: 0.2033 7/15 [=============>................] - ETA: 0s - loss: 1.0432 - accuracy: 0.2037 8/15 [===============>..............] - ETA: 0s - loss: 1.0433 - accuracy: 0.2043 9/15 [=================>............] - ETA: 0s - loss: 1.0433 - accuracy: 0.203810/15 [===================>..........] - ETA: 0s - loss: 1.0434 - accuracy: 0.203111/15 [=====================>........] - ETA: 0s - loss: 1.0435 - accuracy: 0.202212/15 [=======================>......] - ETA: 0s - loss: 1.0436 - accuracy: 0.201113/15 [=========================>....] - ETA: 0s - loss: 1.0437 - accuracy: 0.200214/15 [===========================>..] - ETA: 0s - loss: 1.0437 - accuracy: 0.199515/15 [==============================] - ETA: 0s - loss: 1.0438 - accuracy: 0.199015/15 [==============================] - 5s 68ms/step - loss: 1.0438 - accuracy: 0.1985
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 1 3 0 2] pred: [-0.00264081  0.00164979 -0.01532919 -0.00170226  0.03351622]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 2 1 0] pred: [-0.01754598 -0.01197614 -0.0046342   0.0200319   0.00057314]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [0 1 3 4 2] pred: [ 0.02055905 -0.00907673 -0.01795209 -0.01430036 -0.0177328 ]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 2 1 0] pred: [-0.01769682 -0.01572797 -0.00747182  0.01544124  0.00373053]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [3 0 1 4 2] pred: [ 0.0095085   0.00271551 -0.01394774  0.02504268  0.00217881]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [3 2 1 4 0] pred: [-0.01473725  0.0035532   0.00689907  0.00881779 -0.00841532]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [3 1 2 4 0] pred: [-0.02120678  0.00504292 -0.01068743  0.00515119 -0.01599883]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 2 1 0] pred: [-0.02555596 -0.02166463 -0.00837107  0.01096481  0.00266499]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 0 1 4 2] pred: [ 0.01884423 -0.00093327 -0.01554359  0.02007065 -0.00151629]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [0 2 3 4 1] pred: [ 0.01943348 -0.02387783  0.01088041  0.00273716 -0.00081158]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [4 1 0 3 2] pred: [ 0.0056874   0.00678258 -0.0112479  -0.00491744  0.02402873]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [-0.00445816  0.00587599  0.00637503 -0.00304132 -0.00479323]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [3 1 0 2 4] pred: [ 0.00113961  0.00585421  0.00063404  0.0188555  -0.00750169]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 2 1 0] pred: [-0.0225621  -0.01302058 -0.00897933  0.01720484  0.00270185]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 3 4 2 1] pred: [ 0.01763619 -0.00850433  0.00261889  0.01055066  0.00971813]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 2 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:02 - loss: 1.0568 - accuracy: 0.2188 2/15 [===>..........................] - ETA: 0s - loss: 1.0570 - accuracy: 0.2109   3/15 [=====>........................] - ETA: 0s - loss: 1.0591 - accuracy: 0.2153 4/15 [=======>......................] - ETA: 0s - loss: 1.0597 - accuracy: 0.2191 5/15 [=========>....................] - ETA: 0s - loss: 1.0601 - accuracy: 0.2199 6/15 [===========>..................] - ETA: 0s - loss: 1.0602 - accuracy: 0.2200 7/15 [=============>................] - ETA: 0s - loss: 1.0604 - accuracy: 0.2211 8/15 [===============>..............] - ETA: 0s - loss: 1.0604 - accuracy: 0.2232 9/15 [=================>............] - ETA: 0s - loss: 1.0604 - accuracy: 0.225610/15 [===================>..........] - ETA: 0s - loss: 1.0603 - accuracy: 0.227011/15 [=====================>........] - ETA: 0s - loss: 1.0602 - accuracy: 0.228512/15 [=======================>......] - ETA: 0s - loss: 1.0601 - accuracy: 0.229613/15 [=========================>....] - ETA: 0s - loss: 1.0600 - accuracy: 0.230314/15 [===========================>..] - ETA: 0s - loss: 1.0600 - accuracy: 0.230715/15 [==============================] - ETA: 0s - loss: 1.0599 - accuracy: 0.231215/15 [==============================] - 5s 74ms/step - loss: 1.0599 - accuracy: 0.2316
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 1 0 2] pred: [-0.01773199 -0.00880002 -0.02382335  0.01294355 -0.00428352]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 1 2 0] pred: [-0.00492087  0.01241275 -0.00406687  0.01795693  0.01511156]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 3 2 1 0] pred: [-0.0447051  -0.02089618 -0.00839191  0.0059569   0.01940655]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [2 0 3 4 1] pred: [-0.00196668 -0.0355944   0.0100062  -0.01037363 -0.01532763]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [4 1 2 3 0] pred: [-0.01912107  0.01444777 -0.00513393 -0.00540659  0.02507533]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [4 3 2 1 0] pred: [-0.01576312 -0.01302715 -0.01210993  0.00801117  0.01459511]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [4 2 1 3 0] pred: [-0.01096757  0.00079034  0.01168845 -0.00941225  0.02148991]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [4 1 3 2 0] pred: [-0.03165073  0.01289298 -0.01160537 -0.0098638   0.01762138]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 2 0 3 1] pred: [-0.00175058 -0.01909655  0.00953712 -0.00404623  0.01347049]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [4 1 2 0 3] pred: [-0.00943499  0.01607417 -0.0031021  -0.01103044  0.03460288]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [4 1 2 0 3] pred: [-0.0104821   0.00187458 -0.00161034 -0.01600157  0.02203884]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [4 3 1 2 0] pred: [-0.03238403 -0.01044698 -0.03166696  0.00384512  0.01756881]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 4 0 3] pred: [-0.00034283  0.02150485  0.01877103 -0.01958349  0.01206725]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [1 4 3 2 0] pred: [-0.02270265  0.02177435 -0.00957632 -0.00949082  0.02038184]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [4 3 2 0 1] pred: [-0.02964027 -0.03762261 -0.00373963  0.00912069  0.02052175]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 3 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:01 - loss: 1.0437 - accuracy: 0.2188 2/15 [===>..........................] - ETA: 0s - loss: 1.0456 - accuracy: 0.2188   3/15 [=====>........................] - ETA: 0s - loss: 1.0457 - accuracy: 0.2144 4/15 [=======>......................] - ETA: 0s - loss: 1.0455 - accuracy: 0.2126 5/15 [=========>....................] - ETA: 0s - loss: 1.0454 - accuracy: 0.2126 6/15 [===========>..................] - ETA: 0s - loss: 1.0451 - accuracy: 0.2151 7/15 [=============>................] - ETA: 0s - loss: 1.0450 - accuracy: 0.2163 8/15 [===============>..............] - ETA: 0s - loss: 1.0448 - accuracy: 0.2177 9/15 [=================>............] - ETA: 0s - loss: 1.0447 - accuracy: 0.219310/15 [===================>..........] - ETA: 0s - loss: 1.0448 - accuracy: 0.220911/15 [=====================>........] - ETA: 0s - loss: 1.0449 - accuracy: 0.222512/15 [=======================>......] - ETA: 0s - loss: 1.0451 - accuracy: 0.223413/15 [=========================>....] - ETA: 0s - loss: 1.0451 - accuracy: 0.224414/15 [===========================>..] - ETA: 0s - loss: 1.0452 - accuracy: 0.225515/15 [==============================] - ETA: 0s - loss: 1.0452 - accuracy: 0.226715/15 [==============================] - 5s 77ms/step - loss: 1.0452 - accuracy: 0.2278
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 4 0 1] pred: [-0.01464732 -0.01474902  0.01227929 -0.00243982 -0.00633356]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [2 0 4 1 3] pred: [ 0.01589558  0.00034019  0.0193724  -0.01370788  0.01158874]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [0 2 4 3 1] pred: [ 0.01741114 -0.00533041  0.01207878 -0.00270773  0.00658647]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 0 3 2 1] pred: [ 0.01144952 -0.01372089 -0.01051893  0.0043608   0.01239647]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 4 2 1 3] pred: [ 0.02664899  0.01175657  0.01310884 -0.01022278  0.0141351 ]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [0 3 4 1 2] pred: [ 0.01574495 -0.00390618 -0.0166811   0.00669252 -0.00056067]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [0 4 2 1 3] pred: [ 0.03190852 -0.0057454   0.0059107  -0.01205622  0.01157649]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 4 1 3 2] pred: [0.03427288 0.00745938 0.0003769  0.00494968 0.02269793]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [1 4 2 3 0] pred: [0.00729277 0.01304863 0.01251715 0.00891996 0.01262235]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 4 3] pred: [-0.00818777  0.05294572 -0.00098583 -0.01511574 -0.01437625]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [4 1 0 3 2] pred: [ 0.01323817  0.01884798 -0.00398892  0.00641932  0.02354197]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [0 4 1 3 2] pred: [ 0.02695991  0.00175413 -0.00213468 -0.00139946  0.01824456]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [4 1 2 0 3] pred: [0.00524278 0.00837986 0.00762472 0.00506134 0.02433661]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 4 0 3] pred: [ 0.00947545  0.03511395  0.01283395 -0.0040101   0.01142773]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 3 2 4 1] pred: [ 0.02800297 -0.0357896   0.00257784  0.00529984  0.00076373]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 4 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:00 - loss: 1.0712 - accuracy: 0.2266 2/15 [===>..........................] - ETA: 0s - loss: 1.0697 - accuracy: 0.2207   3/15 [=====>........................] - ETA: 0s - loss: 1.0690 - accuracy: 0.2140 4/15 [=======>......................] - ETA: 0s - loss: 1.0683 - accuracy: 0.2127 5/15 [=========>....................] - ETA: 0s - loss: 1.0679 - accuracy: 0.2092 6/15 [===========>..................] - ETA: 0s - loss: 1.0677 - accuracy: 0.2067 7/15 [=============>................] - ETA: 0s - loss: 1.0674 - accuracy: 0.2057 8/15 [===============>..............] - ETA: 0s - loss: 1.0672 - accuracy: 0.2048 9/15 [=================>............] - ETA: 0s - loss: 1.0671 - accuracy: 0.204310/15 [===================>..........] - ETA: 0s - loss: 1.0670 - accuracy: 0.204011/15 [=====================>........] - ETA: 0s - loss: 1.0669 - accuracy: 0.204112/15 [=======================>......] - ETA: 0s - loss: 1.0668 - accuracy: 0.203913/15 [=========================>....] - ETA: 0s - loss: 1.0667 - accuracy: 0.203714/15 [===========================>..] - ETA: 0s - loss: 1.0666 - accuracy: 0.204015/15 [==============================] - ETA: 0s - loss: 1.0666 - accuracy: 0.204215/15 [==============================] - 5s 78ms/step - loss: 1.0665 - accuracy: 0.2045
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 3 1 0 2] pred: [-0.0087992   0.01392035 -0.03368751  0.01500959  0.03360572]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [4 3 1 0 2] pred: [-0.02012087 -0.00378341 -0.0287663   0.02023553  0.03731488]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 3 1 0 2] pred: [-0.01920913  0.00287503 -0.02782249  0.00952596  0.0327712 ]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 1 3 0 2] pred: [-0.01036299  0.01865184 -0.01572782  0.01185957  0.0400493 ]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [4 1 3 0 2] pred: [-0.01022877  0.02537012 -0.01935678  0.00833805  0.04686892]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [4 1 3 0 2] pred: [-0.00923884  0.01374376 -0.03580384  0.00485112  0.04609947]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [4 1 3 0 2] pred: [-0.01693633  0.02629922 -0.02400692  0.01094046  0.03694445]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [1 4 2 3 0] pred: [-0.01407045  0.02197448 -0.00219239 -0.01077091  0.02134502]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 1 3 0 2] pred: [-0.01114133 -0.00081616 -0.01966164 -0.00648158  0.03015338]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [4 1 3 2 0] pred: [-0.01987258  0.01253304 -0.01140775 -0.00344019  0.02165078]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [4 3 1 2 0] pred: [-0.01628199  0.00019273 -0.01552797  0.01573509  0.03866548]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [4 1 0 3 2] pred: [ 0.00212056  0.01396369 -0.01658796 -0.00850426  0.03268333]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 1 0 3 2] pred: [ 0.01090256  0.01399007 -0.01255521  0.00026343  0.03374762]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [4 3 1 2 0] pred: [-0.01244841  0.00172837 -0.00026087  0.01189667  0.01796995]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [4 3 1 0 2] pred: [-0.012596    0.0064708  -0.04635861  0.00749165  0.01818324]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 5 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:01 - loss: 1.0405 - accuracy: 0.1875 2/15 [===>..........................] - ETA: 0s - loss: 1.0418 - accuracy: 0.1738   3/15 [=====>........................] - ETA: 0s - loss: 1.0420 - accuracy: 0.1775 4/15 [=======>......................] - ETA: 0s - loss: 1.0424 - accuracy: 0.1825 5/15 [=========>....................] - ETA: 0s - loss: 1.0425 - accuracy: 0.1857 6/15 [===========>..................] - ETA: 0s - loss: 1.0426 - accuracy: 0.1866 7/15 [=============>................] - ETA: 0s - loss: 1.0426 - accuracy: 0.1882 8/15 [===============>..............] - ETA: 0s - loss: 1.0426 - accuracy: 0.1891 9/15 [=================>............] - ETA: 0s - loss: 1.0427 - accuracy: 0.188810/15 [===================>..........] - ETA: 0s - loss: 1.0427 - accuracy: 0.188811/15 [=====================>........] - ETA: 0s - loss: 1.0427 - accuracy: 0.188712/15 [=======================>......] - ETA: 0s - loss: 1.0428 - accuracy: 0.188613/15 [=========================>....] - ETA: 0s - loss: 1.0428 - accuracy: 0.188514/15 [===========================>..] - ETA: 0s - loss: 1.0429 - accuracy: 0.188415/15 [==============================] - ETA: 0s - loss: 1.0430 - accuracy: 0.188415/15 [==============================] - 5s 66ms/step - loss: 1.0431 - accuracy: 0.1884
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 3 1 4] pred: [ 0.00133329 -0.01003127  0.00288663  0.00096024 -0.01238735]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [4 3 0 2 1] pred: [ 0.00123921 -0.01189207 -0.00913696  0.01121189  0.01245198]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [0 2 3 1 4] pred: [ 0.01248095 -0.00339928  0.00421506  0.00223474 -0.02074992]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 3 2 0 1] pred: [-0.01655272 -0.02122697 -0.01526318  0.00699977  0.00768596]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [4 2 3 1 0] pred: [-0.01149123 -0.00469744  0.01059563 -0.00125071  0.02702481]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 3 4 2] pred: [ 0.0249226   0.00984573 -0.00510214  0.00519573  0.00436946]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [-0.00459211 -0.00167687  0.02252695 -0.00635911 -0.01812308]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 3 0 1] pred: [6.9641825e-03 1.1823140e-05 2.7375204e-02 2.0269783e-02 2.5293730e-02]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 1 2 0 4] pred: [-0.00326415  0.00228638  0.00042615  0.01135117 -0.0233933 ]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [3 4 2 1 0] pred: [-0.01463358 -0.00782333  0.0043132   0.02117852  0.00950773]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [2 0 3 1 4] pred: [ 0.00797996 -0.0068967   0.01433605  0.00242971 -0.02493504]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 2 0 1] pred: [-0.01006487 -0.02270245 -0.00869017  0.00272657 -0.0003794 ]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [1 3 2 0 4] pred: [-0.00816517  0.01066421 -0.00236943  0.00839413 -0.02136947]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 2 0 1] pred: [-0.00167827 -0.02085662  0.00722953  0.02439741  0.01196981]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 2 4 1 0] pred: [-0.00780866 -0.00471292  0.02070314  0.03229787 -0.00126154]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 6 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:00 - loss: 1.0869 - accuracy: 0.2422 2/15 [===>..........................] - ETA: 0s - loss: 1.0890 - accuracy: 0.2461   3/15 [=====>........................] - ETA: 0s - loss: 1.0895 - accuracy: 0.2448 4/15 [=======>......................] - ETA: 0s - loss: 1.0898 - accuracy: 0.2393 5/15 [=========>....................] - ETA: 0s - loss: 1.0899 - accuracy: 0.2370 6/15 [===========>..................] - ETA: 0s - loss: 1.0901 - accuracy: 0.2340 7/15 [=============>................] - ETA: 0s - loss: 1.0902 - accuracy: 0.2326 8/15 [===============>..............] - ETA: 0s - loss: 1.0903 - accuracy: 0.2304 9/15 [=================>............] - ETA: 0s - loss: 1.0903 - accuracy: 0.228410/15 [===================>..........] - ETA: 0s - loss: 1.0903 - accuracy: 0.227511/15 [=====================>........] - ETA: 0s - loss: 1.0903 - accuracy: 0.226512/15 [=======================>......] - ETA: 0s - loss: 1.0903 - accuracy: 0.225513/15 [=========================>....] - ETA: 0s - loss: 1.0904 - accuracy: 0.224814/15 [===========================>..] - ETA: 0s - loss: 1.0904 - accuracy: 0.224115/15 [==============================] - 5s 58ms/step - loss: 1.0904 - accuracy: 0.2228
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 0 1 3 2] pred: [-0.00820309 -0.01562168 -0.02468773 -0.02354941  0.0436566 ]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [4 0 3 2 1] pred: [ 0.00136017 -0.05203844 -0.03261255 -0.00101607  0.03488685]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 2 0 3 1] pred: [-0.00020944 -0.03396514  0.00105056 -0.0230921   0.04570487]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [4 3 2 1 0] pred: [-0.03473087 -0.01871405 -0.01527173 -0.00379717  0.01080232]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [4 3 1 2 0] pred: [-0.04535826 -0.01745304 -0.01827431 -0.00711418  0.01324288]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [4 2 3 1 0] pred: [-0.04738606 -0.01745964  0.00421005 -0.00759466  0.02254598]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [4 3 0 1 2] pred: [-0.0022688  -0.01254196 -0.02731774 -0.00087186  0.03234363]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [4 3 0 2 1] pred: [-0.00725794 -0.01506627 -0.00928995  0.0141913   0.02591592]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 2 0 3 1] pred: [-0.00764592 -0.03002386  0.00588252 -0.01960892  0.043636  ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [4 0 2 3 1] pred: [-0.00791011 -0.03916756 -0.00793492 -0.0242059   0.0086071 ]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [4 3 2 0 1] pred: [-0.02246688 -0.02738543 -0.01327847 -0.010305   -0.00671766]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 0 2 1 3] pred: [ 0.00652896 -0.02655629 -0.01588588 -0.03180106  0.02754889]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 2 0 3 1] pred: [-0.01449546 -0.05278983  0.01287038 -0.03579829  0.05022402]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [4 0 2 3 1] pred: [-0.00341137 -0.04054682 -0.01645912 -0.01945419  0.02304743]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [4 3 2 1 0] pred: [-0.05296031 -0.01447506 -0.01180464 -0.00580587  0.01781113]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 7 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 57s - loss: 1.0585 - accuracy: 0.0938 2/15 [===>..........................] - ETA: 0s - loss: 1.0569 - accuracy: 0.1133  3/15 [=====>........................] - ETA: 0s - loss: 1.0560 - accuracy: 0.1259 4/15 [=======>......................] - ETA: 0s - loss: 1.0555 - accuracy: 0.1276 5/15 [=========>....................] - ETA: 0s - loss: 1.0554 - accuracy: 0.1271 6/15 [===========>..................] - ETA: 0s - loss: 1.0553 - accuracy: 0.1265 7/15 [=============>................] - ETA: 0s - loss: 1.0551 - accuracy: 0.1261 8/15 [===============>..............] - ETA: 0s - loss: 1.0550 - accuracy: 0.1260 9/15 [=================>............] - ETA: 0s - loss: 1.0549 - accuracy: 0.127010/15 [===================>..........] - ETA: 0s - loss: 1.0548 - accuracy: 0.127511/15 [=====================>........] - ETA: 0s - loss: 1.0549 - accuracy: 0.127412/15 [=======================>......] - ETA: 0s - loss: 1.0550 - accuracy: 0.127213/15 [=========================>....] - ETA: 0s - loss: 1.0550 - accuracy: 0.127114/15 [===========================>..] - ETA: 0s - loss: 1.0550 - accuracy: 0.127215/15 [==============================] - ETA: 0s - loss: 1.0551 - accuracy: 0.127415/15 [==============================] - 5s 71ms/step - loss: 1.0551 - accuracy: 0.1275
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 2 0 1 4] pred: [-0.00255904 -0.00425097 -0.00113378  0.01759159 -0.01953321]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [3 1 2 4 0] pred: [0.00248069 0.00718565 0.00581663 0.01920889 0.00536009]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 3 2 0 1] pred: [-0.01508707 -0.02888431 -0.00332845  0.00344863  0.00917598]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [3 2 0 1 4] pred: [ 0.00542957 -0.01118297  0.00662371  0.01483086 -0.01243166]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [3 2 0 4 1] pred: [-0.0164272  -0.02788456 -0.01461895  0.00413892 -0.02691466]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [4 3 2 0 1] pred: [-0.0072839  -0.02354215 -0.00538254  0.00230939  0.00539474]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [3 2 1 0 4] pred: [-0.00263725  0.00129302  0.00825468  0.01184971 -0.0032077 ]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [4 2 0 3 1] pred: [-0.0150831  -0.02773948  0.00235213 -0.02446291  0.02519758]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 0 2 4 1] pred: [ 0.00206648 -0.02386666 -0.00380477  0.02490348 -0.00874955]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [3 0 4 1 2] pred: [ 0.01981921 -0.01630347 -0.01643115  0.03908411  0.0058464 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 0 4 2 1] pred: [ 0.01799041 -0.01637861 -0.01364337  0.03979287  0.00060629]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [2 4 3 1 0] pred: [-0.01966747 -0.01413209  0.01827475  0.00562079  0.01598543]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 0 4 3 1] pred: [-0.01373421 -0.03353854  0.0014518  -0.02158339 -0.02148592]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [3 2 4 1 0] pred: [-0.01862033 -0.01501227  0.00349564  0.00768171 -0.00530268]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 2 0 4 1] pred: [-0.00970377 -0.02620286 -0.00514476  0.00383222 -0.01334103]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 8 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 58s - loss: 1.0726 - accuracy: 0.1328 2/15 [===>..........................] - ETA: 0s - loss: 1.0663 - accuracy: 0.1504  3/15 [=====>........................] - ETA: 0s - loss: 1.0629 - accuracy: 0.1619 4/15 [=======>......................] - ETA: 0s - loss: 1.0608 - accuracy: 0.1673 5/15 [=========>....................] - ETA: 0s - loss: 1.0591 - accuracy: 0.1726 6/15 [===========>..................] - ETA: 0s - loss: 1.0578 - accuracy: 0.1766 7/15 [=============>................] - ETA: 0s - loss: 1.0568 - accuracy: 0.1817 8/15 [===============>..............] - ETA: 0s - loss: 1.0559 - accuracy: 0.1867 9/15 [=================>............] - ETA: 0s - loss: 1.0552 - accuracy: 0.191110/15 [===================>..........] - ETA: 0s - loss: 1.0546 - accuracy: 0.194411/15 [=====================>........] - ETA: 0s - loss: 1.0542 - accuracy: 0.197112/15 [=======================>......] - ETA: 0s - loss: 1.0537 - accuracy: 0.199013/15 [=========================>....] - ETA: 0s - loss: 1.0534 - accuracy: 0.200614/15 [===========================>..] - ETA: 0s - loss: 1.0531 - accuracy: 0.201515/15 [==============================] - ETA: 0s - loss: 1.0528 - accuracy: 0.202415/15 [==============================] - 5s 79ms/step - loss: 1.0525 - accuracy: 0.2032
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 3 0 4] pred: [ 0.00132342  0.02137674  0.02011091  0.0062403  -0.00660961]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 3 1 2 4] pred: [ 0.0197005   0.00516571  0.00328323  0.00826166 -0.00236004]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [-0.01229269  0.01164866  0.03234565  0.00853562 -0.0139537 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 3 0 4] pred: [-0.00218943  0.0318532   0.02638438  0.0152257  -0.01509048]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 4 0 1] pred: [-0.0115947  -0.02670131  0.01728169  0.00232365 -0.00696955]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [-0.00720238  0.01359893  0.02878347  0.00021904 -0.00813647]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [3 2 1 0 4] pred: [-0.00342775  0.00936042  0.01704932  0.02132406 -0.01475705]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 3 0 1] pred: [ 0.0099381  -0.02824592  0.02241219  0.01868611  0.0215559 ]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [1 0 3 2 4] pred: [ 0.01773357  0.02031105  0.0092562   0.01157321 -0.00371642]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 0 4 1] pred: [ 0.00381224 -0.00886793  0.01676229  0.01856239  0.00267907]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [2 4 3 0 1] pred: [ 0.01265487 -0.02359883  0.02940727  0.01535763  0.02887826]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [2 0 4 3 1] pred: [ 0.02175974 -0.02870864  0.02987774 -0.00316911  0.0139821 ]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [1 3 2 4 0] pred: [-0.01097315  0.02748287  0.00714687  0.01656022 -0.00927249]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 0 4 1 3] pred: [0.02677409 0.00676199 0.04457331 0.00573591 0.01497738]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 0 4 1] pred: [ 0.00359695 -0.01547203  0.02562542  0.00796086 -0.00899683]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 9 : 
BPIC15.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC15.csv
Categories:
[0 1 2 3 4]
output y_tr
(3657, 154)
(3657, 5)
(1885, 154)
(1885, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
357
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 357)         127449    
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                93120     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 220,874
Trainable params: 220,874
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
 1/15 [=>............................] - ETA: 1:02 - loss: 1.0534 - accuracy: 0.2891 2/15 [===>..........................] - ETA: 0s - loss: 1.0545 - accuracy: 0.2559   3/15 [=====>........................] - ETA: 0s - loss: 1.0571 - accuracy: 0.2470 4/15 [=======>......................] - ETA: 0s - loss: 1.0580 - accuracy: 0.2419 5/15 [=========>....................] - ETA: 0s - loss: 1.0590 - accuracy: 0.2376 6/15 [===========>..................] - ETA: 0s - loss: 1.0595 - accuracy: 0.2362 7/15 [=============>................] - ETA: 0s - loss: 1.0597 - accuracy: 0.2356 8/15 [===============>..............] - ETA: 0s - loss: 1.0597 - accuracy: 0.2353 9/15 [=================>............] - ETA: 0s - loss: 1.0596 - accuracy: 0.235810/15 [===================>..........] - ETA: 0s - loss: 1.0595 - accuracy: 0.236311/15 [=====================>........] - ETA: 0s - loss: 1.0593 - accuracy: 0.236612/15 [=======================>......] - ETA: 0s - loss: 1.0592 - accuracy: 0.236613/15 [=========================>....] - ETA: 0s - loss: 1.0591 - accuracy: 0.236714/15 [===========================>..] - ETA: 0s - loss: 1.0590 - accuracy: 0.236915/15 [==============================] - ETA: 0s - loss: 1.0589 - accuracy: 0.237215/15 [==============================] - 6s 76ms/step - loss: 1.0588 - accuracy: 0.2374
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 1 4 3] pred: [ 0.01886195  0.00654064  0.02004353 -0.00905071 -0.00400877]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 3 2 4 1] pred: [ 0.03054395 -0.0219546   0.00805711  0.02568546 -0.01466963]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 0 4 1] pred: [-0.01656865 -0.04212333  0.03571185  0.03217756 -0.02672918]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 3 1 2 0] pred: [0.0068081  0.01862881 0.01590436 0.03678165 0.05606369]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [0 4 2 3 1] pred: [ 0.01657218 -0.00590562  0.01139071  0.00541746  0.01250581]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [3 0 4 2 1] pred: [ 0.03035451 -0.00776148  0.01395763  0.03490209  0.0239608 ]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 1 0 2] pred: [-0.00359072 -0.00215572 -0.01339653  0.05935363  0.00518171]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [3 2 0 4 1] pred: [ 0.01567257 -0.01642266  0.02723208  0.03812815  0.00155787]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 4 0 2 1] pred: [ 0.00908389 -0.00606995  0.00904927  0.05072498  0.01399747]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [3 0 2 4 1] pred: [ 0.02503109 -0.01830529  0.00955487  0.03236785 -0.00415976]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [3 4 0 2 1] pred: [ 0.00567941 -0.00015479  0.0006477   0.05660528  0.01311323]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 2 1 0] pred: [-0.01633631 -0.00668456  0.01101932  0.0554224   0.04475792]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 2 0 1] pred: [-0.0034668  -0.00376198  0.01252527  0.04690078  0.01560018]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 2 0 1] pred: [ 0.01159771 -0.0133141   0.02770183  0.03086507  0.02898923]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 1 2 0] pred: [-0.02190777  0.00071632 -0.00272991  0.02992689  0.02236597]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Job end at Sat Nov  5 09:58:12 CET 2022
