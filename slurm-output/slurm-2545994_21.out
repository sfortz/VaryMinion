
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompi-2020b
  2) GCC/8.3.0 => GCC/10.2.0
  3) GCCcore/8.3.0 => GCCcore/10.2.0
  4) OpenBLAS/0.3.7-GCC-8.3.0 => OpenBLAS/0.3.12-GCC-10.2.0
  5) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/4.0.5-GCC-10.2.0
  6) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.1.0-gompi-2020b
  7) XZ/5.2.4-GCCcore-8.3.0 => XZ/5.2.5-GCCcore-10.2.0
  8) binutils/2.32-GCCcore-8.3.0 => binutils/2.35-GCCcore-10.2.0
  9) foss/2019b => foss/2020b
 10) gompi/2019b => gompi/2020b
 11) hwloc/1.11.12-GCCcore-8.3.0 => hwloc/2.2.0-GCCcore-10.2.0
 12) libpciaccess/0.14-GCCcore-8.3.0 => libpciaccess/0.16-GCCcore-10.2.0
 13) libxml2/2.9.9-GCCcore-8.3.0 => libxml2/2.9.10-GCCcore-10.2.0
 14) numactl/2.0.12-GCCcore-8.3.0 => numactl/2.0.13-GCCcore-10.2.0
 15) releases/2019b => releases/2020b
 16) zlib/1.2.11-GCCcore-8.3.0 => zlib/1.2.11-GCCcore-10.2.0

Job start at Sat Nov  5 10:16:23 CET 2022
WARNING:tensorflow:From /scratch/2546016/2546016/VaryMinions/scripts/training_NN/training_Model.py:22: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2022-11-05 10:16:27.984843: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-05 10:16:27.985322: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
2022-11-05 10:16:29.827763: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-11-05 10:16:29.828125: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500195000 Hz
Number of possible configurations: 40
Begining exécution of the 21 th configuration: BPIC20.csv with GRU model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and bin_ce as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 90, 58)            3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                16200     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 21s - loss: 2.6796 - accuracy: 0.15623/6 [==============>...............] - ETA: 0s - loss: 2.7243 - accuracy: 0.1523 5/6 [========================>.....] - ETA: 0s - loss: 2.7408 - accuracy: 0.14966/6 [==============================] - 4s 36ms/step - loss: 2.7558 - accuracy: 0.1490
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 1 4 0 2] pred: [-0.010334    0.01532578 -0.01516639  0.02309053  0.00899744]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [3 1 4 0 2] pred: [-0.00954183  0.01386047 -0.01588841  0.02303758  0.00905809]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [3 1 4 2 0] pred: [-0.01206432  0.00928529 -0.00678765  0.02285804  0.00631146]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [3 1 4 0 2] pred: [-0.0112903   0.01808574 -0.01499493  0.02229037  0.01062728]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [3 0 4 1 2] pred: [ 0.02805794  0.02125849 -0.00786852  0.04399672  0.02356889]
 Top predictions indices: [3 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [3 4 0 1 2] pred: [ 0.02134687  0.01627416 -0.01129598  0.03111494  0.02740689]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [1 3 4 2 0] pred: [-0.00764314  0.02026095 -0.00606853  0.0134156  -0.00153369]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [1 3 4 2 0] pred: [-0.01190465  0.01852242 -0.00301249  0.00893798 -0.00078264]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 1 2 4 0] pred: [-6.9936633e-04  2.1245275e-02  2.5444850e-04  2.4749473e-02
 -7.1579590e-05]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [3 1 2 4 0] pred: [-0.00052763  0.02147947  0.00069615  0.02468112  0.00017323]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 1 4 0 2] pred: [ 0.00171601  0.01374534 -0.01279268  0.03221592  0.00930861]
 Top predictions indices: [3 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 11 ============
pred sorted: [1 3 4 0 2] pred: [-0.01294738  0.03184132 -0.01572426  0.01423035  0.00549828]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [1 4 3 2 0] pred: [-0.01242887  0.02580548 -0.00999309  0.00308875  0.00723274]
 Top predictions indices: [1 4] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 13 ============
pred sorted: [1 3 4 0 2] pred: [-0.00741039  0.02535444 -0.00897232  0.00437785  0.00240158]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 1 4 2 0] pred: [-0.01546838  0.01721276 -0.0154617   0.02257898  0.01153964]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 1 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 21s - loss: 1.0504 - accuracy: 0.39843/6 [==============>...............] - ETA: 0s - loss: 1.0571 - accuracy: 0.3793 5/6 [========================>.....] - ETA: 0s - loss: 1.0567 - accuracy: 0.36476/6 [==============================] - 4s 31ms/step - loss: 1.0562 - accuracy: 0.3564
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 3 4 0] pred: [-0.01522848  0.05268472  0.01562767  0.01221647  0.00703047]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [1 4 0 3 2] pred: [ 0.01174926  0.04459291 -0.01719843  0.00224062  0.02850977]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 3 0 4] pred: [ 0.00242101  0.04309001  0.03207793  0.01317044 -0.00989858]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 3 4 0] pred: [-0.01290517  0.04914333  0.01554882  0.00776516  0.00467839]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [1 4 3 2 0] pred: [-0.01060089  0.05163477  0.01078709  0.01265765  0.01304391]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 3 4 0] pred: [-0.01109784  0.03964218  0.02020065  0.00307831 -0.0002265 ]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 3 4 0] pred: [-0.02318826  0.05373643  0.01956214  0.01859402 -0.00640249]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [1 3 2 4 0] pred: [-0.01570999  0.05359521  0.01059664  0.01222926  0.0078744 ]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [1 4 2 3 0] pred: [-0.01382758  0.05946315  0.01013448  0.00675549  0.0143623 ]
 Top predictions indices: [1 4] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 9 ============
pred sorted: [1 4 3 2 0] pred: [-0.00992398  0.05306555  0.00836431  0.01153604  0.01563891]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [1 3 2 4 0] pred: [-0.00941422  0.05038888  0.01284548  0.01334906  0.01200857]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [1 3 2 4 0] pred: [-0.02614993  0.05597403  0.0112135   0.01974098 -0.00917443]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 3 0 4] pred: [ 0.00501737  0.04153616  0.0318512   0.01270484 -0.00946211]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 3 4 0] pred: [-0.00963745  0.04992523  0.01768307  0.01146759  0.00994335]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 3 4 0] pred: [-0.01242048  0.05912231  0.0260264   0.00747807 -0.00037184]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 2 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 3.7121 - accuracy: 0.01563/6 [==============>...............] - ETA: 0s - loss: 3.7521 - accuracy: 0.0135 5/6 [========================>.....] - ETA: 0s - loss: 3.7974 - accuracy: 0.01196/6 [==============================] - 4s 31ms/step - loss: 3.8236 - accuracy: 0.0109
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 2 1 3 0] pred: [-0.06184495 -0.0073744  -0.00628419 -0.05537331  0.00709496]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [4 0 1 2 3] pred: [-0.01133105 -0.0131314  -0.01823098 -0.02633509  0.00515077]
 Top predictions indices: [4 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 1 0 2 3] pred: [-0.01216802 -0.01020018 -0.01961648 -0.02444059 -0.00045444]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 1 0 2 3] pred: [-0.00613421 -0.00590567 -0.01657165 -0.02247153  0.00468763]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [4 0 1 2 3] pred: [-0.00679393 -0.01216177 -0.01785737 -0.04032806  0.00870162]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [4 1 0 2 3] pred: [-0.01228082 -0.00995573 -0.01928681 -0.02414895 -0.00125751]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [4 0 1 2 3] pred: [-0.01062342 -0.01492456 -0.02022525 -0.03598883  0.00462307]
 Top predictions indices: [4 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [4 1 0 2 3] pred: [-0.01359445 -0.00842407 -0.02152096 -0.02989002  0.0073725 ]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 2 1 0 3] pred: [-0.03486459 -0.02476642 -0.00682531 -0.06007768 -0.00073663]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [4 0 1 2 3] pred: [-0.01149957 -0.01601448 -0.01854002 -0.03133933  0.00066694]
 Top predictions indices: [4 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [4 0 1 2 3] pred: [-0.01233334 -0.01563856 -0.01943862 -0.0323818   0.00114569]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 0 1 2 3] pred: [-0.0034767  -0.01391806 -0.01441532 -0.03019499  0.00479851]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 2 1 0 3] pred: [-0.0474133  -0.01996575 -0.01144019 -0.05608388  0.00519844]
 Top predictions indices: [4 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 13 ============
pred sorted: [4 0 1 2 3] pred: [-0.00133027 -0.01275049 -0.01701171 -0.03403637  0.00739631]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [4 1 2 3 0] pred: [-0.0642769  -0.00015335 -0.01062231 -0.05681347  0.00631316]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 3 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 3.7639 - accuracy: 0.03123/6 [==============>...............] - ETA: 0s - loss: 3.7952 - accuracy: 0.0291 5/6 [========================>.....] - ETA: 0s - loss: 3.7944 - accuracy: 0.03036/6 [==============================] - 4s 31ms/step - loss: 3.7972 - accuracy: 0.0313
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 3 4 2 1] pred: [-0.002125   -0.04999639 -0.04928966 -0.02006321 -0.03861885]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 4 3 2 1] pred: [ 0.01064428 -0.06320199 -0.03721556 -0.03032747 -0.02587764]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [0 3 4 2 1] pred: [-0.006714   -0.06559226 -0.04646115 -0.02799972 -0.04218226]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [0 3 4 2 1] pred: [-0.00541221 -0.06161383 -0.04494723 -0.02631504 -0.03898752]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 3 4 2 1] pred: [-0.0076772  -0.06486498 -0.04719967 -0.0283891  -0.04143794]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [0 3 4 2 1] pred: [-0.00956203 -0.06054296 -0.05198574 -0.02884726 -0.04123275]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [0 4 3 1 2] pred: [ 0.01136848 -0.03032293 -0.03914169 -0.00370868  0.00162384]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 4 3 2 1] pred: [ 0.00575413 -0.04264354 -0.04177398 -0.03041024 -0.01546955]
 Top predictions indices: [0 4] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 3 4 1 2] pred: [-0.00784969 -0.05121803 -0.05312838 -0.024986   -0.04070964]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [0 3 4 2 1] pred: [-0.00387923 -0.06206501 -0.0449779  -0.02813323 -0.04114607]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [0 3 4 2 1] pred: [-0.00151081 -0.04924843 -0.0490375  -0.02074326 -0.03816744]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [0 3 4 2 1] pred: [-0.00352998 -0.06181407 -0.04502612 -0.02780504 -0.04101953]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [0 3 4 2 1] pred: [-0.00671212 -0.05296067 -0.05126756 -0.02240067 -0.04053581]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [0 3 4 1 2] pred: [-0.00661334 -0.05196481 -0.0521838  -0.02213304 -0.04052473]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 3 4 2 1] pred: [-0.01351971 -0.06001206 -0.05364354 -0.03005591 -0.04162588]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 4 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 2.3317 - accuracy: 0.37503/6 [==============>...............] - ETA: 0s - loss: 2.3587 - accuracy: 0.4049 5/6 [========================>.....] - ETA: 0s - loss: 2.3929 - accuracy: 0.40876/6 [==============================] - 4s 32ms/step - loss: 2.4104 - accuracy: 0.4141
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 0 1 2 3] pred: [ 0.02482978  0.01427925  0.00051851 -0.01658924  0.04629237]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [0 1 4 3 2] pred: [ 0.05471341  0.02747045 -0.03066729 -0.02751135  0.02156076]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [1 0 3 4 2] pred: [ 0.02411845  0.0392483  -0.00806013  0.01255613  0.00361949]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [1 0 4 3 2] pred: [ 0.01126817  0.03324927 -0.00626692  0.00907068  0.0099359 ]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [1 0 4 3 2] pred: [ 0.03370171  0.04142155 -0.00277928  0.00468     0.01743006]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [1 0 3 4 2] pred: [ 0.02784685  0.0659755  -0.01337344  0.01796344  0.0059986 ]
 Top predictions indices: [1 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 6 ============
pred sorted: [1 0 4 3 2] pred: [ 0.03821025  0.03910483 -0.00733667  0.01093436  0.01739788]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [1 0 3 4 2] pred: [ 0.02401747  0.05827452 -0.01922989  0.01693907 -0.00109324]
 Top predictions indices: [1 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 8 ============
pred sorted: [1 0 4 3 2] pred: [ 2.8451415e-02  3.9802101e-02 -6.9852220e-05  8.3524045e-03
  2.0658899e-02]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [1 0 3 4 2] pred: [ 0.02398256  0.04778172 -0.01106936  0.01715131  0.00113057]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [1 0 4 3 2] pred: [0.02744591 0.0389059  0.0004156  0.00546923 0.02545792]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [1 0 3 4 2] pred: [ 0.02942131  0.06109716 -0.01656654  0.01540387  0.00378622]
 Top predictions indices: [1 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 12 ============
pred sorted: [1 0 4 3 2] pred: [ 0.01767261  0.02926569 -0.00857207  0.00598843  0.01721457]
 Top predictions indices: [1 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 13 ============
pred sorted: [0 1 4 3 2] pred: [ 0.04560483  0.04478113 -0.00513012  0.00509648  0.01534973]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [1 0 3 4 2] pred: [ 0.01105932  0.03110318 -0.0101577   0.00781811  0.00724053]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 5 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 2.5545 - accuracy: 0.18753/6 [==============>...............] - ETA: 0s - loss: 2.5445 - accuracy: 0.1662 5/6 [========================>.....] - ETA: 0s - loss: 2.5377 - accuracy: 0.15656/6 [==============================] - 4s 37ms/step - loss: 2.5346 - accuracy: 0.1498
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 2 0 1 4] pred: [-0.01899464 -0.02810636  0.00533432  0.02442532 -0.03415462]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [3 2 0 4 1] pred: [-0.02051049 -0.03904377  0.01070521  0.01912239 -0.03190235]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [3 2 0 1 4] pred: [-0.01388001 -0.02984822  0.00408109  0.01989404 -0.03098469]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 3 0 1 2] pred: [-0.01068068 -0.04071978 -0.05048087  0.00897636  0.03450599]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [3 0 4 2 1] pred: [ 0.01134057 -0.03891397 -0.02205904  0.04033834  0.01072743]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [3 2 0 1 4] pred: [-0.02232083 -0.02977267  0.01054206  0.02219079 -0.03592167]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [4 3 0 1 2] pred: [-0.02152136 -0.03333242 -0.05913922 -0.00138452  0.02007743]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [3 2 4 1 0] pred: [-0.03732434 -0.02406804 -0.01379748  0.0167751  -0.01654319]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 0 1] pred: [-0.02440836 -0.03827317 -0.0001156   0.03538259 -0.02017283]
 Top predictions indices: [3 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 9 ============
pred sorted: [3 2 0 4 1] pred: [-0.01554605 -0.03404493  0.00407062  0.02345281 -0.02824417]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 2 4 1 0] pred: [-0.03680586 -0.02293385 -0.01333912  0.0194013  -0.01815077]
 Top predictions indices: [3 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 11 ============
pred sorted: [3 2 0 1 4] pred: [-0.01444179 -0.02518332  0.00763577  0.02077669 -0.03461262]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [3 2 0 1 4] pred: [-1.8389890e-02 -2.5745520e-02 -3.7999358e-05  1.8802604e-02
 -2.8233167e-02]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [3 2 0 1 4] pred: [-0.02597537 -0.03182665  0.00410106  0.02729453 -0.03353299]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 2 0 1 4] pred: [-0.01989309 -0.02453733  0.00628838  0.0224041  -0.03177278]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 6 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 2.4765 - accuracy: 0.06253/6 [==============>...............] - ETA: 0s - loss: 2.4209 - accuracy: 0.0629 5/6 [========================>.....] - ETA: 0s - loss: 2.4232 - accuracy: 0.06106/6 [==============================] - 4s 38ms/step - loss: 2.4101 - accuracy: 0.0602
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 3 1 2 4] pred: [0.04395475 0.01041375 0.00399522 0.03022557 0.00070557]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 3 1 2 4] pred: [0.04213484 0.01640141 0.0067953  0.03930442 0.00065942]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [3 0 1 2 4] pred: [ 0.03769712  0.01170807  0.0105975   0.04167945 -0.00653707]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [0 3 1 2 4] pred: [ 0.03970785  0.01244896  0.00020978  0.03062318 -0.00163819]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 3 1 2 4] pred: [ 0.04000531  0.00348257 -0.01136839  0.01085928 -0.01739228]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [0 3 1 4 2] pred: [ 0.0404969   0.00825774 -0.00028431  0.03166102  0.00086073]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [0 3 1 2 4] pred: [ 0.03645822  0.01485848  0.00339864  0.02832222 -0.00610414]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 3 1 2 4] pred: [ 0.0373181   0.00320428  0.00244191  0.03561777 -0.01000403]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 3 1 2 4] pred: [ 0.042686    0.01419233  0.00780031  0.03419039 -0.00265369]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [0 3 1 2 4] pred: [ 0.03844085  0.01640235 -0.00015403  0.03208998 -0.00885306]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [0 3 1 2 4] pred: [ 0.03864623  0.01782741 -0.00069081  0.03485324 -0.00852668]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [0 1 2 3 4] pred: [ 0.02859197 -0.00362159 -0.00782497 -0.01158902 -0.01523178]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [0 3 1 2 4] pred: [ 0.03982039  0.01649788  0.00388592  0.03380457 -0.0076691 ]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [0 3 1 4 2] pred: [ 0.04248175  0.00882347 -0.00440323  0.03331083  0.00141102]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 3 1 2 4] pred: [ 0.03652656  0.01726999  0.00711987  0.03212642 -0.00526517]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 7 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 1.7772 - accuracy: 0.17973/6 [==============>...............] - ETA: 0s - loss: 1.7507 - accuracy: 0.1832 5/6 [========================>.....] - ETA: 0s - loss: 1.7187 - accuracy: 0.17846/6 [==============================] - 4s 32ms/step - loss: 1.7056 - accuracy: 0.1748
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 3 0 4 2] pred: [0.01484891 0.02972464 0.00372608 0.01711457 0.0142896 ]
 Top predictions indices: [1 3] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 1 ============
pred sorted: [4 1 3 0 2] pred: [0.00262572 0.023841   0.00183613 0.01200045 0.05129927]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 3 1 0 2] pred: [0.00314723 0.00707012 0.00097628 0.01505378 0.03647358]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [1 4 0 3 2] pred: [ 0.01421822  0.04038778 -0.00135882  0.01419199  0.02692092]
 Top predictions indices: [1 4] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 4 ============
pred sorted: [4 1 3 0 2] pred: [-0.00392233  0.02930261 -0.00837199  0.0145329   0.03688801]
 Top predictions indices: [4 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 5 ============
pred sorted: [4 1 3 0 2] pred: [0.00564015 0.00797818 0.00467261 0.00778632 0.02997649]
 Top predictions indices: [4 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 6 ============
pred sorted: [0 1 3 4 2] pred: [ 0.02151589  0.01457326 -0.02494871  0.00795251  0.00519934]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [4 3 2 1 0] pred: [0.00409828 0.00607539 0.00831522 0.00939959 0.03680113]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 2 1 3 0] pred: [0.00350152 0.00659882 0.00675252 0.0050316  0.034629  ]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [4 2 3 1 0] pred: [0.00805985 0.00808412 0.01411464 0.0089913  0.03521175]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [1 4 0 3 2] pred: [ 0.01443849  0.04014719 -0.01532177  0.00989206  0.01500567]
 Top predictions indices: [1 4] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 11 ============
pred sorted: [4 1 3 2 0] pred: [0.0037236  0.00699961 0.00460229 0.00653168 0.03323659]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 2 1 0 3] pred: [0.00456022 0.00851086 0.01199099 0.00395781 0.02997561]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [4 1 3 2 0] pred: [-0.00034427  0.03047449  0.00119524  0.01155359  0.03255918]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [4 1 3 0 2] pred: [-0.00397109  0.03351483 -0.00633     0.0127755   0.03355166]
 Top predictions indices: [4 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
Generating classification report
Generating confusion matrix
Exécution 8 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 2.8020 - accuracy: 0.08593/6 [==============>...............] - ETA: 0s - loss: 2.7210 - accuracy: 0.0712 5/6 [========================>.....] - ETA: 0s - loss: 2.7100 - accuracy: 0.06366/6 [==============================] - 4s 31ms/step - loss: 2.6965 - accuracy: 0.0604
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 3 1 4 2] pred: [ 0.054083    0.02974479 -0.02663793  0.03138369 -0.00205207]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 3 1 4 2] pred: [ 4.7630060e-02  2.1719433e-02 -3.3900857e-02  4.6319157e-02
 -5.0760806e-05]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [0 3 1 4 2] pred: [ 0.05792522  0.02893236 -0.03914345  0.03969287  0.00757251]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [0 1 3 4 2] pred: [ 0.05493349  0.03279033 -0.03772694  0.02155113 -0.00185916]
 Top predictions indices: [0 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 4 ============
pred sorted: [0 3 1 4 2] pred: [ 0.04626196  0.02551318 -0.02683845  0.0441311   0.00654495]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 3 4 2] pred: [ 0.0367288   0.01648584 -0.01125353  0.01122395  0.01095806]
 Top predictions indices: [0 1] vs. real classes indices: [3 4]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [0 4 3 1 2] pred: [ 0.06681091  0.0093916  -0.06007461  0.01716779  0.03526822]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [3 0 1 4 2] pred: [ 0.04761102  0.02622156 -0.03548818  0.04935918  0.00375122]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 3 1 4 2] pred: [ 0.04436015  0.03097937 -0.02317785  0.03885034  0.01094638]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [3 0 1 4 2] pred: [ 0.04894425  0.02724562 -0.04051243  0.05549722  0.00200211]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [0 3 1 4 2] pred: [ 0.04811638  0.02443357 -0.02873102  0.04342625  0.00632283]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [3 0 1 4 2] pred: [ 0.04514541  0.02641708 -0.03475371  0.05100205  0.00207076]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [0 3 1 4 2] pred: [ 0.05359672  0.03020189 -0.02736739  0.03438638 -0.0033756 ]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [3 0 1 4 2] pred: [ 0.04909535  0.02746852 -0.04101498  0.05587897  0.00102631]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 3 1 4 2] pred: [ 0.04662798  0.02615287 -0.02791161  0.0449799   0.00597762]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 9 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 1.7104 - accuracy: 0.42193/6 [==============>...............] - ETA: 0s - loss: 1.6793 - accuracy: 0.4423 5/6 [========================>.....] - ETA: 0s - loss: 1.6857 - accuracy: 0.44346/6 [==============================] - 4s 35ms/step - loss: 1.6855 - accuracy: 0.4462
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 4 0] pred: [-0.04382712 -0.00632765  0.03726279  0.01431085 -0.01597816]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 1 ============
pred sorted: [2 3 4 1 0] pred: [-0.04546802 -0.01078361  0.03543079  0.0143349  -0.00833009]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 4 1 0] pred: [-0.05223288 -0.01456843  0.02001901  0.01609921 -0.00719047]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 4 0] pred: [-0.05454892  0.00766296  0.0338175   0.00684206 -0.01374179]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 4 1 0] pred: [-0.06309742 -0.01284594  0.01615377  0.01355388 -0.00566501]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 4 0] pred: [-0.04002388 -0.00443393  0.03616352  0.00846346 -0.00850141]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 4 0] pred: [-0.03819096 -0.00081152  0.03654286  0.00866978 -0.01250415]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 4 0] pred: [-0.02471716 -0.00497683  0.02745195  0.02116128 -0.02109932]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 4 1 0] pred: [-0.04761989 -0.00966658  0.03352113  0.01050903 -0.00413152]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 9 ============
pred sorted: [1 3 2 4 0] pred: [-0.04920332  0.03584741 -0.01334864  0.00482854 -0.0177469 ]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [1 3 2 4 0] pred: [-0.04124055  0.03621594 -0.00274674 -0.00136529 -0.01346487]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 1 4 0] pred: [-3.8142990e-02 -3.7331134e-05  3.8190957e-02  1.0455954e-02
 -1.4757355e-02]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [1 3 2 4 0] pred: [-0.04675632  0.03715162 -0.00510543 -0.0037397  -0.02544821]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 4 0] pred: [-0.04459428 -0.00649908  0.03553436  0.01358633 -0.01512411]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 4 0] pred: [-0.04397441 -0.00485217  0.03647674  0.01312809 -0.01578156]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
Generating classification report
Generating confusion matrix
Job end at Sat Nov  5 10:18:13 CET 2022
