
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompi-2020b
  2) GCC/8.3.0 => GCC/10.2.0
  3) GCCcore/8.3.0 => GCCcore/10.2.0
  4) OpenBLAS/0.3.7-GCC-8.3.0 => OpenBLAS/0.3.12-GCC-10.2.0
  5) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/4.0.5-GCC-10.2.0
  6) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.1.0-gompi-2020b
  7) XZ/5.2.4-GCCcore-8.3.0 => XZ/5.2.5-GCCcore-10.2.0
  8) binutils/2.32-GCCcore-8.3.0 => binutils/2.35-GCCcore-10.2.0
  9) foss/2019b => foss/2020b
 10) gompi/2019b => gompi/2020b
 11) hwloc/1.11.12-GCCcore-8.3.0 => hwloc/2.2.0-GCCcore-10.2.0
 12) libpciaccess/0.14-GCCcore-8.3.0 => libpciaccess/0.16-GCCcore-10.2.0
 13) libxml2/2.9.9-GCCcore-8.3.0 => libxml2/2.9.10-GCCcore-10.2.0
 14) numactl/2.0.12-GCCcore-8.3.0 => numactl/2.0.13-GCCcore-10.2.0
 15) releases/2019b => releases/2020b
 16) zlib/1.2.11-GCCcore-8.3.0 => zlib/1.2.11-GCCcore-10.2.0

Job start at Sat Nov  5 10:18:54 CET 2022
WARNING:tensorflow:From /scratch/2546017/2546017/VaryMinions/scripts/training_NN/training_Model.py:22: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2022-11-05 10:18:58.866482: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-05 10:18:58.866951: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
2022-11-05 10:19:00.705460: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-11-05 10:19:00.705822: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500195000 Hz
Number of possible configurations: 40
Begining exécution of the 22 th configuration: BPIC20.csv with GRU model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and bin_ce-logits as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 90, 58)            3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                16200     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 21s - loss: 0.6948 - accuracy: 0.22662/6 [=========>....................] - ETA: 0s - loss: 0.6948 - accuracy: 0.2324 4/6 [===================>..........] - ETA: 0s - loss: 0.6949 - accuracy: 0.22696/6 [==============================] - ETA: 0s - loss: 0.6950 - accuracy: 0.22636/6 [==============================] - 4s 39ms/step - loss: 0.6950 - accuracy: 0.2258
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 0 4] pred: [ 0.00275171  0.00494218  0.03733632  0.02917913 -0.0084675 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 0 4 1 3] pred: [0.02320052 0.00680146 0.02384647 0.00263293 0.02265489]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 2 ============
pred sorted: [1 2 3 4 0] pred: [-0.01882482  0.02346606  0.01963691  0.01459623  0.00204995]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 2 3 0 1] pred: [0.00848343 0.00462505 0.03160961 0.02076936 0.03495708]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [4 2 1 3 0] pred: [0.00114226 0.01561443 0.02492155 0.00387064 0.04130512]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 4 1 0] pred: [-0.0004708   0.00293364  0.04485515  0.04008296  0.01019474]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [4 2 1 0 3] pred: [0.01160137 0.01245761 0.02488286 0.00838015 0.03202749]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 3 0 1] pred: [0.00961068 0.00116618 0.02890543 0.02034537 0.02863002]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 1 0 4] pred: [-0.0059212  -0.00116993  0.01994265  0.01454733 -0.02122012]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [4 2 0 3 1] pred: [0.01415733 0.0118221  0.02608493 0.0129083  0.03560609]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [4 2 0 3 1] pred: [ 0.02499937 -0.00408103  0.02728553  0.01518684  0.02984661]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 2 3 1 0] pred: [0.00098889 0.01314519 0.02318433 0.0216131  0.02360922]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [1 0 2 3 4] pred: [ 0.00790549  0.02148277 -0.00370561 -0.01225337 -0.03581492]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 4 1 0 3] pred: [ 0.00470836  0.00790525  0.02204457 -0.00325891  0.02203   ]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 14 ============
pred sorted: [4 2 0 3 1] pred: [0.02051914 0.00618846 0.0280237  0.01093949 0.03000691]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 1 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.6912 - accuracy: 0.42973/6 [==============>...............] - ETA: 0s - loss: 0.6912 - accuracy: 0.4115 5/6 [========================>.....] - ETA: 0s - loss: 0.6913 - accuracy: 0.41316/6 [==============================] - 4s 34ms/step - loss: 0.6913 - accuracy: 0.4133
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 4 1 0 3] pred: [-0.0056627  -0.00024516  0.02878338 -0.01897994  0.01208047]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 0 4 1 3] pred: [ 0.01304827 -0.01074564  0.02996401 -0.01210591  0.00084862]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 2 ============
pred sorted: [1 4 2 0 3] pred: [ 0.00285017  0.019811    0.01593882 -0.04024931  0.01854549]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 4 0 3] pred: [-0.00912305  0.01302929  0.02670399 -0.0119857  -0.00067488]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 4 1 0 3] pred: [-0.00269596  0.00213837  0.0325995  -0.01006427  0.00679862]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 0 4 1 3] pred: [ 0.00078682 -0.00613134  0.02492637 -0.01506601 -0.00222467]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 4 1 0 3] pred: [-0.00509583 -0.00083068  0.03044999 -0.01870298  0.01297807]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 4 0 1 3] pred: [ 0.00378315  0.0009428   0.03894319 -0.02754569  0.01306324]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 0 3] pred: [-0.00132067  0.01469656  0.01896968 -0.02914771  0.01324459]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [2 0 4 1 3] pred: [ 0.01237333  0.00182715  0.0360716  -0.01327411  0.00453015]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [ 0.0067734   0.00822092  0.01748392  0.00709356 -0.01711003]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [4 2 1 3 0] pred: [-0.03724914 -0.00843814  0.00434959 -0.00938388  0.0131083 ]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [2 4 0 1 3] pred: [ 0.00599508 -0.00417306  0.03063725 -0.00972461  0.00994742]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 0 4 3 1] pred: [-0.00362141 -0.00777659  0.02737579 -0.00621103 -0.0043711 ]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [2 0 1 3 4] pred: [ 0.00574133 -0.00347118  0.0292821  -0.01371377 -0.01650122]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 2 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.6952 - accuracy: 0.06253/6 [==============>...............] - ETA: 0s - loss: 0.6951 - accuracy: 0.0603 5/6 [========================>.....] - ETA: 0s - loss: 0.6952 - accuracy: 0.05426/6 [==============================] - 4s 39ms/step - loss: 0.6952 - accuracy: 0.0533
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 0 2 1 4] pred: [ 0.00462906 -0.02163818 -0.01309711  0.01281588 -0.04277921]
 Top predictions indices: [3 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 3 2 1 4] pred: [ 0.02769412 -0.01791385  0.01031356  0.02274435 -0.01876447]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [0 3 4 2 1] pred: [ 0.05244951 -0.03208466 -0.03106865 -0.00177781 -0.00801815]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [0 3 2 4 1] pred: [ 0.03860211 -0.00962495 -0.00130084  0.01291574 -0.00919054]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 3 1 4 2] pred: [ 0.02376406 -0.01418695 -0.02609083  0.02222072 -0.0188128 ]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [0 3 2 4 1] pred: [ 0.04110895 -0.01492274 -0.00957565  0.00426696 -0.01044689]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [0 3 4 2 1] pred: [ 0.04120906 -0.02610776 -0.01355619  0.00740864 -0.01099186]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [1 0 4 2 3] pred: [ 0.00461978  0.01437536 -0.01519489 -0.01589168 -0.0025019 ]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [0 2 3 1 4] pred: [ 0.0359424  -0.01973151  0.016452    0.01249598 -0.01984112]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [0 3 2 4 1] pred: [ 0.02705992 -0.01800468 -0.01066075  0.02170285 -0.01541635]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [0 3 4 1 2] pred: [ 0.03429247 -0.0134206  -0.01463893  0.01792783 -0.00949666]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [0 3 4 2 1] pred: [ 0.04527937 -0.01278806 -0.01220787  0.00844004 -0.00658073]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [3 0 2 4 1] pred: [-0.00839386 -0.02544808 -0.01257958  0.03717072 -0.01608639]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [0 3 2 1 4] pred: [ 0.02611004 -0.01238371 -0.01003249  0.02166087 -0.01338841]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 0 2 4 1] pred: [-0.00924928 -0.02527994 -0.01370449  0.03673422 -0.01635565]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 3 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.6890 - accuracy: 0.30473/6 [==============>...............] - ETA: 0s - loss: 0.6889 - accuracy: 0.2878 5/6 [========================>.....] - ETA: 0s - loss: 0.6889 - accuracy: 0.28416/6 [==============================] - 4s 38ms/step - loss: 0.6889 - accuracy: 0.2811
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 3 0 4] pred: [-0.01352051  0.00419302 -0.00086995 -0.01232356 -0.03701768]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [-0.02011801  0.00254882  0.00384876 -0.00239217 -0.04298535]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 3 0 4] pred: [-0.01074296  0.00610241  0.00290245 -0.00981444 -0.03942937]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 4 3] pred: [-0.00782377  0.00560222  0.00567178 -0.01762586 -0.01506683]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 3 0 4] pred: [-0.01422156  0.0047429   0.00359109 -0.00211997 -0.0330251 ]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [0 1 2 3 4] pred: [-0.01018774 -0.01094359 -0.01317672 -0.01916177 -0.03402216]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [3 0 1 2 4] pred: [-0.00327126 -0.02115066 -0.02683421  0.00489064 -0.03380533]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 3 0 4] pred: [-0.01596255  0.00990745 -0.00104856 -0.01230487 -0.04323515]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 3 0 4] pred: [-0.01442809  0.00596566 -0.00022423 -0.01145348 -0.04547204]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [4 2 3 0 1] pred: [-0.01369105 -0.0188373   0.00457485 -0.00267233  0.00599753]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [0 1 2 3 4] pred: [ 0.00107166 -0.00486123 -0.01107563 -0.01656241 -0.03254708]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 4 0 1] pred: [-0.03144396 -0.03663607  0.0053803  -0.00495048 -0.00768595]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 4 1 0] pred: [-0.02874242 -0.02262105  0.01768454 -0.01256641 -0.0129725 ]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 0 4] pred: [-0.01164873 -0.0041108   0.02986297  0.00490177 -0.01734537]
 Top predictions indices: [2 3] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [-0.0054715   0.00409171  0.00151863 -0.01448704 -0.04703559]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 4 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 21s - loss: 0.6963 - accuracy: 0.34383/6 [==============>...............] - ETA: 0s - loss: 0.6963 - accuracy: 0.3459 5/6 [========================>.....] - ETA: 0s - loss: 0.6963 - accuracy: 0.33906/6 [==============================] - 4s 35ms/step - loss: 0.6964 - accuracy: 0.3352
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 0 2 4 3] pred: [ 0.03483685  0.04886458  0.02038518 -0.02460543 -0.00847384]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [1 4 0 3 2] pred: [ 0.00112075  0.02832108 -0.05387966 -0.03151303  0.00997316]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [3 1 0 4 2] pred: [ 0.00061818  0.02163213 -0.0182702   0.0243815  -0.01331557]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [1 0 4 3 2] pred: [ 0.01932866  0.04011967 -0.03521897 -0.02124344 -0.00242838]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [1 4 0 2 3] pred: [-0.00545767  0.04584783 -0.01415058 -0.02469891 -0.00446397]
 Top predictions indices: [1 4] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 5 ============
pred sorted: [1 0 4 3 2] pred: [ 0.02628629  0.04047286 -0.04431259 -0.02240329 -0.01199865]
 Top predictions indices: [1 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 6 ============
pred sorted: [1 4 3 2 0] pred: [-0.05783995  0.02692543 -0.0307251  -0.00967992  0.02444669]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [1 0 2 4 3] pred: [ 0.02527924  0.04574242  0.01868932 -0.02930387 -0.01253627]
 Top predictions indices: [1 0] vs. real classes indices: [3 4]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [1 0 4 3 2] pred: [ 0.00917984  0.03115302 -0.0713786  -0.00866685  0.00108588]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [0 1 2 3 4] pred: [ 0.02588512  0.0214986   0.01784775  0.01408157 -0.03723732]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [1 0 4 3 2] pred: [ 0.0150113   0.03757914 -0.04236411 -0.02006108  0.00757917]
 Top predictions indices: [1 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 11 ============
pred sorted: [1 3 0 4 2] pred: [-0.00458349  0.03319399 -0.0199044   0.0211491  -0.01844433]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [1 4 3 0 2] pred: [-0.00370841  0.02481483 -0.0724813   0.00973981  0.01918119]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [1 4 0 3 2] pred: [ 0.00429417  0.02908403 -0.08039872  0.00087193  0.01055077]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [1 4 3 0 2] pred: [-0.0186188   0.04623219 -0.03767253 -0.00299908  0.01340809]
 Top predictions indices: [1 4] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
Generating classification report
Generating confusion matrix
Exécution 5 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.6935 - accuracy: 0.31253/6 [==============>...............] - ETA: 0s - loss: 0.6937 - accuracy: 0.3060 5/6 [========================>.....] - ETA: 0s - loss: 0.6938 - accuracy: 0.30566/6 [==============================] - 4s 34ms/step - loss: 0.6938 - accuracy: 0.3061
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 3 4 1] pred: [ 0.0381677  -0.05532233  0.04918149  0.02887929 -0.01442836]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 1 ============
pred sorted: [2 4 0 3 1] pred: [ 0.01862113 -0.0628756   0.02482297  0.00124083  0.01926795]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 0 4 3 1] pred: [ 0.02625544 -0.06882142  0.02836016 -0.00110828  0.01698017]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [0 3 2 4 1] pred: [ 0.02378003 -0.05169764  0.01454494  0.02247878 -0.02014466]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [4 2 0 3 1] pred: [-0.00019563 -0.03338329  0.01191462 -0.02252052  0.03093694]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [2 0 4 3 1] pred: [ 0.01589039 -0.05941775  0.03451258 -0.00367186  0.0156723 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 0 4 1] pred: [ 0.02442227 -0.03485819  0.03502243  0.02765293  0.00927389]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 0 4 3 1] pred: [ 0.01908334 -0.06578077  0.0263567  -0.00035889  0.01136366]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 8 ============
pred sorted: [2 0 4 3 1] pred: [ 0.02579475 -0.07099672  0.02633548  0.0054701   0.0130331 ]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [2 0 3 4 1] pred: [ 0.03743964 -0.05344289  0.05191858  0.02049133 -0.01493792]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 4 0 3 1] pred: [ 0.01496755 -0.06864358  0.03218598  0.00444046  0.03169146]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 11 ============
pred sorted: [4 2 3 0 1] pred: [ 0.00465706 -0.04162198  0.02361455  0.00559568  0.02544031]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [2 0 3 4 1] pred: [ 0.03240824 -0.02049643  0.06819977  0.01208551 -0.0003953 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 0 4 3 1] pred: [ 0.03118826 -0.01949384  0.07632029 -0.00192285  0.00467701]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 0 4 1] pred: [ 0.01046714 -0.03594939  0.06011195  0.03648966 -0.00838416]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 6 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 21s - loss: 0.6918 - accuracy: 0.07033/6 [==============>...............] - ETA: 0s - loss: 0.6918 - accuracy: 0.0677 5/6 [========================>.....] - ETA: 0s - loss: 0.6918 - accuracy: 0.07096/6 [==============================] - 4s 27ms/step - loss: 0.6918 - accuracy: 0.0713
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 1 2 4 3] pred: [ 0.0511912   0.01567434  0.00594096 -0.01436459 -0.00292965]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 2 1 4 3] pred: [ 0.03425235 -0.0146824  -0.01122641 -0.02948277 -0.0154639 ]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [0 2 4 3 1] pred: [ 0.00107738 -0.02268851 -0.0196997  -0.02266224 -0.02232275]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 3 ============
pred sorted: [0 2 4 1 3] pred: [ 0.03281524 -0.01389764 -0.00477148 -0.03749364 -0.01120641]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 2 1 3 4] pred: [ 0.03564952 -0.02588443 -0.00739206 -0.02775564 -0.03080056]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [4 2 3 1 0] pred: [-0.0289115  -0.0095234   0.01637775 -0.00112637  0.0251995 ]
 Top predictions indices: [4 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 6 ============
pred sorted: [0 2 3 1 4] pred: [ 0.0312612  -0.02621354 -0.01423125 -0.0261824  -0.03384395]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 7 ============
pred sorted: [0 2 3 1 4] pred: [ 0.03137544 -0.02771069 -0.01058537 -0.02382316 -0.03469416]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 2 4 1 3] pred: [ 0.03153866 -0.03070679 -0.00858857 -0.03143319 -0.02313469]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 9 ============
pred sorted: [0 4 2 1 3] pred: [ 0.03465259 -0.02343221 -0.01638299 -0.03215935 -0.01569013]
 Top predictions indices: [0 4] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [0 2 3 4 1] pred: [ 0.03954442 -0.02720701 -0.00713936 -0.01984205 -0.02451337]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 11 ============
pred sorted: [0 2 4 3 1] pred: [ 0.01097175 -0.02265846 -0.01125237 -0.01584578 -0.01219138]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 12 ============
pred sorted: [0 4 2 1 3] pred: [ 0.01729648 -0.01972874 -0.01452321 -0.02827486 -0.00464209]
 Top predictions indices: [0 4] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [0 2 4 1 3] pred: [ 0.03100771 -0.02193196 -0.01027123 -0.03338144 -0.02119633]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 2 1 3 4] pred: [ 0.03167064 -0.02568001 -0.01085293 -0.0271746  -0.03354745]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 7 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 21s - loss: 0.6890 - accuracy: 0.21883/6 [==============>...............] - ETA: 0s - loss: 0.6890 - accuracy: 0.2270 5/6 [========================>.....] - ETA: 0s - loss: 0.6890 - accuracy: 0.22466/6 [==============================] - 4s 30ms/step - loss: 0.6890 - accuracy: 0.2191
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 3 1 4] pred: [ 0.010769   -0.01114793  0.01188087 -0.01110027 -0.02991333]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [0 2 3 1 4] pred: [ 0.01925893 -0.00653228  0.01604451 -0.00337033 -0.02463384]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [0 2 3 1 4] pred: [ 0.02773529 -0.02106933  0.01104615 -0.01060423 -0.03709223]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [2 0 3 1 4] pred: [ 0.02357046 -0.01252755  0.02630142 -0.01046422 -0.03424656]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 0 4] pred: [-0.0218568  -0.02054807  0.02396455 -0.00917965 -0.02558584]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [2 0 1 3 4] pred: [ 0.01386132 -0.02064591  0.03225775 -0.02194214 -0.05648878]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [0 2 1 4 3] pred: [ 0.02245164 -0.00199568  0.01487212 -0.04463299 -0.02785986]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 2 1 3 4] pred: [ 0.02449414 -0.01520637  0.02266798 -0.01635853 -0.03865566]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 2 1 3 4] pred: [ 0.02628483  0.01604504  0.02417132 -0.01861882 -0.03955908]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 9 ============
pred sorted: [0 2 1 3 4] pred: [ 0.02313461 -0.01138002  0.01680079 -0.01841239 -0.0349149 ]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [2 0 1 4 3] pred: [ 0.00947656 -0.0164523   0.01720489 -0.03360574 -0.02825039]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 0 1 3 4] pred: [ 0.01900653 -0.01870941  0.02005502 -0.02190322 -0.03478282]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 0 1 3 4] pred: [ 0.00677348 -0.00113418  0.01130721 -0.00771374 -0.01920122]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [0 1 2 4 3] pred: [ 0.03177526  0.02213704  0.01429181 -0.03217237 -0.02979948]
 Top predictions indices: [0 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 14 ============
pred sorted: [2 0 1 3 4] pred: [ 0.02384364 -0.00953359  0.0283994  -0.01287095 -0.03467211]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
Generating classification report
Generating confusion matrix
Exécution 8 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.6906 - accuracy: 0.42973/6 [==============>...............] - ETA: 0s - loss: 0.6905 - accuracy: 0.4466 5/6 [========================>.....] - ETA: 0s - loss: 0.6905 - accuracy: 0.44236/6 [==============================] - 4s 34ms/step - loss: 0.6905 - accuracy: 0.4365
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 4 3] pred: [-0.00930141  0.03002833  0.02868506 -0.01339242 -0.01011177]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 4 3] pred: [-0.00041513  0.03215857  0.02637438 -0.02102689 -0.01135238]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [2 3 1 0 4] pred: [-0.01205224 -0.00618585  0.02820907  0.0043514  -0.03080102]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 4 0 3] pred: [-0.01383718  0.02810034  0.02875139 -0.01570999 -0.00339086]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 0 1 3 4] pred: [ 0.00622364  0.00570864  0.02019661  0.00379915 -0.00854387]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [3 2 4 0 1] pred: [-0.02040954 -0.02078309 -0.0091914   0.01127407 -0.01917673]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 4 3] pred: [ 0.00476729  0.02444939  0.0426476  -0.01143173  0.00029287]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 4 3] pred: [ 0.01033525  0.04383558  0.02463812 -0.01865304 -0.01766304]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 0 3] pred: [-0.00894602  0.0254467   0.03903171 -0.02270344  0.00127344]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [3 1 0 4 2] pred: [ 0.00551961  0.01096713 -0.03670551  0.03156813  0.0021236 ]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 4 3] pred: [-0.00159782  0.04029156  0.03121993 -0.02365608 -0.01813379]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 3 0] pred: [-0.01685057  0.02280373  0.03114965 -0.01507006 -0.00481058]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [0 2 3 1 4] pred: [ 0.02378701 -0.00043334  0.01015912  0.00420463 -0.02445675]
 Top predictions indices: [0] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 0 3] pred: [-0.01133793  0.03175887  0.03791303 -0.0193272  -0.00421679]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [ 0.00165542  0.0049136   0.02160429  0.00343317 -0.0086376 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 9 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.6930 - accuracy: 0.09383/6 [==============>...............] - ETA: 0s - loss: 0.6934 - accuracy: 0.0751 6/6 [==============================] - ETA: 0s - loss: 0.6934 - accuracy: 0.07206/6 [==============================] - 4s 23ms/step - loss: 0.6934 - accuracy: 0.0717
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [4 2 0 3 1] pred: [ 0.01521689 -0.11274678  0.02376492 -0.01563823  0.02830518]
 Top predictions indices: [4 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 1 ============
pred sorted: [0 4 2 3 1] pred: [ 0.01953773 -0.10116985  0.00807064 -0.0001776   0.01397933]
 Top predictions indices: [0 4] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 0 2 3 1] pred: [ 0.01675912 -0.10382404  0.01332964 -0.00056983  0.01826897]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [0 4 2 3 1] pred: [ 0.01584395 -0.07188995  0.00408727  0.00186684  0.01370567]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 4 2 3 1] pred: [ 0.01984015 -0.10360415  0.00731484 -0.00259978  0.01637945]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [2 4 0 3 1] pred: [ 0.00385204 -0.06831487  0.02373154 -0.01730006  0.02240931]
 Top predictions indices: [2 4] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 6 ============
pred sorted: [4 0 2 3 1] pred: [ 0.01389634 -0.07114457  0.01135028  0.00615604  0.01396086]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 2 3 4 1] pred: [ 0.01767719 -0.05614081  0.0103086   0.00348411 -0.01089118]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 2 0 3 1] pred: [-0.01100938 -0.05162371  0.02274428 -0.03456757  0.02730715]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [4 0 2 3 1] pred: [ 0.01529779 -0.10512158  0.01269698 -0.00274628  0.01939629]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [4 2 0 3 1] pred: [ 0.01431605 -0.08502565  0.01603983 -0.01204847  0.0188815 ]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 2 0 3 1] pred: [ 0.00664604 -0.05906155  0.01098673 -0.00275774  0.02634398]
 Top predictions indices: [4 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 12 ============
pred sorted: [0 4 2 3 1] pred: [ 0.02106679 -0.10130633  0.00779597 -0.00248693  0.01743106]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [0 4 2 3 1] pred: [ 0.0130116  -0.07468234  0.00922884  0.00303111  0.01258697]
 Top predictions indices: [0 4] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [4 2 0 3 1] pred: [ 0.00991273 -0.08779565  0.02369277 -0.01040465  0.02596848]
 Top predictions indices: [4 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
Generating classification report
Generating confusion matrix
Job end at Sat Nov  5 10:20:42 CET 2022
