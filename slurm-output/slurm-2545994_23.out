
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompi-2020b
  2) GCC/8.3.0 => GCC/10.2.0
  3) GCCcore/8.3.0 => GCCcore/10.2.0
  4) OpenBLAS/0.3.7-GCC-8.3.0 => OpenBLAS/0.3.12-GCC-10.2.0
  5) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/4.0.5-GCC-10.2.0
  6) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.1.0-gompi-2020b
  7) XZ/5.2.4-GCCcore-8.3.0 => XZ/5.2.5-GCCcore-10.2.0
  8) binutils/2.32-GCCcore-8.3.0 => binutils/2.35-GCCcore-10.2.0
  9) foss/2019b => foss/2020b
 10) gompi/2019b => gompi/2020b
 11) hwloc/1.11.12-GCCcore-8.3.0 => hwloc/2.2.0-GCCcore-10.2.0
 12) libpciaccess/0.14-GCCcore-8.3.0 => libpciaccess/0.16-GCCcore-10.2.0
 13) libxml2/2.9.9-GCCcore-8.3.0 => libxml2/2.9.10-GCCcore-10.2.0
 14) numactl/2.0.12-GCCcore-8.3.0 => numactl/2.0.13-GCCcore-10.2.0
 15) releases/2019b => releases/2020b
 16) zlib/1.2.11-GCCcore-8.3.0 => zlib/1.2.11-GCCcore-10.2.0

Job start at Sat Nov  5 10:21:29 CET 2022
WARNING:tensorflow:From /scratch/2546018/2546018/VaryMinions/scripts/training_NN/training_Model.py:22: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2022-11-05 10:21:33.892207: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-05 10:21:33.892678: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
2022-11-05 10:21:35.743871: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-11-05 10:21:35.744231: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500195000 Hz
Number of possible configurations: 40
Begining exécution of the 23 th configuration: BPIC20.csv with GRU model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and mse as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 90, 58)            3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                16200     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 21s - loss: 0.2569 - accuracy: 0.09383/6 [==============>...............] - ETA: 0s - loss: 0.2588 - accuracy: 0.1241 5/6 [========================>.....] - ETA: 0s - loss: 0.2586 - accuracy: 0.12996/6 [==============================] - 4s 33ms/step - loss: 0.2585 - accuracy: 0.1317
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 1 4 0 2] pred: [-0.0210832   0.00514262 -0.03241138  0.00597092  0.00165615]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [4 3 1 2 0] pred: [-0.02700316  0.00189692 -0.02487776  0.00673725  0.00919162]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [3 1 4 0 2] pred: [ 0.00025328  0.02930442 -0.02835516  0.03704436  0.0135598 ]
 Top predictions indices: [3 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 3 ============
pred sorted: [3 4 1 2 0] pred: [-0.0409381  -0.00058628 -0.02591402  0.01082651  0.00871284]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [1 4 3 0 2] pred: [-0.01597936  0.00192157 -0.02036563 -0.00928987  0.00104989]
 Top predictions indices: [1 4] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 5 ============
pred sorted: [3 1 4 0 2] pred: [-0.00658358  0.02594518 -0.03467773  0.02968168  0.00105682]
 Top predictions indices: [3 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 6 ============
pred sorted: [4 3 1 2 0] pred: [-0.03640835 -0.00320657 -0.01217543  0.0036647   0.00913874]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 1 0 2] pred: [-0.00878823  0.01186659 -0.02193198  0.04332292  0.03390012]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [1 3 4 2 0] pred: [-0.02763297  0.01494639 -0.0181412   0.01169885  0.00620218]
 Top predictions indices: [1 3] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 9 ============
pred sorted: [4 3 1 2 0] pred: [-0.03422698 -0.00215161 -0.01904081  0.00031831  0.00885728]
 Top predictions indices: [4 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 4 1 2 0] pred: [-0.03143559 -0.00245253 -0.01258645  0.00306418  0.00010612]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 1 3 0 2] pred: [-0.0216884  -0.00762306 -0.02230812 -0.01612179  0.00102691]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 3 1 2 0] pred: [-0.02564301  0.0017455  -0.02368307  0.00569369  0.0094501 ]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [1 3 4 2 0] pred: [-0.03253387  0.01493345 -0.01939459  0.00814201  0.00382899]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 4 3 0] pred: [-0.04168544  0.02074754  0.00489127 -0.018395    0.00178538]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 1 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.2532 - accuracy: 0.34383/6 [==============>...............] - ETA: 0s - loss: 0.2527 - accuracy: 0.3611 5/6 [========================>.....] - ETA: 0s - loss: 0.2533 - accuracy: 0.36486/6 [==============================] - 4s 30ms/step - loss: 0.2538 - accuracy: 0.3670
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 0 2 4 3] pred: [ 0.00925146  0.010127    0.00910126 -0.03950182 -0.01333955]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [-0.01603152 -0.0156223   0.01122522 -0.01573966 -0.03220376]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [2 0 4 1 3] pred: [-0.01012311 -0.0288102  -0.00348095 -0.02975205 -0.01269584]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 3 ============
pred sorted: [2 0 4 1 3] pred: [-1.1136712e-02 -3.6946885e-02 -5.1502138e-05 -4.7204673e-02
 -1.4797542e-02]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 3 0 4] pred: [-0.00276504  0.03418643  0.00749698 -0.00062047 -0.00299394]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [4 2 0 1 3] pred: [-0.01124712 -0.03407998  0.00378609 -0.03788291  0.00869331]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [-0.00218288  0.01328939  0.0416193  -0.01290261 -0.01491494]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 0 4 1 3] pred: [-0.00933412 -0.04611706  0.00111465 -0.05201539 -0.01123688]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [4 0 2 1 3] pred: [-0.01203132 -0.03538905 -0.01383357 -0.04428212  0.0045031 ]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [2 0 4 1 3] pred: [-0.01264761 -0.03340265 -0.00261864 -0.04554133 -0.01402834]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 0 3 1 4] pred: [-0.01585141 -0.02130731  0.02592533 -0.01811036 -0.03544024]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [4 2 1 3 0] pred: [-0.0115937  -0.00070079  0.00361783 -0.01089249  0.01837685]
 Top predictions indices: [4 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 12 ============
pred sorted: [2 0 4 1 3] pred: [-0.00807251 -0.03965274  0.00542918 -0.04249661 -0.01689761]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [0 2 4 3 1] pred: [-0.00027959 -0.04094877 -0.0036187  -0.02818108 -0.00906763]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 14 ============
pred sorted: [2 0 3 1 4] pred: [-0.01650305 -0.02417351  0.01452682 -0.02214308 -0.03243291]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
Generating classification report
Generating confusion matrix
Exécution 2 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 19s - loss: 0.2601 - accuracy: 0.15623/6 [==============>...............] - ETA: 0s - loss: 0.2591 - accuracy: 0.1250 5/6 [========================>.....] - ETA: 0s - loss: 0.2581 - accuracy: 0.11396/6 [==============================] - 4s 29ms/step - loss: 0.2577 - accuracy: 0.1101
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 4 2 3 1] pred: [ 0.0225803  -0.04401232 -0.00648945 -0.03364442 -0.00452383]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [0 4 1 3 2] pred: [ 0.03022927 -0.00242601 -0.01259973 -0.00714381  0.01209328]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 2 1 3 0] pred: [-0.02462865 -0.02184787 -0.02141931 -0.02349056  0.03333304]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 3 4 0] pred: [-0.00886165  0.03862881  0.02894194  0.00336613  0.00079001]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [4 1 3 2 0] pred: [-0.02162916 -0.00112235 -0.01882561 -0.00171618  0.03828837]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [4 2 0 3 1] pred: [-0.01204858 -0.0177156  -0.00685264 -0.01675385  0.0271077 ]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [0 4 3 2 1] pred: [ 0.00841418 -0.01374791 -0.00795101 -0.00297849  0.00798003]
 Top predictions indices: [0 4] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [0 1 2 3 4] pred: [0.03176097 0.0112401  0.00580455 0.00492645 0.00076925]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 3 1 0 2] pred: [-0.00803615 -0.00568095 -0.01379398 -0.00124629  0.02610298]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [4 0 1 3 2] pred: [-0.00029428 -0.00089389 -0.01163175 -0.00113065  0.02365166]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [0 3 1 2 4] pred: [ 0.02244753 -0.01180207 -0.01256451  0.00044834 -0.02371056]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 0 3 2 1] pred: [-0.00056311 -0.02202439 -0.01101412 -0.00932204  0.02153759]
 Top predictions indices: [4 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [4 3 0 1 2] pred: [ 0.00082188 -0.00677055 -0.00970994  0.0013129   0.01612007]
 Top predictions indices: [4 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [4 0 3 2 1] pred: [ 0.00547275 -0.01190515 -0.00898288 -0.0013927   0.01047325]
 Top predictions indices: [4 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 2 3 1 4] pred: [ 0.01660202 -0.02693075  0.00240424 -0.02491393 -0.06478503]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 3 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.2503 - accuracy: 0.09383/6 [==============>...............] - ETA: 0s - loss: 0.2517 - accuracy: 0.1141 5/6 [========================>.....] - ETA: 0s - loss: 0.2514 - accuracy: 0.11446/6 [==============================] - 4s 35ms/step - loss: 0.2516 - accuracy: 0.1133
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 0 2 4 1] pred: [-0.00582112 -0.04948902 -0.00764657  0.01119149 -0.02494195]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [0 2 4 1 3] pred: [ 0.02468647 -0.02030914  0.01297256 -0.02703945 -0.00280913]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 2 ============
pred sorted: [0 2 4 1 3] pred: [ 0.01837705 -0.01732551  0.01254072 -0.01865769 -0.00455091]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [0 2 4 1 3] pred: [ 0.01889411 -0.02091694  0.00474489 -0.02625298  0.00445702]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 2 4 1 3] pred: [ 0.0196061  -0.0212202   0.00311991 -0.02489388  0.00227551]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [3 2 4 0 1] pred: [-0.0069601  -0.04261006  0.00967919  0.01250791  0.00068606]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [0 2 4 1 3] pred: [ 0.0276241  -0.02145241  0.01152035 -0.02602357 -0.00100824]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 7 ============
pred sorted: [0 2 4 1 3] pred: [ 0.01839293 -0.01705743  0.01276835 -0.01852451 -0.0044438 ]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 2 4 1 3] pred: [ 0.01740585 -0.01860069  0.00846782 -0.02821496  0.00541922]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 9 ============
pred sorted: [0 4 3 1 2] pred: [ 0.0163959  -0.00603423 -0.00614616  0.00419939  0.01025116]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [0 2 4 1 3] pred: [ 0.01531955 -0.02078562  0.00511204 -0.02714772  0.0041943 ]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 11 ============
pred sorted: [0 2 4 1 3] pred: [ 0.0145498  -0.01936031  0.01352094 -0.02735173  0.00583728]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [0 2 4 3 1] pred: [ 0.03059828 -0.02790043  0.01273278 -0.01752572 -0.00377304]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [0 2 4 1 3] pred: [ 0.01848366 -0.01934629  0.0096021  -0.02657094  0.00306239]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 2 4 3 1] pred: [ 0.02261732 -0.02356287  0.00626996 -0.01811683 -0.01239593]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 4 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.2565 - accuracy: 0.08593/6 [==============>...............] - ETA: 0s - loss: 0.2519 - accuracy: 0.1133 5/6 [========================>.....] - ETA: 0s - loss: 0.2490 - accuracy: 0.12276/6 [==============================] - 4s 33ms/step - loss: 0.2477 - accuracy: 0.1285
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 2 1 3 4] pred: [ 0.02852317  0.01032796  0.02120316  0.00846017 -0.01988834]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 2 3 1 4] pred: [ 0.03263388  0.00952045  0.02662055  0.01222803 -0.01192379]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 2 ============
pred sorted: [2 1 4 3 0] pred: [-0.00771694  0.01946373  0.04043842  0.0006922   0.00115139]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [0 3 2 1 4] pred: [ 0.02698504  0.00896569  0.01223808  0.01991311 -0.01452902]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [1 0 3 4 2] pred: [0.02105773 0.02710831 0.00545851 0.01159122 0.00684229]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [0 2 3 1 4] pred: [ 0.03739583  0.01068031  0.02813927  0.01085678 -0.01366294]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [2 0 3 1 4] pred: [ 0.0273558   0.01323404  0.0329596   0.01754544 -0.00996044]
 Top predictions indices: [2 0] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 7 ============
pred sorted: [0 3 1 2 4] pred: [ 0.02609102  0.00236273 -0.00022442  0.01117463 -0.00903066]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 2 3 1 4] pred: [ 0.03444578  0.00926481  0.02707562  0.01590876 -0.01660739]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [0 2 3 1 4] pred: [ 0.03494132  0.00840863  0.02528619  0.01853977 -0.01369887]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 0 2 1 4] pred: [ 0.03038945  0.002471    0.01675801  0.03264779 -0.00751368]
 Top predictions indices: [3 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [0 2 3 1 4] pred: [ 0.03573176  0.00597882  0.0346746   0.01826688 -0.01070068]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [0 2 3 1 4] pred: [ 0.03361045  0.00684397  0.01238524  0.01237535 -0.01746294]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [4 1 2 3 0] pred: [-0.03467256  0.02206025  0.00443776 -0.01416923  0.02321828]
 Top predictions indices: [4] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 0 2 1 4] pred: [ 0.02300657  0.00257149  0.01470503  0.02746913 -0.00020344]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 5 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.2545 - accuracy: 0.04693/6 [==============>...............] - ETA: 0s - loss: 0.2539 - accuracy: 0.0660 5/6 [========================>.....] - ETA: 0s - loss: 0.2543 - accuracy: 0.06676/6 [==============================] - 4s 32ms/step - loss: 0.2541 - accuracy: 0.0691
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 4 2 0 3] pred: [-0.02403601  0.00631136 -0.01267437 -0.03471144  0.00127806]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 2 3 1 4] pred: [ 0.02619276  0.00268465  0.00437122  0.00334509 -0.02566292]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 1 2 3 0] pred: [-0.03833436 -0.0155437  -0.02778307 -0.03593663 -0.00308581]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 3 0 1 2] pred: [-0.02369987 -0.02395298 -0.07225461 -0.02025615  0.02561986]
 Top predictions indices: [4] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 3 2 1 4] pred: [ 0.02125924 -0.01685458 -0.0041376   0.00015394 -0.02267368]
 Top predictions indices: [0 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [0 2 3 1 4] pred: [ 0.0255302  -0.0006857   0.00448132  0.00343001 -0.02221451]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [0 2 3 1 4] pred: [ 0.0089358  -0.02526073  0.00338547 -0.00614002 -0.02920414]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 7 ============
pred sorted: [0 2 3 1 4] pred: [ 0.01565468 -0.01795411  0.00065172  0.00053208 -0.02624771]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [2 0 1 3 4] pred: [ 0.01098859  0.00768459  0.01527034 -0.00813148 -0.02605308]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [0 2 1 3 4] pred: [ 0.02460048  0.01284152  0.01654791 -0.01080097 -0.02132383]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [2 0 1 3 4] pred: [ 0.02768008  0.02329657  0.02844479 -0.00647168 -0.016698  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [1 4 0 3 2] pred: [-0.00219841  0.0394269  -0.04610526 -0.01726923  0.02291208]
 Top predictions indices: [1] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [0 3 2 1 4] pred: [ 0.01674016 -0.0103855  -0.00324228  0.00518691 -0.02857844]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 0 3 4] pred: [ 0.02545747  0.03127851  0.03318463 -0.00930515 -0.01211518]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [0 3 2 1 4] pred: [ 0.02151332 -0.02391252 -0.00808076 -0.0002253  -0.02522096]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 6 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.2665 - accuracy: 0.08593/6 [==============>...............] - ETA: 0s - loss: 0.2666 - accuracy: 0.0859 5/6 [========================>.....] - ETA: 0s - loss: 0.2653 - accuracy: 0.08696/6 [==============================] - 4s 25ms/step - loss: 0.2645 - accuracy: 0.0871
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 2 3 4 1] pred: [ 0.02005722 -0.02895784  0.00900563  0.00025567 -0.00886092]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 1 ============
pred sorted: [3 0 2 1 4] pred: [-0.00565738 -0.03083251 -0.0160517   0.00790071 -0.03087696]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [3 0 1 4 2] pred: [-0.00350136 -0.01301424 -0.03103372 -0.00130678 -0.01933135]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [3 0 2 1 4] pred: [-0.00064637 -0.02775264 -0.01252383  0.02070892 -0.04092865]
 Top predictions indices: [3 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [3 0 2 1 4] pred: [ 0.00010397 -0.02412716 -0.02146814  0.01706138 -0.0322751 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [3 0 1 2 4] pred: [ 0.00258696 -0.02122829 -0.02395413  0.01655558 -0.05019545]
 Top predictions indices: [3 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [3 0 2 1 4] pred: [-0.00100207 -0.02367238 -0.01319423  0.01024465 -0.03314843]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [3 0 2 1 4] pred: [ 0.00056933 -0.02479775 -0.0110414   0.01065689 -0.03669043]
 Top predictions indices: [3 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 0 3 1 2] pred: [-0.00450324 -0.03144157 -0.04625246 -0.00931032  0.00697261]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [3 0 2 4 1] pred: [-0.00470348 -0.05084174 -0.03080839  0.02095128 -0.0488195 ]
 Top predictions indices: [3 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [0 2 4 3 1] pred: [ 0.02457458 -0.01904544  0.01055481  0.00413323  0.00615098]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [3 0 2 1 4] pred: [-0.01222714 -0.03824867 -0.02804581  0.01339657 -0.04800399]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [3 0 2 1 4] pred: [-0.00291185 -0.02819016 -0.01611762  0.01596375 -0.03077567]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 0 4 1] pred: [ 0.03116462 -0.01349754  0.04805768  0.0357222  -0.00242951]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [3 2 0 1 4] pred: [-0.01444262 -0.03290731 -0.00727082  0.01653049 -0.04866247]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 7 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.2518 - accuracy: 0.00783/6 [==============>...............] - ETA: 0s - loss: 0.2516 - accuracy: 0.0230 5/6 [========================>.....] - ETA: 0s - loss: 0.2515 - accuracy: 0.02506/6 [==============================] - 4s 28ms/step - loss: 0.2516 - accuracy: 0.0255
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 1 2 3 4] pred: [ 0.03389804  0.03266817  0.00805098  0.00536825 -0.00263354]
 Top predictions indices: [0] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [0 1 2 4 3] pred: [ 0.04358472  0.0193239   0.01465031 -0.00984756  0.00692552]
 Top predictions indices: [0 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 2 ============
pred sorted: [1 0 3 2 4] pred: [ 0.01647169  0.01674215 -0.01049521 -0.00637484 -0.01257788]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [4 2 0 3 1] pred: [ 0.0161878  -0.02083653  0.03327185  0.00057206  0.03713056]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [0 1 4 2 3] pred: [ 0.02626996  0.01470413  0.01274661 -0.02400678  0.01408918]
 Top predictions indices: [0 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 5 ============
pred sorted: [4 3 2 0 1] pred: [-0.00729284 -0.03882245 -0.00481857  0.00545234  0.00626706]
 Top predictions indices: [4 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [0 2 1 4 3] pred: [ 0.05011173  0.00770498  0.01462751 -0.01090578 -0.00270846]
 Top predictions indices: [0 2] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 7 ============
pred sorted: [0 3 2 4 1] pred: [ 0.02899261 -0.05007426  0.0067193   0.01387119 -0.0123935 ]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [0 1 2 4 3] pred: [ 0.03728687  0.02010329  0.01330285 -0.01086711  0.00388898]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [0 4 2 1 3] pred: [ 0.02425349 -0.00668979  0.00447239 -0.01540606  0.01821967]
 Top predictions indices: [0 4] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [0 1 2 4 3] pred: [ 0.03679857  0.02724739  0.01083938 -0.00661375  0.00709938]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [0 1 2 4 3] pred: [ 0.03706191  0.01936497  0.01240352 -0.00980789  0.00372124]
 Top predictions indices: [0] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [0 3 4 2 1] pred: [ 0.01149781 -0.04665806 -0.00612406  0.00810861 -0.00196147]
 Top predictions indices: [0] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 4 3 0 1] pred: [-0.02637577 -0.03772604  0.00629558 -0.00883394  0.00253262]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [1 0 3 4 2] pred: [ 0.02965176  0.03338907 -0.00162811  0.01584619  0.00900841]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 8 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.2510 - accuracy: 0.08593/6 [==============>...............] - ETA: 0s - loss: 0.2542 - accuracy: 0.1068 5/6 [========================>.....] - ETA: 0s - loss: 0.2560 - accuracy: 0.11236/6 [==============================] - 4s 28ms/step - loss: 0.2562 - accuracy: 0.1146
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 1 0 4 2] pred: [-0.01325557  0.00724489 -0.01899015  0.04516951 -0.01519596]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [3 1 4 2 0] pred: [-0.02081092  0.00436754 -0.01835832  0.04605179 -0.00481054]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [1 3 2 4 0] pred: [-0.01483261  0.01693448  0.00163333  0.00569307 -0.0105777 ]
 Top predictions indices: [1] vs. real classes indices: [3]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [3 0 4 1 2] pred: [-0.00510196 -0.01256841 -0.01506681  0.02522421 -0.00793619]
 Top predictions indices: [3 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [3 1 4 2 0] pred: [-0.02085172  0.00498537 -0.01889013  0.04721588 -0.00517362]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [3 1 4 0 2] pred: [-0.01727112  0.00091626 -0.02443884  0.05670084 -0.00879483]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [2 0 4 1 3] pred: [ 0.0190482  -0.00289418  0.03075134 -0.03038857  0.01818443]
 Top predictions indices: [2] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [3 1 0 4 2] pred: [-0.0115289   0.00603468 -0.01568757  0.04642938 -0.01461748]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [3 1 4 0 2] pred: [-0.01640864  0.01182652 -0.02072634  0.05257031 -0.00409674]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [3 1 4 2 0] pred: [-0.01736219  0.00218176 -0.01642732  0.05173254 -0.0092773 ]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 1 4 0 2] pred: [-0.01257233  0.00546261 -0.01755173  0.03840457 -0.00681083]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [3 1 4 0 2] pred: [-0.01614782  0.00558799 -0.02209349  0.0527456  -0.0123931 ]
 Top predictions indices: [3 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
 ============ Sample: 12 ============
pred sorted: [2 0 1 4 3] pred: [-0.0018218  -0.01679212  0.01350687 -0.02130522 -0.02020064]
 Top predictions indices: [2] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 4 0 3] pred: [-0.01133059  0.04946657 -0.00103277 -0.02787876 -0.00565861]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 1 4 0 2] pred: [-0.01875736  0.00640305 -0.01965972  0.04981832 -0.00675581]
 Top predictions indices: [3 1] vs. real classes indices: [1 2]
Jaccard Score:  0.3333333333333333
 
Generating classification report
Generating confusion matrix
Exécution 9 : 
BPIC20.csv
Running Tensforflow with CPU
GRU
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a GRU
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 90, 58)            3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                16200     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 19,869
Trainable params: 19,869
Non-trainable params: 0
_________________________________________________________________
None
Evaluate on test data
1/6 [====>.........................] - ETA: 20s - loss: 0.2441 - accuracy: 0.04693/6 [==============>...............] - ETA: 0s - loss: 0.2444 - accuracy: 0.0573 5/6 [========================>.....] - ETA: 0s - loss: 0.2463 - accuracy: 0.05806/6 [==============================] - 4s 37ms/step - loss: 0.2482 - accuracy: 0.0588
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 4 0 2 1] pred: [ 0.01877041 -0.01919515  0.00090635  0.03121455  0.02644541]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 1 ============
pred sorted: [4 3 0 2 1] pred: [-0.00150242 -0.01753734 -0.01087136  0.0140583   0.04117579]
 Top predictions indices: [4 3] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [4 0 2 1 3] pred: [ 0.01763149 -0.00168372  0.00743703 -0.02264288  0.03728453]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 0 2 1] pred: [ 0.00816028 -0.02712051  0.00616524  0.03939605  0.02802631]
 Top predictions indices: [3] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [3 2 4 0 1] pred: [ 0.00281431 -0.02168737  0.01945321  0.02631276  0.01327924]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [4 0 3 2 1] pred: [ 0.01998103 -0.01218032 -0.00401076  0.00287862  0.03254418]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [4 0 3 1 2] pred: [ 0.04641316  0.00164999 -0.02439387  0.01205739  0.05379173]
 Top predictions indices: [4] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 0 2 1] pred: [ 0.01599758 -0.01694451  0.0044217   0.03259248  0.02125997]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [4 0 2 3 1] pred: [ 0.01812992 -0.0088035   0.00642294  0.00521781  0.03212142]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [4 0 1 2 3] pred: [ 0.02262786 -0.0019524  -0.00373224 -0.01507185  0.04162139]
 Top predictions indices: [4 0] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [3 4 2 0 1] pred: [ 0.00587999 -0.02910344  0.00791233  0.03980641  0.02932653]
 Top predictions indices: [3 4] vs. real classes indices: [1 2]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [4 2 3 1 0] pred: [-0.00285683 -0.00131415  0.01496164  0.00111701  0.04625206]
 Top predictions indices: [4] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 0 2 1] pred: [ 0.01625171 -0.03127064  0.0054337   0.03662653  0.02405246]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [3 4 2 0 1] pred: [ 0.00407524 -0.02639114  0.00427708  0.03964679  0.01211897]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [3 4 0 2 1] pred: [ 1.8426161e-02 -2.0205226e-02 -5.8654696e-06  3.2781783e-02
  2.7915789e-02]
 Top predictions indices: [3] vs. real classes indices: [2]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Job end at Sat Nov  5 10:23:16 CET 2022
