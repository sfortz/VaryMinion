
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompi-2020b
  2) GCC/8.3.0 => GCC/10.2.0
  3) GCCcore/8.3.0 => GCCcore/10.2.0
  4) OpenBLAS/0.3.7-GCC-8.3.0 => OpenBLAS/0.3.12-GCC-10.2.0
  5) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/4.0.5-GCC-10.2.0
  6) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.1.0-gompi-2020b
  7) XZ/5.2.4-GCCcore-8.3.0 => XZ/5.2.5-GCCcore-10.2.0
  8) binutils/2.32-GCCcore-8.3.0 => binutils/2.35-GCCcore-10.2.0
  9) foss/2019b => foss/2020b
 10) gompi/2019b => gompi/2020b
 11) hwloc/1.11.12-GCCcore-8.3.0 => hwloc/2.2.0-GCCcore-10.2.0
 12) libpciaccess/0.14-GCCcore-8.3.0 => libpciaccess/0.16-GCCcore-10.2.0
 13) libxml2/2.9.9-GCCcore-8.3.0 => libxml2/2.9.10-GCCcore-10.2.0
 14) numactl/2.0.12-GCCcore-8.3.0 => numactl/2.0.13-GCCcore-10.2.0
 15) releases/2019b => releases/2020b
 16) zlib/1.2.11-GCCcore-8.3.0 => zlib/1.2.11-GCCcore-10.2.0

Job start at Sun Nov  6 08:29:49 CET 2022
WARNING:tensorflow:From /scratch/2546130/2546130/VaryMinions/scripts/training_NN/training_Model.py:22: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2022-11-06 08:29:54.259047: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-06 08:29:54.259518: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
2022-11-06 08:29:56.147243: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-11-06 08:29:56.147611: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500195000 Hz
Number of possible configurations: 40
Begining exécution of the 35 th configuration: BPIC20.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, tanh as activation function and manhattan as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 58)          3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                21360     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:13 - loss: 1.3274 - accuracy: 0.2812 2/11 [====>.........................] - ETA: 2s - loss: 1.3349 - accuracy: 0.2734   3/11 [=======>......................] - ETA: 1s - loss: 1.3337 - accuracy: 0.2951 4/11 [=========>....................] - ETA: 1s - loss: 1.3358 - accuracy: 0.3195 5/11 [============>.................] - ETA: 1s - loss: 1.3317 - accuracy: 0.3415 6/11 [===============>..............] - ETA: 1s - loss: 1.3250 - accuracy: 0.3601 7/11 [==================>...........] - ETA: 0s - loss: 1.3190 - accuracy: 0.3737 8/11 [====================>.........] - ETA: 0s - loss: 1.3134 - accuracy: 0.3839 9/11 [=======================>......] - ETA: 0s - loss: 1.3083 - accuracy: 0.392410/11 [==========================>...] - ETA: 0s - loss: 1.3038 - accuracy: 0.398911/11 [==============================] - ETA: 0s - loss: 1.2995 - accuracy: 0.404311/11 [==============================] - 9s 172ms/step - loss: 1.2959 - accuracy: 0.4088
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 1.2328 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 1s - loss: 1.2197 - accuracy: 0.4199 3/11 [=======>......................] - ETA: 1s - loss: 1.2187 - accuracy: 0.4223 4/11 [=========>....................] - ETA: 1s - loss: 1.2128 - accuracy: 0.4300 5/11 [============>.................] - ETA: 0s - loss: 1.2058 - accuracy: 0.4384 6/11 [===============>..............] - ETA: 0s - loss: 1.2007 - accuracy: 0.4426 7/11 [==================>...........] - ETA: 0s - loss: 1.1960 - accuracy: 0.4457 8/11 [====================>.........] - ETA: 0s - loss: 1.1917 - accuracy: 0.4483 9/11 [=======================>......] - ETA: 0s - loss: 1.1881 - accuracy: 0.449410/11 [==========================>...] - ETA: 0s - loss: 1.1847 - accuracy: 0.450311/11 [==============================] - ETA: 0s - loss: 1.1815 - accuracy: 0.450911/11 [==============================] - 2s 152ms/step - loss: 1.1788 - accuracy: 0.4515
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 1.0504 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 1.0420 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 1s - loss: 1.0360 - accuracy: 0.4766 4/11 [=========>....................] - ETA: 1s - loss: 1.0310 - accuracy: 0.4761 5/11 [============>.................] - ETA: 0s - loss: 1.0308 - accuracy: 0.4709 6/11 [===============>..............] - ETA: 0s - loss: 1.0312 - accuracy: 0.4655 7/11 [==================>...........] - ETA: 0s - loss: 1.0291 - accuracy: 0.4628 8/11 [====================>.........] - ETA: 0s - loss: 1.0254 - accuracy: 0.4617 9/11 [=======================>......] - ETA: 0s - loss: 1.0207 - accuracy: 0.461210/11 [==========================>...] - ETA: 0s - loss: 1.0159 - accuracy: 0.460911/11 [==============================] - ETA: 0s - loss: 1.0113 - accuracy: 0.460611/11 [==============================] - 2s 148ms/step - loss: 1.0076 - accuracy: 0.4603
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8658 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.8246 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 1s - loss: 0.8200 - accuracy: 0.4627 4/11 [=========>....................] - ETA: 1s - loss: 0.8166 - accuracy: 0.4642 5/11 [============>.................] - ETA: 0s - loss: 0.8220 - accuracy: 0.4598 6/11 [===============>..............] - ETA: 0s - loss: 0.8250 - accuracy: 0.4572 7/11 [==================>...........] - ETA: 0s - loss: 0.8251 - accuracy: 0.4566 8/11 [====================>.........] - ETA: 0s - loss: 0.8242 - accuracy: 0.4573 9/11 [=======================>......] - ETA: 0s - loss: 0.8233 - accuracy: 0.457910/11 [==========================>...] - ETA: 0s - loss: 0.8229 - accuracy: 0.457911/11 [==============================] - ETA: 0s - loss: 0.8229 - accuracy: 0.457911/11 [==============================] - 2s 162ms/step - loss: 0.8229 - accuracy: 0.4579
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7676 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.7775 - accuracy: 0.4883 3/11 [=======>......................] - ETA: 1s - loss: 0.7823 - accuracy: 0.4800 4/11 [=========>....................] - ETA: 1s - loss: 0.7901 - accuracy: 0.4748 5/11 [============>.................] - ETA: 1s - loss: 0.7966 - accuracy: 0.4711 6/11 [===============>..............] - ETA: 0s - loss: 0.8028 - accuracy: 0.4676 7/11 [==================>...........] - ETA: 0s - loss: 0.8063 - accuracy: 0.4648 8/11 [====================>.........] - ETA: 0s - loss: 0.8087 - accuracy: 0.4623 9/11 [=======================>......] - ETA: 0s - loss: 0.8090 - accuracy: 0.461210/11 [==========================>...] - ETA: 0s - loss: 0.8084 - accuracy: 0.460511/11 [==============================] - ETA: 0s - loss: 0.8075 - accuracy: 0.460211/11 [==============================] - 2s 151ms/step - loss: 0.8066 - accuracy: 0.4600
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8024 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.7959 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 1s - loss: 0.7846 - accuracy: 0.4618 4/11 [=========>....................] - ETA: 0s - loss: 0.7850 - accuracy: 0.4616 5/11 [============>.................] - ETA: 0s - loss: 0.7827 - accuracy: 0.4633 6/11 [===============>..............] - ETA: 0s - loss: 0.7822 - accuracy: 0.4627 7/11 [==================>...........] - ETA: 0s - loss: 0.7828 - accuracy: 0.4618 8/11 [====================>.........] - ETA: 0s - loss: 0.7830 - accuracy: 0.4611 9/11 [=======================>......] - ETA: 0s - loss: 0.7827 - accuracy: 0.460910/11 [==========================>...] - ETA: 0s - loss: 0.7819 - accuracy: 0.461111/11 [==============================] - ETA: 0s - loss: 0.7809 - accuracy: 0.461111/11 [==============================] - 2s 138ms/step - loss: 0.7801 - accuracy: 0.4612
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7586 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.7476 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 1s - loss: 0.7429 - accuracy: 0.4709 4/11 [=========>....................] - ETA: 0s - loss: 0.7427 - accuracy: 0.4709 5/11 [============>.................] - ETA: 0s - loss: 0.7466 - accuracy: 0.4692 6/11 [===============>..............] - ETA: 0s - loss: 0.7464 - accuracy: 0.4713 7/11 [==================>...........] - ETA: 0s - loss: 0.7462 - accuracy: 0.4716 8/11 [====================>.........] - ETA: 0s - loss: 0.7452 - accuracy: 0.4718 9/11 [=======================>......] - ETA: 0s - loss: 0.7450 - accuracy: 0.472210/11 [==========================>...] - ETA: 0s - loss: 0.7454 - accuracy: 0.471911/11 [==============================] - ETA: 0s - loss: 0.7453 - accuracy: 0.471611/11 [==============================] - 2s 143ms/step - loss: 0.7453 - accuracy: 0.4713
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7748 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 1s - loss: 0.7456 - accuracy: 0.4473 3/11 [=======>......................] - ETA: 1s - loss: 0.7437 - accuracy: 0.4553 4/11 [=========>....................] - ETA: 1s - loss: 0.7390 - accuracy: 0.4626 5/11 [============>.................] - ETA: 1s - loss: 0.7380 - accuracy: 0.4638 6/11 [===============>..............] - ETA: 0s - loss: 0.7371 - accuracy: 0.4655 7/11 [==================>...........] - ETA: 0s - loss: 0.7363 - accuracy: 0.4671 8/11 [====================>.........] - ETA: 0s - loss: 0.7345 - accuracy: 0.4685 9/11 [=======================>......] - ETA: 0s - loss: 0.7334 - accuracy: 0.469910/11 [==========================>...] - ETA: 0s - loss: 0.7326 - accuracy: 0.470911/11 [==============================] - ETA: 0s - loss: 0.7319 - accuracy: 0.471711/11 [==============================] - 2s 141ms/step - loss: 0.7313 - accuracy: 0.4724
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6479 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 1s - loss: 0.6706 - accuracy: 0.5098 3/11 [=======>......................] - ETA: 1s - loss: 0.6860 - accuracy: 0.4891 4/11 [=========>....................] - ETA: 1s - loss: 0.6938 - accuracy: 0.4836 5/11 [============>.................] - ETA: 0s - loss: 0.6952 - accuracy: 0.4822 6/11 [===============>..............] - ETA: 0s - loss: 0.6950 - accuracy: 0.4817 7/11 [==================>...........] - ETA: 0s - loss: 0.6941 - accuracy: 0.4824 8/11 [====================>.........] - ETA: 0s - loss: 0.6940 - accuracy: 0.4826 9/11 [=======================>......] - ETA: 0s - loss: 0.6949 - accuracy: 0.482710/11 [==========================>...] - ETA: 0s - loss: 0.6957 - accuracy: 0.482611/11 [==============================] - ETA: 0s - loss: 0.6965 - accuracy: 0.482611/11 [==============================] - 2s 151ms/step - loss: 0.6971 - accuracy: 0.4827
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6935 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.6885 - accuracy: 0.5293 3/11 [=======>......................] - ETA: 1s - loss: 0.6746 - accuracy: 0.5343 4/11 [=========>....................] - ETA: 1s - loss: 0.6742 - accuracy: 0.5277 5/11 [============>.................] - ETA: 0s - loss: 0.6778 - accuracy: 0.5196 6/11 [===============>..............] - ETA: 0s - loss: 0.6792 - accuracy: 0.5133 7/11 [==================>...........] - ETA: 0s - loss: 0.6815 - accuracy: 0.5086 8/11 [====================>.........] - ETA: 0s - loss: 0.6820 - accuracy: 0.5063 9/11 [=======================>......] - ETA: 0s - loss: 0.6820 - accuracy: 0.504410/11 [==========================>...] - ETA: 0s - loss: 0.6824 - accuracy: 0.502911/11 [==============================] - ETA: 0s - loss: 0.6823 - accuracy: 0.501711/11 [==============================] - 2s 149ms/step - loss: 0.6823 - accuracy: 0.5007
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5401 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.5886 - accuracy: 0.4863 3/11 [=======>......................] - ETA: 1s - loss: 0.6113 - accuracy: 0.4857 4/11 [=========>....................] - ETA: 1s - loss: 0.6287 - accuracy: 0.4819 5/11 [============>.................] - ETA: 0s - loss: 0.6408 - accuracy: 0.4790 6/11 [===============>..............] - ETA: 0s - loss: 0.6465 - accuracy: 0.4788 7/11 [==================>...........] - ETA: 0s - loss: 0.6492 - accuracy: 0.4790 8/11 [====================>.........] - ETA: 0s - loss: 0.6515 - accuracy: 0.4794 9/11 [=======================>......] - ETA: 0s - loss: 0.6530 - accuracy: 0.480310/11 [==========================>...] - ETA: 0s - loss: 0.6541 - accuracy: 0.481511/11 [==============================] - ETA: 0s - loss: 0.6543 - accuracy: 0.483011/11 [==============================] - 2s 158ms/step - loss: 0.6545 - accuracy: 0.4842
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6741 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.6629 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 1s - loss: 0.6489 - accuracy: 0.5391 4/11 [=========>....................] - ETA: 1s - loss: 0.6462 - accuracy: 0.5342 5/11 [============>.................] - ETA: 0s - loss: 0.6409 - accuracy: 0.5330 6/11 [===============>..............] - ETA: 0s - loss: 0.6378 - accuracy: 0.5320 7/11 [==================>...........] - ETA: 0s - loss: 0.6369 - accuracy: 0.5295 8/11 [====================>.........] - ETA: 0s - loss: 0.6348 - accuracy: 0.5283 9/11 [=======================>......] - ETA: 0s - loss: 0.6337 - accuracy: 0.526310/11 [==========================>...] - ETA: 0s - loss: 0.6327 - accuracy: 0.524811/11 [==============================] - ETA: 0s - loss: 0.6320 - accuracy: 0.523411/11 [==============================] - 2s 138ms/step - loss: 0.6314 - accuracy: 0.5223
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6538 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 1s - loss: 0.6491 - accuracy: 0.5410 3/11 [=======>......................] - ETA: 1s - loss: 0.6385 - accuracy: 0.5352 4/11 [=========>....................] - ETA: 1s - loss: 0.6328 - accuracy: 0.5303 5/11 [============>.................] - ETA: 0s - loss: 0.6300 - accuracy: 0.5245 6/11 [===============>..............] - ETA: 0s - loss: 0.6258 - accuracy: 0.5235 7/11 [==================>...........] - ETA: 0s - loss: 0.6220 - accuracy: 0.5243 8/11 [====================>.........] - ETA: 0s - loss: 0.6177 - accuracy: 0.5242 9/11 [=======================>......] - ETA: 0s - loss: 0.6140 - accuracy: 0.524110/11 [==========================>...] - ETA: 0s - loss: 0.6112 - accuracy: 0.523611/11 [==============================] - ETA: 0s - loss: 0.6094 - accuracy: 0.523811/11 [==============================] - 2s 160ms/step - loss: 0.6078 - accuracy: 0.5240
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5450 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.5601 - accuracy: 0.4980 3/11 [=======>......................] - ETA: 0s - loss: 0.5615 - accuracy: 0.5126 4/11 [=========>....................] - ETA: 0s - loss: 0.5577 - accuracy: 0.5275 5/11 [============>.................] - ETA: 0s - loss: 0.5539 - accuracy: 0.5342 6/11 [===============>..............] - ETA: 0s - loss: 0.5522 - accuracy: 0.5363 7/11 [==================>...........] - ETA: 0s - loss: 0.5516 - accuracy: 0.5377 8/11 [====================>.........] - ETA: 0s - loss: 0.5518 - accuracy: 0.5381 9/11 [=======================>......] - ETA: 0s - loss: 0.5511 - accuracy: 0.540210/11 [==========================>...] - ETA: 0s - loss: 0.5511 - accuracy: 0.541811/11 [==============================] - ETA: 0s - loss: 0.5514 - accuracy: 0.543111/11 [==============================] - 2s 143ms/step - loss: 0.5517 - accuracy: 0.5442
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5009 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 1s - loss: 0.5056 - accuracy: 0.5605 3/11 [=======>......................] - ETA: 1s - loss: 0.5069 - accuracy: 0.5560 4/11 [=========>....................] - ETA: 1s - loss: 0.5127 - accuracy: 0.5596 5/11 [============>.................] - ETA: 0s - loss: 0.5151 - accuracy: 0.5611 6/11 [===============>..............] - ETA: 0s - loss: 0.5170 - accuracy: 0.5615 7/11 [==================>...........] - ETA: 0s - loss: 0.5177 - accuracy: 0.5630 8/11 [====================>.........] - ETA: 0s - loss: 0.5188 - accuracy: 0.5636 9/11 [=======================>......] - ETA: 0s - loss: 0.5198 - accuracy: 0.564210/11 [==========================>...] - ETA: 0s - loss: 0.5203 - accuracy: 0.565211/11 [==============================] - ETA: 0s - loss: 0.5210 - accuracy: 0.565611/11 [==============================] - 2s 147ms/step - loss: 0.5215 - accuracy: 0.5660
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4620 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 1s - loss: 0.4680 - accuracy: 0.6172 3/11 [=======>......................] - ETA: 1s - loss: 0.4722 - accuracy: 0.6241 4/11 [=========>....................] - ETA: 1s - loss: 0.4765 - accuracy: 0.6229 5/11 [============>.................] - ETA: 0s - loss: 0.4807 - accuracy: 0.6196 6/11 [===============>..............] - ETA: 0s - loss: 0.4846 - accuracy: 0.6161 7/11 [==================>...........] - ETA: 0s - loss: 0.4878 - accuracy: 0.6134 8/11 [====================>.........] - ETA: 0s - loss: 0.4910 - accuracy: 0.6106 9/11 [=======================>......] - ETA: 0s - loss: 0.4930 - accuracy: 0.608510/11 [==========================>...] - ETA: 0s - loss: 0.4945 - accuracy: 0.606911/11 [==============================] - ETA: 0s - loss: 0.4957 - accuracy: 0.606011/11 [==============================] - 2s 157ms/step - loss: 0.4967 - accuracy: 0.6053
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4799 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 1s - loss: 0.4871 - accuracy: 0.6055 3/11 [=======>......................] - ETA: 1s - loss: 0.4822 - accuracy: 0.6050 4/11 [=========>....................] - ETA: 1s - loss: 0.4810 - accuracy: 0.6042 5/11 [============>.................] - ETA: 0s - loss: 0.4783 - accuracy: 0.6049 6/11 [===============>..............] - ETA: 0s - loss: 0.4777 - accuracy: 0.6050 7/11 [==================>...........] - ETA: 0s - loss: 0.4777 - accuracy: 0.6063 8/11 [====================>.........] - ETA: 0s - loss: 0.4787 - accuracy: 0.6055 9/11 [=======================>......] - ETA: 0s - loss: 0.4788 - accuracy: 0.605410/11 [==========================>...] - ETA: 0s - loss: 0.4791 - accuracy: 0.605011/11 [==============================] - ETA: 0s - loss: 0.4796 - accuracy: 0.604811/11 [==============================] - 2s 138ms/step - loss: 0.4799 - accuracy: 0.6046
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5233 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 1s - loss: 0.5207 - accuracy: 0.6582 3/11 [=======>......................] - ETA: 1s - loss: 0.5121 - accuracy: 0.6567 4/11 [=========>....................] - ETA: 0s - loss: 0.5069 - accuracy: 0.6532 5/11 [============>.................] - ETA: 0s - loss: 0.5015 - accuracy: 0.6497 6/11 [===============>..............] - ETA: 0s - loss: 0.4985 - accuracy: 0.6465 7/11 [==================>...........] - ETA: 0s - loss: 0.4949 - accuracy: 0.6432 8/11 [====================>.........] - ETA: 0s - loss: 0.4927 - accuracy: 0.6400 9/11 [=======================>......] - ETA: 0s - loss: 0.4901 - accuracy: 0.638410/11 [==========================>...] - ETA: 0s - loss: 0.4879 - accuracy: 0.636811/11 [==============================] - ETA: 0s - loss: 0.4860 - accuracy: 0.635211/11 [==============================] - 1s 126ms/step - loss: 0.4844 - accuracy: 0.6338
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4976 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 1s - loss: 0.4907 - accuracy: 0.6133 3/11 [=======>......................] - ETA: 1s - loss: 0.4827 - accuracy: 0.6111 4/11 [=========>....................] - ETA: 1s - loss: 0.4740 - accuracy: 0.6117 5/11 [============>.................] - ETA: 0s - loss: 0.4675 - accuracy: 0.6143 6/11 [===============>..............] - ETA: 0s - loss: 0.4651 - accuracy: 0.6161 7/11 [==================>...........] - ETA: 0s - loss: 0.4637 - accuracy: 0.6156 8/11 [====================>.........] - ETA: 0s - loss: 0.4627 - accuracy: 0.6161 9/11 [=======================>......] - ETA: 0s - loss: 0.4613 - accuracy: 0.616510/11 [==========================>...] - ETA: 0s - loss: 0.4607 - accuracy: 0.616511/11 [==============================] - ETA: 0s - loss: 0.4604 - accuracy: 0.616611/11 [==============================] - 2s 149ms/step - loss: 0.4600 - accuracy: 0.6167
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4449 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 1s - loss: 0.4481 - accuracy: 0.6270 3/11 [=======>......................] - ETA: 0s - loss: 0.4445 - accuracy: 0.6237 4/11 [=========>....................] - ETA: 0s - loss: 0.4463 - accuracy: 0.6230 5/11 [============>.................] - ETA: 0s - loss: 0.4497 - accuracy: 0.6244 6/11 [===============>..............] - ETA: 0s - loss: 0.4526 - accuracy: 0.6247 7/11 [==================>...........] - ETA: 0s - loss: 0.4552 - accuracy: 0.6252 8/11 [====================>.........] - ETA: 0s - loss: 0.4563 - accuracy: 0.6252 9/11 [=======================>......] - ETA: 0s - loss: 0.4571 - accuracy: 0.625010/11 [==========================>...] - ETA: 0s - loss: 0.4564 - accuracy: 0.624811/11 [==============================] - ETA: 0s - loss: 0.4556 - accuracy: 0.624811/11 [==============================] - 1s 119ms/step - loss: 0.4550 - accuracy: 0.6249
Evaluate on test data
1/6 [====>.........................] - ETA: 11s - loss: 0.5261 - accuracy: 0.59383/6 [==============>...............] - ETA: 0s - loss: 0.5080 - accuracy: 0.6120 5/6 [========================>.....] - ETA: 0s - loss: 0.4693 - accuracy: 0.61566/6 [==============================] - 3s 28ms/step - loss: 0.4617 - accuracy: 0.6204
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 4 0 3] pred: [-0.041926   0.9984456  0.9995607 -0.0454246  0.0303778]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 0 4 3 1] pred: [ 7.5952598e-04 -4.0967908e-02  9.9580222e-01 -1.0566805e-02
 -3.1105687e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [3 4 0 1 2] pred: [-0.00356527 -0.02869634 -0.04375337  0.2768569   0.02124282]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 0 4 3 1] pred: [-0.00251212 -0.03129705  0.9970045  -0.00570662 -0.00369753]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 4 3] pred: [ 4.5629889e-03  9.6215022e-01  9.5462191e-01 -1.3797341e-02
  2.5601068e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [-0.0036413   0.03104402  0.99761057  0.00463872 -0.013657  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 0 3] pred: [-0.00396789  0.99746317  0.9995893  -0.01726079 -0.00344621]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 0 3 4 1] pred: [ 0.00597322 -0.13128547  0.99595356 -0.00230584 -0.00465106]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 4 3] pred: [ 7.2201237e-04  8.0860251e-01  9.9735969e-01 -5.3300746e-03
 -3.6606798e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [3 4 0 2 1] pred: [ 0.00052987 -0.03654594 -0.02939563  0.3121641   0.04896745]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 0 3 4 1] pred: [ 0.00626951 -0.0211297   0.99589145 -0.00320738 -0.00854193]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [-0.00575918  0.9630184   0.99283344 -0.00504938 -0.00736237]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 4 0] pred: [-0.02076989  0.07138944  0.9941218   0.04966883 -0.0126172 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 3 0] pred: [-7.3647518e-03  9.5157295e-01  9.9917197e-01 -6.7987754e-03
 -5.6654081e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 4 3] pred: [ 0.00300827  0.9918009   0.9993918  -0.01487376  0.00251937]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 1 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:19 - loss: 1.3424 - accuracy: 0.0938 2/11 [====>.........................] - ETA: 1s - loss: 1.3388 - accuracy: 0.1055   3/11 [=======>......................] - ETA: 1s - loss: 1.3357 - accuracy: 0.1328 4/11 [=========>....................] - ETA: 1s - loss: 1.3338 - accuracy: 0.1577 5/11 [============>.................] - ETA: 0s - loss: 1.3316 - accuracy: 0.1809 6/11 [===============>..............] - ETA: 0s - loss: 1.3288 - accuracy: 0.2024 7/11 [==================>...........] - ETA: 0s - loss: 1.3260 - accuracy: 0.2186 8/11 [====================>.........] - ETA: 0s - loss: 1.3226 - accuracy: 0.2340 9/11 [=======================>......] - ETA: 0s - loss: 1.3194 - accuracy: 0.247510/11 [==========================>...] - ETA: 0s - loss: 1.3159 - accuracy: 0.259811/11 [==============================] - ETA: 0s - loss: 1.3122 - accuracy: 0.270711/11 [==============================] - 10s 174ms/step - loss: 1.3091 - accuracy: 0.2799
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 1.1561 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 1.1595 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 1s - loss: 1.1637 - accuracy: 0.4883 4/11 [=========>....................] - ETA: 1s - loss: 1.1688 - accuracy: 0.4810 5/11 [============>.................] - ETA: 1s - loss: 1.1720 - accuracy: 0.4741 6/11 [===============>..............] - ETA: 1s - loss: 1.1736 - accuracy: 0.4696 7/11 [==================>...........] - ETA: 0s - loss: 1.1745 - accuracy: 0.4659 8/11 [====================>.........] - ETA: 0s - loss: 1.1748 - accuracy: 0.4635 9/11 [=======================>......] - ETA: 0s - loss: 1.1744 - accuracy: 0.461810/11 [==========================>...] - ETA: 0s - loss: 1.1737 - accuracy: 0.460711/11 [==============================] - ETA: 0s - loss: 1.1724 - accuracy: 0.460111/11 [==============================] - 2s 213ms/step - loss: 1.1714 - accuracy: 0.4595
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 1.0412 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 1.0407 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 1s - loss: 1.0358 - accuracy: 0.4653 4/11 [=========>....................] - ETA: 1s - loss: 1.0288 - accuracy: 0.4705 5/11 [============>.................] - ETA: 1s - loss: 1.0241 - accuracy: 0.4724 6/11 [===============>..............] - ETA: 1s - loss: 1.0201 - accuracy: 0.4729 7/11 [==================>...........] - ETA: 0s - loss: 1.0175 - accuracy: 0.4716 8/11 [====================>.........] - ETA: 0s - loss: 1.0153 - accuracy: 0.4699 9/11 [=======================>......] - ETA: 0s - loss: 1.0128 - accuracy: 0.468110/11 [==========================>...] - ETA: 0s - loss: 1.0105 - accuracy: 0.466311/11 [==============================] - ETA: 0s - loss: 1.0075 - accuracy: 0.465011/11 [==============================] - 2s 204ms/step - loss: 1.0051 - accuracy: 0.4640
Epoch 4/20
 1/11 [=>............................] - ETA: 2s - loss: 0.8753 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 1s - loss: 0.8690 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 1s - loss: 0.8587 - accuracy: 0.4366 4/11 [=========>....................] - ETA: 1s - loss: 0.8580 - accuracy: 0.4378 5/11 [============>.................] - ETA: 1s - loss: 0.8571 - accuracy: 0.4393 6/11 [===============>..............] - ETA: 1s - loss: 0.8538 - accuracy: 0.4421 7/11 [==================>...........] - ETA: 0s - loss: 0.8533 - accuracy: 0.4420 8/11 [====================>.........] - ETA: 0s - loss: 0.8515 - accuracy: 0.4429 9/11 [=======================>......] - ETA: 0s - loss: 0.8498 - accuracy: 0.443910/11 [==========================>...] - ETA: 0s - loss: 0.8478 - accuracy: 0.444911/11 [==============================] - ETA: 0s - loss: 0.8463 - accuracy: 0.445611/11 [==============================] - 2s 223ms/step - loss: 0.8450 - accuracy: 0.4461
Epoch 5/20
 1/11 [=>............................] - ETA: 2s - loss: 0.8942 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 1s - loss: 0.8607 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 1s - loss: 0.8440 - accuracy: 0.4449 4/11 [=========>....................] - ETA: 1s - loss: 0.8350 - accuracy: 0.4484 5/11 [============>.................] - ETA: 1s - loss: 0.8360 - accuracy: 0.4459 6/11 [===============>..............] - ETA: 0s - loss: 0.8359 - accuracy: 0.4447 7/11 [==================>...........] - ETA: 0s - loss: 0.8365 - accuracy: 0.4434 8/11 [====================>.........] - ETA: 0s - loss: 0.8361 - accuracy: 0.4425 9/11 [=======================>......] - ETA: 0s - loss: 0.8349 - accuracy: 0.442710/11 [==========================>...] - ETA: 0s - loss: 0.8327 - accuracy: 0.443911/11 [==============================] - ETA: 0s - loss: 0.8309 - accuracy: 0.444811/11 [==============================] - 2s 195ms/step - loss: 0.8295 - accuracy: 0.4455
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7168 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.7566 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 1s - loss: 0.7624 - accuracy: 0.4965 4/11 [=========>....................] - ETA: 1s - loss: 0.7722 - accuracy: 0.4876 5/11 [============>.................] - ETA: 0s - loss: 0.7802 - accuracy: 0.4810 6/11 [===============>..............] - ETA: 0s - loss: 0.7855 - accuracy: 0.4757 7/11 [==================>...........] - ETA: 0s - loss: 0.7886 - accuracy: 0.4717 8/11 [====================>.........] - ETA: 0s - loss: 0.7912 - accuracy: 0.4684 9/11 [=======================>......] - ETA: 0s - loss: 0.7920 - accuracy: 0.466710/11 [==========================>...] - ETA: 0s - loss: 0.7917 - accuracy: 0.466011/11 [==============================] - ETA: 0s - loss: 0.7914 - accuracy: 0.465211/11 [==============================] - 2s 190ms/step - loss: 0.7911 - accuracy: 0.4645
Epoch 7/20
 1/11 [=>............................] - ETA: 2s - loss: 0.8646 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 2s - loss: 0.8455 - accuracy: 0.4160 3/11 [=======>......................] - ETA: 1s - loss: 0.8317 - accuracy: 0.4266 4/11 [=========>....................] - ETA: 1s - loss: 0.8199 - accuracy: 0.4342 5/11 [============>.................] - ETA: 1s - loss: 0.8137 - accuracy: 0.4371 6/11 [===============>..............] - ETA: 1s - loss: 0.8092 - accuracy: 0.4389 7/11 [==================>...........] - ETA: 0s - loss: 0.8056 - accuracy: 0.4404 8/11 [====================>.........] - ETA: 0s - loss: 0.8031 - accuracy: 0.4419 9/11 [=======================>......] - ETA: 0s - loss: 0.8000 - accuracy: 0.443910/11 [==========================>...] - ETA: 0s - loss: 0.7970 - accuracy: 0.445511/11 [==============================] - ETA: 0s - loss: 0.7937 - accuracy: 0.447111/11 [==============================] - 2s 206ms/step - loss: 0.7909 - accuracy: 0.4485
Epoch 8/20
 1/11 [=>............................] - ETA: 2s - loss: 0.7111 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.7227 - accuracy: 0.4980 3/11 [=======>......................] - ETA: 1s - loss: 0.7314 - accuracy: 0.4935 4/11 [=========>....................] - ETA: 1s - loss: 0.7365 - accuracy: 0.4893 5/11 [============>.................] - ETA: 1s - loss: 0.7410 - accuracy: 0.4848 6/11 [===============>..............] - ETA: 1s - loss: 0.7426 - accuracy: 0.4830 7/11 [==================>...........] - ETA: 0s - loss: 0.7433 - accuracy: 0.4827 8/11 [====================>.........] - ETA: 0s - loss: 0.7441 - accuracy: 0.4821 9/11 [=======================>......] - ETA: 0s - loss: 0.7442 - accuracy: 0.481310/11 [==========================>...] - ETA: 0s - loss: 0.7443 - accuracy: 0.480611/11 [==============================] - ETA: 0s - loss: 0.7440 - accuracy: 0.480211/11 [==============================] - 2s 204ms/step - loss: 0.7437 - accuracy: 0.4799
Epoch 9/20
 1/11 [=>............................] - ETA: 2s - loss: 0.6704 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.6833 - accuracy: 0.5137 3/11 [=======>......................] - ETA: 1s - loss: 0.6889 - accuracy: 0.5056 4/11 [=========>....................] - ETA: 1s - loss: 0.7036 - accuracy: 0.4950 5/11 [============>.................] - ETA: 1s - loss: 0.7104 - accuracy: 0.4910 6/11 [===============>..............] - ETA: 0s - loss: 0.7147 - accuracy: 0.4881 7/11 [==================>...........] - ETA: 0s - loss: 0.7171 - accuracy: 0.4865 8/11 [====================>.........] - ETA: 0s - loss: 0.7184 - accuracy: 0.4854 9/11 [=======================>......] - ETA: 0s - loss: 0.7189 - accuracy: 0.484910/11 [==========================>...] - ETA: 0s - loss: 0.7199 - accuracy: 0.484311/11 [==============================] - ETA: 0s - loss: 0.7201 - accuracy: 0.484011/11 [==============================] - 2s 179ms/step - loss: 0.7202 - accuracy: 0.4838
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6721 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 1s - loss: 0.6799 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 1s - loss: 0.6805 - accuracy: 0.5200 4/11 [=========>....................] - ETA: 1s - loss: 0.6877 - accuracy: 0.5125 5/11 [============>.................] - ETA: 1s - loss: 0.6910 - accuracy: 0.5078 6/11 [===============>..............] - ETA: 0s - loss: 0.6927 - accuracy: 0.5050 7/11 [==================>...........] - ETA: 0s - loss: 0.6934 - accuracy: 0.5027 8/11 [====================>.........] - ETA: 0s - loss: 0.6929 - accuracy: 0.5009 9/11 [=======================>......] - ETA: 0s - loss: 0.6921 - accuracy: 0.499010/11 [==========================>...] - ETA: 0s - loss: 0.6920 - accuracy: 0.497611/11 [==============================] - ETA: 0s - loss: 0.6923 - accuracy: 0.496111/11 [==============================] - 2s 175ms/step - loss: 0.6926 - accuracy: 0.4949
Epoch 11/20
 1/11 [=>............................] - ETA: 2s - loss: 0.6920 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.6942 - accuracy: 0.4590 3/11 [=======>......................] - ETA: 1s - loss: 0.6829 - accuracy: 0.4640 4/11 [=========>....................] - ETA: 1s - loss: 0.6777 - accuracy: 0.4691 5/11 [============>.................] - ETA: 1s - loss: 0.6760 - accuracy: 0.4718 6/11 [===============>..............] - ETA: 0s - loss: 0.6754 - accuracy: 0.4733 7/11 [==================>...........] - ETA: 0s - loss: 0.6754 - accuracy: 0.4747 8/11 [====================>.........] - ETA: 0s - loss: 0.6760 - accuracy: 0.4755 9/11 [=======================>......] - ETA: 0s - loss: 0.6756 - accuracy: 0.475710/11 [==========================>...] - ETA: 0s - loss: 0.6753 - accuracy: 0.476311/11 [==============================] - ETA: 0s - loss: 0.6748 - accuracy: 0.476911/11 [==============================] - 2s 183ms/step - loss: 0.6743 - accuracy: 0.4773
Epoch 12/20
 1/11 [=>............................] - ETA: 2s - loss: 0.6381 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.6496 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 1s - loss: 0.6561 - accuracy: 0.5061 4/11 [=========>....................] - ETA: 1s - loss: 0.6578 - accuracy: 0.5026 5/11 [============>.................] - ETA: 1s - loss: 0.6577 - accuracy: 0.4999 6/11 [===============>..............] - ETA: 0s - loss: 0.6585 - accuracy: 0.4971 7/11 [==================>...........] - ETA: 0s - loss: 0.6570 - accuracy: 0.4938 8/11 [====================>.........] - ETA: 0s - loss: 0.6563 - accuracy: 0.4914 9/11 [=======================>......] - ETA: 0s - loss: 0.6557 - accuracy: 0.490410/11 [==========================>...] - ETA: 0s - loss: 0.6543 - accuracy: 0.490211/11 [==============================] - ETA: 0s - loss: 0.6534 - accuracy: 0.489511/11 [==============================] - 2s 193ms/step - loss: 0.6527 - accuracy: 0.4889
Epoch 13/20
 1/11 [=>............................] - ETA: 2s - loss: 0.6627 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 2s - loss: 0.6334 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 1s - loss: 0.6153 - accuracy: 0.4900 4/11 [=========>....................] - ETA: 1s - loss: 0.6082 - accuracy: 0.4940 5/11 [============>.................] - ETA: 1s - loss: 0.6027 - accuracy: 0.4939 6/11 [===============>..............] - ETA: 1s - loss: 0.6026 - accuracy: 0.4934 7/11 [==================>...........] - ETA: 0s - loss: 0.6039 - accuracy: 0.4929 8/11 [====================>.........] - ETA: 0s - loss: 0.6046 - accuracy: 0.4926 9/11 [=======================>......] - ETA: 0s - loss: 0.6050 - accuracy: 0.492410/11 [==========================>...] - ETA: 0s - loss: 0.6057 - accuracy: 0.492111/11 [==============================] - ETA: 0s - loss: 0.6071 - accuracy: 0.491411/11 [==============================] - 2s 206ms/step - loss: 0.6082 - accuracy: 0.4909
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6676 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.6447 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 1s - loss: 0.6324 - accuracy: 0.4618 4/11 [=========>....................] - ETA: 1s - loss: 0.6256 - accuracy: 0.4674 5/11 [============>.................] - ETA: 1s - loss: 0.6215 - accuracy: 0.4755 6/11 [===============>..............] - ETA: 0s - loss: 0.6181 - accuracy: 0.4807 7/11 [==================>...........] - ETA: 0s - loss: 0.6162 - accuracy: 0.4833 8/11 [====================>.........] - ETA: 0s - loss: 0.6136 - accuracy: 0.4857 9/11 [=======================>......] - ETA: 0s - loss: 0.6111 - accuracy: 0.486910/11 [==========================>...] - ETA: 0s - loss: 0.6094 - accuracy: 0.488011/11 [==============================] - ETA: 0s - loss: 0.6085 - accuracy: 0.488011/11 [==============================] - 2s 179ms/step - loss: 0.6077 - accuracy: 0.4881
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6754 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.6476 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 1s - loss: 0.6281 - accuracy: 0.4774 4/11 [=========>....................] - ETA: 1s - loss: 0.6203 - accuracy: 0.4831 5/11 [============>.................] - ETA: 1s - loss: 0.6156 - accuracy: 0.4852 6/11 [===============>..............] - ETA: 0s - loss: 0.6118 - accuracy: 0.4849 7/11 [==================>...........] - ETA: 0s - loss: 0.6086 - accuracy: 0.4845 8/11 [====================>.........] - ETA: 0s - loss: 0.6065 - accuracy: 0.4841 9/11 [=======================>......] - ETA: 0s - loss: 0.6036 - accuracy: 0.483510/11 [==========================>...] - ETA: 0s - loss: 0.6010 - accuracy: 0.483311/11 [==============================] - ETA: 0s - loss: 0.5987 - accuracy: 0.483811/11 [==============================] - 2s 190ms/step - loss: 0.5969 - accuracy: 0.4843
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5636 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.5740 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 1s - loss: 0.5686 - accuracy: 0.5017 4/11 [=========>....................] - ETA: 1s - loss: 0.5660 - accuracy: 0.4993 5/11 [============>.................] - ETA: 1s - loss: 0.5619 - accuracy: 0.4985 6/11 [===============>..............] - ETA: 0s - loss: 0.5625 - accuracy: 0.4973 7/11 [==================>...........] - ETA: 0s - loss: 0.5624 - accuracy: 0.4973 8/11 [====================>.........] - ETA: 0s - loss: 0.5617 - accuracy: 0.4971 9/11 [=======================>......] - ETA: 0s - loss: 0.5615 - accuracy: 0.496410/11 [==========================>...] - ETA: 0s - loss: 0.5609 - accuracy: 0.496711/11 [==============================] - ETA: 0s - loss: 0.5604 - accuracy: 0.496711/11 [==============================] - 2s 203ms/step - loss: 0.5599 - accuracy: 0.4968
Epoch 17/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5626 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.5726 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 1s - loss: 0.5687 - accuracy: 0.4783 4/11 [=========>....................] - ETA: 1s - loss: 0.5647 - accuracy: 0.4832 5/11 [============>.................] - ETA: 1s - loss: 0.5603 - accuracy: 0.4882 6/11 [===============>..............] - ETA: 1s - loss: 0.5599 - accuracy: 0.4903 7/11 [==================>...........] - ETA: 0s - loss: 0.5590 - accuracy: 0.4924 8/11 [====================>.........] - ETA: 0s - loss: 0.5587 - accuracy: 0.4942 9/11 [=======================>......] - ETA: 0s - loss: 0.5568 - accuracy: 0.495710/11 [==========================>...] - ETA: 0s - loss: 0.5545 - accuracy: 0.497211/11 [==============================] - ETA: 0s - loss: 0.5525 - accuracy: 0.498611/11 [==============================] - 2s 219ms/step - loss: 0.5509 - accuracy: 0.4997
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4860 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.4877 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 1s - loss: 0.4854 - accuracy: 0.4991 4/11 [=========>....................] - ETA: 1s - loss: 0.4885 - accuracy: 0.5003 5/11 [============>.................] - ETA: 1s - loss: 0.4916 - accuracy: 0.5053 6/11 [===============>..............] - ETA: 0s - loss: 0.4937 - accuracy: 0.5096 7/11 [==================>...........] - ETA: 0s - loss: 0.4969 - accuracy: 0.5122 8/11 [====================>.........] - ETA: 0s - loss: 0.4995 - accuracy: 0.5146 9/11 [=======================>......] - ETA: 0s - loss: 0.5016 - accuracy: 0.515810/11 [==========================>...] - ETA: 0s - loss: 0.5031 - accuracy: 0.516811/11 [==============================] - ETA: 0s - loss: 0.5042 - accuracy: 0.517611/11 [==============================] - 2s 182ms/step - loss: 0.5052 - accuracy: 0.5183
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5521 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.5176 - accuracy: 0.5332 3/11 [=======>......................] - ETA: 1s - loss: 0.5033 - accuracy: 0.5369 4/11 [=========>....................] - ETA: 1s - loss: 0.4979 - accuracy: 0.5335 5/11 [============>.................] - ETA: 1s - loss: 0.4953 - accuracy: 0.5324 6/11 [===============>..............] - ETA: 0s - loss: 0.4937 - accuracy: 0.5331 7/11 [==================>...........] - ETA: 0s - loss: 0.4941 - accuracy: 0.5324 8/11 [====================>.........] - ETA: 0s - loss: 0.4939 - accuracy: 0.5335 9/11 [=======================>......] - ETA: 0s - loss: 0.4937 - accuracy: 0.534710/11 [==========================>...] - ETA: 0s - loss: 0.4938 - accuracy: 0.536011/11 [==============================] - ETA: 0s - loss: 0.4943 - accuracy: 0.536911/11 [==============================] - 2s 202ms/step - loss: 0.4947 - accuracy: 0.5376
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5060 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.4902 - accuracy: 0.5684 3/11 [=======>......................] - ETA: 1s - loss: 0.4820 - accuracy: 0.5734 4/11 [=========>....................] - ETA: 1s - loss: 0.4788 - accuracy: 0.5736 5/11 [============>.................] - ETA: 1s - loss: 0.4768 - accuracy: 0.5729 6/11 [===============>..............] - ETA: 1s - loss: 0.4763 - accuracy: 0.5710 7/11 [==================>...........] - ETA: 0s - loss: 0.4775 - accuracy: 0.5693 8/11 [====================>.........] - ETA: 0s - loss: 0.4778 - accuracy: 0.5689 9/11 [=======================>......] - ETA: 0s - loss: 0.4777 - accuracy: 0.568710/11 [==========================>...] - ETA: 0s - loss: 0.4779 - accuracy: 0.567711/11 [==============================] - ETA: 0s - loss: 0.4785 - accuracy: 0.566411/11 [==============================] - 2s 211ms/step - loss: 0.4790 - accuracy: 0.5653
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.5020 - accuracy: 0.67193/6 [==============>...............] - ETA: 0s - loss: 0.5074 - accuracy: 0.6172 5/6 [========================>.....] - ETA: 0s - loss: 0.5041 - accuracy: 0.60006/6 [==============================] - 3s 36ms/step - loss: 0.5119 - accuracy: 0.5907
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 0 1 3 4] pred: [ 0.00770037  0.00399066  0.98937833  0.00313197 -0.00452952]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [ 9.8146508e-03  9.3273985e-01  9.8677617e-01  1.9600820e-03
 -5.0097861e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 0 4 1 3] pred: [-3.3433596e-04 -1.5166651e-03  9.9735081e-01 -2.4786973e-02
 -6.5659883e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [ 0.01477017  0.97651327  0.99450636  0.01291145 -0.01663429]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [-6.4207322e-04  8.4341246e-01  9.6659654e-01 -2.1021666e-02
 -6.8153744e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 0 4 1] pred: [ 0.00330331 -0.04176337  0.9909077   0.01395141 -0.00942398]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [ 0.01181806  0.9757418   0.9958177   0.00439444 -0.00927508]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 0 4 1] pred: [ 0.00635796 -0.06100336  0.9967403   0.00882456 -0.00501267]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 4 0 3 1] pred: [-4.3295042e-04 -3.8864680e-02  9.9900544e-01 -6.7068795e-03
  3.9579943e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [ 0.01412244  0.9527161   0.9990897   0.01666396 -0.0171165 ]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 0 4 1] pred: [ 1.5244649e-03 -2.2810174e-03  9.9863017e-01  5.3908415e-03
  4.7860874e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [ 0.01524383  0.97652197  0.9993679  -0.03972178 -0.00653387]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [ 0.15646887  0.52795434  0.21066856  0.00258677 -0.00277059]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 0 4 3 1] pred: [ 0.00741902 -0.10290227  0.9879765  -0.00585304  0.00320976]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 0 4 1] pred: [ 0.0064706  -0.0284764   0.9944754   0.00701889 -0.00501687]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 2 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:20 - loss: 1.2756 - accuracy: 0.3359 2/11 [====>.........................] - ETA: 1s - loss: 1.2865 - accuracy: 0.3281   3/11 [=======>......................] - ETA: 1s - loss: 1.2920 - accuracy: 0.3394 4/11 [=========>....................] - ETA: 1s - loss: 1.2920 - accuracy: 0.3507 5/11 [============>.................] - ETA: 1s - loss: 1.2893 - accuracy: 0.3609 6/11 [===============>..............] - ETA: 0s - loss: 1.2861 - accuracy: 0.3693 7/11 [==================>...........] - ETA: 0s - loss: 1.2828 - accuracy: 0.3760 8/11 [====================>.........] - ETA: 0s - loss: 1.2806 - accuracy: 0.3823 9/11 [=======================>......] - ETA: 0s - loss: 1.2782 - accuracy: 0.387810/11 [==========================>...] - ETA: 0s - loss: 1.2756 - accuracy: 0.392911/11 [==============================] - ETA: 0s - loss: 1.2734 - accuracy: 0.397011/11 [==============================] - 10s 162ms/step - loss: 1.2715 - accuracy: 0.4004
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 1.1568 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 1.1743 - accuracy: 0.5059 3/11 [=======>......................] - ETA: 1s - loss: 1.1903 - accuracy: 0.4857 4/11 [=========>....................] - ETA: 1s - loss: 1.1947 - accuracy: 0.4766 5/11 [============>.................] - ETA: 1s - loss: 1.1960 - accuracy: 0.4706 6/11 [===============>..............] - ETA: 0s - loss: 1.1945 - accuracy: 0.4690 7/11 [==================>...........] - ETA: 0s - loss: 1.1928 - accuracy: 0.4675 8/11 [====================>.........] - ETA: 0s - loss: 1.1907 - accuracy: 0.4659 9/11 [=======================>......] - ETA: 0s - loss: 1.1881 - accuracy: 0.465110/11 [==========================>...] - ETA: 0s - loss: 1.1853 - accuracy: 0.464911/11 [==============================] - ETA: 0s - loss: 1.1822 - accuracy: 0.464911/11 [==============================] - 2s 167ms/step - loss: 1.1797 - accuracy: 0.4648
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 1.0518 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 1.0514 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 1s - loss: 1.0476 - accuracy: 0.4753 4/11 [=========>....................] - ETA: 1s - loss: 1.0499 - accuracy: 0.4688 5/11 [============>.................] - ETA: 0s - loss: 1.0463 - accuracy: 0.4684 6/11 [===============>..............] - ETA: 0s - loss: 1.0403 - accuracy: 0.4702 7/11 [==================>...........] - ETA: 0s - loss: 1.0357 - accuracy: 0.4703 8/11 [====================>.........] - ETA: 0s - loss: 1.0311 - accuracy: 0.4703 9/11 [=======================>......] - ETA: 0s - loss: 1.0265 - accuracy: 0.470010/11 [==========================>...] - ETA: 0s - loss: 1.0220 - accuracy: 0.469611/11 [==============================] - ETA: 0s - loss: 1.0179 - accuracy: 0.469011/11 [==============================] - 2s 161ms/step - loss: 1.0145 - accuracy: 0.4685
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8262 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.8016 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 1s - loss: 0.8018 - accuracy: 0.5130 4/11 [=========>....................] - ETA: 1s - loss: 0.8045 - accuracy: 0.5103 5/11 [============>.................] - ETA: 1s - loss: 0.8092 - accuracy: 0.5051 6/11 [===============>..............] - ETA: 0s - loss: 0.8138 - accuracy: 0.4992 7/11 [==================>...........] - ETA: 0s - loss: 0.8184 - accuracy: 0.4938 8/11 [====================>.........] - ETA: 0s - loss: 0.8195 - accuracy: 0.4908 9/11 [=======================>......] - ETA: 0s - loss: 0.8205 - accuracy: 0.488510/11 [==========================>...] - ETA: 0s - loss: 0.8211 - accuracy: 0.486411/11 [==============================] - ETA: 0s - loss: 0.8218 - accuracy: 0.484311/11 [==============================] - 2s 176ms/step - loss: 0.8224 - accuracy: 0.4826
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7013 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.7251 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 1s - loss: 0.7333 - accuracy: 0.5182 4/11 [=========>....................] - ETA: 1s - loss: 0.7478 - accuracy: 0.5083 5/11 [============>.................] - ETA: 0s - loss: 0.7555 - accuracy: 0.5026 6/11 [===============>..............] - ETA: 0s - loss: 0.7587 - accuracy: 0.4991 7/11 [==================>...........] - ETA: 0s - loss: 0.7602 - accuracy: 0.4959 8/11 [====================>.........] - ETA: 0s - loss: 0.7616 - accuracy: 0.4926 9/11 [=======================>......] - ETA: 0s - loss: 0.7633 - accuracy: 0.490010/11 [==========================>...] - ETA: 0s - loss: 0.7651 - accuracy: 0.487811/11 [==============================] - ETA: 0s - loss: 0.7672 - accuracy: 0.485811/11 [==============================] - 2s 172ms/step - loss: 0.7690 - accuracy: 0.4840
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7968 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.7821 - accuracy: 0.5020 3/11 [=======>......................] - ETA: 1s - loss: 0.7782 - accuracy: 0.5004 4/11 [=========>....................] - ETA: 1s - loss: 0.7829 - accuracy: 0.4920 5/11 [============>.................] - ETA: 1s - loss: 0.7884 - accuracy: 0.4842 6/11 [===============>..............] - ETA: 0s - loss: 0.7894 - accuracy: 0.4793 7/11 [==================>...........] - ETA: 0s - loss: 0.7912 - accuracy: 0.4746 8/11 [====================>.........] - ETA: 0s - loss: 0.7916 - accuracy: 0.4721 9/11 [=======================>......] - ETA: 0s - loss: 0.7917 - accuracy: 0.470310/11 [==========================>...] - ETA: 0s - loss: 0.7905 - accuracy: 0.469911/11 [==============================] - ETA: 0s - loss: 0.7887 - accuracy: 0.469911/11 [==============================] - 2s 174ms/step - loss: 0.7873 - accuracy: 0.4699
Epoch 7/20
 1/11 [=>............................] - ETA: 2s - loss: 0.7406 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.7312 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 1s - loss: 0.7344 - accuracy: 0.4957 4/11 [=========>....................] - ETA: 1s - loss: 0.7399 - accuracy: 0.4880 5/11 [============>.................] - ETA: 1s - loss: 0.7395 - accuracy: 0.4854 6/11 [===============>..............] - ETA: 1s - loss: 0.7417 - accuracy: 0.4817 7/11 [==================>...........] - ETA: 0s - loss: 0.7440 - accuracy: 0.4792 8/11 [====================>.........] - ETA: 0s - loss: 0.7453 - accuracy: 0.4779 9/11 [=======================>......] - ETA: 0s - loss: 0.7473 - accuracy: 0.476510/11 [==========================>...] - ETA: 0s - loss: 0.7485 - accuracy: 0.476211/11 [==============================] - ETA: 0s - loss: 0.7485 - accuracy: 0.476611/11 [==============================] - 2s 191ms/step - loss: 0.7486 - accuracy: 0.4769
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8275 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.7995 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 1s - loss: 0.7930 - accuracy: 0.4835 4/11 [=========>....................] - ETA: 1s - loss: 0.7811 - accuracy: 0.4842 5/11 [============>.................] - ETA: 1s - loss: 0.7716 - accuracy: 0.4830 6/11 [===============>..............] - ETA: 1s - loss: 0.7658 - accuracy: 0.4811 7/11 [==================>...........] - ETA: 0s - loss: 0.7590 - accuracy: 0.4825 8/11 [====================>.........] - ETA: 0s - loss: 0.7540 - accuracy: 0.4838 9/11 [=======================>......] - ETA: 0s - loss: 0.7505 - accuracy: 0.484910/11 [==========================>...] - ETA: 0s - loss: 0.7473 - accuracy: 0.485711/11 [==============================] - ETA: 0s - loss: 0.7453 - accuracy: 0.486011/11 [==============================] - 2s 213ms/step - loss: 0.7436 - accuracy: 0.4862
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6774 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.6926 - accuracy: 0.5098 3/11 [=======>......................] - ETA: 1s - loss: 0.7007 - accuracy: 0.4987 4/11 [=========>....................] - ETA: 1s - loss: 0.7050 - accuracy: 0.4976 5/11 [============>.................] - ETA: 1s - loss: 0.7075 - accuracy: 0.4977 6/11 [===============>..............] - ETA: 0s - loss: 0.7074 - accuracy: 0.4977 7/11 [==================>...........] - ETA: 0s - loss: 0.7076 - accuracy: 0.4977 8/11 [====================>.........] - ETA: 0s - loss: 0.7074 - accuracy: 0.4972 9/11 [=======================>......] - ETA: 0s - loss: 0.7080 - accuracy: 0.496410/11 [==========================>...] - ETA: 0s - loss: 0.7079 - accuracy: 0.495811/11 [==============================] - ETA: 0s - loss: 0.7077 - accuracy: 0.495111/11 [==============================] - 2s 166ms/step - loss: 0.7076 - accuracy: 0.4946
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8111 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.7763 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 1s - loss: 0.7515 - accuracy: 0.4540 4/11 [=========>....................] - ETA: 0s - loss: 0.7363 - accuracy: 0.4601 5/11 [============>.................] - ETA: 0s - loss: 0.7234 - accuracy: 0.4659 6/11 [===============>..............] - ETA: 0s - loss: 0.7161 - accuracy: 0.4703 7/11 [==================>...........] - ETA: 0s - loss: 0.7104 - accuracy: 0.4744 8/11 [====================>.........] - ETA: 0s - loss: 0.7064 - accuracy: 0.4766 9/11 [=======================>......] - ETA: 0s - loss: 0.7035 - accuracy: 0.478210/11 [==========================>...] - ETA: 0s - loss: 0.7015 - accuracy: 0.479311/11 [==============================] - ETA: 0s - loss: 0.6998 - accuracy: 0.480411/11 [==============================] - 2s 174ms/step - loss: 0.6984 - accuracy: 0.4813
Epoch 11/20
 1/11 [=>............................] - ETA: 2s - loss: 0.6652 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.6741 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 1s - loss: 0.6804 - accuracy: 0.4983 4/11 [=========>....................] - ETA: 1s - loss: 0.6819 - accuracy: 0.4972 5/11 [============>.................] - ETA: 0s - loss: 0.6793 - accuracy: 0.4975 6/11 [===============>..............] - ETA: 0s - loss: 0.6783 - accuracy: 0.4977 7/11 [==================>...........] - ETA: 0s - loss: 0.6784 - accuracy: 0.4969 8/11 [====================>.........] - ETA: 0s - loss: 0.6788 - accuracy: 0.4964 9/11 [=======================>......] - ETA: 0s - loss: 0.6784 - accuracy: 0.495910/11 [==========================>...] - ETA: 0s - loss: 0.6774 - accuracy: 0.495711/11 [==============================] - ETA: 0s - loss: 0.6756 - accuracy: 0.495711/11 [==============================] - 2s 180ms/step - loss: 0.6741 - accuracy: 0.4956
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6941 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.6638 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 1s - loss: 0.6499 - accuracy: 0.5226 4/11 [=========>....................] - ETA: 1s - loss: 0.6498 - accuracy: 0.5199 5/11 [============>.................] - ETA: 0s - loss: 0.6486 - accuracy: 0.5184 6/11 [===============>..............] - ETA: 0s - loss: 0.6476 - accuracy: 0.5175 7/11 [==================>...........] - ETA: 0s - loss: 0.6466 - accuracy: 0.5158 8/11 [====================>.........] - ETA: 0s - loss: 0.6461 - accuracy: 0.5142 9/11 [=======================>......] - ETA: 0s - loss: 0.6459 - accuracy: 0.512410/11 [==========================>...] - ETA: 0s - loss: 0.6453 - accuracy: 0.511311/11 [==============================] - ETA: 0s - loss: 0.6442 - accuracy: 0.510411/11 [==============================] - 2s 173ms/step - loss: 0.6432 - accuracy: 0.5097
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5777 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 1s - loss: 0.6047 - accuracy: 0.5508 3/11 [=======>......................] - ETA: 1s - loss: 0.6120 - accuracy: 0.5347 4/11 [=========>....................] - ETA: 1s - loss: 0.6121 - accuracy: 0.5280 5/11 [============>.................] - ETA: 0s - loss: 0.6115 - accuracy: 0.5236 6/11 [===============>..............] - ETA: 0s - loss: 0.6102 - accuracy: 0.5225 7/11 [==================>...........] - ETA: 0s - loss: 0.6087 - accuracy: 0.5214 8/11 [====================>.........] - ETA: 0s - loss: 0.6082 - accuracy: 0.5198 9/11 [=======================>......] - ETA: 0s - loss: 0.6075 - accuracy: 0.518810/11 [==========================>...] - ETA: 0s - loss: 0.6071 - accuracy: 0.518311/11 [==============================] - ETA: 0s - loss: 0.6070 - accuracy: 0.517911/11 [==============================] - 2s 154ms/step - loss: 0.6070 - accuracy: 0.5176
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6495 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.6537 - accuracy: 0.5215 3/11 [=======>......................] - ETA: 1s - loss: 0.6429 - accuracy: 0.5282 4/11 [=========>....................] - ETA: 1s - loss: 0.6375 - accuracy: 0.5309 5/11 [============>.................] - ETA: 0s - loss: 0.6343 - accuracy: 0.5351 6/11 [===============>..............] - ETA: 0s - loss: 0.6322 - accuracy: 0.5381 7/11 [==================>...........] - ETA: 0s - loss: 0.6298 - accuracy: 0.5379 8/11 [====================>.........] - ETA: 0s - loss: 0.6260 - accuracy: 0.5384 9/11 [=======================>......] - ETA: 0s - loss: 0.6217 - accuracy: 0.539510/11 [==========================>...] - ETA: 0s - loss: 0.6186 - accuracy: 0.540411/11 [==============================] - ETA: 0s - loss: 0.6155 - accuracy: 0.540911/11 [==============================] - 2s 186ms/step - loss: 0.6130 - accuracy: 0.5413
Epoch 15/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5794 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.5949 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 1s - loss: 0.5885 - accuracy: 0.5234 4/11 [=========>....................] - ETA: 1s - loss: 0.5857 - accuracy: 0.5264 5/11 [============>.................] - ETA: 1s - loss: 0.5824 - accuracy: 0.5295 6/11 [===============>..............] - ETA: 1s - loss: 0.5811 - accuracy: 0.5298 7/11 [==================>...........] - ETA: 0s - loss: 0.5802 - accuracy: 0.5286 8/11 [====================>.........] - ETA: 0s - loss: 0.5782 - accuracy: 0.5294 9/11 [=======================>......] - ETA: 0s - loss: 0.5771 - accuracy: 0.530810/11 [==========================>...] - ETA: 0s - loss: 0.5759 - accuracy: 0.531711/11 [==============================] - ETA: 0s - loss: 0.5751 - accuracy: 0.532911/11 [==============================] - 2s 220ms/step - loss: 0.5745 - accuracy: 0.5338
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5109 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.5043 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 1s - loss: 0.5040 - accuracy: 0.5556 4/11 [=========>....................] - ETA: 1s - loss: 0.5102 - accuracy: 0.5549 5/11 [============>.................] - ETA: 1s - loss: 0.5135 - accuracy: 0.5520 6/11 [===============>..............] - ETA: 1s - loss: 0.5147 - accuracy: 0.5505 7/11 [==================>...........] - ETA: 0s - loss: 0.5181 - accuracy: 0.5498 8/11 [====================>.........] - ETA: 0s - loss: 0.5208 - accuracy: 0.5497 9/11 [=======================>......] - ETA: 0s - loss: 0.5229 - accuracy: 0.550310/11 [==========================>...] - ETA: 0s - loss: 0.5252 - accuracy: 0.551311/11 [==============================] - ETA: 0s - loss: 0.5269 - accuracy: 0.552211/11 [==============================] - 2s 209ms/step - loss: 0.5283 - accuracy: 0.5531
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5428 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 1s - loss: 0.5429 - accuracy: 0.5645 3/11 [=======>......................] - ETA: 1s - loss: 0.5389 - accuracy: 0.5647 4/11 [=========>....................] - ETA: 1s - loss: 0.5389 - accuracy: 0.5666 5/11 [============>.................] - ETA: 1s - loss: 0.5386 - accuracy: 0.5692 6/11 [===============>..............] - ETA: 0s - loss: 0.5389 - accuracy: 0.5709 7/11 [==================>...........] - ETA: 0s - loss: 0.5397 - accuracy: 0.5726 8/11 [====================>.........] - ETA: 0s - loss: 0.5392 - accuracy: 0.5728 9/11 [=======================>......] - ETA: 0s - loss: 0.5386 - accuracy: 0.573110/11 [==========================>...] - ETA: 0s - loss: 0.5376 - accuracy: 0.573011/11 [==============================] - ETA: 0s - loss: 0.5366 - accuracy: 0.572811/11 [==============================] - 2s 195ms/step - loss: 0.5357 - accuracy: 0.5726
Epoch 18/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5702 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 2s - loss: 0.5471 - accuracy: 0.5234 3/11 [=======>......................] - ETA: 1s - loss: 0.5321 - accuracy: 0.5278 4/11 [=========>....................] - ETA: 1s - loss: 0.5260 - accuracy: 0.5345 5/11 [============>.................] - ETA: 1s - loss: 0.5252 - accuracy: 0.5382 6/11 [===============>..............] - ETA: 1s - loss: 0.5244 - accuracy: 0.5423 7/11 [==================>...........] - ETA: 0s - loss: 0.5229 - accuracy: 0.5452 8/11 [====================>.........] - ETA: 0s - loss: 0.5225 - accuracy: 0.5473 9/11 [=======================>......] - ETA: 0s - loss: 0.5211 - accuracy: 0.549810/11 [==========================>...] - ETA: 0s - loss: 0.5202 - accuracy: 0.552111/11 [==============================] - ETA: 0s - loss: 0.5197 - accuracy: 0.554111/11 [==============================] - 2s 222ms/step - loss: 0.5192 - accuracy: 0.5558
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5375 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 2s - loss: 0.5301 - accuracy: 0.5449 3/11 [=======>......................] - ETA: 1s - loss: 0.5227 - accuracy: 0.5456 4/11 [=========>....................] - ETA: 1s - loss: 0.5157 - accuracy: 0.5522 5/11 [============>.................] - ETA: 1s - loss: 0.5130 - accuracy: 0.5555 6/11 [===============>..............] - ETA: 0s - loss: 0.5118 - accuracy: 0.5578 7/11 [==================>...........] - ETA: 0s - loss: 0.5096 - accuracy: 0.5599 8/11 [====================>.........] - ETA: 0s - loss: 0.5091 - accuracy: 0.5613 9/11 [=======================>......] - ETA: 0s - loss: 0.5083 - accuracy: 0.562910/11 [==========================>...] - ETA: 0s - loss: 0.5070 - accuracy: 0.564311/11 [==============================] - ETA: 0s - loss: 0.5063 - accuracy: 0.565111/11 [==============================] - 2s 197ms/step - loss: 0.5058 - accuracy: 0.5659
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5184 - accuracy: 0.6250 2/11 [====>.........................] - ETA: 2s - loss: 0.4971 - accuracy: 0.6152 3/11 [=======>......................] - ETA: 1s - loss: 0.5015 - accuracy: 0.6011 4/11 [=========>....................] - ETA: 1s - loss: 0.5037 - accuracy: 0.5949 5/11 [============>.................] - ETA: 1s - loss: 0.5038 - accuracy: 0.5903 6/11 [===============>..............] - ETA: 1s - loss: 0.5044 - accuracy: 0.5865 7/11 [==================>...........] - ETA: 0s - loss: 0.5054 - accuracy: 0.5852 8/11 [====================>.........] - ETA: 0s - loss: 0.5047 - accuracy: 0.5832 9/11 [=======================>......] - ETA: 0s - loss: 0.5033 - accuracy: 0.582110/11 [==========================>...] - ETA: 0s - loss: 0.5020 - accuracy: 0.581111/11 [==============================] - ETA: 0s - loss: 0.5007 - accuracy: 0.580511/11 [==============================] - 2s 205ms/step - loss: 0.4996 - accuracy: 0.5799
Evaluate on test data
1/6 [====>.........................] - ETA: 11s - loss: 0.5547 - accuracy: 0.50003/6 [==============>...............] - ETA: 0s - loss: 0.5377 - accuracy: 0.5703 5/6 [========================>.....] - ETA: 0s - loss: 0.5211 - accuracy: 0.58756/6 [==============================] - 2s 32ms/step - loss: 0.5278 - accuracy: 0.5878
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [-4.8227925e-03  3.7624508e-01  9.6933538e-01  4.8852231e-02
 -1.5940052e-05]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 2 1 0] pred: [0.00210949 0.0047908  0.01706668 0.13730589 0.09806588]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 4 3] pred: [ 2.3962767e-04  9.3712467e-01  9.9693650e-01 -9.3152719e-03
 -6.4339330e-03]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 4 3] pred: [ 0.09207691  0.3097962   0.20523052 -0.00042551  0.00150877]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [ 0.00861185  0.8132592   0.9995974  -0.00112784  0.00534045]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [-0.00637736  0.93331224  0.9940541   0.01626647 -0.01219661]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 0 4 1] pred: [-0.00681688 -0.04154216  0.99766606  0.00107927 -0.01479829]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 0 4 1] pred: [ 0.00353673 -0.06510464  0.9960442   0.00643676 -0.01352622]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [1 0 3 4 2] pred: [ 0.08302635  0.1536335  -0.3263517   0.00126888 -0.0024868 ]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [-0.01159962  0.81576717  0.9490182   0.02643956 -0.00817438]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 4 3] pred: [ 0.02028766  0.32997286  0.97791713 -0.00255255 -0.00217891]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [-0.00231275  0.9204635   0.989815    0.00230084 -0.01677496]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 0 4 3 1] pred: [-1.4541834e-04 -2.9859351e-02  9.9714810e-01 -6.5443679e-03
 -1.5662062e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 0 3] pred: [0.00733565 0.12059484 0.99622697 0.00197335 0.00763913]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 0 3 4] pred: [ 0.00508016  0.8444401   0.99284744  0.00437297 -0.00751437]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 3 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:15 - loss: 1.3078 - accuracy: 0.1328 2/11 [====>.........................] - ETA: 1s - loss: 1.3030 - accuracy: 0.2148   3/11 [=======>......................] - ETA: 1s - loss: 1.3014 - accuracy: 0.2622 4/11 [=========>....................] - ETA: 1s - loss: 1.2948 - accuracy: 0.2918 5/11 [============>.................] - ETA: 1s - loss: 1.2890 - accuracy: 0.3141 6/11 [===============>..............] - ETA: 1s - loss: 1.2843 - accuracy: 0.3303 7/11 [==================>...........] - ETA: 0s - loss: 1.2808 - accuracy: 0.3436 8/11 [====================>.........] - ETA: 0s - loss: 1.2778 - accuracy: 0.3536 9/11 [=======================>......] - ETA: 0s - loss: 1.2747 - accuracy: 0.362110/11 [==========================>...] - ETA: 0s - loss: 1.2715 - accuracy: 0.369311/11 [==============================] - ETA: 0s - loss: 1.2686 - accuracy: 0.375311/11 [==============================] - 10s 208ms/step - loss: 1.2662 - accuracy: 0.3802
Epoch 2/20
 1/11 [=>............................] - ETA: 2s - loss: 1.1996 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 1.1973 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 1s - loss: 1.1883 - accuracy: 0.4709 4/11 [=========>....................] - ETA: 1s - loss: 1.1788 - accuracy: 0.4772 5/11 [============>.................] - ETA: 1s - loss: 1.1728 - accuracy: 0.4783 6/11 [===============>..............] - ETA: 1s - loss: 1.1689 - accuracy: 0.4774 7/11 [==================>...........] - ETA: 0s - loss: 1.1649 - accuracy: 0.4770 8/11 [====================>.........] - ETA: 0s - loss: 1.1612 - accuracy: 0.4764 9/11 [=======================>......] - ETA: 0s - loss: 1.1577 - accuracy: 0.475910/11 [==========================>...] - ETA: 0s - loss: 1.1540 - accuracy: 0.475811/11 [==============================] - ETA: 0s - loss: 1.1507 - accuracy: 0.475511/11 [==============================] - 2s 195ms/step - loss: 1.1480 - accuracy: 0.4752
Epoch 3/20
 1/11 [=>............................] - ETA: 2s - loss: 1.0452 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 1.0259 - accuracy: 0.4590 3/11 [=======>......................] - ETA: 1s - loss: 1.0109 - accuracy: 0.4692 4/11 [=========>....................] - ETA: 1s - loss: 1.0073 - accuracy: 0.4691 5/11 [============>.................] - ETA: 1s - loss: 1.0019 - accuracy: 0.4699 6/11 [===============>..............] - ETA: 1s - loss: 0.9958 - accuracy: 0.4717 7/11 [==================>...........] - ETA: 0s - loss: 0.9892 - accuracy: 0.4735 8/11 [====================>.........] - ETA: 0s - loss: 0.9833 - accuracy: 0.4746 9/11 [=======================>......] - ETA: 0s - loss: 0.9780 - accuracy: 0.475410/11 [==========================>...] - ETA: 0s - loss: 0.9741 - accuracy: 0.475311/11 [==============================] - ETA: 0s - loss: 0.9701 - accuracy: 0.475011/11 [==============================] - 2s 218ms/step - loss: 0.9669 - accuracy: 0.4748
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8144 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.7863 - accuracy: 0.5254 3/11 [=======>......................] - ETA: 1s - loss: 0.7894 - accuracy: 0.5161 4/11 [=========>....................] - ETA: 1s - loss: 0.7840 - accuracy: 0.5155 5/11 [============>.................] - ETA: 1s - loss: 0.7820 - accuracy: 0.5136 6/11 [===============>..............] - ETA: 0s - loss: 0.7845 - accuracy: 0.5094 7/11 [==================>...........] - ETA: 0s - loss: 0.7856 - accuracy: 0.5068 8/11 [====================>.........] - ETA: 0s - loss: 0.7885 - accuracy: 0.5031 9/11 [=======================>......] - ETA: 0s - loss: 0.7896 - accuracy: 0.501110/11 [==========================>...] - ETA: 0s - loss: 0.7914 - accuracy: 0.498811/11 [==============================] - ETA: 0s - loss: 0.7935 - accuracy: 0.496311/11 [==============================] - 2s 194ms/step - loss: 0.7953 - accuracy: 0.4943
Epoch 5/20
 1/11 [=>............................] - ETA: 2s - loss: 0.8416 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 2s - loss: 0.8259 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 1s - loss: 0.8201 - accuracy: 0.4657 4/11 [=========>....................] - ETA: 1s - loss: 0.8220 - accuracy: 0.4660 5/11 [============>.................] - ETA: 1s - loss: 0.8213 - accuracy: 0.4662 6/11 [===============>..............] - ETA: 1s - loss: 0.8209 - accuracy: 0.4656 7/11 [==================>...........] - ETA: 0s - loss: 0.8187 - accuracy: 0.4662 8/11 [====================>.........] - ETA: 0s - loss: 0.8164 - accuracy: 0.4670 9/11 [=======================>......] - ETA: 0s - loss: 0.8147 - accuracy: 0.467510/11 [==========================>...] - ETA: 0s - loss: 0.8129 - accuracy: 0.467911/11 [==============================] - ETA: 0s - loss: 0.8111 - accuracy: 0.468311/11 [==============================] - 2s 202ms/step - loss: 0.8096 - accuracy: 0.4686
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7640 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.7842 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 1s - loss: 0.8034 - accuracy: 0.4614 4/11 [=========>....................] - ETA: 1s - loss: 0.8106 - accuracy: 0.4559 5/11 [============>.................] - ETA: 1s - loss: 0.8139 - accuracy: 0.4544 6/11 [===============>..............] - ETA: 0s - loss: 0.8151 - accuracy: 0.4538 7/11 [==================>...........] - ETA: 0s - loss: 0.8154 - accuracy: 0.4537 8/11 [====================>.........] - ETA: 0s - loss: 0.8138 - accuracy: 0.4549 9/11 [=======================>......] - ETA: 0s - loss: 0.8112 - accuracy: 0.456410/11 [==========================>...] - ETA: 0s - loss: 0.8093 - accuracy: 0.457411/11 [==============================] - ETA: 0s - loss: 0.8061 - accuracy: 0.459011/11 [==============================] - 2s 194ms/step - loss: 0.8035 - accuracy: 0.4603
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7457 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 2s - loss: 0.7844 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 1s - loss: 0.7793 - accuracy: 0.4874 4/11 [=========>....................] - ETA: 1s - loss: 0.7786 - accuracy: 0.4871 5/11 [============>.................] - ETA: 1s - loss: 0.7781 - accuracy: 0.4860 6/11 [===============>..............] - ETA: 1s - loss: 0.7768 - accuracy: 0.4846 7/11 [==================>...........] - ETA: 0s - loss: 0.7753 - accuracy: 0.4838 8/11 [====================>.........] - ETA: 0s - loss: 0.7749 - accuracy: 0.4829 9/11 [=======================>......] - ETA: 0s - loss: 0.7732 - accuracy: 0.482610/11 [==========================>...] - ETA: 0s - loss: 0.7719 - accuracy: 0.482411/11 [==============================] - ETA: 0s - loss: 0.7706 - accuracy: 0.482211/11 [==============================] - 2s 205ms/step - loss: 0.7696 - accuracy: 0.4821
Epoch 8/20
 1/11 [=>............................] - ETA: 2s - loss: 0.8469 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 1s - loss: 0.8174 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 1s - loss: 0.8091 - accuracy: 0.4505 4/11 [=========>....................] - ETA: 1s - loss: 0.8035 - accuracy: 0.4575 5/11 [============>.................] - ETA: 1s - loss: 0.7983 - accuracy: 0.4610 6/11 [===============>..............] - ETA: 1s - loss: 0.7929 - accuracy: 0.4627 7/11 [==================>...........] - ETA: 0s - loss: 0.7873 - accuracy: 0.4655 8/11 [====================>.........] - ETA: 0s - loss: 0.7825 - accuracy: 0.4684 9/11 [=======================>......] - ETA: 0s - loss: 0.7781 - accuracy: 0.470710/11 [==========================>...] - ETA: 0s - loss: 0.7746 - accuracy: 0.472211/11 [==============================] - ETA: 0s - loss: 0.7718 - accuracy: 0.473111/11 [==============================] - 2s 204ms/step - loss: 0.7694 - accuracy: 0.4738
Epoch 9/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5755 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 1s - loss: 0.6017 - accuracy: 0.6113 3/11 [=======>......................] - ETA: 2s - loss: 0.6205 - accuracy: 0.5881 4/11 [=========>....................] - ETA: 1s - loss: 0.6366 - accuracy: 0.5719 5/11 [============>.................] - ETA: 1s - loss: 0.6503 - accuracy: 0.5607 6/11 [===============>..............] - ETA: 1s - loss: 0.6609 - accuracy: 0.5516 7/11 [==================>...........] - ETA: 0s - loss: 0.6694 - accuracy: 0.5444 8/11 [====================>.........] - ETA: 0s - loss: 0.6762 - accuracy: 0.5384 9/11 [=======================>......] - ETA: 0s - loss: 0.6821 - accuracy: 0.532510/11 [==========================>...] - ETA: 0s - loss: 0.6860 - accuracy: 0.528511/11 [==============================] - ETA: 0s - loss: 0.6897 - accuracy: 0.524511/11 [==============================] - 2s 218ms/step - loss: 0.6927 - accuracy: 0.5211
Epoch 10/20
 1/11 [=>............................] - ETA: 2s - loss: 0.7138 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.7029 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 1s - loss: 0.6995 - accuracy: 0.5017 4/11 [=========>....................] - ETA: 1s - loss: 0.7011 - accuracy: 0.5028 5/11 [============>.................] - ETA: 1s - loss: 0.7016 - accuracy: 0.5016 6/11 [===============>..............] - ETA: 0s - loss: 0.7017 - accuracy: 0.5002 7/11 [==================>...........] - ETA: 0s - loss: 0.7030 - accuracy: 0.4992 8/11 [====================>.........] - ETA: 0s - loss: 0.7054 - accuracy: 0.4978 9/11 [=======================>......] - ETA: 0s - loss: 0.7058 - accuracy: 0.497610/11 [==========================>...] - ETA: 0s - loss: 0.7063 - accuracy: 0.497611/11 [==============================] - ETA: 0s - loss: 0.7067 - accuracy: 0.497411/11 [==============================] - 2s 193ms/step - loss: 0.7070 - accuracy: 0.4972
Epoch 11/20
 1/11 [=>............................] - ETA: 2s - loss: 0.7690 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 1s - loss: 0.7535 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 1s - loss: 0.7466 - accuracy: 0.4410 4/11 [=========>....................] - ETA: 1s - loss: 0.7424 - accuracy: 0.4479 5/11 [============>.................] - ETA: 1s - loss: 0.7399 - accuracy: 0.4521 6/11 [===============>..............] - ETA: 0s - loss: 0.7370 - accuracy: 0.4564 7/11 [==================>...........] - ETA: 0s - loss: 0.7337 - accuracy: 0.4607 8/11 [====================>.........] - ETA: 0s - loss: 0.7309 - accuracy: 0.4641 9/11 [=======================>......] - ETA: 0s - loss: 0.7276 - accuracy: 0.467410/11 [==========================>...] - ETA: 0s - loss: 0.7247 - accuracy: 0.469811/11 [==============================] - ETA: 0s - loss: 0.7220 - accuracy: 0.472411/11 [==============================] - 2s 185ms/step - loss: 0.7197 - accuracy: 0.4746
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7405 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.7199 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 1s - loss: 0.7164 - accuracy: 0.4991 4/11 [=========>....................] - ETA: 1s - loss: 0.7087 - accuracy: 0.5018 5/11 [============>.................] - ETA: 1s - loss: 0.7044 - accuracy: 0.5014 6/11 [===============>..............] - ETA: 0s - loss: 0.7023 - accuracy: 0.5021 7/11 [==================>...........] - ETA: 0s - loss: 0.7002 - accuracy: 0.5035 8/11 [====================>.........] - ETA: 0s - loss: 0.6978 - accuracy: 0.5034 9/11 [=======================>......] - ETA: 0s - loss: 0.6958 - accuracy: 0.503610/11 [==========================>...] - ETA: 0s - loss: 0.6945 - accuracy: 0.503311/11 [==============================] - ETA: 0s - loss: 0.6932 - accuracy: 0.503211/11 [==============================] - 2s 202ms/step - loss: 0.6921 - accuracy: 0.5032
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6667 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 1s - loss: 0.6649 - accuracy: 0.5430 3/11 [=======>......................] - ETA: 1s - loss: 0.6691 - accuracy: 0.5286 4/11 [=========>....................] - ETA: 1s - loss: 0.6703 - accuracy: 0.5234 5/11 [============>.................] - ETA: 1s - loss: 0.6728 - accuracy: 0.5197 6/11 [===============>..............] - ETA: 1s - loss: 0.6746 - accuracy: 0.5158 7/11 [==================>...........] - ETA: 0s - loss: 0.6766 - accuracy: 0.5132 8/11 [====================>.........] - ETA: 0s - loss: 0.6768 - accuracy: 0.5112 9/11 [=======================>......] - ETA: 0s - loss: 0.6759 - accuracy: 0.510410/11 [==========================>...] - ETA: 0s - loss: 0.6747 - accuracy: 0.510011/11 [==============================] - ETA: 0s - loss: 0.6738 - accuracy: 0.509611/11 [==============================] - 2s 216ms/step - loss: 0.6730 - accuracy: 0.5092
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5783 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 1s - loss: 0.5761 - accuracy: 0.5430 3/11 [=======>......................] - ETA: 1s - loss: 0.5882 - accuracy: 0.5399 4/11 [=========>....................] - ETA: 1s - loss: 0.5980 - accuracy: 0.5378 5/11 [============>.................] - ETA: 1s - loss: 0.6086 - accuracy: 0.5352 6/11 [===============>..............] - ETA: 1s - loss: 0.6163 - accuracy: 0.5328 7/11 [==================>...........] - ETA: 0s - loss: 0.6236 - accuracy: 0.5302 8/11 [====================>.........] - ETA: 0s - loss: 0.6277 - accuracy: 0.5274 9/11 [=======================>......] - ETA: 0s - loss: 0.6309 - accuracy: 0.525010/11 [==========================>...] - ETA: 0s - loss: 0.6331 - accuracy: 0.523411/11 [==============================] - ETA: 0s - loss: 0.6346 - accuracy: 0.522111/11 [==============================] - 2s 206ms/step - loss: 0.6358 - accuracy: 0.5211
Epoch 15/20
 1/11 [=>............................] - ETA: 2s - loss: 0.6075 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 2s - loss: 0.6005 - accuracy: 0.5645 3/11 [=======>......................] - ETA: 1s - loss: 0.6020 - accuracy: 0.5595 4/11 [=========>....................] - ETA: 1s - loss: 0.6043 - accuracy: 0.5539 5/11 [============>.................] - ETA: 1s - loss: 0.6062 - accuracy: 0.5487 6/11 [===============>..............] - ETA: 0s - loss: 0.6070 - accuracy: 0.5462 7/11 [==================>...........] - ETA: 0s - loss: 0.6082 - accuracy: 0.5428 8/11 [====================>.........] - ETA: 0s - loss: 0.6102 - accuracy: 0.5394 9/11 [=======================>......] - ETA: 0s - loss: 0.6114 - accuracy: 0.537310/11 [==========================>...] - ETA: 0s - loss: 0.6135 - accuracy: 0.535211/11 [==============================] - ETA: 0s - loss: 0.6150 - accuracy: 0.533011/11 [==============================] - 2s 201ms/step - loss: 0.6162 - accuracy: 0.5313
Epoch 16/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5854 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.5784 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 1s - loss: 0.5853 - accuracy: 0.5347 4/11 [=========>....................] - ETA: 1s - loss: 0.5904 - accuracy: 0.5319 5/11 [============>.................] - ETA: 1s - loss: 0.5945 - accuracy: 0.5271 6/11 [===============>..............] - ETA: 0s - loss: 0.5972 - accuracy: 0.5234 7/11 [==================>...........] - ETA: 0s - loss: 0.6004 - accuracy: 0.5202 8/11 [====================>.........] - ETA: 0s - loss: 0.6019 - accuracy: 0.5189 9/11 [=======================>......] - ETA: 0s - loss: 0.6033 - accuracy: 0.518710/11 [==========================>...] - ETA: 0s - loss: 0.6043 - accuracy: 0.518211/11 [==============================] - ETA: 0s - loss: 0.6048 - accuracy: 0.518011/11 [==============================] - 2s 179ms/step - loss: 0.6053 - accuracy: 0.5179
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6108 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.6005 - accuracy: 0.5020 3/11 [=======>......................] - ETA: 1s - loss: 0.5929 - accuracy: 0.5082 4/11 [=========>....................] - ETA: 1s - loss: 0.5878 - accuracy: 0.5111 5/11 [============>.................] - ETA: 1s - loss: 0.5832 - accuracy: 0.5164 6/11 [===============>..............] - ETA: 0s - loss: 0.5834 - accuracy: 0.5197 7/11 [==================>...........] - ETA: 0s - loss: 0.5826 - accuracy: 0.5217 8/11 [====================>.........] - ETA: 0s - loss: 0.5828 - accuracy: 0.5231 9/11 [=======================>......] - ETA: 0s - loss: 0.5824 - accuracy: 0.524410/11 [==========================>...] - ETA: 0s - loss: 0.5827 - accuracy: 0.524611/11 [==============================] - ETA: 0s - loss: 0.5832 - accuracy: 0.524811/11 [==============================] - 2s 182ms/step - loss: 0.5836 - accuracy: 0.5249
Epoch 18/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5838 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 2s - loss: 0.5794 - accuracy: 0.5664 3/11 [=======>......................] - ETA: 1s - loss: 0.5692 - accuracy: 0.5642 4/11 [=========>....................] - ETA: 1s - loss: 0.5669 - accuracy: 0.5609 5/11 [============>.................] - ETA: 1s - loss: 0.5680 - accuracy: 0.5571 6/11 [===============>..............] - ETA: 1s - loss: 0.5690 - accuracy: 0.5530 7/11 [==================>...........] - ETA: 0s - loss: 0.5685 - accuracy: 0.5493 8/11 [====================>.........] - ETA: 0s - loss: 0.5670 - accuracy: 0.5468 9/11 [=======================>......] - ETA: 0s - loss: 0.5662 - accuracy: 0.545210/11 [==========================>...] - ETA: 0s - loss: 0.5659 - accuracy: 0.544511/11 [==============================] - ETA: 0s - loss: 0.5660 - accuracy: 0.543411/11 [==============================] - 2s 200ms/step - loss: 0.5660 - accuracy: 0.5425
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5772 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.5714 - accuracy: 0.5176 3/11 [=======>......................] - ETA: 1s - loss: 0.5655 - accuracy: 0.5178 4/11 [=========>....................] - ETA: 1s - loss: 0.5634 - accuracy: 0.5202 5/11 [============>.................] - ETA: 1s - loss: 0.5608 - accuracy: 0.5252 6/11 [===============>..............] - ETA: 1s - loss: 0.5599 - accuracy: 0.5295 7/11 [==================>...........] - ETA: 0s - loss: 0.5596 - accuracy: 0.5323 8/11 [====================>.........] - ETA: 0s - loss: 0.5581 - accuracy: 0.5332 9/11 [=======================>......] - ETA: 0s - loss: 0.5570 - accuracy: 0.534310/11 [==========================>...] - ETA: 0s - loss: 0.5558 - accuracy: 0.535311/11 [==============================] - ETA: 0s - loss: 0.5550 - accuracy: 0.535911/11 [==============================] - 2s 204ms/step - loss: 0.5543 - accuracy: 0.5365
Epoch 20/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5110 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.5101 - accuracy: 0.5059 3/11 [=======>......................] - ETA: 1s - loss: 0.5053 - accuracy: 0.5082 4/11 [=========>....................] - ETA: 1s - loss: 0.5094 - accuracy: 0.5164 5/11 [============>.................] - ETA: 1s - loss: 0.5140 - accuracy: 0.5207 6/11 [===============>..............] - ETA: 1s - loss: 0.5169 - accuracy: 0.5239 7/11 [==================>...........] - ETA: 0s - loss: 0.5182 - accuracy: 0.5267 8/11 [====================>.........] - ETA: 0s - loss: 0.5202 - accuracy: 0.5307 9/11 [=======================>......] - ETA: 0s - loss: 0.5218 - accuracy: 0.532510/11 [==========================>...] - ETA: 0s - loss: 0.5222 - accuracy: 0.533911/11 [==============================] - ETA: 0s - loss: 0.5227 - accuracy: 0.535211/11 [==============================] - 2s 202ms/step - loss: 0.5231 - accuracy: 0.5364
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.5840 - accuracy: 0.49223/6 [==============>...............] - ETA: 0s - loss: 0.5688 - accuracy: 0.5208 5/6 [========================>.....] - ETA: 0s - loss: 0.5750 - accuracy: 0.50476/6 [==============================] - 3s 32ms/step - loss: 0.5715 - accuracy: 0.5014
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 4 3] pred: [-0.00150069  0.8886501   0.99193656 -0.00431468 -0.00266527]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [4 3 0 1 2] pred: [-0.00950601 -0.13906735 -0.14919624  0.07192673  0.08993242]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 0 4 3 1] pred: [ 0.01123765 -0.09278045  0.98939437  0.00441946  0.00475254]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [-0.0052522   0.9178835   0.99884266 -0.00231267 -0.00995481]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [4 3 0 2 1] pred: [ 0.00377572 -0.16693237 -0.09949698  0.04684027  0.07545382]
 Top predictions indices: [4 3] vs. real classes indices: [3 4]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [4 3 0 2 1] pred: [ 0.00659612 -0.1989237  -0.06351609  0.04428721  0.07385658]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 0 4 1] pred: [ 0.01741946 -0.3139827   0.9918379   0.02148781 -0.00419715]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 0 3] pred: [-9.2194293e-04  6.5683466e-01  9.9279982e-01 -8.3761094e-03
  2.9340289e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [-4.1115433e-03  6.2714629e-02  9.9152392e-01  4.0076952e-04
 -1.1066758e-02]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [3 0 4 2 1] pred: [ 0.00986321 -0.09061215 -0.02013928  0.11068637  0.00420998]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [1 0 3 4 2] pred: [ 4.9611706e-02  2.9135382e-01 -5.0315354e-02 -1.6767997e-04
 -2.1233615e-03]
 Top predictions indices: [1] vs. real classes indices: [0]
Jaccard Score:  0.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 4 0] pred: [-0.00885833  0.790259    0.93298465 -0.00566297 -0.00613357]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [-0.00346872  0.16744003  0.9974052  -0.00187984 -0.0159421 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 3 0] pred: [-5.8058528e-03  9.1720891e-01  9.9207383e-01 -3.6118890e-03
 -4.7571349e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [-0.0303092   0.9619765   0.9989904  -0.01338315 -0.02225463]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 4 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:15 - loss: 1.2852 - accuracy: 0.0469 2/11 [====>.........................] - ETA: 1s - loss: 1.2938 - accuracy: 0.0566   3/11 [=======>......................] - ETA: 1s - loss: 1.2912 - accuracy: 0.0959 4/11 [=========>....................] - ETA: 1s - loss: 1.2893 - accuracy: 0.1330 5/11 [============>.................] - ETA: 0s - loss: 1.2863 - accuracy: 0.1626 6/11 [===============>..............] - ETA: 0s - loss: 1.2834 - accuracy: 0.1880 7/11 [==================>...........] - ETA: 0s - loss: 1.2816 - accuracy: 0.2073 8/11 [====================>.........] - ETA: 0s - loss: 1.2793 - accuracy: 0.2241 9/11 [=======================>......] - ETA: 0s - loss: 1.2772 - accuracy: 0.238510/11 [==========================>...] - ETA: 0s - loss: 1.2749 - accuracy: 0.252211/11 [==============================] - ETA: 0s - loss: 1.2728 - accuracy: 0.263811/11 [==============================] - 9s 135ms/step - loss: 1.2710 - accuracy: 0.2735
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 1.2185 - accuracy: 0.3828 2/11 [====>.........................] - ETA: 1s - loss: 1.2095 - accuracy: 0.3965 3/11 [=======>......................] - ETA: 1s - loss: 1.2079 - accuracy: 0.4023 4/11 [=========>....................] - ETA: 0s - loss: 1.2034 - accuracy: 0.4102 5/11 [============>.................] - ETA: 0s - loss: 1.2010 - accuracy: 0.4156 6/11 [===============>..............] - ETA: 0s - loss: 1.1977 - accuracy: 0.4201 7/11 [==================>...........] - ETA: 0s - loss: 1.1946 - accuracy: 0.4237 8/11 [====================>.........] - ETA: 0s - loss: 1.1919 - accuracy: 0.4266 9/11 [=======================>......] - ETA: 0s - loss: 1.1891 - accuracy: 0.429210/11 [==========================>...] - ETA: 0s - loss: 1.1865 - accuracy: 0.431111/11 [==============================] - ETA: 0s - loss: 1.1838 - accuracy: 0.433111/11 [==============================] - 2s 138ms/step - loss: 1.1815 - accuracy: 0.4348
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 1.0783 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 1.0872 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 1s - loss: 1.0831 - accuracy: 0.4470 4/11 [=========>....................] - ETA: 1s - loss: 1.0792 - accuracy: 0.4476 5/11 [============>.................] - ETA: 0s - loss: 1.0735 - accuracy: 0.4503 6/11 [===============>..............] - ETA: 0s - loss: 1.0690 - accuracy: 0.4514 7/11 [==================>...........] - ETA: 0s - loss: 1.0655 - accuracy: 0.4516 8/11 [====================>.........] - ETA: 0s - loss: 1.0621 - accuracy: 0.4516 9/11 [=======================>......] - ETA: 0s - loss: 1.0587 - accuracy: 0.451510/11 [==========================>...] - ETA: 0s - loss: 1.0553 - accuracy: 0.451111/11 [==============================] - ETA: 0s - loss: 1.0514 - accuracy: 0.451211/11 [==============================] - 2s 137ms/step - loss: 1.0481 - accuracy: 0.4513
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.9018 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 0s - loss: 0.9045 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 0s - loss: 0.8907 - accuracy: 0.4696 4/11 [=========>....................] - ETA: 0s - loss: 0.8863 - accuracy: 0.4689 5/11 [============>.................] - ETA: 0s - loss: 0.8813 - accuracy: 0.4676 6/11 [===============>..............] - ETA: 0s - loss: 0.8766 - accuracy: 0.4669 7/11 [==================>...........] - ETA: 0s - loss: 0.8764 - accuracy: 0.4642 8/11 [====================>.........] - ETA: 0s - loss: 0.8752 - accuracy: 0.4622 9/11 [=======================>......] - ETA: 0s - loss: 0.8745 - accuracy: 0.460310/11 [==========================>...] - ETA: 0s - loss: 0.8730 - accuracy: 0.459111/11 [==============================] - ETA: 0s - loss: 0.8714 - accuracy: 0.458511/11 [==============================] - 1s 129ms/step - loss: 0.8701 - accuracy: 0.4580
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7806 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.7740 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 1s - loss: 0.7701 - accuracy: 0.4957 4/11 [=========>....................] - ETA: 0s - loss: 0.7690 - accuracy: 0.4963 5/11 [============>.................] - ETA: 0s - loss: 0.7692 - accuracy: 0.4961 6/11 [===============>..............] - ETA: 0s - loss: 0.7728 - accuracy: 0.4935 7/11 [==================>...........] - ETA: 0s - loss: 0.7768 - accuracy: 0.4912 8/11 [====================>.........] - ETA: 0s - loss: 0.7784 - accuracy: 0.4902 9/11 [=======================>......] - ETA: 0s - loss: 0.7809 - accuracy: 0.488310/11 [==========================>...] - ETA: 0s - loss: 0.7835 - accuracy: 0.486111/11 [==============================] - ETA: 0s - loss: 0.7863 - accuracy: 0.483311/11 [==============================] - 2s 135ms/step - loss: 0.7886 - accuracy: 0.4810
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7672 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.7342 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 1s - loss: 0.7377 - accuracy: 0.4701 4/11 [=========>....................] - ETA: 0s - loss: 0.7490 - accuracy: 0.4683 5/11 [============>.................] - ETA: 0s - loss: 0.7610 - accuracy: 0.4637 6/11 [===============>..............] - ETA: 0s - loss: 0.7679 - accuracy: 0.4621 7/11 [==================>...........] - ETA: 0s - loss: 0.7715 - accuracy: 0.4621 8/11 [====================>.........] - ETA: 0s - loss: 0.7762 - accuracy: 0.4606 9/11 [=======================>......] - ETA: 0s - loss: 0.7798 - accuracy: 0.459610/11 [==========================>...] - ETA: 0s - loss: 0.7814 - accuracy: 0.459111/11 [==============================] - ETA: 0s - loss: 0.7827 - accuracy: 0.458911/11 [==============================] - 2s 138ms/step - loss: 0.7838 - accuracy: 0.4587
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7377 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 0s - loss: 0.7514 - accuracy: 0.4844 3/11 [=======>......................] - ETA: 0s - loss: 0.7391 - accuracy: 0.4948 4/11 [=========>....................] - ETA: 0s - loss: 0.7302 - accuracy: 0.4976 5/11 [============>.................] - ETA: 0s - loss: 0.7333 - accuracy: 0.4952 6/11 [===============>..............] - ETA: 0s - loss: 0.7401 - accuracy: 0.4913 7/11 [==================>...........] - ETA: 0s - loss: 0.7439 - accuracy: 0.4885 8/11 [====================>.........] - ETA: 0s - loss: 0.7466 - accuracy: 0.4865 9/11 [=======================>......] - ETA: 0s - loss: 0.7496 - accuracy: 0.484410/11 [==========================>...] - ETA: 0s - loss: 0.7520 - accuracy: 0.481911/11 [==============================] - ETA: 0s - loss: 0.7539 - accuracy: 0.479911/11 [==============================] - 1s 131ms/step - loss: 0.7554 - accuracy: 0.4782
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7267 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.7317 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 1s - loss: 0.7391 - accuracy: 0.4705 4/11 [=========>....................] - ETA: 1s - loss: 0.7438 - accuracy: 0.4686 5/11 [============>.................] - ETA: 1s - loss: 0.7457 - accuracy: 0.4680 6/11 [===============>..............] - ETA: 0s - loss: 0.7477 - accuracy: 0.4673 7/11 [==================>...........] - ETA: 0s - loss: 0.7489 - accuracy: 0.4678 8/11 [====================>.........] - ETA: 0s - loss: 0.7484 - accuracy: 0.4688 9/11 [=======================>......] - ETA: 0s - loss: 0.7489 - accuracy: 0.469210/11 [==========================>...] - ETA: 0s - loss: 0.7491 - accuracy: 0.470111/11 [==============================] - ETA: 0s - loss: 0.7497 - accuracy: 0.470211/11 [==============================] - 2s 166ms/step - loss: 0.7501 - accuracy: 0.4703
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7462 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.7536 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 1s - loss: 0.7551 - accuracy: 0.4557 4/11 [=========>....................] - ETA: 0s - loss: 0.7540 - accuracy: 0.4604 5/11 [============>.................] - ETA: 0s - loss: 0.7527 - accuracy: 0.4643 6/11 [===============>..............] - ETA: 0s - loss: 0.7494 - accuracy: 0.4685 7/11 [==================>...........] - ETA: 0s - loss: 0.7470 - accuracy: 0.4706 8/11 [====================>.........] - ETA: 0s - loss: 0.7449 - accuracy: 0.4718 9/11 [=======================>......] - ETA: 0s - loss: 0.7447 - accuracy: 0.472210/11 [==========================>...] - ETA: 0s - loss: 0.7443 - accuracy: 0.472311/11 [==============================] - ETA: 0s - loss: 0.7438 - accuracy: 0.472611/11 [==============================] - 1s 130ms/step - loss: 0.7434 - accuracy: 0.4729
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7860 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 1s - loss: 0.7666 - accuracy: 0.4277 3/11 [=======>......................] - ETA: 1s - loss: 0.7532 - accuracy: 0.4397 4/11 [=========>....................] - ETA: 1s - loss: 0.7538 - accuracy: 0.4445 5/11 [============>.................] - ETA: 0s - loss: 0.7515 - accuracy: 0.4490 6/11 [===============>..............] - ETA: 0s - loss: 0.7500 - accuracy: 0.4506 7/11 [==================>...........] - ETA: 0s - loss: 0.7466 - accuracy: 0.4532 8/11 [====================>.........] - ETA: 0s - loss: 0.7435 - accuracy: 0.4554 9/11 [=======================>......] - ETA: 0s - loss: 0.7404 - accuracy: 0.457610/11 [==========================>...] - ETA: 0s - loss: 0.7383 - accuracy: 0.459211/11 [==============================] - ETA: 0s - loss: 0.7369 - accuracy: 0.460711/11 [==============================] - 2s 153ms/step - loss: 0.7357 - accuracy: 0.4620
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7356 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.7228 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 1s - loss: 0.7118 - accuracy: 0.4805 4/11 [=========>....................] - ETA: 1s - loss: 0.7099 - accuracy: 0.4795 5/11 [============>.................] - ETA: 0s - loss: 0.7088 - accuracy: 0.4795 6/11 [===============>..............] - ETA: 0s - loss: 0.7066 - accuracy: 0.4803 7/11 [==================>...........] - ETA: 0s - loss: 0.7060 - accuracy: 0.4808 8/11 [====================>.........] - ETA: 0s - loss: 0.7049 - accuracy: 0.4822 9/11 [=======================>......] - ETA: 0s - loss: 0.7041 - accuracy: 0.482710/11 [==========================>...] - ETA: 0s - loss: 0.7039 - accuracy: 0.482711/11 [==============================] - ETA: 0s - loss: 0.7041 - accuracy: 0.482311/11 [==============================] - 2s 140ms/step - loss: 0.7042 - accuracy: 0.4820
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6345 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.6571 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 1s - loss: 0.6734 - accuracy: 0.4701 4/11 [=========>....................] - ETA: 1s - loss: 0.6830 - accuracy: 0.4658 5/11 [============>.................] - ETA: 0s - loss: 0.6839 - accuracy: 0.4667 6/11 [===============>..............] - ETA: 0s - loss: 0.6848 - accuracy: 0.4675 7/11 [==================>...........] - ETA: 0s - loss: 0.6856 - accuracy: 0.4689 8/11 [====================>.........] - ETA: 0s - loss: 0.6867 - accuracy: 0.4698 9/11 [=======================>......] - ETA: 0s - loss: 0.6875 - accuracy: 0.470610/11 [==========================>...] - ETA: 0s - loss: 0.6877 - accuracy: 0.471811/11 [==============================] - ETA: 0s - loss: 0.6875 - accuracy: 0.472811/11 [==============================] - 2s 145ms/step - loss: 0.6873 - accuracy: 0.4737
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6392 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.6579 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 1s - loss: 0.6623 - accuracy: 0.5095 4/11 [=========>....................] - ETA: 1s - loss: 0.6642 - accuracy: 0.5062 5/11 [============>.................] - ETA: 0s - loss: 0.6642 - accuracy: 0.5046 6/11 [===============>..............] - ETA: 0s - loss: 0.6639 - accuracy: 0.5041 7/11 [==================>...........] - ETA: 0s - loss: 0.6648 - accuracy: 0.5013 8/11 [====================>.........] - ETA: 0s - loss: 0.6654 - accuracy: 0.4993 9/11 [=======================>......] - ETA: 0s - loss: 0.6661 - accuracy: 0.497110/11 [==========================>...] - ETA: 0s - loss: 0.6659 - accuracy: 0.496211/11 [==============================] - ETA: 0s - loss: 0.6657 - accuracy: 0.495811/11 [==============================] - 2s 138ms/step - loss: 0.6655 - accuracy: 0.4955
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6467 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.6466 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 1s - loss: 0.6368 - accuracy: 0.4935 4/11 [=========>....................] - ETA: 1s - loss: 0.6341 - accuracy: 0.5015 5/11 [============>.................] - ETA: 0s - loss: 0.6318 - accuracy: 0.5059 6/11 [===============>..............] - ETA: 0s - loss: 0.6293 - accuracy: 0.5086 7/11 [==================>...........] - ETA: 0s - loss: 0.6275 - accuracy: 0.5102 8/11 [====================>.........] - ETA: 0s - loss: 0.6269 - accuracy: 0.5109 9/11 [=======================>......] - ETA: 0s - loss: 0.6269 - accuracy: 0.510310/11 [==========================>...] - ETA: 0s - loss: 0.6275 - accuracy: 0.509611/11 [==============================] - ETA: 0s - loss: 0.6286 - accuracy: 0.508911/11 [==============================] - 2s 158ms/step - loss: 0.6296 - accuracy: 0.5083
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6080 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 1s - loss: 0.6200 - accuracy: 0.5449 3/11 [=======>......................] - ETA: 1s - loss: 0.6159 - accuracy: 0.5412 4/11 [=========>....................] - ETA: 1s - loss: 0.6164 - accuracy: 0.5373 5/11 [============>.................] - ETA: 1s - loss: 0.6170 - accuracy: 0.5354 6/11 [===============>..............] - ETA: 0s - loss: 0.6186 - accuracy: 0.5328 7/11 [==================>...........] - ETA: 0s - loss: 0.6204 - accuracy: 0.5300 8/11 [====================>.........] - ETA: 0s - loss: 0.6219 - accuracy: 0.5287 9/11 [=======================>......] - ETA: 0s - loss: 0.6227 - accuracy: 0.528710/11 [==========================>...] - ETA: 0s - loss: 0.6229 - accuracy: 0.529011/11 [==============================] - ETA: 0s - loss: 0.6226 - accuracy: 0.529011/11 [==============================] - 2s 159ms/step - loss: 0.6224 - accuracy: 0.5291
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5918 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.5993 - accuracy: 0.5273 3/11 [=======>......................] - ETA: 1s - loss: 0.5972 - accuracy: 0.5347 4/11 [=========>....................] - ETA: 0s - loss: 0.5996 - accuracy: 0.5353 5/11 [============>.................] - ETA: 0s - loss: 0.6007 - accuracy: 0.5354 6/11 [===============>..............] - ETA: 0s - loss: 0.6023 - accuracy: 0.5352 7/11 [==================>...........] - ETA: 0s - loss: 0.6042 - accuracy: 0.5351 8/11 [====================>.........] - ETA: 0s - loss: 0.6056 - accuracy: 0.5350 9/11 [=======================>......] - ETA: 0s - loss: 0.6059 - accuracy: 0.536110/11 [==========================>...] - ETA: 0s - loss: 0.6058 - accuracy: 0.536911/11 [==============================] - ETA: 0s - loss: 0.6055 - accuracy: 0.537211/11 [==============================] - 2s 153ms/step - loss: 0.6053 - accuracy: 0.5374
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6335 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.6238 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 1s - loss: 0.6178 - accuracy: 0.5087 4/11 [=========>....................] - ETA: 1s - loss: 0.6135 - accuracy: 0.5163 5/11 [============>.................] - ETA: 0s - loss: 0.6120 - accuracy: 0.5205 6/11 [===============>..............] - ETA: 0s - loss: 0.6110 - accuracy: 0.5251 7/11 [==================>...........] - ETA: 0s - loss: 0.6101 - accuracy: 0.5294 8/11 [====================>.........] - ETA: 0s - loss: 0.6084 - accuracy: 0.5333 9/11 [=======================>......] - ETA: 0s - loss: 0.6073 - accuracy: 0.535710/11 [==========================>...] - ETA: 0s - loss: 0.6057 - accuracy: 0.537411/11 [==============================] - ETA: 0s - loss: 0.6043 - accuracy: 0.539211/11 [==============================] - 2s 138ms/step - loss: 0.6031 - accuracy: 0.5407
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5257 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 1s - loss: 0.5320 - accuracy: 0.5684 3/11 [=======>......................] - ETA: 1s - loss: 0.5410 - accuracy: 0.5612 4/11 [=========>....................] - ETA: 1s - loss: 0.5429 - accuracy: 0.5576 5/11 [============>.................] - ETA: 0s - loss: 0.5468 - accuracy: 0.5545 6/11 [===============>..............] - ETA: 0s - loss: 0.5487 - accuracy: 0.5539 7/11 [==================>...........] - ETA: 0s - loss: 0.5513 - accuracy: 0.5539 8/11 [====================>.........] - ETA: 0s - loss: 0.5541 - accuracy: 0.5542 9/11 [=======================>......] - ETA: 0s - loss: 0.5564 - accuracy: 0.555710/11 [==========================>...] - ETA: 0s - loss: 0.5582 - accuracy: 0.557411/11 [==============================] - ETA: 0s - loss: 0.5597 - accuracy: 0.558811/11 [==============================] - 2s 155ms/step - loss: 0.5610 - accuracy: 0.5600
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5731 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 1s - loss: 0.5663 - accuracy: 0.5547 3/11 [=======>......................] - ETA: 1s - loss: 0.5659 - accuracy: 0.5530 4/11 [=========>....................] - ETA: 0s - loss: 0.5714 - accuracy: 0.5470 5/11 [============>.................] - ETA: 0s - loss: 0.5728 - accuracy: 0.5504 6/11 [===============>..............] - ETA: 0s - loss: 0.5731 - accuracy: 0.5527 7/11 [==================>...........] - ETA: 0s - loss: 0.5744 - accuracy: 0.5547 8/11 [====================>.........] - ETA: 0s - loss: 0.5742 - accuracy: 0.5568 9/11 [=======================>......] - ETA: 0s - loss: 0.5731 - accuracy: 0.559010/11 [==========================>...] - ETA: 0s - loss: 0.5723 - accuracy: 0.561011/11 [==============================] - ETA: 0s - loss: 0.5713 - accuracy: 0.562611/11 [==============================] - 2s 144ms/step - loss: 0.5705 - accuracy: 0.5639
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5031 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 1s - loss: 0.5114 - accuracy: 0.5723 3/11 [=======>......................] - ETA: 1s - loss: 0.5132 - accuracy: 0.5751 4/11 [=========>....................] - ETA: 1s - loss: 0.5159 - accuracy: 0.5758 5/11 [============>.................] - ETA: 0s - loss: 0.5198 - accuracy: 0.5788 6/11 [===============>..............] - ETA: 0s - loss: 0.5249 - accuracy: 0.5828 7/11 [==================>...........] - ETA: 0s - loss: 0.5294 - accuracy: 0.5849 8/11 [====================>.........] - ETA: 0s - loss: 0.5323 - accuracy: 0.5854 9/11 [=======================>......] - ETA: 0s - loss: 0.5339 - accuracy: 0.584910/11 [==========================>...] - ETA: 0s - loss: 0.5352 - accuracy: 0.584811/11 [==============================] - ETA: 0s - loss: 0.5365 - accuracy: 0.584411/11 [==============================] - 2s 162ms/step - loss: 0.5375 - accuracy: 0.5841
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.4669 - accuracy: 0.55473/6 [==============>...............] - ETA: 0s - loss: 0.5254 - accuracy: 0.5859 5/6 [========================>.....] - ETA: 0s - loss: 0.5274 - accuracy: 0.57976/6 [==============================] - 3s 26ms/step - loss: 0.5272 - accuracy: 0.5779
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [-2.4414016e-04  7.5318807e-01  9.9407387e-01  5.4474548e-03
  4.1489848e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 4 3] pred: [ 0.0177857   0.83699596  0.9753611  -0.00510705  0.00582664]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 4 3] pred: [ 0.02501218  0.7697147   0.9665696  -0.01287668  0.00119912]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [0 1 3 4 2] pred: [ 0.15058254  0.09072044 -0.04153028  0.00396739 -0.00184834]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [3 2 4 0 1] pred: [ 0.00560475 -0.01845482  0.03389194  0.17601089  0.01265579]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 4 3 0] pred: [-8.14511732e-04  1.36397004e-01  9.99785542e-01 -4.44261328e-04
  1.01045575e-02]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 0 3] pred: [4.7118766e-03 8.1107944e-02 9.9913937e-01 5.2248122e-04 5.6757419e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [0.00396303 0.8790084  0.9988489  0.01208698 0.00487495]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 0 3] pred: [ 3.3549843e-03  1.6602457e-01  9.9880511e-01 -5.0836609e-04
  5.1094457e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 4 0 3] pred: [ 0.00684829  0.8520078   0.9880434  -0.00349198  0.01189411]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [0 1 4 3 2] pred: [ 0.10903749  0.08556162 -0.10395014 -0.00361917 -0.00074749]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [0.00954596 0.0259753  0.99938697 0.00158621 0.00370401]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 0 4 1] pred: [ 1.1022330e-02 -2.4099784e-01  9.9955219e-01  1.7371533e-02
  5.8831921e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 4 0 3] pred: [ 2.6133703e-04  9.5340252e-02  9.9953902e-01 -9.5823137e-03
  7.0498767e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [0.00322016 0.04095788 0.9996805  0.00649939 0.00325175]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 5 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:19 - loss: 1.3162 - accuracy: 0.2656 2/11 [====>.........................] - ETA: 1s - loss: 1.3073 - accuracy: 0.3086   3/11 [=======>......................] - ETA: 1s - loss: 1.2983 - accuracy: 0.3359 4/11 [=========>....................] - ETA: 1s - loss: 1.2944 - accuracy: 0.3496 5/11 [============>.................] - ETA: 1s - loss: 1.2955 - accuracy: 0.3550 6/11 [===============>..............] - ETA: 1s - loss: 1.2944 - accuracy: 0.3599 7/11 [==================>...........] - ETA: 0s - loss: 1.2925 - accuracy: 0.3649 8/11 [====================>.........] - ETA: 0s - loss: 1.2897 - accuracy: 0.3707 9/11 [=======================>......] - ETA: 0s - loss: 1.2865 - accuracy: 0.375510/11 [==========================>...] - ETA: 0s - loss: 1.2831 - accuracy: 0.379911/11 [==============================] - ETA: 0s - loss: 1.2804 - accuracy: 0.383411/11 [==============================] - 10s 190ms/step - loss: 1.2782 - accuracy: 0.3864
Epoch 2/20
 1/11 [=>............................] - ETA: 2s - loss: 1.1896 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 1.1794 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 1s - loss: 1.1728 - accuracy: 0.4579 4/11 [=========>....................] - ETA: 1s - loss: 1.1675 - accuracy: 0.4582 5/11 [============>.................] - ETA: 1s - loss: 1.1629 - accuracy: 0.4597 6/11 [===============>..............] - ETA: 0s - loss: 1.1591 - accuracy: 0.4605 7/11 [==================>...........] - ETA: 0s - loss: 1.1579 - accuracy: 0.4591 8/11 [====================>.........] - ETA: 0s - loss: 1.1563 - accuracy: 0.4584 9/11 [=======================>......] - ETA: 0s - loss: 1.1554 - accuracy: 0.457010/11 [==========================>...] - ETA: 0s - loss: 1.1541 - accuracy: 0.455911/11 [==============================] - ETA: 0s - loss: 1.1526 - accuracy: 0.455111/11 [==============================] - 2s 182ms/step - loss: 1.1513 - accuracy: 0.4544
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 1.0759 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 1.0766 - accuracy: 0.4316 3/11 [=======>......................] - ETA: 1s - loss: 1.0688 - accuracy: 0.4336 4/11 [=========>....................] - ETA: 1s - loss: 1.0542 - accuracy: 0.4419 5/11 [============>.................] - ETA: 1s - loss: 1.0435 - accuracy: 0.4463 6/11 [===============>..............] - ETA: 0s - loss: 1.0353 - accuracy: 0.4492 7/11 [==================>...........] - ETA: 0s - loss: 1.0293 - accuracy: 0.4506 8/11 [====================>.........] - ETA: 0s - loss: 1.0244 - accuracy: 0.4510 9/11 [=======================>......] - ETA: 0s - loss: 1.0197 - accuracy: 0.450910/11 [==========================>...] - ETA: 0s - loss: 1.0155 - accuracy: 0.450711/11 [==============================] - ETA: 0s - loss: 1.0114 - accuracy: 0.450411/11 [==============================] - 2s 192ms/step - loss: 1.0080 - accuracy: 0.4501
Epoch 4/20
 1/11 [=>............................] - ETA: 2s - loss: 0.9077 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.9029 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 1s - loss: 0.8891 - accuracy: 0.4418 4/11 [=========>....................] - ETA: 1s - loss: 0.8758 - accuracy: 0.4481 5/11 [============>.................] - ETA: 0s - loss: 0.8668 - accuracy: 0.4528 6/11 [===============>..............] - ETA: 0s - loss: 0.8647 - accuracy: 0.4533 7/11 [==================>...........] - ETA: 0s - loss: 0.8643 - accuracy: 0.4527 8/11 [====================>.........] - ETA: 0s - loss: 0.8639 - accuracy: 0.4520 9/11 [=======================>......] - ETA: 0s - loss: 0.8628 - accuracy: 0.451810/11 [==========================>...] - ETA: 0s - loss: 0.8614 - accuracy: 0.451911/11 [==============================] - ETA: 0s - loss: 0.8603 - accuracy: 0.451711/11 [==============================] - 2s 181ms/step - loss: 0.8593 - accuracy: 0.4515
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8902 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 1s - loss: 0.8957 - accuracy: 0.4160 3/11 [=======>......................] - ETA: 1s - loss: 0.8813 - accuracy: 0.4232 4/11 [=========>....................] - ETA: 1s - loss: 0.8733 - accuracy: 0.4258 5/11 [============>.................] - ETA: 1s - loss: 0.8687 - accuracy: 0.4281 6/11 [===============>..............] - ETA: 1s - loss: 0.8599 - accuracy: 0.4323 7/11 [==================>...........] - ETA: 0s - loss: 0.8536 - accuracy: 0.4356 8/11 [====================>.........] - ETA: 0s - loss: 0.8498 - accuracy: 0.4377 9/11 [=======================>......] - ETA: 0s - loss: 0.8468 - accuracy: 0.439310/11 [==========================>...] - ETA: 0s - loss: 0.8445 - accuracy: 0.440711/11 [==============================] - ETA: 0s - loss: 0.8424 - accuracy: 0.441811/11 [==============================] - 2s 200ms/step - loss: 0.8407 - accuracy: 0.4428
Epoch 6/20
 1/11 [=>............................] - ETA: 2s - loss: 0.8900 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 1s - loss: 0.8699 - accuracy: 0.4199 3/11 [=======>......................] - ETA: 1s - loss: 0.8592 - accuracy: 0.4258 4/11 [=========>....................] - ETA: 1s - loss: 0.8507 - accuracy: 0.4272 5/11 [============>.................] - ETA: 1s - loss: 0.8451 - accuracy: 0.4290 6/11 [===============>..............] - ETA: 0s - loss: 0.8399 - accuracy: 0.4315 7/11 [==================>...........] - ETA: 0s - loss: 0.8359 - accuracy: 0.4333 8/11 [====================>.........] - ETA: 0s - loss: 0.8331 - accuracy: 0.4352 9/11 [=======================>......] - ETA: 0s - loss: 0.8299 - accuracy: 0.437410/11 [==========================>...] - ETA: 0s - loss: 0.8276 - accuracy: 0.438711/11 [==============================] - ETA: 0s - loss: 0.8253 - accuracy: 0.440211/11 [==============================] - 2s 195ms/step - loss: 0.8234 - accuracy: 0.4415
Epoch 7/20
 1/11 [=>............................] - ETA: 2s - loss: 0.8359 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 1s - loss: 0.8164 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 1s - loss: 0.7985 - accuracy: 0.4484 4/11 [=========>....................] - ETA: 1s - loss: 0.7860 - accuracy: 0.4559 5/11 [============>.................] - ETA: 1s - loss: 0.7837 - accuracy: 0.4569 6/11 [===============>..............] - ETA: 0s - loss: 0.7813 - accuracy: 0.4593 7/11 [==================>...........] - ETA: 0s - loss: 0.7797 - accuracy: 0.4605 8/11 [====================>.........] - ETA: 0s - loss: 0.7779 - accuracy: 0.4618 9/11 [=======================>......] - ETA: 0s - loss: 0.7773 - accuracy: 0.462510/11 [==========================>...] - ETA: 0s - loss: 0.7772 - accuracy: 0.462411/11 [==============================] - ETA: 0s - loss: 0.7772 - accuracy: 0.462311/11 [==============================] - 2s 182ms/step - loss: 0.7771 - accuracy: 0.4622
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7763 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.7755 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 1s - loss: 0.7705 - accuracy: 0.4783 4/11 [=========>....................] - ETA: 1s - loss: 0.7676 - accuracy: 0.4798 5/11 [============>.................] - ETA: 1s - loss: 0.7656 - accuracy: 0.4807 6/11 [===============>..............] - ETA: 1s - loss: 0.7610 - accuracy: 0.4824 7/11 [==================>...........] - ETA: 0s - loss: 0.7605 - accuracy: 0.4816 8/11 [====================>.........] - ETA: 0s - loss: 0.7604 - accuracy: 0.4807 9/11 [=======================>......] - ETA: 0s - loss: 0.7593 - accuracy: 0.480210/11 [==========================>...] - ETA: 0s - loss: 0.7590 - accuracy: 0.479211/11 [==============================] - ETA: 0s - loss: 0.7585 - accuracy: 0.478811/11 [==============================] - 2s 206ms/step - loss: 0.7580 - accuracy: 0.4784
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7903 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.7470 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 1s - loss: 0.7348 - accuracy: 0.4744 4/11 [=========>....................] - ETA: 1s - loss: 0.7278 - accuracy: 0.4793 5/11 [============>.................] - ETA: 1s - loss: 0.7283 - accuracy: 0.4791 6/11 [===============>..............] - ETA: 0s - loss: 0.7290 - accuracy: 0.4785 7/11 [==================>...........] - ETA: 0s - loss: 0.7289 - accuracy: 0.4783 8/11 [====================>.........] - ETA: 0s - loss: 0.7288 - accuracy: 0.4786 9/11 [=======================>......] - ETA: 0s - loss: 0.7296 - accuracy: 0.478410/11 [==========================>...] - ETA: 0s - loss: 0.7297 - accuracy: 0.479011/11 [==============================] - ETA: 0s - loss: 0.7297 - accuracy: 0.479511/11 [==============================] - 2s 203ms/step - loss: 0.7297 - accuracy: 0.4799
Epoch 10/20
 1/11 [=>............................] - ETA: 2s - loss: 0.7482 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.7452 - accuracy: 0.5020 3/11 [=======>......................] - ETA: 1s - loss: 0.7414 - accuracy: 0.4961 4/11 [=========>....................] - ETA: 1s - loss: 0.7362 - accuracy: 0.4961 5/11 [============>.................] - ETA: 1s - loss: 0.7314 - accuracy: 0.4969 6/11 [===============>..............] - ETA: 0s - loss: 0.7268 - accuracy: 0.4991 7/11 [==================>...........] - ETA: 0s - loss: 0.7238 - accuracy: 0.5010 8/11 [====================>.........] - ETA: 0s - loss: 0.7214 - accuracy: 0.5008 9/11 [=======================>......] - ETA: 0s - loss: 0.7187 - accuracy: 0.500710/11 [==========================>...] - ETA: 0s - loss: 0.7168 - accuracy: 0.500311/11 [==============================] - ETA: 0s - loss: 0.7151 - accuracy: 0.499911/11 [==============================] - 2s 178ms/step - loss: 0.7137 - accuracy: 0.4995
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7183 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.6855 - accuracy: 0.5332 3/11 [=======>......................] - ETA: 1s - loss: 0.6867 - accuracy: 0.5317 4/11 [=========>....................] - ETA: 1s - loss: 0.6855 - accuracy: 0.5272 5/11 [============>.................] - ETA: 0s - loss: 0.6849 - accuracy: 0.5236 6/11 [===============>..............] - ETA: 0s - loss: 0.6845 - accuracy: 0.5234 7/11 [==================>...........] - ETA: 0s - loss: 0.6843 - accuracy: 0.5221 8/11 [====================>.........] - ETA: 0s - loss: 0.6829 - accuracy: 0.5215 9/11 [=======================>......] - ETA: 0s - loss: 0.6820 - accuracy: 0.520810/11 [==========================>...] - ETA: 0s - loss: 0.6810 - accuracy: 0.519811/11 [==============================] - ETA: 0s - loss: 0.6797 - accuracy: 0.518811/11 [==============================] - 2s 179ms/step - loss: 0.6787 - accuracy: 0.5180
Epoch 12/20
 1/11 [=>............................] - ETA: 2s - loss: 0.7365 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 2s - loss: 0.7153 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 1s - loss: 0.7051 - accuracy: 0.4674 4/11 [=========>....................] - ETA: 1s - loss: 0.6904 - accuracy: 0.4741 5/11 [============>.................] - ETA: 1s - loss: 0.6806 - accuracy: 0.4790 6/11 [===============>..............] - ETA: 0s - loss: 0.6735 - accuracy: 0.4825 7/11 [==================>...........] - ETA: 0s - loss: 0.6675 - accuracy: 0.4850 8/11 [====================>.........] - ETA: 0s - loss: 0.6638 - accuracy: 0.4878 9/11 [=======================>......] - ETA: 0s - loss: 0.6612 - accuracy: 0.490410/11 [==========================>...] - ETA: 0s - loss: 0.6591 - accuracy: 0.492611/11 [==============================] - ETA: 0s - loss: 0.6573 - accuracy: 0.495011/11 [==============================] - 2s 187ms/step - loss: 0.6557 - accuracy: 0.4969
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6239 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 1s - loss: 0.6238 - accuracy: 0.5645 3/11 [=======>......................] - ETA: 1s - loss: 0.6282 - accuracy: 0.5551 4/11 [=========>....................] - ETA: 1s - loss: 0.6320 - accuracy: 0.5448 5/11 [============>.................] - ETA: 1s - loss: 0.6318 - accuracy: 0.5371 6/11 [===============>..............] - ETA: 0s - loss: 0.6306 - accuracy: 0.5331 7/11 [==================>...........] - ETA: 0s - loss: 0.6303 - accuracy: 0.5304 8/11 [====================>.........] - ETA: 0s - loss: 0.6292 - accuracy: 0.5306 9/11 [=======================>......] - ETA: 0s - loss: 0.6275 - accuracy: 0.531310/11 [==========================>...] - ETA: 0s - loss: 0.6258 - accuracy: 0.531511/11 [==============================] - ETA: 0s - loss: 0.6247 - accuracy: 0.531911/11 [==============================] - 2s 193ms/step - loss: 0.6238 - accuracy: 0.5322
Epoch 14/20
 1/11 [=>............................] - ETA: 2s - loss: 0.6449 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 2s - loss: 0.6458 - accuracy: 0.5508 3/11 [=======>......................] - ETA: 1s - loss: 0.6416 - accuracy: 0.5521 4/11 [=========>....................] - ETA: 1s - loss: 0.6353 - accuracy: 0.5586 5/11 [============>.................] - ETA: 1s - loss: 0.6305 - accuracy: 0.5591 6/11 [===============>..............] - ETA: 1s - loss: 0.6270 - accuracy: 0.5588 7/11 [==================>...........] - ETA: 0s - loss: 0.6235 - accuracy: 0.5579 8/11 [====================>.........] - ETA: 0s - loss: 0.6196 - accuracy: 0.5587 9/11 [=======================>......] - ETA: 0s - loss: 0.6168 - accuracy: 0.558510/11 [==========================>...] - ETA: 0s - loss: 0.6147 - accuracy: 0.558111/11 [==============================] - ETA: 0s - loss: 0.6126 - accuracy: 0.557811/11 [==============================] - 3s 228ms/step - loss: 0.6108 - accuracy: 0.5576
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6058 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.5973 - accuracy: 0.5293 3/11 [=======>......................] - ETA: 1s - loss: 0.5975 - accuracy: 0.5360 4/11 [=========>....................] - ETA: 1s - loss: 0.5949 - accuracy: 0.5431 5/11 [============>.................] - ETA: 1s - loss: 0.5926 - accuracy: 0.5498 6/11 [===============>..............] - ETA: 0s - loss: 0.5900 - accuracy: 0.5563 7/11 [==================>...........] - ETA: 0s - loss: 0.5877 - accuracy: 0.5605 8/11 [====================>.........] - ETA: 0s - loss: 0.5840 - accuracy: 0.5628 9/11 [=======================>......] - ETA: 0s - loss: 0.5818 - accuracy: 0.564110/11 [==========================>...] - ETA: 0s - loss: 0.5802 - accuracy: 0.565111/11 [==============================] - ETA: 0s - loss: 0.5794 - accuracy: 0.565811/11 [==============================] - 2s 175ms/step - loss: 0.5787 - accuracy: 0.5664
Epoch 16/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5770 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.5575 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 1s - loss: 0.5639 - accuracy: 0.5573 4/11 [=========>....................] - ETA: 1s - loss: 0.5664 - accuracy: 0.5566 5/11 [============>.................] - ETA: 1s - loss: 0.5684 - accuracy: 0.5619 6/11 [===============>..............] - ETA: 0s - loss: 0.5665 - accuracy: 0.5657 7/11 [==================>...........] - ETA: 0s - loss: 0.5643 - accuracy: 0.5690 8/11 [====================>.........] - ETA: 0s - loss: 0.5620 - accuracy: 0.5714 9/11 [=======================>......] - ETA: 0s - loss: 0.5601 - accuracy: 0.573010/11 [==========================>...] - ETA: 0s - loss: 0.5593 - accuracy: 0.573811/11 [==============================] - ETA: 0s - loss: 0.5586 - accuracy: 0.574611/11 [==============================] - 2s 200ms/step - loss: 0.5581 - accuracy: 0.5753
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5184 - accuracy: 0.6250 2/11 [====>.........................] - ETA: 1s - loss: 0.5627 - accuracy: 0.6133 3/11 [=======>......................] - ETA: 1s - loss: 0.5642 - accuracy: 0.6050 4/11 [=========>....................] - ETA: 1s - loss: 0.5610 - accuracy: 0.6007 5/11 [============>.................] - ETA: 1s - loss: 0.5561 - accuracy: 0.5987 6/11 [===============>..............] - ETA: 1s - loss: 0.5516 - accuracy: 0.5970 7/11 [==================>...........] - ETA: 0s - loss: 0.5490 - accuracy: 0.5970 8/11 [====================>.........] - ETA: 0s - loss: 0.5471 - accuracy: 0.5972 9/11 [=======================>......] - ETA: 0s - loss: 0.5452 - accuracy: 0.597010/11 [==========================>...] - ETA: 0s - loss: 0.5438 - accuracy: 0.597011/11 [==============================] - ETA: 0s - loss: 0.5427 - accuracy: 0.596711/11 [==============================] - 2s 192ms/step - loss: 0.5418 - accuracy: 0.5964
Epoch 18/20
 1/11 [=>............................] - ETA: 2s - loss: 0.4647 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 1s - loss: 0.4814 - accuracy: 0.5586 3/11 [=======>......................] - ETA: 1s - loss: 0.4982 - accuracy: 0.5668 4/11 [=========>....................] - ETA: 1s - loss: 0.5026 - accuracy: 0.5736 5/11 [============>.................] - ETA: 1s - loss: 0.5048 - accuracy: 0.5773 6/11 [===============>..............] - ETA: 0s - loss: 0.5068 - accuracy: 0.5803 7/11 [==================>...........] - ETA: 0s - loss: 0.5086 - accuracy: 0.5823 8/11 [====================>.........] - ETA: 0s - loss: 0.5100 - accuracy: 0.5836 9/11 [=======================>......] - ETA: 0s - loss: 0.5105 - accuracy: 0.585410/11 [==========================>...] - ETA: 0s - loss: 0.5110 - accuracy: 0.586711/11 [==============================] - ETA: 0s - loss: 0.5115 - accuracy: 0.587611/11 [==============================] - 2s 201ms/step - loss: 0.5119 - accuracy: 0.5884
Epoch 19/20
 1/11 [=>............................] - ETA: 2s - loss: 0.3931 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 1s - loss: 0.4315 - accuracy: 0.6191 3/11 [=======>......................] - ETA: 1s - loss: 0.4418 - accuracy: 0.6202 4/11 [=========>....................] - ETA: 1s - loss: 0.4511 - accuracy: 0.6160 5/11 [============>.................] - ETA: 1s - loss: 0.4557 - accuracy: 0.6128 6/11 [===============>..............] - ETA: 0s - loss: 0.4624 - accuracy: 0.6105 7/11 [==================>...........] - ETA: 0s - loss: 0.4698 - accuracy: 0.6096 8/11 [====================>.........] - ETA: 0s - loss: 0.4746 - accuracy: 0.6084 9/11 [=======================>......] - ETA: 0s - loss: 0.4784 - accuracy: 0.608410/11 [==========================>...] - ETA: 0s - loss: 0.4806 - accuracy: 0.608211/11 [==============================] - ETA: 0s - loss: 0.4826 - accuracy: 0.608511/11 [==============================] - 2s 183ms/step - loss: 0.4842 - accuracy: 0.6087
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4808 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 1s - loss: 0.4785 - accuracy: 0.6035 3/11 [=======>......................] - ETA: 1s - loss: 0.4926 - accuracy: 0.6107 4/11 [=========>....................] - ETA: 1s - loss: 0.5003 - accuracy: 0.6152 5/11 [============>.................] - ETA: 1s - loss: 0.5053 - accuracy: 0.6153 6/11 [===============>..............] - ETA: 0s - loss: 0.5064 - accuracy: 0.6158 7/11 [==================>...........] - ETA: 0s - loss: 0.5074 - accuracy: 0.6165 8/11 [====================>.........] - ETA: 0s - loss: 0.5074 - accuracy: 0.6168 9/11 [=======================>......] - ETA: 0s - loss: 0.5062 - accuracy: 0.616710/11 [==========================>...] - ETA: 0s - loss: 0.5040 - accuracy: 0.616911/11 [==============================] - ETA: 0s - loss: 0.5025 - accuracy: 0.616511/11 [==============================] - 2s 193ms/step - loss: 0.5012 - accuracy: 0.6162
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.5025 - accuracy: 0.61723/6 [==============>...............] - ETA: 0s - loss: 0.4525 - accuracy: 0.6146 5/6 [========================>.....] - ETA: 0s - loss: 0.4547 - accuracy: 0.59696/6 [==============================] - 3s 31ms/step - loss: 0.4620 - accuracy: 0.5977
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 0 4 1] pred: [-0.00875107 -0.0751261   0.97054     0.11797208 -0.00894274]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 0 3 4] pred: [ 0.00389837  0.8847386   0.9924356   0.00339791 -0.00213934]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 4 3] pred: [ 0.01456464  0.89829993  0.8935597  -0.01406141 -0.00182679]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [ 0.02870044  0.3717767   0.90001607  0.0666557  -0.02576658]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [ 0.05765237  0.9033034   0.962403   -0.01653218  0.01143082]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [ 0.1214716   0.87594026  0.994655   -0.03200746  0.00763056]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 4 0 1] pred: [-0.01605053 -0.08933669  0.99526507  0.0158016  -0.00190423]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 0 4 1] pred: [ 0.01436422 -0.03792311  0.99644345  0.02014311 -0.01197294]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 0 3 4] pred: [ 1.2431322e-02  9.0112096e-01  9.9646610e-01  4.6280024e-04
 -1.4122408e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 3 4 0] pred: [-2.2464469e-03  9.4337428e-01  9.4204396e-01  6.0040453e-03
 -9.8316930e-05]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 4 0] pred: [-0.00295454  0.5036368   0.9995918   0.00565392  0.00290466]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 4 0 3] pred: [ 0.00201771  0.9523466   0.99801415 -0.00540807  0.00296599]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [ 6.5302092e-04  3.8657475e-02  9.9854392e-01 -5.3442507e-03
 -7.8704068e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [ 0.00399463  0.8748849   0.99851453  0.00826371 -0.00498769]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 4 3 0] pred: [0.00442706 0.9291811  0.9996062  0.00947805 0.01039317]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 6 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:20 - loss: 1.3046 - accuracy: 0.2891 2/11 [====>.........................] - ETA: 1s - loss: 1.2894 - accuracy: 0.3066   3/11 [=======>......................] - ETA: 1s - loss: 1.2885 - accuracy: 0.3355 4/11 [=========>....................] - ETA: 1s - loss: 1.2924 - accuracy: 0.3512 5/11 [============>.................] - ETA: 1s - loss: 1.2933 - accuracy: 0.3635 6/11 [===============>..............] - ETA: 0s - loss: 1.2914 - accuracy: 0.3737 7/11 [==================>...........] - ETA: 0s - loss: 1.2888 - accuracy: 0.3831 8/11 [====================>.........] - ETA: 0s - loss: 1.2861 - accuracy: 0.3906 9/11 [=======================>......] - ETA: 0s - loss: 1.2833 - accuracy: 0.397310/11 [==========================>...] - ETA: 0s - loss: 1.2804 - accuracy: 0.402911/11 [==============================] - ETA: 0s - loss: 1.2777 - accuracy: 0.407611/11 [==============================] - 10s 180ms/step - loss: 1.2754 - accuracy: 0.4115
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 1.2012 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 1.1957 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 1s - loss: 1.1874 - accuracy: 0.4900 4/11 [=========>....................] - ETA: 1s - loss: 1.1871 - accuracy: 0.4852 5/11 [============>.................] - ETA: 0s - loss: 1.1827 - accuracy: 0.4850 6/11 [===============>..............] - ETA: 0s - loss: 1.1785 - accuracy: 0.4849 7/11 [==================>...........] - ETA: 0s - loss: 1.1747 - accuracy: 0.4848 8/11 [====================>.........] - ETA: 0s - loss: 1.1715 - accuracy: 0.4840 9/11 [=======================>......] - ETA: 0s - loss: 1.1684 - accuracy: 0.482910/11 [==========================>...] - ETA: 0s - loss: 1.1652 - accuracy: 0.481911/11 [==============================] - ETA: 0s - loss: 1.1627 - accuracy: 0.480211/11 [==============================] - 2s 159ms/step - loss: 1.1606 - accuracy: 0.4788
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 1.0315 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 1.0381 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 1s - loss: 1.0359 - accuracy: 0.4674 4/11 [=========>....................] - ETA: 1s - loss: 1.0321 - accuracy: 0.4663 5/11 [============>.................] - ETA: 0s - loss: 1.0288 - accuracy: 0.4652 6/11 [===============>..............] - ETA: 0s - loss: 1.0234 - accuracy: 0.4658 7/11 [==================>...........] - ETA: 0s - loss: 1.0184 - accuracy: 0.4658 8/11 [====================>.........] - ETA: 0s - loss: 1.0125 - accuracy: 0.4663 9/11 [=======================>......] - ETA: 0s - loss: 1.0060 - accuracy: 0.467310/11 [==========================>...] - ETA: 0s - loss: 1.0009 - accuracy: 0.467311/11 [==============================] - ETA: 0s - loss: 0.9963 - accuracy: 0.466911/11 [==============================] - 2s 165ms/step - loss: 0.9925 - accuracy: 0.4667
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8672 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 1s - loss: 0.8489 - accuracy: 0.4434 3/11 [=======>......................] - ETA: 1s - loss: 0.8488 - accuracy: 0.4466 4/11 [=========>....................] - ETA: 1s - loss: 0.8488 - accuracy: 0.4497 5/11 [============>.................] - ETA: 1s - loss: 0.8526 - accuracy: 0.4485 6/11 [===============>..............] - ETA: 0s - loss: 0.8531 - accuracy: 0.4482 7/11 [==================>...........] - ETA: 0s - loss: 0.8489 - accuracy: 0.4505 8/11 [====================>.........] - ETA: 0s - loss: 0.8452 - accuracy: 0.4520 9/11 [=======================>......] - ETA: 0s - loss: 0.8424 - accuracy: 0.453110/11 [==========================>...] - ETA: 0s - loss: 0.8396 - accuracy: 0.454211/11 [==============================] - ETA: 0s - loss: 0.8373 - accuracy: 0.455111/11 [==============================] - 2s 187ms/step - loss: 0.8353 - accuracy: 0.4558
Epoch 5/20
 1/11 [=>............................] - ETA: 2s - loss: 0.8337 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.8285 - accuracy: 0.4258 3/11 [=======>......................] - ETA: 1s - loss: 0.8211 - accuracy: 0.4253 4/11 [=========>....................] - ETA: 1s - loss: 0.8180 - accuracy: 0.4289 5/11 [============>.................] - ETA: 1s - loss: 0.8160 - accuracy: 0.4325 6/11 [===============>..............] - ETA: 0s - loss: 0.8126 - accuracy: 0.4366 7/11 [==================>...........] - ETA: 0s - loss: 0.8125 - accuracy: 0.4386 8/11 [====================>.........] - ETA: 0s - loss: 0.8120 - accuracy: 0.4399 9/11 [=======================>......] - ETA: 0s - loss: 0.8102 - accuracy: 0.441710/11 [==========================>...] - ETA: 0s - loss: 0.8078 - accuracy: 0.443711/11 [==============================] - ETA: 0s - loss: 0.8056 - accuracy: 0.445511/11 [==============================] - 2s 187ms/step - loss: 0.8038 - accuracy: 0.4470
Epoch 6/20
 1/11 [=>............................] - ETA: 2s - loss: 0.7821 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.7593 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 1s - loss: 0.7606 - accuracy: 0.4531 4/11 [=========>....................] - ETA: 1s - loss: 0.7685 - accuracy: 0.4507 5/11 [============>.................] - ETA: 1s - loss: 0.7704 - accuracy: 0.4537 6/11 [===============>..............] - ETA: 0s - loss: 0.7746 - accuracy: 0.4527 7/11 [==================>...........] - ETA: 0s - loss: 0.7756 - accuracy: 0.4531 8/11 [====================>.........] - ETA: 0s - loss: 0.7763 - accuracy: 0.4539 9/11 [=======================>......] - ETA: 0s - loss: 0.7761 - accuracy: 0.454710/11 [==========================>...] - ETA: 0s - loss: 0.7748 - accuracy: 0.455911/11 [==============================] - ETA: 0s - loss: 0.7739 - accuracy: 0.456911/11 [==============================] - 2s 186ms/step - loss: 0.7731 - accuracy: 0.4578
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7539 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.7655 - accuracy: 0.4590 3/11 [=======>......................] - ETA: 1s - loss: 0.7679 - accuracy: 0.4518 4/11 [=========>....................] - ETA: 1s - loss: 0.7645 - accuracy: 0.4512 5/11 [============>.................] - ETA: 1s - loss: 0.7613 - accuracy: 0.4512 6/11 [===============>..............] - ETA: 0s - loss: 0.7583 - accuracy: 0.4526 7/11 [==================>...........] - ETA: 0s - loss: 0.7555 - accuracy: 0.4548 8/11 [====================>.........] - ETA: 0s - loss: 0.7543 - accuracy: 0.4559 9/11 [=======================>......] - ETA: 0s - loss: 0.7535 - accuracy: 0.456410/11 [==========================>...] - ETA: 0s - loss: 0.7527 - accuracy: 0.457011/11 [==============================] - ETA: 0s - loss: 0.7515 - accuracy: 0.458211/11 [==============================] - 2s 199ms/step - loss: 0.7506 - accuracy: 0.4592
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7457 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 2s - loss: 0.7446 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 1s - loss: 0.7467 - accuracy: 0.4722 4/11 [=========>....................] - ETA: 1s - loss: 0.7492 - accuracy: 0.4699 5/11 [============>.................] - ETA: 1s - loss: 0.7505 - accuracy: 0.4684 6/11 [===============>..............] - ETA: 1s - loss: 0.7496 - accuracy: 0.4683 7/11 [==================>...........] - ETA: 0s - loss: 0.7461 - accuracy: 0.4696 8/11 [====================>.........] - ETA: 0s - loss: 0.7433 - accuracy: 0.4703 9/11 [=======================>......] - ETA: 0s - loss: 0.7407 - accuracy: 0.471510/11 [==========================>...] - ETA: 0s - loss: 0.7382 - accuracy: 0.472311/11 [==============================] - ETA: 0s - loss: 0.7365 - accuracy: 0.472711/11 [==============================] - 2s 193ms/step - loss: 0.7352 - accuracy: 0.4729
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7508 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.7212 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 1s - loss: 0.7084 - accuracy: 0.4444 4/11 [=========>....................] - ETA: 1s - loss: 0.7102 - accuracy: 0.4451 5/11 [============>.................] - ETA: 0s - loss: 0.7146 - accuracy: 0.4455 6/11 [===============>..............] - ETA: 0s - loss: 0.7187 - accuracy: 0.4450 7/11 [==================>...........] - ETA: 0s - loss: 0.7193 - accuracy: 0.4460 8/11 [====================>.........] - ETA: 0s - loss: 0.7176 - accuracy: 0.4486 9/11 [=======================>......] - ETA: 0s - loss: 0.7151 - accuracy: 0.451610/11 [==========================>...] - ETA: 0s - loss: 0.7126 - accuracy: 0.454411/11 [==============================] - ETA: 0s - loss: 0.7110 - accuracy: 0.456611/11 [==============================] - 2s 176ms/step - loss: 0.7097 - accuracy: 0.4584
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6098 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 1s - loss: 0.6028 - accuracy: 0.5449 3/11 [=======>......................] - ETA: 1s - loss: 0.6052 - accuracy: 0.5464 4/11 [=========>....................] - ETA: 1s - loss: 0.6165 - accuracy: 0.5378 5/11 [============>.................] - ETA: 1s - loss: 0.6275 - accuracy: 0.5299 6/11 [===============>..............] - ETA: 1s - loss: 0.6345 - accuracy: 0.5230 7/11 [==================>...........] - ETA: 0s - loss: 0.6396 - accuracy: 0.5171 8/11 [====================>.........] - ETA: 0s - loss: 0.6432 - accuracy: 0.5139 9/11 [=======================>......] - ETA: 0s - loss: 0.6462 - accuracy: 0.510410/11 [==========================>...] - ETA: 0s - loss: 0.6481 - accuracy: 0.507511/11 [==============================] - ETA: 0s - loss: 0.6496 - accuracy: 0.505211/11 [==============================] - 2s 195ms/step - loss: 0.6509 - accuracy: 0.5032
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6135 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.6430 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 1s - loss: 0.6490 - accuracy: 0.4670 4/11 [=========>....................] - ETA: 1s - loss: 0.6480 - accuracy: 0.4714 5/11 [============>.................] - ETA: 1s - loss: 0.6444 - accuracy: 0.4758 6/11 [===============>..............] - ETA: 0s - loss: 0.6412 - accuracy: 0.4799 7/11 [==================>...........] - ETA: 0s - loss: 0.6387 - accuracy: 0.4827 8/11 [====================>.........] - ETA: 0s - loss: 0.6358 - accuracy: 0.4844 9/11 [=======================>......] - ETA: 0s - loss: 0.6356 - accuracy: 0.485410/11 [==========================>...] - ETA: 0s - loss: 0.6354 - accuracy: 0.485711/11 [==============================] - ETA: 0s - loss: 0.6355 - accuracy: 0.486011/11 [==============================] - 2s 185ms/step - loss: 0.6356 - accuracy: 0.4863
Epoch 12/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5807 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 2s - loss: 0.6073 - accuracy: 0.5059 3/11 [=======>......................] - ETA: 1s - loss: 0.6204 - accuracy: 0.4996 4/11 [=========>....................] - ETA: 1s - loss: 0.6214 - accuracy: 0.4953 5/11 [============>.................] - ETA: 1s - loss: 0.6202 - accuracy: 0.4922 6/11 [===============>..............] - ETA: 0s - loss: 0.6175 - accuracy: 0.4906 7/11 [==================>...........] - ETA: 0s - loss: 0.6169 - accuracy: 0.4899 8/11 [====================>.........] - ETA: 0s - loss: 0.6164 - accuracy: 0.4890 9/11 [=======================>......] - ETA: 0s - loss: 0.6146 - accuracy: 0.490010/11 [==========================>...] - ETA: 0s - loss: 0.6132 - accuracy: 0.491111/11 [==============================] - ETA: 0s - loss: 0.6123 - accuracy: 0.492011/11 [==============================] - 2s 194ms/step - loss: 0.6116 - accuracy: 0.4928
Epoch 13/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5897 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 2s - loss: 0.5867 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 1s - loss: 0.5873 - accuracy: 0.5078 4/11 [=========>....................] - ETA: 1s - loss: 0.5901 - accuracy: 0.5054 5/11 [============>.................] - ETA: 1s - loss: 0.5881 - accuracy: 0.5068 6/11 [===============>..............] - ETA: 0s - loss: 0.5868 - accuracy: 0.5083 7/11 [==================>...........] - ETA: 0s - loss: 0.5867 - accuracy: 0.5090 8/11 [====================>.........] - ETA: 0s - loss: 0.5865 - accuracy: 0.5095 9/11 [=======================>......] - ETA: 0s - loss: 0.5855 - accuracy: 0.510010/11 [==========================>...] - ETA: 0s - loss: 0.5844 - accuracy: 0.510311/11 [==============================] - ETA: 0s - loss: 0.5833 - accuracy: 0.511311/11 [==============================] - 2s 174ms/step - loss: 0.5823 - accuracy: 0.5122
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5081 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.5270 - accuracy: 0.5410 3/11 [=======>......................] - ETA: 1s - loss: 0.5353 - accuracy: 0.5334 4/11 [=========>....................] - ETA: 1s - loss: 0.5398 - accuracy: 0.5285 5/11 [============>.................] - ETA: 1s - loss: 0.5388 - accuracy: 0.5293 6/11 [===============>..............] - ETA: 1s - loss: 0.5391 - accuracy: 0.5314 7/11 [==================>...........] - ETA: 0s - loss: 0.5387 - accuracy: 0.5335 8/11 [====================>.........] - ETA: 0s - loss: 0.5389 - accuracy: 0.5340 9/11 [=======================>......] - ETA: 0s - loss: 0.5400 - accuracy: 0.534110/11 [==========================>...] - ETA: 0s - loss: 0.5399 - accuracy: 0.534511/11 [==============================] - ETA: 0s - loss: 0.5404 - accuracy: 0.535011/11 [==============================] - 2s 202ms/step - loss: 0.5407 - accuracy: 0.5354
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6316 - accuracy: 0.5859 2/11 [====>.........................] - ETA: 1s - loss: 0.5953 - accuracy: 0.5762 3/11 [=======>......................] - ETA: 1s - loss: 0.5737 - accuracy: 0.5707 4/11 [=========>....................] - ETA: 1s - loss: 0.5659 - accuracy: 0.5731 5/11 [============>.................] - ETA: 1s - loss: 0.5590 - accuracy: 0.5753 6/11 [===============>..............] - ETA: 0s - loss: 0.5550 - accuracy: 0.5756 7/11 [==================>...........] - ETA: 0s - loss: 0.5516 - accuracy: 0.5747 8/11 [====================>.........] - ETA: 0s - loss: 0.5485 - accuracy: 0.5733 9/11 [=======================>......] - ETA: 0s - loss: 0.5456 - accuracy: 0.572110/11 [==========================>...] - ETA: 0s - loss: 0.5432 - accuracy: 0.571511/11 [==============================] - ETA: 0s - loss: 0.5413 - accuracy: 0.570611/11 [==============================] - 2s 188ms/step - loss: 0.5398 - accuracy: 0.5698
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5380 - accuracy: 0.6484 2/11 [====>.........................] - ETA: 1s - loss: 0.5295 - accuracy: 0.6016 3/11 [=======>......................] - ETA: 1s - loss: 0.5274 - accuracy: 0.5868 4/11 [=========>....................] - ETA: 1s - loss: 0.5214 - accuracy: 0.5802 5/11 [============>.................] - ETA: 1s - loss: 0.5182 - accuracy: 0.5758 6/11 [===============>..............] - ETA: 0s - loss: 0.5158 - accuracy: 0.5742 7/11 [==================>...........] - ETA: 0s - loss: 0.5141 - accuracy: 0.5725 8/11 [====================>.........] - ETA: 0s - loss: 0.5132 - accuracy: 0.5721 9/11 [=======================>......] - ETA: 0s - loss: 0.5131 - accuracy: 0.570810/11 [==========================>...] - ETA: 0s - loss: 0.5125 - accuracy: 0.570011/11 [==============================] - ETA: 0s - loss: 0.5118 - accuracy: 0.569911/11 [==============================] - 2s 193ms/step - loss: 0.5113 - accuracy: 0.5698
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4800 - accuracy: 0.5703 2/11 [====>.........................] - ETA: 1s - loss: 0.4885 - accuracy: 0.5449 3/11 [=======>......................] - ETA: 1s - loss: 0.4932 - accuracy: 0.5447 4/11 [=========>....................] - ETA: 1s - loss: 0.4980 - accuracy: 0.5448 5/11 [============>.................] - ETA: 1s - loss: 0.5005 - accuracy: 0.5477 6/11 [===============>..............] - ETA: 0s - loss: 0.5022 - accuracy: 0.5521 7/11 [==================>...........] - ETA: 0s - loss: 0.5019 - accuracy: 0.5547 8/11 [====================>.........] - ETA: 0s - loss: 0.5021 - accuracy: 0.5557 9/11 [=======================>......] - ETA: 0s - loss: 0.5019 - accuracy: 0.556910/11 [==========================>...] - ETA: 0s - loss: 0.5009 - accuracy: 0.558411/11 [==============================] - ETA: 0s - loss: 0.4999 - accuracy: 0.559811/11 [==============================] - 2s 176ms/step - loss: 0.4990 - accuracy: 0.5610
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4198 - accuracy: 0.6484 2/11 [====>.........................] - ETA: 1s - loss: 0.4495 - accuracy: 0.6309 3/11 [=======>......................] - ETA: 1s - loss: 0.4572 - accuracy: 0.6150 4/11 [=========>....................] - ETA: 1s - loss: 0.4608 - accuracy: 0.6068 5/11 [============>.................] - ETA: 1s - loss: 0.4631 - accuracy: 0.6020 6/11 [===============>..............] - ETA: 0s - loss: 0.4650 - accuracy: 0.5980 7/11 [==================>...........] - ETA: 0s - loss: 0.4674 - accuracy: 0.5947 8/11 [====================>.........] - ETA: 0s - loss: 0.4692 - accuracy: 0.5909 9/11 [=======================>......] - ETA: 0s - loss: 0.4702 - accuracy: 0.588610/11 [==========================>...] - ETA: 0s - loss: 0.4708 - accuracy: 0.587011/11 [==============================] - ETA: 0s - loss: 0.4714 - accuracy: 0.586011/11 [==============================] - 2s 185ms/step - loss: 0.4719 - accuracy: 0.5852
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4583 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 2s - loss: 0.4552 - accuracy: 0.5645 3/11 [=======>......................] - ETA: 1s - loss: 0.4528 - accuracy: 0.5690 4/11 [=========>....................] - ETA: 1s - loss: 0.4506 - accuracy: 0.5723 5/11 [============>.................] - ETA: 1s - loss: 0.4508 - accuracy: 0.5747 6/11 [===============>..............] - ETA: 0s - loss: 0.4504 - accuracy: 0.5763 7/11 [==================>...........] - ETA: 0s - loss: 0.4487 - accuracy: 0.5785 8/11 [====================>.........] - ETA: 0s - loss: 0.4478 - accuracy: 0.5801 9/11 [=======================>......] - ETA: 0s - loss: 0.4481 - accuracy: 0.580910/11 [==========================>...] - ETA: 0s - loss: 0.4495 - accuracy: 0.581011/11 [==============================] - ETA: 0s - loss: 0.4508 - accuracy: 0.580911/11 [==============================] - 2s 195ms/step - loss: 0.4519 - accuracy: 0.5808
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4913 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 1s - loss: 0.5024 - accuracy: 0.5645 3/11 [=======>......................] - ETA: 1s - loss: 0.4942 - accuracy: 0.5664 4/11 [=========>....................] - ETA: 1s - loss: 0.4901 - accuracy: 0.5693 5/11 [============>.................] - ETA: 1s - loss: 0.4864 - accuracy: 0.5720 6/11 [===============>..............] - ETA: 0s - loss: 0.4830 - accuracy: 0.5737 7/11 [==================>...........] - ETA: 0s - loss: 0.4800 - accuracy: 0.5748 8/11 [====================>.........] - ETA: 0s - loss: 0.4772 - accuracy: 0.5761 9/11 [=======================>......] - ETA: 0s - loss: 0.4749 - accuracy: 0.576510/11 [==========================>...] - ETA: 0s - loss: 0.4729 - accuracy: 0.577411/11 [==============================] - ETA: 0s - loss: 0.4709 - accuracy: 0.577711/11 [==============================] - 2s 187ms/step - loss: 0.4693 - accuracy: 0.5780
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.4766 - accuracy: 0.54693/6 [==============>...............] - ETA: 0s - loss: 0.4593 - accuracy: 0.5729 5/6 [========================>.....] - ETA: 0s - loss: 0.4605 - accuracy: 0.57506/6 [==============================] - 3s 29ms/step - loss: 0.4594 - accuracy: 0.5850
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [0 1 3 4 2] pred: [ 0.14672418  0.09992093 -0.1296847   0.00357926 -0.01373432]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [-5.8547774e-04  9.5649302e-01  9.9509746e-01  1.2482224e-02
  1.5065153e-03]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 4 0] pred: [-0.00438051  0.9639379   0.99707043  0.00375347  0.00148169]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 3 ============
pred sorted: [3 1 0 4 2] pred: [-0.00154825  0.06488031 -0.10101654  0.48868743 -0.00247654]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 4 3 0] pred: [-0.00733597  0.6262429   0.9978109   0.00168498  0.03142755]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [3 1 4 0 2] pred: [ 0.00351899  0.02522965 -0.04305939  0.45141676  0.01810255]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 0 3] pred: [ 0.00173816  0.9928459   0.9991155  -0.00288995  0.04007028]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [0 1 4 3 2] pred: [ 1.6917953e-01  3.9259758e-02 -3.3249074e-01 -6.4037293e-03
  8.0445549e-05]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [3 4 0 2 1] pred: [ 0.00236192 -0.02018533 -0.00318084  0.39810714  0.02696837]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [2 0 3 4 1] pred: [ 5.2449484e-03 -3.8919110e-02  9.9825841e-01  2.1026160e-03
  2.0210235e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [ 3.0760183e-03  9.6305764e-01  9.7561967e-01  9.2091095e-03
 -8.3948864e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 4 3] pred: [0.00508611 0.9606076  0.9989047  0.0013838  0.00464123]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [-0.00785428  0.8575924   0.96126616  0.02880392 -0.01449365]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [0.00178453 0.95274746 0.99724597 0.01045643 0.0066999 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 4 3 0] pred: [-7.7603948e-03  5.6665307e-01  9.9680424e-01  2.8265081e-04
  2.8204557e-02]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 7 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:21 - loss: 1.2545 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 1.2515 - accuracy: 0.4609   3/11 [=======>......................] - ETA: 1s - loss: 1.2555 - accuracy: 0.4679 4/11 [=========>....................] - ETA: 1s - loss: 1.2579 - accuracy: 0.4691 5/11 [============>.................] - ETA: 0s - loss: 1.2567 - accuracy: 0.4681 6/11 [===============>..............] - ETA: 0s - loss: 1.2541 - accuracy: 0.4695 7/11 [==================>...........] - ETA: 0s - loss: 1.2516 - accuracy: 0.4699 8/11 [====================>.........] - ETA: 0s - loss: 1.2486 - accuracy: 0.4700 9/11 [=======================>......] - ETA: 0s - loss: 1.2458 - accuracy: 0.469310/11 [==========================>...] - ETA: 0s - loss: 1.2433 - accuracy: 0.469011/11 [==============================] - ETA: 0s - loss: 1.2410 - accuracy: 0.468711/11 [==============================] - 10s 157ms/step - loss: 1.2391 - accuracy: 0.4684
Epoch 2/20
 1/11 [=>............................] - ETA: 2s - loss: 1.1904 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 2s - loss: 1.1627 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 2s - loss: 1.1512 - accuracy: 0.4575 4/11 [=========>....................] - ETA: 1s - loss: 1.1453 - accuracy: 0.4613 5/11 [============>.................] - ETA: 1s - loss: 1.1386 - accuracy: 0.4662 6/11 [===============>..............] - ETA: 1s - loss: 1.1346 - accuracy: 0.4677 7/11 [==================>...........] - ETA: 0s - loss: 1.1311 - accuracy: 0.4687 8/11 [====================>.........] - ETA: 0s - loss: 1.1280 - accuracy: 0.4685 9/11 [=======================>......] - ETA: 0s - loss: 1.1254 - accuracy: 0.467710/11 [==========================>...] - ETA: 0s - loss: 1.1226 - accuracy: 0.466911/11 [==============================] - ETA: 0s - loss: 1.1193 - accuracy: 0.466911/11 [==============================] - 2s 210ms/step - loss: 1.1165 - accuracy: 0.4668
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 1.0367 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 1s - loss: 1.0248 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 1s - loss: 1.0143 - accuracy: 0.4262 4/11 [=========>....................] - ETA: 1s - loss: 1.0023 - accuracy: 0.4339 5/11 [============>.................] - ETA: 1s - loss: 0.9926 - accuracy: 0.4390 6/11 [===============>..............] - ETA: 0s - loss: 0.9852 - accuracy: 0.4427 7/11 [==================>...........] - ETA: 0s - loss: 0.9768 - accuracy: 0.4467 8/11 [====================>.........] - ETA: 0s - loss: 0.9696 - accuracy: 0.4497 9/11 [=======================>......] - ETA: 0s - loss: 0.9642 - accuracy: 0.451610/11 [==========================>...] - ETA: 0s - loss: 0.9591 - accuracy: 0.453311/11 [==============================] - ETA: 0s - loss: 0.9548 - accuracy: 0.454511/11 [==============================] - 2s 189ms/step - loss: 0.9512 - accuracy: 0.4555
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.9377 - accuracy: 0.3828 2/11 [====>.........................] - ETA: 1s - loss: 0.8884 - accuracy: 0.4180 3/11 [=======>......................] - ETA: 1s - loss: 0.8746 - accuracy: 0.4227 4/11 [=========>....................] - ETA: 1s - loss: 0.8627 - accuracy: 0.4308 5/11 [============>.................] - ETA: 0s - loss: 0.8577 - accuracy: 0.4353 6/11 [===============>..............] - ETA: 0s - loss: 0.8529 - accuracy: 0.4391 7/11 [==================>...........] - ETA: 0s - loss: 0.8492 - accuracy: 0.4419 8/11 [====================>.........] - ETA: 0s - loss: 0.8459 - accuracy: 0.4442 9/11 [=======================>......] - ETA: 0s - loss: 0.8432 - accuracy: 0.446010/11 [==========================>...] - ETA: 0s - loss: 0.8409 - accuracy: 0.447711/11 [==============================] - ETA: 0s - loss: 0.8383 - accuracy: 0.449411/11 [==============================] - 2s 152ms/step - loss: 0.8362 - accuracy: 0.4508
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8083 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.8012 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 1s - loss: 0.8038 - accuracy: 0.4648 4/11 [=========>....................] - ETA: 1s - loss: 0.8052 - accuracy: 0.4644 5/11 [============>.................] - ETA: 0s - loss: 0.8123 - accuracy: 0.4599 6/11 [===============>..............] - ETA: 0s - loss: 0.8122 - accuracy: 0.4599 7/11 [==================>...........] - ETA: 0s - loss: 0.8123 - accuracy: 0.4589 8/11 [====================>.........] - ETA: 0s - loss: 0.8114 - accuracy: 0.4590 9/11 [=======================>......] - ETA: 0s - loss: 0.8112 - accuracy: 0.459010/11 [==========================>...] - ETA: 0s - loss: 0.8104 - accuracy: 0.459611/11 [==============================] - ETA: 0s - loss: 0.8093 - accuracy: 0.460311/11 [==============================] - 2s 147ms/step - loss: 0.8084 - accuracy: 0.4609
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.9005 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 1s - loss: 0.8674 - accuracy: 0.4258 3/11 [=======>......................] - ETA: 1s - loss: 0.8559 - accuracy: 0.4306 4/11 [=========>....................] - ETA: 1s - loss: 0.8458 - accuracy: 0.4347 5/11 [============>.................] - ETA: 1s - loss: 0.8386 - accuracy: 0.4393 6/11 [===============>..............] - ETA: 0s - loss: 0.8326 - accuracy: 0.4429 7/11 [==================>...........] - ETA: 0s - loss: 0.8286 - accuracy: 0.4446 8/11 [====================>.........] - ETA: 0s - loss: 0.8252 - accuracy: 0.4462 9/11 [=======================>......] - ETA: 0s - loss: 0.8212 - accuracy: 0.448210/11 [==========================>...] - ETA: 0s - loss: 0.8166 - accuracy: 0.450811/11 [==============================] - ETA: 0s - loss: 0.8130 - accuracy: 0.452911/11 [==============================] - 2s 175ms/step - loss: 0.8101 - accuracy: 0.4545
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8360 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.8557 - accuracy: 0.4180 3/11 [=======>......................] - ETA: 1s - loss: 0.8440 - accuracy: 0.4227 4/11 [=========>....................] - ETA: 1s - loss: 0.8323 - accuracy: 0.4289 5/11 [============>.................] - ETA: 1s - loss: 0.8255 - accuracy: 0.4328 6/11 [===============>..............] - ETA: 0s - loss: 0.8189 - accuracy: 0.4373 7/11 [==================>...........] - ETA: 0s - loss: 0.8123 - accuracy: 0.4422 8/11 [====================>.........] - ETA: 0s - loss: 0.8060 - accuracy: 0.4470 9/11 [=======================>......] - ETA: 0s - loss: 0.7998 - accuracy: 0.451610/11 [==========================>...] - ETA: 0s - loss: 0.7959 - accuracy: 0.454811/11 [==============================] - ETA: 0s - loss: 0.7925 - accuracy: 0.457411/11 [==============================] - 2s 179ms/step - loss: 0.7896 - accuracy: 0.4596
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7486 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.7583 - accuracy: 0.5059 3/11 [=======>......................] - ETA: 1s - loss: 0.7645 - accuracy: 0.5004 4/11 [=========>....................] - ETA: 1s - loss: 0.7671 - accuracy: 0.4974 5/11 [============>.................] - ETA: 1s - loss: 0.7654 - accuracy: 0.4970 6/11 [===============>..............] - ETA: 0s - loss: 0.7624 - accuracy: 0.4979 7/11 [==================>...........] - ETA: 0s - loss: 0.7589 - accuracy: 0.4992 8/11 [====================>.........] - ETA: 0s - loss: 0.7579 - accuracy: 0.4981 9/11 [=======================>......] - ETA: 0s - loss: 0.7567 - accuracy: 0.497510/11 [==========================>...] - ETA: 0s - loss: 0.7557 - accuracy: 0.497011/11 [==============================] - ETA: 0s - loss: 0.7543 - accuracy: 0.497011/11 [==============================] - 2s 171ms/step - loss: 0.7532 - accuracy: 0.4969
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6099 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 1s - loss: 0.6624 - accuracy: 0.5293 3/11 [=======>......................] - ETA: 1s - loss: 0.6825 - accuracy: 0.5204 4/11 [=========>....................] - ETA: 1s - loss: 0.7000 - accuracy: 0.5104 5/11 [============>.................] - ETA: 1s - loss: 0.7076 - accuracy: 0.5055 6/11 [===============>..............] - ETA: 1s - loss: 0.7139 - accuracy: 0.5016 7/11 [==================>...........] - ETA: 0s - loss: 0.7179 - accuracy: 0.4996 8/11 [====================>.........] - ETA: 0s - loss: 0.7198 - accuracy: 0.4984 9/11 [=======================>......] - ETA: 0s - loss: 0.7212 - accuracy: 0.497910/11 [==========================>...] - ETA: 0s - loss: 0.7212 - accuracy: 0.498611/11 [==============================] - ETA: 0s - loss: 0.7215 - accuracy: 0.498911/11 [==============================] - 2s 202ms/step - loss: 0.7217 - accuracy: 0.4991
Epoch 10/20
 1/11 [=>............................] - ETA: 2s - loss: 0.6861 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 2s - loss: 0.6711 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 1s - loss: 0.6783 - accuracy: 0.5148 4/11 [=========>....................] - ETA: 1s - loss: 0.6828 - accuracy: 0.5150 5/11 [============>.................] - ETA: 1s - loss: 0.6861 - accuracy: 0.5142 6/11 [===============>..............] - ETA: 0s - loss: 0.6863 - accuracy: 0.5148 7/11 [==================>...........] - ETA: 0s - loss: 0.6868 - accuracy: 0.5145 8/11 [====================>.........] - ETA: 0s - loss: 0.6877 - accuracy: 0.5139 9/11 [=======================>......] - ETA: 0s - loss: 0.6893 - accuracy: 0.512910/11 [==========================>...] - ETA: 0s - loss: 0.6905 - accuracy: 0.512311/11 [==============================] - ETA: 0s - loss: 0.6920 - accuracy: 0.511411/11 [==============================] - 2s 162ms/step - loss: 0.6933 - accuracy: 0.5106
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7234 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.7158 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 1s - loss: 0.7170 - accuracy: 0.5069 4/11 [=========>....................] - ETA: 1s - loss: 0.7150 - accuracy: 0.5072 5/11 [============>.................] - ETA: 0s - loss: 0.7136 - accuracy: 0.5064 6/11 [===============>..............] - ETA: 0s - loss: 0.7116 - accuracy: 0.5051 7/11 [==================>...........] - ETA: 0s - loss: 0.7099 - accuracy: 0.5040 8/11 [====================>.........] - ETA: 0s - loss: 0.7082 - accuracy: 0.5033 9/11 [=======================>......] - ETA: 0s - loss: 0.7072 - accuracy: 0.502610/11 [==========================>...] - ETA: 0s - loss: 0.7057 - accuracy: 0.502711/11 [==============================] - ETA: 0s - loss: 0.7040 - accuracy: 0.502911/11 [==============================] - 2s 150ms/step - loss: 0.7025 - accuracy: 0.5031
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7239 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.7130 - accuracy: 0.4980 3/11 [=======>......................] - ETA: 1s - loss: 0.7068 - accuracy: 0.5039 4/11 [=========>....................] - ETA: 0s - loss: 0.7025 - accuracy: 0.5059 5/11 [============>.................] - ETA: 0s - loss: 0.7007 - accuracy: 0.5059 6/11 [===============>..............] - ETA: 0s - loss: 0.6965 - accuracy: 0.5071 7/11 [==================>...........] - ETA: 0s - loss: 0.6919 - accuracy: 0.5082 8/11 [====================>.........] - ETA: 0s - loss: 0.6888 - accuracy: 0.5085 9/11 [=======================>......] - ETA: 0s - loss: 0.6863 - accuracy: 0.508710/11 [==========================>...] - ETA: 0s - loss: 0.6836 - accuracy: 0.509111/11 [==============================] - ETA: 0s - loss: 0.6820 - accuracy: 0.509411/11 [==============================] - 2s 163ms/step - loss: 0.6807 - accuracy: 0.5096
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6541 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.6338 - accuracy: 0.5332 3/11 [=======>......................] - ETA: 1s - loss: 0.6398 - accuracy: 0.5256 4/11 [=========>....................] - ETA: 1s - loss: 0.6443 - accuracy: 0.5197 5/11 [============>.................] - ETA: 1s - loss: 0.6465 - accuracy: 0.5167 6/11 [===============>..............] - ETA: 0s - loss: 0.6489 - accuracy: 0.5143 7/11 [==================>...........] - ETA: 0s - loss: 0.6494 - accuracy: 0.5140 8/11 [====================>.........] - ETA: 0s - loss: 0.6498 - accuracy: 0.5138 9/11 [=======================>......] - ETA: 0s - loss: 0.6494 - accuracy: 0.513510/11 [==========================>...] - ETA: 0s - loss: 0.6484 - accuracy: 0.513811/11 [==============================] - ETA: 0s - loss: 0.6477 - accuracy: 0.514211/11 [==============================] - 2s 189ms/step - loss: 0.6472 - accuracy: 0.5145
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6187 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.6207 - accuracy: 0.5098 3/11 [=======>......................] - ETA: 1s - loss: 0.6293 - accuracy: 0.5109 4/11 [=========>....................] - ETA: 1s - loss: 0.6326 - accuracy: 0.5111 5/11 [============>.................] - ETA: 0s - loss: 0.6345 - accuracy: 0.5129 6/11 [===============>..............] - ETA: 0s - loss: 0.6342 - accuracy: 0.5142 7/11 [==================>...........] - ETA: 0s - loss: 0.6333 - accuracy: 0.5156 8/11 [====================>.........] - ETA: 0s - loss: 0.6321 - accuracy: 0.5169 9/11 [=======================>......] - ETA: 0s - loss: 0.6300 - accuracy: 0.518610/11 [==========================>...] - ETA: 0s - loss: 0.6287 - accuracy: 0.519811/11 [==============================] - ETA: 0s - loss: 0.6274 - accuracy: 0.521011/11 [==============================] - 2s 159ms/step - loss: 0.6263 - accuracy: 0.5221
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6467 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.6345 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 1s - loss: 0.6208 - accuracy: 0.5295 4/11 [=========>....................] - ETA: 1s - loss: 0.6109 - accuracy: 0.5382 5/11 [============>.................] - ETA: 1s - loss: 0.6079 - accuracy: 0.5412 6/11 [===============>..............] - ETA: 0s - loss: 0.6080 - accuracy: 0.5433 7/11 [==================>...........] - ETA: 0s - loss: 0.6082 - accuracy: 0.5447 8/11 [====================>.........] - ETA: 0s - loss: 0.6069 - accuracy: 0.5461 9/11 [=======================>......] - ETA: 0s - loss: 0.6049 - accuracy: 0.546610/11 [==========================>...] - ETA: 0s - loss: 0.6035 - accuracy: 0.546611/11 [==============================] - ETA: 0s - loss: 0.6022 - accuracy: 0.546911/11 [==============================] - 2s 194ms/step - loss: 0.6011 - accuracy: 0.5471
Epoch 16/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5745 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 1s - loss: 0.5651 - accuracy: 0.6484 3/11 [=======>......................] - ETA: 1s - loss: 0.5571 - accuracy: 0.6328 4/11 [=========>....................] - ETA: 1s - loss: 0.5544 - accuracy: 0.6245 5/11 [============>.................] - ETA: 1s - loss: 0.5546 - accuracy: 0.6162 6/11 [===============>..............] - ETA: 1s - loss: 0.5571 - accuracy: 0.6083 7/11 [==================>...........] - ETA: 0s - loss: 0.5600 - accuracy: 0.6024 8/11 [====================>.........] - ETA: 0s - loss: 0.5619 - accuracy: 0.5974 9/11 [=======================>......] - ETA: 0s - loss: 0.5631 - accuracy: 0.592710/11 [==========================>...] - ETA: 0s - loss: 0.5635 - accuracy: 0.589111/11 [==============================] - ETA: 0s - loss: 0.5637 - accuracy: 0.585711/11 [==============================] - 2s 201ms/step - loss: 0.5639 - accuracy: 0.5829
Epoch 17/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5951 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 1s - loss: 0.5841 - accuracy: 0.5605 3/11 [=======>......................] - ETA: 1s - loss: 0.5825 - accuracy: 0.5569 4/11 [=========>....................] - ETA: 1s - loss: 0.5810 - accuracy: 0.5592 5/11 [============>.................] - ETA: 1s - loss: 0.5798 - accuracy: 0.5615 6/11 [===============>..............] - ETA: 0s - loss: 0.5786 - accuracy: 0.5621 7/11 [==================>...........] - ETA: 0s - loss: 0.5760 - accuracy: 0.5634 8/11 [====================>.........] - ETA: 0s - loss: 0.5734 - accuracy: 0.5644 9/11 [=======================>......] - ETA: 0s - loss: 0.5713 - accuracy: 0.565910/11 [==========================>...] - ETA: 0s - loss: 0.5687 - accuracy: 0.567511/11 [==============================] - ETA: 0s - loss: 0.5666 - accuracy: 0.569111/11 [==============================] - 2s 202ms/step - loss: 0.5648 - accuracy: 0.5704
Epoch 18/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5603 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 2s - loss: 0.5429 - accuracy: 0.6289 3/11 [=======>......................] - ETA: 1s - loss: 0.5430 - accuracy: 0.6207 4/11 [=========>....................] - ETA: 1s - loss: 0.5415 - accuracy: 0.6144 5/11 [============>.................] - ETA: 1s - loss: 0.5367 - accuracy: 0.6103 6/11 [===============>..............] - ETA: 1s - loss: 0.5353 - accuracy: 0.6071 7/11 [==================>...........] - ETA: 0s - loss: 0.5344 - accuracy: 0.6050 8/11 [====================>.........] - ETA: 0s - loss: 0.5330 - accuracy: 0.6048 9/11 [=======================>......] - ETA: 0s - loss: 0.5316 - accuracy: 0.604710/11 [==========================>...] - ETA: 0s - loss: 0.5309 - accuracy: 0.604211/11 [==============================] - ETA: 0s - loss: 0.5303 - accuracy: 0.603811/11 [==============================] - 2s 204ms/step - loss: 0.5299 - accuracy: 0.6034
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5454 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 1s - loss: 0.5478 - accuracy: 0.6133 3/11 [=======>......................] - ETA: 1s - loss: 0.5404 - accuracy: 0.6102 4/11 [=========>....................] - ETA: 1s - loss: 0.5331 - accuracy: 0.6134 5/11 [============>.................] - ETA: 1s - loss: 0.5280 - accuracy: 0.6139 6/11 [===============>..............] - ETA: 0s - loss: 0.5252 - accuracy: 0.6136 7/11 [==================>...........] - ETA: 0s - loss: 0.5225 - accuracy: 0.6131 8/11 [====================>.........] - ETA: 0s - loss: 0.5201 - accuracy: 0.6118 9/11 [=======================>......] - ETA: 0s - loss: 0.5184 - accuracy: 0.611710/11 [==========================>...] - ETA: 0s - loss: 0.5161 - accuracy: 0.611811/11 [==============================] - ETA: 0s - loss: 0.5149 - accuracy: 0.612511/11 [==============================] - 2s 184ms/step - loss: 0.5139 - accuracy: 0.6130
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4851 - accuracy: 0.6016 2/11 [====>.........................] - ETA: 1s - loss: 0.4910 - accuracy: 0.6074 3/11 [=======>......................] - ETA: 1s - loss: 0.4874 - accuracy: 0.6150 4/11 [=========>....................] - ETA: 1s - loss: 0.4849 - accuracy: 0.6185 5/11 [============>.................] - ETA: 1s - loss: 0.4849 - accuracy: 0.6220 6/11 [===============>..............] - ETA: 0s - loss: 0.4853 - accuracy: 0.6260 7/11 [==================>...........] - ETA: 0s - loss: 0.4863 - accuracy: 0.6271 8/11 [====================>.........] - ETA: 0s - loss: 0.4863 - accuracy: 0.6278 9/11 [=======================>......] - ETA: 0s - loss: 0.4862 - accuracy: 0.628110/11 [==========================>...] - ETA: 0s - loss: 0.4867 - accuracy: 0.628111/11 [==============================] - ETA: 0s - loss: 0.4870 - accuracy: 0.628111/11 [==============================] - 2s 195ms/step - loss: 0.4873 - accuracy: 0.6282
Evaluate on test data
1/6 [====>.........................] - ETA: 11s - loss: 0.5301 - accuracy: 0.59383/6 [==============>...............] - ETA: 0s - loss: 0.4892 - accuracy: 0.6146 5/6 [========================>.....] - ETA: 0s - loss: 0.4873 - accuracy: 0.61566/6 [==============================] - 2s 36ms/step - loss: 0.4893 - accuracy: 0.6161
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [-0.01153116  0.95228004  0.9988552   0.01145101  0.00115934]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [-0.00976936  0.95597005  0.98798203  0.02081463 -0.0020175 ]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [-0.00140059  0.89393383  0.9430548   0.01094521 -0.00589529]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 4 3 0 1] pred: [-0.01117155 -0.09129487  0.9988615  -0.00356372  0.00308949]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [-0.01230192  0.9209913   0.98675424  0.02092917 -0.0019661 ]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 4 0] pred: [-0.007797    0.8500897   0.99498916  0.01382915 -0.00337807]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [3 1 0 4 2] pred: [-0.00139638  0.05819793 -0.13855897  0.26846516 -0.00206116]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 4 0] pred: [-0.02167543  0.02398922  0.99863863  0.00637198 -0.00278819]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 4 3 0 1] pred: [-0.01491617 -0.09332998  0.9987799   0.00209173  0.0125157 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 4 0] pred: [-0.01259405  0.95790297  0.99822986  0.00801862 -0.00381933]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [ 9.4697736e-03  6.8329595e-02  9.9946886e-01  9.6025848e-04
 -7.6066428e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 0 2 1] pred: [ 0.0121765  -0.06891182  0.00888064  0.2483372   0.05502082]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 0 3] pred: [ 0.00130496  0.96399456  0.9715244  -0.00537183  0.02551674]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [-1.4737012e-02  9.6209025e-01  9.9279904e-01  1.3489439e-02
  3.5463995e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [-0.00796491  0.78917146  0.9989746   0.02341251  0.00323844]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 8 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:16 - loss: 1.3027 - accuracy: 0.0469 2/11 [====>.........................] - ETA: 1s - loss: 1.3019 - accuracy: 0.0703   3/11 [=======>......................] - ETA: 1s - loss: 1.3027 - accuracy: 0.0981 4/11 [=========>....................] - ETA: 1s - loss: 1.3023 - accuracy: 0.1292 5/11 [============>.................] - ETA: 1s - loss: 1.3002 - accuracy: 0.1556 6/11 [===============>..............] - ETA: 0s - loss: 1.2964 - accuracy: 0.1800 7/11 [==================>...........] - ETA: 0s - loss: 1.2935 - accuracy: 0.2004 8/11 [====================>.........] - ETA: 0s - loss: 1.2897 - accuracy: 0.2188 9/11 [=======================>......] - ETA: 0s - loss: 1.2863 - accuracy: 0.234710/11 [==========================>...] - ETA: 0s - loss: 1.2841 - accuracy: 0.247711/11 [==============================] - ETA: 0s - loss: 1.2820 - accuracy: 0.259111/11 [==============================] - 9s 182ms/step - loss: 1.2803 - accuracy: 0.2685
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 1.2145 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 1.1941 - accuracy: 0.4629 3/11 [=======>......................] - ETA: 1s - loss: 1.1912 - accuracy: 0.4692 4/11 [=========>....................] - ETA: 0s - loss: 1.1896 - accuracy: 0.4725 5/11 [============>.................] - ETA: 0s - loss: 1.1885 - accuracy: 0.4708 6/11 [===============>..............] - ETA: 0s - loss: 1.1883 - accuracy: 0.4696 7/11 [==================>...........] - ETA: 0s - loss: 1.1896 - accuracy: 0.4682 8/11 [====================>.........] - ETA: 0s - loss: 1.1900 - accuracy: 0.4673 9/11 [=======================>......] - ETA: 0s - loss: 1.1897 - accuracy: 0.467010/11 [==========================>...] - ETA: 0s - loss: 1.1894 - accuracy: 0.466111/11 [==============================] - ETA: 0s - loss: 1.1892 - accuracy: 0.465211/11 [==============================] - 2s 168ms/step - loss: 1.1891 - accuracy: 0.4645
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 1.1404 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 1.1406 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 1s - loss: 1.1440 - accuracy: 0.4614 4/11 [=========>....................] - ETA: 1s - loss: 1.1438 - accuracy: 0.4564 5/11 [============>.................] - ETA: 1s - loss: 1.1419 - accuracy: 0.4532 6/11 [===============>..............] - ETA: 0s - loss: 1.1394 - accuracy: 0.4504 7/11 [==================>...........] - ETA: 0s - loss: 1.1360 - accuracy: 0.4490 8/11 [====================>.........] - ETA: 0s - loss: 1.1323 - accuracy: 0.4489 9/11 [=======================>......] - ETA: 0s - loss: 1.1290 - accuracy: 0.448510/11 [==========================>...] - ETA: 0s - loss: 1.1245 - accuracy: 0.449511/11 [==============================] - ETA: 0s - loss: 1.1206 - accuracy: 0.449911/11 [==============================] - 2s 179ms/step - loss: 1.1174 - accuracy: 0.4503
Epoch 4/20
 1/11 [=>............................] - ETA: 2s - loss: 1.0185 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.9978 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 1s - loss: 0.9839 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 1s - loss: 0.9745 - accuracy: 0.4644 5/11 [============>.................] - ETA: 1s - loss: 0.9681 - accuracy: 0.4652 6/11 [===============>..............] - ETA: 0s - loss: 0.9634 - accuracy: 0.4647 7/11 [==================>...........] - ETA: 0s - loss: 0.9604 - accuracy: 0.4628 8/11 [====================>.........] - ETA: 0s - loss: 0.9567 - accuracy: 0.4617 9/11 [=======================>......] - ETA: 0s - loss: 0.9530 - accuracy: 0.460810/11 [==========================>...] - ETA: 0s - loss: 0.9500 - accuracy: 0.459911/11 [==============================] - ETA: 0s - loss: 0.9466 - accuracy: 0.459411/11 [==============================] - 2s 169ms/step - loss: 0.9438 - accuracy: 0.4590
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8781 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 2s - loss: 0.8696 - accuracy: 0.4395 3/11 [=======>......................] - ETA: 1s - loss: 0.8633 - accuracy: 0.4431 4/11 [=========>....................] - ETA: 1s - loss: 0.8579 - accuracy: 0.4447 5/11 [============>.................] - ETA: 1s - loss: 0.8510 - accuracy: 0.4492 6/11 [===============>..............] - ETA: 0s - loss: 0.8480 - accuracy: 0.4500 7/11 [==================>...........] - ETA: 0s - loss: 0.8463 - accuracy: 0.4505 8/11 [====================>.........] - ETA: 0s - loss: 0.8453 - accuracy: 0.4504 9/11 [=======================>......] - ETA: 0s - loss: 0.8446 - accuracy: 0.450110/11 [==========================>...] - ETA: 0s - loss: 0.8438 - accuracy: 0.450111/11 [==============================] - ETA: 0s - loss: 0.8424 - accuracy: 0.450511/11 [==============================] - 2s 165ms/step - loss: 0.8413 - accuracy: 0.4510
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7981 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.8273 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 1s - loss: 0.8387 - accuracy: 0.4618 4/11 [=========>....................] - ETA: 1s - loss: 0.8430 - accuracy: 0.4572 5/11 [============>.................] - ETA: 1s - loss: 0.8452 - accuracy: 0.4533 6/11 [===============>..............] - ETA: 0s - loss: 0.8414 - accuracy: 0.4537 7/11 [==================>...........] - ETA: 0s - loss: 0.8383 - accuracy: 0.4539 8/11 [====================>.........] - ETA: 0s - loss: 0.8338 - accuracy: 0.4556 9/11 [=======================>......] - ETA: 0s - loss: 0.8305 - accuracy: 0.456110/11 [==========================>...] - ETA: 0s - loss: 0.8282 - accuracy: 0.456211/11 [==============================] - ETA: 0s - loss: 0.8258 - accuracy: 0.456311/11 [==============================] - 2s 163ms/step - loss: 0.8239 - accuracy: 0.4565
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7993 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.8046 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 1s - loss: 0.8014 - accuracy: 0.4709 4/11 [=========>....................] - ETA: 1s - loss: 0.7957 - accuracy: 0.4684 5/11 [============>.................] - ETA: 1s - loss: 0.7966 - accuracy: 0.4641 6/11 [===============>..............] - ETA: 0s - loss: 0.7970 - accuracy: 0.4605 7/11 [==================>...........] - ETA: 0s - loss: 0.7971 - accuracy: 0.4584 8/11 [====================>.........] - ETA: 0s - loss: 0.7954 - accuracy: 0.4581 9/11 [=======================>......] - ETA: 0s - loss: 0.7945 - accuracy: 0.457110/11 [==========================>...] - ETA: 0s - loss: 0.7933 - accuracy: 0.456911/11 [==============================] - ETA: 0s - loss: 0.7918 - accuracy: 0.457111/11 [==============================] - 2s 167ms/step - loss: 0.7905 - accuracy: 0.4573
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8468 - accuracy: 0.3906 2/11 [====>.........................] - ETA: 1s - loss: 0.8420 - accuracy: 0.4023 3/11 [=======>......................] - ETA: 1s - loss: 0.8244 - accuracy: 0.4167 4/11 [=========>....................] - ETA: 1s - loss: 0.8105 - accuracy: 0.4307 5/11 [============>.................] - ETA: 1s - loss: 0.8052 - accuracy: 0.4367 6/11 [===============>..............] - ETA: 0s - loss: 0.7996 - accuracy: 0.4416 7/11 [==================>...........] - ETA: 0s - loss: 0.7941 - accuracy: 0.4466 8/11 [====================>.........] - ETA: 0s - loss: 0.7892 - accuracy: 0.4507 9/11 [=======================>......] - ETA: 0s - loss: 0.7847 - accuracy: 0.453910/11 [==========================>...] - ETA: 0s - loss: 0.7806 - accuracy: 0.456011/11 [==============================] - ETA: 0s - loss: 0.7777 - accuracy: 0.457711/11 [==============================] - 2s 182ms/step - loss: 0.7753 - accuracy: 0.4592
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7591 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.7612 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 1s - loss: 0.7526 - accuracy: 0.5000 4/11 [=========>....................] - ETA: 1s - loss: 0.7391 - accuracy: 0.5020 5/11 [============>.................] - ETA: 1s - loss: 0.7340 - accuracy: 0.5000 6/11 [===============>..............] - ETA: 0s - loss: 0.7319 - accuracy: 0.4978 7/11 [==================>...........] - ETA: 0s - loss: 0.7312 - accuracy: 0.4957 8/11 [====================>.........] - ETA: 0s - loss: 0.7306 - accuracy: 0.4943 9/11 [=======================>......] - ETA: 0s - loss: 0.7296 - accuracy: 0.493310/11 [==========================>...] - ETA: 0s - loss: 0.7290 - accuracy: 0.492011/11 [==============================] - ETA: 0s - loss: 0.7283 - accuracy: 0.491211/11 [==============================] - 2s 167ms/step - loss: 0.7278 - accuracy: 0.4905
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6658 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.6952 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 1s - loss: 0.6997 - accuracy: 0.4796 4/11 [=========>....................] - ETA: 1s - loss: 0.6973 - accuracy: 0.4823 5/11 [============>.................] - ETA: 1s - loss: 0.6949 - accuracy: 0.4871 6/11 [===============>..............] - ETA: 0s - loss: 0.6949 - accuracy: 0.4890 7/11 [==================>...........] - ETA: 0s - loss: 0.6950 - accuracy: 0.4910 8/11 [====================>.........] - ETA: 0s - loss: 0.6942 - accuracy: 0.4920 9/11 [=======================>......] - ETA: 0s - loss: 0.6947 - accuracy: 0.491710/11 [==========================>...] - ETA: 0s - loss: 0.6954 - accuracy: 0.491611/11 [==============================] - ETA: 0s - loss: 0.6957 - accuracy: 0.491511/11 [==============================] - 2s 184ms/step - loss: 0.6960 - accuracy: 0.4914
Epoch 11/20
 1/11 [=>............................] - ETA: 2s - loss: 0.6203 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.6332 - accuracy: 0.5020 3/11 [=======>......................] - ETA: 1s - loss: 0.6368 - accuracy: 0.5048 4/11 [=========>....................] - ETA: 1s - loss: 0.6385 - accuracy: 0.5055 5/11 [============>.................] - ETA: 1s - loss: 0.6414 - accuracy: 0.5063 6/11 [===============>..............] - ETA: 0s - loss: 0.6437 - accuracy: 0.5076 7/11 [==================>...........] - ETA: 0s - loss: 0.6446 - accuracy: 0.5101 8/11 [====================>.........] - ETA: 0s - loss: 0.6457 - accuracy: 0.5105 9/11 [=======================>......] - ETA: 0s - loss: 0.6468 - accuracy: 0.511010/11 [==========================>...] - ETA: 0s - loss: 0.6490 - accuracy: 0.510011/11 [==============================] - ETA: 0s - loss: 0.6514 - accuracy: 0.508511/11 [==============================] - 2s 161ms/step - loss: 0.6535 - accuracy: 0.5073
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5866 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.5797 - accuracy: 0.5176 3/11 [=======>......................] - ETA: 1s - loss: 0.5938 - accuracy: 0.5169 4/11 [=========>....................] - ETA: 1s - loss: 0.6075 - accuracy: 0.5142 5/11 [============>.................] - ETA: 0s - loss: 0.6161 - accuracy: 0.5107 6/11 [===============>..............] - ETA: 0s - loss: 0.6215 - accuracy: 0.5081 7/11 [==================>...........] - ETA: 0s - loss: 0.6265 - accuracy: 0.5072 8/11 [====================>.........] - ETA: 0s - loss: 0.6306 - accuracy: 0.5053 9/11 [=======================>......] - ETA: 0s - loss: 0.6337 - accuracy: 0.504510/11 [==========================>...] - ETA: 0s - loss: 0.6359 - accuracy: 0.503711/11 [==============================] - ETA: 0s - loss: 0.6376 - accuracy: 0.503211/11 [==============================] - 2s 161ms/step - loss: 0.6390 - accuracy: 0.5027
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7150 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.7042 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 1s - loss: 0.6855 - accuracy: 0.4618 4/11 [=========>....................] - ETA: 1s - loss: 0.6757 - accuracy: 0.4694 5/11 [============>.................] - ETA: 1s - loss: 0.6688 - accuracy: 0.4749 6/11 [===============>..............] - ETA: 0s - loss: 0.6635 - accuracy: 0.4789 7/11 [==================>...........] - ETA: 0s - loss: 0.6607 - accuracy: 0.4809 8/11 [====================>.........] - ETA: 0s - loss: 0.6588 - accuracy: 0.4826 9/11 [=======================>......] - ETA: 0s - loss: 0.6574 - accuracy: 0.484210/11 [==========================>...] - ETA: 0s - loss: 0.6555 - accuracy: 0.485511/11 [==============================] - ETA: 0s - loss: 0.6534 - accuracy: 0.486811/11 [==============================] - 2s 172ms/step - loss: 0.6517 - accuracy: 0.4879
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6055 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.5879 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 1s - loss: 0.5868 - accuracy: 0.5017 4/11 [=========>....................] - ETA: 1s - loss: 0.5852 - accuracy: 0.5052 5/11 [============>.................] - ETA: 1s - loss: 0.5863 - accuracy: 0.5082 6/11 [===============>..............] - ETA: 0s - loss: 0.5886 - accuracy: 0.5086 7/11 [==================>...........] - ETA: 0s - loss: 0.5906 - accuracy: 0.5096 8/11 [====================>.........] - ETA: 0s - loss: 0.5930 - accuracy: 0.5101 9/11 [=======================>......] - ETA: 0s - loss: 0.5949 - accuracy: 0.509910/11 [==========================>...] - ETA: 0s - loss: 0.5969 - accuracy: 0.509511/11 [==============================] - ETA: 0s - loss: 0.5984 - accuracy: 0.509211/11 [==============================] - 2s 171ms/step - loss: 0.5997 - accuracy: 0.5090
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5872 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.6045 - accuracy: 0.5410 3/11 [=======>......................] - ETA: 1s - loss: 0.6090 - accuracy: 0.5317 4/11 [=========>....................] - ETA: 1s - loss: 0.6141 - accuracy: 0.5286 5/11 [============>.................] - ETA: 1s - loss: 0.6127 - accuracy: 0.5267 6/11 [===============>..............] - ETA: 0s - loss: 0.6127 - accuracy: 0.5272 7/11 [==================>...........] - ETA: 0s - loss: 0.6125 - accuracy: 0.5272 8/11 [====================>.........] - ETA: 0s - loss: 0.6116 - accuracy: 0.5264 9/11 [=======================>......] - ETA: 0s - loss: 0.6099 - accuracy: 0.526410/11 [==========================>...] - ETA: 0s - loss: 0.6087 - accuracy: 0.526411/11 [==============================] - ETA: 0s - loss: 0.6071 - accuracy: 0.526511/11 [==============================] - 2s 159ms/step - loss: 0.6059 - accuracy: 0.5266
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6360 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.6372 - accuracy: 0.5078 3/11 [=======>......................] - ETA: 1s - loss: 0.6316 - accuracy: 0.5226 4/11 [=========>....................] - ETA: 1s - loss: 0.6258 - accuracy: 0.5291 5/11 [============>.................] - ETA: 0s - loss: 0.6206 - accuracy: 0.5314 6/11 [===============>..............] - ETA: 0s - loss: 0.6146 - accuracy: 0.5349 7/11 [==================>...........] - ETA: 0s - loss: 0.6113 - accuracy: 0.5369 8/11 [====================>.........] - ETA: 0s - loss: 0.6072 - accuracy: 0.5380 9/11 [=======================>......] - ETA: 0s - loss: 0.6040 - accuracy: 0.539610/11 [==========================>...] - ETA: 0s - loss: 0.6012 - accuracy: 0.540611/11 [==============================] - ETA: 0s - loss: 0.5985 - accuracy: 0.542111/11 [==============================] - 2s 163ms/step - loss: 0.5963 - accuracy: 0.5434
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6292 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.6336 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 1s - loss: 0.6224 - accuracy: 0.5451 4/11 [=========>....................] - ETA: 1s - loss: 0.6217 - accuracy: 0.5509 5/11 [============>.................] - ETA: 1s - loss: 0.6154 - accuracy: 0.5561 6/11 [===============>..............] - ETA: 0s - loss: 0.6091 - accuracy: 0.5623 7/11 [==================>...........] - ETA: 0s - loss: 0.6024 - accuracy: 0.5656 8/11 [====================>.........] - ETA: 0s - loss: 0.5978 - accuracy: 0.5676 9/11 [=======================>......] - ETA: 0s - loss: 0.5940 - accuracy: 0.569310/11 [==========================>...] - ETA: 0s - loss: 0.5903 - accuracy: 0.570511/11 [==============================] - ETA: 0s - loss: 0.5875 - accuracy: 0.571611/11 [==============================] - 2s 173ms/step - loss: 0.5852 - accuracy: 0.5725
Epoch 18/20
 1/11 [=>............................] - ETA: 2s - loss: 0.4935 - accuracy: 0.6250 2/11 [====>.........................] - ETA: 2s - loss: 0.5164 - accuracy: 0.6133 3/11 [=======>......................] - ETA: 1s - loss: 0.5253 - accuracy: 0.6068 4/11 [=========>....................] - ETA: 1s - loss: 0.5314 - accuracy: 0.5986 5/11 [============>.................] - ETA: 1s - loss: 0.5342 - accuracy: 0.5942 6/11 [===============>..............] - ETA: 0s - loss: 0.5353 - accuracy: 0.5907 7/11 [==================>...........] - ETA: 0s - loss: 0.5347 - accuracy: 0.5884 8/11 [====================>.........] - ETA: 0s - loss: 0.5354 - accuracy: 0.5867 9/11 [=======================>......] - ETA: 0s - loss: 0.5356 - accuracy: 0.586710/11 [==========================>...] - ETA: 0s - loss: 0.5358 - accuracy: 0.587511/11 [==============================] - ETA: 0s - loss: 0.5362 - accuracy: 0.588011/11 [==============================] - 2s 168ms/step - loss: 0.5365 - accuracy: 0.5884
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4844 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 1s - loss: 0.4780 - accuracy: 0.6797 3/11 [=======>......................] - ETA: 1s - loss: 0.4792 - accuracy: 0.6701 4/11 [=========>....................] - ETA: 1s - loss: 0.4800 - accuracy: 0.6598 5/11 [============>.................] - ETA: 0s - loss: 0.4829 - accuracy: 0.6522 6/11 [===============>..............] - ETA: 0s - loss: 0.4877 - accuracy: 0.6460 7/11 [==================>...........] - ETA: 0s - loss: 0.4941 - accuracy: 0.6425 8/11 [====================>.........] - ETA: 0s - loss: 0.4978 - accuracy: 0.6394 9/11 [=======================>......] - ETA: 0s - loss: 0.5005 - accuracy: 0.637210/11 [==========================>...] - ETA: 0s - loss: 0.5023 - accuracy: 0.636011/11 [==============================] - ETA: 0s - loss: 0.5040 - accuracy: 0.634811/11 [==============================] - 2s 170ms/step - loss: 0.5054 - accuracy: 0.6338
Epoch 20/20
 1/11 [=>............................] - ETA: 2s - loss: 0.5421 - accuracy: 0.6250 2/11 [====>.........................] - ETA: 1s - loss: 0.5384 - accuracy: 0.6152 3/11 [=======>......................] - ETA: 1s - loss: 0.5390 - accuracy: 0.6115 4/11 [=========>....................] - ETA: 0s - loss: 0.5335 - accuracy: 0.6110 5/11 [============>.................] - ETA: 0s - loss: 0.5322 - accuracy: 0.6116 6/11 [===============>..............] - ETA: 0s - loss: 0.5313 - accuracy: 0.6102 7/11 [==================>...........] - ETA: 0s - loss: 0.5291 - accuracy: 0.6107 8/11 [====================>.........] - ETA: 0s - loss: 0.5286 - accuracy: 0.6113 9/11 [=======================>......] - ETA: 0s - loss: 0.5274 - accuracy: 0.612910/11 [==========================>...] - ETA: 0s - loss: 0.5263 - accuracy: 0.613911/11 [==============================] - ETA: 0s - loss: 0.5246 - accuracy: 0.615311/11 [==============================] - 2s 178ms/step - loss: 0.5232 - accuracy: 0.6165
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.4264 - accuracy: 0.59383/6 [==============>...............] - ETA: 0s - loss: 0.4829 - accuracy: 0.6068 5/6 [========================>.....] - ETA: 0s - loss: 0.4998 - accuracy: 0.60946/6 [==============================] - 3s 28ms/step - loss: 0.5012 - accuracy: 0.6048
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 4 0 3] pred: [-0.00657671  0.86100173  0.9804109  -0.01167367 -0.00282343]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [-0.01092587  0.80597705  0.99308884  0.00962752 -0.00682865]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [3 2 0 4 1] pred: [ 0.00168654 -0.04663659  0.09608751  0.23054534 -0.00120754]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [3 4 2 0 1] pred: [-0.00263494 -0.05218336  0.01779265  0.18572128  0.06026828]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 3 4 0] pred: [0.00107835 0.8709005  0.87020606 0.00915151 0.00352728]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 4 3] pred: [-0.00786153  0.9833088   0.99612546 -0.01871858 -0.01124367]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 4 0 3] pred: [-0.00898521  0.9881816   0.9920955  -0.01276518  0.00111046]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 4 3 0] pred: [-0.00689723  0.01757244  0.9982739  -0.0058015  -0.00427273]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 4 0 3] pred: [-0.01058255  0.98035705  0.9916657  -0.01685435 -0.00955508]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 4 0 1] pred: [-0.02023068 -0.1363471   0.996748    0.03988385 -0.01334278]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 4 3 0 1] pred: [-6.1988318e-03 -2.5245817e-02  9.9765664e-01 -5.7675284e-03
  5.4684310e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [3 2 4 0 1] pred: [-3.8238708e-05 -9.0653509e-02  3.1423185e-02  2.3855574e-01
  2.6016107e-03]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 4 0 3] pred: [-0.00576794  0.83663696  0.98207647 -0.0116468  -0.00141725]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 4 3] pred: [ 4.9540307e-05  9.8278344e-01  9.7110248e-01 -4.3605450e-03
 -1.3856577e-03]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [-0.00820594  0.9402182   0.9775241   0.00472396  0.00228417]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 9 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:15 - loss: 1.2903 - accuracy: 0.3047 2/11 [====>.........................] - ETA: 2s - loss: 1.3006 - accuracy: 0.3262   3/11 [=======>......................] - ETA: 1s - loss: 1.3017 - accuracy: 0.3398 4/11 [=========>....................] - ETA: 1s - loss: 1.2983 - accuracy: 0.3545 5/11 [============>.................] - ETA: 1s - loss: 1.2972 - accuracy: 0.3645 6/11 [===============>..............] - ETA: 0s - loss: 1.2948 - accuracy: 0.3739 7/11 [==================>...........] - ETA: 0s - loss: 1.2930 - accuracy: 0.3809 8/11 [====================>.........] - ETA: 0s - loss: 1.2900 - accuracy: 0.3869 9/11 [=======================>......] - ETA: 0s - loss: 1.2870 - accuracy: 0.392410/11 [==========================>...] - ETA: 0s - loss: 1.2847 - accuracy: 0.396711/11 [==============================] - ETA: 0s - loss: 1.2822 - accuracy: 0.400511/11 [==============================] - 9s 177ms/step - loss: 1.2801 - accuracy: 0.4038
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 1.1381 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 1.1396 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 1s - loss: 1.1463 - accuracy: 0.4753 4/11 [=========>....................] - ETA: 1s - loss: 1.1493 - accuracy: 0.4731 5/11 [============>.................] - ETA: 1s - loss: 1.1524 - accuracy: 0.4704 6/11 [===============>..............] - ETA: 0s - loss: 1.1532 - accuracy: 0.4703 7/11 [==================>...........] - ETA: 0s - loss: 1.1536 - accuracy: 0.4698 8/11 [====================>.........] - ETA: 0s - loss: 1.1535 - accuracy: 0.4694 9/11 [=======================>......] - ETA: 0s - loss: 1.1528 - accuracy: 0.469310/11 [==========================>...] - ETA: 0s - loss: 1.1518 - accuracy: 0.469011/11 [==============================] - ETA: 0s - loss: 1.1513 - accuracy: 0.468211/11 [==============================] - 2s 170ms/step - loss: 1.1509 - accuracy: 0.4675
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 1.0240 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 1.0105 - accuracy: 0.4941 3/11 [=======>......................] - ETA: 1s - loss: 1.0129 - accuracy: 0.4909 4/11 [=========>....................] - ETA: 1s - loss: 1.0125 - accuracy: 0.4883 5/11 [============>.................] - ETA: 1s - loss: 1.0117 - accuracy: 0.4850 6/11 [===============>..............] - ETA: 0s - loss: 1.0109 - accuracy: 0.4816 7/11 [==================>...........] - ETA: 0s - loss: 1.0092 - accuracy: 0.4793 8/11 [====================>.........] - ETA: 0s - loss: 1.0086 - accuracy: 0.4760 9/11 [=======================>......] - ETA: 0s - loss: 1.0060 - accuracy: 0.474610/11 [==========================>...] - ETA: 0s - loss: 1.0032 - accuracy: 0.473111/11 [==============================] - ETA: 0s - loss: 1.0005 - accuracy: 0.471911/11 [==============================] - 2s 165ms/step - loss: 0.9983 - accuracy: 0.4709
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.8447 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.8631 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 1s - loss: 0.8704 - accuracy: 0.4375 4/11 [=========>....................] - ETA: 1s - loss: 0.8786 - accuracy: 0.4336 5/11 [============>.................] - ETA: 1s - loss: 0.8835 - accuracy: 0.4309 6/11 [===============>..............] - ETA: 0s - loss: 0.8836 - accuracy: 0.4314 7/11 [==================>...........] - ETA: 0s - loss: 0.8804 - accuracy: 0.4332 8/11 [====================>.........] - ETA: 0s - loss: 0.8773 - accuracy: 0.4352 9/11 [=======================>......] - ETA: 0s - loss: 0.8729 - accuracy: 0.437610/11 [==========================>...] - ETA: 0s - loss: 0.8698 - accuracy: 0.439111/11 [==============================] - ETA: 0s - loss: 0.8663 - accuracy: 0.440911/11 [==============================] - 2s 165ms/step - loss: 0.8635 - accuracy: 0.4425
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.9127 - accuracy: 0.3906 2/11 [====>.........................] - ETA: 1s - loss: 0.8529 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 1s - loss: 0.8434 - accuracy: 0.4384 4/11 [=========>....................] - ETA: 1s - loss: 0.8374 - accuracy: 0.4411 5/11 [============>.................] - ETA: 1s - loss: 0.8317 - accuracy: 0.4435 6/11 [===============>..............] - ETA: 0s - loss: 0.8280 - accuracy: 0.4447 7/11 [==================>...........] - ETA: 0s - loss: 0.8232 - accuracy: 0.4475 8/11 [====================>.........] - ETA: 0s - loss: 0.8185 - accuracy: 0.4496 9/11 [=======================>......] - ETA: 0s - loss: 0.8145 - accuracy: 0.451810/11 [==========================>...] - ETA: 0s - loss: 0.8130 - accuracy: 0.452411/11 [==============================] - ETA: 0s - loss: 0.8117 - accuracy: 0.453111/11 [==============================] - 2s 171ms/step - loss: 0.8107 - accuracy: 0.4537
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7698 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.7556 - accuracy: 0.4961 3/11 [=======>......................] - ETA: 1s - loss: 0.7484 - accuracy: 0.5009 4/11 [=========>....................] - ETA: 1s - loss: 0.7464 - accuracy: 0.5002 5/11 [============>.................] - ETA: 0s - loss: 0.7487 - accuracy: 0.4967 6/11 [===============>..............] - ETA: 0s - loss: 0.7530 - accuracy: 0.4920 7/11 [==================>...........] - ETA: 0s - loss: 0.7570 - accuracy: 0.4879 8/11 [====================>.........] - ETA: 0s - loss: 0.7597 - accuracy: 0.4852 9/11 [=======================>......] - ETA: 0s - loss: 0.7624 - accuracy: 0.482710/11 [==========================>...] - ETA: 0s - loss: 0.7649 - accuracy: 0.480611/11 [==============================] - ETA: 0s - loss: 0.7667 - accuracy: 0.478811/11 [==============================] - 2s 151ms/step - loss: 0.7682 - accuracy: 0.4773
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7708 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.7872 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 1s - loss: 0.7953 - accuracy: 0.4484 4/11 [=========>....................] - ETA: 1s - loss: 0.7942 - accuracy: 0.4486 5/11 [============>.................] - ETA: 0s - loss: 0.7930 - accuracy: 0.4507 6/11 [===============>..............] - ETA: 0s - loss: 0.7886 - accuracy: 0.4546 7/11 [==================>...........] - ETA: 0s - loss: 0.7854 - accuracy: 0.4563 8/11 [====================>.........] - ETA: 0s - loss: 0.7830 - accuracy: 0.4569 9/11 [=======================>......] - ETA: 0s - loss: 0.7807 - accuracy: 0.457810/11 [==========================>...] - ETA: 0s - loss: 0.7790 - accuracy: 0.458511/11 [==============================] - ETA: 0s - loss: 0.7780 - accuracy: 0.459011/11 [==============================] - 2s 185ms/step - loss: 0.7773 - accuracy: 0.4593
Epoch 8/20
 1/11 [=>............................] - ETA: 2s - loss: 0.7872 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.8178 - accuracy: 0.4473 3/11 [=======>......................] - ETA: 1s - loss: 0.8156 - accuracy: 0.4431 4/11 [=========>....................] - ETA: 1s - loss: 0.8142 - accuracy: 0.4393 5/11 [============>.................] - ETA: 1s - loss: 0.8127 - accuracy: 0.4377 6/11 [===============>..............] - ETA: 0s - loss: 0.8105 - accuracy: 0.4368 7/11 [==================>...........] - ETA: 0s - loss: 0.8070 - accuracy: 0.4375 8/11 [====================>.........] - ETA: 0s - loss: 0.8042 - accuracy: 0.4379 9/11 [=======================>......] - ETA: 0s - loss: 0.8007 - accuracy: 0.439610/11 [==========================>...] - ETA: 0s - loss: 0.7965 - accuracy: 0.441911/11 [==============================] - ETA: 0s - loss: 0.7923 - accuracy: 0.444311/11 [==============================] - 2s 174ms/step - loss: 0.7889 - accuracy: 0.4463
Epoch 9/20
 1/11 [=>............................] - ETA: 2s - loss: 0.7368 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.7405 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 1s - loss: 0.7381 - accuracy: 0.4605 4/11 [=========>....................] - ETA: 1s - loss: 0.7413 - accuracy: 0.4616 5/11 [============>.................] - ETA: 1s - loss: 0.7391 - accuracy: 0.4655 6/11 [===============>..............] - ETA: 1s - loss: 0.7358 - accuracy: 0.4700 7/11 [==================>...........] - ETA: 0s - loss: 0.7341 - accuracy: 0.4723 8/11 [====================>.........] - ETA: 0s - loss: 0.7322 - accuracy: 0.4741 9/11 [=======================>......] - ETA: 0s - loss: 0.7312 - accuracy: 0.475310/11 [==========================>...] - ETA: 0s - loss: 0.7311 - accuracy: 0.476211/11 [==============================] - ETA: 0s - loss: 0.7312 - accuracy: 0.476411/11 [==============================] - 2s 184ms/step - loss: 0.7313 - accuracy: 0.4766
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.7201 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.7227 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 1s - loss: 0.7212 - accuracy: 0.4918 4/11 [=========>....................] - ETA: 1s - loss: 0.7236 - accuracy: 0.4894 5/11 [============>.................] - ETA: 0s - loss: 0.7226 - accuracy: 0.4903 6/11 [===============>..............] - ETA: 0s - loss: 0.7243 - accuracy: 0.4895 7/11 [==================>...........] - ETA: 0s - loss: 0.7260 - accuracy: 0.4888 8/11 [====================>.........] - ETA: 0s - loss: 0.7270 - accuracy: 0.4881 9/11 [=======================>......] - ETA: 0s - loss: 0.7273 - accuracy: 0.488310/11 [==========================>...] - ETA: 0s - loss: 0.7274 - accuracy: 0.488011/11 [==============================] - ETA: 0s - loss: 0.7264 - accuracy: 0.488211/11 [==============================] - 2s 161ms/step - loss: 0.7255 - accuracy: 0.4883
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6158 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 1s - loss: 0.6308 - accuracy: 0.5625 3/11 [=======>......................] - ETA: 1s - loss: 0.6544 - accuracy: 0.5391 4/11 [=========>....................] - ETA: 1s - loss: 0.6607 - accuracy: 0.5288 5/11 [============>.................] - ETA: 0s - loss: 0.6663 - accuracy: 0.5202 6/11 [===============>..............] - ETA: 0s - loss: 0.6687 - accuracy: 0.5156 7/11 [==================>...........] - ETA: 0s - loss: 0.6716 - accuracy: 0.5125 8/11 [====================>.........] - ETA: 0s - loss: 0.6739 - accuracy: 0.5100 9/11 [=======================>......] - ETA: 0s - loss: 0.6772 - accuracy: 0.507010/11 [==========================>...] - ETA: 0s - loss: 0.6794 - accuracy: 0.505011/11 [==============================] - ETA: 0s - loss: 0.6808 - accuracy: 0.503611/11 [==============================] - 2s 157ms/step - loss: 0.6820 - accuracy: 0.5025
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6380 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 1s - loss: 0.6300 - accuracy: 0.5488 3/11 [=======>......................] - ETA: 1s - loss: 0.6345 - accuracy: 0.5412 4/11 [=========>....................] - ETA: 1s - loss: 0.6398 - accuracy: 0.5343 5/11 [============>.................] - ETA: 1s - loss: 0.6438 - accuracy: 0.5287 6/11 [===============>..............] - ETA: 0s - loss: 0.6462 - accuracy: 0.5261 7/11 [==================>...........] - ETA: 0s - loss: 0.6485 - accuracy: 0.5240 8/11 [====================>.........] - ETA: 0s - loss: 0.6501 - accuracy: 0.5224 9/11 [=======================>......] - ETA: 0s - loss: 0.6527 - accuracy: 0.519310/11 [==========================>...] - ETA: 0s - loss: 0.6550 - accuracy: 0.516411/11 [==============================] - ETA: 0s - loss: 0.6570 - accuracy: 0.514111/11 [==============================] - 2s 173ms/step - loss: 0.6586 - accuracy: 0.5121
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5815 - accuracy: 0.5469 2/11 [====>.........................] - ETA: 1s - loss: 0.6184 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 1s - loss: 0.6296 - accuracy: 0.5191 4/11 [=========>....................] - ETA: 1s - loss: 0.6351 - accuracy: 0.5129 5/11 [============>.................] - ETA: 0s - loss: 0.6389 - accuracy: 0.5081 6/11 [===============>..............] - ETA: 0s - loss: 0.6400 - accuracy: 0.5065 7/11 [==================>...........] - ETA: 0s - loss: 0.6414 - accuracy: 0.5062 8/11 [====================>.........] - ETA: 0s - loss: 0.6428 - accuracy: 0.5055 9/11 [=======================>......] - ETA: 0s - loss: 0.6437 - accuracy: 0.505110/11 [==========================>...] - ETA: 0s - loss: 0.6449 - accuracy: 0.504511/11 [==============================] - ETA: 0s - loss: 0.6461 - accuracy: 0.503511/11 [==============================] - 2s 163ms/step - loss: 0.6471 - accuracy: 0.5027
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6982 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.6830 - accuracy: 0.4883 3/11 [=======>......................] - ETA: 1s - loss: 0.6737 - accuracy: 0.4800 4/11 [=========>....................] - ETA: 1s - loss: 0.6665 - accuracy: 0.4821 5/11 [============>.................] - ETA: 1s - loss: 0.6606 - accuracy: 0.4826 6/11 [===============>..............] - ETA: 0s - loss: 0.6577 - accuracy: 0.4826 7/11 [==================>...........] - ETA: 0s - loss: 0.6569 - accuracy: 0.4832 8/11 [====================>.........] - ETA: 0s - loss: 0.6552 - accuracy: 0.4848 9/11 [=======================>......] - ETA: 0s - loss: 0.6530 - accuracy: 0.486510/11 [==========================>...] - ETA: 0s - loss: 0.6519 - accuracy: 0.486811/11 [==============================] - ETA: 0s - loss: 0.6507 - accuracy: 0.487811/11 [==============================] - 2s 164ms/step - loss: 0.6497 - accuracy: 0.4885
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5572 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.5635 - accuracy: 0.5215 3/11 [=======>......................] - ETA: 1s - loss: 0.5695 - accuracy: 0.5143 4/11 [=========>....................] - ETA: 1s - loss: 0.5709 - accuracy: 0.5127 5/11 [============>.................] - ETA: 0s - loss: 0.5725 - accuracy: 0.5108 6/11 [===============>..............] - ETA: 0s - loss: 0.5770 - accuracy: 0.5081 7/11 [==================>...........] - ETA: 0s - loss: 0.5815 - accuracy: 0.5054 8/11 [====================>.........] - ETA: 0s - loss: 0.5851 - accuracy: 0.5044 9/11 [=======================>......] - ETA: 0s - loss: 0.5878 - accuracy: 0.504310/11 [==========================>...] - ETA: 0s - loss: 0.5905 - accuracy: 0.503711/11 [==============================] - ETA: 0s - loss: 0.5929 - accuracy: 0.503311/11 [==============================] - 2s 168ms/step - loss: 0.5948 - accuracy: 0.5029
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.6270 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.6297 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 1s - loss: 0.6369 - accuracy: 0.4718 4/11 [=========>....................] - ETA: 1s - loss: 0.6383 - accuracy: 0.4730 5/11 [============>.................] - ETA: 0s - loss: 0.6377 - accuracy: 0.4759 6/11 [===============>..............] - ETA: 0s - loss: 0.6334 - accuracy: 0.4795 7/11 [==================>...........] - ETA: 0s - loss: 0.6279 - accuracy: 0.4826 8/11 [====================>.........] - ETA: 0s - loss: 0.6238 - accuracy: 0.4852 9/11 [=======================>......] - ETA: 0s - loss: 0.6213 - accuracy: 0.486810/11 [==========================>...] - ETA: 0s - loss: 0.6184 - accuracy: 0.488611/11 [==============================] - ETA: 0s - loss: 0.6160 - accuracy: 0.490011/11 [==============================] - 2s 156ms/step - loss: 0.6140 - accuracy: 0.4911
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5925 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.6024 - accuracy: 0.5410 3/11 [=======>......................] - ETA: 1s - loss: 0.5901 - accuracy: 0.5360 4/11 [=========>....................] - ETA: 1s - loss: 0.5866 - accuracy: 0.5329 5/11 [============>.................] - ETA: 0s - loss: 0.5832 - accuracy: 0.5282 6/11 [===============>..............] - ETA: 0s - loss: 0.5831 - accuracy: 0.5248 7/11 [==================>...........] - ETA: 0s - loss: 0.5833 - accuracy: 0.5224 8/11 [====================>.........] - ETA: 0s - loss: 0.5835 - accuracy: 0.5201 9/11 [=======================>......] - ETA: 0s - loss: 0.5824 - accuracy: 0.517910/11 [==========================>...] - ETA: 0s - loss: 0.5816 - accuracy: 0.516111/11 [==============================] - ETA: 0s - loss: 0.5805 - accuracy: 0.515711/11 [==============================] - 2s 150ms/step - loss: 0.5795 - accuracy: 0.5153
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.4800 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.5033 - accuracy: 0.5312 3/11 [=======>......................] - ETA: 1s - loss: 0.5153 - accuracy: 0.5330 4/11 [=========>....................] - ETA: 1s - loss: 0.5196 - accuracy: 0.5311 5/11 [============>.................] - ETA: 0s - loss: 0.5246 - accuracy: 0.5283 6/11 [===============>..............] - ETA: 0s - loss: 0.5284 - accuracy: 0.5266 7/11 [==================>...........] - ETA: 0s - loss: 0.5324 - accuracy: 0.5260 8/11 [====================>.........] - ETA: 0s - loss: 0.5354 - accuracy: 0.5254 9/11 [=======================>......] - ETA: 0s - loss: 0.5374 - accuracy: 0.525010/11 [==========================>...] - ETA: 0s - loss: 0.5382 - accuracy: 0.524411/11 [==============================] - ETA: 0s - loss: 0.5390 - accuracy: 0.524111/11 [==============================] - 2s 153ms/step - loss: 0.5397 - accuracy: 0.5239
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5484 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.5402 - accuracy: 0.4922 3/11 [=======>......................] - ETA: 1s - loss: 0.5427 - accuracy: 0.5061 4/11 [=========>....................] - ETA: 1s - loss: 0.5448 - accuracy: 0.5109 5/11 [============>.................] - ETA: 0s - loss: 0.5463 - accuracy: 0.5156 6/11 [===============>..............] - ETA: 0s - loss: 0.5449 - accuracy: 0.5197 7/11 [==================>...........] - ETA: 0s - loss: 0.5446 - accuracy: 0.5220 8/11 [====================>.........] - ETA: 0s - loss: 0.5439 - accuracy: 0.5244 9/11 [=======================>......] - ETA: 0s - loss: 0.5427 - accuracy: 0.525710/11 [==========================>...] - ETA: 0s - loss: 0.5415 - accuracy: 0.527511/11 [==============================] - ETA: 0s - loss: 0.5400 - accuracy: 0.529111/11 [==============================] - 2s 158ms/step - loss: 0.5388 - accuracy: 0.5304
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.5739 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.5572 - accuracy: 0.5352 3/11 [=======>......................] - ETA: 1s - loss: 0.5450 - accuracy: 0.5451 4/11 [=========>....................] - ETA: 1s - loss: 0.5381 - accuracy: 0.5505 5/11 [============>.................] - ETA: 1s - loss: 0.5339 - accuracy: 0.5522 6/11 [===============>..............] - ETA: 0s - loss: 0.5290 - accuracy: 0.5535 7/11 [==================>...........] - ETA: 0s - loss: 0.5257 - accuracy: 0.5545 8/11 [====================>.........] - ETA: 0s - loss: 0.5240 - accuracy: 0.5552 9/11 [=======================>......] - ETA: 0s - loss: 0.5222 - accuracy: 0.555710/11 [==========================>...] - ETA: 0s - loss: 0.5209 - accuracy: 0.556811/11 [==============================] - ETA: 0s - loss: 0.5193 - accuracy: 0.557811/11 [==============================] - 2s 154ms/step - loss: 0.5180 - accuracy: 0.5587
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.5709 - accuracy: 0.51563/6 [==============>...............] - ETA: 0s - loss: 0.5758 - accuracy: 0.5677 5/6 [========================>.....] - ETA: 0s - loss: 0.5437 - accuracy: 0.59846/6 [==============================] - 3s 31ms/step - loss: 0.5546 - accuracy: 0.5963
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/cecisw/arch/easybuild/2020b/software/scikit-learn/0.23.2-foss-2020b/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 0 3 4] pred: [-0.00252466  0.0503032   0.99663246 -0.0072306  -0.014186  ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [-0.00189678  0.7620168   0.97651654  0.02718417  0.00927512]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 0 3 1 4] pred: [ 0.02655716 -0.02011031  0.997488   -0.00781138 -0.02534526]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [3 1 0 4 2] pred: [ 0.01107844  0.14152406 -0.08178352  0.1502976   0.00119914]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 4 3] pred: [ 0.00645235  0.9642447   0.9693861  -0.01829276 -0.01231162]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [0 4 1 3 2] pred: [ 0.09752155  0.00466697 -0.2073981  -0.0081455   0.01441333]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [-0.00742914  0.19825341  0.9961769  -0.00912097 -0.01472028]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 4 3] pred: [ 4.3920935e-03  8.9639562e-01  9.4409013e-01 -7.0736222e-03
 -1.7614337e-04]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 8 ============
pred sorted: [2 3 0 4 1] pred: [ 0.0082135  -0.05112404  0.9970455   0.01695408 -0.01237114]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [4 3 0 2 1] pred: [ 0.00628861 -0.21677381 -0.07253324  0.03195288  0.14704634]
 Top predictions indices: [4 3] vs. real classes indices: [3 4]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 0 3 4] pred: [ 3.515454e-04  9.684185e-01  9.845077e-01 -8.710180e-03 -1.036553e-02]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 0 4 3 1] pred: [-0.00288746 -0.15507288  0.997664   -0.01842729 -0.00738122]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 4 3] pred: [ 0.00681401  0.7975052   0.9816209  -0.0103026  -0.00287253]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [ 0.00561109  0.4676438   0.99821913  0.0133672  -0.02965646]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 4 1 0] pred: [-0.00551225 -0.00535908  0.244113    0.13888808 -0.00511722]
 Top predictions indices: [2] vs. real classes indices: [3]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Job end at Sun Nov  6 08:39:05 CET 2022
