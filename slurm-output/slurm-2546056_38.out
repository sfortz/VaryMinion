
The following have been reloaded with a version change:
  1) FFTW/3.3.8-gompi-2019b => FFTW/3.3.8-gompi-2020b
  2) GCC/8.3.0 => GCC/10.2.0
  3) GCCcore/8.3.0 => GCCcore/10.2.0
  4) OpenBLAS/0.3.7-GCC-8.3.0 => OpenBLAS/0.3.12-GCC-10.2.0
  5) OpenMPI/3.1.4-GCC-8.3.0 => OpenMPI/4.0.5-GCC-10.2.0
  6) ScaLAPACK/2.0.2-gompi-2019b => ScaLAPACK/2.1.0-gompi-2020b
  7) XZ/5.2.4-GCCcore-8.3.0 => XZ/5.2.5-GCCcore-10.2.0
  8) binutils/2.32-GCCcore-8.3.0 => binutils/2.35-GCCcore-10.2.0
  9) foss/2019b => foss/2020b
 10) gompi/2019b => gompi/2020b
 11) hwloc/1.11.12-GCCcore-8.3.0 => hwloc/2.2.0-GCCcore-10.2.0
 12) libpciaccess/0.14-GCCcore-8.3.0 => libpciaccess/0.16-GCCcore-10.2.0
 13) libxml2/2.9.9-GCCcore-8.3.0 => libxml2/2.9.10-GCCcore-10.2.0
 14) numactl/2.0.12-GCCcore-8.3.0 => numactl/2.0.13-GCCcore-10.2.0
 15) releases/2019b => releases/2020b
 16) zlib/1.2.11-GCCcore-8.3.0 => zlib/1.2.11-GCCcore-10.2.0

Job start at Sun Nov  6 08:59:58 CET 2022
WARNING:tensorflow:From /scratch/2546133/2546133/VaryMinions/scripts/training_NN/training_Model.py:22: is_gpu_available (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.config.list_physical_devices('GPU')` instead.
2022-11-06 09:00:03.316892: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-11-06 09:00:03.317352: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
2022-11-06 09:00:05.206587: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-11-06 09:00:05.206955: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500195000 Hz
Number of possible configurations: 40
Begining exécution of the 38 th configuration: BPIC20.csv with LSTM model, 20 epochs, 30 units, 128 batch_size, sigmoid as activation function and mse as loss function.
Exécution 0 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, None, 58)          3364      
_________________________________________________________________
bidirectional (Bidirectional (None, 60)                21360     
_________________________________________________________________
dense (Dense)                (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:13 - loss: 0.2508 - accuracy: 0.0234 2/11 [====>.........................] - ETA: 1s - loss: 0.2504 - accuracy: 0.1133   3/11 [=======>......................] - ETA: 1s - loss: 0.2499 - accuracy: 0.1701 4/11 [=========>....................] - ETA: 1s - loss: 0.2495 - accuracy: 0.2131 5/11 [============>.................] - ETA: 1s - loss: 0.2490 - accuracy: 0.2433 6/11 [===============>..............] - ETA: 0s - loss: 0.2485 - accuracy: 0.2683 7/11 [==================>...........] - ETA: 0s - loss: 0.2481 - accuracy: 0.2880 8/11 [====================>.........] - ETA: 0s - loss: 0.2476 - accuracy: 0.3037 9/11 [=======================>......] - ETA: 0s - loss: 0.2471 - accuracy: 0.315610/11 [==========================>...] - ETA: 0s - loss: 0.2466 - accuracy: 0.325211/11 [==============================] - ETA: 0s - loss: 0.2461 - accuracy: 0.333411/11 [==============================] - 9s 181ms/step - loss: 0.2458 - accuracy: 0.3402
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2258 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.2263 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 1s - loss: 0.2260 - accuracy: 0.4358 4/11 [=========>....................] - ETA: 1s - loss: 0.2252 - accuracy: 0.4391 5/11 [============>.................] - ETA: 1s - loss: 0.2243 - accuracy: 0.4429 6/11 [===============>..............] - ETA: 0s - loss: 0.2235 - accuracy: 0.4463 7/11 [==================>...........] - ETA: 0s - loss: 0.2226 - accuracy: 0.4479 8/11 [====================>.........] - ETA: 0s - loss: 0.2217 - accuracy: 0.4493 9/11 [=======================>......] - ETA: 0s - loss: 0.2207 - accuracy: 0.450010/11 [==========================>...] - ETA: 0s - loss: 0.2197 - accuracy: 0.451311/11 [==============================] - ETA: 0s - loss: 0.2187 - accuracy: 0.452511/11 [==============================] - 2s 177ms/step - loss: 0.2178 - accuracy: 0.4535
Epoch 3/20
 1/11 [=>............................] - ETA: 2s - loss: 0.1771 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.1741 - accuracy: 0.4668 3/11 [=======>......................] - ETA: 1s - loss: 0.1721 - accuracy: 0.4683 4/11 [=========>....................] - ETA: 1s - loss: 0.1696 - accuracy: 0.4694 5/11 [============>.................] - ETA: 1s - loss: 0.1676 - accuracy: 0.4686 6/11 [===============>..............] - ETA: 0s - loss: 0.1657 - accuracy: 0.4682 7/11 [==================>...........] - ETA: 0s - loss: 0.1638 - accuracy: 0.4683 8/11 [====================>.........] - ETA: 0s - loss: 0.1622 - accuracy: 0.4671 9/11 [=======================>......] - ETA: 0s - loss: 0.1605 - accuracy: 0.466710/11 [==========================>...] - ETA: 0s - loss: 0.1587 - accuracy: 0.466811/11 [==============================] - ETA: 0s - loss: 0.1572 - accuracy: 0.466611/11 [==============================] - 2s 186ms/step - loss: 0.1559 - accuracy: 0.4665
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1270 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 1s - loss: 0.1248 - accuracy: 0.4199 3/11 [=======>......................] - ETA: 1s - loss: 0.1233 - accuracy: 0.4301 4/11 [=========>....................] - ETA: 1s - loss: 0.1214 - accuracy: 0.4378 5/11 [============>.................] - ETA: 1s - loss: 0.1204 - accuracy: 0.4409 6/11 [===============>..............] - ETA: 0s - loss: 0.1197 - accuracy: 0.4444 7/11 [==================>...........] - ETA: 0s - loss: 0.1192 - accuracy: 0.4473 8/11 [====================>.........] - ETA: 0s - loss: 0.1189 - accuracy: 0.4490 9/11 [=======================>......] - ETA: 0s - loss: 0.1185 - accuracy: 0.450210/11 [==========================>...] - ETA: 0s - loss: 0.1181 - accuracy: 0.451811/11 [==============================] - ETA: 0s - loss: 0.1177 - accuracy: 0.453011/11 [==============================] - 2s 180ms/step - loss: 0.1173 - accuracy: 0.4540
Epoch 5/20
 1/11 [=>............................] - ETA: 2s - loss: 0.1220 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 1s - loss: 0.1165 - accuracy: 0.4238 3/11 [=======>......................] - ETA: 1s - loss: 0.1150 - accuracy: 0.4336 4/11 [=========>....................] - ETA: 1s - loss: 0.1148 - accuracy: 0.4355 5/11 [============>.................] - ETA: 1s - loss: 0.1144 - accuracy: 0.4400 6/11 [===============>..............] - ETA: 0s - loss: 0.1142 - accuracy: 0.4441 7/11 [==================>...........] - ETA: 0s - loss: 0.1140 - accuracy: 0.4467 8/11 [====================>.........] - ETA: 0s - loss: 0.1139 - accuracy: 0.4477 9/11 [=======================>......] - ETA: 0s - loss: 0.1136 - accuracy: 0.448910/11 [==========================>...] - ETA: 0s - loss: 0.1133 - accuracy: 0.450711/11 [==============================] - ETA: 0s - loss: 0.1130 - accuracy: 0.452011/11 [==============================] - 2s 177ms/step - loss: 0.1128 - accuracy: 0.4530
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1128 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.1113 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 1s - loss: 0.1113 - accuracy: 0.4657 4/11 [=========>....................] - ETA: 1s - loss: 0.1109 - accuracy: 0.4650 5/11 [============>.................] - ETA: 1s - loss: 0.1102 - accuracy: 0.4645 6/11 [===============>..............] - ETA: 0s - loss: 0.1094 - accuracy: 0.4648 7/11 [==================>...........] - ETA: 0s - loss: 0.1087 - accuracy: 0.4657 8/11 [====================>.........] - ETA: 0s - loss: 0.1081 - accuracy: 0.4667 9/11 [=======================>......] - ETA: 0s - loss: 0.1076 - accuracy: 0.467510/11 [==========================>...] - ETA: 0s - loss: 0.1074 - accuracy: 0.466911/11 [==============================] - ETA: 0s - loss: 0.1072 - accuracy: 0.466711/11 [==============================] - 2s 192ms/step - loss: 0.1070 - accuracy: 0.4666
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1066 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 1s - loss: 0.1027 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 1s - loss: 0.1033 - accuracy: 0.4379 4/11 [=========>....................] - ETA: 1s - loss: 0.1035 - accuracy: 0.4373 5/11 [============>.................] - ETA: 1s - loss: 0.1031 - accuracy: 0.4392 6/11 [===============>..............] - ETA: 0s - loss: 0.1027 - accuracy: 0.4420 7/11 [==================>...........] - ETA: 0s - loss: 0.1024 - accuracy: 0.4444 8/11 [====================>.........] - ETA: 0s - loss: 0.1021 - accuracy: 0.4477 9/11 [=======================>......] - ETA: 0s - loss: 0.1018 - accuracy: 0.450110/11 [==========================>...] - ETA: 0s - loss: 0.1015 - accuracy: 0.452011/11 [==============================] - ETA: 0s - loss: 0.1012 - accuracy: 0.453711/11 [==============================] - 2s 197ms/step - loss: 0.1009 - accuracy: 0.4552
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0901 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 1s - loss: 0.0899 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 1s - loss: 0.0884 - accuracy: 0.5061 4/11 [=========>....................] - ETA: 1s - loss: 0.0873 - accuracy: 0.5075 5/11 [============>.................] - ETA: 1s - loss: 0.0870 - accuracy: 0.5047 6/11 [===============>..............] - ETA: 1s - loss: 0.0868 - accuracy: 0.5033 7/11 [==================>...........] - ETA: 0s - loss: 0.0871 - accuracy: 0.5011 8/11 [====================>.........] - ETA: 0s - loss: 0.0872 - accuracy: 0.4991 9/11 [=======================>......] - ETA: 0s - loss: 0.0873 - accuracy: 0.496710/11 [==========================>...] - ETA: 0s - loss: 0.0875 - accuracy: 0.494111/11 [==============================] - ETA: 0s - loss: 0.0876 - accuracy: 0.492711/11 [==============================] - 2s 217ms/step - loss: 0.0876 - accuracy: 0.4915
Epoch 9/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0883 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 2s - loss: 0.0858 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 2s - loss: 0.0841 - accuracy: 0.4865 4/11 [=========>....................] - ETA: 2s - loss: 0.0831 - accuracy: 0.4919 5/11 [============>.................] - ETA: 1s - loss: 0.0820 - accuracy: 0.4972 6/11 [===============>..............] - ETA: 1s - loss: 0.0812 - accuracy: 0.5007 7/11 [==================>...........] - ETA: 1s - loss: 0.0805 - accuracy: 0.5035 8/11 [====================>.........] - ETA: 0s - loss: 0.0799 - accuracy: 0.5040 9/11 [=======================>......] - ETA: 0s - loss: 0.0792 - accuracy: 0.505110/11 [==========================>...] - ETA: 0s - loss: 0.0787 - accuracy: 0.506311/11 [==============================] - ETA: 0s - loss: 0.0782 - accuracy: 0.507411/11 [==============================] - 3s 245ms/step - loss: 0.0778 - accuracy: 0.5084
Epoch 10/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0687 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.0679 - accuracy: 0.5566 3/11 [=======>......................] - ETA: 1s - loss: 0.0683 - accuracy: 0.5525 4/11 [=========>....................] - ETA: 1s - loss: 0.0677 - accuracy: 0.5550 5/11 [============>.................] - ETA: 1s - loss: 0.0672 - accuracy: 0.5587 6/11 [===============>..............] - ETA: 1s - loss: 0.0670 - accuracy: 0.5615 7/11 [==================>...........] - ETA: 0s - loss: 0.0667 - accuracy: 0.5648 8/11 [====================>.........] - ETA: 0s - loss: 0.0665 - accuracy: 0.5666 9/11 [=======================>......] - ETA: 0s - loss: 0.0661 - accuracy: 0.568610/11 [==========================>...] - ETA: 0s - loss: 0.0656 - accuracy: 0.570611/11 [==============================] - ETA: 0s - loss: 0.0651 - accuracy: 0.572811/11 [==============================] - 2s 210ms/step - loss: 0.0648 - accuracy: 0.5746
Epoch 11/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0557 - accuracy: 0.6484 2/11 [====>.........................] - ETA: 1s - loss: 0.0581 - accuracy: 0.6445 3/11 [=======>......................] - ETA: 1s - loss: 0.0582 - accuracy: 0.6337 4/11 [=========>....................] - ETA: 1s - loss: 0.0577 - accuracy: 0.6315 5/11 [============>.................] - ETA: 1s - loss: 0.0573 - accuracy: 0.6327 6/11 [===============>..............] - ETA: 1s - loss: 0.0567 - accuracy: 0.6347 7/11 [==================>...........] - ETA: 0s - loss: 0.0562 - accuracy: 0.6370 8/11 [====================>.........] - ETA: 0s - loss: 0.0557 - accuracy: 0.6394 9/11 [=======================>......] - ETA: 0s - loss: 0.0552 - accuracy: 0.642010/11 [==========================>...] - ETA: 0s - loss: 0.0548 - accuracy: 0.645111/11 [==============================] - ETA: 0s - loss: 0.0546 - accuracy: 0.647811/11 [==============================] - 2s 225ms/step - loss: 0.0544 - accuracy: 0.6500
Epoch 12/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0474 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 2s - loss: 0.0463 - accuracy: 0.6875 3/11 [=======>......................] - ETA: 1s - loss: 0.0465 - accuracy: 0.6832 4/11 [=========>....................] - ETA: 1s - loss: 0.0464 - accuracy: 0.6828 5/11 [============>.................] - ETA: 1s - loss: 0.0461 - accuracy: 0.6865 6/11 [===============>..............] - ETA: 1s - loss: 0.0459 - accuracy: 0.6915 7/11 [==================>...........] - ETA: 0s - loss: 0.0459 - accuracy: 0.6952 8/11 [====================>.........] - ETA: 0s - loss: 0.0459 - accuracy: 0.6978 9/11 [=======================>......] - ETA: 0s - loss: 0.0459 - accuracy: 0.700010/11 [==========================>...] - ETA: 0s - loss: 0.0458 - accuracy: 0.701711/11 [==============================] - ETA: 0s - loss: 0.0459 - accuracy: 0.702711/11 [==============================] - 2s 215ms/step - loss: 0.0460 - accuracy: 0.7036
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0404 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 1s - loss: 0.0423 - accuracy: 0.7188 3/11 [=======>......................] - ETA: 1s - loss: 0.0420 - accuracy: 0.7205 4/11 [=========>....................] - ETA: 1s - loss: 0.0417 - accuracy: 0.7274 5/11 [============>.................] - ETA: 1s - loss: 0.0420 - accuracy: 0.7347 6/11 [===============>..............] - ETA: 0s - loss: 0.0423 - accuracy: 0.7407 7/11 [==================>...........] - ETA: 0s - loss: 0.0425 - accuracy: 0.7464 8/11 [====================>.........] - ETA: 0s - loss: 0.0426 - accuracy: 0.7516 9/11 [=======================>......] - ETA: 0s - loss: 0.0426 - accuracy: 0.755510/11 [==========================>...] - ETA: 0s - loss: 0.0426 - accuracy: 0.758111/11 [==============================] - ETA: 0s - loss: 0.0426 - accuracy: 0.759611/11 [==============================] - 2s 201ms/step - loss: 0.0425 - accuracy: 0.7609
Epoch 14/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0317 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 2s - loss: 0.0343 - accuracy: 0.8027 3/11 [=======>......................] - ETA: 1s - loss: 0.0361 - accuracy: 0.8190 4/11 [=========>....................] - ETA: 1s - loss: 0.0371 - accuracy: 0.8281 5/11 [============>.................] - ETA: 1s - loss: 0.0379 - accuracy: 0.8309 6/11 [===============>..............] - ETA: 1s - loss: 0.0383 - accuracy: 0.8322 7/11 [==================>...........] - ETA: 0s - loss: 0.0387 - accuracy: 0.8311 8/11 [====================>.........] - ETA: 0s - loss: 0.0389 - accuracy: 0.8289 9/11 [=======================>......] - ETA: 0s - loss: 0.0390 - accuracy: 0.825410/11 [==========================>...] - ETA: 0s - loss: 0.0391 - accuracy: 0.822311/11 [==============================] - ETA: 0s - loss: 0.0391 - accuracy: 0.820011/11 [==============================] - 2s 218ms/step - loss: 0.0391 - accuracy: 0.8180
Epoch 15/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0348 - accuracy: 0.9219 2/11 [====>.........................] - ETA: 1s - loss: 0.0352 - accuracy: 0.9102 3/11 [=======>......................] - ETA: 1s - loss: 0.0365 - accuracy: 0.8958 4/11 [=========>....................] - ETA: 1s - loss: 0.0367 - accuracy: 0.8833 5/11 [============>.................] - ETA: 1s - loss: 0.0366 - accuracy: 0.8726 6/11 [===============>..............] - ETA: 1s - loss: 0.0366 - accuracy: 0.8630 7/11 [==================>...........] - ETA: 0s - loss: 0.0365 - accuracy: 0.8555 8/11 [====================>.........] - ETA: 0s - loss: 0.0364 - accuracy: 0.8490 9/11 [=======================>......] - ETA: 0s - loss: 0.0363 - accuracy: 0.844710/11 [==========================>...] - ETA: 0s - loss: 0.0362 - accuracy: 0.842411/11 [==============================] - ETA: 0s - loss: 0.0362 - accuracy: 0.840711/11 [==============================] - 2s 220ms/step - loss: 0.0362 - accuracy: 0.8393
Epoch 16/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0388 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 1s - loss: 0.0385 - accuracy: 0.8457 3/11 [=======>......................] - ETA: 1s - loss: 0.0377 - accuracy: 0.8511 4/11 [=========>....................] - ETA: 1s - loss: 0.0369 - accuracy: 0.8542 5/11 [============>.................] - ETA: 1s - loss: 0.0364 - accuracy: 0.8533 6/11 [===============>..............] - ETA: 1s - loss: 0.0359 - accuracy: 0.8528 7/11 [==================>...........] - ETA: 0s - loss: 0.0355 - accuracy: 0.8515 8/11 [====================>.........] - ETA: 0s - loss: 0.0351 - accuracy: 0.8501 9/11 [=======================>......] - ETA: 0s - loss: 0.0349 - accuracy: 0.847810/11 [==========================>...] - ETA: 0s - loss: 0.0348 - accuracy: 0.845211/11 [==============================] - ETA: 0s - loss: 0.0347 - accuracy: 0.842911/11 [==============================] - 2s 225ms/step - loss: 0.0345 - accuracy: 0.8409
Epoch 17/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0371 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 1s - loss: 0.0365 - accuracy: 0.8770 3/11 [=======>......................] - ETA: 1s - loss: 0.0355 - accuracy: 0.8832 4/11 [=========>....................] - ETA: 1s - loss: 0.0344 - accuracy: 0.8900 5/11 [============>.................] - ETA: 1s - loss: 0.0339 - accuracy: 0.8939 6/11 [===============>..............] - ETA: 1s - loss: 0.0333 - accuracy: 0.8944 7/11 [==================>...........] - ETA: 0s - loss: 0.0330 - accuracy: 0.8923 8/11 [====================>.........] - ETA: 0s - loss: 0.0328 - accuracy: 0.8878 9/11 [=======================>......] - ETA: 0s - loss: 0.0327 - accuracy: 0.883610/11 [==========================>...] - ETA: 0s - loss: 0.0326 - accuracy: 0.879011/11 [==============================] - ETA: 0s - loss: 0.0326 - accuracy: 0.874611/11 [==============================] - 2s 223ms/step - loss: 0.0325 - accuracy: 0.8710
Epoch 18/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0240 - accuracy: 0.9062 2/11 [====>.........................] - ETA: 1s - loss: 0.0252 - accuracy: 0.8789 3/11 [=======>......................] - ETA: 1s - loss: 0.0263 - accuracy: 0.8707 4/11 [=========>....................] - ETA: 1s - loss: 0.0268 - accuracy: 0.8688 5/11 [============>.................] - ETA: 1s - loss: 0.0271 - accuracy: 0.8679 6/11 [===============>..............] - ETA: 1s - loss: 0.0272 - accuracy: 0.8675 7/11 [==================>...........] - ETA: 0s - loss: 0.0273 - accuracy: 0.8676 8/11 [====================>.........] - ETA: 0s - loss: 0.0275 - accuracy: 0.8670 9/11 [=======================>......] - ETA: 0s - loss: 0.0277 - accuracy: 0.866810/11 [==========================>...] - ETA: 0s - loss: 0.0279 - accuracy: 0.866411/11 [==============================] - ETA: 0s - loss: 0.0280 - accuracy: 0.865611/11 [==============================] - 2s 223ms/step - loss: 0.0282 - accuracy: 0.8650
Epoch 19/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0272 - accuracy: 0.8984 2/11 [====>.........................] - ETA: 1s - loss: 0.0275 - accuracy: 0.9043 3/11 [=======>......................] - ETA: 1s - loss: 0.0282 - accuracy: 0.9058 4/11 [=========>....................] - ETA: 1s - loss: 0.0286 - accuracy: 0.9059 5/11 [============>.................] - ETA: 1s - loss: 0.0286 - accuracy: 0.9060 6/11 [===============>..............] - ETA: 1s - loss: 0.0287 - accuracy: 0.9060 7/11 [==================>...........] - ETA: 0s - loss: 0.0287 - accuracy: 0.9062 8/11 [====================>.........] - ETA: 0s - loss: 0.0287 - accuracy: 0.9065 9/11 [=======================>......] - ETA: 0s - loss: 0.0286 - accuracy: 0.905910/11 [==========================>...] - ETA: 0s - loss: 0.0286 - accuracy: 0.905411/11 [==============================] - ETA: 0s - loss: 0.0285 - accuracy: 0.905111/11 [==============================] - 2s 218ms/step - loss: 0.0284 - accuracy: 0.9048
Epoch 20/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0275 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 1s - loss: 0.0288 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 1s - loss: 0.0287 - accuracy: 0.8741 4/11 [=========>....................] - ETA: 1s - loss: 0.0289 - accuracy: 0.8787 5/11 [============>.................] - ETA: 1s - loss: 0.0287 - accuracy: 0.8789 6/11 [===============>..............] - ETA: 1s - loss: 0.0283 - accuracy: 0.8785 7/11 [==================>...........] - ETA: 0s - loss: 0.0280 - accuracy: 0.8782 8/11 [====================>.........] - ETA: 0s - loss: 0.0277 - accuracy: 0.8785 9/11 [=======================>......] - ETA: 0s - loss: 0.0274 - accuracy: 0.879110/11 [==========================>...] - ETA: 0s - loss: 0.0272 - accuracy: 0.879511/11 [==============================] - ETA: 0s - loss: 0.0271 - accuracy: 0.880211/11 [==============================] - 2s 226ms/step - loss: 0.0270 - accuracy: 0.8807
Evaluate on test data
1/6 [====>.........................] - ETA: 13s - loss: 0.0259 - accuracy: 0.90622/6 [=========>....................] - ETA: 0s - loss: 0.0264 - accuracy: 0.9336 3/6 [==============>...............] - ETA: 0s - loss: 0.0290 - accuracy: 0.93494/6 [===================>..........] - ETA: 0s - loss: 0.0287 - accuracy: 0.93755/6 [========================>.....] - ETA: 0s - loss: 0.0285 - accuracy: 0.93126/6 [==============================] - 3s 49ms/step - loss: 0.0286 - accuracy: 0.9249
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [0.00479504 0.5430397  0.89173853 0.03987384 0.00151941]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [0.00142038 0.20654109 0.9766432  0.04447716 0.00181994]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [4 3 0 2 1] pred: [0.0854657  0.02602714 0.07898271 0.52950644 0.5857999 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 3 0 4] pred: [6.7745745e-03 9.1437435e-01 8.5893345e-01 7.4376464e-03 4.2593479e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 0 4] pred: [0.00193301 0.01406616 0.9752315  0.01804107 0.00147465]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [4 3 0 2 1] pred: [0.1346806  0.02178848 0.05664498 0.45097432 0.7658373 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [0.01979756 0.42566645 0.8238789  0.11196649 0.01254743]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 0 4] pred: [0.00210264 0.01282212 0.97427016 0.02006066 0.00152633]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [1.1725992e-02 8.4533435e-01 8.1373680e-01 9.0302229e-03 6.0650706e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [4 3 0 2 1] pred: [0.14791277 0.03198454 0.05803806 0.5515     0.8144878 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [3 4 2 0 1] pred: [0.01338324 0.01095933 0.07469541 0.85023206 0.10023645]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [1.5021622e-02 8.4848863e-01 8.4242666e-01 5.8035851e-03 5.8481097e-04]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [0.0017997  0.03076422 0.97972775 0.01307076 0.00150609]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 0 4] pred: [0.00192112 0.01398671 0.9754896  0.01802742 0.00147039]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [4.712686e-02 9.385015e-01 7.187579e-01 5.748749e-03 8.804798e-04]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 1 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_1 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:20 - loss: 0.2513 - accuracy: 0.1953 2/11 [====>.........................] - ETA: 1s - loss: 0.2508 - accuracy: 0.1699   3/11 [=======>......................] - ETA: 1s - loss: 0.2503 - accuracy: 0.1853 4/11 [=========>....................] - ETA: 1s - loss: 0.2498 - accuracy: 0.2059 5/11 [============>.................] - ETA: 1s - loss: 0.2493 - accuracy: 0.2269 6/11 [===============>..............] - ETA: 0s - loss: 0.2488 - accuracy: 0.2453 7/11 [==================>...........] - ETA: 0s - loss: 0.2483 - accuracy: 0.2610 8/11 [====================>.........] - ETA: 0s - loss: 0.2478 - accuracy: 0.2742 9/11 [=======================>......] - ETA: 0s - loss: 0.2473 - accuracy: 0.285110/11 [==========================>...] - ETA: 0s - loss: 0.2468 - accuracy: 0.294911/11 [==============================] - ETA: 0s - loss: 0.2462 - accuracy: 0.303411/11 [==============================] - 10s 209ms/step - loss: 0.2458 - accuracy: 0.3104
Epoch 2/20
 1/11 [=>............................] - ETA: 2s - loss: 0.2272 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.2262 - accuracy: 0.4277 3/11 [=======>......................] - ETA: 1s - loss: 0.2254 - accuracy: 0.4275 4/11 [=========>....................] - ETA: 1s - loss: 0.2244 - accuracy: 0.4310 5/11 [============>.................] - ETA: 1s - loss: 0.2234 - accuracy: 0.4314 6/11 [===============>..............] - ETA: 1s - loss: 0.2225 - accuracy: 0.4317 7/11 [==================>...........] - ETA: 0s - loss: 0.2215 - accuracy: 0.4335 8/11 [====================>.........] - ETA: 0s - loss: 0.2205 - accuracy: 0.4347 9/11 [=======================>......] - ETA: 0s - loss: 0.2194 - accuracy: 0.437310/11 [==========================>...] - ETA: 0s - loss: 0.2182 - accuracy: 0.439811/11 [==============================] - ETA: 0s - loss: 0.2172 - accuracy: 0.441511/11 [==============================] - 2s 211ms/step - loss: 0.2163 - accuracy: 0.4429
Epoch 3/20
 1/11 [=>............................] - ETA: 2s - loss: 0.1752 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.1740 - accuracy: 0.4258 3/11 [=======>......................] - ETA: 1s - loss: 0.1720 - accuracy: 0.4262 4/11 [=========>....................] - ETA: 1s - loss: 0.1699 - accuracy: 0.4290 5/11 [============>.................] - ETA: 1s - loss: 0.1680 - accuracy: 0.4304 6/11 [===============>..............] - ETA: 1s - loss: 0.1660 - accuracy: 0.4318 7/11 [==================>...........] - ETA: 0s - loss: 0.1641 - accuracy: 0.4331 8/11 [====================>.........] - ETA: 0s - loss: 0.1622 - accuracy: 0.4354 9/11 [=======================>......] - ETA: 0s - loss: 0.1602 - accuracy: 0.437310/11 [==========================>...] - ETA: 0s - loss: 0.1583 - accuracy: 0.439511/11 [==============================] - ETA: 0s - loss: 0.1566 - accuracy: 0.441211/11 [==============================] - 2s 206ms/step - loss: 0.1552 - accuracy: 0.4427
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1231 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.1212 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 1s - loss: 0.1208 - accuracy: 0.4549 4/11 [=========>....................] - ETA: 0s - loss: 0.1208 - accuracy: 0.4539 5/11 [============>.................] - ETA: 0s - loss: 0.1209 - accuracy: 0.4535 6/11 [===============>..............] - ETA: 0s - loss: 0.1212 - accuracy: 0.4521 7/11 [==================>...........] - ETA: 0s - loss: 0.1210 - accuracy: 0.4519 8/11 [====================>.........] - ETA: 0s - loss: 0.1209 - accuracy: 0.4518 9/11 [=======================>......] - ETA: 0s - loss: 0.1205 - accuracy: 0.452910/11 [==========================>...] - ETA: 0s - loss: 0.1201 - accuracy: 0.453411/11 [==============================] - ETA: 0s - loss: 0.1198 - accuracy: 0.453811/11 [==============================] - 2s 143ms/step - loss: 0.1195 - accuracy: 0.4542
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1165 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 1s - loss: 0.1192 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 1s - loss: 0.1178 - accuracy: 0.4557 4/11 [=========>....................] - ETA: 1s - loss: 0.1170 - accuracy: 0.4570 5/11 [============>.................] - ETA: 1s - loss: 0.1161 - accuracy: 0.4606 6/11 [===============>..............] - ETA: 1s - loss: 0.1155 - accuracy: 0.4626 7/11 [==================>...........] - ETA: 0s - loss: 0.1148 - accuracy: 0.4633 8/11 [====================>.........] - ETA: 0s - loss: 0.1144 - accuracy: 0.4630 9/11 [=======================>......] - ETA: 0s - loss: 0.1139 - accuracy: 0.463410/11 [==========================>...] - ETA: 0s - loss: 0.1136 - accuracy: 0.463211/11 [==============================] - ETA: 0s - loss: 0.1134 - accuracy: 0.462811/11 [==============================] - 2s 189ms/step - loss: 0.1133 - accuracy: 0.4624
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1112 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.1141 - accuracy: 0.4766 3/11 [=======>......................] - ETA: 1s - loss: 0.1141 - accuracy: 0.4705 4/11 [=========>....................] - ETA: 1s - loss: 0.1133 - accuracy: 0.4715 5/11 [============>.................] - ETA: 1s - loss: 0.1125 - accuracy: 0.4716 6/11 [===============>..............] - ETA: 0s - loss: 0.1120 - accuracy: 0.4709 7/11 [==================>...........] - ETA: 0s - loss: 0.1116 - accuracy: 0.4703 8/11 [====================>.........] - ETA: 0s - loss: 0.1111 - accuracy: 0.4697 9/11 [=======================>......] - ETA: 0s - loss: 0.1107 - accuracy: 0.468810/11 [==========================>...] - ETA: 0s - loss: 0.1102 - accuracy: 0.468311/11 [==============================] - ETA: 0s - loss: 0.1098 - accuracy: 0.467411/11 [==============================] - 2s 187ms/step - loss: 0.1095 - accuracy: 0.4666
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0936 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.0976 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 1s - loss: 0.0986 - accuracy: 0.4818 4/11 [=========>....................] - ETA: 1s - loss: 0.0987 - accuracy: 0.4761 5/11 [============>.................] - ETA: 0s - loss: 0.0989 - accuracy: 0.4718 6/11 [===============>..............] - ETA: 0s - loss: 0.0991 - accuracy: 0.4685 7/11 [==================>...........] - ETA: 0s - loss: 0.0993 - accuracy: 0.4660 8/11 [====================>.........] - ETA: 0s - loss: 0.0994 - accuracy: 0.4646 9/11 [=======================>......] - ETA: 0s - loss: 0.0994 - accuracy: 0.464110/11 [==========================>...] - ETA: 0s - loss: 0.0994 - accuracy: 0.463511/11 [==============================] - ETA: 0s - loss: 0.0993 - accuracy: 0.463111/11 [==============================] - 2s 165ms/step - loss: 0.0993 - accuracy: 0.4629
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0923 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.0941 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 1s - loss: 0.0939 - accuracy: 0.4605 4/11 [=========>....................] - ETA: 1s - loss: 0.0935 - accuracy: 0.4640 5/11 [============>.................] - ETA: 0s - loss: 0.0935 - accuracy: 0.4631 6/11 [===============>..............] - ETA: 0s - loss: 0.0934 - accuracy: 0.4627 7/11 [==================>...........] - ETA: 0s - loss: 0.0933 - accuracy: 0.4642 8/11 [====================>.........] - ETA: 0s - loss: 0.0933 - accuracy: 0.4639 9/11 [=======================>......] - ETA: 0s - loss: 0.0932 - accuracy: 0.464110/11 [==========================>...] - ETA: 0s - loss: 0.0929 - accuracy: 0.465411/11 [==============================] - ETA: 0s - loss: 0.0926 - accuracy: 0.467011/11 [==============================] - 2s 170ms/step - loss: 0.0924 - accuracy: 0.4683
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0828 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.0805 - accuracy: 0.5215 3/11 [=======>......................] - ETA: 1s - loss: 0.0815 - accuracy: 0.5204 4/11 [=========>....................] - ETA: 1s - loss: 0.0821 - accuracy: 0.5168 5/11 [============>.................] - ETA: 1s - loss: 0.0823 - accuracy: 0.5137 6/11 [===============>..............] - ETA: 0s - loss: 0.0822 - accuracy: 0.5125 7/11 [==================>...........] - ETA: 0s - loss: 0.0819 - accuracy: 0.5126 8/11 [====================>.........] - ETA: 0s - loss: 0.0816 - accuracy: 0.5122 9/11 [=======================>......] - ETA: 0s - loss: 0.0814 - accuracy: 0.511910/11 [==========================>...] - ETA: 0s - loss: 0.0812 - accuracy: 0.512211/11 [==============================] - ETA: 0s - loss: 0.0809 - accuracy: 0.513311/11 [==============================] - 2s 165ms/step - loss: 0.0808 - accuracy: 0.5142
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0759 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.0754 - accuracy: 0.5605 3/11 [=======>......................] - ETA: 1s - loss: 0.0749 - accuracy: 0.5577 4/11 [=========>....................] - ETA: 1s - loss: 0.0742 - accuracy: 0.5540 5/11 [============>.................] - ETA: 0s - loss: 0.0742 - accuracy: 0.5504 6/11 [===============>..............] - ETA: 0s - loss: 0.0739 - accuracy: 0.5503 7/11 [==================>...........] - ETA: 0s - loss: 0.0735 - accuracy: 0.5509 8/11 [====================>.........] - ETA: 0s - loss: 0.0730 - accuracy: 0.5526 9/11 [=======================>......] - ETA: 0s - loss: 0.0725 - accuracy: 0.553610/11 [==========================>...] - ETA: 0s - loss: 0.0721 - accuracy: 0.554111/11 [==============================] - ETA: 0s - loss: 0.0717 - accuracy: 0.554011/11 [==============================] - 2s 168ms/step - loss: 0.0714 - accuracy: 0.5540
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0690 - accuracy: 0.6562 2/11 [====>.........................] - ETA: 1s - loss: 0.0671 - accuracy: 0.6582 3/11 [=======>......................] - ETA: 1s - loss: 0.0668 - accuracy: 0.6558 4/11 [=========>....................] - ETA: 1s - loss: 0.0664 - accuracy: 0.6506 5/11 [============>.................] - ETA: 1s - loss: 0.0659 - accuracy: 0.6479 6/11 [===============>..............] - ETA: 0s - loss: 0.0656 - accuracy: 0.6446 7/11 [==================>...........] - ETA: 0s - loss: 0.0653 - accuracy: 0.6408 8/11 [====================>.........] - ETA: 0s - loss: 0.0649 - accuracy: 0.6379 9/11 [=======================>......] - ETA: 0s - loss: 0.0645 - accuracy: 0.635710/11 [==========================>...] - ETA: 0s - loss: 0.0641 - accuracy: 0.634111/11 [==============================] - ETA: 0s - loss: 0.0638 - accuracy: 0.633011/11 [==============================] - 2s 178ms/step - loss: 0.0635 - accuracy: 0.6321
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0555 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 1s - loss: 0.0555 - accuracy: 0.6328 3/11 [=======>......................] - ETA: 1s - loss: 0.0551 - accuracy: 0.6467 4/11 [=========>....................] - ETA: 1s - loss: 0.0549 - accuracy: 0.6525 5/11 [============>.................] - ETA: 1s - loss: 0.0547 - accuracy: 0.6561 6/11 [===============>..............] - ETA: 0s - loss: 0.0544 - accuracy: 0.6589 7/11 [==================>...........] - ETA: 0s - loss: 0.0541 - accuracy: 0.6600 8/11 [====================>.........] - ETA: 0s - loss: 0.0540 - accuracy: 0.6618 9/11 [=======================>......] - ETA: 0s - loss: 0.0539 - accuracy: 0.664110/11 [==========================>...] - ETA: 0s - loss: 0.0538 - accuracy: 0.666011/11 [==============================] - ETA: 0s - loss: 0.0537 - accuracy: 0.667911/11 [==============================] - 2s 176ms/step - loss: 0.0537 - accuracy: 0.6695
Epoch 13/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0603 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 2s - loss: 0.0574 - accuracy: 0.7793 3/11 [=======>......................] - ETA: 1s - loss: 0.0555 - accuracy: 0.7834 4/11 [=========>....................] - ETA: 1s - loss: 0.0543 - accuracy: 0.7843 5/11 [============>.................] - ETA: 1s - loss: 0.0536 - accuracy: 0.7862 6/11 [===============>..............] - ETA: 0s - loss: 0.0530 - accuracy: 0.7882 7/11 [==================>...........] - ETA: 0s - loss: 0.0525 - accuracy: 0.7909 8/11 [====================>.........] - ETA: 0s - loss: 0.0519 - accuracy: 0.7936 9/11 [=======================>......] - ETA: 0s - loss: 0.0515 - accuracy: 0.796210/11 [==========================>...] - ETA: 0s - loss: 0.0511 - accuracy: 0.798211/11 [==============================] - ETA: 0s - loss: 0.0508 - accuracy: 0.799711/11 [==============================] - 2s 200ms/step - loss: 0.0506 - accuracy: 0.8009
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0494 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 1s - loss: 0.0483 - accuracy: 0.8164 3/11 [=======>......................] - ETA: 1s - loss: 0.0481 - accuracy: 0.7977 4/11 [=========>....................] - ETA: 1s - loss: 0.0480 - accuracy: 0.7858 5/11 [============>.................] - ETA: 0s - loss: 0.0473 - accuracy: 0.7752 6/11 [===============>..............] - ETA: 0s - loss: 0.0468 - accuracy: 0.7684 7/11 [==================>...........] - ETA: 0s - loss: 0.0464 - accuracy: 0.7651 8/11 [====================>.........] - ETA: 0s - loss: 0.0460 - accuracy: 0.7629 9/11 [=======================>......] - ETA: 0s - loss: 0.0457 - accuracy: 0.761410/11 [==========================>...] - ETA: 0s - loss: 0.0454 - accuracy: 0.761711/11 [==============================] - ETA: 0s - loss: 0.0453 - accuracy: 0.761911/11 [==============================] - 2s 182ms/step - loss: 0.0451 - accuracy: 0.7621
Epoch 15/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0409 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 1s - loss: 0.0426 - accuracy: 0.8320 3/11 [=======>......................] - ETA: 1s - loss: 0.0430 - accuracy: 0.8203 4/11 [=========>....................] - ETA: 1s - loss: 0.0427 - accuracy: 0.8164 5/11 [============>.................] - ETA: 1s - loss: 0.0425 - accuracy: 0.8144 6/11 [===============>..............] - ETA: 0s - loss: 0.0423 - accuracy: 0.8136 7/11 [==================>...........] - ETA: 0s - loss: 0.0421 - accuracy: 0.8136 8/11 [====================>.........] - ETA: 0s - loss: 0.0419 - accuracy: 0.8151 9/11 [=======================>......] - ETA: 0s - loss: 0.0418 - accuracy: 0.816910/11 [==========================>...] - ETA: 0s - loss: 0.0416 - accuracy: 0.818511/11 [==============================] - ETA: 0s - loss: 0.0415 - accuracy: 0.819811/11 [==============================] - 2s 166ms/step - loss: 0.0413 - accuracy: 0.8208
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0399 - accuracy: 0.7500 2/11 [====>.........................] - ETA: 1s - loss: 0.0391 - accuracy: 0.7715 3/11 [=======>......................] - ETA: 1s - loss: 0.0393 - accuracy: 0.7765 4/11 [=========>....................] - ETA: 0s - loss: 0.0391 - accuracy: 0.7821 5/11 [============>.................] - ETA: 0s - loss: 0.0389 - accuracy: 0.7882 6/11 [===============>..............] - ETA: 0s - loss: 0.0387 - accuracy: 0.7948 7/11 [==================>...........] - ETA: 0s - loss: 0.0386 - accuracy: 0.8012 8/11 [====================>.........] - ETA: 0s - loss: 0.0385 - accuracy: 0.8059 9/11 [=======================>......] - ETA: 0s - loss: 0.0384 - accuracy: 0.809710/11 [==========================>...] - ETA: 0s - loss: 0.0383 - accuracy: 0.812211/11 [==============================] - ETA: 0s - loss: 0.0382 - accuracy: 0.812211/11 [==============================] - 2s 160ms/step - loss: 0.0382 - accuracy: 0.8123
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0440 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 1s - loss: 0.0406 - accuracy: 0.7129 3/11 [=======>......................] - ETA: 1s - loss: 0.0391 - accuracy: 0.7279 4/11 [=========>....................] - ETA: 1s - loss: 0.0388 - accuracy: 0.7432 5/11 [============>.................] - ETA: 0s - loss: 0.0383 - accuracy: 0.7573 6/11 [===============>..............] - ETA: 0s - loss: 0.0382 - accuracy: 0.7678 7/11 [==================>...........] - ETA: 0s - loss: 0.0381 - accuracy: 0.7771 8/11 [====================>.........] - ETA: 0s - loss: 0.0379 - accuracy: 0.7852 9/11 [=======================>......] - ETA: 0s - loss: 0.0376 - accuracy: 0.792010/11 [==========================>...] - ETA: 0s - loss: 0.0375 - accuracy: 0.797311/11 [==============================] - ETA: 0s - loss: 0.0373 - accuracy: 0.801911/11 [==============================] - 2s 153ms/step - loss: 0.0371 - accuracy: 0.8057
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0323 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 1s - loss: 0.0328 - accuracy: 0.8281 3/11 [=======>......................] - ETA: 1s - loss: 0.0329 - accuracy: 0.8264 4/11 [=========>....................] - ETA: 1s - loss: 0.0327 - accuracy: 0.8263 5/11 [============>.................] - ETA: 1s - loss: 0.0326 - accuracy: 0.8279 6/11 [===============>..............] - ETA: 0s - loss: 0.0326 - accuracy: 0.8275 7/11 [==================>...........] - ETA: 0s - loss: 0.0326 - accuracy: 0.8281 8/11 [====================>.........] - ETA: 0s - loss: 0.0326 - accuracy: 0.8285 9/11 [=======================>......] - ETA: 0s - loss: 0.0325 - accuracy: 0.828810/11 [==========================>...] - ETA: 0s - loss: 0.0325 - accuracy: 0.828811/11 [==============================] - ETA: 0s - loss: 0.0326 - accuracy: 0.829411/11 [==============================] - 2s 169ms/step - loss: 0.0326 - accuracy: 0.8299
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0366 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 1s - loss: 0.0354 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 1s - loss: 0.0347 - accuracy: 0.8681 4/11 [=========>....................] - ETA: 1s - loss: 0.0344 - accuracy: 0.8674 5/11 [============>.................] - ETA: 1s - loss: 0.0341 - accuracy: 0.8692 6/11 [===============>..............] - ETA: 0s - loss: 0.0337 - accuracy: 0.8699 7/11 [==================>...........] - ETA: 0s - loss: 0.0334 - accuracy: 0.8699 8/11 [====================>.........] - ETA: 0s - loss: 0.0331 - accuracy: 0.8697 9/11 [=======================>......] - ETA: 0s - loss: 0.0328 - accuracy: 0.870010/11 [==========================>...] - ETA: 0s - loss: 0.0327 - accuracy: 0.870011/11 [==============================] - ETA: 0s - loss: 0.0325 - accuracy: 0.869611/11 [==============================] - 2s 173ms/step - loss: 0.0324 - accuracy: 0.8692
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0291 - accuracy: 0.8906 2/11 [====>.........................] - ETA: 1s - loss: 0.0284 - accuracy: 0.8926 3/11 [=======>......................] - ETA: 1s - loss: 0.0284 - accuracy: 0.8876 4/11 [=========>....................] - ETA: 0s - loss: 0.0286 - accuracy: 0.8854 5/11 [============>.................] - ETA: 0s - loss: 0.0287 - accuracy: 0.8830 6/11 [===============>..............] - ETA: 0s - loss: 0.0285 - accuracy: 0.8817 7/11 [==================>...........] - ETA: 0s - loss: 0.0284 - accuracy: 0.8812 8/11 [====================>.........] - ETA: 0s - loss: 0.0284 - accuracy: 0.8803 9/11 [=======================>......] - ETA: 0s - loss: 0.0284 - accuracy: 0.879210/11 [==========================>...] - ETA: 0s - loss: 0.0285 - accuracy: 0.878411/11 [==============================] - ETA: 0s - loss: 0.0285 - accuracy: 0.878011/11 [==============================] - 2s 175ms/step - loss: 0.0286 - accuracy: 0.8777
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.0322 - accuracy: 0.90623/6 [==============>...............] - ETA: 0s - loss: 0.0289 - accuracy: 0.9219 5/6 [========================>.....] - ETA: 0s - loss: 0.0294 - accuracy: 0.91566/6 [==============================] - 3s 31ms/step - loss: 0.0290 - accuracy: 0.9164
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 4 0] pred: [5.7312846e-04 1.5089214e-02 9.7791624e-01 3.2892615e-02 1.2219548e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [1 0 2 3 4] pred: [0.34871525 0.7391502  0.11991566 0.04454273 0.02006775]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [0 1 3 4 2] pred: [0.5578558  0.30694473 0.13176066 0.24893564 0.13271037]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.02273723 0.9160184  0.68661183 0.0109365  0.00419202]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 4 0] pred: [5.6466460e-04 1.5543342e-02 9.7753847e-01 3.1776845e-02 1.2397170e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 4 0] pred: [6.1085820e-04 1.8078893e-02 9.7500229e-01 3.1619251e-02 1.4069974e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [0.02860484 0.94847524 0.5620924  0.01874101 0.00679311]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [0 1 3 4 2] pred: [0.8053246  0.22047287 0.02575037 0.07879791 0.03454164]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 3 0 4] pred: [0.00964221 0.8815438  0.81969553 0.0107657  0.00255665]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [0.03759718 0.9031235  0.51521325 0.02129027 0.00594294]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 4 0] pred: [5.1671267e-04 1.5792757e-02 9.7231138e-01 3.5132378e-02 1.3796389e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 3 0 4] pred: [0.03367934 0.46497193 0.6076187  0.11318943 0.01531541]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 2 0 1] pred: [0.05750749 0.02628583 0.0651786  0.7374957  0.32523006]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [0.00487477 0.22589764 0.93339056 0.02330697 0.00649169]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [0.01610345 0.9494346  0.8549035  0.00933674 0.00289109]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 2 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_2 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:13 - loss: 0.2521 - accuracy: 0.1406 2/11 [====>.........................] - ETA: 1s - loss: 0.2516 - accuracy: 0.1484   3/11 [=======>......................] - ETA: 1s - loss: 0.2511 - accuracy: 0.1840 4/11 [=========>....................] - ETA: 1s - loss: 0.2506 - accuracy: 0.2157 5/11 [============>.................] - ETA: 1s - loss: 0.2502 - accuracy: 0.2388 6/11 [===============>..............] - ETA: 0s - loss: 0.2497 - accuracy: 0.2565 7/11 [==================>...........] - ETA: 0s - loss: 0.2493 - accuracy: 0.2710 8/11 [====================>.........] - ETA: 0s - loss: 0.2488 - accuracy: 0.2829 9/11 [=======================>......] - ETA: 0s - loss: 0.2484 - accuracy: 0.293910/11 [==========================>...] - ETA: 0s - loss: 0.2479 - accuracy: 0.303311/11 [==============================] - ETA: 0s - loss: 0.2475 - accuracy: 0.311211/11 [==============================] - 9s 186ms/step - loss: 0.2471 - accuracy: 0.3178
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2287 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.2283 - accuracy: 0.4531 3/11 [=======>......................] - ETA: 1s - loss: 0.2277 - accuracy: 0.4601 4/11 [=========>....................] - ETA: 1s - loss: 0.2271 - accuracy: 0.4583 5/11 [============>.................] - ETA: 1s - loss: 0.2265 - accuracy: 0.4567 6/11 [===============>..............] - ETA: 0s - loss: 0.2258 - accuracy: 0.4561 7/11 [==================>...........] - ETA: 0s - loss: 0.2251 - accuracy: 0.4568 8/11 [====================>.........] - ETA: 0s - loss: 0.2243 - accuracy: 0.4569 9/11 [=======================>......] - ETA: 0s - loss: 0.2235 - accuracy: 0.456810/11 [==========================>...] - ETA: 0s - loss: 0.2226 - accuracy: 0.456311/11 [==============================] - ETA: 0s - loss: 0.2217 - accuracy: 0.456011/11 [==============================] - 2s 193ms/step - loss: 0.2210 - accuracy: 0.4558
Epoch 3/20
 1/11 [=>............................] - ETA: 2s - loss: 0.1836 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.1810 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 1s - loss: 0.1787 - accuracy: 0.4601 4/11 [=========>....................] - ETA: 1s - loss: 0.1767 - accuracy: 0.4652 5/11 [============>.................] - ETA: 1s - loss: 0.1750 - accuracy: 0.4659 6/11 [===============>..............] - ETA: 0s - loss: 0.1733 - accuracy: 0.4666 7/11 [==================>...........] - ETA: 0s - loss: 0.1715 - accuracy: 0.4667 8/11 [====================>.........] - ETA: 0s - loss: 0.1699 - accuracy: 0.4655 9/11 [=======================>......] - ETA: 0s - loss: 0.1682 - accuracy: 0.464910/11 [==========================>...] - ETA: 0s - loss: 0.1667 - accuracy: 0.464011/11 [==============================] - ETA: 0s - loss: 0.1654 - accuracy: 0.463011/11 [==============================] - 2s 189ms/step - loss: 0.1643 - accuracy: 0.4622
Epoch 4/20
 1/11 [=>............................] - ETA: 2s - loss: 0.1139 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.1156 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 1s - loss: 0.1181 - accuracy: 0.4622 4/11 [=========>....................] - ETA: 1s - loss: 0.1184 - accuracy: 0.4570 5/11 [============>.................] - ETA: 1s - loss: 0.1190 - accuracy: 0.4534 6/11 [===============>..............] - ETA: 0s - loss: 0.1196 - accuracy: 0.4514 7/11 [==================>...........] - ETA: 0s - loss: 0.1199 - accuracy: 0.4499 8/11 [====================>.........] - ETA: 0s - loss: 0.1200 - accuracy: 0.4490 9/11 [=======================>......] - ETA: 0s - loss: 0.1199 - accuracy: 0.448710/11 [==========================>...] - ETA: 0s - loss: 0.1197 - accuracy: 0.448711/11 [==============================] - ETA: 0s - loss: 0.1195 - accuracy: 0.449111/11 [==============================] - 2s 194ms/step - loss: 0.1194 - accuracy: 0.4495
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1081 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.1077 - accuracy: 0.4414 3/11 [=======>......................] - ETA: 1s - loss: 0.1081 - accuracy: 0.4462 4/11 [=========>....................] - ETA: 1s - loss: 0.1084 - accuracy: 0.4504 5/11 [============>.................] - ETA: 0s - loss: 0.1086 - accuracy: 0.4528 6/11 [===============>..............] - ETA: 0s - loss: 0.1088 - accuracy: 0.4544 7/11 [==================>...........] - ETA: 0s - loss: 0.1091 - accuracy: 0.4555 8/11 [====================>.........] - ETA: 0s - loss: 0.1092 - accuracy: 0.4558 9/11 [=======================>......] - ETA: 0s - loss: 0.1092 - accuracy: 0.456010/11 [==========================>...] - ETA: 0s - loss: 0.1091 - accuracy: 0.456511/11 [==============================] - ETA: 0s - loss: 0.1092 - accuracy: 0.456211/11 [==============================] - 2s 169ms/step - loss: 0.1092 - accuracy: 0.4559
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1104 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.1089 - accuracy: 0.4648 3/11 [=======>......................] - ETA: 1s - loss: 0.1077 - accuracy: 0.4627 4/11 [=========>....................] - ETA: 1s - loss: 0.1073 - accuracy: 0.4598 5/11 [============>.................] - ETA: 1s - loss: 0.1071 - accuracy: 0.4591 6/11 [===============>..............] - ETA: 0s - loss: 0.1071 - accuracy: 0.4574 7/11 [==================>...........] - ETA: 0s - loss: 0.1070 - accuracy: 0.4552 8/11 [====================>.........] - ETA: 0s - loss: 0.1069 - accuracy: 0.4540 9/11 [=======================>......] - ETA: 0s - loss: 0.1066 - accuracy: 0.453710/11 [==========================>...] - ETA: 0s - loss: 0.1061 - accuracy: 0.454011/11 [==============================] - ETA: 0s - loss: 0.1058 - accuracy: 0.454011/11 [==============================] - 2s 167ms/step - loss: 0.1055 - accuracy: 0.4540
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1026 - accuracy: 0.3828 2/11 [====>.........................] - ETA: 1s - loss: 0.1032 - accuracy: 0.4023 3/11 [=======>......................] - ETA: 1s - loss: 0.1020 - accuracy: 0.4175 4/11 [=========>....................] - ETA: 1s - loss: 0.1008 - accuracy: 0.4259 5/11 [============>.................] - ETA: 1s - loss: 0.0998 - accuracy: 0.4336 6/11 [===============>..............] - ETA: 0s - loss: 0.0988 - accuracy: 0.4412 7/11 [==================>...........] - ETA: 0s - loss: 0.0981 - accuracy: 0.4461 8/11 [====================>.........] - ETA: 0s - loss: 0.0977 - accuracy: 0.4496 9/11 [=======================>......] - ETA: 0s - loss: 0.0972 - accuracy: 0.453610/11 [==========================>...] - ETA: 0s - loss: 0.0968 - accuracy: 0.456711/11 [==============================] - ETA: 0s - loss: 0.0965 - accuracy: 0.459811/11 [==============================] - 2s 175ms/step - loss: 0.0961 - accuracy: 0.4624
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0805 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 1s - loss: 0.0829 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 1s - loss: 0.0836 - accuracy: 0.5399 4/11 [=========>....................] - ETA: 1s - loss: 0.0842 - accuracy: 0.5382 5/11 [============>.................] - ETA: 1s - loss: 0.0848 - accuracy: 0.5384 6/11 [===============>..............] - ETA: 0s - loss: 0.0849 - accuracy: 0.5411 7/11 [==================>...........] - ETA: 0s - loss: 0.0847 - accuracy: 0.5443 8/11 [====================>.........] - ETA: 0s - loss: 0.0843 - accuracy: 0.5482 9/11 [=======================>......] - ETA: 0s - loss: 0.0840 - accuracy: 0.551810/11 [==========================>...] - ETA: 0s - loss: 0.0837 - accuracy: 0.554311/11 [==============================] - ETA: 0s - loss: 0.0835 - accuracy: 0.556311/11 [==============================] - 2s 183ms/step - loss: 0.0833 - accuracy: 0.5580
Epoch 9/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0778 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 1s - loss: 0.0795 - accuracy: 0.5703 3/11 [=======>......................] - ETA: 1s - loss: 0.0811 - accuracy: 0.5773 4/11 [=========>....................] - ETA: 1s - loss: 0.0809 - accuracy: 0.5858 5/11 [============>.................] - ETA: 1s - loss: 0.0806 - accuracy: 0.5914 6/11 [===============>..............] - ETA: 0s - loss: 0.0800 - accuracy: 0.5968 7/11 [==================>...........] - ETA: 0s - loss: 0.0795 - accuracy: 0.5999 8/11 [====================>.........] - ETA: 0s - loss: 0.0787 - accuracy: 0.6040 9/11 [=======================>......] - ETA: 0s - loss: 0.0780 - accuracy: 0.607710/11 [==========================>...] - ETA: 0s - loss: 0.0774 - accuracy: 0.611311/11 [==============================] - ETA: 0s - loss: 0.0769 - accuracy: 0.614111/11 [==============================] - 2s 189ms/step - loss: 0.0764 - accuracy: 0.6165
Epoch 10/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0815 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 1s - loss: 0.0778 - accuracy: 0.5859 3/11 [=======>......................] - ETA: 1s - loss: 0.0758 - accuracy: 0.5964 4/11 [=========>....................] - ETA: 1s - loss: 0.0739 - accuracy: 0.5981 5/11 [============>.................] - ETA: 1s - loss: 0.0725 - accuracy: 0.6041 6/11 [===============>..............] - ETA: 1s - loss: 0.0715 - accuracy: 0.6107 7/11 [==================>...........] - ETA: 0s - loss: 0.0709 - accuracy: 0.6164 8/11 [====================>.........] - ETA: 0s - loss: 0.0703 - accuracy: 0.6228 9/11 [=======================>......] - ETA: 0s - loss: 0.0697 - accuracy: 0.628410/11 [==========================>...] - ETA: 0s - loss: 0.0692 - accuracy: 0.632811/11 [==============================] - ETA: 0s - loss: 0.0687 - accuracy: 0.636711/11 [==============================] - 2s 192ms/step - loss: 0.0682 - accuracy: 0.6399
Epoch 11/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0675 - accuracy: 0.6484 2/11 [====>.........................] - ETA: 1s - loss: 0.0685 - accuracy: 0.6543 3/11 [=======>......................] - ETA: 1s - loss: 0.0672 - accuracy: 0.6732 4/11 [=========>....................] - ETA: 1s - loss: 0.0657 - accuracy: 0.6870 5/11 [============>.................] - ETA: 1s - loss: 0.0647 - accuracy: 0.6987 6/11 [===============>..............] - ETA: 0s - loss: 0.0637 - accuracy: 0.7083 7/11 [==================>...........] - ETA: 0s - loss: 0.0630 - accuracy: 0.7163 8/11 [====================>.........] - ETA: 0s - loss: 0.0624 - accuracy: 0.7224 9/11 [=======================>......] - ETA: 0s - loss: 0.0620 - accuracy: 0.726210/11 [==========================>...] - ETA: 0s - loss: 0.0615 - accuracy: 0.728111/11 [==============================] - ETA: 0s - loss: 0.0611 - accuracy: 0.729411/11 [==============================] - 2s 186ms/step - loss: 0.0607 - accuracy: 0.7305
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0617 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 1s - loss: 0.0564 - accuracy: 0.6484 3/11 [=======>......................] - ETA: 1s - loss: 0.0549 - accuracy: 0.6736 4/11 [=========>....................] - ETA: 1s - loss: 0.0542 - accuracy: 0.6908 5/11 [============>.................] - ETA: 1s - loss: 0.0540 - accuracy: 0.7007 6/11 [===============>..............] - ETA: 0s - loss: 0.0538 - accuracy: 0.7087 7/11 [==================>...........] - ETA: 0s - loss: 0.0538 - accuracy: 0.7140 8/11 [====================>.........] - ETA: 0s - loss: 0.0537 - accuracy: 0.7190 9/11 [=======================>......] - ETA: 0s - loss: 0.0537 - accuracy: 0.721910/11 [==========================>...] - ETA: 0s - loss: 0.0536 - accuracy: 0.724411/11 [==============================] - ETA: 0s - loss: 0.0535 - accuracy: 0.726611/11 [==============================] - 2s 182ms/step - loss: 0.0534 - accuracy: 0.7284
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0492 - accuracy: 0.7422 2/11 [====>.........................] - ETA: 1s - loss: 0.0508 - accuracy: 0.7539 3/11 [=======>......................] - ETA: 1s - loss: 0.0503 - accuracy: 0.7543 4/11 [=========>....................] - ETA: 1s - loss: 0.0499 - accuracy: 0.7562 5/11 [============>.................] - ETA: 1s - loss: 0.0499 - accuracy: 0.7578 6/11 [===============>..............] - ETA: 0s - loss: 0.0499 - accuracy: 0.7586 7/11 [==================>...........] - ETA: 0s - loss: 0.0497 - accuracy: 0.7598 8/11 [====================>.........] - ETA: 0s - loss: 0.0496 - accuracy: 0.7615 9/11 [=======================>......] - ETA: 0s - loss: 0.0495 - accuracy: 0.763010/11 [==========================>...] - ETA: 0s - loss: 0.0493 - accuracy: 0.763711/11 [==============================] - ETA: 0s - loss: 0.0493 - accuracy: 0.763811/11 [==============================] - 2s 198ms/step - loss: 0.0492 - accuracy: 0.7638
Epoch 14/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0534 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 1s - loss: 0.0511 - accuracy: 0.7910 3/11 [=======>......................] - ETA: 1s - loss: 0.0499 - accuracy: 0.8069 4/11 [=========>....................] - ETA: 1s - loss: 0.0494 - accuracy: 0.8102 5/11 [============>.................] - ETA: 1s - loss: 0.0490 - accuracy: 0.8116 6/11 [===============>..............] - ETA: 0s - loss: 0.0486 - accuracy: 0.8126 7/11 [==================>...........] - ETA: 0s - loss: 0.0483 - accuracy: 0.8109 8/11 [====================>.........] - ETA: 0s - loss: 0.0481 - accuracy: 0.8087 9/11 [=======================>......] - ETA: 0s - loss: 0.0480 - accuracy: 0.806610/11 [==========================>...] - ETA: 0s - loss: 0.0478 - accuracy: 0.805011/11 [==============================] - ETA: 0s - loss: 0.0476 - accuracy: 0.804011/11 [==============================] - 2s 189ms/step - loss: 0.0474 - accuracy: 0.8032
Epoch 15/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0396 - accuracy: 0.8516 2/11 [====>.........................] - ETA: 1s - loss: 0.0397 - accuracy: 0.8477 3/11 [=======>......................] - ETA: 1s - loss: 0.0398 - accuracy: 0.8490 4/11 [=========>....................] - ETA: 1s - loss: 0.0398 - accuracy: 0.8521 5/11 [============>.................] - ETA: 0s - loss: 0.0404 - accuracy: 0.8526 6/11 [===============>..............] - ETA: 0s - loss: 0.0410 - accuracy: 0.8518 7/11 [==================>...........] - ETA: 0s - loss: 0.0412 - accuracy: 0.8505 8/11 [====================>.........] - ETA: 0s - loss: 0.0412 - accuracy: 0.8480 9/11 [=======================>......] - ETA: 0s - loss: 0.0413 - accuracy: 0.844810/11 [==========================>...] - ETA: 0s - loss: 0.0414 - accuracy: 0.841111/11 [==============================] - ETA: 0s - loss: 0.0415 - accuracy: 0.837611/11 [==============================] - 2s 165ms/step - loss: 0.0415 - accuracy: 0.8348
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0369 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 1s - loss: 0.0376 - accuracy: 0.8398 3/11 [=======>......................] - ETA: 1s - loss: 0.0376 - accuracy: 0.8490 4/11 [=========>....................] - ETA: 1s - loss: 0.0382 - accuracy: 0.8540 5/11 [============>.................] - ETA: 1s - loss: 0.0385 - accuracy: 0.8591 6/11 [===============>..............] - ETA: 0s - loss: 0.0388 - accuracy: 0.8627 7/11 [==================>...........] - ETA: 0s - loss: 0.0390 - accuracy: 0.8660 8/11 [====================>.........] - ETA: 0s - loss: 0.0391 - accuracy: 0.8681 9/11 [=======================>......] - ETA: 0s - loss: 0.0392 - accuracy: 0.868110/11 [==========================>...] - ETA: 0s - loss: 0.0392 - accuracy: 0.866611/11 [==============================] - ETA: 0s - loss: 0.0393 - accuracy: 0.864711/11 [==============================] - 2s 182ms/step - loss: 0.0393 - accuracy: 0.8631
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0433 - accuracy: 0.6719 2/11 [====>.........................] - ETA: 1s - loss: 0.0409 - accuracy: 0.7070 3/11 [=======>......................] - ETA: 1s - loss: 0.0401 - accuracy: 0.7266 4/11 [=========>....................] - ETA: 1s - loss: 0.0395 - accuracy: 0.7427 5/11 [============>.................] - ETA: 0s - loss: 0.0392 - accuracy: 0.7551 6/11 [===============>..............] - ETA: 0s - loss: 0.0389 - accuracy: 0.7668 7/11 [==================>...........] - ETA: 0s - loss: 0.0389 - accuracy: 0.7757 8/11 [====================>.........] - ETA: 0s - loss: 0.0389 - accuracy: 0.7836 9/11 [=======================>......] - ETA: 0s - loss: 0.0388 - accuracy: 0.789910/11 [==========================>...] - ETA: 0s - loss: 0.0387 - accuracy: 0.794611/11 [==============================] - ETA: 0s - loss: 0.0386 - accuracy: 0.798311/11 [==============================] - 2s 178ms/step - loss: 0.0385 - accuracy: 0.8014
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0373 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 1s - loss: 0.0353 - accuracy: 0.7051 3/11 [=======>......................] - ETA: 1s - loss: 0.0346 - accuracy: 0.7235 4/11 [=========>....................] - ETA: 1s - loss: 0.0341 - accuracy: 0.7409 5/11 [============>.................] - ETA: 1s - loss: 0.0339 - accuracy: 0.7561 6/11 [===============>..............] - ETA: 0s - loss: 0.0338 - accuracy: 0.7690 7/11 [==================>...........] - ETA: 0s - loss: 0.0337 - accuracy: 0.7798 8/11 [====================>.........] - ETA: 0s - loss: 0.0337 - accuracy: 0.7891 9/11 [=======================>......] - ETA: 0s - loss: 0.0337 - accuracy: 0.796910/11 [==========================>...] - ETA: 0s - loss: 0.0338 - accuracy: 0.803011/11 [==============================] - ETA: 0s - loss: 0.0338 - accuracy: 0.807711/11 [==============================] - 2s 190ms/step - loss: 0.0338 - accuracy: 0.8117
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0292 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 1s - loss: 0.0294 - accuracy: 0.7812 3/11 [=======>......................] - ETA: 1s - loss: 0.0294 - accuracy: 0.7882 4/11 [=========>....................] - ETA: 1s - loss: 0.0297 - accuracy: 0.7928 5/11 [============>.................] - ETA: 0s - loss: 0.0299 - accuracy: 0.7967 6/11 [===============>..............] - ETA: 0s - loss: 0.0300 - accuracy: 0.8009 7/11 [==================>...........] - ETA: 0s - loss: 0.0303 - accuracy: 0.8049 8/11 [====================>.........] - ETA: 0s - loss: 0.0304 - accuracy: 0.8092 9/11 [=======================>......] - ETA: 0s - loss: 0.0305 - accuracy: 0.812910/11 [==========================>...] - ETA: 0s - loss: 0.0306 - accuracy: 0.816711/11 [==============================] - ETA: 0s - loss: 0.0307 - accuracy: 0.820111/11 [==============================] - 2s 195ms/step - loss: 0.0308 - accuracy: 0.8230
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0279 - accuracy: 0.8828 2/11 [====>.........................] - ETA: 1s - loss: 0.0282 - accuracy: 0.8730 3/11 [=======>......................] - ETA: 1s - loss: 0.0284 - accuracy: 0.8668 4/11 [=========>....................] - ETA: 1s - loss: 0.0287 - accuracy: 0.8625 5/11 [============>.................] - ETA: 1s - loss: 0.0288 - accuracy: 0.8615 6/11 [===============>..............] - ETA: 0s - loss: 0.0291 - accuracy: 0.8614 7/11 [==================>...........] - ETA: 0s - loss: 0.0292 - accuracy: 0.8611 8/11 [====================>.........] - ETA: 0s - loss: 0.0294 - accuracy: 0.8610 9/11 [=======================>......] - ETA: 0s - loss: 0.0294 - accuracy: 0.861510/11 [==========================>...] - ETA: 0s - loss: 0.0295 - accuracy: 0.862511/11 [==============================] - ETA: 0s - loss: 0.0295 - accuracy: 0.863511/11 [==============================] - 2s 182ms/step - loss: 0.0295 - accuracy: 0.8643
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.0226 - accuracy: 0.94533/6 [==============>...............] - ETA: 0s - loss: 0.0268 - accuracy: 0.8984 5/6 [========================>.....] - ETA: 0s - loss: 0.0282 - accuracy: 0.88286/6 [==============================] - 3s 32ms/step - loss: 0.0283 - accuracy: 0.8824
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 2 4 1 0] pred: [0.00418752 0.01820952 0.10911605 0.8424239  0.04298684]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [1.85948610e-03 1.01468146e-01 9.48653698e-01 1.67366564e-02
 7.37249851e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [7.9074502e-04 4.1840315e-02 9.8519051e-01 1.0998517e-02 4.8226118e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [7.8457594e-04 1.9104332e-02 9.7896016e-01 1.6309321e-02 4.2745471e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 0 4] pred: [1.0724664e-03 3.9850444e-02 9.6557367e-01 1.3564229e-02 5.8934093e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [8.0505013e-04 1.8146545e-02 9.8213303e-01 1.5219808e-02 3.8456917e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [0.02426803 0.94799507 0.7955556  0.00841343 0.00218713]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [7.9926848e-04 1.7365873e-02 9.8292631e-01 1.5357286e-02 3.7556887e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [8.1381202e-04 1.6899943e-02 9.8425758e-01 1.5186995e-02 3.5724044e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [2 1 3 0 4] pred: [1.3490617e-03 6.9761395e-02 9.5064247e-01 1.2690783e-02 7.7047944e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 1 3 0 4] pred: [8.0925226e-04 1.6845554e-02 9.8352379e-01 1.5414804e-02 3.6689639e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 1 0 3 4] pred: [0.00887865 0.5167906  0.9383049  0.00600737 0.00105637]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [3 4 2 0 1] pred: [0.18230411 0.14672995 0.25889218 0.55746853 0.5150026 ]
 Top predictions indices: [3] vs. real classes indices: [4]
Jaccard Score:  0.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 0 3 4] pred: [0.02303988 0.9324639  0.8284145  0.00818717 0.00200528]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [8.4283948e-04 1.7598927e-02 9.8348391e-01 1.3871908e-02 3.4922361e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 3 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_3 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:15 - loss: 0.2519 - accuracy: 0.0469 2/11 [====>.........................] - ETA: 1s - loss: 0.2514 - accuracy: 0.0703   3/11 [=======>......................] - ETA: 1s - loss: 0.2509 - accuracy: 0.1163 4/11 [=========>....................] - ETA: 1s - loss: 0.2504 - accuracy: 0.1536 5/11 [============>.................] - ETA: 1s - loss: 0.2499 - accuracy: 0.1854 6/11 [===============>..............] - ETA: 0s - loss: 0.2494 - accuracy: 0.2094 7/11 [==================>...........] - ETA: 0s - loss: 0.2488 - accuracy: 0.2312 8/11 [====================>.........] - ETA: 0s - loss: 0.2483 - accuracy: 0.2484 9/11 [=======================>......] - ETA: 0s - loss: 0.2478 - accuracy: 0.262410/11 [==========================>...] - ETA: 0s - loss: 0.2473 - accuracy: 0.274011/11 [==============================] - ETA: 0s - loss: 0.2468 - accuracy: 0.284011/11 [==============================] - 9s 188ms/step - loss: 0.2464 - accuracy: 0.2923
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2265 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 2s - loss: 0.2255 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 1s - loss: 0.2248 - accuracy: 0.4609 4/11 [=========>....................] - ETA: 1s - loss: 0.2238 - accuracy: 0.4590 5/11 [============>.................] - ETA: 1s - loss: 0.2229 - accuracy: 0.4581 6/11 [===============>..............] - ETA: 0s - loss: 0.2219 - accuracy: 0.4579 7/11 [==================>...........] - ETA: 0s - loss: 0.2209 - accuracy: 0.4584 8/11 [====================>.........] - ETA: 0s - loss: 0.2200 - accuracy: 0.4580 9/11 [=======================>......] - ETA: 0s - loss: 0.2189 - accuracy: 0.457310/11 [==========================>...] - ETA: 0s - loss: 0.2178 - accuracy: 0.457111/11 [==============================] - ETA: 0s - loss: 0.2167 - accuracy: 0.457111/11 [==============================] - 2s 185ms/step - loss: 0.2158 - accuracy: 0.4572
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1721 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 1s - loss: 0.1693 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 1s - loss: 0.1676 - accuracy: 0.4405 4/11 [=========>....................] - ETA: 1s - loss: 0.1654 - accuracy: 0.4432 5/11 [============>.................] - ETA: 0s - loss: 0.1631 - accuracy: 0.4449 6/11 [===============>..............] - ETA: 0s - loss: 0.1609 - accuracy: 0.4480 7/11 [==================>...........] - ETA: 0s - loss: 0.1588 - accuracy: 0.4500 8/11 [====================>.........] - ETA: 0s - loss: 0.1568 - accuracy: 0.4520 9/11 [=======================>......] - ETA: 0s - loss: 0.1549 - accuracy: 0.453410/11 [==========================>...] - ETA: 0s - loss: 0.1533 - accuracy: 0.454211/11 [==============================] - ETA: 0s - loss: 0.1519 - accuracy: 0.454511/11 [==============================] - 2s 161ms/step - loss: 0.1508 - accuracy: 0.4548
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1027 - accuracy: 0.5078 2/11 [====>.........................] - ETA: 2s - loss: 0.1120 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 2s - loss: 0.1160 - accuracy: 0.4648 4/11 [=========>....................] - ETA: 1s - loss: 0.1167 - accuracy: 0.4644 5/11 [============>.................] - ETA: 1s - loss: 0.1172 - accuracy: 0.4634 6/11 [===============>..............] - ETA: 1s - loss: 0.1175 - accuracy: 0.4636 7/11 [==================>...........] - ETA: 0s - loss: 0.1176 - accuracy: 0.4637 8/11 [====================>.........] - ETA: 0s - loss: 0.1179 - accuracy: 0.4624 9/11 [=======================>......] - ETA: 0s - loss: 0.1181 - accuracy: 0.461910/11 [==========================>...] - ETA: 0s - loss: 0.1181 - accuracy: 0.461411/11 [==============================] - ETA: 0s - loss: 0.1181 - accuracy: 0.461111/11 [==============================] - 2s 199ms/step - loss: 0.1181 - accuracy: 0.4608
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1101 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.1117 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 1s - loss: 0.1116 - accuracy: 0.4627 4/11 [=========>....................] - ETA: 1s - loss: 0.1112 - accuracy: 0.4632 5/11 [============>.................] - ETA: 0s - loss: 0.1103 - accuracy: 0.4665 6/11 [===============>..............] - ETA: 0s - loss: 0.1097 - accuracy: 0.4684 7/11 [==================>...........] - ETA: 0s - loss: 0.1093 - accuracy: 0.4702 8/11 [====================>.........] - ETA: 0s - loss: 0.1091 - accuracy: 0.4698 9/11 [=======================>......] - ETA: 0s - loss: 0.1091 - accuracy: 0.468110/11 [==========================>...] - ETA: 0s - loss: 0.1091 - accuracy: 0.466811/11 [==============================] - ETA: 0s - loss: 0.1091 - accuracy: 0.465911/11 [==============================] - 2s 169ms/step - loss: 0.1091 - accuracy: 0.4652
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0965 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.0965 - accuracy: 0.4824 3/11 [=======>......................] - ETA: 1s - loss: 0.0984 - accuracy: 0.4779 4/11 [=========>....................] - ETA: 1s - loss: 0.0997 - accuracy: 0.4712 5/11 [============>.................] - ETA: 1s - loss: 0.1008 - accuracy: 0.4632 6/11 [===============>..............] - ETA: 0s - loss: 0.1009 - accuracy: 0.4607 7/11 [==================>...........] - ETA: 0s - loss: 0.1011 - accuracy: 0.4581 8/11 [====================>.........] - ETA: 0s - loss: 0.1012 - accuracy: 0.4573 9/11 [=======================>......] - ETA: 0s - loss: 0.1012 - accuracy: 0.456910/11 [==========================>...] - ETA: 0s - loss: 0.1012 - accuracy: 0.457111/11 [==============================] - ETA: 0s - loss: 0.1011 - accuracy: 0.457311/11 [==============================] - 2s 187ms/step - loss: 0.1010 - accuracy: 0.4574
Epoch 7/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0951 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 1s - loss: 0.0958 - accuracy: 0.4121 3/11 [=======>......................] - ETA: 1s - loss: 0.0959 - accuracy: 0.4119 4/11 [=========>....................] - ETA: 1s - loss: 0.0951 - accuracy: 0.4198 5/11 [============>.................] - ETA: 1s - loss: 0.0947 - accuracy: 0.4277 6/11 [===============>..............] - ETA: 0s - loss: 0.0948 - accuracy: 0.4306 7/11 [==================>...........] - ETA: 0s - loss: 0.0947 - accuracy: 0.4340 8/11 [====================>.........] - ETA: 0s - loss: 0.0943 - accuracy: 0.4371 9/11 [=======================>......] - ETA: 0s - loss: 0.0939 - accuracy: 0.439910/11 [==========================>...] - ETA: 0s - loss: 0.0933 - accuracy: 0.442211/11 [==============================] - ETA: 0s - loss: 0.0929 - accuracy: 0.444111/11 [==============================] - 2s 188ms/step - loss: 0.0925 - accuracy: 0.4456
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0828 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 1s - loss: 0.0843 - accuracy: 0.4238 3/11 [=======>......................] - ETA: 1s - loss: 0.0848 - accuracy: 0.4310 4/11 [=========>....................] - ETA: 1s - loss: 0.0847 - accuracy: 0.4321 5/11 [============>.................] - ETA: 1s - loss: 0.0845 - accuracy: 0.4341 6/11 [===============>..............] - ETA: 0s - loss: 0.0842 - accuracy: 0.4347 7/11 [==================>...........] - ETA: 0s - loss: 0.0838 - accuracy: 0.4362 8/11 [====================>.........] - ETA: 0s - loss: 0.0833 - accuracy: 0.4385 9/11 [=======================>......] - ETA: 0s - loss: 0.0829 - accuracy: 0.440010/11 [==========================>...] - ETA: 0s - loss: 0.0824 - accuracy: 0.442411/11 [==============================] - ETA: 0s - loss: 0.0819 - accuracy: 0.445311/11 [==============================] - 2s 176ms/step - loss: 0.0815 - accuracy: 0.4477
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0652 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.0686 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 1s - loss: 0.0697 - accuracy: 0.4957 4/11 [=========>....................] - ETA: 1s - loss: 0.0699 - accuracy: 0.4933 5/11 [============>.................] - ETA: 1s - loss: 0.0695 - accuracy: 0.4928 6/11 [===============>..............] - ETA: 0s - loss: 0.0695 - accuracy: 0.4918 7/11 [==================>...........] - ETA: 0s - loss: 0.0694 - accuracy: 0.4931 8/11 [====================>.........] - ETA: 0s - loss: 0.0692 - accuracy: 0.4956 9/11 [=======================>......] - ETA: 0s - loss: 0.0690 - accuracy: 0.498410/11 [==========================>...] - ETA: 0s - loss: 0.0688 - accuracy: 0.501211/11 [==============================] - ETA: 0s - loss: 0.0687 - accuracy: 0.503911/11 [==============================] - 2s 172ms/step - loss: 0.0686 - accuracy: 0.5061
Epoch 10/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0621 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.0616 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 1s - loss: 0.0607 - accuracy: 0.5530 4/11 [=========>....................] - ETA: 1s - loss: 0.0602 - accuracy: 0.5607 5/11 [============>.................] - ETA: 0s - loss: 0.0599 - accuracy: 0.5714 6/11 [===============>..............] - ETA: 0s - loss: 0.0595 - accuracy: 0.5823 7/11 [==================>...........] - ETA: 0s - loss: 0.0590 - accuracy: 0.5919 8/11 [====================>.........] - ETA: 0s - loss: 0.0586 - accuracy: 0.5997 9/11 [=======================>......] - ETA: 0s - loss: 0.0585 - accuracy: 0.605310/11 [==========================>...] - ETA: 0s - loss: 0.0584 - accuracy: 0.610211/11 [==============================] - ETA: 0s - loss: 0.0583 - accuracy: 0.614911/11 [==============================] - 2s 155ms/step - loss: 0.0583 - accuracy: 0.6188
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0503 - accuracy: 0.6797 2/11 [====>.........................] - ETA: 1s - loss: 0.0537 - accuracy: 0.6621 3/11 [=======>......................] - ETA: 1s - loss: 0.0542 - accuracy: 0.6628 4/11 [=========>....................] - ETA: 1s - loss: 0.0540 - accuracy: 0.6626 5/11 [============>.................] - ETA: 0s - loss: 0.0539 - accuracy: 0.6651 6/11 [===============>..............] - ETA: 0s - loss: 0.0539 - accuracy: 0.6675 7/11 [==================>...........] - ETA: 0s - loss: 0.0538 - accuracy: 0.6702 8/11 [====================>.........] - ETA: 0s - loss: 0.0537 - accuracy: 0.6737 9/11 [=======================>......] - ETA: 0s - loss: 0.0535 - accuracy: 0.677410/11 [==========================>...] - ETA: 0s - loss: 0.0533 - accuracy: 0.680411/11 [==============================] - ETA: 0s - loss: 0.0531 - accuracy: 0.683111/11 [==============================] - 2s 158ms/step - loss: 0.0529 - accuracy: 0.6853
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0461 - accuracy: 0.7422 2/11 [====>.........................] - ETA: 1s - loss: 0.0471 - accuracy: 0.7480 3/11 [=======>......................] - ETA: 1s - loss: 0.0469 - accuracy: 0.7452 4/11 [=========>....................] - ETA: 1s - loss: 0.0466 - accuracy: 0.7474 5/11 [============>.................] - ETA: 1s - loss: 0.0463 - accuracy: 0.7479 6/11 [===============>..............] - ETA: 0s - loss: 0.0463 - accuracy: 0.7489 7/11 [==================>...........] - ETA: 0s - loss: 0.0463 - accuracy: 0.7513 8/11 [====================>.........] - ETA: 0s - loss: 0.0462 - accuracy: 0.7536 9/11 [=======================>......] - ETA: 0s - loss: 0.0462 - accuracy: 0.756310/11 [==========================>...] - ETA: 0s - loss: 0.0462 - accuracy: 0.758911/11 [==============================] - ETA: 0s - loss: 0.0462 - accuracy: 0.761411/11 [==============================] - 2s 172ms/step - loss: 0.0462 - accuracy: 0.7634
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0360 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 1s - loss: 0.0381 - accuracy: 0.7871 3/11 [=======>......................] - ETA: 1s - loss: 0.0394 - accuracy: 0.7895 4/11 [=========>....................] - ETA: 1s - loss: 0.0404 - accuracy: 0.7884 5/11 [============>.................] - ETA: 1s - loss: 0.0410 - accuracy: 0.7870 6/11 [===============>..............] - ETA: 0s - loss: 0.0413 - accuracy: 0.7884 7/11 [==================>...........] - ETA: 0s - loss: 0.0413 - accuracy: 0.7919 8/11 [====================>.........] - ETA: 0s - loss: 0.0414 - accuracy: 0.7943 9/11 [=======================>......] - ETA: 0s - loss: 0.0416 - accuracy: 0.796810/11 [==========================>...] - ETA: 0s - loss: 0.0416 - accuracy: 0.799411/11 [==============================] - ETA: 0s - loss: 0.0417 - accuracy: 0.801811/11 [==============================] - 2s 154ms/step - loss: 0.0418 - accuracy: 0.8038
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0389 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 1s - loss: 0.0394 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 1s - loss: 0.0401 - accuracy: 0.8090 4/11 [=========>....................] - ETA: 1s - loss: 0.0402 - accuracy: 0.8089 5/11 [============>.................] - ETA: 0s - loss: 0.0404 - accuracy: 0.8074 6/11 [===============>..............] - ETA: 0s - loss: 0.0404 - accuracy: 0.8081 7/11 [==================>...........] - ETA: 0s - loss: 0.0404 - accuracy: 0.8106 8/11 [====================>.........] - ETA: 0s - loss: 0.0403 - accuracy: 0.8138 9/11 [=======================>......] - ETA: 0s - loss: 0.0401 - accuracy: 0.817510/11 [==========================>...] - ETA: 0s - loss: 0.0401 - accuracy: 0.820211/11 [==============================] - ETA: 0s - loss: 0.0400 - accuracy: 0.822811/11 [==============================] - 2s 166ms/step - loss: 0.0400 - accuracy: 0.8249
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0364 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 1s - loss: 0.0351 - accuracy: 0.8145 3/11 [=======>......................] - ETA: 1s - loss: 0.0349 - accuracy: 0.8112 4/11 [=========>....................] - ETA: 1s - loss: 0.0349 - accuracy: 0.8145 5/11 [============>.................] - ETA: 1s - loss: 0.0348 - accuracy: 0.8172 6/11 [===============>..............] - ETA: 0s - loss: 0.0348 - accuracy: 0.8205 7/11 [==================>...........] - ETA: 0s - loss: 0.0351 - accuracy: 0.8229 8/11 [====================>.........] - ETA: 0s - loss: 0.0352 - accuracy: 0.8254 9/11 [=======================>......] - ETA: 0s - loss: 0.0352 - accuracy: 0.827710/11 [==========================>...] - ETA: 0s - loss: 0.0353 - accuracy: 0.830211/11 [==============================] - ETA: 0s - loss: 0.0354 - accuracy: 0.832211/11 [==============================] - 2s 182ms/step - loss: 0.0355 - accuracy: 0.8339
Epoch 16/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0351 - accuracy: 0.8906 2/11 [====>.........................] - ETA: 1s - loss: 0.0338 - accuracy: 0.8848 3/11 [=======>......................] - ETA: 1s - loss: 0.0338 - accuracy: 0.8806 4/11 [=========>....................] - ETA: 1s - loss: 0.0338 - accuracy: 0.8729 5/11 [============>.................] - ETA: 1s - loss: 0.0338 - accuracy: 0.8667 6/11 [===============>..............] - ETA: 0s - loss: 0.0339 - accuracy: 0.8620 7/11 [==================>...........] - ETA: 0s - loss: 0.0340 - accuracy: 0.8572 8/11 [====================>.........] - ETA: 0s - loss: 0.0341 - accuracy: 0.8537 9/11 [=======================>......] - ETA: 0s - loss: 0.0342 - accuracy: 0.851010/11 [==========================>...] - ETA: 0s - loss: 0.0342 - accuracy: 0.849511/11 [==============================] - ETA: 0s - loss: 0.0342 - accuracy: 0.848311/11 [==============================] - 2s 167ms/step - loss: 0.0342 - accuracy: 0.8472
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0345 - accuracy: 0.9141 2/11 [====>.........................] - ETA: 1s - loss: 0.0341 - accuracy: 0.9043 3/11 [=======>......................] - ETA: 1s - loss: 0.0346 - accuracy: 0.9023 4/11 [=========>....................] - ETA: 1s - loss: 0.0347 - accuracy: 0.9014 5/11 [============>.................] - ETA: 1s - loss: 0.0348 - accuracy: 0.9002 6/11 [===============>..............] - ETA: 0s - loss: 0.0347 - accuracy: 0.8986 7/11 [==================>...........] - ETA: 0s - loss: 0.0346 - accuracy: 0.8976 8/11 [====================>.........] - ETA: 0s - loss: 0.0343 - accuracy: 0.8961 9/11 [=======================>......] - ETA: 0s - loss: 0.0341 - accuracy: 0.893610/11 [==========================>...] - ETA: 0s - loss: 0.0340 - accuracy: 0.890811/11 [==============================] - ETA: 0s - loss: 0.0338 - accuracy: 0.888011/11 [==============================] - 2s 177ms/step - loss: 0.0337 - accuracy: 0.8857
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0340 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 1s - loss: 0.0349 - accuracy: 0.7891 3/11 [=======>......................] - ETA: 1s - loss: 0.0338 - accuracy: 0.8064 4/11 [=========>....................] - ETA: 0s - loss: 0.0331 - accuracy: 0.8192 5/11 [============>.................] - ETA: 0s - loss: 0.0328 - accuracy: 0.8275 6/11 [===============>..............] - ETA: 0s - loss: 0.0326 - accuracy: 0.8357 7/11 [==================>...........] - ETA: 0s - loss: 0.0325 - accuracy: 0.8410 8/11 [====================>.........] - ETA: 0s - loss: 0.0323 - accuracy: 0.8452 9/11 [=======================>......] - ETA: 0s - loss: 0.0322 - accuracy: 0.848810/11 [==========================>...] - ETA: 0s - loss: 0.0321 - accuracy: 0.852111/11 [==============================] - ETA: 0s - loss: 0.0320 - accuracy: 0.854811/11 [==============================] - 2s 165ms/step - loss: 0.0319 - accuracy: 0.8570
Epoch 19/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0281 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 1s - loss: 0.0283 - accuracy: 0.8633 3/11 [=======>......................] - ETA: 1s - loss: 0.0287 - accuracy: 0.8524 4/11 [=========>....................] - ETA: 1s - loss: 0.0288 - accuracy: 0.8434 5/11 [============>.................] - ETA: 1s - loss: 0.0290 - accuracy: 0.8351 6/11 [===============>..............] - ETA: 0s - loss: 0.0289 - accuracy: 0.8298 7/11 [==================>...........] - ETA: 0s - loss: 0.0289 - accuracy: 0.8265 8/11 [====================>.........] - ETA: 0s - loss: 0.0289 - accuracy: 0.8255 9/11 [=======================>......] - ETA: 0s - loss: 0.0290 - accuracy: 0.825310/11 [==========================>...] - ETA: 0s - loss: 0.0290 - accuracy: 0.826111/11 [==============================] - ETA: 0s - loss: 0.0291 - accuracy: 0.827111/11 [==============================] - 2s 166ms/step - loss: 0.0292 - accuracy: 0.8279
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0290 - accuracy: 0.9453 2/11 [====>.........................] - ETA: 1s - loss: 0.0296 - accuracy: 0.9316 3/11 [=======>......................] - ETA: 1s - loss: 0.0291 - accuracy: 0.9301 4/11 [=========>....................] - ETA: 1s - loss: 0.0290 - accuracy: 0.9290 5/11 [============>.................] - ETA: 1s - loss: 0.0288 - accuracy: 0.9292 6/11 [===============>..............] - ETA: 0s - loss: 0.0287 - accuracy: 0.9299 7/11 [==================>...........] - ETA: 0s - loss: 0.0286 - accuracy: 0.9294 8/11 [====================>.........] - ETA: 0s - loss: 0.0286 - accuracy: 0.9275 9/11 [=======================>......] - ETA: 0s - loss: 0.0286 - accuracy: 0.925210/11 [==========================>...] - ETA: 0s - loss: 0.0286 - accuracy: 0.922211/11 [==============================] - ETA: 0s - loss: 0.0286 - accuracy: 0.918911/11 [==============================] - 2s 177ms/step - loss: 0.0287 - accuracy: 0.9162
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.0341 - accuracy: 0.85943/6 [==============>...............] - ETA: 0s - loss: 0.0332 - accuracy: 0.8620 5/6 [========================>.....] - ETA: 0s - loss: 0.0350 - accuracy: 0.84536/6 [==============================] - 3s 33ms/step - loss: 0.0352 - accuracy: 0.8414
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 4 0] pred: [0.00113919 0.6182879  0.9591262  0.00656381 0.00236407]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 4 0] pred: [3.3292174e-04 3.5022676e-02 9.8020929e-01 1.7566979e-02 2.3924708e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [0 1 2 3 4] pred: [0.62726724 0.3547499  0.21421191 0.20466569 0.11513701]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [0.00148767 0.6317146  0.95270157 0.01069975 0.00135848]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [3.9598346e-04 3.8898200e-02 9.7698522e-01 1.8713206e-02 2.8079748e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 4 0] pred: [3.5226345e-04 3.4658700e-02 9.7433680e-01 2.0037144e-02 2.3348331e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [3 4 2 0 1] pred: [0.01209676 0.01189369 0.09604836 0.8342327  0.1448107 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 4 0] pred: [2.2974610e-04 1.5400559e-02 9.7320431e-01 3.5465658e-02 2.9929876e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [0.00148147 0.09417668 0.943621   0.04236904 0.00212502]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [3 2 4 0 1] pred: [0.01613346 0.01296762 0.09334105 0.8287145  0.09235093]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 3 0 4] pred: [0.00641233 0.931431   0.90440243 0.01157299 0.00213948]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 1 4 0] pred: [2.4017692e-04 1.6607523e-02 9.7149915e-01 3.6650300e-02 3.0946136e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.05205289 0.686217   0.36204445 0.02282006 0.00852972]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 3 0 4] pred: [0.00708386 0.92056715 0.8812489  0.01217744 0.00223798]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 4 0] pred: [3.3923984e-04 3.5161287e-02 9.8031116e-01 1.7499894e-02 2.3924410e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 4 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_4 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:15 - loss: 0.2487 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.2482 - accuracy: 0.4980   3/11 [=======>......................] - ETA: 1s - loss: 0.2476 - accuracy: 0.4978 4/11 [=========>....................] - ETA: 1s - loss: 0.2471 - accuracy: 0.4930 5/11 [============>.................] - ETA: 0s - loss: 0.2466 - accuracy: 0.4891 6/11 [===============>..............] - ETA: 0s - loss: 0.2460 - accuracy: 0.4861 7/11 [==================>...........] - ETA: 0s - loss: 0.2454 - accuracy: 0.4859 8/11 [====================>.........] - ETA: 0s - loss: 0.2448 - accuracy: 0.4854 9/11 [=======================>......] - ETA: 0s - loss: 0.2442 - accuracy: 0.484810/11 [==========================>...] - ETA: 0s - loss: 0.2436 - accuracy: 0.483311/11 [==============================] - ETA: 0s - loss: 0.2430 - accuracy: 0.481611/11 [==============================] - 9s 153ms/step - loss: 0.2425 - accuracy: 0.4801
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2186 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.2173 - accuracy: 0.4512 3/11 [=======>......................] - ETA: 1s - loss: 0.2163 - accuracy: 0.4510 4/11 [=========>....................] - ETA: 1s - loss: 0.2154 - accuracy: 0.4491 5/11 [============>.................] - ETA: 1s - loss: 0.2143 - accuracy: 0.4499 6/11 [===============>..............] - ETA: 0s - loss: 0.2132 - accuracy: 0.4502 7/11 [==================>...........] - ETA: 0s - loss: 0.2122 - accuracy: 0.4500 8/11 [====================>.........] - ETA: 0s - loss: 0.2110 - accuracy: 0.4495 9/11 [=======================>......] - ETA: 0s - loss: 0.2096 - accuracy: 0.450510/11 [==========================>...] - ETA: 0s - loss: 0.2081 - accuracy: 0.451111/11 [==============================] - ETA: 0s - loss: 0.2068 - accuracy: 0.451511/11 [==============================] - 2s 173ms/step - loss: 0.2056 - accuracy: 0.4518
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1509 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.1499 - accuracy: 0.4492 3/11 [=======>......................] - ETA: 1s - loss: 0.1486 - accuracy: 0.4444 4/11 [=========>....................] - ETA: 1s - loss: 0.1474 - accuracy: 0.4432 5/11 [============>.................] - ETA: 0s - loss: 0.1463 - accuracy: 0.4424 6/11 [===============>..............] - ETA: 0s - loss: 0.1452 - accuracy: 0.4424 7/11 [==================>...........] - ETA: 0s - loss: 0.1438 - accuracy: 0.4428 8/11 [====================>.........] - ETA: 0s - loss: 0.1426 - accuracy: 0.4436 9/11 [=======================>......] - ETA: 0s - loss: 0.1415 - accuracy: 0.444310/11 [==========================>...] - ETA: 0s - loss: 0.1403 - accuracy: 0.445311/11 [==============================] - ETA: 0s - loss: 0.1393 - accuracy: 0.446211/11 [==============================] - 2s 154ms/step - loss: 0.1385 - accuracy: 0.4470
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1239 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 2s - loss: 0.1199 - accuracy: 0.4434 3/11 [=======>......................] - ETA: 1s - loss: 0.1192 - accuracy: 0.4466 4/11 [=========>....................] - ETA: 1s - loss: 0.1190 - accuracy: 0.4473 5/11 [============>.................] - ETA: 1s - loss: 0.1177 - accuracy: 0.4519 6/11 [===============>..............] - ETA: 1s - loss: 0.1168 - accuracy: 0.4579 7/11 [==================>...........] - ETA: 0s - loss: 0.1166 - accuracy: 0.4600 8/11 [====================>.........] - ETA: 0s - loss: 0.1164 - accuracy: 0.4602 9/11 [=======================>......] - ETA: 0s - loss: 0.1164 - accuracy: 0.459410/11 [==========================>...] - ETA: 0s - loss: 0.1163 - accuracy: 0.458911/11 [==============================] - ETA: 0s - loss: 0.1163 - accuracy: 0.458611/11 [==============================] - 2s 199ms/step - loss: 0.1162 - accuracy: 0.4584
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1051 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.1060 - accuracy: 0.4434 3/11 [=======>......................] - ETA: 1s - loss: 0.1053 - accuracy: 0.4518 4/11 [=========>....................] - ETA: 1s - loss: 0.1051 - accuracy: 0.4585 5/11 [============>.................] - ETA: 0s - loss: 0.1051 - accuracy: 0.4621 6/11 [===============>..............] - ETA: 0s - loss: 0.1056 - accuracy: 0.4628 7/11 [==================>...........] - ETA: 0s - loss: 0.1060 - accuracy: 0.4640 8/11 [====================>.........] - ETA: 0s - loss: 0.1064 - accuracy: 0.4635 9/11 [=======================>......] - ETA: 0s - loss: 0.1068 - accuracy: 0.462910/11 [==========================>...] - ETA: 0s - loss: 0.1072 - accuracy: 0.462211/11 [==============================] - ETA: 0s - loss: 0.1075 - accuracy: 0.461611/11 [==============================] - 2s 180ms/step - loss: 0.1078 - accuracy: 0.4611
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1010 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 2s - loss: 0.1044 - accuracy: 0.4473 3/11 [=======>......................] - ETA: 2s - loss: 0.1041 - accuracy: 0.4510 4/11 [=========>....................] - ETA: 1s - loss: 0.1031 - accuracy: 0.4564 5/11 [============>.................] - ETA: 1s - loss: 0.1024 - accuracy: 0.4595 6/11 [===============>..............] - ETA: 1s - loss: 0.1023 - accuracy: 0.4593 7/11 [==================>...........] - ETA: 0s - loss: 0.1021 - accuracy: 0.4594 8/11 [====================>.........] - ETA: 0s - loss: 0.1019 - accuracy: 0.4596 9/11 [=======================>......] - ETA: 0s - loss: 0.1019 - accuracy: 0.459010/11 [==========================>...] - ETA: 0s - loss: 0.1021 - accuracy: 0.458411/11 [==============================] - ETA: 0s - loss: 0.1021 - accuracy: 0.458511/11 [==============================] - 2s 217ms/step - loss: 0.1022 - accuracy: 0.4586
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0942 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.0926 - accuracy: 0.4902 3/11 [=======>......................] - ETA: 1s - loss: 0.0916 - accuracy: 0.4952 4/11 [=========>....................] - ETA: 1s - loss: 0.0912 - accuracy: 0.4969 5/11 [============>.................] - ETA: 1s - loss: 0.0911 - accuracy: 0.4966 6/11 [===============>..............] - ETA: 0s - loss: 0.0910 - accuracy: 0.4950 7/11 [==================>...........] - ETA: 0s - loss: 0.0911 - accuracy: 0.4939 8/11 [====================>.........] - ETA: 0s - loss: 0.0913 - accuracy: 0.4926 9/11 [=======================>......] - ETA: 0s - loss: 0.0915 - accuracy: 0.491310/11 [==========================>...] - ETA: 0s - loss: 0.0916 - accuracy: 0.490511/11 [==============================] - ETA: 0s - loss: 0.0916 - accuracy: 0.489911/11 [==============================] - 2s 175ms/step - loss: 0.0917 - accuracy: 0.4895
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0902 - accuracy: 0.5391 2/11 [====>.........................] - ETA: 1s - loss: 0.0870 - accuracy: 0.5430 3/11 [=======>......................] - ETA: 1s - loss: 0.0856 - accuracy: 0.5382 4/11 [=========>....................] - ETA: 1s - loss: 0.0844 - accuracy: 0.5355 5/11 [============>.................] - ETA: 1s - loss: 0.0842 - accuracy: 0.5299 6/11 [===============>..............] - ETA: 1s - loss: 0.0840 - accuracy: 0.5239 7/11 [==================>...........] - ETA: 0s - loss: 0.0838 - accuracy: 0.5201 8/11 [====================>.........] - ETA: 0s - loss: 0.0837 - accuracy: 0.5175 9/11 [=======================>......] - ETA: 0s - loss: 0.0835 - accuracy: 0.516610/11 [==========================>...] - ETA: 0s - loss: 0.0833 - accuracy: 0.516711/11 [==============================] - ETA: 0s - loss: 0.0831 - accuracy: 0.516711/11 [==============================] - 2s 190ms/step - loss: 0.0830 - accuracy: 0.5167
Epoch 9/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0706 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.0717 - accuracy: 0.5391 3/11 [=======>......................] - ETA: 1s - loss: 0.0730 - accuracy: 0.5564 4/11 [=========>....................] - ETA: 1s - loss: 0.0741 - accuracy: 0.5672 5/11 [============>.................] - ETA: 1s - loss: 0.0747 - accuracy: 0.5753 6/11 [===============>..............] - ETA: 0s - loss: 0.0747 - accuracy: 0.5843 7/11 [==================>...........] - ETA: 0s - loss: 0.0748 - accuracy: 0.5907 8/11 [====================>.........] - ETA: 0s - loss: 0.0749 - accuracy: 0.5950 9/11 [=======================>......] - ETA: 0s - loss: 0.0751 - accuracy: 0.597410/11 [==========================>...] - ETA: 0s - loss: 0.0752 - accuracy: 0.599911/11 [==============================] - ETA: 0s - loss: 0.0750 - accuracy: 0.603111/11 [==============================] - 2s 168ms/step - loss: 0.0749 - accuracy: 0.6058
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0725 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 1s - loss: 0.0728 - accuracy: 0.7500 3/11 [=======>......................] - ETA: 1s - loss: 0.0718 - accuracy: 0.7526 4/11 [=========>....................] - ETA: 1s - loss: 0.0714 - accuracy: 0.7524 5/11 [============>.................] - ETA: 0s - loss: 0.0706 - accuracy: 0.7535 6/11 [===============>..............] - ETA: 0s - loss: 0.0703 - accuracy: 0.7514 7/11 [==================>...........] - ETA: 0s - loss: 0.0700 - accuracy: 0.7493 8/11 [====================>.........] - ETA: 0s - loss: 0.0698 - accuracy: 0.7476 9/11 [=======================>......] - ETA: 0s - loss: 0.0696 - accuracy: 0.745410/11 [==========================>...] - ETA: 0s - loss: 0.0694 - accuracy: 0.744011/11 [==============================] - ETA: 0s - loss: 0.0692 - accuracy: 0.743111/11 [==============================] - 2s 149ms/step - loss: 0.0690 - accuracy: 0.7424
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0650 - accuracy: 0.7266 2/11 [====>.........................] - ETA: 1s - loss: 0.0644 - accuracy: 0.7363 3/11 [=======>......................] - ETA: 1s - loss: 0.0630 - accuracy: 0.7435 4/11 [=========>....................] - ETA: 1s - loss: 0.0620 - accuracy: 0.7412 5/11 [============>.................] - ETA: 1s - loss: 0.0611 - accuracy: 0.7408 6/11 [===============>..............] - ETA: 0s - loss: 0.0607 - accuracy: 0.7388 7/11 [==================>...........] - ETA: 0s - loss: 0.0607 - accuracy: 0.7380 8/11 [====================>.........] - ETA: 0s - loss: 0.0606 - accuracy: 0.7378 9/11 [=======================>......] - ETA: 0s - loss: 0.0605 - accuracy: 0.737910/11 [==========================>...] - ETA: 0s - loss: 0.0604 - accuracy: 0.738111/11 [==============================] - ETA: 0s - loss: 0.0604 - accuracy: 0.738111/11 [==============================] - 2s 187ms/step - loss: 0.0604 - accuracy: 0.7382
Epoch 12/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0517 - accuracy: 0.7500 2/11 [====>.........................] - ETA: 1s - loss: 0.0536 - accuracy: 0.7598 3/11 [=======>......................] - ETA: 1s - loss: 0.0551 - accuracy: 0.7635 4/11 [=========>....................] - ETA: 1s - loss: 0.0553 - accuracy: 0.7664 5/11 [============>.................] - ETA: 0s - loss: 0.0556 - accuracy: 0.7688 6/11 [===============>..............] - ETA: 0s - loss: 0.0558 - accuracy: 0.7709 7/11 [==================>...........] - ETA: 0s - loss: 0.0558 - accuracy: 0.7735 8/11 [====================>.........] - ETA: 0s - loss: 0.0558 - accuracy: 0.7753 9/11 [=======================>......] - ETA: 0s - loss: 0.0557 - accuracy: 0.776610/11 [==========================>...] - ETA: 0s - loss: 0.0555 - accuracy: 0.777711/11 [==============================] - ETA: 0s - loss: 0.0554 - accuracy: 0.779011/11 [==============================] - 2s 175ms/step - loss: 0.0553 - accuracy: 0.7802
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0563 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 1s - loss: 0.0549 - accuracy: 0.8066 3/11 [=======>......................] - ETA: 1s - loss: 0.0546 - accuracy: 0.8043 4/11 [=========>....................] - ETA: 1s - loss: 0.0544 - accuracy: 0.8024 5/11 [============>.................] - ETA: 0s - loss: 0.0541 - accuracy: 0.8010 6/11 [===============>..............] - ETA: 0s - loss: 0.0539 - accuracy: 0.8016 7/11 [==================>...........] - ETA: 0s - loss: 0.0537 - accuracy: 0.7997 8/11 [====================>.........] - ETA: 0s - loss: 0.0534 - accuracy: 0.7977 9/11 [=======================>......] - ETA: 0s - loss: 0.0531 - accuracy: 0.796210/11 [==========================>...] - ETA: 0s - loss: 0.0528 - accuracy: 0.795611/11 [==============================] - ETA: 0s - loss: 0.0525 - accuracy: 0.795711/11 [==============================] - 2s 184ms/step - loss: 0.0523 - accuracy: 0.7957
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0498 - accuracy: 0.8203 2/11 [====>.........................] - ETA: 1s - loss: 0.0506 - accuracy: 0.8203 3/11 [=======>......................] - ETA: 1s - loss: 0.0491 - accuracy: 0.8238 4/11 [=========>....................] - ETA: 1s - loss: 0.0483 - accuracy: 0.8288 5/11 [============>.................] - ETA: 1s - loss: 0.0478 - accuracy: 0.8318 6/11 [===============>..............] - ETA: 0s - loss: 0.0475 - accuracy: 0.8309 7/11 [==================>...........] - ETA: 0s - loss: 0.0473 - accuracy: 0.8274 8/11 [====================>.........] - ETA: 0s - loss: 0.0470 - accuracy: 0.8238 9/11 [=======================>......] - ETA: 0s - loss: 0.0468 - accuracy: 0.820510/11 [==========================>...] - ETA: 0s - loss: 0.0467 - accuracy: 0.818111/11 [==============================] - ETA: 0s - loss: 0.0466 - accuracy: 0.816511/11 [==============================] - 2s 173ms/step - loss: 0.0465 - accuracy: 0.8151
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0483 - accuracy: 0.9297 2/11 [====>.........................] - ETA: 1s - loss: 0.0468 - accuracy: 0.9121 3/11 [=======>......................] - ETA: 1s - loss: 0.0468 - accuracy: 0.9076 4/11 [=========>....................] - ETA: 1s - loss: 0.0465 - accuracy: 0.9038 5/11 [============>.................] - ETA: 0s - loss: 0.0464 - accuracy: 0.8993 6/11 [===============>..............] - ETA: 0s - loss: 0.0462 - accuracy: 0.8955 7/11 [==================>...........] - ETA: 0s - loss: 0.0464 - accuracy: 0.8922 8/11 [====================>.........] - ETA: 0s - loss: 0.0465 - accuracy: 0.8891 9/11 [=======================>......] - ETA: 0s - loss: 0.0464 - accuracy: 0.884810/11 [==========================>...] - ETA: 0s - loss: 0.0464 - accuracy: 0.880011/11 [==============================] - ETA: 0s - loss: 0.0463 - accuracy: 0.874411/11 [==============================] - 2s 170ms/step - loss: 0.0463 - accuracy: 0.8698
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0417 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 1s - loss: 0.0425 - accuracy: 0.6699 3/11 [=======>......................] - ETA: 1s - loss: 0.0431 - accuracy: 0.6662 4/11 [=========>....................] - ETA: 1s - loss: 0.0434 - accuracy: 0.6657 5/11 [============>.................] - ETA: 0s - loss: 0.0437 - accuracy: 0.6604 6/11 [===============>..............] - ETA: 0s - loss: 0.0438 - accuracy: 0.6586 7/11 [==================>...........] - ETA: 0s - loss: 0.0438 - accuracy: 0.6594 8/11 [====================>.........] - ETA: 0s - loss: 0.0437 - accuracy: 0.6609 9/11 [=======================>......] - ETA: 0s - loss: 0.0437 - accuracy: 0.664310/11 [==========================>...] - ETA: 0s - loss: 0.0436 - accuracy: 0.668611/11 [==============================] - ETA: 0s - loss: 0.0435 - accuracy: 0.672911/11 [==============================] - 2s 165ms/step - loss: 0.0435 - accuracy: 0.6765
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0432 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 1s - loss: 0.0423 - accuracy: 0.8691 3/11 [=======>......................] - ETA: 1s - loss: 0.0414 - accuracy: 0.8746 4/11 [=========>....................] - ETA: 1s - loss: 0.0409 - accuracy: 0.8761 5/11 [============>.................] - ETA: 0s - loss: 0.0405 - accuracy: 0.8765 6/11 [===============>..............] - ETA: 0s - loss: 0.0403 - accuracy: 0.8767 7/11 [==================>...........] - ETA: 0s - loss: 0.0401 - accuracy: 0.8763 8/11 [====================>.........] - ETA: 0s - loss: 0.0399 - accuracy: 0.8747 9/11 [=======================>......] - ETA: 0s - loss: 0.0399 - accuracy: 0.871910/11 [==========================>...] - ETA: 0s - loss: 0.0398 - accuracy: 0.869011/11 [==============================] - ETA: 0s - loss: 0.0398 - accuracy: 0.866011/11 [==============================] - 2s 149ms/step - loss: 0.0397 - accuracy: 0.8636
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0372 - accuracy: 0.7500 2/11 [====>.........................] - ETA: 2s - loss: 0.0376 - accuracy: 0.7695 3/11 [=======>......................] - ETA: 1s - loss: 0.0369 - accuracy: 0.7873 4/11 [=========>....................] - ETA: 1s - loss: 0.0363 - accuracy: 0.7970 5/11 [============>.................] - ETA: 1s - loss: 0.0362 - accuracy: 0.8048 6/11 [===============>..............] - ETA: 0s - loss: 0.0361 - accuracy: 0.8104 7/11 [==================>...........] - ETA: 0s - loss: 0.0360 - accuracy: 0.8158 8/11 [====================>.........] - ETA: 0s - loss: 0.0359 - accuracy: 0.8205 9/11 [=======================>......] - ETA: 0s - loss: 0.0359 - accuracy: 0.824310/11 [==========================>...] - ETA: 0s - loss: 0.0358 - accuracy: 0.827211/11 [==============================] - ETA: 0s - loss: 0.0358 - accuracy: 0.829511/11 [==============================] - 2s 184ms/step - loss: 0.0359 - accuracy: 0.8315
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0383 - accuracy: 0.8672 2/11 [====>.........................] - ETA: 1s - loss: 0.0393 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 1s - loss: 0.0395 - accuracy: 0.8707 4/11 [=========>....................] - ETA: 0s - loss: 0.0388 - accuracy: 0.8747 5/11 [============>.................] - ETA: 0s - loss: 0.0385 - accuracy: 0.8757 6/11 [===============>..............] - ETA: 0s - loss: 0.0377 - accuracy: 0.8777 7/11 [==================>...........] - ETA: 0s - loss: 0.0371 - accuracy: 0.8789 8/11 [====================>.........] - ETA: 0s - loss: 0.0366 - accuracy: 0.8804 9/11 [=======================>......] - ETA: 0s - loss: 0.0363 - accuracy: 0.881710/11 [==========================>...] - ETA: 0s - loss: 0.0360 - accuracy: 0.882511/11 [==============================] - ETA: 0s - loss: 0.0358 - accuracy: 0.882911/11 [==============================] - 2s 144ms/step - loss: 0.0356 - accuracy: 0.8833
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0267 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 1s - loss: 0.0292 - accuracy: 0.8613 3/11 [=======>......................] - ETA: 1s - loss: 0.0301 - accuracy: 0.8607 4/11 [=========>....................] - ETA: 1s - loss: 0.0309 - accuracy: 0.8555 5/11 [============>.................] - ETA: 1s - loss: 0.0312 - accuracy: 0.8538 6/11 [===============>..............] - ETA: 0s - loss: 0.0313 - accuracy: 0.8538 7/11 [==================>...........] - ETA: 0s - loss: 0.0314 - accuracy: 0.8554 8/11 [====================>.........] - ETA: 0s - loss: 0.0316 - accuracy: 0.8576 9/11 [=======================>......] - ETA: 0s - loss: 0.0318 - accuracy: 0.860210/11 [==========================>...] - ETA: 0s - loss: 0.0319 - accuracy: 0.862711/11 [==============================] - ETA: 0s - loss: 0.0320 - accuracy: 0.865011/11 [==============================] - 2s 164ms/step - loss: 0.0321 - accuracy: 0.8670
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.0313 - accuracy: 0.87503/6 [==============>...............] - ETA: 0s - loss: 0.0302 - accuracy: 0.9115 5/6 [========================>.....] - ETA: 0s - loss: 0.0316 - accuracy: 0.89696/6 [==============================] - 3s 37ms/step - loss: 0.0314 - accuracy: 0.8938
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 0 4] pred: [0.00497219 0.04084617 0.89235824 0.18028635 0.00357926]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [4 3 0 2 1] pred: [0.09324977 0.02517185 0.05804569 0.64769447 0.7843685 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [4 3 0 2 1] pred: [0.11775368 0.0342724  0.07744715 0.6388737  0.7881248 ]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [0.00166428 0.10397217 0.96703994 0.02109334 0.00144163]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 3 4 0] pred: [6.6125393e-04 2.9437155e-02 9.8584068e-01 2.6140213e-02 2.0860136e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.01592559 0.9223244  0.8831394  0.00488433 0.00099283]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 4 0] pred: [7.3337555e-04 3.3651084e-02 9.8286521e-01 2.7060509e-02 2.0507276e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 3 1 4 0] pred: [6.5687299e-04 2.6774675e-02 9.7983569e-01 3.3752799e-02 2.0774603e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 0 4] pred: [3.3097863e-03 2.7056944e-01 9.0283555e-01 4.1200489e-02 8.3640218e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [4 3 0 2 1] pred: [0.293748   0.19195452 0.27256054 0.5519326  0.68445265]
 Top predictions indices: [4] vs. real classes indices: [4]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 4 0] pred: [6.62624836e-04 1.28189325e-02 9.24632668e-01 9.13220644e-02
 4.57534194e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 0 2 1] pred: [0.06659016 0.01144433 0.04308212 0.79579806 0.2891243 ]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.01533446 0.9167602  0.8316128  0.00656065 0.00092271]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 4 0] pred: [8.2805753e-04 4.2856455e-02 9.7980684e-01 3.2335550e-02 1.7195344e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [3 2 1 0 4] pred: [0.27271405 0.2845499  0.31951493 0.32219672 0.18063638]
 Top predictions indices: [3] vs. real classes indices: [0]
Jaccard Score:  0.0
 
Generating classification report
Generating confusion matrix
Exécution 5 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_5 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:14 - loss: 0.2495 - accuracy: 0.3516 2/11 [====>.........................] - ETA: 1s - loss: 0.2490 - accuracy: 0.3906   3/11 [=======>......................] - ETA: 1s - loss: 0.2485 - accuracy: 0.3993 4/11 [=========>....................] - ETA: 1s - loss: 0.2480 - accuracy: 0.4103 5/11 [============>.................] - ETA: 0s - loss: 0.2476 - accuracy: 0.4167 6/11 [===============>..............] - ETA: 0s - loss: 0.2471 - accuracy: 0.4219 7/11 [==================>...........] - ETA: 0s - loss: 0.2466 - accuracy: 0.4254 8/11 [====================>.........] - ETA: 0s - loss: 0.2461 - accuracy: 0.4270 9/11 [=======================>......] - ETA: 0s - loss: 0.2456 - accuracy: 0.429010/11 [==========================>...] - ETA: 0s - loss: 0.2450 - accuracy: 0.431211/11 [==============================] - ETA: 0s - loss: 0.2445 - accuracy: 0.433011/11 [==============================] - 9s 139ms/step - loss: 0.2441 - accuracy: 0.4346
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2260 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 1s - loss: 0.2241 - accuracy: 0.4297 3/11 [=======>......................] - ETA: 1s - loss: 0.2228 - accuracy: 0.4401 4/11 [=========>....................] - ETA: 1s - loss: 0.2217 - accuracy: 0.4434 5/11 [============>.................] - ETA: 0s - loss: 0.2205 - accuracy: 0.4459 6/11 [===============>..............] - ETA: 0s - loss: 0.2194 - accuracy: 0.4474 7/11 [==================>...........] - ETA: 0s - loss: 0.2182 - accuracy: 0.4474 8/11 [====================>.........] - ETA: 0s - loss: 0.2170 - accuracy: 0.4472 9/11 [=======================>......] - ETA: 0s - loss: 0.2157 - accuracy: 0.448010/11 [==========================>...] - ETA: 0s - loss: 0.2144 - accuracy: 0.448911/11 [==============================] - ETA: 0s - loss: 0.2131 - accuracy: 0.449811/11 [==============================] - 2s 152ms/step - loss: 0.2120 - accuracy: 0.4506
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1619 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.1587 - accuracy: 0.4551 3/11 [=======>......................] - ETA: 1s - loss: 0.1564 - accuracy: 0.4666 4/11 [=========>....................] - ETA: 1s - loss: 0.1544 - accuracy: 0.4691 5/11 [============>.................] - ETA: 1s - loss: 0.1530 - accuracy: 0.4656 6/11 [===============>..............] - ETA: 0s - loss: 0.1515 - accuracy: 0.4622 7/11 [==================>...........] - ETA: 0s - loss: 0.1500 - accuracy: 0.4611 8/11 [====================>.........] - ETA: 0s - loss: 0.1485 - accuracy: 0.4604 9/11 [=======================>......] - ETA: 0s - loss: 0.1472 - accuracy: 0.459410/11 [==========================>...] - ETA: 0s - loss: 0.1461 - accuracy: 0.459011/11 [==============================] - ETA: 0s - loss: 0.1449 - accuracy: 0.459011/11 [==============================] - 2s 180ms/step - loss: 0.1439 - accuracy: 0.4590
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1084 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.1115 - accuracy: 0.5039 3/11 [=======>......................] - ETA: 1s - loss: 0.1146 - accuracy: 0.4896 4/11 [=========>....................] - ETA: 1s - loss: 0.1157 - accuracy: 0.4829 5/11 [============>.................] - ETA: 0s - loss: 0.1165 - accuracy: 0.4763 6/11 [===============>..............] - ETA: 0s - loss: 0.1167 - accuracy: 0.4725 7/11 [==================>...........] - ETA: 0s - loss: 0.1168 - accuracy: 0.4694 8/11 [====================>.........] - ETA: 0s - loss: 0.1170 - accuracy: 0.4669 9/11 [=======================>......] - ETA: 0s - loss: 0.1167 - accuracy: 0.466710/11 [==========================>...] - ETA: 0s - loss: 0.1165 - accuracy: 0.466611/11 [==============================] - ETA: 0s - loss: 0.1165 - accuracy: 0.465911/11 [==============================] - 2s 165ms/step - loss: 0.1165 - accuracy: 0.4653
Epoch 5/20
 1/11 [=>............................] - ETA: 2s - loss: 0.1153 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.1148 - accuracy: 0.4707 3/11 [=======>......................] - ETA: 1s - loss: 0.1154 - accuracy: 0.4622 4/11 [=========>....................] - ETA: 1s - loss: 0.1163 - accuracy: 0.4585 5/11 [============>.................] - ETA: 0s - loss: 0.1160 - accuracy: 0.4584 6/11 [===============>..............] - ETA: 0s - loss: 0.1158 - accuracy: 0.4577 7/11 [==================>...........] - ETA: 0s - loss: 0.1156 - accuracy: 0.4570 8/11 [====================>.........] - ETA: 0s - loss: 0.1152 - accuracy: 0.4566 9/11 [=======================>......] - ETA: 0s - loss: 0.1149 - accuracy: 0.456110/11 [==========================>...] - ETA: 0s - loss: 0.1146 - accuracy: 0.455911/11 [==============================] - ETA: 0s - loss: 0.1143 - accuracy: 0.456211/11 [==============================] - 2s 150ms/step - loss: 0.1140 - accuracy: 0.4564
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1042 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.1056 - accuracy: 0.4570 3/11 [=======>......................] - ETA: 1s - loss: 0.1077 - accuracy: 0.4497 4/11 [=========>....................] - ETA: 1s - loss: 0.1084 - accuracy: 0.4466 5/11 [============>.................] - ETA: 0s - loss: 0.1087 - accuracy: 0.4470 6/11 [===============>..............] - ETA: 0s - loss: 0.1087 - accuracy: 0.4482 7/11 [==================>...........] - ETA: 0s - loss: 0.1086 - accuracy: 0.4497 8/11 [====================>.........] - ETA: 0s - loss: 0.1083 - accuracy: 0.4508 9/11 [=======================>......] - ETA: 0s - loss: 0.1080 - accuracy: 0.451910/11 [==========================>...] - ETA: 0s - loss: 0.1077 - accuracy: 0.452611/11 [==============================] - ETA: 0s - loss: 0.1075 - accuracy: 0.453111/11 [==============================] - 2s 157ms/step - loss: 0.1073 - accuracy: 0.4536
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1013 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 2s - loss: 0.1024 - accuracy: 0.4609 3/11 [=======>......................] - ETA: 1s - loss: 0.1026 - accuracy: 0.4557 4/11 [=========>....................] - ETA: 1s - loss: 0.1027 - accuracy: 0.4565 5/11 [============>.................] - ETA: 1s - loss: 0.1024 - accuracy: 0.4609 6/11 [===============>..............] - ETA: 0s - loss: 0.1018 - accuracy: 0.4637 7/11 [==================>...........] - ETA: 0s - loss: 0.1013 - accuracy: 0.4659 8/11 [====================>.........] - ETA: 0s - loss: 0.1010 - accuracy: 0.4667 9/11 [=======================>......] - ETA: 0s - loss: 0.1007 - accuracy: 0.466410/11 [==========================>...] - ETA: 0s - loss: 0.1003 - accuracy: 0.466311/11 [==============================] - ETA: 0s - loss: 0.0999 - accuracy: 0.465911/11 [==============================] - 2s 174ms/step - loss: 0.0996 - accuracy: 0.4656
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0843 - accuracy: 0.4609 2/11 [====>.........................] - ETA: 2s - loss: 0.0879 - accuracy: 0.4473 3/11 [=======>......................] - ETA: 1s - loss: 0.0881 - accuracy: 0.4466 4/11 [=========>....................] - ETA: 1s - loss: 0.0877 - accuracy: 0.4443 5/11 [============>.................] - ETA: 1s - loss: 0.0872 - accuracy: 0.4464 6/11 [===============>..............] - ETA: 0s - loss: 0.0868 - accuracy: 0.4473 7/11 [==================>...........] - ETA: 0s - loss: 0.0864 - accuracy: 0.4493 8/11 [====================>.........] - ETA: 0s - loss: 0.0861 - accuracy: 0.4514 9/11 [=======================>......] - ETA: 0s - loss: 0.0859 - accuracy: 0.452310/11 [==========================>...] - ETA: 0s - loss: 0.0856 - accuracy: 0.453411/11 [==============================] - ETA: 0s - loss: 0.0854 - accuracy: 0.454511/11 [==============================] - 2s 171ms/step - loss: 0.0852 - accuracy: 0.4554
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0726 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.0729 - accuracy: 0.4277 3/11 [=======>......................] - ETA: 1s - loss: 0.0743 - accuracy: 0.4327 4/11 [=========>....................] - ETA: 1s - loss: 0.0747 - accuracy: 0.4412 5/11 [============>.................] - ETA: 0s - loss: 0.0744 - accuracy: 0.4539 6/11 [===============>..............] - ETA: 0s - loss: 0.0744 - accuracy: 0.4646 7/11 [==================>...........] - ETA: 0s - loss: 0.0742 - accuracy: 0.4756 8/11 [====================>.........] - ETA: 0s - loss: 0.0742 - accuracy: 0.4846 9/11 [=======================>......] - ETA: 0s - loss: 0.0742 - accuracy: 0.493510/11 [==========================>...] - ETA: 0s - loss: 0.0740 - accuracy: 0.501211/11 [==============================] - ETA: 0s - loss: 0.0739 - accuracy: 0.507811/11 [==============================] - 2s 158ms/step - loss: 0.0737 - accuracy: 0.5134
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0680 - accuracy: 0.5781 2/11 [====>.........................] - ETA: 1s - loss: 0.0664 - accuracy: 0.5898 3/11 [=======>......................] - ETA: 1s - loss: 0.0656 - accuracy: 0.5894 4/11 [=========>....................] - ETA: 1s - loss: 0.0661 - accuracy: 0.5832 5/11 [============>.................] - ETA: 1s - loss: 0.0659 - accuracy: 0.5784 6/11 [===============>..............] - ETA: 0s - loss: 0.0660 - accuracy: 0.5751 7/11 [==================>...........] - ETA: 0s - loss: 0.0659 - accuracy: 0.5744 8/11 [====================>.........] - ETA: 0s - loss: 0.0659 - accuracy: 0.5746 9/11 [=======================>......] - ETA: 0s - loss: 0.0657 - accuracy: 0.576110/11 [==========================>...] - ETA: 0s - loss: 0.0656 - accuracy: 0.577911/11 [==============================] - ETA: 0s - loss: 0.0654 - accuracy: 0.580311/11 [==============================] - 2s 177ms/step - loss: 0.0653 - accuracy: 0.5823
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0597 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 1s - loss: 0.0609 - accuracy: 0.7227 3/11 [=======>......................] - ETA: 1s - loss: 0.0616 - accuracy: 0.7196 4/11 [=========>....................] - ETA: 1s - loss: 0.0617 - accuracy: 0.7174 5/11 [============>.................] - ETA: 0s - loss: 0.0618 - accuracy: 0.7140 6/11 [===============>..............] - ETA: 0s - loss: 0.0615 - accuracy: 0.7098 7/11 [==================>...........] - ETA: 0s - loss: 0.0614 - accuracy: 0.7063 8/11 [====================>.........] - ETA: 0s - loss: 0.0611 - accuracy: 0.7028 9/11 [=======================>......] - ETA: 0s - loss: 0.0609 - accuracy: 0.698710/11 [==========================>...] - ETA: 0s - loss: 0.0605 - accuracy: 0.695211/11 [==============================] - ETA: 0s - loss: 0.0602 - accuracy: 0.692411/11 [==============================] - 2s 184ms/step - loss: 0.0599 - accuracy: 0.6901
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0614 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 1s - loss: 0.0595 - accuracy: 0.6504 3/11 [=======>......................] - ETA: 1s - loss: 0.0579 - accuracy: 0.6662 4/11 [=========>....................] - ETA: 1s - loss: 0.0568 - accuracy: 0.6808 5/11 [============>.................] - ETA: 1s - loss: 0.0561 - accuracy: 0.6928 6/11 [===============>..............] - ETA: 0s - loss: 0.0555 - accuracy: 0.7015 7/11 [==================>...........] - ETA: 0s - loss: 0.0548 - accuracy: 0.7087 8/11 [====================>.........] - ETA: 0s - loss: 0.0543 - accuracy: 0.7146 9/11 [=======================>......] - ETA: 0s - loss: 0.0538 - accuracy: 0.718910/11 [==========================>...] - ETA: 0s - loss: 0.0533 - accuracy: 0.721611/11 [==============================] - ETA: 0s - loss: 0.0531 - accuracy: 0.723511/11 [==============================] - 2s 178ms/step - loss: 0.0529 - accuracy: 0.7250
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0509 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 1s - loss: 0.0517 - accuracy: 0.7012 3/11 [=======>......................] - ETA: 1s - loss: 0.0507 - accuracy: 0.7053 4/11 [=========>....................] - ETA: 1s - loss: 0.0499 - accuracy: 0.7091 5/11 [============>.................] - ETA: 1s - loss: 0.0492 - accuracy: 0.7129 6/11 [===============>..............] - ETA: 0s - loss: 0.0486 - accuracy: 0.7161 7/11 [==================>...........] - ETA: 0s - loss: 0.0482 - accuracy: 0.7181 8/11 [====================>.........] - ETA: 0s - loss: 0.0480 - accuracy: 0.7211 9/11 [=======================>......] - ETA: 0s - loss: 0.0478 - accuracy: 0.725010/11 [==========================>...] - ETA: 0s - loss: 0.0476 - accuracy: 0.728911/11 [==============================] - ETA: 0s - loss: 0.0475 - accuracy: 0.732711/11 [==============================] - 2s 169ms/step - loss: 0.0474 - accuracy: 0.7359
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0471 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 1s - loss: 0.0433 - accuracy: 0.8477 3/11 [=======>......................] - ETA: 1s - loss: 0.0420 - accuracy: 0.8490 4/11 [=========>....................] - ETA: 0s - loss: 0.0426 - accuracy: 0.8408 5/11 [============>.................] - ETA: 0s - loss: 0.0427 - accuracy: 0.8336 6/11 [===============>..............] - ETA: 0s - loss: 0.0427 - accuracy: 0.8240 7/11 [==================>...........] - ETA: 0s - loss: 0.0425 - accuracy: 0.8185 8/11 [====================>.........] - ETA: 0s - loss: 0.0424 - accuracy: 0.8127 9/11 [=======================>......] - ETA: 0s - loss: 0.0424 - accuracy: 0.807610/11 [==========================>...] - ETA: 0s - loss: 0.0423 - accuracy: 0.803711/11 [==============================] - ETA: 0s - loss: 0.0422 - accuracy: 0.800811/11 [==============================] - 2s 173ms/step - loss: 0.0422 - accuracy: 0.7984
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0298 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 1s - loss: 0.0321 - accuracy: 0.8672 3/11 [=======>......................] - ETA: 1s - loss: 0.0334 - accuracy: 0.8568 4/11 [=========>....................] - ETA: 1s - loss: 0.0344 - accuracy: 0.8516 5/11 [============>.................] - ETA: 1s - loss: 0.0351 - accuracy: 0.8494 6/11 [===============>..............] - ETA: 0s - loss: 0.0356 - accuracy: 0.8482 7/11 [==================>...........] - ETA: 0s - loss: 0.0358 - accuracy: 0.8487 8/11 [====================>.........] - ETA: 0s - loss: 0.0360 - accuracy: 0.8488 9/11 [=======================>......] - ETA: 0s - loss: 0.0362 - accuracy: 0.848310/11 [==========================>...] - ETA: 0s - loss: 0.0364 - accuracy: 0.847011/11 [==============================] - ETA: 0s - loss: 0.0366 - accuracy: 0.845111/11 [==============================] - 2s 168ms/step - loss: 0.0367 - accuracy: 0.8434
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0385 - accuracy: 0.6953 2/11 [====>.........................] - ETA: 1s - loss: 0.0375 - accuracy: 0.7090 3/11 [=======>......................] - ETA: 1s - loss: 0.0367 - accuracy: 0.7157 4/11 [=========>....................] - ETA: 1s - loss: 0.0362 - accuracy: 0.7165 5/11 [============>.................] - ETA: 1s - loss: 0.0360 - accuracy: 0.7166 6/11 [===============>..............] - ETA: 0s - loss: 0.0360 - accuracy: 0.7189 7/11 [==================>...........] - ETA: 0s - loss: 0.0360 - accuracy: 0.7230 8/11 [====================>.........] - ETA: 0s - loss: 0.0361 - accuracy: 0.7273 9/11 [=======================>......] - ETA: 0s - loss: 0.0360 - accuracy: 0.732110/11 [==========================>...] - ETA: 0s - loss: 0.0361 - accuracy: 0.736811/11 [==============================] - ETA: 0s - loss: 0.0361 - accuracy: 0.741011/11 [==============================] - 2s 162ms/step - loss: 0.0360 - accuracy: 0.7445
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0300 - accuracy: 0.8906 2/11 [====>.........................] - ETA: 1s - loss: 0.0316 - accuracy: 0.8652 3/11 [=======>......................] - ETA: 1s - loss: 0.0326 - accuracy: 0.8537 4/11 [=========>....................] - ETA: 1s - loss: 0.0325 - accuracy: 0.8488 5/11 [============>.................] - ETA: 0s - loss: 0.0328 - accuracy: 0.8422 6/11 [===============>..............] - ETA: 0s - loss: 0.0329 - accuracy: 0.8370 7/11 [==================>...........] - ETA: 0s - loss: 0.0329 - accuracy: 0.8314 8/11 [====================>.........] - ETA: 0s - loss: 0.0328 - accuracy: 0.8271 9/11 [=======================>......] - ETA: 0s - loss: 0.0328 - accuracy: 0.823210/11 [==========================>...] - ETA: 0s - loss: 0.0329 - accuracy: 0.820411/11 [==============================] - ETA: 0s - loss: 0.0329 - accuracy: 0.818211/11 [==============================] - 2s 170ms/step - loss: 0.0329 - accuracy: 0.8165
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0314 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 1s - loss: 0.0319 - accuracy: 0.7969 3/11 [=======>......................] - ETA: 1s - loss: 0.0312 - accuracy: 0.8090 4/11 [=========>....................] - ETA: 1s - loss: 0.0309 - accuracy: 0.8172 5/11 [============>.................] - ETA: 1s - loss: 0.0308 - accuracy: 0.8185 6/11 [===============>..............] - ETA: 0s - loss: 0.0310 - accuracy: 0.8181 7/11 [==================>...........] - ETA: 0s - loss: 0.0311 - accuracy: 0.8172 8/11 [====================>.........] - ETA: 0s - loss: 0.0311 - accuracy: 0.8169 9/11 [=======================>......] - ETA: 0s - loss: 0.0311 - accuracy: 0.816410/11 [==========================>...] - ETA: 0s - loss: 0.0311 - accuracy: 0.815311/11 [==============================] - ETA: 0s - loss: 0.0311 - accuracy: 0.814911/11 [==============================] - 2s 173ms/step - loss: 0.0311 - accuracy: 0.8146
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0301 - accuracy: 0.8359 2/11 [====>.........................] - ETA: 1s - loss: 0.0303 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 1s - loss: 0.0304 - accuracy: 0.8490 4/11 [=========>....................] - ETA: 1s - loss: 0.0305 - accuracy: 0.8540 5/11 [============>.................] - ETA: 0s - loss: 0.0306 - accuracy: 0.8560 6/11 [===============>..............] - ETA: 0s - loss: 0.0304 - accuracy: 0.8577 7/11 [==================>...........] - ETA: 0s - loss: 0.0303 - accuracy: 0.8571 8/11 [====================>.........] - ETA: 0s - loss: 0.0303 - accuracy: 0.8556 9/11 [=======================>......] - ETA: 0s - loss: 0.0302 - accuracy: 0.853110/11 [==========================>...] - ETA: 0s - loss: 0.0301 - accuracy: 0.850411/11 [==============================] - ETA: 0s - loss: 0.0300 - accuracy: 0.848111/11 [==============================] - 2s 164ms/step - loss: 0.0300 - accuracy: 0.8462
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0284 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 1s - loss: 0.0296 - accuracy: 0.8125 3/11 [=======>......................] - ETA: 1s - loss: 0.0299 - accuracy: 0.8212 4/11 [=========>....................] - ETA: 1s - loss: 0.0300 - accuracy: 0.8293 5/11 [============>.................] - ETA: 0s - loss: 0.0302 - accuracy: 0.8375 6/11 [===============>..............] - ETA: 0s - loss: 0.0301 - accuracy: 0.8431 7/11 [==================>...........] - ETA: 0s - loss: 0.0300 - accuracy: 0.8465 8/11 [====================>.........] - ETA: 0s - loss: 0.0299 - accuracy: 0.8481 9/11 [=======================>......] - ETA: 0s - loss: 0.0297 - accuracy: 0.848010/11 [==========================>...] - ETA: 0s - loss: 0.0296 - accuracy: 0.847111/11 [==============================] - ETA: 0s - loss: 0.0295 - accuracy: 0.846211/11 [==============================] - 2s 156ms/step - loss: 0.0294 - accuracy: 0.8455
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.0355 - accuracy: 0.88283/6 [==============>...............] - ETA: 0s - loss: 0.0314 - accuracy: 0.8854 5/6 [========================>.....] - ETA: 0s - loss: 0.0322 - accuracy: 0.88136/6 [==============================] - 3s 29ms/step - loss: 0.0320 - accuracy: 0.8853
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [1 2 0 3 4] pred: [0.22057793 0.6964345  0.31280994 0.08359998 0.01918393]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [1 2 0 3 4] pred: [0.02642253 0.85211635 0.7302913  0.01232579 0.00116402]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [1 2 0 3 4] pred: [0.01927057 0.9089104  0.68099725 0.00921041 0.00135267]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [1 2 0 3 4] pred: [0.02529562 0.8946575  0.75436044 0.00847119 0.00114518]
 Top predictions indices: [1] vs. real classes indices: [2]
Jaccard Score:  0.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [0.02788436 0.90518785 0.6040748  0.01020974 0.00164735]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [1 2 0 3 4] pred: [0.03404251 0.8892237  0.5299834  0.01316437 0.00229555]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 0 3 4] pred: [1.7313689e-02 8.7464541e-01 9.1520643e-01 5.3247511e-03 6.9713593e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 3 0 4] pred: [0.03330642 0.3954244  0.6935221  0.14155465 0.02572376]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [1 0 2 3 4] pred: [0.22368336 0.73170835 0.20215839 0.02463159 0.01394251]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [0.01820645 0.9361297  0.6983193  0.00849846 0.00153381]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [0.01947221 0.8838038  0.7970501  0.00893268 0.00102636]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [2 3 1 0 4] pred: [0.00274637 0.02094036 0.961559   0.03942752 0.00204206]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.02091321 0.80013984 0.7460852  0.01389128 0.00116467]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 0 1 4] pred: [0.00691012 0.00377122 0.9603585  0.0431053  0.00220042]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [1 2 0 3 4] pred: [0.03686342 0.9207597  0.6870135  0.00768644 0.00147668]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 6 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_6 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:15 - loss: 0.2507 - accuracy: 0.5000 2/11 [====>.........................] - ETA: 1s - loss: 0.2502 - accuracy: 0.5469   3/11 [=======>......................] - ETA: 1s - loss: 0.2497 - accuracy: 0.5616 4/11 [=========>....................] - ETA: 1s - loss: 0.2492 - accuracy: 0.5658 5/11 [============>.................] - ETA: 1s - loss: 0.2487 - accuracy: 0.5617 6/11 [===============>..............] - ETA: 0s - loss: 0.2481 - accuracy: 0.5575 7/11 [==================>...........] - ETA: 0s - loss: 0.2476 - accuracy: 0.5534 8/11 [====================>.........] - ETA: 0s - loss: 0.2470 - accuracy: 0.5494 9/11 [=======================>......] - ETA: 0s - loss: 0.2465 - accuracy: 0.545210/11 [==========================>...] - ETA: 0s - loss: 0.2459 - accuracy: 0.540711/11 [==============================] - ETA: 0s - loss: 0.2453 - accuracy: 0.536711/11 [==============================] - 9s 187ms/step - loss: 0.2449 - accuracy: 0.5334
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2243 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 1s - loss: 0.2226 - accuracy: 0.4316 3/11 [=======>......................] - ETA: 1s - loss: 0.2215 - accuracy: 0.4353 4/11 [=========>....................] - ETA: 1s - loss: 0.2206 - accuracy: 0.4320 5/11 [============>.................] - ETA: 0s - loss: 0.2197 - accuracy: 0.4309 6/11 [===============>..............] - ETA: 0s - loss: 0.2185 - accuracy: 0.4337 7/11 [==================>...........] - ETA: 0s - loss: 0.2173 - accuracy: 0.4365 8/11 [====================>.........] - ETA: 0s - loss: 0.2161 - accuracy: 0.4391 9/11 [=======================>......] - ETA: 0s - loss: 0.2148 - accuracy: 0.441410/11 [==========================>...] - ETA: 0s - loss: 0.2135 - accuracy: 0.442811/11 [==============================] - ETA: 0s - loss: 0.2122 - accuracy: 0.444311/11 [==============================] - 2s 180ms/step - loss: 0.2111 - accuracy: 0.4455
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1558 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.1567 - accuracy: 0.5000 3/11 [=======>......................] - ETA: 1s - loss: 0.1558 - accuracy: 0.4861 4/11 [=========>....................] - ETA: 1s - loss: 0.1546 - accuracy: 0.4749 5/11 [============>.................] - ETA: 0s - loss: 0.1533 - accuracy: 0.4678 6/11 [===============>..............] - ETA: 0s - loss: 0.1517 - accuracy: 0.4651 7/11 [==================>...........] - ETA: 0s - loss: 0.1502 - accuracy: 0.4634 8/11 [====================>.........] - ETA: 0s - loss: 0.1487 - accuracy: 0.4627 9/11 [=======================>......] - ETA: 0s - loss: 0.1473 - accuracy: 0.461810/11 [==========================>...] - ETA: 0s - loss: 0.1460 - accuracy: 0.461111/11 [==============================] - ETA: 0s - loss: 0.1448 - accuracy: 0.460911/11 [==============================] - 2s 163ms/step - loss: 0.1438 - accuracy: 0.4608
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1121 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.1120 - accuracy: 0.4746 3/11 [=======>......................] - ETA: 1s - loss: 0.1120 - accuracy: 0.4770 4/11 [=========>....................] - ETA: 1s - loss: 0.1125 - accuracy: 0.4754 5/11 [============>.................] - ETA: 0s - loss: 0.1129 - accuracy: 0.4735 6/11 [===============>..............] - ETA: 0s - loss: 0.1132 - accuracy: 0.4718 7/11 [==================>...........] - ETA: 0s - loss: 0.1136 - accuracy: 0.4701 8/11 [====================>.........] - ETA: 0s - loss: 0.1138 - accuracy: 0.4692 9/11 [=======================>......] - ETA: 0s - loss: 0.1139 - accuracy: 0.467710/11 [==========================>...] - ETA: 0s - loss: 0.1141 - accuracy: 0.466611/11 [==============================] - ETA: 0s - loss: 0.1142 - accuracy: 0.465911/11 [==============================] - 2s 146ms/step - loss: 0.1143 - accuracy: 0.4653
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1335 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 1s - loss: 0.1280 - accuracy: 0.4219 3/11 [=======>......................] - ETA: 1s - loss: 0.1250 - accuracy: 0.4314 4/11 [=========>....................] - ETA: 1s - loss: 0.1216 - accuracy: 0.4432 5/11 [============>.................] - ETA: 0s - loss: 0.1194 - accuracy: 0.4483 6/11 [===============>..............] - ETA: 0s - loss: 0.1178 - accuracy: 0.4513 7/11 [==================>...........] - ETA: 0s - loss: 0.1165 - accuracy: 0.4533 8/11 [====================>.........] - ETA: 0s - loss: 0.1154 - accuracy: 0.4556 9/11 [=======================>......] - ETA: 0s - loss: 0.1148 - accuracy: 0.457310/11 [==========================>...] - ETA: 0s - loss: 0.1143 - accuracy: 0.458011/11 [==============================] - ETA: 0s - loss: 0.1139 - accuracy: 0.458111/11 [==============================] - 2s 171ms/step - loss: 0.1136 - accuracy: 0.4582
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1087 - accuracy: 0.4219 2/11 [====>.........................] - ETA: 1s - loss: 0.1069 - accuracy: 0.4375 3/11 [=======>......................] - ETA: 1s - loss: 0.1057 - accuracy: 0.4479 4/11 [=========>....................] - ETA: 1s - loss: 0.1054 - accuracy: 0.4487 5/11 [============>.................] - ETA: 0s - loss: 0.1057 - accuracy: 0.4455 6/11 [===============>..............] - ETA: 0s - loss: 0.1058 - accuracy: 0.4446 7/11 [==================>...........] - ETA: 0s - loss: 0.1059 - accuracy: 0.4441 8/11 [====================>.........] - ETA: 0s - loss: 0.1057 - accuracy: 0.4442 9/11 [=======================>......] - ETA: 0s - loss: 0.1056 - accuracy: 0.444410/11 [==========================>...] - ETA: 0s - loss: 0.1054 - accuracy: 0.445511/11 [==============================] - ETA: 0s - loss: 0.1052 - accuracy: 0.447011/11 [==============================] - 2s 164ms/step - loss: 0.1050 - accuracy: 0.4482
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0987 - accuracy: 0.4531 2/11 [====>.........................] - ETA: 1s - loss: 0.0963 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 1s - loss: 0.0954 - accuracy: 0.4818 4/11 [=========>....................] - ETA: 1s - loss: 0.0943 - accuracy: 0.4849 5/11 [============>.................] - ETA: 1s - loss: 0.0934 - accuracy: 0.4895 6/11 [===============>..............] - ETA: 0s - loss: 0.0926 - accuracy: 0.4936 7/11 [==================>...........] - ETA: 0s - loss: 0.0921 - accuracy: 0.4958 8/11 [====================>.........] - ETA: 0s - loss: 0.0919 - accuracy: 0.4968 9/11 [=======================>......] - ETA: 0s - loss: 0.0917 - accuracy: 0.496710/11 [==========================>...] - ETA: 0s - loss: 0.0917 - accuracy: 0.495411/11 [==============================] - ETA: 0s - loss: 0.0917 - accuracy: 0.494611/11 [==============================] - 2s 166ms/step - loss: 0.0917 - accuracy: 0.4939
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0932 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.0905 - accuracy: 0.5293 3/11 [=======>......................] - ETA: 1s - loss: 0.0884 - accuracy: 0.5456 4/11 [=========>....................] - ETA: 1s - loss: 0.0871 - accuracy: 0.5547 5/11 [============>.................] - ETA: 0s - loss: 0.0863 - accuracy: 0.5609 6/11 [===============>..............] - ETA: 0s - loss: 0.0858 - accuracy: 0.5638 7/11 [==================>...........] - ETA: 0s - loss: 0.0858 - accuracy: 0.5651 8/11 [====================>.........] - ETA: 0s - loss: 0.0856 - accuracy: 0.5656 9/11 [=======================>......] - ETA: 0s - loss: 0.0852 - accuracy: 0.565610/11 [==========================>...] - ETA: 0s - loss: 0.0848 - accuracy: 0.565611/11 [==============================] - ETA: 0s - loss: 0.0845 - accuracy: 0.565211/11 [==============================] - 2s 166ms/step - loss: 0.0843 - accuracy: 0.5649
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0670 - accuracy: 0.6406 2/11 [====>.........................] - ETA: 1s - loss: 0.0698 - accuracy: 0.6172 3/11 [=======>......................] - ETA: 1s - loss: 0.0714 - accuracy: 0.6189 4/11 [=========>....................] - ETA: 1s - loss: 0.0720 - accuracy: 0.6268 5/11 [============>.................] - ETA: 1s - loss: 0.0723 - accuracy: 0.6311 6/11 [===============>..............] - ETA: 0s - loss: 0.0728 - accuracy: 0.6329 7/11 [==================>...........] - ETA: 0s - loss: 0.0730 - accuracy: 0.6350 8/11 [====================>.........] - ETA: 0s - loss: 0.0732 - accuracy: 0.6381 9/11 [=======================>......] - ETA: 0s - loss: 0.0734 - accuracy: 0.641010/11 [==========================>...] - ETA: 0s - loss: 0.0734 - accuracy: 0.643311/11 [==============================] - ETA: 0s - loss: 0.0734 - accuracy: 0.645611/11 [==============================] - 2s 171ms/step - loss: 0.0734 - accuracy: 0.6474
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0683 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 1s - loss: 0.0670 - accuracy: 0.6504 3/11 [=======>......................] - ETA: 1s - loss: 0.0668 - accuracy: 0.6506 4/11 [=========>....................] - ETA: 1s - loss: 0.0672 - accuracy: 0.6510 5/11 [============>.................] - ETA: 1s - loss: 0.0676 - accuracy: 0.6493 6/11 [===============>..............] - ETA: 0s - loss: 0.0678 - accuracy: 0.6457 7/11 [==================>...........] - ETA: 0s - loss: 0.0676 - accuracy: 0.6441 8/11 [====================>.........] - ETA: 0s - loss: 0.0675 - accuracy: 0.6439 9/11 [=======================>......] - ETA: 0s - loss: 0.0674 - accuracy: 0.644010/11 [==========================>...] - ETA: 0s - loss: 0.0673 - accuracy: 0.645111/11 [==============================] - ETA: 0s - loss: 0.0672 - accuracy: 0.646611/11 [==============================] - 2s 167ms/step - loss: 0.0672 - accuracy: 0.6479
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0547 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 1s - loss: 0.0580 - accuracy: 0.7852 3/11 [=======>......................] - ETA: 1s - loss: 0.0590 - accuracy: 0.7778 4/11 [=========>....................] - ETA: 1s - loss: 0.0597 - accuracy: 0.7733 5/11 [============>.................] - ETA: 0s - loss: 0.0597 - accuracy: 0.7689 6/11 [===============>..............] - ETA: 0s - loss: 0.0596 - accuracy: 0.7647 7/11 [==================>...........] - ETA: 0s - loss: 0.0597 - accuracy: 0.7602 8/11 [====================>.........] - ETA: 0s - loss: 0.0597 - accuracy: 0.7554 9/11 [=======================>......] - ETA: 0s - loss: 0.0597 - accuracy: 0.751710/11 [==========================>...] - ETA: 0s - loss: 0.0597 - accuracy: 0.748511/11 [==============================] - ETA: 0s - loss: 0.0598 - accuracy: 0.746211/11 [==============================] - 2s 162ms/step - loss: 0.0598 - accuracy: 0.7444
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0579 - accuracy: 0.7656 2/11 [====>.........................] - ETA: 1s - loss: 0.0574 - accuracy: 0.7773 3/11 [=======>......................] - ETA: 1s - loss: 0.0585 - accuracy: 0.7821 4/11 [=========>....................] - ETA: 1s - loss: 0.0586 - accuracy: 0.7868 5/11 [============>.................] - ETA: 1s - loss: 0.0586 - accuracy: 0.7891 6/11 [===============>..............] - ETA: 0s - loss: 0.0585 - accuracy: 0.7898 7/11 [==================>...........] - ETA: 0s - loss: 0.0583 - accuracy: 0.7893 8/11 [====================>.........] - ETA: 0s - loss: 0.0579 - accuracy: 0.7880 9/11 [=======================>......] - ETA: 0s - loss: 0.0576 - accuracy: 0.786410/11 [==========================>...] - ETA: 0s - loss: 0.0572 - accuracy: 0.784311/11 [==============================] - ETA: 0s - loss: 0.0570 - accuracy: 0.782211/11 [==============================] - 2s 176ms/step - loss: 0.0567 - accuracy: 0.7805
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0442 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 1s - loss: 0.0441 - accuracy: 0.7422 3/11 [=======>......................] - ETA: 1s - loss: 0.0446 - accuracy: 0.7413 4/11 [=========>....................] - ETA: 1s - loss: 0.0449 - accuracy: 0.7410 5/11 [============>.................] - ETA: 1s - loss: 0.0452 - accuracy: 0.7447 6/11 [===============>..............] - ETA: 0s - loss: 0.0454 - accuracy: 0.7497 7/11 [==================>...........] - ETA: 0s - loss: 0.0458 - accuracy: 0.7544 8/11 [====================>.........] - ETA: 0s - loss: 0.0461 - accuracy: 0.7587 9/11 [=======================>......] - ETA: 0s - loss: 0.0464 - accuracy: 0.762210/11 [==========================>...] - ETA: 0s - loss: 0.0466 - accuracy: 0.765811/11 [==============================] - ETA: 0s - loss: 0.0467 - accuracy: 0.768611/11 [==============================] - 2s 183ms/step - loss: 0.0469 - accuracy: 0.7709
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0445 - accuracy: 0.6641 2/11 [====>.........................] - ETA: 1s - loss: 0.0447 - accuracy: 0.6680 3/11 [=======>......................] - ETA: 1s - loss: 0.0446 - accuracy: 0.6684 4/11 [=========>....................] - ETA: 1s - loss: 0.0441 - accuracy: 0.6751 5/11 [============>.................] - ETA: 1s - loss: 0.0440 - accuracy: 0.6814 6/11 [===============>..............] - ETA: 0s - loss: 0.0443 - accuracy: 0.6856 7/11 [==================>...........] - ETA: 0s - loss: 0.0446 - accuracy: 0.6910 8/11 [====================>.........] - ETA: 0s - loss: 0.0448 - accuracy: 0.6973 9/11 [=======================>......] - ETA: 0s - loss: 0.0448 - accuracy: 0.703410/11 [==========================>...] - ETA: 0s - loss: 0.0448 - accuracy: 0.709511/11 [==============================] - ETA: 0s - loss: 0.0447 - accuracy: 0.715011/11 [==============================] - 2s 164ms/step - loss: 0.0447 - accuracy: 0.7197
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0425 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 1s - loss: 0.0418 - accuracy: 0.8008 3/11 [=======>......................] - ETA: 1s - loss: 0.0413 - accuracy: 0.7977 4/11 [=========>....................] - ETA: 1s - loss: 0.0414 - accuracy: 0.7922 5/11 [============>.................] - ETA: 0s - loss: 0.0415 - accuracy: 0.7865 6/11 [===============>..............] - ETA: 0s - loss: 0.0412 - accuracy: 0.7824 7/11 [==================>...........] - ETA: 0s - loss: 0.0409 - accuracy: 0.7797 8/11 [====================>.........] - ETA: 0s - loss: 0.0407 - accuracy: 0.7782 9/11 [=======================>......] - ETA: 0s - loss: 0.0406 - accuracy: 0.777110/11 [==========================>...] - ETA: 0s - loss: 0.0405 - accuracy: 0.776511/11 [==============================] - ETA: 0s - loss: 0.0404 - accuracy: 0.776811/11 [==============================] - 2s 164ms/step - loss: 0.0404 - accuracy: 0.7770
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0366 - accuracy: 0.8594 2/11 [====>.........................] - ETA: 1s - loss: 0.0376 - accuracy: 0.8535 3/11 [=======>......................] - ETA: 1s - loss: 0.0371 - accuracy: 0.8572 4/11 [=========>....................] - ETA: 1s - loss: 0.0367 - accuracy: 0.8558 5/11 [============>.................] - ETA: 1s - loss: 0.0365 - accuracy: 0.8543 6/11 [===============>..............] - ETA: 0s - loss: 0.0364 - accuracy: 0.8526 7/11 [==================>...........] - ETA: 0s - loss: 0.0363 - accuracy: 0.8510 8/11 [====================>.........] - ETA: 0s - loss: 0.0362 - accuracy: 0.8493 9/11 [=======================>......] - ETA: 0s - loss: 0.0361 - accuracy: 0.848010/11 [==========================>...] - ETA: 0s - loss: 0.0361 - accuracy: 0.846811/11 [==============================] - ETA: 0s - loss: 0.0361 - accuracy: 0.846211/11 [==============================] - 2s 173ms/step - loss: 0.0361 - accuracy: 0.8457
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0318 - accuracy: 0.8984 2/11 [====>.........................] - ETA: 1s - loss: 0.0332 - accuracy: 0.8848 3/11 [=======>......................] - ETA: 1s - loss: 0.0348 - accuracy: 0.8789 4/11 [=========>....................] - ETA: 1s - loss: 0.0353 - accuracy: 0.8755 5/11 [============>.................] - ETA: 0s - loss: 0.0354 - accuracy: 0.8738 6/11 [===============>..............] - ETA: 0s - loss: 0.0353 - accuracy: 0.8716 7/11 [==================>...........] - ETA: 0s - loss: 0.0351 - accuracy: 0.8696 8/11 [====================>.........] - ETA: 0s - loss: 0.0349 - accuracy: 0.8682 9/11 [=======================>......] - ETA: 0s - loss: 0.0347 - accuracy: 0.867210/11 [==========================>...] - ETA: 0s - loss: 0.0345 - accuracy: 0.866111/11 [==============================] - ETA: 0s - loss: 0.0343 - accuracy: 0.865611/11 [==============================] - 2s 163ms/step - loss: 0.0342 - accuracy: 0.8651
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0299 - accuracy: 0.9219 2/11 [====>.........................] - ETA: 1s - loss: 0.0320 - accuracy: 0.9297 3/11 [=======>......................] - ETA: 1s - loss: 0.0317 - accuracy: 0.9280 4/11 [=========>....................] - ETA: 1s - loss: 0.0319 - accuracy: 0.9245 5/11 [============>.................] - ETA: 0s - loss: 0.0322 - accuracy: 0.9199 6/11 [===============>..............] - ETA: 0s - loss: 0.0321 - accuracy: 0.9157 7/11 [==================>...........] - ETA: 0s - loss: 0.0321 - accuracy: 0.9123 8/11 [====================>.........] - ETA: 0s - loss: 0.0321 - accuracy: 0.9093 9/11 [=======================>......] - ETA: 0s - loss: 0.0320 - accuracy: 0.907610/11 [==========================>...] - ETA: 0s - loss: 0.0318 - accuracy: 0.906311/11 [==============================] - ETA: 0s - loss: 0.0316 - accuracy: 0.905311/11 [==============================] - 2s 164ms/step - loss: 0.0315 - accuracy: 0.9045
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0292 - accuracy: 0.8828 2/11 [====>.........................] - ETA: 1s - loss: 0.0301 - accuracy: 0.8633 3/11 [=======>......................] - ETA: 1s - loss: 0.0294 - accuracy: 0.8585 4/11 [=========>....................] - ETA: 1s - loss: 0.0291 - accuracy: 0.8602 5/11 [============>.................] - ETA: 1s - loss: 0.0289 - accuracy: 0.8641 6/11 [===============>..............] - ETA: 0s - loss: 0.0286 - accuracy: 0.8681 7/11 [==================>...........] - ETA: 0s - loss: 0.0285 - accuracy: 0.8715 8/11 [====================>.........] - ETA: 0s - loss: 0.0284 - accuracy: 0.8742 9/11 [=======================>......] - ETA: 0s - loss: 0.0283 - accuracy: 0.876510/11 [==========================>...] - ETA: 0s - loss: 0.0282 - accuracy: 0.877811/11 [==============================] - ETA: 0s - loss: 0.0281 - accuracy: 0.878811/11 [==============================] - 2s 174ms/step - loss: 0.0281 - accuracy: 0.8796
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0234 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 1s - loss: 0.0245 - accuracy: 0.8496 3/11 [=======>......................] - ETA: 1s - loss: 0.0245 - accuracy: 0.8537 4/11 [=========>....................] - ETA: 1s - loss: 0.0246 - accuracy: 0.8595 5/11 [============>.................] - ETA: 1s - loss: 0.0246 - accuracy: 0.8626 6/11 [===============>..............] - ETA: 0s - loss: 0.0247 - accuracy: 0.8658 7/11 [==================>...........] - ETA: 0s - loss: 0.0248 - accuracy: 0.8668 8/11 [====================>.........] - ETA: 0s - loss: 0.0248 - accuracy: 0.8682 9/11 [=======================>......] - ETA: 0s - loss: 0.0248 - accuracy: 0.869810/11 [==========================>...] - ETA: 0s - loss: 0.0248 - accuracy: 0.871611/11 [==============================] - ETA: 0s - loss: 0.0248 - accuracy: 0.873111/11 [==============================] - 2s 153ms/step - loss: 0.0248 - accuracy: 0.8744
Evaluate on test data
1/6 [====>.........................] - ETA: 11s - loss: 0.0239 - accuracy: 0.85164/6 [===================>..........] - ETA: 0s - loss: 0.0272 - accuracy: 0.8594 6/6 [==============================] - 2s 25ms/step - loss: 0.0289 - accuracy: 0.8527
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 4 0] pred: [5.6731701e-04 1.1752695e-02 9.6792018e-01 1.8607497e-02 9.3564391e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [3 4 2 0 1] pred: [0.03849804 0.02081588 0.07247075 0.7748057  0.25493804]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 4 0] pred: [5.34713268e-04 1.29560828e-02 9.74062681e-01 1.07678175e-02
 7.38948584e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [7.0759654e-04 3.2579601e-02 9.7352493e-01 4.2349696e-03 6.7767501e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [1 2 0 3 4] pred: [0.07336882 0.90942323 0.40680915 0.00895286 0.00598839]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 0 3 4] pred: [0.01133379 0.85628265 0.9265827  0.00478005 0.00228697]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [1 2 0 3 4] pred: [0.03755832 0.9412322  0.77223456 0.0064694  0.00368884]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 0 3 4] pred: [0.02224284 0.9229815  0.9037758  0.0046376  0.00347656]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [3 2 4 0 1] pred: [0.01622608 0.01457024 0.11812332 0.82874423 0.07204917]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [0.02930617 0.9008322  0.8264519  0.00566787 0.00377947]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 4 0] pred: [0.00096759 0.00683013 0.9302772  0.0703097  0.00177133]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [0.04979473 0.9494444  0.7243419  0.00626412 0.00439611]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 3 1 4 0] pred: [4.0912628e-04 7.2807968e-03 9.7788191e-01 1.3850749e-02 1.1425316e-03]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 1 3 0 4] pred: [6.9555640e-04 2.5686324e-02 9.7150886e-01 6.4550936e-03 6.6107512e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [1.0302663e-03 5.8037639e-02 9.5112348e-01 4.2957962e-03 6.9844723e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 7 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_7 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:14 - loss: 0.2498 - accuracy: 0.1641 2/11 [====>.........................] - ETA: 1s - loss: 0.2494 - accuracy: 0.2012   3/11 [=======>......................] - ETA: 1s - loss: 0.2489 - accuracy: 0.2383 4/11 [=========>....................] - ETA: 1s - loss: 0.2484 - accuracy: 0.2656 5/11 [============>.................] - ETA: 0s - loss: 0.2479 - accuracy: 0.2850 6/11 [===============>..............] - ETA: 0s - loss: 0.2474 - accuracy: 0.3017 7/11 [==================>...........] - ETA: 0s - loss: 0.2469 - accuracy: 0.3144 8/11 [====================>.........] - ETA: 0s - loss: 0.2464 - accuracy: 0.3251 9/11 [=======================>......] - ETA: 0s - loss: 0.2458 - accuracy: 0.335010/11 [==========================>...] - ETA: 0s - loss: 0.2453 - accuracy: 0.343811/11 [==============================] - ETA: 0s - loss: 0.2448 - accuracy: 0.351211/11 [==============================] - 9s 154ms/step - loss: 0.2443 - accuracy: 0.3574
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2233 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.2223 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 1s - loss: 0.2214 - accuracy: 0.4679 4/11 [=========>....................] - ETA: 1s - loss: 0.2205 - accuracy: 0.4637 5/11 [============>.................] - ETA: 0s - loss: 0.2197 - accuracy: 0.4557 6/11 [===============>..............] - ETA: 0s - loss: 0.2188 - accuracy: 0.4502 7/11 [==================>...........] - ETA: 0s - loss: 0.2177 - accuracy: 0.4484 8/11 [====================>.........] - ETA: 0s - loss: 0.2166 - accuracy: 0.4482 9/11 [=======================>......] - ETA: 0s - loss: 0.2154 - accuracy: 0.448910/11 [==========================>...] - ETA: 0s - loss: 0.2141 - accuracy: 0.450111/11 [==============================] - ETA: 0s - loss: 0.2129 - accuracy: 0.451311/11 [==============================] - 2s 157ms/step - loss: 0.2118 - accuracy: 0.4523
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1699 - accuracy: 0.3984 2/11 [====>.........................] - ETA: 1s - loss: 0.1655 - accuracy: 0.4238 3/11 [=======>......................] - ETA: 1s - loss: 0.1620 - accuracy: 0.4336 4/11 [=========>....................] - ETA: 1s - loss: 0.1590 - accuracy: 0.4414 5/11 [============>.................] - ETA: 0s - loss: 0.1564 - accuracy: 0.4472 6/11 [===============>..............] - ETA: 0s - loss: 0.1543 - accuracy: 0.4503 7/11 [==================>...........] - ETA: 0s - loss: 0.1525 - accuracy: 0.4517 8/11 [====================>.........] - ETA: 0s - loss: 0.1505 - accuracy: 0.4533 9/11 [=======================>......] - ETA: 0s - loss: 0.1488 - accuracy: 0.454510/11 [==========================>...] - ETA: 0s - loss: 0.1472 - accuracy: 0.455611/11 [==============================] - ETA: 0s - loss: 0.1458 - accuracy: 0.456311/11 [==============================] - 2s 182ms/step - loss: 0.1446 - accuracy: 0.4569
Epoch 4/20
 1/11 [=>............................] - ETA: 2s - loss: 0.1055 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.1071 - accuracy: 0.4336 3/11 [=======>......................] - ETA: 1s - loss: 0.1081 - accuracy: 0.4384 4/11 [=========>....................] - ETA: 1s - loss: 0.1084 - accuracy: 0.4401 5/11 [============>.................] - ETA: 1s - loss: 0.1084 - accuracy: 0.4427 6/11 [===============>..............] - ETA: 0s - loss: 0.1087 - accuracy: 0.4442 7/11 [==================>...........] - ETA: 0s - loss: 0.1093 - accuracy: 0.4441 8/11 [====================>.........] - ETA: 0s - loss: 0.1096 - accuracy: 0.4447 9/11 [=======================>......] - ETA: 0s - loss: 0.1097 - accuracy: 0.446610/11 [==========================>...] - ETA: 0s - loss: 0.1099 - accuracy: 0.448111/11 [==============================] - ETA: 0s - loss: 0.1101 - accuracy: 0.449511/11 [==============================] - 2s 182ms/step - loss: 0.1102 - accuracy: 0.4507
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1066 - accuracy: 0.5312 2/11 [====>.........................] - ETA: 1s - loss: 0.1076 - accuracy: 0.5176 3/11 [=======>......................] - ETA: 1s - loss: 0.1063 - accuracy: 0.5143 4/11 [=========>....................] - ETA: 1s - loss: 0.1057 - accuracy: 0.5103 5/11 [============>.................] - ETA: 1s - loss: 0.1060 - accuracy: 0.5054 6/11 [===============>..............] - ETA: 0s - loss: 0.1056 - accuracy: 0.5034 7/11 [==================>...........] - ETA: 0s - loss: 0.1054 - accuracy: 0.5018 8/11 [====================>.........] - ETA: 0s - loss: 0.1053 - accuracy: 0.4994 9/11 [=======================>......] - ETA: 0s - loss: 0.1053 - accuracy: 0.496510/11 [==========================>...] - ETA: 0s - loss: 0.1054 - accuracy: 0.493311/11 [==============================] - ETA: 0s - loss: 0.1055 - accuracy: 0.490611/11 [==============================] - 2s 174ms/step - loss: 0.1056 - accuracy: 0.4883
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1079 - accuracy: 0.4844 2/11 [====>.........................] - ETA: 1s - loss: 0.1069 - accuracy: 0.4863 3/11 [=======>......................] - ETA: 1s - loss: 0.1060 - accuracy: 0.4787 4/11 [=========>....................] - ETA: 1s - loss: 0.1053 - accuracy: 0.4718 5/11 [============>.................] - ETA: 1s - loss: 0.1043 - accuracy: 0.4709 6/11 [===============>..............] - ETA: 0s - loss: 0.1036 - accuracy: 0.4699 7/11 [==================>...........] - ETA: 0s - loss: 0.1030 - accuracy: 0.4680 8/11 [====================>.........] - ETA: 0s - loss: 0.1023 - accuracy: 0.4677 9/11 [=======================>......] - ETA: 0s - loss: 0.1019 - accuracy: 0.467210/11 [==========================>...] - ETA: 0s - loss: 0.1015 - accuracy: 0.467611/11 [==============================] - ETA: 0s - loss: 0.1012 - accuracy: 0.467211/11 [==============================] - 2s 195ms/step - loss: 0.1009 - accuracy: 0.4669
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0982 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.0937 - accuracy: 0.4727 3/11 [=======>......................] - ETA: 1s - loss: 0.0918 - accuracy: 0.4774 4/11 [=========>....................] - ETA: 1s - loss: 0.0911 - accuracy: 0.4718 5/11 [============>.................] - ETA: 1s - loss: 0.0904 - accuracy: 0.4709 6/11 [===============>..............] - ETA: 0s - loss: 0.0901 - accuracy: 0.4703 7/11 [==================>...........] - ETA: 0s - loss: 0.0903 - accuracy: 0.4685 8/11 [====================>.........] - ETA: 0s - loss: 0.0905 - accuracy: 0.4670 9/11 [=======================>......] - ETA: 0s - loss: 0.0904 - accuracy: 0.466010/11 [==========================>...] - ETA: 0s - loss: 0.0902 - accuracy: 0.466011/11 [==============================] - ETA: 0s - loss: 0.0900 - accuracy: 0.466311/11 [==============================] - 2s 196ms/step - loss: 0.0898 - accuracy: 0.4665
Epoch 8/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0809 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.0804 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 1s - loss: 0.0808 - accuracy: 0.4757 4/11 [=========>....................] - ETA: 1s - loss: 0.0806 - accuracy: 0.4779 5/11 [============>.................] - ETA: 1s - loss: 0.0801 - accuracy: 0.4801 6/11 [===============>..............] - ETA: 0s - loss: 0.0798 - accuracy: 0.4821 7/11 [==================>...........] - ETA: 0s - loss: 0.0796 - accuracy: 0.4836 8/11 [====================>.........] - ETA: 0s - loss: 0.0794 - accuracy: 0.4851 9/11 [=======================>......] - ETA: 0s - loss: 0.0792 - accuracy: 0.486810/11 [==========================>...] - ETA: 0s - loss: 0.0791 - accuracy: 0.488311/11 [==============================] - ETA: 0s - loss: 0.0792 - accuracy: 0.489311/11 [==============================] - 2s 196ms/step - loss: 0.0792 - accuracy: 0.4902
Epoch 9/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0632 - accuracy: 0.6328 2/11 [====>.........................] - ETA: 1s - loss: 0.0695 - accuracy: 0.6113 3/11 [=======>......................] - ETA: 1s - loss: 0.0723 - accuracy: 0.6011 4/11 [=========>....................] - ETA: 1s - loss: 0.0734 - accuracy: 0.5993 5/11 [============>.................] - ETA: 1s - loss: 0.0743 - accuracy: 0.5969 6/11 [===============>..............] - ETA: 0s - loss: 0.0750 - accuracy: 0.5944 7/11 [==================>...........] - ETA: 0s - loss: 0.0752 - accuracy: 0.5935 8/11 [====================>.........] - ETA: 0s - loss: 0.0752 - accuracy: 0.5933 9/11 [=======================>......] - ETA: 0s - loss: 0.0752 - accuracy: 0.593510/11 [==========================>...] - ETA: 0s - loss: 0.0750 - accuracy: 0.594611/11 [==============================] - ETA: 0s - loss: 0.0748 - accuracy: 0.596211/11 [==============================] - 2s 173ms/step - loss: 0.0746 - accuracy: 0.5976
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0785 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 1s - loss: 0.0745 - accuracy: 0.5977 3/11 [=======>......................] - ETA: 1s - loss: 0.0728 - accuracy: 0.6076 4/11 [=========>....................] - ETA: 1s - loss: 0.0714 - accuracy: 0.6154 5/11 [============>.................] - ETA: 1s - loss: 0.0709 - accuracy: 0.6192 6/11 [===============>..............] - ETA: 0s - loss: 0.0701 - accuracy: 0.6225 7/11 [==================>...........] - ETA: 0s - loss: 0.0695 - accuracy: 0.6242 8/11 [====================>.........] - ETA: 0s - loss: 0.0689 - accuracy: 0.6254 9/11 [=======================>......] - ETA: 0s - loss: 0.0686 - accuracy: 0.625210/11 [==========================>...] - ETA: 0s - loss: 0.0683 - accuracy: 0.624811/11 [==============================] - ETA: 0s - loss: 0.0681 - accuracy: 0.624411/11 [==============================] - 2s 183ms/step - loss: 0.0679 - accuracy: 0.6240
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0726 - accuracy: 0.5938 2/11 [====>.........................] - ETA: 1s - loss: 0.0687 - accuracy: 0.6113 3/11 [=======>......................] - ETA: 1s - loss: 0.0669 - accuracy: 0.6202 4/11 [=========>....................] - ETA: 1s - loss: 0.0652 - accuracy: 0.6292 5/11 [============>.................] - ETA: 0s - loss: 0.0640 - accuracy: 0.6384 6/11 [===============>..............] - ETA: 0s - loss: 0.0631 - accuracy: 0.6455 7/11 [==================>...........] - ETA: 0s - loss: 0.0624 - accuracy: 0.6512 8/11 [====================>.........] - ETA: 0s - loss: 0.0618 - accuracy: 0.6560 9/11 [=======================>......] - ETA: 0s - loss: 0.0615 - accuracy: 0.658610/11 [==========================>...] - ETA: 0s - loss: 0.0612 - accuracy: 0.660611/11 [==============================] - ETA: 0s - loss: 0.0610 - accuracy: 0.662511/11 [==============================] - 2s 167ms/step - loss: 0.0609 - accuracy: 0.6641
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0486 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 1s - loss: 0.0517 - accuracy: 0.7773 3/11 [=======>......................] - ETA: 1s - loss: 0.0528 - accuracy: 0.7717 4/11 [=========>....................] - ETA: 1s - loss: 0.0532 - accuracy: 0.7692 5/11 [============>.................] - ETA: 0s - loss: 0.0531 - accuracy: 0.7644 6/11 [===============>..............] - ETA: 0s - loss: 0.0530 - accuracy: 0.7599 7/11 [==================>...........] - ETA: 0s - loss: 0.0530 - accuracy: 0.7573 8/11 [====================>.........] - ETA: 0s - loss: 0.0529 - accuracy: 0.7554 9/11 [=======================>......] - ETA: 0s - loss: 0.0529 - accuracy: 0.755310/11 [==========================>...] - ETA: 0s - loss: 0.0529 - accuracy: 0.755911/11 [==============================] - ETA: 0s - loss: 0.0530 - accuracy: 0.756611/11 [==============================] - 2s 170ms/step - loss: 0.0530 - accuracy: 0.7572
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0557 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 1s - loss: 0.0545 - accuracy: 0.8691 3/11 [=======>......................] - ETA: 1s - loss: 0.0534 - accuracy: 0.8598 4/11 [=========>....................] - ETA: 1s - loss: 0.0528 - accuracy: 0.8494 5/11 [============>.................] - ETA: 0s - loss: 0.0524 - accuracy: 0.8358 6/11 [===============>..............] - ETA: 0s - loss: 0.0522 - accuracy: 0.8245 7/11 [==================>...........] - ETA: 0s - loss: 0.0522 - accuracy: 0.8168 8/11 [====================>.........] - ETA: 0s - loss: 0.0520 - accuracy: 0.8128 9/11 [=======================>......] - ETA: 0s - loss: 0.0519 - accuracy: 0.810410/11 [==========================>...] - ETA: 0s - loss: 0.0516 - accuracy: 0.810011/11 [==============================] - ETA: 0s - loss: 0.0513 - accuracy: 0.809811/11 [==============================] - 2s 153ms/step - loss: 0.0511 - accuracy: 0.8097
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0436 - accuracy: 0.7969 2/11 [====>.........................] - ETA: 1s - loss: 0.0443 - accuracy: 0.7715 3/11 [=======>......................] - ETA: 1s - loss: 0.0465 - accuracy: 0.7539 4/11 [=========>....................] - ETA: 1s - loss: 0.0470 - accuracy: 0.7490 5/11 [============>.................] - ETA: 1s - loss: 0.0470 - accuracy: 0.7480 6/11 [===============>..............] - ETA: 1s - loss: 0.0467 - accuracy: 0.7509 7/11 [==================>...........] - ETA: 0s - loss: 0.0464 - accuracy: 0.7552 8/11 [====================>.........] - ETA: 0s - loss: 0.0462 - accuracy: 0.7606 9/11 [=======================>......] - ETA: 0s - loss: 0.0461 - accuracy: 0.765910/11 [==========================>...] - ETA: 0s - loss: 0.0460 - accuracy: 0.771111/11 [==============================] - ETA: 0s - loss: 0.0459 - accuracy: 0.775911/11 [==============================] - 2s 183ms/step - loss: 0.0458 - accuracy: 0.7800
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0447 - accuracy: 0.7812 2/11 [====>.........................] - ETA: 1s - loss: 0.0432 - accuracy: 0.7695 3/11 [=======>......................] - ETA: 1s - loss: 0.0433 - accuracy: 0.7639 4/11 [=========>....................] - ETA: 1s - loss: 0.0433 - accuracy: 0.7614 5/11 [============>.................] - ETA: 1s - loss: 0.0438 - accuracy: 0.7582 6/11 [===============>..............] - ETA: 0s - loss: 0.0439 - accuracy: 0.7568 7/11 [==================>...........] - ETA: 0s - loss: 0.0438 - accuracy: 0.7589 8/11 [====================>.........] - ETA: 0s - loss: 0.0436 - accuracy: 0.7620 9/11 [=======================>......] - ETA: 0s - loss: 0.0434 - accuracy: 0.766610/11 [==========================>...] - ETA: 0s - loss: 0.0433 - accuracy: 0.771411/11 [==============================] - ETA: 0s - loss: 0.0431 - accuracy: 0.776111/11 [==============================] - 2s 162ms/step - loss: 0.0430 - accuracy: 0.7800
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0395 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 1s - loss: 0.0397 - accuracy: 0.8359 3/11 [=======>......................] - ETA: 1s - loss: 0.0399 - accuracy: 0.8273 4/11 [=========>....................] - ETA: 1s - loss: 0.0402 - accuracy: 0.8226 5/11 [============>.................] - ETA: 0s - loss: 0.0403 - accuracy: 0.8209 6/11 [===============>..............] - ETA: 0s - loss: 0.0404 - accuracy: 0.8191 7/11 [==================>...........] - ETA: 0s - loss: 0.0403 - accuracy: 0.8197 8/11 [====================>.........] - ETA: 0s - loss: 0.0401 - accuracy: 0.8209 9/11 [=======================>......] - ETA: 0s - loss: 0.0399 - accuracy: 0.822710/11 [==========================>...] - ETA: 0s - loss: 0.0396 - accuracy: 0.824911/11 [==============================] - ETA: 0s - loss: 0.0395 - accuracy: 0.827011/11 [==============================] - 2s 147ms/step - loss: 0.0393 - accuracy: 0.8288
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0407 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 1s - loss: 0.0399 - accuracy: 0.8574 3/11 [=======>......................] - ETA: 1s - loss: 0.0392 - accuracy: 0.8589 4/11 [=========>....................] - ETA: 1s - loss: 0.0394 - accuracy: 0.8576 5/11 [============>.................] - ETA: 0s - loss: 0.0391 - accuracy: 0.8579 6/11 [===============>..............] - ETA: 0s - loss: 0.0388 - accuracy: 0.8547 7/11 [==================>...........] - ETA: 0s - loss: 0.0384 - accuracy: 0.8520 8/11 [====================>.........] - ETA: 0s - loss: 0.0381 - accuracy: 0.8505 9/11 [=======================>......] - ETA: 0s - loss: 0.0379 - accuracy: 0.850210/11 [==========================>...] - ETA: 0s - loss: 0.0377 - accuracy: 0.850211/11 [==============================] - ETA: 0s - loss: 0.0374 - accuracy: 0.850511/11 [==============================] - 2s 152ms/step - loss: 0.0373 - accuracy: 0.8507
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0322 - accuracy: 0.8906 2/11 [====>.........................] - ETA: 1s - loss: 0.0331 - accuracy: 0.8945 3/11 [=======>......................] - ETA: 1s - loss: 0.0329 - accuracy: 0.8898 4/11 [=========>....................] - ETA: 1s - loss: 0.0327 - accuracy: 0.8875 5/11 [============>.................] - ETA: 0s - loss: 0.0323 - accuracy: 0.8819 6/11 [===============>..............] - ETA: 0s - loss: 0.0320 - accuracy: 0.8758 7/11 [==================>...........] - ETA: 0s - loss: 0.0320 - accuracy: 0.8701 8/11 [====================>.........] - ETA: 0s - loss: 0.0320 - accuracy: 0.8657 9/11 [=======================>......] - ETA: 0s - loss: 0.0320 - accuracy: 0.862510/11 [==========================>...] - ETA: 0s - loss: 0.0320 - accuracy: 0.860411/11 [==============================] - ETA: 0s - loss: 0.0321 - accuracy: 0.859111/11 [==============================] - 2s 180ms/step - loss: 0.0321 - accuracy: 0.8580
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0249 - accuracy: 0.9297 2/11 [====>.........................] - ETA: 1s - loss: 0.0282 - accuracy: 0.9180 3/11 [=======>......................] - ETA: 1s - loss: 0.0294 - accuracy: 0.9149 4/11 [=========>....................] - ETA: 1s - loss: 0.0295 - accuracy: 0.9147 5/11 [============>.................] - ETA: 1s - loss: 0.0296 - accuracy: 0.9096 6/11 [===============>..............] - ETA: 0s - loss: 0.0297 - accuracy: 0.9053 7/11 [==================>...........] - ETA: 0s - loss: 0.0298 - accuracy: 0.9012 8/11 [====================>.........] - ETA: 0s - loss: 0.0299 - accuracy: 0.8978 9/11 [=======================>......] - ETA: 0s - loss: 0.0299 - accuracy: 0.895410/11 [==========================>...] - ETA: 0s - loss: 0.0299 - accuracy: 0.893811/11 [==============================] - ETA: 0s - loss: 0.0299 - accuracy: 0.892311/11 [==============================] - 2s 171ms/step - loss: 0.0300 - accuracy: 0.8911
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0330 - accuracy: 0.8828 2/11 [====>.........................] - ETA: 1s - loss: 0.0320 - accuracy: 0.8770 3/11 [=======>......................] - ETA: 1s - loss: 0.0316 - accuracy: 0.8702 4/11 [=========>....................] - ETA: 0s - loss: 0.0313 - accuracy: 0.8665 5/11 [============>.................] - ETA: 0s - loss: 0.0309 - accuracy: 0.8654 6/11 [===============>..............] - ETA: 0s - loss: 0.0306 - accuracy: 0.8653 7/11 [==================>...........] - ETA: 0s - loss: 0.0303 - accuracy: 0.8646 8/11 [====================>.........] - ETA: 0s - loss: 0.0300 - accuracy: 0.8646 9/11 [=======================>......] - ETA: 0s - loss: 0.0298 - accuracy: 0.864410/11 [==========================>...] - ETA: 0s - loss: 0.0296 - accuracy: 0.864711/11 [==============================] - ETA: 0s - loss: 0.0295 - accuracy: 0.865111/11 [==============================] - 2s 147ms/step - loss: 0.0294 - accuracy: 0.8655
Evaluate on test data
1/6 [====>.........................] - ETA: 11s - loss: 0.0253 - accuracy: 0.90623/6 [==============>...............] - ETA: 0s - loss: 0.0280 - accuracy: 0.9193 5/6 [========================>.....] - ETA: 0s - loss: 0.0291 - accuracy: 0.91566/6 [==============================] - 3s 34ms/step - loss: 0.0293 - accuracy: 0.9108
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 1 3 0 4] pred: [7.2962046e-04 2.6214242e-02 9.7930956e-01 1.8331587e-02 5.1224232e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 1 3 0 4] pred: [7.5536966e-04 2.8487831e-02 9.7520703e-01 2.0707071e-02 5.5852532e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 3 0 4] pred: [8.7830424e-04 3.4122527e-02 9.6680456e-01 1.9617945e-02 5.9565902e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 3 0 4] pred: [7.8549981e-04 2.5125712e-02 9.7873074e-01 1.8002987e-02 5.1316619e-04]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 3 1 4 0] pred: [0.00143319 0.03499639 0.85837156 0.07616308 0.00210667]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 4 0] pred: [0.00144732 0.03531998 0.8631595  0.07051247 0.00179344]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 1 3 0 4] pred: [0.1037237  0.498551   0.576494   0.15154475 0.03917107]
 Top predictions indices: [2] vs. real classes indices: [1]
Jaccard Score:  0.0
 
 ============ Sample: 7 ============
pred sorted: [3 4 2 1 0] pred: [0.01162705 0.01914164 0.07898426 0.85833955 0.09911129]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 0 3 4] pred: [0.03438973 0.94906527 0.63141984 0.01064792 0.00193051]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 3 0 4] pred: [0.00966173 0.88800156 0.803936   0.01092565 0.00126553]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [1 2 0 3 4] pred: [0.01936704 0.81761247 0.68546385 0.01301348 0.00210598]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [0.01365182 0.867788   0.78252554 0.01236811 0.00129911]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [1 2 0 3 4] pred: [0.02281076 0.8409859  0.7388102  0.01463038 0.00133741]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 0 4] pred: [0.00167808 0.03006965 0.9219012  0.03737843 0.00118166]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 1 3 0 4] pred: [0.00777954 0.3985606  0.8178674  0.02376923 0.00295416]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 8 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_8 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:19 - loss: 0.2506 - accuracy: 0.1016 2/11 [====>.........................] - ETA: 1s - loss: 0.2501 - accuracy: 0.1445   3/11 [=======>......................] - ETA: 1s - loss: 0.2496 - accuracy: 0.1858 4/11 [=========>....................] - ETA: 1s - loss: 0.2492 - accuracy: 0.2179 5/11 [============>.................] - ETA: 1s - loss: 0.2487 - accuracy: 0.2422 6/11 [===============>..............] - ETA: 0s - loss: 0.2482 - accuracy: 0.2628 7/11 [==================>...........] - ETA: 0s - loss: 0.2477 - accuracy: 0.2788 8/11 [====================>.........] - ETA: 0s - loss: 0.2472 - accuracy: 0.2925 9/11 [=======================>......] - ETA: 0s - loss: 0.2467 - accuracy: 0.304210/11 [==========================>...] - ETA: 0s - loss: 0.2462 - accuracy: 0.314811/11 [==============================] - ETA: 0s - loss: 0.2457 - accuracy: 0.323511/11 [==============================] - 10s 171ms/step - loss: 0.2453 - accuracy: 0.3308
Epoch 2/20
 1/11 [=>............................] - ETA: 2s - loss: 0.2261 - accuracy: 0.4141 2/11 [====>.........................] - ETA: 1s - loss: 0.2255 - accuracy: 0.4258 3/11 [=======>......................] - ETA: 1s - loss: 0.2247 - accuracy: 0.4340 4/11 [=========>....................] - ETA: 1s - loss: 0.2237 - accuracy: 0.4427 5/11 [============>.................] - ETA: 1s - loss: 0.2227 - accuracy: 0.4492 6/11 [===============>..............] - ETA: 0s - loss: 0.2217 - accuracy: 0.4548 7/11 [==================>...........] - ETA: 0s - loss: 0.2207 - accuracy: 0.4581 8/11 [====================>.........] - ETA: 0s - loss: 0.2197 - accuracy: 0.4605 9/11 [=======================>......] - ETA: 0s - loss: 0.2186 - accuracy: 0.461610/11 [==========================>...] - ETA: 0s - loss: 0.2175 - accuracy: 0.462711/11 [==============================] - ETA: 0s - loss: 0.2164 - accuracy: 0.463411/11 [==============================] - 2s 178ms/step - loss: 0.2155 - accuracy: 0.4639
Epoch 3/20
 1/11 [=>............................] - ETA: 2s - loss: 0.1679 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.1662 - accuracy: 0.4941 3/11 [=======>......................] - ETA: 1s - loss: 0.1649 - accuracy: 0.4926 4/11 [=========>....................] - ETA: 1s - loss: 0.1631 - accuracy: 0.4910 5/11 [============>.................] - ETA: 1s - loss: 0.1617 - accuracy: 0.4866 6/11 [===============>..............] - ETA: 0s - loss: 0.1603 - accuracy: 0.4830 7/11 [==================>...........] - ETA: 0s - loss: 0.1587 - accuracy: 0.4806 8/11 [====================>.........] - ETA: 0s - loss: 0.1572 - accuracy: 0.4783 9/11 [=======================>......] - ETA: 0s - loss: 0.1556 - accuracy: 0.476910/11 [==========================>...] - ETA: 0s - loss: 0.1541 - accuracy: 0.476111/11 [==============================] - ETA: 0s - loss: 0.1527 - accuracy: 0.475611/11 [==============================] - 2s 179ms/step - loss: 0.1516 - accuracy: 0.4751
Epoch 4/20
 1/11 [=>............................] - ETA: 2s - loss: 0.1179 - accuracy: 0.4688 2/11 [====>.........................] - ETA: 1s - loss: 0.1184 - accuracy: 0.4688 3/11 [=======>......................] - ETA: 1s - loss: 0.1184 - accuracy: 0.4696 4/11 [=========>....................] - ETA: 1s - loss: 0.1198 - accuracy: 0.4631 5/11 [============>.................] - ETA: 1s - loss: 0.1209 - accuracy: 0.4583 6/11 [===============>..............] - ETA: 1s - loss: 0.1213 - accuracy: 0.4578 7/11 [==================>...........] - ETA: 0s - loss: 0.1213 - accuracy: 0.4575 8/11 [====================>.........] - ETA: 0s - loss: 0.1212 - accuracy: 0.4574 9/11 [=======================>......] - ETA: 0s - loss: 0.1209 - accuracy: 0.457910/11 [==========================>...] - ETA: 0s - loss: 0.1205 - accuracy: 0.458511/11 [==============================] - ETA: 0s - loss: 0.1201 - accuracy: 0.459611/11 [==============================] - 2s 183ms/step - loss: 0.1198 - accuracy: 0.4604
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1367 - accuracy: 0.3750 2/11 [====>.........................] - ETA: 1s - loss: 0.1320 - accuracy: 0.3828 3/11 [=======>......................] - ETA: 1s - loss: 0.1294 - accuracy: 0.3941 4/11 [=========>....................] - ETA: 0s - loss: 0.1268 - accuracy: 0.4040 5/11 [============>.................] - ETA: 0s - loss: 0.1249 - accuracy: 0.4091 6/11 [===============>..............] - ETA: 0s - loss: 0.1234 - accuracy: 0.4151 7/11 [==================>...........] - ETA: 0s - loss: 0.1222 - accuracy: 0.4199 8/11 [====================>.........] - ETA: 0s - loss: 0.1211 - accuracy: 0.4243 9/11 [=======================>......] - ETA: 0s - loss: 0.1199 - accuracy: 0.428710/11 [==========================>...] - ETA: 0s - loss: 0.1190 - accuracy: 0.432111/11 [==============================] - ETA: 0s - loss: 0.1181 - accuracy: 0.435611/11 [==============================] - 2s 138ms/step - loss: 0.1174 - accuracy: 0.4385
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1072 - accuracy: 0.4297 2/11 [====>.........................] - ETA: 1s - loss: 0.1047 - accuracy: 0.4355 3/11 [=======>......................] - ETA: 1s - loss: 0.1039 - accuracy: 0.4379 4/11 [=========>....................] - ETA: 0s - loss: 0.1035 - accuracy: 0.4422 5/11 [============>.................] - ETA: 0s - loss: 0.1032 - accuracy: 0.4453 6/11 [===============>..............] - ETA: 0s - loss: 0.1028 - accuracy: 0.4490 7/11 [==================>...........] - ETA: 0s - loss: 0.1025 - accuracy: 0.4518 8/11 [====================>.........] - ETA: 0s - loss: 0.1023 - accuracy: 0.4540 9/11 [=======================>......] - ETA: 0s - loss: 0.1021 - accuracy: 0.455610/11 [==========================>...] - ETA: 0s - loss: 0.1018 - accuracy: 0.457311/11 [==============================] - ETA: 0s - loss: 0.1015 - accuracy: 0.458811/11 [==============================] - 2s 164ms/step - loss: 0.1013 - accuracy: 0.4600
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0904 - accuracy: 0.5547 2/11 [====>.........................] - ETA: 1s - loss: 0.0906 - accuracy: 0.5254 3/11 [=======>......................] - ETA: 1s - loss: 0.0903 - accuracy: 0.5100 4/11 [=========>....................] - ETA: 1s - loss: 0.0893 - accuracy: 0.5060 5/11 [============>.................] - ETA: 0s - loss: 0.0887 - accuracy: 0.5039 6/11 [===============>..............] - ETA: 0s - loss: 0.0882 - accuracy: 0.5032 7/11 [==================>...........] - ETA: 0s - loss: 0.0879 - accuracy: 0.5028 8/11 [====================>.........] - ETA: 0s - loss: 0.0877 - accuracy: 0.5019 9/11 [=======================>......] - ETA: 0s - loss: 0.0875 - accuracy: 0.501310/11 [==========================>...] - ETA: 0s - loss: 0.0874 - accuracy: 0.500711/11 [==============================] - ETA: 0s - loss: 0.0873 - accuracy: 0.500111/11 [==============================] - 2s 164ms/step - loss: 0.0872 - accuracy: 0.4996
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0843 - accuracy: 0.4922 2/11 [====>.........................] - ETA: 1s - loss: 0.0844 - accuracy: 0.4883 3/11 [=======>......................] - ETA: 1s - loss: 0.0822 - accuracy: 0.4974 4/11 [=========>....................] - ETA: 1s - loss: 0.0805 - accuracy: 0.5034 5/11 [============>.................] - ETA: 1s - loss: 0.0798 - accuracy: 0.5071 6/11 [===============>..............] - ETA: 0s - loss: 0.0791 - accuracy: 0.5105 7/11 [==================>...........] - ETA: 0s - loss: 0.0785 - accuracy: 0.5139 8/11 [====================>.........] - ETA: 0s - loss: 0.0781 - accuracy: 0.5156 9/11 [=======================>......] - ETA: 0s - loss: 0.0777 - accuracy: 0.517310/11 [==========================>...] - ETA: 0s - loss: 0.0774 - accuracy: 0.519011/11 [==============================] - ETA: 0s - loss: 0.0772 - accuracy: 0.520211/11 [==============================] - 2s 169ms/step - loss: 0.0770 - accuracy: 0.5211
Epoch 9/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0626 - accuracy: 0.5625 2/11 [====>.........................] - ETA: 1s - loss: 0.0632 - accuracy: 0.5781 3/11 [=======>......................] - ETA: 1s - loss: 0.0635 - accuracy: 0.5755 4/11 [=========>....................] - ETA: 1s - loss: 0.0641 - accuracy: 0.5713 5/11 [============>.................] - ETA: 1s - loss: 0.0647 - accuracy: 0.5689 6/11 [===============>..............] - ETA: 0s - loss: 0.0649 - accuracy: 0.5687 7/11 [==================>...........] - ETA: 0s - loss: 0.0652 - accuracy: 0.5678 8/11 [====================>.........] - ETA: 0s - loss: 0.0654 - accuracy: 0.5674 9/11 [=======================>......] - ETA: 0s - loss: 0.0655 - accuracy: 0.567710/11 [==========================>...] - ETA: 0s - loss: 0.0655 - accuracy: 0.568111/11 [==============================] - ETA: 0s - loss: 0.0656 - accuracy: 0.569411/11 [==============================] - 2s 187ms/step - loss: 0.0656 - accuracy: 0.5706
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0611 - accuracy: 0.7578 2/11 [====>.........................] - ETA: 1s - loss: 0.0606 - accuracy: 0.7695 3/11 [=======>......................] - ETA: 1s - loss: 0.0608 - accuracy: 0.7726 4/11 [=========>....................] - ETA: 1s - loss: 0.0609 - accuracy: 0.7674 5/11 [============>.................] - ETA: 1s - loss: 0.0610 - accuracy: 0.7592 6/11 [===============>..............] - ETA: 0s - loss: 0.0610 - accuracy: 0.7516 7/11 [==================>...........] - ETA: 0s - loss: 0.0611 - accuracy: 0.7444 8/11 [====================>.........] - ETA: 0s - loss: 0.0610 - accuracy: 0.7389 9/11 [=======================>......] - ETA: 0s - loss: 0.0609 - accuracy: 0.736010/11 [==========================>...] - ETA: 0s - loss: 0.0608 - accuracy: 0.735311/11 [==============================] - ETA: 0s - loss: 0.0606 - accuracy: 0.735011/11 [==============================] - 2s 168ms/step - loss: 0.0605 - accuracy: 0.7348
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0552 - accuracy: 0.7422 2/11 [====>.........................] - ETA: 1s - loss: 0.0555 - accuracy: 0.7441 3/11 [=======>......................] - ETA: 1s - loss: 0.0547 - accuracy: 0.7418 4/11 [=========>....................] - ETA: 1s - loss: 0.0544 - accuracy: 0.7345 5/11 [============>.................] - ETA: 0s - loss: 0.0542 - accuracy: 0.7317 6/11 [===============>..............] - ETA: 0s - loss: 0.0540 - accuracy: 0.7298 7/11 [==================>...........] - ETA: 0s - loss: 0.0538 - accuracy: 0.7295 8/11 [====================>.........] - ETA: 0s - loss: 0.0537 - accuracy: 0.7296 9/11 [=======================>......] - ETA: 0s - loss: 0.0537 - accuracy: 0.728510/11 [==========================>...] - ETA: 0s - loss: 0.0536 - accuracy: 0.727811/11 [==============================] - ETA: 0s - loss: 0.0535 - accuracy: 0.727511/11 [==============================] - 2s 173ms/step - loss: 0.0534 - accuracy: 0.7272
Epoch 12/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0566 - accuracy: 0.7500 2/11 [====>.........................] - ETA: 1s - loss: 0.0535 - accuracy: 0.7539 3/11 [=======>......................] - ETA: 1s - loss: 0.0522 - accuracy: 0.7500 4/11 [=========>....................] - ETA: 1s - loss: 0.0516 - accuracy: 0.7446 5/11 [============>.................] - ETA: 1s - loss: 0.0509 - accuracy: 0.7423 6/11 [===============>..............] - ETA: 0s - loss: 0.0507 - accuracy: 0.7386 7/11 [==================>...........] - ETA: 0s - loss: 0.0503 - accuracy: 0.7375 8/11 [====================>.........] - ETA: 0s - loss: 0.0500 - accuracy: 0.7376 9/11 [=======================>......] - ETA: 0s - loss: 0.0498 - accuracy: 0.739110/11 [==========================>...] - ETA: 0s - loss: 0.0497 - accuracy: 0.740911/11 [==============================] - ETA: 0s - loss: 0.0495 - accuracy: 0.743111/11 [==============================] - 2s 160ms/step - loss: 0.0494 - accuracy: 0.7449
Epoch 13/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0410 - accuracy: 0.8516 2/11 [====>.........................] - ETA: 1s - loss: 0.0412 - accuracy: 0.8438 3/11 [=======>......................] - ETA: 1s - loss: 0.0419 - accuracy: 0.8325 4/11 [=========>....................] - ETA: 1s - loss: 0.0423 - accuracy: 0.8250 5/11 [============>.................] - ETA: 0s - loss: 0.0429 - accuracy: 0.8197 6/11 [===============>..............] - ETA: 0s - loss: 0.0433 - accuracy: 0.8170 7/11 [==================>...........] - ETA: 0s - loss: 0.0436 - accuracy: 0.8141 8/11 [====================>.........] - ETA: 0s - loss: 0.0438 - accuracy: 0.8115 9/11 [=======================>......] - ETA: 0s - loss: 0.0439 - accuracy: 0.810110/11 [==========================>...] - ETA: 0s - loss: 0.0439 - accuracy: 0.809711/11 [==============================] - ETA: 0s - loss: 0.0439 - accuracy: 0.809311/11 [==============================] - 2s 181ms/step - loss: 0.0440 - accuracy: 0.8090
Epoch 14/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0425 - accuracy: 0.8438 2/11 [====>.........................] - ETA: 1s - loss: 0.0425 - accuracy: 0.8379 3/11 [=======>......................] - ETA: 1s - loss: 0.0425 - accuracy: 0.8260 4/11 [=========>....................] - ETA: 1s - loss: 0.0423 - accuracy: 0.8221 5/11 [============>.................] - ETA: 1s - loss: 0.0422 - accuracy: 0.8196 6/11 [===============>..............] - ETA: 0s - loss: 0.0423 - accuracy: 0.8160 7/11 [==================>...........] - ETA: 0s - loss: 0.0424 - accuracy: 0.8145 8/11 [====================>.........] - ETA: 0s - loss: 0.0424 - accuracy: 0.8140 9/11 [=======================>......] - ETA: 0s - loss: 0.0423 - accuracy: 0.814710/11 [==========================>...] - ETA: 0s - loss: 0.0422 - accuracy: 0.816211/11 [==============================] - ETA: 0s - loss: 0.0421 - accuracy: 0.817711/11 [==============================] - 2s 189ms/step - loss: 0.0420 - accuracy: 0.8190
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0409 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 1s - loss: 0.0400 - accuracy: 0.8535 3/11 [=======>......................] - ETA: 1s - loss: 0.0395 - accuracy: 0.8442 4/11 [=========>....................] - ETA: 1s - loss: 0.0393 - accuracy: 0.8372 5/11 [============>.................] - ETA: 1s - loss: 0.0392 - accuracy: 0.8345 6/11 [===============>..............] - ETA: 0s - loss: 0.0388 - accuracy: 0.8354 7/11 [==================>...........] - ETA: 0s - loss: 0.0387 - accuracy: 0.8366 8/11 [====================>.........] - ETA: 0s - loss: 0.0385 - accuracy: 0.8389 9/11 [=======================>......] - ETA: 0s - loss: 0.0385 - accuracy: 0.840510/11 [==========================>...] - ETA: 0s - loss: 0.0384 - accuracy: 0.842011/11 [==============================] - ETA: 0s - loss: 0.0383 - accuracy: 0.843411/11 [==============================] - 2s 191ms/step - loss: 0.0383 - accuracy: 0.8446
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0307 - accuracy: 0.9219 2/11 [====>.........................] - ETA: 1s - loss: 0.0312 - accuracy: 0.9062 3/11 [=======>......................] - ETA: 1s - loss: 0.0317 - accuracy: 0.8993 4/11 [=========>....................] - ETA: 0s - loss: 0.0320 - accuracy: 0.8918 5/11 [============>.................] - ETA: 0s - loss: 0.0322 - accuracy: 0.8853 6/11 [===============>..............] - ETA: 0s - loss: 0.0325 - accuracy: 0.8788 7/11 [==================>...........] - ETA: 0s - loss: 0.0328 - accuracy: 0.8744 8/11 [====================>.........] - ETA: 0s - loss: 0.0331 - accuracy: 0.8703 9/11 [=======================>......] - ETA: 0s - loss: 0.0333 - accuracy: 0.867110/11 [==========================>...] - ETA: 0s - loss: 0.0334 - accuracy: 0.863911/11 [==============================] - ETA: 0s - loss: 0.0335 - accuracy: 0.860711/11 [==============================] - 2s 159ms/step - loss: 0.0336 - accuracy: 0.8581
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0307 - accuracy: 0.8516 2/11 [====>.........................] - ETA: 1s - loss: 0.0310 - accuracy: 0.8613 3/11 [=======>......................] - ETA: 1s - loss: 0.0314 - accuracy: 0.8650 4/11 [=========>....................] - ETA: 1s - loss: 0.0317 - accuracy: 0.8700 5/11 [============>.................] - ETA: 0s - loss: 0.0318 - accuracy: 0.8732 6/11 [===============>..............] - ETA: 0s - loss: 0.0319 - accuracy: 0.8758 7/11 [==================>...........] - ETA: 0s - loss: 0.0320 - accuracy: 0.8786 8/11 [====================>.........] - ETA: 0s - loss: 0.0319 - accuracy: 0.8807 9/11 [=======================>......] - ETA: 0s - loss: 0.0319 - accuracy: 0.882410/11 [==========================>...] - ETA: 0s - loss: 0.0319 - accuracy: 0.883711/11 [==============================] - ETA: 0s - loss: 0.0319 - accuracy: 0.884211/11 [==============================] - 2s 165ms/step - loss: 0.0319 - accuracy: 0.8845
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0311 - accuracy: 0.8906 2/11 [====>.........................] - ETA: 1s - loss: 0.0308 - accuracy: 0.8926 3/11 [=======>......................] - ETA: 1s - loss: 0.0308 - accuracy: 0.8963 4/11 [=========>....................] - ETA: 1s - loss: 0.0312 - accuracy: 0.8968 5/11 [============>.................] - ETA: 1s - loss: 0.0313 - accuracy: 0.8981 6/11 [===============>..............] - ETA: 0s - loss: 0.0313 - accuracy: 0.8999 7/11 [==================>...........] - ETA: 0s - loss: 0.0312 - accuracy: 0.9019 8/11 [====================>.........] - ETA: 0s - loss: 0.0310 - accuracy: 0.9035 9/11 [=======================>......] - ETA: 0s - loss: 0.0309 - accuracy: 0.904210/11 [==========================>...] - ETA: 0s - loss: 0.0309 - accuracy: 0.903711/11 [==============================] - ETA: 0s - loss: 0.0308 - accuracy: 0.902611/11 [==============================] - 2s 173ms/step - loss: 0.0307 - accuracy: 0.9016
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0228 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 1s - loss: 0.0241 - accuracy: 0.8496 3/11 [=======>......................] - ETA: 1s - loss: 0.0250 - accuracy: 0.8546 4/11 [=========>....................] - ETA: 1s - loss: 0.0255 - accuracy: 0.8592 5/11 [============>.................] - ETA: 0s - loss: 0.0260 - accuracy: 0.8633 6/11 [===============>..............] - ETA: 0s - loss: 0.0264 - accuracy: 0.8670 7/11 [==================>...........] - ETA: 0s - loss: 0.0267 - accuracy: 0.8689 8/11 [====================>.........] - ETA: 0s - loss: 0.0269 - accuracy: 0.8709 9/11 [=======================>......] - ETA: 0s - loss: 0.0270 - accuracy: 0.872310/11 [==========================>...] - ETA: 0s - loss: 0.0271 - accuracy: 0.873811/11 [==============================] - ETA: 0s - loss: 0.0271 - accuracy: 0.875011/11 [==============================] - 2s 153ms/step - loss: 0.0271 - accuracy: 0.8760
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0237 - accuracy: 0.8281 2/11 [====>.........................] - ETA: 1s - loss: 0.0236 - accuracy: 0.8516 3/11 [=======>......................] - ETA: 1s - loss: 0.0244 - accuracy: 0.8646 4/11 [=========>....................] - ETA: 1s - loss: 0.0246 - accuracy: 0.8740 5/11 [============>.................] - ETA: 0s - loss: 0.0249 - accuracy: 0.8808 6/11 [===============>..............] - ETA: 0s - loss: 0.0250 - accuracy: 0.8857 7/11 [==================>...........] - ETA: 0s - loss: 0.0251 - accuracy: 0.8894 8/11 [====================>.........] - ETA: 0s - loss: 0.0252 - accuracy: 0.8910 9/11 [=======================>......] - ETA: 0s - loss: 0.0253 - accuracy: 0.892310/11 [==========================>...] - ETA: 0s - loss: 0.0254 - accuracy: 0.893011/11 [==============================] - ETA: 0s - loss: 0.0254 - accuracy: 0.893311/11 [==============================] - 2s 157ms/step - loss: 0.0255 - accuracy: 0.8936
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.0251 - accuracy: 0.85943/6 [==============>...............] - ETA: 0s - loss: 0.0267 - accuracy: 0.8281 5/6 [========================>.....] - ETA: 0s - loss: 0.0270 - accuracy: 0.82036/6 [==============================] - 3s 33ms/step - loss: 0.0264 - accuracy: 0.8244
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [2 3 1 4 0] pred: [0.00217164 0.01300037 0.9756083  0.02211398 0.00260639]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [0 1 4 3 2] pred: [0.6566059  0.41877496 0.22986165 0.34162354 0.35887885]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [0 1 3 4 2] pred: [0.850878   0.32717693 0.04454604 0.16887563 0.15203384]
 Top predictions indices: [0] vs. real classes indices: [0]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 1 0 3 4] pred: [0.00991151 0.8791678  0.8893157  0.00938177 0.00133377]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [3 2 4 1 0] pred: [0.00407052 0.00614455 0.15124303 0.8500769  0.03064549]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 1 3 0 4] pred: [0.00649449 0.8948638  0.90033436 0.0076822  0.00185892]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 4 0] pred: [0.00202417 0.01889226 0.97406924 0.02012733 0.00240043]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [2 1 0 3 4] pred: [0.02193099 0.75431    0.8843962  0.00644797 0.00172022]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [2 1 3 4 0] pred: [0.0031122  0.15176639 0.93151003 0.11618584 0.00431398]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [2 3 1 4 0] pred: [0.00202531 0.01539969 0.9752803  0.02012089 0.00242674]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 4 0] pred: [0.00195813 0.00940752 0.87902486 0.06776839 0.00873405]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [1 2 0 3 4] pred: [0.13732174 0.68338144 0.21120235 0.01714683 0.01388317]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 3 0 4] pred: [0.00778753 0.09559295 0.9395841  0.0215199  0.00138408]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [2 3 1 4 0] pred: [0.0021469  0.01301911 0.975882   0.02142394 0.00254792]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 4 0] pred: [0.00217253 0.01298705 0.9756101  0.02212098 0.00260732]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Exécution 9 : 
BPIC20.csv
Running Tensforflow with CPU
LSTM
Trying to load: ../../datasets/multi-label/BPIC20.csv
Categories:
[0 1 2 3 4]
output y_tr
(1368, 90)
(1368, 5)
(706, 90)
(706, 5)
Test generation tensorFlow datasets
End generating tensorFlow datasets
Alphabet size:
58
Training a LSTM
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, None, 58)          3364      
_________________________________________________________________
bidirectional_9 (Bidirection (None, 60)                21360     
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 305       
=================================================================
Total params: 25,029
Trainable params: 25,029
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
 1/11 [=>............................] - ETA: 1:20 - loss: 0.2501 - accuracy: 0.2109 2/11 [====>.........................] - ETA: 1s - loss: 0.2496 - accuracy: 0.2695   3/11 [=======>......................] - ETA: 1s - loss: 0.2491 - accuracy: 0.3090 4/11 [=========>....................] - ETA: 1s - loss: 0.2487 - accuracy: 0.3285 5/11 [============>.................] - ETA: 0s - loss: 0.2482 - accuracy: 0.3440 6/11 [===============>..............] - ETA: 0s - loss: 0.2478 - accuracy: 0.3570 7/11 [==================>...........] - ETA: 0s - loss: 0.2473 - accuracy: 0.3672 8/11 [====================>.........] - ETA: 0s - loss: 0.2468 - accuracy: 0.3760 9/11 [=======================>......] - ETA: 0s - loss: 0.2463 - accuracy: 0.382910/11 [==========================>...] - ETA: 0s - loss: 0.2458 - accuracy: 0.388511/11 [==============================] - ETA: 0s - loss: 0.2453 - accuracy: 0.393411/11 [==============================] - 10s 174ms/step - loss: 0.2450 - accuracy: 0.3975
Epoch 2/20
 1/11 [=>............................] - ETA: 1s - loss: 0.2266 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.2257 - accuracy: 0.4805 3/11 [=======>......................] - ETA: 1s - loss: 0.2248 - accuracy: 0.4878 4/11 [=========>....................] - ETA: 1s - loss: 0.2239 - accuracy: 0.4889 5/11 [============>.................] - ETA: 1s - loss: 0.2230 - accuracy: 0.4877 6/11 [===============>..............] - ETA: 0s - loss: 0.2221 - accuracy: 0.4861 7/11 [==================>...........] - ETA: 0s - loss: 0.2212 - accuracy: 0.4844 8/11 [====================>.........] - ETA: 0s - loss: 0.2202 - accuracy: 0.4824 9/11 [=======================>......] - ETA: 0s - loss: 0.2192 - accuracy: 0.480710/11 [==========================>...] - ETA: 0s - loss: 0.2182 - accuracy: 0.479111/11 [==============================] - ETA: 0s - loss: 0.2172 - accuracy: 0.477711/11 [==============================] - 2s 184ms/step - loss: 0.2164 - accuracy: 0.4766
Epoch 3/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1747 - accuracy: 0.5156 2/11 [====>.........................] - ETA: 1s - loss: 0.1730 - accuracy: 0.5117 3/11 [=======>......................] - ETA: 1s - loss: 0.1712 - accuracy: 0.5035 4/11 [=========>....................] - ETA: 1s - loss: 0.1693 - accuracy: 0.4977 5/11 [============>.................] - ETA: 1s - loss: 0.1671 - accuracy: 0.4969 6/11 [===============>..............] - ETA: 0s - loss: 0.1650 - accuracy: 0.4953 7/11 [==================>...........] - ETA: 0s - loss: 0.1628 - accuracy: 0.4939 8/11 [====================>.........] - ETA: 0s - loss: 0.1610 - accuracy: 0.4915 9/11 [=======================>......] - ETA: 0s - loss: 0.1592 - accuracy: 0.488710/11 [==========================>...] - ETA: 0s - loss: 0.1575 - accuracy: 0.486311/11 [==============================] - ETA: 0s - loss: 0.1561 - accuracy: 0.484311/11 [==============================] - 2s 177ms/step - loss: 0.1549 - accuracy: 0.4826
Epoch 4/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1174 - accuracy: 0.4062 2/11 [====>.........................] - ETA: 1s - loss: 0.1152 - accuracy: 0.4316 3/11 [=======>......................] - ETA: 1s - loss: 0.1154 - accuracy: 0.4397 4/11 [=========>....................] - ETA: 1s - loss: 0.1162 - accuracy: 0.4396 5/11 [============>.................] - ETA: 1s - loss: 0.1170 - accuracy: 0.4392 6/11 [===============>..............] - ETA: 0s - loss: 0.1174 - accuracy: 0.4385 7/11 [==================>...........] - ETA: 0s - loss: 0.1174 - accuracy: 0.4398 8/11 [====================>.........] - ETA: 0s - loss: 0.1172 - accuracy: 0.4416 9/11 [=======================>......] - ETA: 0s - loss: 0.1170 - accuracy: 0.442810/11 [==========================>...] - ETA: 0s - loss: 0.1168 - accuracy: 0.444211/11 [==============================] - ETA: 0s - loss: 0.1164 - accuracy: 0.446011/11 [==============================] - 2s 162ms/step - loss: 0.1161 - accuracy: 0.4475
Epoch 5/20
 1/11 [=>............................] - ETA: 1s - loss: 0.1228 - accuracy: 0.4375 2/11 [====>.........................] - ETA: 1s - loss: 0.1209 - accuracy: 0.4258 3/11 [=======>......................] - ETA: 1s - loss: 0.1187 - accuracy: 0.4288 4/11 [=========>....................] - ETA: 1s - loss: 0.1178 - accuracy: 0.4349 5/11 [============>.................] - ETA: 1s - loss: 0.1166 - accuracy: 0.4417 6/11 [===============>..............] - ETA: 0s - loss: 0.1153 - accuracy: 0.4477 7/11 [==================>...........] - ETA: 0s - loss: 0.1144 - accuracy: 0.4520 8/11 [====================>.........] - ETA: 0s - loss: 0.1138 - accuracy: 0.4547 9/11 [=======================>......] - ETA: 0s - loss: 0.1133 - accuracy: 0.456510/11 [==========================>...] - ETA: 0s - loss: 0.1129 - accuracy: 0.457111/11 [==============================] - ETA: 0s - loss: 0.1125 - accuracy: 0.457811/11 [==============================] - 2s 174ms/step - loss: 0.1122 - accuracy: 0.4583
Epoch 6/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0968 - accuracy: 0.5234 2/11 [====>.........................] - ETA: 1s - loss: 0.0967 - accuracy: 0.5156 3/11 [=======>......................] - ETA: 1s - loss: 0.0980 - accuracy: 0.5104 4/11 [=========>....................] - ETA: 1s - loss: 0.0997 - accuracy: 0.5044 5/11 [============>.................] - ETA: 1s - loss: 0.1004 - accuracy: 0.5013 6/11 [===============>..............] - ETA: 0s - loss: 0.1009 - accuracy: 0.4974 7/11 [==================>...........] - ETA: 0s - loss: 0.1012 - accuracy: 0.4941 8/11 [====================>.........] - ETA: 0s - loss: 0.1012 - accuracy: 0.4916 9/11 [=======================>......] - ETA: 0s - loss: 0.1012 - accuracy: 0.489210/11 [==========================>...] - ETA: 0s - loss: 0.1012 - accuracy: 0.487111/11 [==============================] - ETA: 0s - loss: 0.1011 - accuracy: 0.485111/11 [==============================] - 2s 182ms/step - loss: 0.1010 - accuracy: 0.4835
Epoch 7/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0910 - accuracy: 0.4766 2/11 [====>.........................] - ETA: 1s - loss: 0.0908 - accuracy: 0.4785 3/11 [=======>......................] - ETA: 1s - loss: 0.0909 - accuracy: 0.4822 4/11 [=========>....................] - ETA: 1s - loss: 0.0913 - accuracy: 0.4847 5/11 [============>.................] - ETA: 0s - loss: 0.0911 - accuracy: 0.4871 6/11 [===============>..............] - ETA: 0s - loss: 0.0907 - accuracy: 0.4884 7/11 [==================>...........] - ETA: 0s - loss: 0.0903 - accuracy: 0.4875 8/11 [====================>.........] - ETA: 0s - loss: 0.0902 - accuracy: 0.4848 9/11 [=======================>......] - ETA: 0s - loss: 0.0899 - accuracy: 0.483710/11 [==========================>...] - ETA: 0s - loss: 0.0896 - accuracy: 0.482711/11 [==============================] - ETA: 0s - loss: 0.0894 - accuracy: 0.481411/11 [==============================] - 2s 185ms/step - loss: 0.0893 - accuracy: 0.4803
Epoch 8/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0771 - accuracy: 0.4453 2/11 [====>.........................] - ETA: 1s - loss: 0.0811 - accuracy: 0.4453 3/11 [=======>......................] - ETA: 1s - loss: 0.0808 - accuracy: 0.4540 4/11 [=========>....................] - ETA: 1s - loss: 0.0803 - accuracy: 0.4596 5/11 [============>.................] - ETA: 1s - loss: 0.0801 - accuracy: 0.4611 6/11 [===============>..............] - ETA: 0s - loss: 0.0798 - accuracy: 0.4652 7/11 [==================>...........] - ETA: 0s - loss: 0.0795 - accuracy: 0.4699 8/11 [====================>.........] - ETA: 0s - loss: 0.0793 - accuracy: 0.4756 9/11 [=======================>......] - ETA: 0s - loss: 0.0791 - accuracy: 0.480410/11 [==========================>...] - ETA: 0s - loss: 0.0788 - accuracy: 0.485211/11 [==============================] - ETA: 0s - loss: 0.0785 - accuracy: 0.488911/11 [==============================] - 2s 187ms/step - loss: 0.0782 - accuracy: 0.4921
Epoch 9/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0597 - accuracy: 0.6172 2/11 [====>.........................] - ETA: 1s - loss: 0.0617 - accuracy: 0.6133 3/11 [=======>......................] - ETA: 1s - loss: 0.0622 - accuracy: 0.6120 4/11 [=========>....................] - ETA: 1s - loss: 0.0623 - accuracy: 0.6099 5/11 [============>.................] - ETA: 1s - loss: 0.0626 - accuracy: 0.6063 6/11 [===============>..............] - ETA: 0s - loss: 0.0631 - accuracy: 0.6064 7/11 [==================>...........] - ETA: 0s - loss: 0.0634 - accuracy: 0.6095 8/11 [====================>.........] - ETA: 0s - loss: 0.0637 - accuracy: 0.6138 9/11 [=======================>......] - ETA: 0s - loss: 0.0640 - accuracy: 0.618510/11 [==========================>...] - ETA: 0s - loss: 0.0644 - accuracy: 0.623411/11 [==============================] - ETA: 0s - loss: 0.0646 - accuracy: 0.628211/11 [==============================] - 2s 179ms/step - loss: 0.0648 - accuracy: 0.6322
Epoch 10/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0605 - accuracy: 0.7031 2/11 [====>.........................] - ETA: 1s - loss: 0.0625 - accuracy: 0.6953 3/11 [=======>......................] - ETA: 1s - loss: 0.0628 - accuracy: 0.6884 4/11 [=========>....................] - ETA: 1s - loss: 0.0628 - accuracy: 0.6813 5/11 [============>.................] - ETA: 0s - loss: 0.0625 - accuracy: 0.6804 6/11 [===============>..............] - ETA: 0s - loss: 0.0622 - accuracy: 0.6813 7/11 [==================>...........] - ETA: 0s - loss: 0.0620 - accuracy: 0.6833 8/11 [====================>.........] - ETA: 0s - loss: 0.0619 - accuracy: 0.6858 9/11 [=======================>......] - ETA: 0s - loss: 0.0618 - accuracy: 0.688310/11 [==========================>...] - ETA: 0s - loss: 0.0616 - accuracy: 0.691111/11 [==============================] - ETA: 0s - loss: 0.0613 - accuracy: 0.693411/11 [==============================] - 2s 162ms/step - loss: 0.0611 - accuracy: 0.6953
Epoch 11/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0570 - accuracy: 0.6484 2/11 [====>.........................] - ETA: 1s - loss: 0.0572 - accuracy: 0.6602 3/11 [=======>......................] - ETA: 1s - loss: 0.0569 - accuracy: 0.6589 4/11 [=========>....................] - ETA: 1s - loss: 0.0564 - accuracy: 0.6597 5/11 [============>.................] - ETA: 0s - loss: 0.0559 - accuracy: 0.6627 6/11 [===============>..............] - ETA: 0s - loss: 0.0556 - accuracy: 0.6664 7/11 [==================>...........] - ETA: 0s - loss: 0.0554 - accuracy: 0.6698 8/11 [====================>.........] - ETA: 0s - loss: 0.0551 - accuracy: 0.6737 9/11 [=======================>......] - ETA: 0s - loss: 0.0549 - accuracy: 0.677110/11 [==========================>...] - ETA: 0s - loss: 0.0547 - accuracy: 0.680011/11 [==============================] - ETA: 0s - loss: 0.0545 - accuracy: 0.682511/11 [==============================] - 2s 167ms/step - loss: 0.0543 - accuracy: 0.6845
Epoch 12/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0500 - accuracy: 0.7344 2/11 [====>.........................] - ETA: 1s - loss: 0.0487 - accuracy: 0.7559 3/11 [=======>......................] - ETA: 1s - loss: 0.0478 - accuracy: 0.7739 4/11 [=========>....................] - ETA: 1s - loss: 0.0473 - accuracy: 0.7840 5/11 [============>.................] - ETA: 1s - loss: 0.0473 - accuracy: 0.7878 6/11 [===============>..............] - ETA: 0s - loss: 0.0476 - accuracy: 0.7885 7/11 [==================>...........] - ETA: 0s - loss: 0.0478 - accuracy: 0.7860 8/11 [====================>.........] - ETA: 0s - loss: 0.0479 - accuracy: 0.7821 9/11 [=======================>......] - ETA: 0s - loss: 0.0480 - accuracy: 0.777610/11 [==========================>...] - ETA: 0s - loss: 0.0480 - accuracy: 0.773711/11 [==============================] - ETA: 0s - loss: 0.0480 - accuracy: 0.770311/11 [==============================] - 2s 194ms/step - loss: 0.0480 - accuracy: 0.7675
Epoch 13/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0389 - accuracy: 0.8125 2/11 [====>.........................] - ETA: 1s - loss: 0.0403 - accuracy: 0.8066 3/11 [=======>......................] - ETA: 1s - loss: 0.0410 - accuracy: 0.8025 4/11 [=========>....................] - ETA: 1s - loss: 0.0419 - accuracy: 0.8001 5/11 [============>.................] - ETA: 1s - loss: 0.0428 - accuracy: 0.7989 6/11 [===============>..............] - ETA: 0s - loss: 0.0432 - accuracy: 0.7974 7/11 [==================>...........] - ETA: 0s - loss: 0.0435 - accuracy: 0.7962 8/11 [====================>.........] - ETA: 0s - loss: 0.0436 - accuracy: 0.7947 9/11 [=======================>......] - ETA: 0s - loss: 0.0436 - accuracy: 0.792310/11 [==========================>...] - ETA: 0s - loss: 0.0437 - accuracy: 0.789011/11 [==============================] - ETA: 0s - loss: 0.0437 - accuracy: 0.785311/11 [==============================] - 2s 185ms/step - loss: 0.0437 - accuracy: 0.7822
Epoch 14/20
 1/11 [=>............................] - ETA: 2s - loss: 0.0508 - accuracy: 0.7188 2/11 [====>.........................] - ETA: 1s - loss: 0.0484 - accuracy: 0.7207 3/11 [=======>......................] - ETA: 1s - loss: 0.0468 - accuracy: 0.7227 4/11 [=========>....................] - ETA: 1s - loss: 0.0462 - accuracy: 0.7246 5/11 [============>.................] - ETA: 1s - loss: 0.0455 - accuracy: 0.7259 6/11 [===============>..............] - ETA: 0s - loss: 0.0448 - accuracy: 0.7280 7/11 [==================>...........] - ETA: 0s - loss: 0.0443 - accuracy: 0.7311 8/11 [====================>.........] - ETA: 0s - loss: 0.0438 - accuracy: 0.7334 9/11 [=======================>......] - ETA: 0s - loss: 0.0435 - accuracy: 0.735610/11 [==========================>...] - ETA: 0s - loss: 0.0433 - accuracy: 0.738111/11 [==============================] - ETA: 0s - loss: 0.0431 - accuracy: 0.740411/11 [==============================] - 2s 180ms/step - loss: 0.0429 - accuracy: 0.7423
Epoch 15/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0316 - accuracy: 0.8516 2/11 [====>.........................] - ETA: 1s - loss: 0.0326 - accuracy: 0.8379 3/11 [=======>......................] - ETA: 1s - loss: 0.0339 - accuracy: 0.8312 4/11 [=========>....................] - ETA: 1s - loss: 0.0346 - accuracy: 0.8255 5/11 [============>.................] - ETA: 1s - loss: 0.0351 - accuracy: 0.8214 6/11 [===============>..............] - ETA: 0s - loss: 0.0355 - accuracy: 0.8166 7/11 [==================>...........] - ETA: 0s - loss: 0.0357 - accuracy: 0.8127 8/11 [====================>.........] - ETA: 0s - loss: 0.0358 - accuracy: 0.8090 9/11 [=======================>......] - ETA: 0s - loss: 0.0361 - accuracy: 0.806010/11 [==========================>...] - ETA: 0s - loss: 0.0363 - accuracy: 0.803511/11 [==============================] - ETA: 0s - loss: 0.0364 - accuracy: 0.801811/11 [==============================] - 2s 174ms/step - loss: 0.0366 - accuracy: 0.8004
Epoch 16/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0389 - accuracy: 0.8906 2/11 [====>.........................] - ETA: 1s - loss: 0.0381 - accuracy: 0.8809 3/11 [=======>......................] - ETA: 1s - loss: 0.0374 - accuracy: 0.8763 4/11 [=========>....................] - ETA: 1s - loss: 0.0371 - accuracy: 0.8740 5/11 [============>.................] - ETA: 0s - loss: 0.0369 - accuracy: 0.8705 6/11 [===============>..............] - ETA: 0s - loss: 0.0365 - accuracy: 0.8660 7/11 [==================>...........] - ETA: 0s - loss: 0.0363 - accuracy: 0.8603 8/11 [====================>.........] - ETA: 0s - loss: 0.0362 - accuracy: 0.8543 9/11 [=======================>......] - ETA: 0s - loss: 0.0361 - accuracy: 0.849010/11 [==========================>...] - ETA: 0s - loss: 0.0360 - accuracy: 0.844211/11 [==============================] - ETA: 0s - loss: 0.0359 - accuracy: 0.839711/11 [==============================] - 2s 161ms/step - loss: 0.0359 - accuracy: 0.8360
Epoch 17/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0342 - accuracy: 0.8359 2/11 [====>.........................] - ETA: 1s - loss: 0.0351 - accuracy: 0.8262 3/11 [=======>......................] - ETA: 1s - loss: 0.0346 - accuracy: 0.8234 4/11 [=========>....................] - ETA: 1s - loss: 0.0347 - accuracy: 0.8241 5/11 [============>.................] - ETA: 1s - loss: 0.0349 - accuracy: 0.8255 6/11 [===============>..............] - ETA: 0s - loss: 0.0348 - accuracy: 0.8259 7/11 [==================>...........] - ETA: 0s - loss: 0.0346 - accuracy: 0.8262 8/11 [====================>.........] - ETA: 0s - loss: 0.0344 - accuracy: 0.8265 9/11 [=======================>......] - ETA: 0s - loss: 0.0342 - accuracy: 0.826710/11 [==========================>...] - ETA: 0s - loss: 0.0340 - accuracy: 0.826911/11 [==============================] - ETA: 0s - loss: 0.0339 - accuracy: 0.827511/11 [==============================] - 2s 184ms/step - loss: 0.0338 - accuracy: 0.8281
Epoch 18/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0313 - accuracy: 0.9219 2/11 [====>.........................] - ETA: 1s - loss: 0.0321 - accuracy: 0.9160 3/11 [=======>......................] - ETA: 1s - loss: 0.0330 - accuracy: 0.9076 4/11 [=========>....................] - ETA: 1s - loss: 0.0331 - accuracy: 0.9043 5/11 [============>.................] - ETA: 1s - loss: 0.0331 - accuracy: 0.9025 6/11 [===============>..............] - ETA: 0s - loss: 0.0330 - accuracy: 0.9012 7/11 [==================>...........] - ETA: 0s - loss: 0.0330 - accuracy: 0.8990 8/11 [====================>.........] - ETA: 0s - loss: 0.0329 - accuracy: 0.8970 9/11 [=======================>......] - ETA: 0s - loss: 0.0328 - accuracy: 0.893610/11 [==========================>...] - ETA: 0s - loss: 0.0327 - accuracy: 0.890311/11 [==============================] - ETA: 0s - loss: 0.0326 - accuracy: 0.887311/11 [==============================] - 2s 172ms/step - loss: 0.0325 - accuracy: 0.8848
Epoch 19/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0344 - accuracy: 0.8750 2/11 [====>.........................] - ETA: 1s - loss: 0.0316 - accuracy: 0.8887 3/11 [=======>......................] - ETA: 1s - loss: 0.0305 - accuracy: 0.8911 4/11 [=========>....................] - ETA: 1s - loss: 0.0302 - accuracy: 0.8949 5/11 [============>.................] - ETA: 1s - loss: 0.0299 - accuracy: 0.8974 6/11 [===============>..............] - ETA: 1s - loss: 0.0296 - accuracy: 0.8976 7/11 [==================>...........] - ETA: 0s - loss: 0.0295 - accuracy: 0.8966 8/11 [====================>.........] - ETA: 0s - loss: 0.0295 - accuracy: 0.8959 9/11 [=======================>......] - ETA: 0s - loss: 0.0295 - accuracy: 0.894910/11 [==========================>...] - ETA: 0s - loss: 0.0294 - accuracy: 0.893511/11 [==============================] - ETA: 0s - loss: 0.0293 - accuracy: 0.892011/11 [==============================] - 2s 193ms/step - loss: 0.0292 - accuracy: 0.8908
Epoch 20/20
 1/11 [=>............................] - ETA: 1s - loss: 0.0219 - accuracy: 0.7891 2/11 [====>.........................] - ETA: 1s - loss: 0.0214 - accuracy: 0.7930 3/11 [=======>......................] - ETA: 1s - loss: 0.0220 - accuracy: 0.7873 4/11 [=========>....................] - ETA: 1s - loss: 0.0226 - accuracy: 0.7829 5/11 [============>.................] - ETA: 1s - loss: 0.0232 - accuracy: 0.7797 6/11 [===============>..............] - ETA: 0s - loss: 0.0236 - accuracy: 0.7780 7/11 [==================>...........] - ETA: 0s - loss: 0.0239 - accuracy: 0.7783 8/11 [====================>.........] - ETA: 0s - loss: 0.0242 - accuracy: 0.7794 9/11 [=======================>......] - ETA: 0s - loss: 0.0244 - accuracy: 0.781110/11 [==========================>...] - ETA: 0s - loss: 0.0246 - accuracy: 0.783511/11 [==============================] - ETA: 0s - loss: 0.0249 - accuracy: 0.786111/11 [==============================] - 2s 182ms/step - loss: 0.0250 - accuracy: 0.7882
Evaluate on test data
1/6 [====>.........................] - ETA: 12s - loss: 0.0255 - accuracy: 0.82033/6 [==============>...............] - ETA: 0s - loss: 0.0272 - accuracy: 0.8203 5/6 [========================>.....] - ETA: 0s - loss: 0.0287 - accuracy: 0.81416/6 [==============================] - 3s 40ms/step - loss: 0.0287 - accuracy: 0.8116
Generate predictions
Analyzing predictions
 ============ Sample: 0 ============
pred sorted: [3 2 4 0 1] pred: [0.0190312  0.01755399 0.07810077 0.85514945 0.05153152]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 1 ============
pred sorted: [2 3 1 4 0] pred: [0.00173578 0.00673079 0.97117794 0.03492773 0.00239766]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 2 ============
pred sorted: [2 1 0 3 4] pred: [0.01791906 0.14735898 0.9509294  0.01078799 0.00218824]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 3 ============
pred sorted: [2 3 4 1 0] pred: [0.0012958  0.00399637 0.96514505 0.063059   0.00453019]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 4 ============
pred sorted: [2 1 0 3 4] pred: [1.0534763e-02 7.5153482e-01 9.2338902e-01 1.0262549e-02 8.6838007e-04]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 5 ============
pred sorted: [2 3 1 0 4] pred: [0.00245431 0.00913328 0.9704877  0.02334398 0.0015226 ]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 6 ============
pred sorted: [2 3 1 4 0] pred: [0.0021233  0.00763968 0.9611733  0.04282197 0.00255018]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 7 ============
pred sorted: [1 2 3 0 4] pred: [2.0849884e-02 7.5903231e-01 4.3137178e-01 3.6810398e-02 6.5654516e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 8 ============
pred sorted: [1 2 3 0 4] pred: [1.4765292e-02 9.0305066e-01 8.0698073e-01 1.6687393e-02 5.2943826e-04]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 9 ============
pred sorted: [1 2 0 3 4] pred: [0.03791523 0.7591906  0.70389855 0.02013373 0.00116605]
 Top predictions indices: [1 2] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 10 ============
pred sorted: [2 3 1 0 4] pred: [0.00229767 0.00881544 0.96545357 0.0282191  0.00172651]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
 ============ Sample: 11 ============
pred sorted: [3 4 2 1 0] pred: [0.01328552 0.02208436 0.05865669 0.9042374  0.10501528]
 Top predictions indices: [3] vs. real classes indices: [3]
Jaccard Score:  1.0
 
 ============ Sample: 12 ============
pred sorted: [2 1 0 3 4] pred: [0.02760905 0.66678065 0.84564775 0.01068228 0.00134793]
 Top predictions indices: [2 1] vs. real classes indices: [1 2]
Jaccard Score:  1.0
 
 ============ Sample: 13 ============
pred sorted: [1 2 3 0 4] pred: [1.7197490e-02 8.6971086e-01 6.8226224e-01 2.1578401e-02 6.4861774e-04]
 Top predictions indices: [1] vs. real classes indices: [1]
Jaccard Score:  1.0
 
 ============ Sample: 14 ============
pred sorted: [2 3 1 0 4] pred: [0.0021311  0.00813183 0.9724041  0.02360615 0.00171188]
 Top predictions indices: [2] vs. real classes indices: [2]
Jaccard Score:  1.0
 
Generating classification report
Generating confusion matrix
Job end at Sun Nov  6 09:09:15 CET 2022
